/*! SmartEditor3 - v1.0.0 - 2018-05-10
* Copyright (c) 2018 NAVER Corp; Licensed  */

se.defineComponent("se.NoticeBox",{construct:function(){this._initVar()},_initVar:function(){this.$elNoticeBox=$("#se_top_contents_box");this._$elContainer=$(".editor-container");this._nDefaultContainerTop=this._$elContainer.position().top},createNotice:function(a,b){this.$elNoticeBox.append(a);this._updateContainerTop();this._takeCanvasClientRect();var c=this.$elNoticeBox.children().last();if(typeof b==="function"){b(c)}return c},showNotice:function(a){a.show();this._updateContainerTop();this._takeCanvasClientRect()},hideNotice:function(a){a.hide();this._updateContainerTop();this._takeCanvasClientRect()},removeNotice:function(a,b){a.remove();this._updateContainerTop();this._takeCanvasClientRect();if(typeof b==="function"){b()}},_updateContainerTop:function(){var a=this.$elNoticeBox.height()+this._nDefaultContainerTop;this._$elContainer.css({top:a+"px"})},_takeCanvasClientRect:function(){$(window).trigger("resize");$SE_SIZE_STORE.prepareCanvasClientRect()}});se.defineComponent("se.GuideBox",{construct:function(){this.htPromotion=$SE_CONFIG.SERVICE_CONFIG.PROMOTION_PAGE||[];this.htData=$SE_CONFIG.SERVICE_CONFIG.GUIDE_PAGE||[]},setLocalStorage:function(){localStorage.setItem("SE3_R_GUIDE","READ");localStorage.setItem("SE3_PROMO","EVENT")},checkOpen:function(){if(this.isOpen()){this._openGuideContents()}},isOpen:function(){return localStorage.getItem("SE3_R_GUIDE")!=="READ"||localStorage.getItem("SE3_PROMO")!=="EVENT"},_initVar:function(){this._elContainer=$(".pop_userGuide .userGuide").find(".guide_cont");this._elGuide=se.editor.template.control["guide-box.hbs"];this._elPager=se.editor.template.control["guide-pager.hbs"];this._elEvent=se.editor.template.control["guide-box-event.hbs"];this._oNext="";this._oPrev="";this._oSlide="";this._oPager=""},_openGuideContents:function(){if(this.htPromotion.length===0&&this.htData.length===0){return}this._fContents=se.editor.template.control["guide-box-contents.hbs"];$SE_MODAL.create($SE_CONFIG.MODAL_TYPE.BASIC,{content:this._fContents({guideFullLink:$SE_CONFIG.SERVICE_CONFIG.HELP_GUIDE_LINK}),"class":"pop_userGuide_wrap",close:true,beforeOpen:function(){$("#se_guide_btn").removeClass("is-on");this.activate(0)}.bind(this),beforeClose:function(){$("#se_guide_btn").addClass("is-on");this.deactivate();this.setLocalStorage()}.bind(this)});this._initVar();this._appendSlide(this.htPromotion,this.htData);$SE_MODAL.open()},_closeGuideContents:function(){$SE_MODAL.close()},_appendSlide:function(a,b){var c,d=a.length,e=d+b.length;var f=$(document.createDocumentFragment());var g=$(document.createDocumentFragment());var h=null;for(c=0;c<e;c++){if(c<d){f.append(this._elEvent(a[c]));g.append(this._elPager({guideNum:c+1,guideMessage:"프로모션 이벤트 보기"}))}else{h=b[c-d];h.imgText=se.i18n.getMsg(h.imgText);h.gifText=se.i18n.getMsg(h.gifText);f.append(this._elGuide(h));g.append(this._elPager({guideNum:c+1,guideMessage:"가이드 "+c+"번 보기"}))}}this._elContainer.append(f);this._elContainer.find(".slide_bottom ul").append(g)},activate:function(a){this._oSlide=this._elContainer.find(".guide_slide");this._oPager=this._elContainer.find(".pager_lst");this._oNext=this._elContainer.find(".btn_next");this._oPrev=this._elContainer.find(".btn_before");this._activeSlide(a);this._bindEvent();this._autoSlide.bind(this)()},deactivate:function(){this._unbindEvent();this._deactiveSlide();clearInterval(this.nAutoSlice)},_bindEvent:function(){this._oPager.on("click",this._clickPager.bind(this));this._oNext.on("click",this._clickNext.bind(this));this._oPrev.on("click",this._clickBefore.bind(this))},_unbindEvent:function(){this._oPager.off();this._oNext.off();this._oPrev.off()},_clickPager:function(a){a.stopPropagation();var b=$(a.currentTarget).data("page");this._deactiveSlide();this._activeSlide(b-1);this._activeArrow(b);clearInterval(this.nAutoSlice)},_clickNext:function(a){a.stopPropagation();var b=$(".pager .is-on").data("page");if(b+1>this._oSlide.length){return}this._deactiveSlide();if(b+1===this._oSlide.length){this._oNext.addClass("is-off");this._oPrev.removeClass("is-off")}else{this._oPrev.removeClass("is-off")}this._activeSlide(b);clearInterval(this.nAutoSlice)},_clickBefore:function(a){a.stopPropagation();var b=$(".pager .is-on").data("page");if(b-1<1){return}this._deactiveSlide();if(b-1===1){this._oNext.removeClass("is-off");this._oPrev.addClass("is-off")}else{this._oNext.removeClass("is-off")}this._activeSlide(b-2);clearInterval(this.nAutoSlice)},_activeSlide:function(a){if(a===0){this._oNext.removeClass("is-off");this._oPrev.addClass("is-off")}if(a<this.htPromotion.length){$(".slide_bottom").addClass("evnt")}else{$(".slide_bottom").removeClass("evnt")}$(this._oSlide[a]).addClass("is-on");$(this._oPager[a]).addClass("is-on")},_deactiveSlide:function(){this._oSlide.removeClass("is-on");this._oPager.removeClass("is-on")},_autoSlide:function(){var a;this.nAutoSlice=setInterval(function(){a=$(".pager .is-on").data("page")%this._oSlide.length;this._deactiveSlide();this._activeSlide(a);this._activeArrow(a+1)}.bind(this),1e4)},_activeArrow:function(a){if(a===this._oSlide.length){this._oNext.addClass("is-off");this._oPrev.removeClass("is-off")}else if(a===1){this._oNext.removeClass("is-off");this._oPrev.addClass("is-off")}else{this._oNext.removeClass("is-off");this._oPrev.removeClass("is-off")}}});window.$SE_SIZE_STORE=se.defineStatic("se.CanvasSizeStore",function(){var a=null;var b=null;var c=null;var d=null;var e=$SE_CONFIG.ENV_SETTING.IS_CARD_DOC;var f;var g=function(){if(f&&f[0]){return}if(e){f=$("div.editor-content")}else{f=$("#"+$SE_CONFIG.ENV_SETTING.CANVAS_FRAME_ID)}};g();var h=function(){if(f.length===0){g();f.one("load",function(){i()}.bind(this))}else{i()}};var i=function(){g();var e=f.offset();var h=parseInt(f.css("marginTop"),10)-parseInt(f.css("paddingTop"),10);var i=parseInt(f.css("marginLeft"),10)-parseInt(f.css("paddingLeft"),10);var j=f.height();var k=f.width();if($("#se_bottom_contents_box").length>0&&$("#se_bottom_contents_box").css("display")!=="none"){j+=$("#se_bottom_contents_box").height()}a=e.top-h;b=e.top+j;c=e.left-i-20;d=e.left+k+20};var j=function(){if(e){i()}return{top:a,bottom:b,left:c,right:d}};return{prepareCanvasClientRect:h,getCanvasRect:j}}());se.defineComponent("se.DefaultEditor",{construct:function(){this._initVar();this._fetchDefaultEditor()},_initVar:function(){this._nVersion=null;this._nPOSTEntryUserVersion=1;this._fTemplate=se.editor.template.control["default-editor.hbs"];this._sCheckOnClass="is-on"},_wrapperElements:function(){this._$elChoiceBox=this._$elWrap.find("._se_choice_box");this._$elLabel=this._$elWrap.find("._se_choice_box label")},_unwrapperElements:function(){this._$elChoiceBox=null;this._$elLabel=null},_bindEvent:function(){this._$elChoiceBox.on("mousedown",this._checkBox.bind(this))},_unbindEvent:function(){this._$elChoiceBox.off("mousedown")},_checkBox:function(a){var b=$(a.delegateTarget).find("label").get(0).getAttribute("value"),c=this._sCheckOnClass;this._$elLabel.each(function(){var a=$(this);if(this.getAttribute("value")==b){a.addClass(c)}else{a.removeClass(c)}})},openDefaultEditorLayer:function(){this._openDefaultEditorLayer()},_setDefalutEditor:function(a){var b=this._$elWrap.find("label."+this._sCheckOnClass).get(0),c;a.stopPropagation();if(!b){$(document.body).ntoast("setMessage",se.i18n.getMsg("MSG_DEFAULT_EIDTOR"));$(document.body).ntoast("popupToast");return}c=b.getAttribute("value");this._requestAjax($SE_CONFIG.API.UPDATE_DEFAULT_EDITOR,{smartEditorVersion:c},function(b,d,e){clickcr(a.target,"esp.se"+c,"","",a);this._nVersion=c;$SE_MODAL.close()}.bind(this))},_openDefaultEditorLayer:function(){this._$elWrap=$SE_MODAL.create($SE_CONFIG.MODAL_TYPE.BASIC,{content:this._fTemplate({version:this._nVersion,serviceId:$SE_CONFIG.ENV_SETTING.SERVICE_NAME}),"class":"pop_setEditor_wrap",close:false,buttons:[{text:"확인","class":"type1",click:this._setDefalutEditor.bind(this)},{text:"취소","class":"type2",click:function(a){a.stopPropagation();$SE_MODAL.close()}}],afterOpen:function(){this._wrapperElements();this._bindEvent()}.bind(this),afterClose:function(){this._unbindEvent();this._unwrapperElements()}.bind(this)});$SE_MODAL.open()},_fetchDefaultEditor:function(){this._requestAjax($SE_CONFIG.API.GET_DEFAULT_EDITOR,{},function(a,b,c){this._nVersion=0;if(a.result){this._nVersion=a.result.defaultEditorVersion}var d=$("div.se2_link_wrap");if(!($SE_CONFIG.ENV_SETTING.IS_POST_SERVICE&&this._nVersion===this._nPOSTEntryUserVersion)){d.show()}}.bind(this))},_requestAjax:function(a,b,c){b=$.extend({serviceId:$SE_CONFIG.ENV_SETTING.SERVICE_NAME},b);$SE_AJAX.request(a,{type:"get",timeout:1e4,data:b,dataType:"json"},{fSuccess:c},{bShowErrorModal:false})},destroy:function(){this._nVersion=null;this._sVersionCheckClass=null;this._fTemplate=null}});se.defineController("se.CommonViewController",{construct:function(){this._initVar();this._createModule();this._bindEvent();this._bindModuleEvent();this._bindGatewayEvent();this._createNotices();this._showToolTip()},_showToolTip:function(){if(!this._isToolTipNecessary()){return}var a={type:"top",pointerType:"down",top:5,left:55,message:"사진검색을 이용해보세요.<br>다양한 이미지를 자유롭게<br>사용할 수 있습니다.",autoClose:true,extraClass:"pop_GTooltip_searchImage_open"};localStorage.setItem("SE3_IMAGE_SEARCH_USED","T");var b=$(".__se_open_searchImageLayer_subBtn",parent.document);var c=b.ntooltip(a);c.ntooltip("openTooltip")},_isToolTipNecessary:function(){var a=$SE_CONFIG.SERVICE_CONFIG.USE_TOOLTIP;var b=localStorage.getItem("SE3_IMAGE_SEARCH_USED")===null;return a&&b},_initVar:function(){this._oGuideBox=null;this._oDefalutEditor=null;this._oNoticeBox=null},_bindEvent:function(){$("#se_guide_btn").on("click",this._openPopup.bind(this))},_createModule:function(){this._oGuideBox=new se.GuideBox;this._oNoticeBox=new se.NoticeBox},_openPopup:function(a){a.stopPropagation();this._oGuideBox._openGuideContents()},_createNotices:function(){var a=$SE_CONFIG.SERVICE_CONFIG.CHECK_SERVER;if(a&&(a.reserveMaintenance||a.isReadOnly)){this._createCheckSeverNotice(a)}var b=$SE_CONFIG.SERVICE_CONFIG.CHALLENGE;if(b){this._createChallengeNotice(b)}var c=$SE_CONFIG.SERVICE_CONFIG.NOTICE_MESSAGE;if(c){this._createCommonNotice(c)}if($SE_CONFIG.ENV_SETTING.IE_COMPATIBLE_MODE){this._createCommonNotice(se.i18n.getMsg("MSG_COMPATIBLE_MODE"))}},_createCheckSeverNotice:function(a){var b=se.editor.template.common["notice-check-server.hbs"];if(b===undefined){return false}var c="YYYY년 MM월 DD일 HH:mm";var d={startDate:moment(a.maintenanceStartDate).format(c),endDate:moment(a.maintenanceEndDate).format(c),link:a.maintenanceLink};this._oNoticeBox.createNotice(b(d))},_createChallengeNotice:function(a){a=a.toLowerCase();var b=se.editor.template.common["notice-challenge-"+a+".hbs"];if(b===undefined){return false}this._oNoticeBox.createNotice(b(),this._onClickCloseBtn.bind(this))},_createCommonNotice:function(a){var b=se.editor.template.common["notice-common.hbs"];if(b===undefined){return false}var c=this._oNoticeBox;c.createNotice(b({content:a}),function(a){c.showNotice(a)})},createNotice:function(a,b){if(!a){return false}return this._oNoticeBox.createNotice(a,b)},removeNotice:function(a,b){this._oNoticeBox.removeNotice(a,b)},showNotice:function(a){this._oNoticeBox.showNotice(a)},hideNotice:function(a){this._oNoticeBox.hideNotice(a)},_onClickCloseBtn:function(a){var b=this._oNoticeBox;a.on("click",".btn_close_pop",function(){b.removeNotice(a)})},bindDefaultEditorSetting:function(){if($SE_CONFIG.SERVICE_CONFIG.DEFAULT_EDITOR.bSe2Interconvertible){this._oDefalutEditor=new se.DefaultEditor;$("#_se_se2").show().on("click",this._moveToSe2.bind(this));if(!$SE_CONFIG.USER_INFO.TARGET_USER_ID||$SE_CONFIG.USER_INFO.TARGET_USER_ID==$SE_CONFIG.ENV_SETTING.NAVER_ID){$("#_se_default_eidtor_setting").show().on("click",this._openDefaultEditorLayer.bind(this))}}},_openDefaultEditorLayer:function(a){a.stopPropagation();this._oDefalutEditor.openDefaultEditorLayer()},_moveToSe2:function(a){a.stopPropagation();var b=function(){$(window).off("beforeunload");$SE_MEDIA.closeAll();document.location=this._getSe2PageUrl()}.bind(this);if($SE_EVENT_HUB.trigger($SE_EVENT_HUB.MSG.CONTROL.VALIDATE_DOCUMENT,false,false)){this.oApp.exec("DATA_SAVE_TEMP_DOCUMENT",[$SE_CONFIG.MANAGE_DOC_TYPE.TEMP,false,function(){if(confirm(se.i18n.getMsg("MSG_DEFAULT_EDITOR_CONFIRM"))){b()}}.bind(this)])}else{b()}},_getSe2PageUrl:function(){var a=$SE_CONFIG.ENV_SETTING.SE2_PAGE;return a.replace("{targetUserId}",$SE_CONFIG.USER_INFO.TARGET_USER_ID||$SE_CONFIG.ENV_SETTING.NAVER_ID)},_bindModuleEvent:function(){},_bindGatewayEvent:function(){$SE_EVENT_HUB.on($SE_EVENT_HUB.MSG.CONTROL.CREATE_NOTICE,this.createNotice.bind(this));$SE_EVENT_HUB.on($SE_EVENT_HUB.MSG.CONTROL.REMOVE_NOTICE,this.removeNotice.bind(this));$SE_EVENT_HUB.on($SE_EVENT_HUB.MSG.CONTROL.SHOW_NOTICE,this.showNotice.bind(this));$SE_EVENT_HUB.on($SE_EVENT_HUB.MSG.CONTROL.HIDE_NOTICE,this.hideNotice.bind(this));$SE_EVENT_HUB.on($SE_EVENT_HUB.MSG.CONTROL.FETCH_DEFAULT_EDITTOR_SETTING,this.bindDefaultEditorSetting.bind(this))},checkGuideOpen:function(){this._oGuideBox.checkOpen()},$ON_MSG_APP_READY:function(){}});
//# sourceMappingURL=blog_desktop_normal_editor_control_common.min.js.map