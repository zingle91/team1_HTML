/*! SmartEditor3 - v1.0.0 - 2018-05-10
* Copyright (c) 2018 NAVER Corp; Licensed  */

!function(a,b){if("object"==typeof exports&&"object"==typeof module)module.exports=b();else if("function"==typeof define&&define.amd)define([],b);else{var c=b();for(var d in c)("object"==typeof exports?exports:a)[d]=c[d]}}("undefined"!=typeof self?self:this,function(){return function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,b),e.l=!0,e.exports}var c={};return b.m=a,b.c=c,b.d=function(a,c,d){b.o(a,c)||Object.defineProperty(a,c,{configurable:!1,enumerable:!0,get:d})},b.n=function(a){var c=a&&a.__esModule?function(){return a.default}:function(){return a};return b.d(c,"a",c),c},b.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},b.p="",b(b.s=214)}([function(a,b,c){"use strict";b.__esModule=!0,b.default=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}},function(a,b,c){"use strict";b.__esModule=!0;var d=c(215),e=function(a){return a&&a.__esModule?a:{"default":a}}(d);b.default=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),(0,e.default)(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}()},function(a,b,c){"use strict";b.__esModule=!0;var d=c(4),e=function(a){return a&&a.__esModule?a:{"default":a}}(d);b.default=function(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==(void 0===b?"undefined":(0,e.default)(b))&&"function"!=typeof b?a:b}},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(242),f=d(e),g=c(22),h=d(g),i=c(4),j=d(i);b.default=function(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+(void 0===b?"undefined":(0,j.default)(b)));a.prototype=(0,h.default)(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(f.default?(0,f.default)(a,b):a.__proto__=b)}},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(66),f=d(e),g=c(88),h=d(g),i="function"==typeof h.default&&"symbol"==typeof f.default?function(a){return typeof a}:function(a){return a&&"function"==typeof h.default&&a.constructor===h.default&&a!==h.default.prototype?"symbol":typeof a};b.default="function"==typeof h.default&&"symbol"===i(f.default)?function(a){return void 0===a?"undefined":i(a)}:function(a){return a&&"function"==typeof h.default&&a.constructor===h.default&&a!==h.default.prototype?"symbol":void 0===a?"undefined":i(a)}},function(a,b,c){var d,e;!function(b,c){"object"==typeof a&&"object"==typeof a.exports?a.exports=b.document?c(b,!0):function(a){if(!a.document)throw new Error("jQuery requires a window with a document");return c(a)}:c(b)}("undefined"!=typeof window?window:this,function(c,f){function g(a){var b=!!a&&"length"in a&&a.length,c=qa.type(a);return"function"!==c&&!qa.isWindow(a)&&("array"===c||0===b||"number"==typeof b&&b>0&&b-1 in a)}function h(a,b,c){if(qa.isFunction(b))return qa.grep(a,function(a,d){return!!b.call(a,d,a)!==c});if(b.nodeType)return qa.grep(a,function(a){return a===b!==c});if("string"==typeof b){if(Aa.test(b))return qa.filter(b,a,c);b=qa.filter(b,a)}return qa.grep(a,function(a){return qa.inArray(a,b)>-1!==c})}function i(a,b){do{a=a[b]}while(a&&1!==a.nodeType);return a}function j(a){var b={};return qa.each(a.match(Fa)||[],function(a,c){b[c]=!0}),b}function k(){ha.addEventListener?(ha.removeEventListener("DOMContentLoaded",l),c.removeEventListener("load",l)):(ha.detachEvent("onreadystatechange",l),c.detachEvent("onload",l))}function l(){(ha.addEventListener||"load"===c.event.type||"complete"===ha.readyState)&&(k(),qa.ready())}function m(a,b,c){if(void 0===c&&1===a.nodeType){var d="data-"+b.replace(Ka,"-$1").toLowerCase();if("string"==typeof(c=a.getAttribute(d))){try{c="true"===c||"false"!==c&&("null"===c?null:+c+""===c?+c:Ja.test(c)?qa.parseJSON(c):c)}catch(e){}qa.data(a,b,c)}else c=void 0}return c}function n(a){var b;for(b in a)if(("data"!==b||!qa.isEmptyObject(a[b]))&&"toJSON"!==b)return!1;return!0}function o(a,b,c,d){if(Ia(a)){var e,f,g=qa.expando,h=a.nodeType,i=h?qa.cache:a,j=h?a[g]:a[g]&&g;if(j&&i[j]&&(d||i[j].data)||void 0!==c||"string"!=typeof b)return j||(j=h?a[g]=ga.pop()||qa.guid++:g),i[j]||(i[j]=h?{}:{toJSON:qa.noop}),"object"!=typeof b&&"function"!=typeof b||(d?i[j]=qa.extend(i[j],b):i[j].data=qa.extend(i[j].data,b)),f=i[j],d||(f.data||(f.data={}),f=f.data),void 0!==c&&(f[qa.camelCase(b)]=c),"string"==typeof b?null==(e=f[b])&&(e=f[qa.camelCase(b)]):e=f,e}}function p(a,b,c){if(Ia(a)){var d,e,f=a.nodeType,g=f?qa.cache:a,h=f?a[qa.expando]:qa.expando;if(g[h]){if(b&&(d=c?g[h]:g[h].data)){qa.isArray(b)?b=b.concat(qa.map(b,qa.camelCase)):b in d?b=[b]:(b=qa.camelCase(b),b=b in d?[b]:b.split(" ")),e=b.length;for(;e--;)delete d[b[e]];if(c?!n(d):!qa.isEmptyObject(d))return}(c||(delete g[h].data,n(g[h])))&&(f?qa.cleanData([a],!0):pa.deleteExpando||g!=g.window?delete g[h]:g[h]=void 0)}}}function q(a,b,c,d){var e,f=1,g=20,h=d?function(){return d.cur()}:function(){return qa.css(a,b,"")},i=h(),j=c&&c[3]||(qa.cssNumber[b]?"":"px"),k=(qa.cssNumber[b]||"px"!==j&&+i)&&Ma.exec(qa.css(a,b));if(k&&k[3]!==j){j=j||k[3],c=c||[],k=+i||1;do{f=f||".5",k/=f,qa.style(a,b,k+j)}while(f!==(f=h()/i)&&1!==f&&--g)}return c&&(k=+k||+i||0,e=c[1]?k+(c[1]+1)*c[2]:+c[2],d&&(d.unit=j,d.start=k,d.end=e)),e}function r(a){var b=Ua.split("|"),c=a.createDocumentFragment();if(c.createElement)for(;b.length;)c.createElement(b.pop());return c}function s(a,b){var c,d,e=0,f=void 0!==a.getElementsByTagName?a.getElementsByTagName(b||"*"):void 0!==a.querySelectorAll?a.querySelectorAll(b||"*"):void 0;if(!f)for(f=[],c=a.childNodes||a;null!=(d=c[e]);e++)!b||qa.nodeName(d,b)?f.push(d):qa.merge(f,s(d,b));return void 0===b||b&&qa.nodeName(a,b)?qa.merge([a],f):f}function t(a,b){for(var c,d=0;null!=(c=a[d]);d++)qa._data(c,"globalEval",!b||qa._data(b[d],"globalEval"))}function u(a){Qa.test(a.type)&&(a.defaultChecked=a.checked)}function v(a,b,c,d,e){for(var f,g,h,i,j,k,l,m=a.length,n=r(b),o=[],p=0;p<m;p++)if((g=a[p])||0===g)if("object"===qa.type(g))qa.merge(o,g.nodeType?[g]:g);else if(Wa.test(g)){for(i=i||n.appendChild(b.createElement("div")),j=(Ra.exec(g)||["",""])[1].toLowerCase(),l=Va[j]||Va._default,i.innerHTML=l[1]+qa.htmlPrefilter(g)+l[2],f=l[0];f--;)i=i.lastChild;if(!pa.leadingWhitespace&&Ta.test(g)&&o.push(b.createTextNode(Ta.exec(g)[0])),!pa.tbody)for(g="table"!==j||Xa.test(g)?"<table>"!==l[1]||Xa.test(g)?0:i:i.firstChild,f=g&&g.childNodes.length;f--;)qa.nodeName(k=g.childNodes[f],"tbody")&&!k.childNodes.length&&g.removeChild(k);for(qa.merge(o,i.childNodes),i.textContent="";i.firstChild;)i.removeChild(i.firstChild);i=n.lastChild}else o.push(b.createTextNode(g));for(i&&n.removeChild(i),pa.appendChecked||qa.grep(s(o,"input"),u),p=0;g=o[p++];)if(d&&qa.inArray(g,d)>-1)e&&e.push(g);else if(h=qa.contains(g.ownerDocument,g),i=s(n.appendChild(g),"script"),h&&t(i),c)for(f=0;g=i[f++];)Sa.test(g.type||"")&&c.push(g);return i=null,n}function w(){return!0}function x(){return!1}function y(){try{return ha.activeElement}catch(a){}}function z(a,b,c,d,e,f){var g,h;if("object"==typeof b){"string"!=typeof c&&(d=d||c,c=void 0);for(h in b)z(a,h,c,d,b[h],f);return a}if(null==d&&null==e?(e=c,d=c=void 0):null==e&&("string"==typeof c?(e=d,d=void 0):(e=d,d=c,c=void 0)),!1===e)e=x;else if(!e)return a;return 1===f&&(g=e,e=function(a){return qa().off(a),g.apply(this,arguments)},e.guid=g.guid||(g.guid=qa.guid++)),a.each(function(){qa.event.add(this,b,e,d,c)})}function A(a,b){return qa.nodeName(a,"table")&&qa.nodeName(11!==b.nodeType?b:b.firstChild,"tr")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function B(a){return a.type=(null!==qa.find.attr(a,"type"))+"/"+a.type,a}function C(a){var b=gb.exec(a.type);return b?a.type=b[1]:a.removeAttribute("type"),a}function D(a,b){if(1===b.nodeType&&qa.hasData(a)){var c,d,e,f=qa._data(a),g=qa._data(b,f),h=f.events;if(h){delete g.handle,g.events={};for(c in h)for(d=0,e=h[c].length;d<e;d++)qa.event.add(b,c,h[c][d])}g.data&&(g.data=qa.extend({},g.data))}}function E(a,b){var c,d,e;if(1===b.nodeType){if(c=b.nodeName.toLowerCase(),!pa.noCloneEvent&&b[qa.expando]){e=qa._data(b);for(d in e.events)qa.removeEvent(b,d,e.handle);b.removeAttribute(qa.expando)}"script"===c&&b.text!==a.text?(B(b).text=a.text,C(b)):"object"===c?(b.parentNode&&(b.outerHTML=a.outerHTML),pa.html5Clone&&a.innerHTML&&!qa.trim(b.innerHTML)&&(b.innerHTML=a.innerHTML)):"input"===c&&Qa.test(a.type)?(b.defaultChecked=b.checked=a.checked,b.value!==a.value&&(b.value=a.value)):"option"===c?b.defaultSelected=b.selected=a.defaultSelected:"input"!==c&&"textarea"!==c||(b.defaultValue=a.defaultValue)}}function F(a,b,c,d){b=ja.apply([],b);var e,f,g,h,i,j,k=0,l=a.length,m=l-1,n=b[0],o=qa.isFunction(n);if(o||l>1&&"string"==typeof n&&!pa.checkClone&&fb.test(n))return a.each(function(e){var f=a.eq(e);o&&(b[0]=n.call(this,e,f.html())),F(f,b,c,d)});if(l&&(j=v(b,a[0].ownerDocument,!1,a,d),e=j.firstChild,1===j.childNodes.length&&(j=e),e||d)){for(h=qa.map(s(j,"script"),B),g=h.length;k<l;k++)f=j,k!==m&&(f=qa.clone(f,!0,!0),g&&qa.merge(h,s(f,"script"))),c.call(a[k],f,k);if(g)for(i=h[h.length-1].ownerDocument,qa.map(h,C),k=0;k<g;k++)f=h[k],Sa.test(f.type||"")&&!qa._data(f,"globalEval")&&qa.contains(i,f)&&(f.src?qa._evalUrl&&qa._evalUrl(f.src):qa.globalEval((f.text||f.textContent||f.innerHTML||"").replace(hb,"")));j=e=null}return a}function G(a,b,c){for(var d,e=b?qa.filter(b,a):a,f=0;null!=(d=e[f]);f++)c||1!==d.nodeType||qa.cleanData(s(d)),d.parentNode&&(c&&qa.contains(d.ownerDocument,d)&&t(s(d,"script")),d.parentNode.removeChild(d));return a}function H(a,b){var c=qa(b.createElement(a)).appendTo(b.body),d=qa.css(c[0],"display");return c.detach(),d}function I(a){var b=ha,c=lb[a];return c||(c=H(a,b),"none"!==c&&c||(kb=(kb||qa("<iframe frameborder='0' width='0' height='0'/>")).appendTo(b.documentElement),b=(kb[0].contentWindow||kb[0].contentDocument).document,b.write(),b.close(),c=H(a,b),kb.detach()),lb[a]=c),c}function J(a,b){return{get:function(){return a()?void delete this.get:(this.get=b).apply(this,arguments)}}}function K(a){if(a in Ab)return a;for(var b=a.charAt(0).toUpperCase()+a.slice(1),c=zb.length;c--;)if((a=zb[c]+b)in Ab)return a}function L(a,b){for(var c,d,e,f=[],g=0,h=a.length;g<h;g++)d=a[g],d.style&&(f[g]=qa._data(d,"olddisplay"),c=d.style.display,b?(f[g]||"none"!==c||(d.style.display=""),""===d.style.display&&Oa(d)&&(f[g]=qa._data(d,"olddisplay",I(d.nodeName)))):(e=Oa(d),(c&&"none"!==c||!e)&&qa._data(d,"olddisplay",e?c:qa.css(d,"display"))));for(g=0;g<h;g++)d=a[g],d.style&&(b&&"none"!==d.style.display&&""!==d.style.display||(d.style.display=b?f[g]||"":"none"));return a}function M(a,b,c){var d=wb.exec(b);return d?Math.max(0,d[1]-(c||0))+(d[2]||"px"):b}function N(a,b,c,d,e){for(var f=c===(d?"border":"content")?4:"width"===b?1:0,g=0;f<4;f+=2)"margin"===c&&(g+=qa.css(a,c+Na[f],!0,e)),d?("content"===c&&(g-=qa.css(a,"padding"+Na[f],!0,e)),"margin"!==c&&(g-=qa.css(a,"border"+Na[f]+"Width",!0,e))):(g+=qa.css(a,"padding"+Na[f],!0,e),"padding"!==c&&(g+=qa.css(a,"border"+Na[f]+"Width",!0,e)));return g}function O(a,b,c){var d=!0,e="width"===b?a.offsetWidth:a.offsetHeight,f=qb(a),g=pa.boxSizing&&"border-box"===qa.css(a,"boxSizing",!1,f);if(e<=0||null==e){if(e=rb(a,b,f),(e<0||null==e)&&(e=a.style[b]),nb.test(e))return e;d=g&&(pa.boxSizingReliable()||e===a.style[b]),e=parseFloat(e)||0}return e+N(a,b,c||(g?"border":"content"),d,f)+"px"}function P(a,b,c,d,e){return new P.prototype.init(a,b,c,d,e)}function Q(){return c.setTimeout(function(){Bb=void 0}),Bb=qa.now()}function R(a,b){var c,d={height:a},e=0;for(b=b?1:0;e<4;e+=2-b)c=Na[e],d["margin"+c]=d["padding"+c]=a;return b&&(d.opacity=d.width=a),d}function S(a,b,c){for(var d,e=(V.tweeners[b]||[]).concat(V.tweeners["*"]),f=0,g=e.length;f<g;f++)if(d=e[f].call(c,b,a))return d}function T(a,b,c){var d,e,f,g,h,i,j,k=this,l={},m=a.style,n=a.nodeType&&Oa(a),o=qa._data(a,"fxshow");c.queue||(h=qa._queueHooks(a,"fx"),null==h.unqueued&&(h.unqueued=0,i=h.empty.fire,h.empty.fire=function(){h.unqueued||i()}),h.unqueued++,k.always(function(){k.always(function(){h.unqueued--,qa.queue(a,"fx").length||h.empty.fire()})})),1===a.nodeType&&("height"in b||"width"in b)&&(c.overflow=[m.overflow,m.overflowX,m.overflowY],j=qa.css(a,"display"),"inline"===("none"===j?qa._data(a,"olddisplay")||I(a.nodeName):j)&&"none"===qa.css(a,"float")&&(pa.inlineBlockNeedsLayout&&"inline"!==I(a.nodeName)?m.zoom=1:m.display="inline-block")),c.overflow&&(m.overflow="hidden",pa.shrinkWrapBlocks()||k.always(function(){m.overflow=c.overflow[0],m.overflowX=c.overflow[1],m.overflowY=c.overflow[2]}));for(d in b)if(e=b[d],Db.exec(e)){if(delete b[d],f=f||"toggle"===e,e===(n?"hide":"show")){if("show"!==e||!o||void 0===o[d])continue;n=!0}l[d]=o&&o[d]||qa.style(a,d)}else j=void 0;if(qa.isEmptyObject(l))"inline"===("none"===j?I(a.nodeName):j)&&(m.display=j);else{o?"hidden"in o&&(n=o.hidden):o=qa._data(a,"fxshow",{}),f&&(o.hidden=!n),n?qa(a).show():k.done(function(){qa(a).hide()}),k.done(function(){var b;qa._removeData(a,"fxshow");for(b in l)qa.style(a,b,l[b])});for(d in l)g=S(n?o[d]:0,d,k),d in o||(o[d]=g.start,n&&(g.end=g.start,g.start="width"===d||"height"===d?1:0))}}function U(a,b){var c,d,e,f,g;for(c in a)if(d=qa.camelCase(c),e=b[d],f=a[c],qa.isArray(f)&&(e=f[1],f=a[c]=f[0]),c!==d&&(a[d]=f,delete a[c]),(g=qa.cssHooks[d])&&"expand"in g){f=g.expand(f),delete a[d];for(c in f)c in a||(a[c]=f[c],b[c]=e)}else b[d]=e}function V(a,b,c){var d,e,f=0,g=V.prefilters.length,h=qa.Deferred().always(function(){delete i.elem}),i=function(){if(e)return!1;for(var b=Bb||Q(),c=Math.max(0,j.startTime+j.duration-b),d=c/j.duration||0,f=1-d,g=0,i=j.tweens.length;g<i;g++)j.tweens[g].run(f);return h.notifyWith(a,[j,f,c]),f<1&&i?c:(h.resolveWith(a,[j]),!1)},j=h.promise({elem:a,props:qa.extend({},b),opts:qa.extend(!0,{specialEasing:{},easing:qa.easing._default},c),originalProperties:b,originalOptions:c,startTime:Bb||Q(),duration:c.duration,tweens:[],createTween:function(b,c){var d=qa.Tween(a,j.opts,b,c,j.opts.specialEasing[b]||j.opts.easing);return j.tweens.push(d),d},stop:function(b){var c=0,d=b?j.tweens.length:0;if(e)return this;for(e=!0;c<d;c++)j.tweens[c].run(1);return b?(h.notifyWith(a,[j,1,0]),h.resolveWith(a,[j,b])):h.rejectWith(a,[j,b]),this}}),k=j.props;for(U(k,j.opts.specialEasing);f<g;f++)if(d=V.prefilters[f].call(j,a,k,j.opts))return qa.isFunction(d.stop)&&(qa._queueHooks(j.elem,j.opts.queue).stop=qa.proxy(d.stop,d)),d;return qa.map(k,S,j),qa.isFunction(j.opts.start)&&j.opts.start.call(a,j),qa.fx.timer(qa.extend(i,{elem:a,anim:j,queue:j.opts.queue})),j.progress(j.opts.progress).done(j.opts.done,j.opts.complete).fail(j.opts.fail).always(j.opts.always)}function W(a){return qa.attr(a,"class")||""}function X(a){return function(b,c){"string"!=typeof b&&(c=b,b="*");var d,e=0,f=b.toLowerCase().match(Fa)||[];if(qa.isFunction(c))for(;d=f[e++];)"+"===d.charAt(0)?(d=d.slice(1)||"*",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c)}}function Y(a,b,c,d){function e(h){var i;return f[h]=!0,qa.each(a[h]||[],function(a,h){var j=h(b,c,d);return"string"!=typeof j||g||f[j]?g?!(i=j):void 0:(b.dataTypes.unshift(j),e(j),!1)}),i}var f={},g=a===ac;return e(b.dataTypes[0])||!f["*"]&&e("*")}function Z(a,b){var c,d,e=qa.ajaxSettings.flatOptions||{};for(d in b)void 0!==b[d]&&((e[d]?a:c||(c={}))[d]=b[d]);return c&&qa.extend(!0,a,c),a}function $(a,b,c){for(var d,e,f,g,h=a.contents,i=a.dataTypes;"*"===i[0];)i.shift(),void 0===e&&(e=a.mimeType||b.getResponseHeader("Content-Type"));if(e)for(g in h)if(h[g]&&h[g].test(e)){i.unshift(g);break}if(i[0]in c)f=i[0];else{for(g in c){if(!i[0]||a.converters[g+" "+i[0]]){f=g;break}d||(d=g)}f=f||d}if(f)return f!==i[0]&&i.unshift(f),c[f]}function _(a,b,c,d){var e,f,g,h,i,j={},k=a.dataTypes.slice();if(k[1])for(g in a.converters)j[g.toLowerCase()]=a.converters[g];for(f=k.shift();f;)if(a.responseFields[f]&&(c[a.responseFields[f]]=b),!i&&d&&a.dataFilter&&(b=a.dataFilter(b,a.dataType)),i=f,f=k.shift())if("*"===f)f=i;else if("*"!==i&&i!==f){if(!(g=j[i+" "+f]||j["* "+f]))for(e in j)if(h=e.split(" "),h[1]===f&&(g=j[i+" "+h[0]]||j["* "+h[0]])){!0===g?g=j[e]:!0!==j[e]&&(f=h[0],k.unshift(h[1]));break}if(!0!==g)if(g&&a.throws)b=g(b);else try{b=g(b)}catch(l){return{state:"parsererror",error:g?l:"No conversion from "+i+" to "+f}}}return{state:"success",data:b}}function aa(a){return a.style&&a.style.display||qa.css(a,"display")}function ba(a){if(!qa.contains(a.ownerDocument||ha,a))return!0;for(;a&&1===a.nodeType;){if("none"===aa(a)||"hidden"===a.type)return!0;a=a.parentNode}return!1}function ca(a,b,c,d){var e;if(qa.isArray(b))qa.each(b,function(b,e){c||fc.test(a)?d(a,e):ca(a+"["+("object"==typeof e&&null!=e?b:"")+"]",e,c,d)});else if(c||"object"!==qa.type(b))d(a,b);else for(e in b)ca(a+"["+e+"]",b[e],c,d)}function da(){try{return new c.XMLHttpRequest}catch(a){}}function ea(){try{return new c.ActiveXObject("Microsoft.XMLHTTP")}catch(a){}}function fa(a){return qa.isWindow(a)?a:9===a.nodeType&&(a.defaultView||a.parentWindow)}var ga=[],ha=c.document,ia=ga.slice,ja=ga.concat,ka=ga.push,la=ga.indexOf,ma={},na=ma.toString,oa=ma.hasOwnProperty,pa={},qa=function(a,b){return new qa.fn.init(a,b)},ra=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,sa=/^-ms-/,ta=/-([\da-z])/gi,ua=function(a,b){return b.toUpperCase()};qa.fn=qa.prototype={jquery:"1.12.4",constructor:qa,selector:"",length:0,toArray:function(){return ia.call(this)},get:function(a){return null!=a?a<0?this[a+this.length]:this[a]:ia.call(this)},pushStack:function(a){var b=qa.merge(this.constructor(),a);return b.prevObject=this,b.context=this.context,b},each:function(a){return qa.each(this,a)},map:function(a){return this.pushStack(qa.map(this,function(b,c){return a.call(b,c,b)}))},slice:function(){return this.pushStack(ia.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var b=this.length,c=+a+(a<0?b:0);return this.pushStack(c>=0&&c<b?[this[c]]:[])},end:function(){return this.prevObject||this.constructor()},push:ka,sort:ga.sort,splice:ga.splice},qa.extend=qa.fn.extend=function(){var a,b,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for("boolean"==typeof g&&(j=g,g=arguments[h]||{},h++),"object"==typeof g||qa.isFunction(g)||(g={}),h===i&&(g=this,h--);h<i;h++)if(null!=(e=arguments[h]))for(d in e)a=g[d],c=e[d],g!==c&&(j&&c&&(qa.isPlainObject(c)||(b=qa.isArray(c)))?(b?(b=!1,f=a&&qa.isArray(a)?a:[]):f=a&&qa.isPlainObject(a)?a:{},g[d]=qa.extend(j,f,c)):void 0!==c&&(g[d]=c));return g},qa.extend({expando:"jQuery"+("1.12.4"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(a){throw new Error(a)},noop:function(){},isFunction:function(a){return"function"===qa.type(a)},isArray:Array.isArray||function(a){return"array"===qa.type(a)},isWindow:function(a){return null!=a&&a==a.window},isNumeric:function(a){var b=a&&a.toString();return!qa.isArray(a)&&b-parseFloat(b)+1>=0},isEmptyObject:function(a){var b;for(b in a)return!1;return!0},isPlainObject:function(a){var b;if(!a||"object"!==qa.type(a)||a.nodeType||qa.isWindow(a))return!1;try{if(a.constructor&&!oa.call(a,"constructor")&&!oa.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(c){return!1}if(!pa.ownFirst)for(b in a)return oa.call(a,b);for(b in a);return void 0===b||oa.call(a,b)},type:function(a){return null==a?a+"":"object"==typeof a||"function"==typeof a?ma[na.call(a)]||"object":typeof a},globalEval:function(a){a&&qa.trim(a)&&(c.execScript||function(a){c.eval.call(c,a)})(a)},camelCase:function(a){return a.replace(sa,"ms-").replace(ta,ua)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()},each:function(a,b){var c,d=0;if(g(a))for(c=a.length;d<c&&!1!==b.call(a[d],d,a[d]);d++);else for(d in a)if(!1===b.call(a[d],d,a[d]))break;return a},trim:function(a){return null==a?"":(a+"").replace(ra,"")},makeArray:function(a,b){var c=b||[];return null!=a&&(g(Object(a))?qa.merge(c,"string"==typeof a?[a]:a):ka.call(c,a)),c},inArray:function(a,b,c){var d;if(b){if(la)return la.call(b,a,c);for(d=b.length,c=c?c<0?Math.max(0,d+c):c:0;c<d;c++)if(c in b&&b[c]===a)return c}return-1},merge:function(a,b){for(var c=+b.length,d=0,e=a.length;d<c;)a[e++]=b[d++];if(c!==c)for(;void 0!==b[d];)a[e++]=b[d++];return a.length=e,a},grep:function(a,b,c){for(var d=[],e=0,f=a.length,g=!c;e<f;e++)!b(a[e],e)!==g&&d.push(a[e]);return d},map:function(a,b,c){var d,e,f=0,h=[];if(g(a))for(d=a.length;f<d;f++)null!=(e=b(a[f],f,c))&&h.push(e);else for(f in a)null!=(e=b(a[f],f,c))&&h.push(e);return ja.apply([],h)},guid:1,proxy:function(a,b){var c,d,e;if("string"==typeof b&&(e=a[b],b=a,a=e),qa.isFunction(a))return c=ia.call(arguments,2),d=function(){return a.apply(b||this,c.concat(ia.call(arguments)))},d.guid=a.guid=a.guid||qa.guid++,d},now:function(){return+new Date},support:pa}),"function"==typeof Symbol&&(qa.fn[Symbol.iterator]=ga[Symbol.iterator]),qa.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(a,b){ma["[object "+b+"]"]=b.toLowerCase()});var va=function(a){function b(a,b,c,d){var e,f,g,h,j,l,m,n,o=b&&b.ownerDocument,p=b?b.nodeType:9;if(c=c||[],"string"!=typeof a||!a||1!==p&&9!==p&&11!==p)return c;if(!d&&((b?b.ownerDocument||b:M)!==E&&D(b),b=b||E,G)){if(11!==p&&(l=pa.exec(a)))if(e=l[1]){if(9===p){if(!(g=b.getElementById(e)))return c;if(g.id===e)return c.push(g),c}else if(o&&(g=o.getElementById(e))&&K(b,g)&&g.id===e)return c.push(g),c}else{if(l[2])return Y.apply(c,b.getElementsByTagName(a)),c;if((e=l[3])&&t.getElementsByClassName&&b.getElementsByClassName)return Y.apply(c,b.getElementsByClassName(e)),c}if(t.qsa&&!R[a+" "]&&(!H||!H.test(a))){if(1!==p)o=b,n=a;else if("object"!==b.nodeName.toLowerCase()){for((h=b.getAttribute("id"))?h=h.replace(ra,"\\$&"):b.setAttribute("id",h=L),m=x(a),f=m.length,j=ka.test(h)?"#"+h:"[id='"+h+"']";f--;)m[f]=j+" "+k(m[f]);n=m.join(","),o=qa.test(a)&&i(b.parentNode)||b}if(n)try{return Y.apply(c,o.querySelectorAll(n)),c}catch(q){}finally{h===L&&b.removeAttribute("id")}}}return z(a.replace(fa,"$1"),b,c,d)}function c(){function a(c,d){return b.push(c+" ")>u.cacheLength&&delete a[b.shift()],a[c+" "]=d}var b=[];return a}function d(a){return a[L]=!0,a}function e(a){var b=E.createElement("div");try{return!!a(b)}catch(c){return!1}finally{b.parentNode&&b.parentNode.removeChild(b),b=null}}function f(a,b){for(var c=a.split("|"),d=c.length;d--;)u.attrHandle[c[d]]=b}function g(a,b){var c=b&&a,d=c&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||T)-(~a.sourceIndex||T);if(d)return d;if(c)for(;c=c.nextSibling;)if(c===b)return-1;return a?1:-1}function h(a){return d(function(b){return b=+b,d(function(c,d){for(var e,f=a([],c.length,b),g=f.length;g--;)c[e=f[g]]&&(c[e]=!(d[e]=c[e]))})})}function i(a){return a&&void 0!==a.getElementsByTagName&&a}function j(){}function k(a){for(var b=0,c=a.length,d="";b<c;b++)d+=a[b].value;return d}function l(a,b,c){var d=b.dir,e=c&&"parentNode"===d,f=O++;return b.first?function(b,c,f){for(;b=b[d];)if(1===b.nodeType||e)return a(b,c,f)}:function(b,c,g){var h,i,j,k=[N,f];if(g){for(;b=b[d];)if((1===b.nodeType||e)&&a(b,c,g))return!0}else for(;b=b[d];)if(1===b.nodeType||e){if(j=b[L]||(b[L]={}),i=j[b.uniqueID]||(j[b.uniqueID]={}),(h=i[d])&&h[0]===N&&h[1]===f)return k[2]=h[2];if(i[d]=k,k[2]=a(b,c,g))return!0}}}function m(a){return a.length>1?function(b,c,d){for(var e=a.length;e--;)if(!a[e](b,c,d))return!1;return!0}:a[0]}function n(a,c,d){for(var e=0,f=c.length;e<f;e++)b(a,c[e],d);return d}function o(a,b,c,d,e){for(var f,g=[],h=0,i=a.length,j=null!=b;h<i;h++)(f=a[h])&&(c&&!c(f,d,e)||(g.push(f),j&&b.push(h)));return g}function p(a,b,c,e,f,g){return e&&!e[L]&&(e=p(e)),f&&!f[L]&&(f=p(f,g)),d(function(d,g,h,i){var j,k,l,m=[],p=[],q=g.length,r=d||n(b||"*",h.nodeType?[h]:h,[]),s=!a||!d&&b?r:o(r,m,a,h,i),t=c?f||(d?a:q||e)?[]:g:s;if(c&&c(s,t,h,i),e)for(j=o(t,p),e(j,[],h,i),k=j.length;k--;)(l=j[k])&&(t[p[k]]=!(s[p[k]]=l));if(d){if(f||a){if(f){for(j=[],k=t.length;k--;)(l=t[k])&&j.push(s[k]=l);f(null,t=[],j,i)}for(k=t.length;k--;)(l=t[k])&&(j=f?$(d,l):m[k])>-1&&(d[j]=!(g[j]=l))}}else t=o(t===g?t.splice(q,t.length):t),f?f(null,g,t,i):Y.apply(g,t)})}function q(a){for(var b,c,d,e=a.length,f=u.relative[a[0].type],g=f||u.relative[" "],h=f?1:0,i=l(function(a){return a===b},g,!0),j=l(function(a){return $(b,a)>-1},g,!0),n=[function(a,c,d){var e=!f&&(d||c!==A)||((b=c).nodeType?i(a,c,d):j(a,c,d));return b=null,e}];h<e;h++)if(c=u.relative[a[h].type])n=[l(m(n),c)];else{if(c=u.filter[a[h].type].apply(null,a[h].matches),c[L]){for(d=++h;d<e&&!u.relative[a[d].type];d++);return p(h>1&&m(n),h>1&&k(a.slice(0,h-1).concat({value:" "===a[h-2].type?"*":""})).replace(fa,"$1"),c,h<d&&q(a.slice(h,d)),d<e&&q(a=a.slice(d)),d<e&&k(a))}n.push(c)}return m(n)}function r(a,c){var e=c.length>0,f=a.length>0,g=function(d,g,h,i,j){var k,l,m,n=0,p="0",q=d&&[],r=[],s=A,t=d||f&&u.find.TAG("*",j),v=N+=null==s?1:Math.random()||.1,w=t.length;for(j&&(A=g===E||g||j);p!==w&&null!=(k=t[p]);p++){if(f&&k){for(l=0,g||k.ownerDocument===E||(D(k),h=!G);m=a[l++];)if(m(k,g||E,h)){i.push(k);break}j&&(N=v)}e&&((k=!m&&k)&&n--,d&&q.push(k))}if(n+=p,e&&p!==n){for(l=0;m=c[l++];)m(q,r,g,h);if(d){if(n>0)for(;p--;)q[p]||r[p]||(r[p]=W.call(i));r=o(r)}Y.apply(i,r),j&&!d&&r.length>0&&n+c.length>1&&b.uniqueSort(i)}return j&&(N=v,A=s),q};return e?d(g):g}var s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L="sizzle"+1*new Date,M=a.document,N=0,O=0,P=c(),Q=c(),R=c(),S=function(a,b){return a===b&&(C=!0),0},T=1<<31,U={}.hasOwnProperty,V=[],W=V.pop,X=V.push,Y=V.push,Z=V.slice,$=function(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1},_="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",aa="[\\x20\\t\\r\\n\\f]",ba="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",ca="\\["+aa+"*("+ba+")(?:"+aa+"*([*^$|!~]?=)"+aa+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+ba+"))|)"+aa+"*\\]",da=":("+ba+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+ca+")*)|.*)\\)|)",ea=new RegExp(aa+"+","g"),fa=new RegExp("^"+aa+"+|((?:^|[^\\\\])(?:\\\\.)*)"+aa+"+$","g"),ga=new RegExp("^"+aa+"*,"+aa+"*"),ha=new RegExp("^"+aa+"*([>+~]|"+aa+")"+aa+"*"),ia=new RegExp("="+aa+"*([^\\]'\"]*?)"+aa+"*\\]","g"),ja=new RegExp(da),ka=new RegExp("^"+ba+"$"),la={ID:new RegExp("^#("+ba+")"),CLASS:new RegExp("^\\.("+ba+")"),TAG:new RegExp("^("+ba+"|[*])"),ATTR:new RegExp("^"+ca),PSEUDO:new RegExp("^"+da),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+aa+"*(even|odd|(([+-]|)(\\d*)n|)"+aa+"*(?:([+-]|)"+aa+"*(\\d+)|))"+aa+"*\\)|)","i"),bool:new RegExp("^(?:"+_+")$","i"),needsContext:new RegExp("^"+aa+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+aa+"*((?:-\\d)?\\d*)"+aa+"*\\)|)(?=[^-]|$)","i")},ma=/^(?:input|select|textarea|button)$/i,na=/^h\d$/i,oa=/^[^{]+\{\s*\[native \w/,pa=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,qa=/[+~]/,ra=/'|\\/g,sa=new RegExp("\\\\([\\da-f]{1,6}"+aa+"?|("+aa+")|.)","ig"),ta=function(a,b,c){var d="0x"+b-65536;return d!==d||c?b:d<0?String.fromCharCode(d+65536):String.fromCharCode(d>>10|55296,1023&d|56320)},ua=function(){D()};try{Y.apply(V=Z.call(M.childNodes),M.childNodes),V[M.childNodes.length].nodeType}catch(va){Y={apply:V.length?function(a,b){X.apply(a,Z.call(b))}:function(a,b){for(var c=a.length,d=0;a[c++]=b[d++];);a.length=c-1}}}t=b.support={},w=b.isXML=function(a){var b=a&&(a.ownerDocument||a).documentElement;return!!b&&"HTML"!==b.nodeName},D=b.setDocument=function(a){var b,c,d=a?a.ownerDocument||a:M;return d!==E&&9===d.nodeType&&d.documentElement?(E=d,F=E.documentElement,G=!w(E),(c=E.defaultView)&&c.top!==c&&(c.addEventListener?c.addEventListener("unload",ua,!1):c.attachEvent&&c.attachEvent("onunload",ua)),t.attributes=e(function(a){return a.className="i",!a.getAttribute("className")}),t.getElementsByTagName=e(function(a){return a.appendChild(E.createComment("")),!a.getElementsByTagName("*").length}),t.getElementsByClassName=oa.test(E.getElementsByClassName),t.getById=e(function(a){return F.appendChild(a).id=L,!E.getElementsByName||!E.getElementsByName(L).length}),t.getById?(u.find.ID=function(a,b){if(void 0!==b.getElementById&&G){var c=b.getElementById(a);return c?[c]:[]}},u.filter.ID=function(a){var b=a.replace(sa,ta);return function(a){return a.getAttribute("id")===b}}):(delete u.find.ID,u.filter.ID=function(a){var b=a.replace(sa,ta);return function(a){var c=void 0!==a.getAttributeNode&&a.getAttributeNode("id");return c&&c.value===b}}),u.find.TAG=t.getElementsByTagName?function(a,b){return void 0!==b.getElementsByTagName?b.getElementsByTagName(a):t.qsa?b.querySelectorAll(a):void 0}:function(a,b){var c,d=[],e=0,f=b.getElementsByTagName(a);if("*"===a){for(;c=f[e++];)1===c.nodeType&&d.push(c);return d}return f},u.find.CLASS=t.getElementsByClassName&&function(a,b){if(void 0!==b.getElementsByClassName&&G)return b.getElementsByClassName(a)},I=[],H=[],(t.qsa=oa.test(E.querySelectorAll))&&(e(function(a){F.appendChild(a).innerHTML="<a id='"+L+"'></a><select id='"+L+"-\r\\' msallowcapture=''><option selected=''></option></select>",a.querySelectorAll("[msallowcapture^='']").length&&H.push("[*^$]="+aa+"*(?:''|\"\")"),a.querySelectorAll("[selected]").length||H.push("\\["+aa+"*(?:value|"+_+")"),a.querySelectorAll("[id~="+L+"-]").length||H.push("~="),a.querySelectorAll(":checked").length||H.push(":checked"),a.querySelectorAll("a#"+L+"+*").length||H.push(".#.+[+~]")}),e(function(a){var b=E.createElement("input");b.setAttribute("type","hidden"),a.appendChild(b).setAttribute("name","D"),a.querySelectorAll("[name=d]").length&&H.push("name"+aa+"*[*^$|!~]?="),a.querySelectorAll(":enabled").length||H.push(":enabled",":disabled"),a.querySelectorAll("*,:x"),H.push(",.*:")})),(t.matchesSelector=oa.test(J=F.matches||F.webkitMatchesSelector||F.mozMatchesSelector||F.oMatchesSelector||F.msMatchesSelector))&&e(function(a){t.disconnectedMatch=J.call(a,"div"),J.call(a,"[s!='']:x"),I.push("!=",da)}),H=H.length&&new RegExp(H.join("|")),I=I.length&&new RegExp(I.join("|")),b=oa.test(F.compareDocumentPosition),K=b||oa.test(F.contains)?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!(!d||1!==d.nodeType||!(c.contains?c.contains(d):a.compareDocumentPosition&&16&a.compareDocumentPosition(d)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1},S=b?function(a,b){if(a===b)return C=!0,0;var c=!a.compareDocumentPosition-!b.compareDocumentPosition;return c||(c=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&c||!t.sortDetached&&b.compareDocumentPosition(a)===c?a===E||a.ownerDocument===M&&K(M,a)?-1:b===E||b.ownerDocument===M&&K(M,b)?1:B?$(B,a)-$(B,b):0:4&c?-1:1)}:function(a,b){if(a===b)return C=!0,0;var c,d=0,e=a.parentNode,f=b.parentNode,h=[a],i=[b];if(!e||!f)return a===E?-1:b===E?1:e?-1:f?1:B?$(B,a)-$(B,b):0;if(e===f)return g(a,b);for(c=a;c=c.parentNode;)h.unshift(c);for(c=b;c=c.parentNode;)i.unshift(c);for(;h[d]===i[d];)d++;return d?g(h[d],i[d]):h[d]===M?-1:i[d]===M?1:0},E):E},b.matches=function(a,c){return b(a,null,null,c)},b.matchesSelector=function(a,c){if((a.ownerDocument||a)!==E&&D(a),c=c.replace(ia,"='$1']"),t.matchesSelector&&G&&!R[c+" "]&&(!I||!I.test(c))&&(!H||!H.test(c)))try{var d=J.call(a,c);if(d||t.disconnectedMatch||a.document&&11!==a.document.nodeType)return d}catch(e){}return b(c,E,null,[a]).length>0},b.contains=function(a,b){return(a.ownerDocument||a)!==E&&D(a),K(a,b)},b.attr=function(a,b){(a.ownerDocument||a)!==E&&D(a);var c=u.attrHandle[b.toLowerCase()],d=c&&U.call(u.attrHandle,b.toLowerCase())?c(a,b,!G):void 0;return void 0!==d?d:t.attributes||!G?a.getAttribute(b):(d=a.getAttributeNode(b))&&d.specified?d.value:null},b.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)},b.uniqueSort=function(a){var b,c=[],d=0,e=0;if(C=!t.detectDuplicates,B=!t.sortStable&&a.slice(0),a.sort(S),C){for(;b=a[e++];)b===a[e]&&(d=c.push(e));
for(;d--;)a.splice(c[d],1)}return B=null,a},v=b.getText=function(a){var b,c="",d=0,e=a.nodeType;if(e){if(1===e||9===e||11===e){if("string"==typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=v(a)}else if(3===e||4===e)return a.nodeValue}else for(;b=a[d++];)c+=v(b);return c},u=b.selectors={cacheLength:50,createPseudo:d,match:la,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(sa,ta),a[3]=(a[3]||a[4]||a[5]||"").replace(sa,ta),"~="===a[2]&&(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),"nth"===a[1].slice(0,3)?(a[3]||b.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&b.error(a[0]),a},PSEUDO:function(a){var b,c=!a[6]&&a[2];return la.CHILD.test(a[0])?null:(a[3]?a[2]=a[4]||a[5]||"":c&&ja.test(c)&&(b=x(c,!0))&&(b=c.indexOf(")",c.length-b)-c.length)&&(a[0]=a[0].slice(0,b),a[2]=c.slice(0,b)),a.slice(0,3))}},filter:{TAG:function(a){var b=a.replace(sa,ta).toLowerCase();return"*"===a?function(){return!0}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b}},CLASS:function(a){var b=P[a+" "];return b||(b=new RegExp("(^|"+aa+")"+a+"("+aa+"|$)"))&&P(a,function(a){return b.test("string"==typeof a.className&&a.className||void 0!==a.getAttribute&&a.getAttribute("class")||"")})},ATTR:function(a,c,d){return function(e){var f=b.attr(e,a);return null==f?"!="===c:!c||(f+="","="===c?f===d:"!="===c?f!==d:"^="===c?d&&0===f.indexOf(d):"*="===c?d&&f.indexOf(d)>-1:"$="===c?d&&f.slice(-d.length)===d:"~="===c?(" "+f.replace(ea," ")+" ").indexOf(d)>-1:"|="===c&&(f===d||f.slice(0,d.length+1)===d+"-"))}},CHILD:function(a,b,c,d,e){var f="nth"!==a.slice(0,3),g="last"!==a.slice(-4),h="of-type"===b;return 1===d&&0===e?function(a){return!!a.parentNode}:function(b,c,i){var j,k,l,m,n,o,p=f!==g?"nextSibling":"previousSibling",q=b.parentNode,r=h&&b.nodeName.toLowerCase(),s=!i&&!h,t=!1;if(q){if(f){for(;p;){for(m=b;m=m[p];)if(h?m.nodeName.toLowerCase()===r:1===m.nodeType)return!1;o=p="only"===a&&!o&&"nextSibling"}return!0}if(o=[g?q.firstChild:q.lastChild],g&&s){for(m=q,l=m[L]||(m[L]={}),k=l[m.uniqueID]||(l[m.uniqueID]={}),j=k[a]||[],n=j[0]===N&&j[1],t=n&&j[2],m=n&&q.childNodes[n];m=++n&&m&&m[p]||(t=n=0)||o.pop();)if(1===m.nodeType&&++t&&m===b){k[a]=[N,n,t];break}}else if(s&&(m=b,l=m[L]||(m[L]={}),k=l[m.uniqueID]||(l[m.uniqueID]={}),j=k[a]||[],n=j[0]===N&&j[1],t=n),!1===t)for(;(m=++n&&m&&m[p]||(t=n=0)||o.pop())&&((h?m.nodeName.toLowerCase()!==r:1!==m.nodeType)||!++t||(s&&(l=m[L]||(m[L]={}),k=l[m.uniqueID]||(l[m.uniqueID]={}),k[a]=[N,t]),m!==b)););return(t-=e)===d||t%d==0&&t/d>=0}}},PSEUDO:function(a,c){var e,f=u.pseudos[a]||u.setFilters[a.toLowerCase()]||b.error("unsupported pseudo: "+a);return f[L]?f(c):f.length>1?(e=[a,a,"",c],u.setFilters.hasOwnProperty(a.toLowerCase())?d(function(a,b){for(var d,e=f(a,c),g=e.length;g--;)d=$(a,e[g]),a[d]=!(b[d]=e[g])}):function(a){return f(a,0,e)}):f}},pseudos:{not:d(function(a){var b=[],c=[],e=y(a.replace(fa,"$1"));return e[L]?d(function(a,b,c,d){for(var f,g=e(a,null,d,[]),h=a.length;h--;)(f=g[h])&&(a[h]=!(b[h]=f))}):function(a,d,f){return b[0]=a,e(b,null,f,c),b[0]=null,!c.pop()}}),has:d(function(a){return function(c){return b(a,c).length>0}}),contains:d(function(a){return a=a.replace(sa,ta),function(b){return(b.textContent||b.innerText||v(b)).indexOf(a)>-1}}),lang:d(function(a){return ka.test(a||"")||b.error("unsupported lang: "+a),a=a.replace(sa,ta).toLowerCase(),function(b){var c;do{if(c=G?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang"))return(c=c.toLowerCase())===a||0===c.indexOf(a+"-")}while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(b){var c=a.location&&a.location.hash;return c&&c.slice(1)===b.id},root:function(a){return a===F},focus:function(a){return a===E.activeElement&&(!E.hasFocus||E.hasFocus())&&!!(a.type||a.href||~a.tabIndex)},enabled:function(a){return!1===a.disabled},disabled:function(a){return!0===a.disabled},checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,!0===a.selected},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if(a.nodeType<6)return!1;return!0},parent:function(a){return!u.pseudos.empty(a)},header:function(a){return na.test(a.nodeName)},input:function(a){return ma.test(a.nodeName)},button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},text:function(a){var b;return"input"===a.nodeName.toLowerCase()&&"text"===a.type&&(null==(b=a.getAttribute("type"))||"text"===b.toLowerCase())},first:h(function(){return[0]}),last:h(function(a,b){return[b-1]}),eq:h(function(a,b,c){return[c<0?c+b:c]}),even:h(function(a,b){for(var c=0;c<b;c+=2)a.push(c);return a}),odd:h(function(a,b){for(var c=1;c<b;c+=2)a.push(c);return a}),lt:h(function(a,b,c){for(var d=c<0?c+b:c;--d>=0;)a.push(d);return a}),gt:h(function(a,b,c){for(var d=c<0?c+b:c;++d<b;)a.push(d);return a})}},u.pseudos.nth=u.pseudos.eq;for(s in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})u.pseudos[s]=function(a){return function(b){return"input"===b.nodeName.toLowerCase()&&b.type===a}}(s);for(s in{submit:!0,reset:!0})u.pseudos[s]=function(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}}(s);return j.prototype=u.filters=u.pseudos,u.setFilters=new j,x=b.tokenize=function(a,c){var d,e,f,g,h,i,j,k=Q[a+" "];if(k)return c?0:k.slice(0);for(h=a,i=[],j=u.preFilter;h;){d&&!(e=ga.exec(h))||(e&&(h=h.slice(e[0].length)||h),i.push(f=[])),d=!1,(e=ha.exec(h))&&(d=e.shift(),f.push({value:d,type:e[0].replace(fa," ")}),h=h.slice(d.length));for(g in u.filter)!(e=la[g].exec(h))||j[g]&&!(e=j[g](e))||(d=e.shift(),f.push({value:d,type:g,matches:e}),h=h.slice(d.length));if(!d)break}return c?h.length:h?b.error(a):Q(a,i).slice(0)},y=b.compile=function(a,b){var c,d=[],e=[],f=R[a+" "];if(!f){for(b||(b=x(a)),c=b.length;c--;)f=q(b[c]),f[L]?d.push(f):e.push(f);f=R(a,r(e,d)),f.selector=a}return f},z=b.select=function(a,b,c,d){var e,f,g,h,j,l="function"==typeof a&&a,m=!d&&x(a=l.selector||a);if(c=c||[],1===m.length){if(f=m[0]=m[0].slice(0),f.length>2&&"ID"===(g=f[0]).type&&t.getById&&9===b.nodeType&&G&&u.relative[f[1].type]){if(!(b=(u.find.ID(g.matches[0].replace(sa,ta),b)||[])[0]))return c;l&&(b=b.parentNode),a=a.slice(f.shift().value.length)}for(e=la.needsContext.test(a)?0:f.length;e--&&(g=f[e],!u.relative[h=g.type]);)if((j=u.find[h])&&(d=j(g.matches[0].replace(sa,ta),qa.test(f[0].type)&&i(b.parentNode)||b))){if(f.splice(e,1),!(a=d.length&&k(f)))return Y.apply(c,d),c;break}}return(l||y(a,m))(d,b,!G,c,!b||qa.test(a)&&i(b.parentNode)||b),c},t.sortStable=L.split("").sort(S).join("")===L,t.detectDuplicates=!!C,D(),t.sortDetached=e(function(a){return 1&a.compareDocumentPosition(E.createElement("div"))}),e(function(a){return a.innerHTML="<a href='#'></a>","#"===a.firstChild.getAttribute("href")})||f("type|href|height|width",function(a,b,c){if(!c)return a.getAttribute(b,"type"===b.toLowerCase()?1:2)}),t.attributes&&e(function(a){return a.innerHTML="<input/>",a.firstChild.setAttribute("value",""),""===a.firstChild.getAttribute("value")})||f("value",function(a,b,c){if(!c&&"input"===a.nodeName.toLowerCase())return a.defaultValue}),e(function(a){return null==a.getAttribute("disabled")})||f(_,function(a,b,c){var d;if(!c)return!0===a[b]?b.toLowerCase():(d=a.getAttributeNode(b))&&d.specified?d.value:null}),b}(c);qa.find=va,qa.expr=va.selectors,qa.expr[":"]=qa.expr.pseudos,qa.uniqueSort=qa.unique=va.uniqueSort,qa.text=va.getText,qa.isXMLDoc=va.isXML,qa.contains=va.contains;var wa=function(a,b,c){for(var d=[],e=void 0!==c;(a=a[b])&&9!==a.nodeType;)if(1===a.nodeType){if(e&&qa(a).is(c))break;d.push(a)}return d},xa=function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c},ya=qa.expr.match.needsContext,za=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,Aa=/^.[^:#\[\.,]*$/;qa.filter=function(a,b,c){var d=b[0];return c&&(a=":not("+a+")"),1===b.length&&1===d.nodeType?qa.find.matchesSelector(d,a)?[d]:[]:qa.find.matches(a,qa.grep(b,function(a){return 1===a.nodeType}))},qa.fn.extend({find:function(a){var b,c=[],d=this,e=d.length;if("string"!=typeof a)return this.pushStack(qa(a).filter(function(){for(b=0;b<e;b++)if(qa.contains(d[b],this))return!0}));for(b=0;b<e;b++)qa.find(a,d[b],c);return c=this.pushStack(e>1?qa.unique(c):c),c.selector=this.selector?this.selector+" "+a:a,c},filter:function(a){return this.pushStack(h(this,a||[],!1))},not:function(a){return this.pushStack(h(this,a||[],!0))},is:function(a){return!!h(this,"string"==typeof a&&ya.test(a)?qa(a):a||[],!1).length}});var Ba,Ca=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/;(qa.fn.init=function(a,b,c){var d,e;if(!a)return this;if(c=c||Ba,"string"==typeof a){if(!(d="<"===a.charAt(0)&&">"===a.charAt(a.length-1)&&a.length>=3?[null,a,null]:Ca.exec(a))||!d[1]&&b)return!b||b.jquery?(b||c).find(a):this.constructor(b).find(a);if(d[1]){if(b=b instanceof qa?b[0]:b,qa.merge(this,qa.parseHTML(d[1],b&&b.nodeType?b.ownerDocument||b:ha,!0)),za.test(d[1])&&qa.isPlainObject(b))for(d in b)qa.isFunction(this[d])?this[d](b[d]):this.attr(d,b[d]);return this}if((e=ha.getElementById(d[2]))&&e.parentNode){if(e.id!==d[2])return Ba.find(a);this.length=1,this[0]=e}return this.context=ha,this.selector=a,this}return a.nodeType?(this.context=this[0]=a,this.length=1,this):qa.isFunction(a)?void 0!==c.ready?c.ready(a):a(qa):(void 0!==a.selector&&(this.selector=a.selector,this.context=a.context),qa.makeArray(a,this))}).prototype=qa.fn,Ba=qa(ha);var Da=/^(?:parents|prev(?:Until|All))/,Ea={children:!0,contents:!0,next:!0,prev:!0};qa.fn.extend({has:function(a){var b,c=qa(a,this),d=c.length;return this.filter(function(){for(b=0;b<d;b++)if(qa.contains(this,c[b]))return!0})},closest:function(a,b){for(var c,d=0,e=this.length,f=[],g=ya.test(a)||"string"!=typeof a?qa(a,b||this.context):0;d<e;d++)for(c=this[d];c&&c!==b;c=c.parentNode)if(c.nodeType<11&&(g?g.index(c)>-1:1===c.nodeType&&qa.find.matchesSelector(c,a))){f.push(c);break}return this.pushStack(f.length>1?qa.uniqueSort(f):f)},index:function(a){return a?"string"==typeof a?qa.inArray(this[0],qa(a)):qa.inArray(a.jquery?a[0]:a,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(a,b){return this.pushStack(qa.uniqueSort(qa.merge(this.get(),qa(a,b))))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}}),qa.each({parent:function(a){var b=a.parentNode;return b&&11!==b.nodeType?b:null},parents:function(a){return wa(a,"parentNode")},parentsUntil:function(a,b,c){return wa(a,"parentNode",c)},next:function(a){return i(a,"nextSibling")},prev:function(a){return i(a,"previousSibling")},nextAll:function(a){return wa(a,"nextSibling")},prevAll:function(a){return wa(a,"previousSibling")},nextUntil:function(a,b,c){return wa(a,"nextSibling",c)},prevUntil:function(a,b,c){return wa(a,"previousSibling",c)},siblings:function(a){return xa((a.parentNode||{}).firstChild,a)},children:function(a){return xa(a.firstChild)},contents:function(a){return qa.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:qa.merge([],a.childNodes)}},function(a,b){qa.fn[a]=function(c,d){var e=qa.map(this,b,c);return"Until"!==a.slice(-5)&&(d=c),d&&"string"==typeof d&&(e=qa.filter(d,e)),this.length>1&&(Ea[a]||(e=qa.uniqueSort(e)),Da.test(a)&&(e=e.reverse())),this.pushStack(e)}});var Fa=/\S+/g;qa.Callbacks=function(a){a="string"==typeof a?j(a):qa.extend({},a);var b,c,d,e,f=[],g=[],h=-1,i=function(){for(e=a.once,d=b=!0;g.length;h=-1)for(c=g.shift();++h<f.length;)!1===f[h].apply(c[0],c[1])&&a.stopOnFalse&&(h=f.length,c=!1);a.memory||(c=!1),b=!1,e&&(f=c?[]:"")},k={add:function(){return f&&(c&&!b&&(h=f.length-1,g.push(c)),function d(b){qa.each(b,function(b,c){qa.isFunction(c)?a.unique&&k.has(c)||f.push(c):c&&c.length&&"string"!==qa.type(c)&&d(c)})}(arguments),c&&!b&&i()),this},remove:function(){return qa.each(arguments,function(a,b){for(var c;(c=qa.inArray(b,f,c))>-1;)f.splice(c,1),c<=h&&h--}),this},has:function(a){return a?qa.inArray(a,f)>-1:f.length>0},empty:function(){return f&&(f=[]),this},disable:function(){return e=g=[],f=c="",this},disabled:function(){return!f},lock:function(){return e=!0,c||k.disable(),this},locked:function(){return!!e},fireWith:function(a,c){return e||(c=c||[],c=[a,c.slice?c.slice():c],g.push(c),b||i()),this},fire:function(){return k.fireWith(this,arguments),this},fired:function(){return!!d}};return k},qa.extend({Deferred:function(a){var b=[["resolve","done",qa.Callbacks("once memory"),"resolved"],["reject","fail",qa.Callbacks("once memory"),"rejected"],["notify","progress",qa.Callbacks("memory")]],c="pending",d={state:function(){return c},always:function(){return e.done(arguments).fail(arguments),this},then:function(){var a=arguments;return qa.Deferred(function(c){qa.each(b,function(b,f){var g=qa.isFunction(a[b])&&a[b];e[f[1]](function(){var a=g&&g.apply(this,arguments);a&&qa.isFunction(a.promise)?a.promise().progress(c.notify).done(c.resolve).fail(c.reject):c[f[0]+"With"](this===d?c.promise():this,g?[a]:arguments)})}),a=null}).promise()},promise:function(a){return null!=a?qa.extend(a,d):d}},e={};return d.pipe=d.then,qa.each(b,function(a,f){var g=f[2],h=f[3];d[f[1]]=g.add,h&&g.add(function(){c=h},b[1^a][2].disable,b[2][2].lock),e[f[0]]=function(){return e[f[0]+"With"](this===e?d:this,arguments),this},e[f[0]+"With"]=g.fireWith}),d.promise(e),a&&a.call(e,e),e},when:function(a){var b,c,d,e=0,f=ia.call(arguments),g=f.length,h=1!==g||a&&qa.isFunction(a.promise)?g:0,i=1===h?a:qa.Deferred(),j=function(a,c,d){return function(e){c[a]=this,d[a]=arguments.length>1?ia.call(arguments):e,d===b?i.notifyWith(c,d):--h||i.resolveWith(c,d)}};if(g>1)for(b=new Array(g),c=new Array(g),d=new Array(g);e<g;e++)f[e]&&qa.isFunction(f[e].promise)?f[e].promise().progress(j(e,c,b)).done(j(e,d,f)).fail(i.reject):--h;return h||i.resolveWith(d,f),i.promise()}});var Ga;qa.fn.ready=function(a){return qa.ready.promise().done(a),this},qa.extend({isReady:!1,readyWait:1,holdReady:function(a){a?qa.readyWait++:qa.ready(!0)},ready:function(a){(!0===a?--qa.readyWait:qa.isReady)||(qa.isReady=!0,!0!==a&&--qa.readyWait>0||(Ga.resolveWith(ha,[qa]),qa.fn.triggerHandler&&(qa(ha).triggerHandler("ready"),qa(ha).off("ready"))))}}),qa.ready.promise=function(a){if(!Ga)if(Ga=qa.Deferred(),"complete"===ha.readyState||"loading"!==ha.readyState&&!ha.documentElement.doScroll)c.setTimeout(qa.ready);else if(ha.addEventListener)ha.addEventListener("DOMContentLoaded",l),c.addEventListener("load",l);else{ha.attachEvent("onreadystatechange",l),c.attachEvent("onload",l);var b=!1;try{b=null==c.frameElement&&ha.documentElement}catch(d){}b&&b.doScroll&&function e(){if(!qa.isReady){try{b.doScroll("left")}catch(a){return c.setTimeout(e,50)}k(),qa.ready()}}()}return Ga.promise(a)},qa.ready.promise();var Ha;for(Ha in qa(pa))break;pa.ownFirst="0"===Ha,pa.inlineBlockNeedsLayout=!1,qa(function(){var a,b,c,d;(c=ha.getElementsByTagName("body")[0])&&c.style&&(b=ha.createElement("div"),d=ha.createElement("div"),d.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",c.appendChild(d).appendChild(b),void 0!==b.style.zoom&&(b.style.cssText="display:inline;margin:0;border:0;padding:1px;width:1px;zoom:1",pa.inlineBlockNeedsLayout=a=3===b.offsetWidth,a&&(c.style.zoom=1)),c.removeChild(d))}),function(){var a=ha.createElement("div");pa.deleteExpando=!0;try{delete a.test}catch(b){pa.deleteExpando=!1}a=null}();var Ia=function(a){var b=qa.noData[(a.nodeName+" ").toLowerCase()],c=+a.nodeType||1;return(1===c||9===c)&&(!b||!0!==b&&a.getAttribute("classid")===b)},Ja=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Ka=/([A-Z])/g;qa.extend({cache:{},noData:{"applet ":!0,"embed ":!0,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(a){return!!(a=a.nodeType?qa.cache[a[qa.expando]]:a[qa.expando])&&!n(a)},data:function(a,b,c){return o(a,b,c)},removeData:function(a,b){return p(a,b)},_data:function(a,b,c){return o(a,b,c,!0)},_removeData:function(a,b){return p(a,b,!0)}}),qa.fn.extend({data:function(a,b){var c,d,e,f=this[0],g=f&&f.attributes;if(void 0===a){if(this.length&&(e=qa.data(f),1===f.nodeType&&!qa._data(f,"parsedAttrs"))){for(c=g.length;c--;)g[c]&&(d=g[c].name,0===d.indexOf("data-")&&(d=qa.camelCase(d.slice(5)),m(f,d,e[d])));qa._data(f,"parsedAttrs",!0)}return e}return"object"==typeof a?this.each(function(){qa.data(this,a)}):arguments.length>1?this.each(function(){qa.data(this,a,b)}):f?m(f,a,qa.data(f,a)):void 0},removeData:function(a){return this.each(function(){qa.removeData(this,a)})}}),qa.extend({queue:function(a,b,c){var d;if(a)return b=(b||"fx")+"queue",d=qa._data(a,b),c&&(!d||qa.isArray(c)?d=qa._data(a,b,qa.makeArray(c)):d.push(c)),d||[]},dequeue:function(a,b){b=b||"fx";var c=qa.queue(a,b),d=c.length,e=c.shift(),f=qa._queueHooks(a,b),g=function(){qa.dequeue(a,b)};"inprogress"===e&&(e=c.shift(),d--),e&&("fx"===b&&c.unshift("inprogress"),delete f.stop,e.call(a,g,f)),!d&&f&&f.empty.fire()},_queueHooks:function(a,b){var c=b+"queueHooks";return qa._data(a,c)||qa._data(a,c,{empty:qa.Callbacks("once memory").add(function(){qa._removeData(a,b+"queue"),qa._removeData(a,c)})})}}),qa.fn.extend({queue:function(a,b){var c=2;return"string"!=typeof a&&(b=a,a="fx",c--),arguments.length<c?qa.queue(this[0],a):void 0===b?this:this.each(function(){var c=qa.queue(this,a,b);qa._queueHooks(this,a),"fx"===a&&"inprogress"!==c[0]&&qa.dequeue(this,a)})},dequeue:function(a){return this.each(function(){qa.dequeue(this,a)})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,b){var c,d=1,e=qa.Deferred(),f=this,g=this.length,h=function(){--d||e.resolveWith(f,[f])};for("string"!=typeof a&&(b=a,a=void 0),a=a||"fx";g--;)(c=qa._data(f[g],a+"queueHooks"))&&c.empty&&(d++,c.empty.add(h));return h(),e.promise(b)}}),function(){var a;pa.shrinkWrapBlocks=function(){if(null!=a)return a;a=!1;var b,c,d;return(c=ha.getElementsByTagName("body")[0])&&c.style?(b=ha.createElement("div"),d=ha.createElement("div"),d.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",c.appendChild(d).appendChild(b),void 0!==b.style.zoom&&(b.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:1px;width:1px;zoom:1",b.appendChild(ha.createElement("div")).style.width="5px",a=3!==b.offsetWidth),c.removeChild(d),a):void 0}}();var La=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Ma=new RegExp("^(?:([+-])=|)("+La+")([a-z%]*)$","i"),Na=["Top","Right","Bottom","Left"],Oa=function(a,b){return a=b||a,"none"===qa.css(a,"display")||!qa.contains(a.ownerDocument,a)},Pa=function(a,b,c,d,e,f,g){var h=0,i=a.length,j=null==c;if("object"===qa.type(c)){e=!0;for(h in c)Pa(a,b,h,c[h],!0,f,g)}else if(void 0!==d&&(e=!0,qa.isFunction(d)||(g=!0),j&&(g?(b.call(a,d),b=null):(j=b,b=function(a,b,c){return j.call(qa(a),c)})),b))for(;h<i;h++)b(a[h],c,g?d:d.call(a[h],h,b(a[h],c)));return e?a:j?b.call(a):i?b(a[0],c):f},Qa=/^(?:checkbox|radio)$/i,Ra=/<([\w:-]+)/,Sa=/^$|\/(?:java|ecma)script/i,Ta=/^\s+/,Ua="abbr|article|aside|audio|bdi|canvas|data|datalist|details|dialog|figcaption|figure|footer|header|hgroup|main|mark|meter|nav|output|picture|progress|section|summary|template|time|video";!function(){var a=ha.createElement("div"),b=ha.createDocumentFragment(),c=ha.createElement("input");a.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",pa.leadingWhitespace=3===a.firstChild.nodeType,pa.tbody=!a.getElementsByTagName("tbody").length,pa.htmlSerialize=!!a.getElementsByTagName("link").length,pa.html5Clone="<:nav></:nav>"!==ha.createElement("nav").cloneNode(!0).outerHTML,c.type="checkbox",c.checked=!0,b.appendChild(c),pa.appendChecked=c.checked,a.innerHTML="<textarea>x</textarea>",pa.noCloneChecked=!!a.cloneNode(!0).lastChild.defaultValue,b.appendChild(a),c=ha.createElement("input"),c.setAttribute("type","radio"),c.setAttribute("checked","checked"),c.setAttribute("name","t"),a.appendChild(c),pa.checkClone=a.cloneNode(!0).cloneNode(!0).lastChild.checked,pa.noCloneEvent=!!a.addEventListener,a[qa.expando]=1,pa.attributes=!a.getAttribute(qa.expando)}();var Va={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:pa.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]};Va.optgroup=Va.option,Va.tbody=Va.tfoot=Va.colgroup=Va.caption=Va.thead,Va.th=Va.td;var Wa=/<|&#?\w+;/,Xa=/<tbody/i;!function(){var a,b,d=ha.createElement("div");for(a in{submit:!0,change:!0,focusin:!0})b="on"+a,(pa[a]=b in c)||(d.setAttribute(b,"t"),pa[a]=!1===d.attributes[b].expando);d=null}();var Ya=/^(?:input|select|textarea)$/i,Za=/^key/,$a=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,_a=/^(?:focusinfocus|focusoutblur)$/,ab=/^([^.]*)(?:\.(.+)|)/;qa.event={global:{},add:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q=qa._data(a);if(q){for(c.handler&&(i=c,c=i.handler,e=i.selector),c.guid||(c.guid=qa.guid++),(g=q.events)||(g=q.events={}),(k=q.handle)||(k=q.handle=function(a){return void 0===qa||a&&qa.event.triggered===a.type?void 0:qa.event.dispatch.apply(k.elem,arguments)},k.elem=a),b=(b||"").match(Fa)||[""],h=b.length;h--;)f=ab.exec(b[h])||[],n=p=f[1],o=(f[2]||"").split(".").sort(),n&&(j=qa.event.special[n]||{},n=(e?j.delegateType:j.bindType)||n,j=qa.event.special[n]||{},l=qa.extend({type:n,origType:p,data:d,handler:c,guid:c.guid,selector:e,needsContext:e&&qa.expr.match.needsContext.test(e),namespace:o.join(".")},i),(m=g[n])||(m=g[n]=[],m.delegateCount=0,j.setup&&!1!==j.setup.call(a,d,o,k)||(a.addEventListener?a.addEventListener(n,k,!1):a.attachEvent&&a.attachEvent("on"+n,k))),j.add&&(j.add.call(a,l),l.handler.guid||(l.handler.guid=c.guid)),e?m.splice(m.delegateCount++,0,l):m.push(l),qa.event.global[n]=!0);a=null}},remove:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q=qa.hasData(a)&&qa._data(a);if(q&&(k=q.events)){for(b=(b||"").match(Fa)||[""],j=b.length;j--;)if(h=ab.exec(b[j])||[],n=p=h[1],o=(h[2]||"").split(".").sort(),n){for(l=qa.event.special[n]||{},n=(d?l.delegateType:l.bindType)||n,m=k[n]||[],h=h[2]&&new RegExp("(^|\\.)"+o.join("\\.(?:.*\\.|)")+"(\\.|$)"),i=f=m.length;f--;)g=m[f],!e&&p!==g.origType||c&&c.guid!==g.guid||h&&!h.test(g.namespace)||d&&d!==g.selector&&("**"!==d||!g.selector)||(m.splice(f,1),g.selector&&m.delegateCount--,l.remove&&l.remove.call(a,g));i&&!m.length&&(l.teardown&&!1!==l.teardown.call(a,o,q.handle)||qa.removeEvent(a,n,q.handle),delete k[n])}else for(n in k)qa.event.remove(a,n+b[j],c,d,!0);qa.isEmptyObject(k)&&(delete q.handle,qa._removeData(a,"events"))}},trigger:function(a,b,d,e){var f,g,h,i,j,k,l,m=[d||ha],n=oa.call(a,"type")?a.type:a,o=oa.call(a,"namespace")?a.namespace.split("."):[];if(h=k=d=d||ha,3!==d.nodeType&&8!==d.nodeType&&!_a.test(n+qa.event.triggered)&&(n.indexOf(".")>-1&&(o=n.split("."),n=o.shift(),o.sort()),g=n.indexOf(":")<0&&"on"+n,a=a[qa.expando]?a:new qa.Event(n,"object"==typeof a&&a),a.isTrigger=e?2:3,a.namespace=o.join("."),a.rnamespace=a.namespace?new RegExp("(^|\\.)"+o.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,a.result=void 0,a.target||(a.target=d),b=null==b?[a]:qa.makeArray(b,[a]),j=qa.event.special[n]||{},e||!j.trigger||!1!==j.trigger.apply(d,b))){if(!e&&!j.noBubble&&!qa.isWindow(d)){for(i=j.delegateType||n,_a.test(i+n)||(h=h.parentNode);h;h=h.parentNode)m.push(h),k=h;k===(d.ownerDocument||ha)&&m.push(k.defaultView||k.parentWindow||c)}for(l=0;(h=m[l++])&&!a.isPropagationStopped();)a.type=l>1?i:j.bindType||n,f=(qa._data(h,"events")||{})[a.type]&&qa._data(h,"handle"),f&&f.apply(h,b),(f=g&&h[g])&&f.apply&&Ia(h)&&(a.result=f.apply(h,b),!1===a.result&&a.preventDefault());if(a.type=n,!e&&!a.isDefaultPrevented()&&(!j._default||!1===j._default.apply(m.pop(),b))&&Ia(d)&&g&&d[n]&&!qa.isWindow(d)){k=d[g],k&&(d[g]=null),qa.event.triggered=n;try{d[n]()}catch(p){}qa.event.triggered=void 0,k&&(d[g]=k)}return a.result}},dispatch:function(a){a=qa.event.fix(a);var b,c,d,e,f,g=[],h=ia.call(arguments),i=(qa._data(this,"events")||{})[a.type]||[],j=qa.event.special[a.type]||{};if(h[0]=a,a.delegateTarget=this,!j.preDispatch||!1!==j.preDispatch.call(this,a)){for(g=qa.event.handlers.call(this,a,i),b=0;(e=g[b++])&&!a.isPropagationStopped();)for(a.currentTarget=e.elem,c=0;(f=e.handlers[c++])&&!a.isImmediatePropagationStopped();)a.rnamespace&&!a.rnamespace.test(f.namespace)||(a.handleObj=f,a.data=f.data,void 0!==(d=((qa.event.special[f.origType]||{}).handle||f.handler).apply(e.elem,h))&&!1===(a.result=d)&&(a.preventDefault(),a.stopPropagation()));return j.postDispatch&&j.postDispatch.call(this,a),a.result}},handlers:function(a,b){var c,d,e,f,g=[],h=b.delegateCount,i=a.target;if(h&&i.nodeType&&("click"!==a.type||isNaN(a.button)||a.button<1))for(;i!=this;i=i.parentNode||this)if(1===i.nodeType&&(!0!==i.disabled||"click"!==a.type)){for(d=[],c=0;c<h;c++)f=b[c],e=f.selector+" ",void 0===d[e]&&(d[e]=f.needsContext?qa(e,this).index(i)>-1:qa.find(e,this,null,[i]).length),d[e]&&d.push(f);d.length&&g.push({elem:i,handlers:d})}return h<b.length&&g.push({elem:this,handlers:b.slice(h)}),g},fix:function(a){if(a[qa.expando])return a;var b,c,d,e=a.type,f=a,g=this.fixHooks[e];for(g||(this.fixHooks[e]=g=$a.test(e)?this.mouseHooks:Za.test(e)?this.keyHooks:{}),d=g.props?this.props.concat(g.props):this.props,a=new qa.Event(f),b=d.length;b--;)c=d[b],a[c]=f[c];return a.target||(a.target=f.srcElement||ha),3===a.target.nodeType&&(a.target=a.target.parentNode),a.metaKey=!!a.metaKey,g.filter?g.filter(a,f):a},props:"altKey bubbles cancelable ctrlKey currentTarget detail eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){return null==a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode),a}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,b){var c,d,e,f=b.button,g=b.fromElement;return null==a.pageX&&null!=b.clientX&&(d=a.target.ownerDocument||ha,e=d.documentElement,c=d.body,a.pageX=b.clientX+(e&&e.scrollLeft||c&&c.scrollLeft||0)-(e&&e.clientLeft||c&&c.clientLeft||0),a.pageY=b.clientY+(e&&e.scrollTop||c&&c.scrollTop||0)-(e&&e.clientTop||c&&c.clientTop||0)),!a.relatedTarget&&g&&(a.relatedTarget=g===a.target?b.toElement:g),a.which||void 0===f||(a.which=1&f?1:2&f?3:4&f?2:0),a}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==y()&&this.focus)try{return this.focus(),!1}catch(a){}},delegateType:"focusin"},blur:{trigger:function(){if(this===y()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if(qa.nodeName(this,"input")&&"checkbox"===this.type&&this.click)return this.click(),!1},_default:function(a){return qa.nodeName(a.target,"a")}},beforeunload:{postDispatch:function(a){void 0!==a.result&&a.originalEvent&&(a.originalEvent.returnValue=a.result)}}},simulate:function(a,b,c){var d=qa.extend(new qa.Event,c,{type:a,isSimulated:!0});qa.event.trigger(d,null,b),d.isDefaultPrevented()&&c.preventDefault()}},qa.removeEvent=ha.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c)}:function(a,b,c){var d="on"+b;a.detachEvent&&(void 0===a[d]&&(a[d]=null),a.detachEvent(d,c))},qa.Event=function(a,b){if(!(this instanceof qa.Event))return new qa.Event(a,b);a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&!1===a.returnValue?w:x):this.type=a,b&&qa.extend(this,b),this.timeStamp=a&&a.timeStamp||qa.now(),this[qa.expando]=!0},qa.Event.prototype={constructor:qa.Event,isDefaultPrevented:x,isPropagationStopped:x,isImmediatePropagationStopped:x,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=w,a&&(a.preventDefault?a.preventDefault():a.returnValue=!1)},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=w,a&&!this.isSimulated&&(a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0)},stopImmediatePropagation:function(){var a=this.originalEvent;this.isImmediatePropagationStopped=w,a&&a.stopImmediatePropagation&&a.stopImmediatePropagation(),this.stopPropagation()}},qa.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(a,b){qa.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=this,e=a.relatedTarget,f=a.handleObj;return e&&(e===d||qa.contains(d,e))||(a.type=f.origType,c=f.handler.apply(this,arguments),a.type=b),c}}}),pa.submit||(qa.event.special.submit={setup:function(){if(qa.nodeName(this,"form"))return!1;qa.event.add(this,"click._submit keypress._submit",function(a){var b=a.target,c=qa.nodeName(b,"input")||qa.nodeName(b,"button")?qa.prop(b,"form"):void 0;c&&!qa._data(c,"submit")&&(qa.event.add(c,"submit._submit",function(a){a._submitBubble=!0}),qa._data(c,"submit",!0))})},postDispatch:function(a){a._submitBubble&&(delete a._submitBubble,this.parentNode&&!a.isTrigger&&qa.event.simulate("submit",this.parentNode,a))},teardown:function(){if(qa.nodeName(this,"form"))return!1;qa.event.remove(this,"._submit")}}),pa.change||(qa.event.special.change={setup:function(){if(Ya.test(this.nodeName))return"checkbox"!==this.type&&"radio"!==this.type||(qa.event.add(this,"propertychange._change",function(a){"checked"===a.originalEvent.propertyName&&(this._justChanged=!0)}),qa.event.add(this,"click._change",function(a){this._justChanged&&!a.isTrigger&&(this._justChanged=!1),qa.event.simulate("change",this,a)})),!1;qa.event.add(this,"beforeactivate._change",function(a){var b=a.target;Ya.test(b.nodeName)&&!qa._data(b,"change")&&(qa.event.add(b,"change._change",function(a){!this.parentNode||a.isSimulated||a.isTrigger||qa.event.simulate("change",this.parentNode,a)}),qa._data(b,"change",!0))})},handle:function(a){var b=a.target;if(this!==b||a.isSimulated||a.isTrigger||"radio"!==b.type&&"checkbox"!==b.type)return a.handleObj.handler.apply(this,arguments)},teardown:function(){return qa.event.remove(this,"._change"),!Ya.test(this.nodeName)}}),pa.focusin||qa.each({focus:"focusin",blur:"focusout"},function(a,b){var c=function(a){qa.event.simulate(b,a.target,qa.event.fix(a))};qa.event.special[b]={setup:function(){var d=this.ownerDocument||this,e=qa._data(d,b);e||d.addEventListener(a,c,!0),qa._data(d,b,(e||0)+1)},teardown:function(){var d=this.ownerDocument||this,e=qa._data(d,b)-1;e?qa._data(d,b,e):(d.removeEventListener(a,c,!0),qa._removeData(d,b))}}}),qa.fn.extend({on:function(a,b,c,d){return z(this,a,b,c,d)},one:function(a,b,c,d){return z(this,a,b,c,d,1)},off:function(a,b,c){var d,e;if(a&&a.preventDefault&&a.handleObj)return d=a.handleObj,qa(a.delegateTarget).off(d.namespace?d.origType+"."+d.namespace:d.origType,d.selector,d.handler),this;if("object"==typeof a){for(e in a)this.off(e,b,a[e]);return this}return!1!==b&&"function"!=typeof b||(c=b,b=void 0),!1===c&&(c=x),this.each(function(){qa.event.remove(this,a,c,b)})},trigger:function(a,b){return this.each(function(){qa.event.trigger(a,b,this)})},triggerHandler:function(a,b){var c=this[0];if(c)return qa.event.trigger(a,b,c,!0)}});var bb=/ jQuery\d+="(?:null|\d+)"/g,cb=new RegExp("<(?:"+Ua+")[\\s/>]","i"),db=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,eb=/<script|<style|<link/i,fb=/checked\s*(?:[^=]|=\s*.checked.)/i,gb=/^true\/(.*)/,hb=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,ib=r(ha),jb=ib.appendChild(ha.createElement("div"));qa.extend({htmlPrefilter:function(a){return a.replace(db,"<$1></$2>")},clone:function(a,b,c){var d,e,f,g,h,i=qa.contains(a.ownerDocument,a);if(pa.html5Clone||qa.isXMLDoc(a)||!cb.test("<"+a.nodeName+">")?f=a.cloneNode(!0):(jb.innerHTML=a.outerHTML,
jb.removeChild(f=jb.firstChild)),!(pa.noCloneEvent&&pa.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||qa.isXMLDoc(a)))for(d=s(f),h=s(a),g=0;null!=(e=h[g]);++g)d[g]&&E(e,d[g]);if(b)if(c)for(h=h||s(a),d=d||s(f),g=0;null!=(e=h[g]);g++)D(e,d[g]);else D(a,f);return d=s(f,"script"),d.length>0&&t(d,!i&&s(a,"script")),d=h=e=null,f},cleanData:function(a,b){for(var c,d,e,f,g=0,h=qa.expando,i=qa.cache,j=pa.attributes,k=qa.event.special;null!=(c=a[g]);g++)if((b||Ia(c))&&(e=c[h],f=e&&i[e])){if(f.events)for(d in f.events)k[d]?qa.event.remove(c,d):qa.removeEvent(c,d,f.handle);i[e]&&(delete i[e],j||void 0===c.removeAttribute?c[h]=void 0:c.removeAttribute(h),ga.push(e))}}}),qa.fn.extend({domManip:F,detach:function(a){return G(this,a,!0)},remove:function(a){return G(this,a)},text:function(a){return Pa(this,function(a){return void 0===a?qa.text(this):this.empty().append((this[0]&&this[0].ownerDocument||ha).createTextNode(a))},null,a,arguments.length)},append:function(){return F(this,arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){A(this,a).appendChild(a)}})},prepend:function(){return F(this,arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=A(this,a);b.insertBefore(a,b.firstChild)}})},before:function(){return F(this,arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this)})},after:function(){return F(this,arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)})},empty:function(){for(var a,b=0;null!=(a=this[b]);b++){for(1===a.nodeType&&qa.cleanData(s(a,!1));a.firstChild;)a.removeChild(a.firstChild);a.options&&qa.nodeName(a,"select")&&(a.options.length=0)}return this},clone:function(a,b){return a=null!=a&&a,b=null==b?a:b,this.map(function(){return qa.clone(this,a,b)})},html:function(a){return Pa(this,function(a){var b=this[0]||{},c=0,d=this.length;if(void 0===a)return 1===b.nodeType?b.innerHTML.replace(bb,""):void 0;if("string"==typeof a&&!eb.test(a)&&(pa.htmlSerialize||!cb.test(a))&&(pa.leadingWhitespace||!Ta.test(a))&&!Va[(Ra.exec(a)||["",""])[1].toLowerCase()]){a=qa.htmlPrefilter(a);try{for(;c<d;c++)b=this[c]||{},1===b.nodeType&&(qa.cleanData(s(b,!1)),b.innerHTML=a);b=0}catch(e){}}b&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(){var a=[];return F(this,arguments,function(b){var c=this.parentNode;qa.inArray(this,a)<0&&(qa.cleanData(s(this)),c&&c.replaceChild(b,this))},a)}}),qa.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){qa.fn[a]=function(a){for(var c,d=0,e=[],f=qa(a),g=f.length-1;d<=g;d++)c=d===g?this:this.clone(!0),qa(f[d])[b](c),ka.apply(e,c.get());return this.pushStack(e)}});var kb,lb={HTML:"block",BODY:"block"},mb=/^margin/,nb=new RegExp("^("+La+")(?!px)[a-z%]+$","i"),ob=function(a,b,c,d){var e,f,g={};for(f in b)g[f]=a.style[f],a.style[f]=b[f];e=c.apply(a,d||[]);for(f in b)a.style[f]=g[f];return e},pb=ha.documentElement;!function(){function a(){var a,k,l=ha.documentElement;l.appendChild(i),j.style.cssText="-webkit-box-sizing:border-box;box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",b=e=h=!1,d=g=!0,c.getComputedStyle&&(k=c.getComputedStyle(j),b="1%"!==(k||{}).top,h="2px"===(k||{}).marginLeft,e="4px"===(k||{width:"4px"}).width,j.style.marginRight="50%",d="4px"===(k||{marginRight:"4px"}).marginRight,a=j.appendChild(ha.createElement("div")),a.style.cssText=j.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",a.style.marginRight=a.style.width="0",j.style.width="1px",g=!parseFloat((c.getComputedStyle(a)||{}).marginRight),j.removeChild(a)),j.style.display="none",f=0===j.getClientRects().length,f&&(j.style.display="",j.innerHTML="<table><tr><td></td><td>t</td></tr></table>",j.childNodes[0].style.borderCollapse="separate",a=j.getElementsByTagName("td"),a[0].style.cssText="margin:0;border:0;padding:0;display:none",(f=0===a[0].offsetHeight)&&(a[0].style.display="",a[1].style.display="none",f=0===a[0].offsetHeight)),l.removeChild(i)}var b,d,e,f,g,h,i=ha.createElement("div"),j=ha.createElement("div");j.style&&(j.style.cssText="float:left;opacity:.5",pa.opacity="0.5"===j.style.opacity,pa.cssFloat=!!j.style.cssFloat,j.style.backgroundClip="content-box",j.cloneNode(!0).style.backgroundClip="",pa.clearCloneStyle="content-box"===j.style.backgroundClip,i=ha.createElement("div"),i.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",j.innerHTML="",i.appendChild(j),pa.boxSizing=""===j.style.boxSizing||""===j.style.MozBoxSizing||""===j.style.WebkitBoxSizing,qa.extend(pa,{reliableHiddenOffsets:function(){return null==b&&a(),f},boxSizingReliable:function(){return null==b&&a(),e},pixelMarginRight:function(){return null==b&&a(),d},pixelPosition:function(){return null==b&&a(),b},reliableMarginRight:function(){return null==b&&a(),g},reliableMarginLeft:function(){return null==b&&a(),h}}))}();var qb,rb,sb=/^(top|right|bottom|left)$/;c.getComputedStyle?(qb=function(a){var b=a.ownerDocument.defaultView;return b&&b.opener||(b=c),b.getComputedStyle(a)},rb=function(a,b,c){var d,e,f,g,h=a.style;return c=c||qb(a),g=c?c.getPropertyValue(b)||c[b]:void 0,""!==g&&void 0!==g||qa.contains(a.ownerDocument,a)||(g=qa.style(a,b)),c&&!pa.pixelMarginRight()&&nb.test(g)&&mb.test(b)&&(d=h.width,e=h.minWidth,f=h.maxWidth,h.minWidth=h.maxWidth=h.width=g,g=c.width,h.width=d,h.minWidth=e,h.maxWidth=f),void 0===g?g:g+""}):pb.currentStyle&&(qb=function(a){return a.currentStyle},rb=function(a,b,c){var d,e,f,g,h=a.style;return c=c||qb(a),g=c?c[b]:void 0,null==g&&h&&h[b]&&(g=h[b]),nb.test(g)&&!sb.test(b)&&(d=h.left,e=a.runtimeStyle,f=e&&e.left,f&&(e.left=a.currentStyle.left),h.left="fontSize"===b?"1em":g,g=h.pixelLeft+"px",h.left=d,f&&(e.left=f)),void 0===g?g:g+""||"auto"});var tb=/alpha\([^)]*\)/i,ub=/opacity\s*=\s*([^)]*)/i,vb=/^(none|table(?!-c[ea]).+)/,wb=new RegExp("^("+La+")(.*)$","i"),xb={position:"absolute",visibility:"hidden",display:"block"},yb={letterSpacing:"0",fontWeight:"400"},zb=["Webkit","O","Moz","ms"],Ab=ha.createElement("div").style;qa.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=rb(a,"opacity");return""===c?"1":c}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":pa.cssFloat?"cssFloat":"styleFloat"},style:function(a,b,c,d){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var e,f,g,h=qa.camelCase(b),i=a.style;if(b=qa.cssProps[h]||(qa.cssProps[h]=K(h)||h),g=qa.cssHooks[b]||qa.cssHooks[h],void 0===c)return g&&"get"in g&&void 0!==(e=g.get(a,!1,d))?e:i[b];if(f=typeof c,"string"===f&&(e=Ma.exec(c))&&e[1]&&(c=q(a,b,e),f="number"),null!=c&&c===c&&("number"===f&&(c+=e&&e[3]||(qa.cssNumber[h]?"":"px")),pa.clearCloneStyle||""!==c||0!==b.indexOf("background")||(i[b]="inherit"),!(g&&"set"in g&&void 0===(c=g.set(a,c,d)))))try{i[b]=c}catch(j){}}},css:function(a,b,c,d){var e,f,g,h=qa.camelCase(b);return b=qa.cssProps[h]||(qa.cssProps[h]=K(h)||h),g=qa.cssHooks[b]||qa.cssHooks[h],g&&"get"in g&&(f=g.get(a,!0,c)),void 0===f&&(f=rb(a,b,d)),"normal"===f&&b in yb&&(f=yb[b]),""===c||c?(e=parseFloat(f),!0===c||isFinite(e)?e||0:f):f}}),qa.each(["height","width"],function(a,b){qa.cssHooks[b]={get:function(a,c,d){if(c)return vb.test(qa.css(a,"display"))&&0===a.offsetWidth?ob(a,xb,function(){return O(a,b,d)}):O(a,b,d)},set:function(a,c,d){var e=d&&qb(a);return M(a,c,d?N(a,b,d,pa.boxSizing&&"border-box"===qa.css(a,"boxSizing",!1,e),e):0)}}}),pa.opacity||(qa.cssHooks.opacity={get:function(a,b){return ub.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":b?"1":""},set:function(a,b){var c=a.style,d=a.currentStyle,e=qa.isNumeric(b)?"alpha(opacity="+100*b+")":"",f=d&&d.filter||c.filter||"";c.zoom=1,(b>=1||""===b)&&""===qa.trim(f.replace(tb,""))&&c.removeAttribute&&(c.removeAttribute("filter"),""===b||d&&!d.filter)||(c.filter=tb.test(f)?f.replace(tb,e):f+" "+e)}}),qa.cssHooks.marginRight=J(pa.reliableMarginRight,function(a,b){if(b)return ob(a,{display:"inline-block"},rb,[a,"marginRight"])}),qa.cssHooks.marginLeft=J(pa.reliableMarginLeft,function(a,b){if(b)return(parseFloat(rb(a,"marginLeft"))||(qa.contains(a.ownerDocument,a)?a.getBoundingClientRect().left-ob(a,{marginLeft:0},function(){return a.getBoundingClientRect().left}):0))+"px"}),qa.each({margin:"",padding:"",border:"Width"},function(a,b){qa.cssHooks[a+b]={expand:function(c){for(var d=0,e={},f="string"==typeof c?c.split(" "):[c];d<4;d++)e[a+Na[d]+b]=f[d]||f[d-2]||f[0];return e}},mb.test(a)||(qa.cssHooks[a+b].set=M)}),qa.fn.extend({css:function(a,b){return Pa(this,function(a,b,c){var d,e,f={},g=0;if(qa.isArray(b)){for(d=qb(a),e=b.length;g<e;g++)f[b[g]]=qa.css(a,b[g],!1,d);return f}return void 0!==c?qa.style(a,b,c):qa.css(a,b)},a,b,arguments.length>1)},show:function(){return L(this,!0)},hide:function(){return L(this)},toggle:function(a){return"boolean"==typeof a?a?this.show():this.hide():this.each(function(){Oa(this)?qa(this).show():qa(this).hide()})}}),qa.Tween=P,P.prototype={constructor:P,init:function(a,b,c,d,e,f){this.elem=a,this.prop=c,this.easing=e||qa.easing._default,this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||(qa.cssNumber[c]?"":"px")},cur:function(){var a=P.propHooks[this.prop];return a&&a.get?a.get(this):P.propHooks._default.get(this)},run:function(a){var b,c=P.propHooks[this.prop];return this.options.duration?this.pos=b=qa.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):this.pos=b=a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):P.propHooks._default.set(this),this}},P.prototype.init.prototype=P.prototype,P.propHooks={_default:{get:function(a){var b;return 1!==a.elem.nodeType||null!=a.elem[a.prop]&&null==a.elem.style[a.prop]?a.elem[a.prop]:(b=qa.css(a.elem,a.prop,""),b&&"auto"!==b?b:0)},set:function(a){qa.fx.step[a.prop]?qa.fx.step[a.prop](a):1!==a.elem.nodeType||null==a.elem.style[qa.cssProps[a.prop]]&&!qa.cssHooks[a.prop]?a.elem[a.prop]=a.now:qa.style(a.elem,a.prop,a.now+a.unit)}}},P.propHooks.scrollTop=P.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}},qa.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2},_default:"swing"},qa.fx=P.prototype.init,qa.fx.step={};var Bb,Cb,Db=/^(?:toggle|show|hide)$/,Eb=/queueHooks$/;qa.Animation=qa.extend(V,{tweeners:{"*":[function(a,b){var c=this.createTween(a,b);return q(c.elem,a,Ma.exec(b),c),c}]},tweener:function(a,b){qa.isFunction(a)?(b=a,a=["*"]):a=a.match(Fa);for(var c,d=0,e=a.length;d<e;d++)c=a[d],V.tweeners[c]=V.tweeners[c]||[],V.tweeners[c].unshift(b)},prefilters:[T],prefilter:function(a,b){b?V.prefilters.unshift(a):V.prefilters.push(a)}}),qa.speed=function(a,b,c){var d=a&&"object"==typeof a?qa.extend({},a):{complete:c||!c&&b||qa.isFunction(a)&&a,duration:a,easing:c&&b||b&&!qa.isFunction(b)&&b};return d.duration=qa.fx.off?0:"number"==typeof d.duration?d.duration:d.duration in qa.fx.speeds?qa.fx.speeds[d.duration]:qa.fx.speeds._default,null!=d.queue&&!0!==d.queue||(d.queue="fx"),d.old=d.complete,d.complete=function(){qa.isFunction(d.old)&&d.old.call(this),d.queue&&qa.dequeue(this,d.queue)},d},qa.fn.extend({fadeTo:function(a,b,c,d){return this.filter(Oa).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=qa.isEmptyObject(a),f=qa.speed(b,c,d),g=function(){var b=V(this,qa.extend({},a),f);(e||qa._data(this,"finish"))&&b.stop(!0)};return g.finish=g,e||!1===f.queue?this.each(g):this.queue(f.queue,g)},stop:function(a,b,c){var d=function(a){var b=a.stop;delete a.stop,b(c)};return"string"!=typeof a&&(c=b,b=a,a=void 0),b&&!1!==a&&this.queue(a||"fx",[]),this.each(function(){var b=!0,e=null!=a&&a+"queueHooks",f=qa.timers,g=qa._data(this);if(e)g[e]&&g[e].stop&&d(g[e]);else for(e in g)g[e]&&g[e].stop&&Eb.test(e)&&d(g[e]);for(e=f.length;e--;)f[e].elem!==this||null!=a&&f[e].queue!==a||(f[e].anim.stop(c),b=!1,f.splice(e,1));!b&&c||qa.dequeue(this,a)})},finish:function(a){return!1!==a&&(a=a||"fx"),this.each(function(){var b,c=qa._data(this),d=c[a+"queue"],e=c[a+"queueHooks"],f=qa.timers,g=d?d.length:0;for(c.finish=!0,qa.queue(this,a,[]),e&&e.stop&&e.stop.call(this,!0),b=f.length;b--;)f[b].elem===this&&f[b].queue===a&&(f[b].anim.stop(!0),f.splice(b,1));for(b=0;b<g;b++)d[b]&&d[b].finish&&d[b].finish.call(this);delete c.finish})}}),qa.each(["toggle","show","hide"],function(a,b){var c=qa.fn[b];qa.fn[b]=function(a,d,e){return null==a||"boolean"==typeof a?c.apply(this,arguments):this.animate(R(b,!0),a,d,e)}}),qa.each({slideDown:R("show"),slideUp:R("hide"),slideToggle:R("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){qa.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),qa.timers=[],qa.fx.tick=function(){var a,b=qa.timers,c=0;for(Bb=qa.now();c<b.length;c++)(a=b[c])()||b[c]!==a||b.splice(c--,1);b.length||qa.fx.stop(),Bb=void 0},qa.fx.timer=function(a){qa.timers.push(a),a()?qa.fx.start():qa.timers.pop()},qa.fx.interval=13,qa.fx.start=function(){Cb||(Cb=c.setInterval(qa.fx.tick,qa.fx.interval))},qa.fx.stop=function(){c.clearInterval(Cb),Cb=null},qa.fx.speeds={slow:600,fast:200,_default:400},qa.fn.delay=function(a,b){return a=qa.fx?qa.fx.speeds[a]||a:a,b=b||"fx",this.queue(b,function(b,d){var e=c.setTimeout(b,a);d.stop=function(){c.clearTimeout(e)}})},function(){var a,b=ha.createElement("input"),c=ha.createElement("div"),d=ha.createElement("select"),e=d.appendChild(ha.createElement("option"));c=ha.createElement("div"),c.setAttribute("className","t"),c.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",a=c.getElementsByTagName("a")[0],b.setAttribute("type","checkbox"),c.appendChild(b),a=c.getElementsByTagName("a")[0],a.style.cssText="top:1px",pa.getSetAttribute="t"!==c.className,pa.style=/top/.test(a.getAttribute("style")),pa.hrefNormalized="/a"===a.getAttribute("href"),pa.checkOn=!!b.value,pa.optSelected=e.selected,pa.enctype=!!ha.createElement("form").enctype,d.disabled=!0,pa.optDisabled=!e.disabled,b=ha.createElement("input"),b.setAttribute("value",""),pa.input=""===b.getAttribute("value"),b.value="t",b.setAttribute("type","radio"),pa.radioValue="t"===b.value}();var Fb=/\r/g,Gb=/[\x20\t\r\n\f]+/g;qa.fn.extend({val:function(a){var b,c,d,e=this[0];{if(arguments.length)return d=qa.isFunction(a),this.each(function(c){var e;1===this.nodeType&&(e=d?a.call(this,c,qa(this).val()):a,null==e?e="":"number"==typeof e?e+="":qa.isArray(e)&&(e=qa.map(e,function(a){return null==a?"":a+""})),(b=qa.valHooks[this.type]||qa.valHooks[this.nodeName.toLowerCase()])&&"set"in b&&void 0!==b.set(this,e,"value")||(this.value=e))});if(e)return(b=qa.valHooks[e.type]||qa.valHooks[e.nodeName.toLowerCase()])&&"get"in b&&void 0!==(c=b.get(e,"value"))?c:(c=e.value,"string"==typeof c?c.replace(Fb,""):null==c?"":c)}}}),qa.extend({valHooks:{option:{get:function(a){var b=qa.find.attr(a,"value");return null!=b?b:qa.trim(qa.text(a)).replace(Gb," ")}},select:{get:function(a){for(var b,c,d=a.options,e=a.selectedIndex,f="select-one"===a.type||e<0,g=f?null:[],h=f?e+1:d.length,i=e<0?h:f?e:0;i<h;i++)if(c=d[i],(c.selected||i===e)&&(pa.optDisabled?!c.disabled:null===c.getAttribute("disabled"))&&(!c.parentNode.disabled||!qa.nodeName(c.parentNode,"optgroup"))){if(b=qa(c).val(),f)return b;g.push(b)}return g},set:function(a,b){for(var c,d,e=a.options,f=qa.makeArray(b),g=e.length;g--;)if(d=e[g],qa.inArray(qa.valHooks.option.get(d),f)>-1)try{d.selected=c=!0}catch(h){d.scrollHeight}else d.selected=!1;return c||(a.selectedIndex=-1),e}}}}),qa.each(["radio","checkbox"],function(){qa.valHooks[this]={set:function(a,b){if(qa.isArray(b))return a.checked=qa.inArray(qa(a).val(),b)>-1}},pa.checkOn||(qa.valHooks[this].get=function(a){return null===a.getAttribute("value")?"on":a.value})});var Hb,Ib,Jb=qa.expr.attrHandle,Kb=/^(?:checked|selected)$/i,Lb=pa.getSetAttribute,Mb=pa.input;qa.fn.extend({attr:function(a,b){return Pa(this,qa.attr,a,b,arguments.length>1)},removeAttr:function(a){return this.each(function(){qa.removeAttr(this,a)})}}),qa.extend({attr:function(a,b,c){var d,e,f=a.nodeType;if(3!==f&&8!==f&&2!==f)return void 0===a.getAttribute?qa.prop(a,b,c):(1===f&&qa.isXMLDoc(a)||(b=b.toLowerCase(),e=qa.attrHooks[b]||(qa.expr.match.bool.test(b)?Ib:Hb)),void 0!==c?null===c?void qa.removeAttr(a,b):e&&"set"in e&&void 0!==(d=e.set(a,c,b))?d:(a.setAttribute(b,c+""),c):e&&"get"in e&&null!==(d=e.get(a,b))?d:(d=qa.find.attr(a,b),null==d?void 0:d))},attrHooks:{type:{set:function(a,b){if(!pa.radioValue&&"radio"===b&&qa.nodeName(a,"input")){var c=a.value;return a.setAttribute("type",b),c&&(a.value=c),b}}}},removeAttr:function(a,b){var c,d,e=0,f=b&&b.match(Fa);if(f&&1===a.nodeType)for(;c=f[e++];)d=qa.propFix[c]||c,qa.expr.match.bool.test(c)?Mb&&Lb||!Kb.test(c)?a[d]=!1:a[qa.camelCase("default-"+c)]=a[d]=!1:qa.attr(a,c,""),a.removeAttribute(Lb?c:d)}}),Ib={set:function(a,b,c){return!1===b?qa.removeAttr(a,c):Mb&&Lb||!Kb.test(c)?a.setAttribute(!Lb&&qa.propFix[c]||c,c):a[qa.camelCase("default-"+c)]=a[c]=!0,c}},qa.each(qa.expr.match.bool.source.match(/\w+/g),function(a,b){var c=Jb[b]||qa.find.attr;Mb&&Lb||!Kb.test(b)?Jb[b]=function(a,b,d){var e,f;return d||(f=Jb[b],Jb[b]=e,e=null!=c(a,b,d)?b.toLowerCase():null,Jb[b]=f),e}:Jb[b]=function(a,b,c){if(!c)return a[qa.camelCase("default-"+b)]?b.toLowerCase():null}}),Mb&&Lb||(qa.attrHooks.value={set:function(a,b,c){if(!qa.nodeName(a,"input"))return Hb&&Hb.set(a,b,c);a.defaultValue=b}}),Lb||(Hb={set:function(a,b,c){var d=a.getAttributeNode(c);if(d||a.setAttributeNode(d=a.ownerDocument.createAttribute(c)),d.value=b+="","value"===c||b===a.getAttribute(c))return b}},Jb.id=Jb.name=Jb.coords=function(a,b,c){var d;if(!c)return(d=a.getAttributeNode(b))&&""!==d.value?d.value:null},qa.valHooks.button={get:function(a,b){var c=a.getAttributeNode(b);if(c&&c.specified)return c.value},set:Hb.set},qa.attrHooks.contenteditable={set:function(a,b,c){Hb.set(a,""!==b&&b,c)}},qa.each(["width","height"],function(a,b){qa.attrHooks[b]={set:function(a,c){if(""===c)return a.setAttribute(b,"auto"),c}}})),pa.style||(qa.attrHooks.style={get:function(a){return a.style.cssText||void 0},set:function(a,b){return a.style.cssText=b+""}});var Nb=/^(?:input|select|textarea|button|object)$/i,Ob=/^(?:a|area)$/i;qa.fn.extend({prop:function(a,b){return Pa(this,qa.prop,a,b,arguments.length>1)},removeProp:function(a){return a=qa.propFix[a]||a,this.each(function(){try{this[a]=void 0,delete this[a]}catch(b){}})}}),qa.extend({prop:function(a,b,c){var d,e,f=a.nodeType;if(3!==f&&8!==f&&2!==f)return 1===f&&qa.isXMLDoc(a)||(b=qa.propFix[b]||b,e=qa.propHooks[b]),void 0!==c?e&&"set"in e&&void 0!==(d=e.set(a,c,b))?d:a[b]=c:e&&"get"in e&&null!==(d=e.get(a,b))?d:a[b]},propHooks:{tabIndex:{get:function(a){var b=qa.find.attr(a,"tabindex");return b?parseInt(b,10):Nb.test(a.nodeName)||Ob.test(a.nodeName)&&a.href?0:-1}}},propFix:{"for":"htmlFor","class":"className"}}),pa.hrefNormalized||qa.each(["href","src"],function(a,b){qa.propHooks[b]={get:function(a){return a.getAttribute(b,4)}}}),pa.optSelected||(qa.propHooks.selected={get:function(a){var b=a.parentNode;return b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex),null},set:function(a){var b=a.parentNode;b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex)}}),qa.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){qa.propFix[this.toLowerCase()]=this}),pa.enctype||(qa.propFix.enctype="encoding");var Pb=/[\t\r\n\f]/g;qa.fn.extend({addClass:function(a){var b,c,d,e,f,g,h,i=0;if(qa.isFunction(a))return this.each(function(b){qa(this).addClass(a.call(this,b,W(this)))});if("string"==typeof a&&a)for(b=a.match(Fa)||[];c=this[i++];)if(e=W(c),d=1===c.nodeType&&(" "+e+" ").replace(Pb," ")){for(g=0;f=b[g++];)d.indexOf(" "+f+" ")<0&&(d+=f+" ");h=qa.trim(d),e!==h&&qa.attr(c,"class",h)}return this},removeClass:function(a){var b,c,d,e,f,g,h,i=0;if(qa.isFunction(a))return this.each(function(b){qa(this).removeClass(a.call(this,b,W(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof a&&a)for(b=a.match(Fa)||[];c=this[i++];)if(e=W(c),d=1===c.nodeType&&(" "+e+" ").replace(Pb," ")){for(g=0;f=b[g++];)for(;d.indexOf(" "+f+" ")>-1;)d=d.replace(" "+f+" "," ");h=qa.trim(d),e!==h&&qa.attr(c,"class",h)}return this},toggleClass:function(a,b){var c=typeof a;return"boolean"==typeof b&&"string"===c?b?this.addClass(a):this.removeClass(a):qa.isFunction(a)?this.each(function(c){qa(this).toggleClass(a.call(this,c,W(this),b),b)}):this.each(function(){var b,d,e,f;if("string"===c)for(d=0,e=qa(this),f=a.match(Fa)||[];b=f[d++];)e.hasClass(b)?e.removeClass(b):e.addClass(b);else void 0!==a&&"boolean"!==c||(b=W(this),b&&qa._data(this,"__className__",b),qa.attr(this,"class",b||!1===a?"":qa._data(this,"__className__")||""))})},hasClass:function(a){var b,c,d=0;for(b=" "+a+" ";c=this[d++];)if(1===c.nodeType&&(" "+W(c)+" ").replace(Pb," ").indexOf(b)>-1)return!0;return!1}}),qa.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){qa.fn[b]=function(a,c){return arguments.length>0?this.on(b,null,a,c):this.trigger(b)}}),qa.fn.extend({hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)}});var Qb=c.location,Rb=qa.now(),Sb=/\?/,Tb=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;qa.parseJSON=function(a){if(c.JSON&&c.JSON.parse)return c.JSON.parse(a+"");var b,d=null,e=qa.trim(a+"");return e&&!qa.trim(e.replace(Tb,function(a,c,e,f){return b&&c&&(d=0),0===d?a:(b=e||c,d+=!f-!e,"")}))?Function("return "+e)():qa.error("Invalid JSON: "+a)},qa.parseXML=function(a){var b,d;if(!a||"string"!=typeof a)return null;try{c.DOMParser?(d=new c.DOMParser,b=d.parseFromString(a,"text/xml")):(b=new c.ActiveXObject("Microsoft.XMLDOM"),b.async="false",b.loadXML(a))}catch(e){b=void 0}return b&&b.documentElement&&!b.getElementsByTagName("parsererror").length||qa.error("Invalid XML: "+a),b};var Ub=/#.*$/,Vb=/([?&])_=[^&]*/,Wb=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Xb=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Yb=/^(?:GET|HEAD)$/,Zb=/^\/\//,$b=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,_b={},ac={},bc="*/".concat("*"),cc=Qb.href,dc=$b.exec(cc.toLowerCase())||[];qa.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:cc,type:"GET",isLocal:Xb.test(dc[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":bc,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":qa.parseJSON,"text xml":qa.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,b){return b?Z(Z(a,qa.ajaxSettings),b):Z(qa.ajaxSettings,a)},ajaxPrefilter:X(_b),ajaxTransport:X(ac),ajax:function(a,b){function d(a,b,d,e){var f,l,s,t,v,x=b;2!==u&&(u=2,i&&c.clearTimeout(i),k=void 0,h=e||"",w.readyState=a>0?4:0,f=a>=200&&a<300||304===a,d&&(t=$(m,w,d)),t=_(m,t,w,f),f?(m.ifModified&&(v=w.getResponseHeader("Last-Modified"),v&&(qa.lastModified[g]=v),(v=w.getResponseHeader("etag"))&&(qa.etag[g]=v)),204===a||"HEAD"===m.type?x="nocontent":304===a?x="notmodified":(x=t.state,l=t.data,s=t.error,f=!s)):(s=x,!a&&x||(x="error",a<0&&(a=0))),w.status=a,w.statusText=(b||x)+"",f?p.resolveWith(n,[l,x,w]):p.rejectWith(n,[w,x,s]),w.statusCode(r),r=void 0,j&&o.trigger(f?"ajaxSuccess":"ajaxError",[w,m,f?l:s]),q.fireWith(n,[w,x]),j&&(o.trigger("ajaxComplete",[w,m]),--qa.active||qa.event.trigger("ajaxStop")))}"object"==typeof a&&(b=a,a=void 0),b=b||{};var e,f,g,h,i,j,k,l,m=qa.ajaxSetup({},b),n=m.context||m,o=m.context&&(n.nodeType||n.jquery)?qa(n):qa.event,p=qa.Deferred(),q=qa.Callbacks("once memory"),r=m.statusCode||{},s={},t={},u=0,v="canceled",w={readyState:0,getResponseHeader:function(a){var b;if(2===u){if(!l)for(l={};b=Wb.exec(h);)l[b[1].toLowerCase()]=b[2];b=l[a.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return 2===u?h:null},setRequestHeader:function(a,b){var c=a.toLowerCase();return u||(a=t[c]=t[c]||a,s[a]=b),this},overrideMimeType:function(a){return u||(m.mimeType=a),this},statusCode:function(a){var b;if(a)if(u<2)for(b in a)r[b]=[r[b],a[b]];else w.always(a[w.status]);return this},abort:function(a){var b=a||v;return k&&k.abort(b),d(0,b),this}};if(p.promise(w).complete=q.add,w.success=w.done,w.error=w.fail,m.url=((a||m.url||cc)+"").replace(Ub,"").replace(Zb,dc[1]+"//"),m.type=b.method||b.type||m.method||m.type,m.dataTypes=qa.trim(m.dataType||"*").toLowerCase().match(Fa)||[""],null==m.crossDomain&&(e=$b.exec(m.url.toLowerCase()),m.crossDomain=!(!e||e[1]===dc[1]&&e[2]===dc[2]&&(e[3]||("http:"===e[1]?"80":"443"))===(dc[3]||("http:"===dc[1]?"80":"443")))),m.data&&m.processData&&"string"!=typeof m.data&&(m.data=qa.param(m.data,m.traditional)),Y(_b,m,b,w),2===u)return w;j=qa.event&&m.global,j&&0==qa.active++&&qa.event.trigger("ajaxStart"),m.type=m.type.toUpperCase(),m.hasContent=!Yb.test(m.type),g=m.url,m.hasContent||(m.data&&(g=m.url+=(Sb.test(g)?"&":"?")+m.data,delete m.data),!1===m.cache&&(m.url=Vb.test(g)?g.replace(Vb,"$1_="+Rb++):g+(Sb.test(g)?"&":"?")+"_="+Rb++)),m.ifModified&&(qa.lastModified[g]&&w.setRequestHeader("If-Modified-Since",qa.lastModified[g]),qa.etag[g]&&w.setRequestHeader("If-None-Match",qa.etag[g])),(m.data&&m.hasContent&&!1!==m.contentType||b.contentType)&&w.setRequestHeader("Content-Type",m.contentType),w.setRequestHeader("Accept",m.dataTypes[0]&&m.accepts[m.dataTypes[0]]?m.accepts[m.dataTypes[0]]+("*"!==m.dataTypes[0]?", "+bc+"; q=0.01":""):m.accepts["*"]);for(f in m.headers)w.setRequestHeader(f,m.headers[f]);if(m.beforeSend&&(!1===m.beforeSend.call(n,w,m)||2===u))return w.abort();v="abort";for(f in{success:1,error:1,complete:1})w[f](m[f]);if(k=Y(ac,m,b,w)){if(w.readyState=1,j&&o.trigger("ajaxSend",[w,m]),2===u)return w;m.async&&m.timeout>0&&(i=c.setTimeout(function(){w.abort("timeout")},m.timeout));try{u=1,k.send(s,d)}catch(x){if(!(u<2))throw x;d(-1,x)}}else d(-1,"No Transport");return w},getJSON:function(a,b,c){return qa.get(a,b,c,"json")},getScript:function(a,b){return qa.get(a,void 0,b,"script")}}),qa.each(["get","post"],function(a,b){qa[b]=function(a,c,d,e){return qa.isFunction(c)&&(e=e||d,d=c,c=void 0),qa.ajax(qa.extend({url:a,type:b,dataType:e,data:c,success:d},qa.isPlainObject(a)&&a))}}),qa._evalUrl=function(a){return qa.ajax({url:a,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,"throws":!0})},qa.fn.extend({wrapAll:function(a){if(qa.isFunction(a))return this.each(function(b){qa(this).wrapAll(a.call(this,b))});if(this[0]){var b=qa(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){for(var a=this;a.firstChild&&1===a.firstChild.nodeType;)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(a){return qa.isFunction(a)?this.each(function(b){qa(this).wrapInner(a.call(this,b))}):this.each(function(){var b=qa(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=qa.isFunction(a);return this.each(function(c){qa(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){qa.nodeName(this,"body")||qa(this).replaceWith(this.childNodes)}).end()}}),qa.expr.filters.hidden=function(a){return pa.reliableHiddenOffsets()?a.offsetWidth<=0&&a.offsetHeight<=0&&!a.getClientRects().length:ba(a)},qa.expr.filters.visible=function(a){return!qa.expr.filters.hidden(a)};var ec=/%20/g,fc=/\[\]$/,gc=/\r?\n/g,hc=/^(?:submit|button|image|reset|file)$/i,ic=/^(?:input|select|textarea|keygen)/i;qa.param=function(a,b){var c,d=[],e=function(a,b){b=qa.isFunction(b)?b():null==b?"":b,d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};if(void 0===b&&(b=qa.ajaxSettings&&qa.ajaxSettings.traditional),qa.isArray(a)||a.jquery&&!qa.isPlainObject(a))qa.each(a,function(){e(this.name,this.value)});else for(c in a)ca(c,a[c],b,e);return d.join("&").replace(ec,"+")},qa.fn.extend({serialize:function(){return qa.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var a=qa.prop(this,"elements");return a?qa.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!qa(this).is(":disabled")&&ic.test(this.nodeName)&&!hc.test(a)&&(this.checked||!Qa.test(a))}).map(function(a,b){var c=qa(this).val();return null==c?null:qa.isArray(c)?qa.map(c,function(a){return{name:b.name,value:a.replace(gc,"\r\n")}}):{name:b.name,value:c.replace(gc,"\r\n")}}).get()}}),qa.ajaxSettings.xhr=void 0!==c.ActiveXObject?function(){return this.isLocal?ea():ha.documentMode>8?da():/^(get|post|head|put|delete|options)$/i.test(this.type)&&da()||ea()}:da;var jc=0,kc={},lc=qa.ajaxSettings.xhr();c.attachEvent&&c.attachEvent("onunload",function(){for(var a in kc)kc[a](void 0,!0)}),pa.cors=!!lc&&"withCredentials"in lc,lc=pa.ajax=!!lc,lc&&qa.ajaxTransport(function(a){if(!a.crossDomain||pa.cors){var b;return{send:function(d,e){var f,g=a.xhr(),h=++jc;if(g.open(a.type,a.url,a.async,a.username,a.password),a.xhrFields)for(f in a.xhrFields)g[f]=a.xhrFields[f];a.mimeType&&g.overrideMimeType&&g.overrideMimeType(a.mimeType),a.crossDomain||d["X-Requested-With"]||(d["X-Requested-With"]="XMLHttpRequest");for(f in d)void 0!==d[f]&&g.setRequestHeader(f,d[f]+"");g.send(a.hasContent&&a.data||null),b=function(c,d){var f,i,j;if(b&&(d||4===g.readyState))if(delete kc[h],b=void 0,g.onreadystatechange=qa.noop,d)4!==g.readyState&&g.abort();else{j={},f=g.status,"string"==typeof g.responseText&&(j.text=g.responseText);try{i=g.statusText}catch(k){i=""}f||!a.isLocal||a.crossDomain?1223===f&&(f=204):f=j.text?200:404}j&&e(f,i,j,g.getAllResponseHeaders())},a.async?4===g.readyState?c.setTimeout(b):g.onreadystatechange=kc[h]=b:b()},abort:function(){b&&b(void 0,!0)}}}}),qa.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(a){return qa.globalEval(a),a}}}),qa.ajaxPrefilter("script",function(a){void 0===a.cache&&(a.cache=!1),a.crossDomain&&(a.type="GET",a.global=!1)}),qa.ajaxTransport("script",function(a){if(a.crossDomain){var b,c=ha.head||qa("head")[0]||ha.documentElement;return{send:function(d,e){b=ha.createElement("script"),b.async=!0,a.scriptCharset&&(b.charset=a.scriptCharset),b.src=a.url,b.onload=b.onreadystatechange=function(a,c){(c||!b.readyState||/loaded|complete/.test(b.readyState))&&(b.onload=b.onreadystatechange=null,b.parentNode&&b.parentNode.removeChild(b),b=null,c||e(200,"success"))},c.insertBefore(b,c.firstChild)},abort:function(){b&&b.onload(void 0,!0)}}}});var mc=[],nc=/(=)\?(?=&|$)|\?\?/;qa.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=mc.pop()||qa.expando+"_"+Rb++;return this[a]=!0,a}}),qa.ajaxPrefilter("json jsonp",function(a,b,d){var e,f,g,h=!1!==a.jsonp&&(nc.test(a.url)?"url":"string"==typeof a.data&&0===(a.contentType||"").indexOf("application/x-www-form-urlencoded")&&nc.test(a.data)&&"data");if(h||"jsonp"===a.dataTypes[0])return e=a.jsonpCallback=qa.isFunction(a.jsonpCallback)?a.jsonpCallback():a.jsonpCallback,h?a[h]=a[h].replace(nc,"$1"+e):!1!==a.jsonp&&(a.url+=(Sb.test(a.url)?"&":"?")+a.jsonp+"="+e),a.converters["script json"]=function(){return g||qa.error(e+" was not called"),g[0]},a.dataTypes[0]="json",f=c[e],c[e]=function(){g=arguments},d.always(function(){void 0===f?qa(c).removeProp(e):c[e]=f,
a[e]&&(a.jsonpCallback=b.jsonpCallback,mc.push(e)),g&&qa.isFunction(f)&&f(g[0]),g=f=void 0}),"script"}),qa.parseHTML=function(a,b,c){if(!a||"string"!=typeof a)return null;"boolean"==typeof b&&(c=b,b=!1),b=b||ha;var d=za.exec(a),e=!c&&[];return d?[b.createElement(d[1])]:(d=v([a],b,e),e&&e.length&&qa(e).remove(),qa.merge([],d.childNodes))};var oc=qa.fn.load;qa.fn.load=function(a,b,c){if("string"!=typeof a&&oc)return oc.apply(this,arguments);var d,e,f,g=this,h=a.indexOf(" ");return h>-1&&(d=qa.trim(a.slice(h,a.length)),a=a.slice(0,h)),qa.isFunction(b)?(c=b,b=void 0):b&&"object"==typeof b&&(e="POST"),g.length>0&&qa.ajax({url:a,type:e||"GET",dataType:"html",data:b}).done(function(a){f=arguments,g.html(d?qa("<div>").append(qa.parseHTML(a)).find(d):a)}).always(c&&function(a,b){g.each(function(){c.apply(this,f||[a.responseText,b,a])})}),this},qa.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(a,b){qa.fn[b]=function(a){return this.on(b,a)}}),qa.expr.filters.animated=function(a){return qa.grep(qa.timers,function(b){return a===b.elem}).length},qa.offset={setOffset:function(a,b,c){var d,e,f,g,h,i,j,k=qa.css(a,"position"),l=qa(a),m={};"static"===k&&(a.style.position="relative"),h=l.offset(),f=qa.css(a,"top"),i=qa.css(a,"left"),j=("absolute"===k||"fixed"===k)&&qa.inArray("auto",[f,i])>-1,j?(d=l.position(),g=d.top,e=d.left):(g=parseFloat(f)||0,e=parseFloat(i)||0),qa.isFunction(b)&&(b=b.call(a,c,qa.extend({},h))),null!=b.top&&(m.top=b.top-h.top+g),null!=b.left&&(m.left=b.left-h.left+e),"using"in b?b.using.call(a,m):l.css(m)}},qa.fn.extend({offset:function(a){if(arguments.length)return void 0===a?this:this.each(function(b){qa.offset.setOffset(this,a,b)});var b,c,d={top:0,left:0},e=this[0],f=e&&e.ownerDocument;if(f)return b=f.documentElement,qa.contains(b,e)?(void 0!==e.getBoundingClientRect&&(d=e.getBoundingClientRect()),c=fa(f),{top:d.top+(c.pageYOffset||b.scrollTop)-(b.clientTop||0),left:d.left+(c.pageXOffset||b.scrollLeft)-(b.clientLeft||0)}):d},position:function(){if(this[0]){var a,b,c={top:0,left:0},d=this[0];return"fixed"===qa.css(d,"position")?b=d.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),qa.nodeName(a[0],"html")||(c=a.offset()),c.top+=qa.css(a[0],"borderTopWidth",!0),c.left+=qa.css(a[0],"borderLeftWidth",!0)),{top:b.top-c.top-qa.css(d,"marginTop",!0),left:b.left-c.left-qa.css(d,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent;a&&!qa.nodeName(a,"html")&&"static"===qa.css(a,"position");)a=a.offsetParent;return a||pb})}}),qa.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,b){var c=/Y/.test(b);qa.fn[a]=function(d){return Pa(this,function(a,d,e){var f=fa(a);if(void 0===e)return f?b in f?f[b]:f.document.documentElement[d]:a[d];f?f.scrollTo(c?qa(f).scrollLeft():e,c?e:qa(f).scrollTop()):a[d]=e},a,d,arguments.length,null)}}),qa.each(["top","left"],function(a,b){qa.cssHooks[b]=J(pa.pixelPosition,function(a,c){if(c)return c=rb(a,b),nb.test(c)?qa(a).position()[b]+"px":c})}),qa.each({Height:"height",Width:"width"},function(a,b){qa.each({padding:"inner"+a,content:b,"":"outer"+a},function(c,d){qa.fn[d]=function(d,e){var f=arguments.length&&(c||"boolean"!=typeof d),g=c||(!0===d||!0===e?"margin":"border");return Pa(this,function(b,c,d){var e;return qa.isWindow(b)?b.document.documentElement["client"+a]:9===b.nodeType?(e=b.documentElement,Math.max(b.body["scroll"+a],e["scroll"+a],b.body["offset"+a],e["offset"+a],e["client"+a])):void 0===d?qa.css(b,c,g):qa.style(b,c,d,g)},b,f?d:void 0,f,null)}})}),qa.fn.extend({bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,"**"):this.off(b,a||"**",c)}}),qa.fn.size=function(){return this.length},qa.fn.andSelf=qa.fn.addBack,d=[],void 0!==(e=function(){return qa}.apply(b,d))&&(a.exports=e);var pc=c.jQuery,qc=c.$;return qa.noConflict=function(a){return c.$===qa&&(c.$=qc),a&&c.jQuery===qa&&(c.jQuery=pc),qa},f||(c.jQuery=c.$=qa),qa})},function(a,b){a.exports=function(a){return a.webpackPolyfill||(a.deprecate=function(){},a.paths=[],a.children||(a.children=[]),Object.defineProperty(a,"loaded",{enumerable:!0,get:function(){return a.l}}),Object.defineProperty(a,"id",{enumerable:!0,get:function(){return a.i}}),a.webpackPolyfill=1),a}},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(90),f=d(e),g=c(14),h=d(g),i=c(250),j=d(i),k=c(5),l=d(k),m=[],n=!1,o={alert:function(a){function b(b){return a.apply(this,arguments)}return b.toString=function(){return a.toString()},b}(function(a){void 0}),emptyFunction:function(){},isFunction:function(a){return"function"==typeof a},parseGPSCoordinates:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"35/1, 10/1, 130371/10000",b=a.split(/\s*[,\/]\s*/);return b[0]/b[1]+b[2]/b[3]/60+b[4]/b[5]/3600},getUniqueId:function(){function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()},getScriptPath:function(){var a=document.getElementsByTagName("script");return this.dirname(a[a.length-1].src)},dirname:function(a){return-1===a.lastIndexOf("/")?"./":a.replace(/\\/g,"/").replace(/\/[^\/]*\/?$/,"")+"/"},getThumbnailSize:function(a,b,c,d){var e=a/b,f=c/d,g=void 0,h=void 0,i=void 0;return e>f?(i=c/a,g=c,h=b*i):(i=d/b,g=a*i,h=d),[g,h]},getThumbnailImageSizeForCover:function(a,b,c,d){var e=a/b,f=c/d,g=void 0,h=void 0,i=void 0;return e<f?(i=c/a,g=c,h=b*i):(i=d/b,g=a*i,h=d),[g,h]},getCroppedThumbnailSize:function(a,b,c,d,e,f){var g=void 0,h=void 0,i=a/b,j=e/f;return a===b?(g=a,h=b*(i/j)):(g=a/(i/j),h=b),this.getThumbnailSize(g,h,c,d)},isNeedPolyfill:function(){if("Microsoft Internet Explorer"===navigator.appName){if(null!==navigator.userAgent.match(/MSIE ([0-9]{1,}[\.0-9]{0,})/)){if(parseFloat(RegExp.$1)<11)return!0}}return!1},getIEVersion:function(){if(void 0!==this.IEVersion)return this.IEVersion;var a=window.navigator.userAgent,b=a.indexOf("MSIE");return b>0?this.IEVersion=parseInt(a.substring(b+5,a.indexOf(".",b))):navigator.userAgent.match(/Trident\/7\./)?this.IEVersion=11:this.IEVersion=0,this.IEVersion},stripBase64Header:function(a){return a.replace(/^data:image\/[a-z]+;base64,/i,"")},base64ToBlob:function(a,b){var c=window.atob(this.stripBase64Header(a)),d=[];b=b||"";for(var e=0,f=c.length;e<f;e+=1024){for(var g=c.slice(e,e+1024),h=new Array(g.length),i=0;i<g.length;i++)h[i]=g.charCodeAt(i);var j=new Uint8Array(h);d.push(j)}return new Blob(d,{type:b})},urlToBlob:function(a){var b=l.default.Deferred(),c=new XMLHttpRequest;return n=!1,m.push(c),c.onload=function(){var a=m.indexOf(c);a>-1&&m.splice(a,1);var d=window.URL.createObjectURL(this.response);b.resolve(d)},c.onerror=function(){var a=m.indexOf(c);a>-1&&m.splice(a,1),b.reject()},c.onabort=function(){var a=m.indexOf(c);a>-1&&m.splice(a,1),b.reject()},c.open("GET",a,!0),c.responseType="blob",c.send(),b},urlToBase64:function(a){var b=this,c=l.default.Deferred();return l.default.ajax({url:a,crossDomain:!0,xhrFields:{withCredentials:!0},mimeType:"text/plain; charset=x-user-defined",success:function(a){c.resolve(b.binaryToBase64(a))},error:function(){c.reject()}}),c},binaryToBase64:function(a){for(var b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c="",d=0,e=a.length,f=void 0,g=void 0,h=void 0;d<e;){if(f=255&a.charCodeAt(d++),d===e){c+=b.charAt(f>>2),c+=b.charAt((3&f)<<4),c+="==";break}if(g=a.charCodeAt(d++),d===e){c+=b.charAt(f>>2),c+=b.charAt((3&f)<<4|(240&g)>>4),c+=b.charAt((15&g)<<2),c+="=";break}h=a.charCodeAt(d++),c+=b.charAt(f>>2),c+=b.charAt((3&f)<<4|(240&g)>>4),c+=b.charAt((15&g)<<2|(192&h)>>6),c+=b.charAt(63&h)}return c?"data:image/png;base64,"+c:null},base64toFile:function(a,b){for(var c=a.split(","),d=c[0].match(/:(.*?);/)[1],e=atob(c[1]),f=e.length,g=new Uint8Array(f);f--;)g[f]=e.charCodeAt(f);return new File([g],b,{type:d})},timestamp:function(){return Math.floor((new Date).getTime())},objectToArray:function(a){return void 0===a?[]:void 0===a.length?[a]:a},convertHexToRGBA:function(a,b){return a=a.replace("#",""),"rgba("+parseInt(a.substring(0,2),16)+","+parseInt(a.substring(2,4),16)+","+parseInt(a.substring(4,6),16)+","+b+")"},isHold:function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;if(!a)return!1;var c=Number(a.getAttribute("data-holdTime")),d=o.timestamp();return!!(c&&d-c<b)||(a.setAttribute("data-holdTime",d),!1)},getLimitedSize:function(a,b){return a>h.default.maxImageSize&&(b*=h.default.maxImageSize/a,a=h.default.maxImageSize),b>h.default.maxImageSize&&(a*=h.default.maxImageSize/b,b=h.default.maxImageSize),[a,b]},getMaximumWidth:function(a,b){var c=Math.min(h.default.maxImageSize,a),d=b*(c/a);return d>h.default.maxImageSize&&(c*=h.default.maxImageSize/d),Math.ceil(c)},getMinimumWidth:function(a,b){var c=void 0;return c=a>=b?a/b:1,Math.ceil(c)},getFonts:function(){return-1!==navigator.userAgent.indexOf("Macintosh")?h.default.fonts.mac:h.default.fonts.win},getFontsDetected:function(){var a=this.getFonts(),b=[];return a.forEach(function(a){j.default.detect(a)&&b.push(a)}),b},getBytes:function(a){for(var b=0,c=0;c<a.length;c++){var d=escape(a.charAt(c));1===d.length?b++:-1!==d.indexOf("%u")?b+=2:-1!==d.indexOf("%")&&(b+=d.length/3)}return b},byteCut:function(a,b){for(var c=0,d="",e=0;e<a.length;e++){var f=a.charCodeAt(e),g=a.charAt(e);if(f>=0&&f<256?c++:c+=2,c>b)break;d+=g}return d},asyncDelay:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,b=l.default.Deferred();return setTimeout(b.resolve.bind(b),a),b},parseFileName:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",b=a.lastIndexOf("."),c=void 0;return-1!==b&&(c=a.substring(b+1),a=a.substring(0,b)),{name:a,extension:c||""}},addURLProtocol:function(a,b){return b=b||location.protocol.toLowerCase().replace(":",""),a=a.replace(/^https?:/,b+":"),/^https?:\/\//.test(a)||(a=b+"://"+a),a},isSafari:function(){if(void 0!==this._isSafari)return this._isSafari;var a=window.navigator.userAgent.toLowerCase();return this._isSafari=a.indexOf("safari")>-1&&-1===a.indexOf("chrome"),this._isSafari},debug:function(){if(PhotoEditorApp.instance._controller.options.setting.debugMode){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];console.warn.apply(console,b)}},getObjectFromUrlQueryString:function(){return querystring.parse(location.search.substring(1))},addURLParameter:function(a,b,c){return-1===a.indexOf("?")?a+="?":a+="&",a+=b+"="+encodeURIComponent(c)},abortAjax:function(){return l.default.ajaxSetup({beforeSend:function(a){n=!1,m.push(a)},complete:function(a){var b=m.indexOf(a);b>-1&&m.splice(b,1)}}),function(){void 0,m.length&&(n=!0),(0,l.default)(m).each(function(a,b){b.abort()}),m.length=0}}(),isAjaxAborted:function(){return n},openNdriveSavePopup:function(a,b,c){var d=PhotoEditorApp.instance,e=d._controller.options.setting,g=h.default.cloudSaveUrl[e.env],i="service="+e.serviceName+"&resource="+escape((0,f.default)({name:b,size:c,downloadUrl:a})),j=g+"?"+i,k=window.open(j,"oNdriveSavePopup","width=476,height=360,scrollbars=no,location=no,status=no,resizable=no,toolbar=no,menubar=no");k?k.focus():setTimeout(function(){void 0},200)},rgbToHex:function(a){return"#"+a.match(/\d+/g).map(function(a){return a=parseInt(a).toString(16),1==a.length?"0"+a:a}).join("")},fetchBlob:function(a,b,c){var d=new XMLHttpRequest;d.addEventListener("load",function(){b(d.response)}),d.addEventListener("error",function(){c&&c(d.response)}),d.open("GET",a,!0),d.responseType="blob",d.withCredentials=!0,d.send(null)},canUseNewFile:function(){var a=!this.getIEVersion()&&!this.isSafari();if(a)try{new File([],"")}catch(b){a=!1}return a}};b.default=o},function(a,b,c){"use strict";b.__esModule=!0;var d={ACTIVE_TOGGLE_CLASS:"on",OUT_ANIMATION_CLASS:"off",LOADING_CLASS:"npe_loading",DISABLE_TOGGLE_CLASS:"disable",LIST_DRAG_ITEM_CLASS:"npe_drag_orig",FOCUS_TOGGLE_CLASS:"focus",HOVER_TOGGLE_CLASS:"hover",CANVAS_LOADING:".npe_canvas_loading",DIMMED_CLASS:"npe_dimmed",PHOTOEDITOR_WRAP:".npe_wrap",CONTROL_BTN:".npe_btn_control",CONTROL_WRAP:".npe_control_wrap",CONTROL_DETAIL:".npe_control_detail",CONTROL_DETAIL_WRAP:".npe_control_detail_wrap",CONTROL_DETAIL_WRAP_OFF_CLASS:"off",ZOOM_IN_BTN:".npe_btn_zoom_in",ZOOM_OUT_BTN:".npe_btn_zoom_out",RESTORE_BTN:".npe_btn_restore",DETAIL_THUMBNAIL_IMG:".npe_detail_thumb_img",TOOLBAR:".npe_header_toolbar",ZOOM_SLIDE:".npe_header_toolbar_slide_area .npe_slide ",CANVAS_WRAP:".npe_canvas_wrap",CANVAS:".npe_canvas",HEADER_BTN_AREA:".npe_header_btn_area"};b.default=d},function(a,b){var c=a.exports={version:"2.5.3"};"number"==typeof __e&&(__e=c)},function(a,b,c){"use strict";function d(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,D.each)(a,function(a,c){b[c]=a}),b}function e(a,b){(0,D.each)(a,function(b,c){return a.style[c]=b})}function f(a,b){for(var c in b)a[c]=b[c]}function g(a,b){var c;for(var d in b)c=(0,C.default)(a[d]),"undefined"!==c?"object"===c&&(null===a[d]?a[d]=b[d]:void 0===b[d].length&&g(a[d],b[d])):a[d]=b[d];return a}function h(a){return nts&&nts.$proxyDisabled?a:/^[.\/\\]/.test(a)?a:"http://10.113.216.159:10080/?sURL="+a}function i(a){for(var b=0,c=a.length,d=0;b<c;b++)a[b]&&(b!=d&&(a[d]=a[b]),++d);return a.length=d,a}function j(a,b,c,d,e){b=b||0,c=c||0,d=d||a.width||a.naturalWidth,e=e||a.height||a.naturalHeight;var f=F.canvas;return f.width=d,f.height=e,F.drawImage(a,b,c,d,e),F.getImageData(0,0,d,e)}function k(a){return a.reduce(function(a,b){return"string"==typeof a?a+", "+b.name:a.name+", "+b.name})}function l(a,b,c,d,e,f,g){function h(){d[0]=i,i=c.apply(e,d),f(i,b),i<b?setTimeout(h,10):g(i,b)}var i=a,d=[i,b].concat(d);h()}function m(a,b){for(var c=0,d=b.length;c<d;c+=3)a.on(b[c],b[c+1],b[c+2])}function n(a,b){for(var c=0,d=b.length;c<d;c+=3)a.off(b[c],b[c+1],b[c+2])}function o(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;b=b||[];var e,f,g,h,i,j;return e=a.scale.x,f=a.scale.y,i=-a.pivot.x,j=-a.pivot.y,a.anchor&&(a.anchor.x||a.anchor.y)&&(i=-a.anchor.x*a.texture.frame.width,j=-a.anchor.y*a.texture.frame.height),0==a.rotation?(b[0]=e*c,b[1]=0,b[2]=0,b[3]=f*d,b[4]=(e*i+a.x)*c,b[5]=(f*j+a.y)*d):(g=Math.cos(a.rotation),h=Math.sin(a.rotation),b[0]=e*g,b[1]=e*h,b[2]=f*-h,b[3]=f*g,b[4]=b[0]*i+b[2]*j+a.x,b[5]=b[1]*i+b[3]*j+a.y),b}function p(a,b){void 0}function q(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new PIXI.Matrix,c=arguments.length>2&&void 0!==arguments[2]&&arguments[2],d=a.texture&&a.texture.baseTexture?a.texture.baseTexture.source:null,e=-a.pivot.x,f=-a.pivot.y;return d&&(e=e||-(d.width||d.naturalWidth)*a.anchor.x,f=f||-(d.height||d.naturalHeight)*a.anchor.y),b.setTransform(a.position.x,a.position.y,e,f,c?a.scale.x:(0,E.sign)(a.scale.x),c?a.scale.y:(0,E.sign)(a.scale.y),a.rotation,0,0),b}function r(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,c=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return function(d){var e=q(d,void 0,c);if(b&&e.prepend(b),d.renderableObject&&d.texture&&d.texture.baseTexture){var f=Math.abs(d.scale.x),g=Math.abs(d.scale.y),h=f*e.a,i=g*e.c,j=0|e.tx,k=f*e.b,l=g*e.d,m=0|e.ty;a.setTransform(h,k,i,l,j,m),a.drawImage(d.texture.baseTexture.source,0,0)}else d instanceof PIXI.Container&&d.children.forEach(r(a,e),this)}}function s(a,b,c,d){var e=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5,f=b.canvas.width,g=b.canvas.height;if(c<=f&&d<=g)return b;var h=Math.max(f,e*c|0),i=Math.max(g,e*d|0),j=void 0;return(h>f||i>g)&&(.6*h*(1-e)>h-f&&(h=f),.6*i*(1-e)>i-g&&(i=g)),j=h==f&&i==g?b:a,j.drawImage(a.canvas,0,0,c,d,0,0,h,i),s(a,b,h,i,e)}function t(a,b,c,d){var e=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5,f=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,g=b.canvas.width,h=b.canvas.height,i=Math.max(g,c),j=Math.max(h,d),k=i==g&&j==h?b:F;return k.canvas.width=i,k.canvas.height=j,k.save(),null!=f?k.setTransform(f[0],f[1],f[2],f[3],f[4],f[5]):k.setTransform(1,0,0,1,0,0),k.drawImage(a,0,0),k.restore(),k==b?k:s(k,b,i,j,e)}function u(a,b,c,d,e){var f=void 0;try{f=a.getImageData(b,c,d,e)}catch(g){void 0}return f}function v(a,b,c){var d=void 0;try{d=a.createImageData(b,c)}catch(e){void 0}return d}function w(a,b){for(var c=void 0,d=!0,e=arguments.length,f=Array(e>2?e-2:0),g=2;g<e;g++)f[g-2]=arguments[g];for(var h in a)if(void 0!==(c=a[h])&&-1===f.indexOf(c)){if(void 0===b[h])return!1;d="object"===(void 0===c?"undefined":(0,C.default)(c))?d&&w(c,b[h]):d&&c===b[h]}return d}function x(){var a=!!window.opr&&!!opr.addons||!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0,b="undefined"!=typeof InstallTrigger,c=/constructor/i.test(window.HTMLElement)||function(a){return"[object SafariRemoteNotification]"===a.toString()}(!window.safari||safari.pushNotification),d=!!document.documentMode,e=!d&&!!window.StyleMedia,f=!!window.chrome&&!!window.chrome.webstore,g=(f||a)&&!!window.CSS;if(a)return"Opera";if(b)return"FireFox";if(c)return"Safari";if(d){return"Internet Explorer"+(navigator.userAgent.match(/MSIE [0-9]{1,}/g)||[])[0]||""}return e?"Microsoft Edge":f?"Chrome":g?"Blink":void 0}function y(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];return b.reduce(function(a,b){return Math.max(a,b.largestLength)},0)}function z(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];return b.reduce(function(a,b){return a.largestLength>=b.largestLength?a:b}).largestVertex}function A(a,b){var c,d,e=a,f=e.a,g=e.b,h=e.c,i=e.d,j=Math.acos,k=Math.atan,l=Math.sqrt,m=Math.PI,n={x:e.e,y:e.f},o=0,p={x:1,y:1},q={x:0,y:0},r=f*i-g*h;return b?f?(q={x:k(h/f),y:k(g/f)},p={x:f,y:r/f}):g?(o=.5*m,p={x:g,y:r/g},q.x=k(i/g)):(p={x:h,y:i},q.x=.25*m):f||g?(c=l(f*f+g*g),o=g>0?j(f/c):-j(f/c),p={x:c,y:r/c},q.x=k((f*h+g*i)/(c*c))):h||i?(d=l(h*h+i*i),o=.5*m-(i>0?j(-h/d):-j(h/d)),p={x:r/d,y:d},q.y=k((f*h+g*i)/(d*d))):p={x:0,y:0},{translate:n,rotation:o,scale:p,skew:q}}b.__esModule=!0,b.TEMP_POINT_C=b.TEMP_POINT_B=b.TEMP_POINT_A=b.__photoFrameContext=b.__renderableContext=b.__context=void 0;var B=c(4),C=function(a){return a&&a.__esModule?a:{"default":a}}(B);b.clone=d,b.style=e,b.setAll=f,b.pull=g,b.proxy=h,b.removeNullPointer=i,b.toImageData=j,b.enumerateFilterNames=k,b.loop=l,b.addEvents=m,b.removeEvents=n,b.toMatrix=o,b.printMat=p,b.getMatrixFrom=q,b.makeDrawCallbackInClosure=r,b.imageResize=t,b.getImageData=u,b.createImageData=v,b.objectEqual=w,b.getBrowserName=x,b.maxLength=y,b.maxVertex=z,b.decompose=A;var D=c(17),E=c(53),F=b.__context=document.createElement("canvas").getContext("2d");b.__renderableContext=document.createElement("canvas").getContext("2d"),b.__photoFrameContext=document.createElement("canvas").getContext("2d"),b.TEMP_POINT_A={x:0,y:0},b.TEMP_POINT_B={x:0,y:0},b.TEMP_POINT_C={x:0,y:0}},function(a,b,c){"use strict";b.__esModule=!0;var d={CONTROLS:{FILTER:"filter",CROP:"crop",RESIZE:"resize",ADJUST:"adjust",MOSAIC:"mosaic",SIGNATURE:"signature",STICKER:"sticker",TEXT:"text",PHOTOFRAME:"photoFrame",CLIP:"clip"},CONTROL:{CROP:{ORIGINAL:"original",FREE:"free"},RESIZE:{ORIGINAL:"original",CUSTOM:"custom"},ADJUST:{AUTO:"auto_adjust",BRIGHTNESS:"brightness",SATURATION:"saturation",SHARPEN:"sharpen",KELVIN:"kelvin",CONTRAST:"contrast"},MOSAIC:{SQUARE1:"square1"},SIGNATURE:{NONE:"none",IMAGE:"image",TEXT:"text"}},KEYCODES:{DEL:46,LEFT:37,RIGHT:39,Z:90,Y:89,ENTER:13,ESC:27},COOKIES:{LIST_OPENED:"npeListOpened",SIGNATURE_TYPE_LASTEST:"npeSignatureTypeLastest",SIGNATURE_IMAGE_DATAURL:"npeSignatureImageDataURL",SIGNATURE_TEXT:"npeSignatureText",SIGNATURE_TEXT_FONT:"npeSignatureTextFont",SIGNATURE_TEXT_FONT_COLORS:"npeSignatureTextFontColors",SIGNATURE_TEXT_BACK:"npeSignatureTextBack",SIGNATURE_TEXT_BACK_COLORS:"npeSignatureTextBackColors",SIGNATURE_TEXT_FONT_FAMILY:"npeSignatureTextFontFamily",SIGNATURE_TEXT_FONT_SIZE:"npeSignatureTextFontSize",SIGNATURE_TEXT_FONT_BOLD:"npeSignatureTextFontBold",SIGNATURE_TEXT_FONT_ITALIC:"npeSignatureTextFontItalic",SIGNATURE_TEXT_FONT_COLOR:"npeSignatureTextFontColor",SIGNATURE_TEXT_FONT_ALPHA:"npeSignatureTextFontAlpha",SIGNATURE_TEXT_FONT_BG_COLOR:"npeSignatureTextFontBgColor",SIGNATURE_TEXT_FONT_BG_ALPHA:"npeSignatureTextFontBgAlpha",TEXT_FONT:"npeTextFont",TEXT_FONT_COLORS:"npeTextFontColors",TEXT_BACK:"npeTextBack",TEXT_BACK_COLORS:"npeTextBackColors",TEXT_FONT_FAMILY:"npeTextFontFamily",TEXT_FONT_SIZE:"npeTextFontSize",TEXT_FONT_BOLD:"npeTextFontBold",TEXT_FONT_ITALIC:"npeTextFontItalic",TEXT_FONT_COLOR:"npeTextFontColor",TEXT_FONT_ALPHA:"npeTextFontAlpha",TEXT_FONT_BG_COLOR:"npeTextFontBgColor",TEXT_FONT_BG_ALPHA:"npeTextFontBgAlpha",MASK_BORDER:"npeMaskBorder",MASK_BORDER_COLORS:"npeMaskBorderColors",MASK_BORDER_COLOR:"npeMaskBorderColor",MASK_BORDER_ALPHA:"npeMaskBorderAlpha"},LIST_MODE:{LIST:"list",SELECT:"select",SORT:"sort"},CALLBACK_TYPES:{SET_EDITOR:"SET_EDITOR",PHUP_UPLOAD:"PHUP_UPLOAD"}};b.default=d},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(415),f=d(e),g=c(416),h=d(g),i=c(8),j=d(i);f.default.tail.setLoadingClass=function(a,b,c){f.default.callTail("setClass",a,b,j.default.LOADING_CLASS)},f.default.tail._setLoadingClass=function(a,b,c){f.default.callTail("setClass",a,!b,j.default.LOADING_CLASS)},f.default.tail.addI18nTextClass=function(a,b,c){f.default.callTail("addClass",a,"_"+b+"-text")},f.default.tail.fontFamily=function(a,b,c){b&&(a.style.fontFamily=b)},f.default.tail.background=function(a,b,c){b&&(a.style.backgroundImage="url('"+b+"')",a.style.backgroundRepeat="no-repeat")},f.default.tail.widthPercent=function(a,b,c){a.style.width=Number(b)+"%"},f.default.tail.backgroundColor=function(a,b,c){b&&(a.style.backgroundColor=b)},f.default.tail.stickerSprite=function(a,b,c){b&&(a.style.background="url("+b.thumbnail+") no-repeat "+b.backgroundPosition)},b.default={html:h.default,render:function(a,b){f.default.render(a,b)}}},function(a,b,c){var d=c(18),e=c(9),f=c(42),g=c(43),h=function(a,b,c){var i,j,k,l=a&h.F,m=a&h.G,n=a&h.S,o=a&h.P,p=a&h.B,q=a&h.W,r=m?e:e[b]||(e[b]={}),s=r.prototype,t=m?d:n?d[b]:(d[b]||{}).prototype;m&&(c=b);for(i in c)(j=!l&&t&&void 0!==t[i])&&i in r||(k=j?t[i]:c[i],r[i]=m&&"function"!=typeof t[i]?c[i]:p&&j?f(k,d):q&&t[i]==k?function(a){var b=function(b,c,d){if(this instanceof a){switch(arguments.length){case 0:return new a;case 1:return new a(b);case 2:return new a(b,c)}return new a(b,c,d)}return a.apply(this,arguments)};return b.prototype=a.prototype,b}(k):o&&"function"==typeof k?f(Function.call,k):k,o&&((r.virtual||(r.virtual={}))[i]=k,a&h.R&&s&&!s[i]&&g(s,i,k)))};h.F=1,h.G=2,h.S=4,h.P=8,h.B=16,h.W=32,h.U=64,h.R=128,a.exports=h},function(a,b,c){"use strict";b.__esModule=!0;var d=c(7),e=(function(a){a&&a.__esModule}(d),{defaultOptions:{setting:{env:"real",lang:"ko-KR",userId:"hello",serviceName:"blog"},functions:{useFilter:!1,useCrop:!1,useResize:!1,useAdjust:!1,useMosaic:!1,useSignature:!1,useSticker:!1,useText:!1,usePhotoFrame:!1,useClip:!1},resizePreset:[400,600,700,900,1200],resizeCustom:!0,cropPreset:["original","free","16:9","3:2","4:3","1:1","3:4","2:3","9:16"],cropDefault:"free",backgroundColor:2631720,filterPath:"",container:document.body,initKey:null,usePhotoinfraThumbnailType:!0,signature:{defaultText:"기본서명텍스트",byteLimit:42},clip:{index:-1,lineWidth:0,opacity:1,color:"#dadada",dimmedOpacity:.8},popupUploaderStickerType:"grafolio",sideMenuPosition:"left",theme:null,webglFilterEnable:!0},themes:{gp:{signatureColor:"ffec00"}},grafolioApiDomain:{local:"dev.apis.naver.com",dev:"dev.apis.naver.com",real:"apis.naver.com"},grafolioBaseDomain:{local:"beta.gfmarket.phinf.naver.net",dev:"beta.gfmarket.phinf.naver.net",real:"gfmarket.phinf.naver.net"},grafolioBaseDomainSSL:{local:"beta.ssl.phinf.net/gfmarket",dev:"beta.ssl.phinf.net/gfmarket",real:"ssl.phinf.net/gfmarket"},cloudSaveUrl:{local:"https://alpha.cloud.naver.com/saveFile.nhn",dev:"https://alpha.cloud.naver.com/saveFile.nhn",real:"https://cloud.naver.com/saveFile.nhn"},cropThumbnailWidth:48,cropThumbnailHeight:48,signatureImageSize:204800,signatureImageWidth:400,signatureImageHeight:200,signatureImageTypes:["jpg","jpeg","gif","png","bmp"],thumbnailTypeSize:3e3,thumbnailTypeQueryString:"?type=m3000_3000",rotateClockwise:!0,filters:[{i18n:"txt_filter_original",code:-1,path:"filters/00_Original.png"},{i18n:"txt_filter_clear",code:1,path:"filters/01_Clear.png"},{i18n:"txt_filter_bright",code:2,path:"filters/02_Brilliant.png"},{i18n:"txt_filter_cream",code:3,path:"filters/03_Cream.png"},{i18n:"txt_filter_delight",code:4,path:"filters/04_Delight.png"},{i18n:"txt_filter_blossom",code:5,path:"filters/05_Blossom.png"},{i18n:"txt_filter_warm",code:6,path:"filters/06_Warm.png"},{i18n:"txt_filter_lollipop",code:7,path:"filters/07_Lollipop.png"},{i18n:"txt_filter_candy",code:8,path:"filters/08_Candy.png"},{i18n:"txt_filter_mint",code:9,path:"filters/09_Mint.png"},{i18n:"txt_filter_cool",code:10,path:"filters/10_Cool.png"},{i18n:"txt_filter_cobalt",code:11,path:"filters/11_Cobalt.png"},{i18n:"txt_filter_classic",code:12,path:"filters/12_Classic.png"},{i18n:"txt_filter_vintage",code:13,path:"filters/13_Vintage.png"},{i18n:"txt_filter_urban",code:14,path:"filters/14_Urban.png"},{i18n:"txt_filter_chic",code:15,path:"filters/15_Chic.png"},{i18n:"txt_filter_blank",code:16,path:"filters/16_Blank.png"},{i18n:"txt_filter_tintp",code:17,path:"filters/17_Tint-P.png"},{i18n:"txt_filter_tinty",code:18,path:"filters/18_Tint-Y.png"}],frames:[{i18n:"txt_none_apply",code:0},{i18n:"txt_frame_1",code:1,path:"icons/npe_frame_1.png"},{i18n:"txt_frame_2",code:2,path:"icons/npe_frame_2.png"},{i18n:"txt_frame_3",code:3,path:"icons/npe_frame_3.png"},{i18n:"txt_frame_6",code:4,path:"icons/npe_frame_6.png"},{i18n:"txt_frame_4",code:5,path:"icons/npe_frame_4.png"},{i18n:"txt_frame_5",code:6,path:"icons/npe_frame_5.png"}],crops:[{i18n:"txt_original_ratio",code:"original"},{i18n:"txt_free_ratio",code:"free"},{i18n:"txt_16_9_ratio",code:"16:9"},{i18n:"txt_3_2_ratio",code:"3:2"},{i18n:"txt_4_3_ratio",code:"4:3"},{i18n:"txt_1_1_ratio",code:"1:1"},{i18n:"txt_3_4_ratio",code:"3:4"},{i18n:"txt_2_3_ratio",code:"2:3"},{i18n:"txt_9_16_ratio",code:"9:16"}],masks:[{i18n:"txt_mask_oval",path:"masks/mask-oval.svg",className:"oval",code:0},{i18n:"txt_mask_triangle",path:"masks/mask-triangle.svg",className:"triangle",code:1},{i18n:"txt_mask_round_square",path:"masks/mask-round-square.svg",className:"round_square",code:2},{i18n:"txt_mask_polygon",path:"masks/mask-polygon.svg",className:"polygon",code:3},{i18n:"txt_mask_star1",path:"masks/mask-star-1.svg",className:"star1",code:4},{i18n:"txt_mask_star2",path:"masks/mask-star-2.svg",className:"star2",code:5},{i18n:"txt_mask_round_star",path:"masks/mask-round-star.svg",className:"round_star",code:6}],stickers:{pack1:{tabOnImg:"sticker/pack1/tab/01_tab_on.png",tabOffImg:"sticker/pack1/tab/01_tab_off.png",previewImg:"sticker/pack1/thumbnail/sticker_set_default1.png",list:function(a){for(var b=1;b<=33;b++)a.push({original:"sticker/pack1/original/sticker_emoti_"+b+".png",thumbnail:"sticker/pack1/thumbnail/sticker_emoti_"+b+".png"});return a}([])},pack2:{tabOnImg:"sticker/pack2/tab/02_tab_on.png",tabOffImg:"sticker/pack2/tab/02_tab_off.png",previewImg:"sticker/pack2/thumbnail/sticker_set_default2.png",list:function(a){for(var b=1;b<=31;b++)a.push({original:"sticker/pack2/original/sticker_deco_"+b+".png",thumbnail:"sticker/pack2/thumbnail/sticker_deco_"+b+".png"});return a}([])}},stickerPreview:{"default":{width:50,height:50,cols:6},grafolio:{width:90,height:84,cols:4}},maxImageSize:3e3,colors:["#ffffff","#f7f7f7","#e2e2e2","#c2c2c2","#9c9c9c","#858585","#636363","#404040","#272727","#000000","#ffb39b","#ffd4a7","#fff599","#c5dd9c","#7ec89d","#78ccc9","#85ddff","#87c5ff","#bd8fbf","#f69fc1","#f3704c","#fcaf59","#ffef4c","#abd072","#30b478","#00bab4","#00c8ff","#0092e6","#a868a9","#f175a8","#f12f22","#ff9c23","#f4d400","#7bb423","#00a350","#009991","#00afef","#0076c8","#93338f","#f02c8c","#9f190d","#a46206","#a79a00","#568228","#007036","#00726a","#0077a4","#004c80","#63155f","#a01a5c","#5f0e06","#734300","#675f00","#3a5919","#004b24","#00524c","#004c69","#00385f","#430d40","#701441"],fonts:{win:["Abadi MT Condensed Light","Aharoni","Aldhabi","Andalus","Angsana New","AngsanaUPC","Aparajita","Arabic Typesetting","Arial","Arial Black","Arial Nova","Batang","BatangChe","Book Antiqua","Browallia New","BrowalliaUPC","Calibri","Calibri Light","Calisto MT","Cambria","Cambria Math","Candara","Century Gothic","Comic Sans MS","Consolas","Constantia","Copperplate Gothic","Copperplate Gothic Light","Corbel","Cordia New","CordiaUPC","Courier New","DaunPenh","David","Dengxian","DFKai-SB","DilleniaUPC","DokChampa","Dotum","DotumChe","Ebrima","Estrangelo Edessa","EucrosiaUPC","Euphemia","FangSong","Franklin Gothic Medium","FrankRuehl","FreesiaUPC","Gabriola","Gadugi","Gautami","Georgia","Georgia Pro","Gill Sans Nova","Gisha","Gulim","GulimChe","Gungsuh","GungsuhChe","Impact","IrisUPC","Iskoola Pota","JasmineUPC","Javanese Text","KaiTi","Kalinga","Kartika","Khmer UI","KodchiangUPC","Kokila","Lao UI","Latha","Leelawadee","Leelawadee UI","Levenim MT","LilyUPC","Lucida Console","Lucida Handwriting Italic","Lucida Sans Unicode","Malgun Gothic","Mangal","Manny ITC","Marlett","Meiryo","Meiryo UI","Microsoft Himalaya","Microsoft JhengHei","Microsoft JhengHei UI","Microsoft New Tai Lue","Microsoft PhagsPa","Microsoft Sans Serif","Microsoft Tai Le","Microsoft Uighur","Microsoft YaHei","Microsoft YaHei UI","Microsoft Yi Baiti","MingLiU","PMingLiU","MingLiU-ExtB","PMingLiU-ExtB","MingLiU_HKSCS","MingLiU_HKSCS-ExtB","Miriam","Miriam Fixed","Mongolian Baiti","MoolBoran","MS Gothic","MS PGothic","MS Mincho","MS PMincho","MS UI Gothic","MV Boli","Myanmar Text","Narkisim","Neue Haas Grotesk Text Pro","News Gothic MT","Nirmala UI","NSimSun","Nyala","Palatino Linotype","Plantagenet Cherokee","Raavi","Rockwell Nova","Rod","Sakkal Majalla","Sanskrit Text","Segoe MDL2 Assets","Segoe Print","Segoe Script","Segoe UI","Segoe UI Emoji","Segoe UI Historic","Segoe UI Symbol","Shonar Bangla","Shruti","SimHei","SimKai","Simplified Arabic","SimSun","SimSun-ExtB","Sitka Banner","Sitka Display","Sitka Heading","Sitka Small","Sitka Subheading","Sitka Text","Sylfaen","Symbol","Tahoma","Times New Roman","Traditional Arabic","Trebuchet MS","Tunga","Urdu Typesetting","Utsaah","Vani","Verdana","Verdana Pro","Vijaya","Vrinda","Webdings","Westminster","Wingdings","Yu Gothic","Yu Gothic UI","Yu Mincho"],mac:["Al Bayan","American Typewriter","Andale Mono","Apple Casual","Apple Chancery","Apple Garamond","Apple Gothic","Apple LiGothic","Apple LiSung","Apple Myungjo","Apple Symbols","Arial","Arial Hebrew","Ayuthaya","Baghdad","Baskerville","Beijing","BiauKai","Big Caslon","Brush Script","Chalkboard","Chalkduster","Charcoal","Charcoal CY","Chicago","Cochin","Comic Sans","Cooper","Copperplate","Corsiva Hebrew","Courier","Courier New","DecoType Naskh","Devanagari","Didot","Euphemia UCAS","Fang Song","Futura","Gadget","Geeza Pro","Geezah","Geneva","Geneva CY","Georgia","Gill Sans","Gujarati","Gung Seoche","Gurmukhi","Hangangche","HeadlineA","Hei","Helvetica","Helvetica CY","Helvetica Neue","Herculanum","Hiragino Kaku Gothic Pro","Hiragino Kaku Gothic ProN","Hiragino Kaku Gothic Std","Hiragino Kaku Gothic StdN","Hiragino Maru Gothic Pro","Hiragino Maru Gothic ProN","Hiragino Mincho Pro","Hiragino Mincho ProN","Hoefler Text","Inai Mathi","Impact","Jung Gothic","Kai","Keyboard","Krungthep","KufiStandard GK","LastResort","LiHei Pro","LiSong Pro","Lucida Grande","Marker Felt","Menlo","Monaco","Monaco CY","Mshtakan","Nadeem","New Peninim","New York","NISC GB18030","Optima","Osaka","Palatino","Papyrus","PC Myungjo","Pilgiche","Plantagenet Cherokee","Raanana","Sand","Sathu","Seoul","Shin Myungjo Neue","Silom","Skia","Song","ST FangSong","ST Heiti","ST Kaiti","ST Song","Symbol","Tae Graphic","Tahoma","Taipei","Techno","Textile","Thonburi","Times","Times CY","Times New Roman","Trebuchet MS","Verdana","Zapf Chancery","Zapf Dingbats","Zapfino"]
}});b.default=e},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(1),h=d(g),i=function(){function a(){(0,f.default)(this,a)}return a.toRadians=function(b){return b*a.DEG_TO_RAD},a.toDegrees=function(b){return b*a.RAD_TO_DEG},a.getRotation=function(b,c){var d=c.x-b.x,e=c.y-b.y,f=Math.atan2(e,d);return a.toDegrees(f)},a.deltaTransformPoint=function(a,b){return{x:b.x*a.a+b.y*a.c+0,y:b.x*a.b+b.y*a.d+0}},a.getScaleX=function(a){return Math.sqrt(a.a*a.a+a.b*a.b)},a.getScaleY=function(a){return Math.sqrt(a.c*a.c+a.d*a.d)},a.getSkewX=function(b){var c=a.deltaTransformPoint(b,{x:0,y:1});return 180/Math.PI*Math.atan2(c.y,c.x)-90},a.getSkewY=function(b){var c=a.deltaTransformPoint(b,{x:1,y:0});return 180/Math.PI*Math.atan2(c.y,c.x)},a.snapTo=function(a,b){return Math.round(a/b)*b},a.toRoundDegreesByRadians=function(b){return Math.round(a.toDegrees(b))},a.toRoundRadiansByRadians=function(b){return a.toRadians(a.toRoundDegreesByRadians(b))},a.toRoundRadiansByDegrees=function(b){return a.toRadians(a.toRoundDegreesByDegrees(b))},a.toRoundDegreesByDegrees=function(a){return Math.round(a)},a.getModulusDegreesByRadians=function(b,c){return a.toRoundDegreesByRadians(b)%c},a.getModulusDegreesByDegrees=function(b,c){return a.toRoundDegreesByDegrees(b)%c},a.getScale=function(a,b){var c=b.width/a.width,d=b.height/a.height;return c<d?{min:c,max:d}:{min:d,max:c}},a.getSizeFitInBounds=function(a,b){var c=this.getScale(a,b);return new PIXI.Rectangle(0,0,c.min*a.width,c.min*a.height)},a.getRotationPointWithPivot=function(a,b,c){var d=b.x-a.x,e=b.y-a.y,f=Math.sqrt(d*d+e*e),g=180*Math.atan2(e,d)/Math.PI,h=(g+c)%360*Math.PI/180;return{x:a.x+f*Math.cos(h),y:a.y+f*Math.sin(h)}},a.getBoundsByRotationPoints=function(a){var b=Math.min(a.lt.x,a.rt.x,a.rb.x,a.lb.x),c=Math.min(a.lt.y,a.rt.y,a.rb.y,a.lb.y);return{x:b,y:c,width:Math.max(a.lt.x,a.rt.x,a.rb.x,a.lb.x)-b,height:Math.max(a.lt.y,a.rt.y,a.rb.y,a.lb.y)-c}},a.getBoundsByPoints=function(a){return{x:a.lt.x,y:a.lt.y,width:a.rb.x-a.lt.x,height:a.rb.y-a.lt.y}},a.convertCanvasMatrixToPixiMatrix=function(a){var b=new PIXI.Matrix;return b.a=a.m11,b.b=a.m21,b.c=a.m12,b.d=a.m22,b.tx=a.tx,b.ty=a.ty,b},a.toLocalPoints=function(a,b){var c={};for(var d in b)c[d]=a.applyInverse(b[d]);return c},a.getSizeByPoints=function(a){var b=a.rt.x-a.lt.x,c=a.rt.y-a.lt.y,d=Math.sqrt(b*b+c*c);return b=a.rt.x-a.rb.x,c=a.rt.y-a.rb.y,{width:d,height:Math.sqrt(b*b+c*c)}},a.triangleArea=function(a,b,c){return c.x*b.y-b.x*c.y-(c.x*a.y-a.x*c.y)+(b.x*a.y-a.x*b.y)},a.isInsideSquare=function(b,c,d,e,f){return!(a.triangleArea(b,c,d)>0||a.triangleArea(b,d,e)>0||a.triangleArea(b,e,f)>0||a.triangleArea(b,f,c)>0)},a.digit=function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;0===b&&(b=1);var c=Math.pow(10,b);return parseInt(a*c)/c},a.leadingZero=function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,c="";if(a=a.toString(),a.length<b)for(var d=0;d<b-a.length;d++)c+="0";return c+a},a.trace=function(b){return a.leadingZero(parseInt(b))},(0,h.default)(a,null,[{key:"DEG_TO_RAD",get:function(){return this._DEG_TO_RAD||(this._DEG_TO_RAD=Math.PI/180),this._DEG_TO_RAD}},{key:"RAD_TO_DEG",get:function(){return this._RAD_TO_DEG||(this._RAD_TO_DEG=180/Math.PI),this._RAD_TO_DEG}}]),a}();b.default=i},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(256),f=d(e),g=c(257),h=d(g),i=c(258),j=d(i),k=c(7),l=d(k),m=c(5),n=d(m),o={blog:f.default,post:h.default,pholar:j.default},p=[],q={_options:{serviceCode:null},setOptions:function(a){n.default.extend(!0,this._options,a)},log:function(a,b,c){this._canUseNclicks()&&a&&this._runNclicks(a,b,c)},_canUseNclicks:function(){return!!o[this._options.serviceCode]},_runNclicks:function(a,b,c){var d=o[this._options.serviceCode],e=d&&d.codes?d.codes[a]:null;e&&this._clickcr(d,e)},_clickcr:function(a,b){var c=a.ccsrv,d=b,e=a.nsc,f=(new Date).getTime(),g=l.default.addURLProtocol(c+"/cc?a="+d+"&nsc="+e+"&m=0&u=about%3Ablank&time="+f),h=new Image;p.push(h),h.src=g}};b.default=q},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(a instanceof Array)a.forEach(b);else if("number"==typeof a)for(var c=0;c<a;c++)b(c);else for(var d in a)if(b(a[d],d,a))break}function f(a,b){if(a instanceof Array)return a.every(b);if("number"==typeof a){for(var c=0;c<a;c++)if(!b(c))return!1;return!0}for(var d in a)if(!b(a[d],d,a))return!1;return!0}function g(a,b){var c=void 0;return a instanceof Array?a.map(b):("number"==typeof a?(c=[],e(a,function(a){c.push(b(a))})):(c={},e(a,function(a,d,e){c[d]=b(a,d,e)})),c)}function h(a,b){if(a instanceof Array)return a.filter(b);var c={};return e(a,function(a,d,e){b(a,d,e)&&(c[d]=a)}),c}function i(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(a instanceof Array)return a.reduce(b,c);var d=c;return e(a,function(a,c){d=b(a,d,c)}),d}function j(a,b){if(a instanceof Array)return a.indexOf(b);var c=null;return e(a,function(a,d){if(a==b)return c=d,!0}),c}function k(a){return void 0===a.length?null:a[a.length-1]}b.__esModule=!0,b.range=void 0;var l=c(30),m=d(l),n=c(174),o=d(n);b.each=e,b.every=f,b.map=g,b.filter=h,b.reduce=i,b.indexOf=j,b.lastOf=k;b.range=m.default.mark(function p(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.default,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return m.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(!(a<b)){d.next=6;break}return d.next=3,a;case 3:a+=c,d.next=0;break;case 6:case"end":return d.stop()}},p,this)})},function(a,b){var c=a.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=c)},function(a,b,c){var d=c(111)("wks"),e=c(85),f=c(18).Symbol,g="function"==typeof f;(a.exports=function(a){return d[a]||(d[a]=g&&f[a]||(g?f:e)("Symbol."+a))}).store=d},function(a,b,c){"use strict";b.__esModule=!0;var d={},e=["ko-KR","en-US","ja-JP","fr-FR"],f={ko:"ko-KR",en:"en-US",ja:"ja-JP",fr:"fr-FR"},g=e[0];e.forEach(function(a){d[a]=c(255)("./"+a).default});var h={_locale:g,setLang:function(a){a=f[a]||a,-1===e.indexOf(a)&&(a=g),this._locale=a},getMessages:function(){return d[this._locale]},getMessage:function(a){return d[this._locale][a]}};b.default=h},function(a,b,c){a.exports={"default":c(233),__esModule:!0}},function(a,b,c){a.exports={"default":c(246),__esModule:!0}},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(1),h=d(g),i=c(2),j=d(i),k=c(3),l=d(k),m=function(a){function b(c,d){(0,f.default)(this,b);var e=(0,j.default)(this,a.call(this));return e._stage=d,e._bitmapdata=e.stage.bitmapdata,e._options=c,e._update=null,e._ticker=PIXI.ticker.shared,e._filters=[],e._transforms=[],e._enlargable=!1,e._menu="controls",e._imageTransform=null,e}return(0,l.default)(b,a),b.prototype.start=function(){this.stage.magnify.compareOriginalEnable=this.comparable},b.prototype.suspend=function(){return this.stage.magnify.compareOriginalEnable=!1,!0},b.prototype.reset=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&this.invalidate()},b.prototype.dispose=function(){},b.prototype.snapshot=function(){return{}},b.prototype.fitToScreen=function(){this.stage.screenFitEnable&&this.stage.magnify.fitToScreen()},b.prototype.identity=function(){},b.prototype.invalidate=function(a){this._update(a)},b.prototype.pushHistory=function(a){this.stage.emit("pushHistory",{type:"pushHistory",target:this.stage,history:null})},(0,h.default)(b,[{key:"bitmapdata",get:function(){return this._bitmapdata}},{key:"options",get:function(){return this._options}},{key:"stage",get:function(){return this._stage}},{key:"filters",get:function(){return this._filters}},{key:"transforms",get:function(){return this._transforms}},{key:"modified",get:function(){return this._modified}},{key:"screenFitEnable",get:function(){return this.stage.screenFitEnable},set:function(a){this.stage.magnify.autoScale(a)}},{key:"enlargable",get:function(){return this._enlargable}},{key:"comparable",get:function(){return this._options.comparable}},{key:"running",get:function(){return!!this.stage._current&&this.stage._current._menu==this._menu}},{key:"ready",get:function(){return!0}},{key:"complete",get:function(){return!0}},{key:"pending",get:function(){return!1}},{key:"imageTransform",get:function(){return this._imageTransform}},{key:"imageFilter",get:function(){return null}},{key:"gl",get:function(){return this.stage.bitmapdata.gl}}]),b}(PIXI.utils.EventEmitter);b.default=m},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.createElement("canvas"),b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=b.alpha,d=void 0===c||c,e=b.antialias,f=void 0===e||e,g=b.depth,h=void 0===g||g,i=b.failIfMajorPerformanceCaveat,j=void 0===i||i,k=b.premultipliedAlpha,l=void 0===k||k,m=b.preserveDrawingBuffer,n=void 0!==m&&m,o=b.stencil,p=void 0!==o&&o,q={alpha:d,antialias:f,depth:h,failIfMajorPerformanceCaveat:j,premultipliedAlpha:l,preserveDrawingBuffer:n,stencil:p};return B.reduce(function(b,c){return b||a.getContext(c,q)},null)}function f(a){var b=a.getExtension("WEBGL_debug_renderer_info");return b?a.getParameter(b.UNMASKED_RENDERER_WEBGL):""}function g(a){var b=a.getExtension("WEBGL_debug_renderer_info");return b?a.getParameter(b.UNMASKED_VENDOR_WEBGL):""}function h(a,b,c){var d=a.createShader(b);if(a.shaderSource(d,c),a.compileShader(d),a.getShaderParameter(d,a.COMPILE_STATUS))return d;var e=a.getShaderInfoLog(d);throw a.deleteShader(d),new Error(e)}function i(a){for(var b=arguments.length,c=Array(b>1?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];return[a.VERTEX_SHADER,a.FRAGMENT_SHADER].map(function(b,d){return h(a,b,c[d])})}function j(a,b,c){var d=a.createProgram(),e=void 0;if(e="string"==typeof b?i(a,b,c):[b,c],e.forEach(function(b){return a.attachShader(d,b)}),a.linkProgram(d),a.getProgramParameter(d,a.LINK_STATUS))return d;var f=a.getProgramInfoLog(d);throw e.forEach(function(b){return a.deleteShader(b)}),a.deleteProgram(d),new Error(f)}function k(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a.ARRAY_BUFFER,d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:a.STATIC_DRAW,e=a.createBuffer();return a.bindBuffer(c,e),a.bufferData(c,b,d),e}function l(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a.STATIC_DRAW,d=a.createBuffer();return a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,d),a.bufferData(a.ELEMENT_ARRAY_BUFFER,b,c),d}function m(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a.ARRAY_BUFFER;return a.bindBuffer(c,b),a.getBufferParameter(c,a.BUFFER_SIZE)}function n(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},d=c.target,e=void 0===d?a.TEXTURE_2D:d,f=c.level,g=void 0===f?0:f,h=c.internalFormat,i=void 0===h?a.RGBA:h,j=c.type,k=void 0===j?a.UNSIGNED_BYTE:j,l=c.wrapS,m=void 0===l?a.REPEAT:l,n=c.wrapT,p=void 0===n?a.REPEAT:n,q=c.minFilter,r=void 0===q?a.NEAREST_MIPMAP_LINEAR:q,s=c.magFilter,t=void 0===s?a.LINEAR:s,u=c.generateMipmap,v=void 0===u||u,w={target:e,wrapS:m,wrapT:p,minFilter:r,magFilter:t},x=o(a,w);return a.bindTexture(e,x),a.texImage2D(e,g,i,i,k,b),v&&a.generateMipmap(e),a.bindTexture(e,null),x}function o(a,b){var c=b.target,d=void 0===c?a.TEXTURE_2D:c,e=b.wrapS,f=void 0===e?a.REPEAT:e,g=b.wrapT,h=void 0===g?a.REPEAT:g,i=b.minFilter,j=void 0===i?a.NEAREST_MIPMAP_LINEAR:i,k=b.magFilter,l=void 0===k?a.LINEAR:k,m=a.createTexture();return a.bindTexture(d,m),p(a,m,{target:d,wrapS:f,wrapT:h,minFilter:j,magFilter:l}),a.bindTexture(d,null),m}function p(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},d=c.target,e=void 0===d?a.TEXTURE_2D:d,f=c.wrapS,g=void 0===f?a.REPEAT:f,h=c.wrapT,i=void 0===h?a.REPEAT:h,j=c.minFilter,k=void 0===j?a.NEAREST_MIPMAP_LINEAR:j,l=c.magFilter,m=void 0===l?a.LINEAR:l;a.texParameteri(e,a.TEXTURE_WRAP_S,g),a.texParameteri(e,a.TEXTURE_WRAP_T,i),a.texParameteri(e,a.TEXTURE_MIN_FILTER,k),a.texParameteri(e,a.TEXTURE_MAG_FILTER,m)}function q(a,b,c){a.bindTexture(b,c);for(var d=new y.default([["TEXTURE_WRAP_S",0],["TEXTURE_WRAP_T",0],["TEXTURE_MIN_FILTER",0],["TEXTURE_MAG_FILTER",0]]),e=d,f=Array.isArray(e),g=0,e=f?e:(0,w.default)(e);;){var h;if(f){if(g>=e.length)break;h=e[g++]}else{if(g=e.next(),g.done)break;h=g.value}var i=h,j=i[0];i[1];d.set(j,u(a,a.getTexParameter(b,a[j])))}return a.bindTexture(b,null),d}function r(a){return{createShader:function(b,c){return h(a,b,c)},createShadersAll:function(b,c){return i(a,b,c)},createProgram:function(b,c){return j(a,b,c)},createBuffer:function(b){var c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.ARRAY_BUFFER,d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a.STATIC_DRAW;return k(a,b,c,d)},createIndexBuffer:function(b){var c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.STATIC_DRAW;return l(a,b,c)},bufferSize:function(b){var c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.ARRAY_BUFFER;return m(a,b,c)}}}function s(a,b,c,d){var e=arguments.length>4&&void 0!==arguments[4]?arguments[4]:a.createTexture();a.bindTexture(a.TEXTUER_2D,e),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,c,d,0,a.RGBA,a.UNSIGNED_BYTE,b),a.bindTexture(a.TEXTURE_2D,null)}function t(a,b){switch(b){case a.UNSIGNED_BYTE:case a.BYTE:return 1;case a.UNSIGNED_SHORT:case a.SHORT:return 2;case a.FLOAT:return 4}throw new Error("type을 알 수 없습니다.",u(b))}function u(a){for(var b in A)if(A[b]===a)return b;return null}b.__esModule=!0,b.bufferSize=b.createIndexBuffer=b.createBuffer=b.createProgram=b.createShadersAll=b.createShader=void 0;var v=c(45),w=d(v),x=c(126),y=d(x);b.getWebGLContext=e,b.getUnmaskedRenderer=f,b.getUnmaskedVender=g,b.createTexture=n,b.createAndSetTexParam=o,b.setTextureParams=p,b.getTextureParams=q,b.createGLUtility=r,b.imageDataToTexture=s,b.sizeof=t,b.keyof=u;var z=c(127),A=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b.default=a,b}(z),B=["webgl","experimental-webgl"];b.createShader=h,b.createShadersAll=i,b.createProgram=j,b.createBuffer=k,b.createIndexBuffer=l,b.bufferSize=m},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(170),f=d(e),g=c(0),h=d(g),i=c(1),j=d(i),k=c(47),l=d(k),m=c(17),n=c(32),o=["x","y","scaleX","scaleY","offsetX","offsetY","radian","canvasWidth","canvasHeight"],p=function(){function a(){(0,h.default)(this,a),this._matrix=new l.default,this.onConcat=null,this._canvasWidth=this._canvasHeight=-1,this.cacheWith=0,this.cacheHeight=0,this.identity()}return a.prototype.setTo=function(a){return a=a||{},this.offsetX=a.offsetX||0,this.offsetY=a.offsetY||0,this.scaleX=a.scaleX||1,this.scaleY=a.scaleY||1,this.radian=a.radian||0,this.canvasWidth=a.canvasWidth||-1,this.canvasHeight=a.canvasHeight||-1,this},a.prototype.setTransform=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,e=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,f=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,g=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;this.x=a,this.y=b,this.scaleX=c,this.scaleY=d,this.offsetX=e,this.offsetY=f,this.radian=g},a.prototype.equal=function(a){var b=this;return(0,m.every)(a,function(a,c){return b[c]==a})},a.prototype.prependTransforms=function(){var a=this.matrix;a.identity();for(var b=arguments.length,c=Array(b),d=0;d<b;d++)c[d]=arguments[d];c.reduce(function(a,b){return a.preppend(b.matrix),a},a),this.decompose()},a.prototype.evaluateMatrix=function(){if(0==this._radian)this._matrix.setTo(this._scaleX,0,0,this._scaleY,this._x-this._scaleX*this._offsetX,this._y-this._scaleY*this._offsetY);else{var a=this._radian,b=Math.cos(a),c=Math.sin(a),d=this._scaleX*b,e=this._scaleX*c,f=this._scaleY*-c,g=this._scaleY*b,h=this._x-d*this._offsetX-f*this._offsetY,i=this._y-e*this._offsetX-g*this._offsetY;this._matrix.setTo(d,f,e,g,h,i)}this._changed=!1},a.prototype.decompose=function(){var a=this.matrix.raw,b=Math.atan2(a[1],a[0]),c=Math.pow(a[0],2)+Math.pow(a[1],2),d=Math.sqrt(c),e=(a[0]*a[3]-a[2]*a[1])/d;Math.atan2(a[0]*a[2]+a[1]*a[3],c);this.radian=b,this.scaleX=d,this.scaleY=e,this.x=a[4],this.y=a[5]},a.prototype.identity=function(){this._offsetX=this._offsetY=0,this._x=this._y=0,this._scaleX=this._scaleY=1,this._radian=0,this._changed=!0,this._canvasWidth=this._canvasHeight=-1,this._matrix.identity()},a.prototype.rotate=function(a,b,c,d){var e=(0,f.default)(this.scaleX)*(0,f.default)(this.scaleY),g=this.matrix.applyInverse(b/2,c/2),h=new(Function.prototype.bind.apply(l.default,[null].concat(n.calcPivotRotateMatrix.apply(void 0,[e*a].concat(g))))),i=h.apply(this.offsetX,this.offsetY);if(d){var j=[c,b];b=j[0],c=j[1];var k=this.matrix.applyInverse(b/2,c/2),m=k.map(function(a,b){return a-g[b]});m=n.rotatei.apply(void 0,m.concat([e*a])),i=i.map(function(a,b){return a+m[b]})}this.offsetX=i[0],this.offsetY=i[1],this.canvasWidth=b,this.canvasHeight=c,this.radian=(this.radian+a)%(2*Math.PI)},a.prototype.save=function(){var a=this,b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return b=b||{},o.forEach(function(c){return b[c]=a[c]}),b},a.prototype.restore=function(a){this.setTo(a||{})},a.prototype.clone=function(){return{x:this.x,y:this.y,rotation:this.rotation,offsetX:this.offsetX,offsetY:this.offsetY,scaleX:this.scaleX,scaleY:this.scaleY,limitSize:this.limitSize,resize:this.resize,canvasWidth:this.canvasWidth,canvasHeight:this.canvasHeight,radian:this.radian,matrix:this.matrix.clone()}},a.prototype.copy=function(){var b=new a;return b.x=this.x,b.y=this.y,b.radian=this.radian,b.offsetX=this.offsetX,b.offsetY=this.offsetY,b.scaleX=this.scaleX,b.scaleY=this.scaleY,b.canvasWidth=this.canvasWidth,b.canvasHeight=this.canvasHeight,b},a.prototype.toString=function(){var b=[this._offsetX,this._offsetY,this._x,this._y,this._scaleX,this._scaleY,this._canvasWidth,this._canvasHeight,this._radian,this._radian*a.ANG];return"[Transform] offset(%s,%s), position(%s,%s), scale(%s,%s), size(%s,%s), radian(%s,%s)".replace(/%s+/g,function(){return b.shift()})},(0,j.default)(a,[{key:"modified",get:function(){return this.matrix.dirty||0!=this.offsetX||0!=this.offsetY||0!=this.x||0!=this.y||1!=this.scaleX||1!=this.scaleY||0!=this.radian}},{key:"matrix",get:function(){return this._changed&&this.evaluateMatrix(),this._matrix}},{key:"imatrix",get:function(){return this.matrix&&this.evaluateIMatrix(),this._imatrix}},{key:"limitSize",get:function(){return this._limitSize},set:function(a){this._limitSize!=a&&(this._limitSize=a,this._changed=!0)}},{key:"resize",get:function(){return this._resize},set:function(a){this._resize!=a&&(this._resize=a,this._changed=!0)}},{key:"canvasWidth",get:function(){return this._canvasWidth},set:function(a){this._canvasWidth!=a&&(this._canvasWidth=0|a)}},{key:"canvasHeight",get:function(){return this._canvasHeight},set:function(a){this._canvasHeight!=a&&(this._canvasHeight=0|a)}},{key:"offsetX",get:function(){return this._offsetX},set:function(a){this._offsetX!=a&&(this._offsetX=a,this._changed=!0)}},{key:"offsetY",get:function(){return this._offsetY},set:function(a){this._offsetY!=a&&(this._offsetY=a,this._changed=!0)}},{key:"x",get:function(){return this._x},set:function(a){this._x!=a&&(this._x=a,this._changed=!0)}},{key:"y",get:function(){return this._y},set:function(a){this._y!=a&&(this._y=a,this._changed=!0)}},{key:"scaleX",get:function(){return this._scaleX},set:function(a){this._scaleX!=a&&(this._scaleX=a,this._changed=!0)}},{key:"scaleY",get:function(){return this._scaleY},set:function(a){this._scaleY!=a&&(this._scaleY=a,this._changed=!0)}},{key:"radian",get:function(){return this._radian},set:function(a){this._radian!=a&&(this._radian=a,this._changed=!0)}},{key:"rotation",get:function(){return this._radian*a.ANG},set:function(b){this.radian=b*a.RAD}},{key:"changed",get:function(){return this._changed}}]),a}();b.default=p,p.ANG=180/Math.PI,p.RAD=Math.PI/180,p.TEMP=new p},function(a,b){a.exports=function(a){return"object"==typeof a?null!==a:"function"==typeof a}},function(a,b,c){a.exports=!c(50)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(a,b,c){var d=c(29),e=c(147),f=c(104),g=Object.defineProperty;b.f=c(27)?Object.defineProperty:function(a,b,c){if(d(a),b=f(b,!0),d(c),e)try{return g(a,b,c)}catch(h){}if("get"in c||"set"in c)throw TypeError("Accessors not supported!");return"value"in c&&(a[b]=c.value),a}},function(a,b,c){var d=c(26);a.exports=function(a){if(!d(a))throw TypeError(a+" is not an object!");return a}},function(a,b,c){a.exports=c(231)},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(21),f=d(e),g=c(0),h=d(g),i=c(2),j=d(i),k=c(1),l=d(k),m=c(3),n=d(m),o=c(88),p=d(o),q=c(263),r=d(q),s=c(275),t=d(s),u=c(73),v=d(u),w=c(52),x=d(w),y=c(278),z=d(y),A=c(181),B=d(A),C=c(322),D=d(C),E=c(327),F=d(E),G=c(74),H=d(G),I=c(330),J=d(I),K=c(336),L=d(K),M=c(337),N=d(M),O=c(339),P=d(O),Q=c(360),R=d(Q),S=c(364),T=d(S),U=c(365),V=(d(U),c(144)),W=d(V),X=c(92),Y=d(X),Z=c(366),$=d(Z),_=c(56),aa=d(_),ba=c(25),ca=d(ba),da=c(60),ea=d(da),fa=c(17),ga=c(32),ha=(c(53),c(48)),ia=c(33),ja=c(97),ka=d(ja),la=c(24),ma=c(44),na=d(ma),oa=c(93),pa=d(oa),qa=c(10),ra=c(39),sa=c(134),ta=(0,p.default)("name"),ua=(0,p.default)("glAvailable"),va=void 0,wa=void 0,xa=function(a){function b(c,d){var e=arguments.length>2&&void 0!==arguments[2]&&arguments[2],f=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2631720;(0,h.default)(this,b);var g=(0,j.default)(this,a.call(this,d,e,f));return g._options=(0,qa.pull)(c||b.defaultOptions,b.defaultOptions),g._ready=!1,va=(0,ha.makeLoadImage)(g.options.crossOrigin),wa=(0,ha.makeLoadImage)(g.options.filter.crossOrigin),ra.MAXIMUM_PROCESS=g.options.maximumProcess,ra.CONVOLUTION_DELAY=g.options.convolutionDelay,g.ver=b.VERSION,Y.default.shared||Y.default.initialize(new t.default(g._options.crossOrigin)),g._initmain(),g.renderer.roundPixels=!0,g}return(0,n.default)(b,a),(0,l.default)(b,null,[{key:"VERSION",get:function(){return"ver.2.0.0.16"}},{key:"READY",get:function(){return"ready"}},{key:"FILTER_READY",get:function(){return"filterReady"}},{key:"MASK_READY",get:function(){return"maskReady"}},{key:"IMAGE_READY",get:function(){return"imageReady"}},{key:"IMAGE_LOAD_FAIL",get:function(){return"imageLoadFail"}},{key:"BITMAPDATA_UPDATE",get:function(){return"bitmapDataUpdate"}},{key:"PROCESSING",get:function(){return"imageProcessing"}},{key:"PROCESS_COMPLETE",get:function(){return"imageProcessingComplete"}},{key:"EDIT_COMPLETE",get:function(){return"editImageComplete"}},{key:"MOUSE_CHILDREN_CHANGE",get:function(){return"mouseChildrenChange"}},{key:"PHASE_CHANGE",get:function(){return"phaseChange"}},{key:"PHASE_CHANGED",get:function(){return"phaseChanged"}},{key:"SAVE_MASK",get:function(){return"saveMask"}},{key:"RESTORE_MASK",get:function(){return"restoreMask"}},{key:"SAVE_RESIZE",get:function(){return"saveResize"}},{key:"RESTORE_RESIZE",get:function(){return"restoreResize"}},{key:"SAVE_CROP",get:function(){return"saveCrop"}},{key:"RESTORE_CROP",get:function(){return"restoreCrop"}},{key:"VIEWPORT_MOTION_UPDATE",get:function(){return"viewportChanged"}},{key:"VIEWPORT_MOTION_COMPLETE",get:function(){return"viewportMotionComplete"}},{key:"TARGET_VIEWPORT_CHANGE",get:function(){return"targetViewportChange"}},{key:"UPDATE_SHARPEN_FACTOR",get:function(){return"updateSharpenFactor"}},{key:"CLEAR_ALL",get:function(){return"clearAll"}},{key:"INVALID_IMAGE_SRC",get:function(){return"invalidImageSrc"}},{key:"OUT_OF_MEMORY",get:function(){return"OUT_OF_MEMORY"}},{key:"defaultOptions",get:function(){return{magnify:{fitToScreen:!0,minZoom:1,maxZoom:5,scaleMotion:"easeOut",zoomMotion:"easeOut",scaleDuration:300,zoomDuration:500,zoomButtonDt:.1,minimumLimit:.1,maximumLimit:10,compareEnableBoundary:10,showOriginalDelay:400},resize:{},adjust:{},filter:{crossOrigin:null,interpolate:!1,defaultValue:.5,colorTableURLs:["./img/foodie/f_BQ_01.png","./img/foodie/f_BQ_02.png","./img/foodie/f_BQ_03.png","./img/foodie/f_CH_01.png","./img/foodie/f_CH_02.png","./img/foodie/f_CH_03.png","./img/foodie/f_CH_04.png","./img/foodie/f_CR_01.png","./img/foodie/f_CR_02.png","./img/foodie/f_FR_01.png","./img/foodie/f_FR_02.png","./img/foodie/f_FR_03.png","./img/foodie/f_RO_01.png","./img/foodie/f_RO_02.png","./img/foodie/f_RO_03.png","./img/foodie/f_RO_04.png","./img/foodie/f_RO_05.png","./img/foodie/f_SW_01.png","./img/foodie/f_SW_02.png","./img/foodie/f_SW_03.png","./img/foodie/f_YU_01.png","./img/foodie/f_YU_04.png"]},crop:{offsetX:0,offsetY:0,viewport:this.viewport},signature:{renderOnClient:!0,snapRangeRatio:20,lineWidth:1,lineColor:65357,lineAlpha:1,positionType:"rb",w:10,h:10,exitBtnImageURL:"img/sign_close.png",exitBtnMouseoverImageURL:"img/sign_close_hover.png"},sticker:{horizontalGap:10,verticalGap:5,useSnap:!0,snapAngle:5,deleteButtonOffsetY:0,crossOrigin:null},text:{horizontalGap:10,verticalGap:5,useSnap:!0,snapAngle:5,deleteButtonOffsetY:0},mosaic:{modes:[{name:"square1",size:10,color:16777215,alpha:1},{name:"square2",size:15,color:16777215,alpha:1},{name:"square3",size:20,color:16777215,alpha:1},{name:"square4",size:30,color:16777215,alpha:1},{name:"square5",size:40,color:16777215,alpha:1},{name:"circle1",size:10,color:16777215,alpha:1},{name:"circle2",size:15,color:16777215,alpha:1},{name:"circle3",size:20,color:16777215,alpha:1},{name:"circle4",size:30,color:16777215,alpha:1},{name:"circle5",size:40,color:16777215,alpha:1}]},clip:{assets:["img/mask/mask-oval.svg","img/mask/mask-triangle.svg","img/mask/mask-round-square.svg","img/mask/mask-polygon.svg","img/mask/mask-star-1.svg","img/mask/mask-star-2.svg","img/mask/mask-round-star.svg"],useSnap:!0,snapAngle:5,dimmedOpacity:.6,useDelete:!1,viewport:this.viewport,entry:{index:-1,lineWidth:2,color:"#ffffff",opacity:1},polygons:[[150],[[165,0],[330,300],[0,300]],[[0,20],[.6814834742186342,14.823619097949585],[2.679491924311222,10.000000000000005],[5.857864376269045,5.857864376269051],[9.999999999999991,2.679491924311229],[14.823619097949587,.6814834742186342],[20,0],[280,0],[285.1763809020504,.6814834742186306],[290,2.679491924311229],[294.14213562373095,5.857864376269045],[297.3205080756888,9.999999999999991],[299.3185165257814,14.823619097949585],[300,20],[300,280],[299.3185165257814,285.1763809020504],[297.3205080756888,290],[294.14213562373095,294.14213562373095],[290,297.3205080756888],[285.1763809020504,299.3185165257814],[280,300],[20,300],[14.823619097949587,299.3185165257814],[10.000000000000004,297.3205080756888],[5.857864376269051,294.14213562373095],[2.679491924311229,290],[.6814834742186378,285.1763809020504],[0,280]],[[167.5,0],[335,122.23],[271.02,320],[63.98,320],[0,122.23]],[[162.5,0],[325,118.409],[262.93,310],[62.07,310],[0,118.41]],[160],[[335,212.38148973221305],[290.118510267787,290.118510267787],[212.38148973221308,335],[122.61851026778695,335],[44.88148973221308,290.118510267787],[0,212.3814897322131],[0,122.61851026778697],[44.881489732213,44.88148973221308],[122.61851026778686,0],[212.38148973221303,0],[290.11851026778686,44.881489732212955],[335,122.61851026778686]]]},originalMaxSize:3e3,editingFilterAsyncMode:!1,previewSharpenFactor:1.5,maximumProcess:1e5,convolutionDelay:30,viewportDuration:300,autoRotateSize:1600,editingResizeRatio:.5,previewingResizeRatio:0,canvasLimitSize:8e3,crossOrigin:null,webglFilterEnable:!0,useControls:["filter","crop","resize","adjust","mosaic","signature","sticker","text","clip"],controlsMap:{filter:D.default,crop:H.default,resize:B.default,adjust:z.default,mosaic:F.default,signature:L.default,sticker:J.default,text:N.default,clip:P.default},transformOrder:["clip","crop","resize"],filterOrder:["AutoAdjustment","FoodieFilter","SharpenAdjustment","MosaicFilter","ColorTransformFilter"],editingTransform:{transforms:["crop"],resizeTransforms:["resize"],maxSize:1600,addTo:"resizeTransforms"},previewingTransform:{transforms:["crop","resize"],resizeTransforms:[],maxSize:600,addTo:"transforms"},glTransform:{editingTransform:{transforms:["crop"],resizeTransforms:["resize"],maxSize:3e3,addTo:"resizeTransforms"},previewingTransform:{transforms:["crop","resize"],resizeTransforms:[],maxSize:1200,addTo:"transforms"}}}}}]),b.prototype.reset=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,b=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._editingBmpd.clear(),this._previewingBmpd.clear(),this.restore(a),b&&this.updateBitmapData()},b.prototype.clear=function(){var a=this.bitmapdata.canvas,c=a.getContext("2d");c.setTransform(1,0,0,1,0,0),c.clearRect(0,0,a.width,a.height),this.emit(b.CLEAR_ALL),this.clearBitmapDatas(),this.clearMask()},b.prototype.clearMask=function(){this._maskStroke&&this._maskStroke.parent&&this._maskStroke.parent.removeChild(this._maskStroke)},b.prototype.clearBitmapDatas=function(){this._editingBmpd.clear(),this._previewingBmpd.clear()},b.prototype.dispose=function(){var b=this;a.prototype.dispose.call(this),this._options.useControls.forEach(function(a){b[a].dispose()}),this.magnify.dispose(),this.motion.dispose(),this.canvas.width=this.canvas.width,this._editingCanvas.texture.destroy(),this._renderer.destroy(),this._viewportMotion&&(this._viewportMotion.stop(),this._viewportMotion.off("update",this.onViewportUpdate,this))},b.prototype.setImageByURL=function(a){var b=this,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,d=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this._ready=!1,this._img=document.createElement("img"),va(a,this._img).then(function(a){return b.setImageByElement(a,c,d)}).catch(this.onImageLoadFail)},b.prototype.unload=function(){this._ready||this._img&&(this._img.src="#")},b.prototype.setImageByElement=function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,c=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this.clearBitmapDatas(),this._setEditingImage(a),this._setPreviewingImage(a),this.reset(b),this.updateBitmapData(),this.root.scale.x=this.root.scale.y=1,this.magnify.updateTargetTexture(this._editingCanvas.texture.frame,(0,A.getEditingScale)(this.bitmapdata.canvas.width,this.resizedWidth,this.resizedHeight,this._options.originalMaxSize)),this.magnify.boundary=this.magnify.boundary,this._align(),this._ready=!0,this.onAllMenuReady(c).then(this.readyToEdit)},b.prototype.setExternalAssets=function(a,b){var c=this;return this.setFilterColorTables(a).then(function(){return c.setMaskAssets(b)})},b.prototype.setMaskAssets=function(a){var c=this;return this.clip.loadAssets(a).then(function(){return c.emit(b.MASK_READY,{target:c,type:b.MASK_READY})})},b.prototype.setFilterColorTables=function(a){var c=this;if(!a)return f.default.resolve();var d=a.map(function(a){return wa(a)});return f.default.all(d).then(function(a){return c.filter.onColorTableLoadComplete(a)}).then(function(){return c.emit(b.FILTER_READY,{target:c,type:b.FILTER_READY})})},b.prototype.readyToEdit=function(){var a=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.screenFitEnable?this.magnify.fitToScreen(!0):this.magnify.alignToCenter(),a?(this.emit(b.IMAGE_READY,{type:b.IMAGE_READY,target:this}),this):this},b.prototype.onAllMenuReady=function(){var a=this,b=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],c=this._options.useControls.map(function(b){return a.onSingleMenuReady(a[b])});return f.default.all(c).then(function(){return f.default.resolve(b)})},b.prototype.onSingleMenuReady=function(a){return new f.default(function(c,d){a.ready?c(a):a.once(b.READY,function(){
return c(a)})})},b.prototype.snapshot=function(){var a=this,b={};return this.options.useControls.forEach(function(c){var d=a[c].snapshot();d&&(d.modified=a[c].modified),b[c]=d}),this.signature&&(b.screenFitEnable=this.screenFitEnable),b},b.prototype.restore=function(a){var b=this;a=a||{},this.options.useControls.forEach(function(c){b[c].reset(a[c])}),void 0!==a.screenFitEnable&&(this.screenFitEnable=a.screenFitEnable),this._alignStickersDepth()},b.prototype.save=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,d=this,e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"image/jpeg",f=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;return null==a?this.saveASync(c,e,f):this.setImageByURL(a,b,!1).then(function(){return d.saveASync(c,e,f)})},b.prototype.saveASync=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,b=this,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"image/jpeg",d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.92,e=this._editingBmpd;return this._encode=c,this._encodeOption=d,this.updateImageTransformControls(this.options.originalMaxSize),e.save(this.imageTransformControls.imageTransforms,e.filters,a||void 0).then(function(a){return b.onProcessComplete(a)})},b.prototype.updateBitmapData=function(){this.updateImageTransformControls(this.editingMaxSize,!0),this._editingBmpd.transforms=this.imageTransformControls.simpleTransforms,this._editingBmpd.update(this.async,this.onProcessing,this.onEditingProcessComplete),this.updateClippingRect(),this.updateSignContainer(),this.updateStickerContainer(),this._previewEnabled=Math.max(this.bitmapdata.transformedWidth,this.bitmapdata.transformedHeight)>this.previewingMaxSize&&!this.imageTransformControls.mask.modified,this.updateImageTransformControls(this.previewingMaxSize,!1),this._previewingBmpd.updateImageTransforms(this.imageTransformControls.simpleTransforms);var a=this._previewingBmpd.transformedWidth/this._editingBmpd.transformedWidth;this.emit(b.UPDATE_SHARPEN_FACTOR,Math.min(1,a*this.options.previewSharpenFactor),a),this.showPreview&&this._previewingBmpd.updateFilters(null),this._previewingBmpd.updateCanvas(),this.async||this.emitBitmapDataUpdate()},b.prototype.updateImageTransformControls=function(a){var b=arguments.length>1&&void 0!==arguments[1]&&arguments[1],c=this.imageTransformControls,d=c.resize;d.maximum=a,d.updateResizedSize=b},b.prototype.updateClippingRect=function(){var a=this._maskGraphic,b=this.bitmapdata.canvas.width,c=this.bitmapdata.canvas.height;a.clear(),a.drawRect(0,0,b,c);var d=this.imageTransformControls.mask,e=d.stroke;this._objectContainer.mask!=a&&(this._objectContainer.mask=a),this._maskStroke.texture&&this._maskStroke.texture.destroy(),d.modified?(this._maskStroke.texture=new r.default.Texture(new r.default.BaseTexture(e.strokeCanvas)),this._rootMask.clear(),ka.default.drawSVG(this._rootMask,this.clip.maskSource),this.enableMask()):this.disableMask()},b.prototype.enableMask=function(){var a=this.imageTransformControls.mask,b=a.stroke;if(a.modified){this._objectContainer.addChild(this._maskStroke),this._maskContainer.addChild(this._rootMask),this._maskContainer.mask=this._rootMask;var c=b.maskWidth,d=b.maskHeight,e=ca.default.TEMP;e.prependTransforms.apply(e,this.imageTransformControls.transforms.slice(2,3)),this.applyTransformTo(this._rootMask,e,c/b.sourceWidth,d/b.sourceHeight),this.applyTransformTo(this._maskStroke,e)}},b.prototype.disableMask=function(){var a=this.imageTransformControls.mask;return this._maskStroke.parent&&this._maskStroke.parent.removeChild(this._maskStroke),this._maskContainer.mask=null,a.modified?[this._maskStroke,this._rootMask]:[]},b.prototype.updateSpecificFilter=function(a){this._editingBmpd.updateFilters(a),this._editingBmpd.updateCanvas()},b.prototype.updateSignContainer=function(){var a=this.resizedWidth,b=this.resizedHeight,c=this.options.originalMaxSize,d=Math.max(a,b),e=Math.min(a,b),f=Math.max(c/d,1/e);f<1&&(a=a*f|0,b=b*f|0),this.signatureContainer.updateSize(a,b),this.signatureContainer.width=this._editingCanvas.width,this.signatureContainer.height=this._editingCanvas.height},b.prototype.updateStickerContainer=function(){var a=this.bitmapdata.worldTransform;this.applyTransformTo(this.stickerContainer,a)},b.prototype.applyTransformTo=function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;a&&(a.scale.x=b.scaleX*c,a.scale.y=b.scaleY*d,a.x=b.x,a.y=b.y,a.rotation=b.radian,a.pivot.x=b.offsetX,a.pivot.y=b.offsetY)},b.prototype.emitBitmapDataUpdate=function(){this._bitmapDataUpdateEvent.cropWidth=this.maskedWidth,this._bitmapDataUpdateEvent.cropHeight=this.maskedHeight,this.emit(this._bitmapDataUpdateEvent.type,this._bitmapDataUpdateEvent)},b.prototype.viewportTo=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,e=this,f=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,g=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"easeOut";this._targetvp=this._targetvp||{};var h={},i={x:a,y:c,width:d,height:f};(0,fa.each)(i,function(a,b){-1!=a&&(h[b]=a),e._targetvp[b]=-1==a?e.viewport[b]:a}),this._viewportMotion.play(this.viewport,h,this.options.viewportDuration,x.default[g]),"main"==this.phase?this.magnify.viewportTo(h,!1):this._current.screenFitEnable&&this.magnify.viewportTo(h,this._current.enlargable),this.emit(b.TARGET_VIEWPORT_CHANGE)},b.prototype.toDataURL=function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"image/jpeg",d=this._editingBmpd.canvas,e=qa.__context.canvas;return e.width=a,e.height=b,(0,ia.resizeImage)(d,qa.__context),this.drawRenderableObjects(qa.__context,!0),e.toDataURL(c)},b.prototype.toImageElement=function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,d=this._editingBmpd.canvas,e=qa.__context.canvas;return c=c||document.createElement("img"),e.width=a,e.height=b,(0,ia.resizeImage)(d,qa.__context),c.src=e.toDataURL("image/jpeg",.92),c},b.prototype.drawRenderableObjects=function(a){var b=this,c=arguments.length>1&&void 0!==arguments[1]&&arguments[1];a.save(),a.setTransform(1,0,0,1,0,0);var d=this.signatureContainer,e=d.actualWidth,f=d.actualHeight,g=this.getEditingScaleGap(d);(c?[this.stickerContainer,this.signatureContainer]:[this.stickerContainer]).forEach(function(c,d){if(0!=c.children.length){var h=qa.__renderableContext.canvas,i=c.scale.x,j=c.scale.y;g>1&&(c.scale.x*=g,c.scale.y*=g,c.updateTransform()),h.width=e,h.height=f,qa.__renderableContext.setTransform(1,0,0,1,0,0),qa.__renderableContext.clearRect(0,0,h.width,h.height),(0,qa.makeDrawCallbackInClosure)(qa.__renderableContext,null,!0).call(b,c),(0,ia.resizeImage)(h,a),c.scale.x=i,c.scale.y=j}}),a.restore()},b.prototype.getEditingScaleGap=function(a){return(0|a.actualWidth)/a.width},b.prototype.drawFilterThumbnails=function(a){if(!this.filter.complete)throw new Error("FoodieFilter ColorTable이 로드되지 않았습니다.");if(0==a.length)throw new Error("썸네일을 그릴 canvas element가 없습니다.");var b=0,c=a.length,d=void 0,e=new sa,f=a[0].width,g=a[0].height;qa.__context.canvas.width=f,qa.__context.canvas.height=g,(0,ia.resizeImage)(this.bitmapdata.source,qa.__context);for(var h=qa.__context.getImageData(0,0,f,g),i=qa.__context.getImageData(0,0,f,g);b<c;b++)d=a[b].getContext("2d"),e.colorTable=this.filter.colorTables[b],e.applyFilter(h,i),d.putImageData(i,0,0)},b.prototype.viewportToLocal=function(a){var b=this.rectToLocal(this.viewport,a),c={origin:b.tl,width:(0,ga.getDistance)(b.tl.x,b.tl.y,b.tr.x,b.tr.y),height:(0,ga.getDistance)(b.tl.x,b.tl.y,b.bl.x,b.bl.y),radian:(0,ga.getRadian)(b.tl.x,b.tl.y,b.tr.x,b.tr.y)};return a.scale.x<0?c=a.scale.y<0?{origin:b.br,width:(0,ga.getDistance)(b.br.x,b.br.y,b.bl.x,b.bl.y),height:(0,ga.getDistance)(b.br.x,b.br.y,b.tr.x,b.tr.y),radian:(0,ga.getRadian)(b.br.x,b.br.y,b.bl.x,b.bl.y)}:{origin:b.tr,width:(0,ga.getDistance)(b.tr.x,b.tr.y,b.tl.x,b.tl.y),height:(0,ga.getDistance)(b.tr.x,b.tr.y,b.br.x,b.br.y),radian:(0,ga.getRadian)(b.tr.x,b.tr.y,b.tl.x,b.tl.y)}:a.scale.y<0&&(c={origin:b.bl,width:(0,ga.getDistance)(b.bl.x,b.bl.y,b.br.x,b.br.y),height:(0,ga.getDistance)(b.bl.x,b.bl.y,b.tl.x,b.tl.y),radian:(0,ga.getRadian)(b.bl.x,b.bl.y,b.br.x,b.br.y)}),c},b.prototype.imageToLocal=function(a){this.updateTransform();var b=this.editingSprite,c=[{x:0,y:0},{x:this.bitmapdata.width,y:this.bitmapdata.height}].map(function(a){return b.toGlobal(a)}),d=c[0].x,e=c[0].y,f=c[1].x,g=c[1].y;return this.rectToLocal({x:Math.min(d,f),y:Math.min(e,g),width:Math.abs(d-f),height:Math.abs(e-g)},a)},b.prototype.rectToLocal=function(a,b){this.root.updateTransform();var c=a.x+a.width,d=a.y+a.height;return(0,fa.map)({tl:{x:a.x,y:a.y},tr:{x:c,y:a.y},bl:{x:a.x,y:d},br:{x:c,y:d}},function(a){return b.toLocal(a,null,a)})},b.prototype.getModifiedStateAt=function(a){return!!this[a]&&this[a].modified},b.prototype.getUsingMenu=function(a){return null!=this[a]},b.prototype.getImageBounds=function(){var a=this;if(this.editingSprite.texture.noFrame)return null;var b=this.editingSprite.texture.width,c=this.editingSprite.texture.height,d={lt:{x:0,y:0},rt:{x:b,y:0},lb:{x:0,y:c},rb:{x:b,y:c}},e=(0,fa.map)(d,function(b){return a.editingSprite.toGlobal(b)});return{x:e.lt.x,y:e.lt.y,width:e.rt.x-e.lt.x,height:e.lb.y-e.lt.y}},b.prototype._initmain=function(){this._phase="main",this._current=null,this._filters=null,this._screenFitEnable=!1,this._initGLAvailable(),this._initEvents(),this._makeBitmaps(),this._initMotions(),this._initControls()},b.prototype._initGLAvailable=function(){var a=(0,la.getWebGLContext)();this[ua]=a&&parseInt(a.MAX_TEXTURE_SIZE)>3e3&&this._checkAvailableVGA((0,la.getUnmaskedRenderer)(a))},b.prototype._checkAvailableVGA=function(a){return!(!a||""==a)&&!/Intel[()\w\s\/\\]+Express Chipset/gi.test(a)},b.prototype._initEvents=function(){this._processingEvent={type:b.PROCESSING,target:this,processed:0,total:0,filter:""},this._editingCompleteEvent={type:b.EDIT_COMPLETE,target:this},this._bitmapDataUpdateEvent={type:b.BITMAPDATA_UPDATE,target:this,cropWidth:0,cropHeight:0},this._viewportMotionCompleteEvent={type:b.VIEWPORT_MOTION_COMPLETE,target:this,phase:"main"},this.setImageByElement=this.setImageByElement.bind(this),this.onImageLoadFail=this.onImageLoadFail.bind(this),this.onUpdateBitmapData=this.onUpdateBitmapData.bind(this),this.onProcessing=this.onProcessing.bind(this),this.onProcessComplete=this.onProcessComplete.bind(this),this.onEditingProcessComplete=this.onEditingProcessComplete.bind(this),this.readyToEdit=this.readyToEdit.bind(this)},b.prototype._makeBitmaps=function(){var a=this;if(this.glAvailable&&na.default.initializeFilterContext((0,la.getWebGLContext)(void 0,{depth:!1,premultipliedAlpha:!1})),this._editingBmpd=this.glAvailable?new T.default:new W.default,this._previewingBmpd=this.glAvailable?new T.default:new W.default,this.glAvailable){var b=new pa.default(na.default.shared);this._editingBmpd.drawGLImage=b,this._previewingBmpd.drawGLImage=b}this.onEditingCanvasChanged=this.onEditingCanvasChanged.bind(this),this.onPreviewingCanvasChanged=this.onPreviewingCanvasChanged.bind(this),[[this._editingBmpd,this.options.editingResizeRatio,"Editing Bitmapdata",this.onEditingCanvasChanged],[this._previewingBmpd,this.options.previewingResizeRatio,"Previewing Bitmapdata",this.onPreviewingCanvasChanged]].forEach(function(b){var c=b[0],d=b[1],e=b[2],f=b[3];c.oomCallback=a.outofmemory,c.resizeRatio=d,c._bitmapType=e,c.canvas.addEventListener("change",f)}),this._editingCanvas=new r.default.Sprite,this._previewingCanvas=new r.default.Sprite,this._previewingCanvas.visible=!1,this._container=new r.default.Container,this._container.interactive=!0,this._stickerLayer=new aa.default,this._stickerLayer.interactive=!0,this._signLayer=new aa.default,this._signLayer.interactive=!1,this._objectContainer=new r.default.Container,this._objectContainer.interactive=!1,this._frameLayer=new aa.default,this._frameLayer.interactive=!1,this._maskLayer=new r.default.Container,this._maskLayer.interactive=!1,this._maskContainer=new r.default.Container,this._maskContainer.interactive=!1,this._maskGraphic=new r.default.Graphics,this._maskGraphic.interactive=!1,this._maskStroke=new r.default.Sprite,this._maskStroke.interactive=!1,this._rootMask=new r.default.Graphics;var c=this._maskContainer;c.addChild(this._editingCanvas),c.addChild(this._previewingCanvas),c.addChild(this._objectContainer),this._objectContainer.addChild(this._stickerLayer),this._objectContainer.addChild(this._signLayer),this._objectContainer.addChild(this._maskStroke),this._objectContainer.addChild(this._maskGraphic),c=this.root,c.addChild(this._maskContainer),c.addChild(this._frameLayer),this.addChild(c),this.addChild(this._maskLayer)},b.prototype._initMotions=function(){this._motion=new x.default,this._motion.name="stageMotion",this._viewportMotion=new x.default,this._viewportMotion.on("update",this.onViewportUpdate,this),this._viewportMotion.on("complete",this.onViewportComplete,this),this._viewportMotion.name="viewportMotion"},b.prototype._initControls=function(){var a=this;this._magnify=new v.default(this._options.magnify,this,this.canvas),this._magnify.initWithTarget(this.root),this._options.useControls.forEach(this._makeControls,this),this._imageTransformControls=new(Function.prototype.bind.apply(R.default,[null].concat(this._retrieveImageTransforms(this.options.transformOrder)))),this._filters=this._retrieveFilter(this.options.filterOrder),this._editingBmpd.filters=this._filters.slice(),this._previewingBmpd.filters=this._filters.slice(),this.mosaic&&(this._previewingBmpd.filters[this.options.filterOrder.indexOf("MosaicFilter")]=this.mosaic.previewingFilter),this.adjust&&(this._previewingBmpd.filters[this.options.filterOrder.indexOf("SharpenAdjustment")]=this.adjust._sharpenPreview),this.viewport=new r.default.Rectangle(0,0,this.canvas.width,this.canvas.height);var b=this.options.useControls.map(function(b){return a._menuReady(b)});f.default.all(b).then(function(b){return a.onPhotoEditorReady()})},b.prototype._menuReady=function(a){var b=this[a];return new f.default(function(a,c){b||a(null),b.complete&&a(b),b.pending||a(b),b.once("ready",function(){return a(b)})})},b.prototype._makeControls=function(a){var b="_"+a,c=this._options.controlsMap[a],d=this._options[a];switch(a){case"adjust":case"filter":case"resize":case"crop":case"clip":this[b]=new c(d,this,this.maskContainer);break;case"mosaic":this[b]=new c(d,this,this._previewingBmpd),this.mosaic.initWithTarget(this.root);break;case"signature":this[b]=new c(d,this,this.signatureContainer);break;case"photoFrame":this[b]=new c(d,this,this.photoFrameContainer);break;case"sticker":case"text":this[b]=new c(d,this,this.stickerContainer);break;default:void 0}this[b]&&(this[b]._update=this.onUpdateBitmapData,this[b]._menu=a)},b.prototype._retrieveImageTransforms=function(a){var b=this;return a.map(function(a){return b[a]?b[a].imageTransform:void 0})},b.prototype._appendTransformsTo=function(a,b){var c=this,d=[];b.forEach(function(a){var b=c[a];b&&d.push.apply(d,b.transforms)}),a.push.apply(a,d)},b.prototype._retrieveFilter=function(a){var b,c,d=this,e=[];return this.options.useControls.forEach(function(f){b=d[f].filters;for(var g=0;g<b.length;g++)c=a.indexOf(b[g].name),(0,ea.default)(-1!=c,b[g].name+" 필터의 순서를 알 수 없습니다."),e[c]=b[g]}),(0,qa.removeNullPointer)(e),e},b.prototype._setEditingImage=function(a){var b=this,c=a.width||a.naturalWidth,d=a.height||a.naturalHeight;this._options.useControls.forEach(function(a){b[a]&&b[a].identity(c,d)}),this.signatureContainer.updateSize(c,d),this.stickerContainer.updateSize(c,d),this._setTextureAt(a,this._editingBmpd,this._editingCanvas)},b.prototype._setPreviewingImage=function(a){this._setTextureAt(a,this._previewingBmpd,this._previewingCanvas)},b.prototype._setTextureAt=function(a,b,c){b.initWithSource(a),c.texture&&c.texture.destroy(),c.texture=new r.default.Texture(new r.default.BaseTexture(b.canvas))},b.prototype._textureUVUpdate=function(a,b,c){if(a.baseTexture&&a.baseTexture.source){a.baseTexture.update();var d=a.frame;d.width=b,d.height=c,a.frame=d}},b.prototype._align=function(){this._container.x=this.viewport.x+this.viewport.width/2,this._container.y=this.viewport.y+this.viewport.height/2},b.prototype._alignStickersDepth=function(){this.stickerContainer&&this.stickerContainer.children.sort(function(a,b){return a.childIndex<b.childIndex?-1:a.childIndex>b.childIndex?1:0})},b.prototype.onUpdateBitmapData=function(a){this._changedFilter=a,-1==this.renderer.listeners("prerender").indexOf(this.onInvalidate)&&this.renderer.on("prerender",this.onInvalidate,this)},b.prototype.onPhotoEditorReady=function(){var a=this;setTimeout(function(){a.emit(b.READY,{type:b.READY,target:a})},10)},b.prototype.onInvalidate=function(a){if(this.renderer.off("prerender",this.onInvalidate,this),!this._changedFilter)return void this.updateBitmapData();this.showPreview?(this._previewingBmpd.updateFilters(this._getPreviewFilter(this._changedFilter)),this._previewingBmpd.updateCanvas()):this.async?this._editingBmpd.updateFiltersAsync(this._changedFilter,this.onProcessing,this.onEditingProcessComplete):this.updateSpecificFilter(this._changedFilter)},b.prototype._getPreviewFilter=function(a){if(!a)return a;var b=this.adjust?this.adjust._sharpen:null,c=this.mosaic?this.mosaic._mosaic:null;switch(a){case b:return this._adjust._sharpenPreview;case c:return this._mosaic._mosaic}return a},b.prototype.onEditingCanvasChanged=function(a){this._textureUVUpdate(this._editingCanvas.texture,a.target.width,a.target.height),this.magnify.updateTargetTexture(this._editingCanvas.texture.frame,(0,A.getEditingScale)(this.bitmapdata.canvas.width,this.resizedWidth,this.resizedHeight,this._options.originalMaxSize)),this._previewingCanvas.width=this._editingCanvas.width,this._previewingCanvas.height=this._editingCanvas.height,this._signLayer.width=this._editingCanvas.width,this._signLayer.height=this._editingCanvas.height,"resize"==this.phase?(this._align(),this.magnify._checkBoundary(),this.magnify.alignToCenter()):this.screenFitEnable&&this.magnify.fitToScreen()},b.prototype.onPreviewingCanvasChanged=function(a){this._textureUVUpdate(this._previewingCanvas.texture,a.target.width,a.target.height),this._previewingCanvas.width=this._editingCanvas.width,this._previewingCanvas.height=this._editingCanvas.height},b.prototype.onViewportUpdate=function(){this.viewport=this.viewport},b.prototype.onViewportComplete=function(){this._viewportMotionCompleteEvent.phase=this.phase,this.emit(b.VIEWPORT_MOTION_COMPLETE,this._viewportMotionCompleteEvent)},b.prototype.onEditingProcessComplete=function(){this._editingBmpd.updateCanvas(),this._previewingCanvas.visible=!1,this.emitBitmapDataUpdate(),this.emit(this._editingCompleteEvent.type,this._editingCompleteEvent)},b.prototype.onProcessing=function(a,c,d){this._processingEvent.processed=a,this._processingEvent.total=c,this._processingEvent.filter=d,this.emit(b.PROCESSING,this._processingEvent)},b.prototype.onProcessComplete=function(a){var c=this._encode||"image/jpeg",d=this._encodeOption||.92,e={type:b.PROCESS_COMPLETE,target:this,context:a,dataURL:""};this.drawRenderableObjects(a,this._options.signature.renderOnClient),this.clip.modified&&(c="image/png");try{e.dataURL=a.canvas.toDataURL(c,d)}catch(f){this.outofmemory()}return this._encode=null,this._encodeOption=null,this.emit(b.PROCESS_COMPLETE,e),e},b.prototype.onImageLoadFail=function(a){return this.emit(b.IMAGE_LOAD_FAIL,a),f.default.reject(a)},b.prototype.outofmemory=function(){this.emit(b.OUT_OF_MEMORY)},(0,l.default)(b,[{key:"viewport",get:function(){return this.magnify.boundary},set:function(a){this.magnify.boundary=a,this.crop&&(this.crop.viewport=a),this.clip&&(this.clip.viewport=a),this.viewportMotion.running||(this._current?this._current.fitToScreen():this.magnify.fitToScreen()),this._align(),this.emit(b.VIEWPORT_MOTION_UPDATE)}},{key:"showPreview",get:function(){return this._previewEnabled&&this._previewingCanvas.visible},set:function(a){if(a!=this.showPreview){var b=this._previewEnabled&&a;b?(this._previewingBmpd.updateFilters(null),this._previewingBmpd.updateCanvas(),this._previewingCanvas.visible=!0):b||(this.async?this._editingBmpd.updateFiltersAsync(this._changedFilter,this.onProcessing,this.onEditingProcessComplete):(this.updateSpecificFilter(this._changedFilter),this._previewingCanvas.visible=!1))}}},{key:"phase",get:function(){return this._phase},set:function(a){switch(this._phase!=a&&this._current&&this._current.suspend(),a){case"main":this._current=null,this.magnify.target.visible=!0,this.magnify.autoScale(this.screenFitEnable);break;default:if(!this[a])return void void 0;this._current=this[a],this._current.start()}this._phase=a;var c=b.PHASE_CHANGED;this.emit(c,{type:c,phase:this._phase})}},{key:"showOriginal",get:function(){return this._editingBmpd.showOriginal},set:function(a){this._editingBmpd.showOriginal=a}},{key:"croppedWidth",get:function(){var a=this.imageTransformControls.crop.transform.canvasWidth;return a<=0?this.bitmapdata.sourceWidth:a}},{key:"croppedHeight",get:function(){var a=this.imageTransformControls.crop.transform.canvasHeight;return a<=0?this.bitmapdata.sourceHeight:a}},{key:"maskedWidth",get:function(){var a=this.imageTransformControls.mask;return a.modified?0|a.stroke.maskWidth:this.croppedWidth}},{key:"maskedHeight",get:function(){var a=this.imageTransformControls.mask;return a.modified?0|a.stroke.maskHeight:this.croppedHeight}},{key:"resizedWidth",get:function(){return this.imageTransformControls.resize.resizedWidth||this.maskedWidth}},{key:"resizedHeight",get:function(){return this.imageTransformControls.resize.resizedHeight||this.maskedHeight}},{key:"croppedScaleX",get:function(){return this.crop?this.crop.transform.scaleX:1}},{key:"croppedScaleY",get:function(){return this.crop?this.crop.transform.scaleY:1}},{key:"screenFitEnable",get:function(){return this._screenFitEnable},set:function(a){this._screenFitEnable=a,this._current&&(this._current.screenFitEnable=a)}},{key:"debug",get:function(){return this._magnify.frameVisible},set:function(a){this._magnify.frameVisible=a,this._editingBmpd._debug=a,this._stickerLayer.debug=a,a&&([[this.root,"root"],[this._editingCanvas,"editingCanvas"],[this._previewingCanvas,"previewingCanvas"],[this.stickerContainer,"stickerContainer"],[this.signatureContainer,"signatureContainer"],[this.photoFrameContainer,"photoFrameContainer"],[this._objectContainer,"objectContainer"],[this._maskGraphic,"maskGraphic"],[this._maskLayer,"maskUIContainer"],[this._maskStroke,"maskStroke"]].forEach(function(a){var b=a[0],c=a[1];return b[ta]=c}),this._editingBmpd[ta]="Editing",this._previewingBmpd[ta]="Previewing",window.__name__=ta)}},{key:"showAlert",get:function(){return this._showAlert||!1},set:function(a){this._showAlert=a&&this._editingBmpd._debug,this._editingBmpd.msie=a}},{key:"editingSprite",get:function(){return this._editingCanvas}},{key:"previewingSprite",get:function(){return this._previewingCanvas}},{key:"bitmapdata",get:function(){return this._editingBmpd}},{key:"previewBitmapdata",get:function(){return this._previewingBmpd}},{key:"ready",get:function(){return this._ready}},{key:"magnify",get:function(){return this._magnify}},{key:"motion",get:function(){return this._motion}},{key:"viewportMotion",get:function(){return this._viewportMotion}},{key:"signatureContainer",get:function(){return this._signLayer}},{key:"stickerContainer",get:function(){return this._stickerLayer}},{key:"maskContainer",get:function(){return this._maskLayer}},{key:"options",get:function(){return this._options}},{key:"root",get:function(){return this._container}},{key:"modified",get:function(){var a=this;return this._options.useControls.reduce(function(b,c){return b||a[c].modified},!1)}},{key:"targetViewport",get:function(){return this._targetvp||this.viewport}},{key:"async",get:function(){return this.options.editingFilterAsyncMode&&this._previewEnabled}},{key:"imageTransformControls",get:function(){return this._imageTransformControls}},{key:"glAvailable",get:function(){return this.options.webglFilterEnable&&this[ua]}},{key:"editingMaxSize",get:function(){return this.glAvailable?this.options.glTransform.editingTransform.maxSize:this.options.editingTransform.maxSize}},{key:"previewingMaxSize",get:function(){return this.glAvailable?this.options.glTransform.previewingTransform.maxSize:this.options.previewingTransform.maxSize}},{key:"adjust",get:function(){return this._adjust}},{key:"resize",get:function(){return this._resize}},{key:"filter",get:function(){return this._filter}},{key:"crop",get:function(){return this._crop}},{key:"mosaic",get:function(){return this._mosaic}},{key:"photoFrame",get:function(){return this._photoFrame}},{key:"signature",get:function(){return this._signature}},{key:"sticker",get:function(){return this._sticker}},{key:"text",get:function(){return this._text}},{key:"clip",get:function(){return this._clip}}]),b}($.default);b.default=xa},function(a,b,c){"use strict";function d(a,b,c,d){var e=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],f=c-a,g=d-b,h=Math.sqrt(f*f+g*g);return e[0]=f/h,e[1]=g/h,e}function e(a,b,c,d){var e=c-a,f=d-b;return Math.sqrt(e*e+f*f)}function f(a,b,c,d){var e=c-a,f=d-b;return Math.atan2(f,e)}function g(a,b,c,d,e,g){var h=f(a,b,c,d);return f(a,b,e,g)-h}function h(a,b,c){var d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(d=d||{x:0,y:0},0==c)return d.x=a,d.y=b,d;var e=Math.cos(c),f=Math.sin(c);return d.x=a*e-b*f,d.y=a*f+b*e,d}function i(a,b,c){if(c%(2*Math.PI)==0)return[a,b];var d=Math.cos(c),e=Math.sin(c),f=a,g=b;return a=d*f-e*g,b=e*f+d*g,[a,b]}function j(a,b,c){var d=void 0,e=void 0;a%(2*Math.PI)==0?d=e=0:(d=Math.cos(a),e=Math.sin(a));var f=d,g=e,h=-e,i=d;return[f,g,h,i,-f*b-g*c+b,-h*b-i*c+c]}function k(a,b,c){var d=c.origin.x,e=c.origin.y,f=void 0,g=void 0;if(0==c.radian)f=a-d,g=b-e;else{var h=Math.cos(c.radian),i=Math.sin(c.radian);f=h*a+i*b-h*d-i*e,g=-i*a+h*b+i*d-h*e}return!(f<0||f>c.width||g<0||g>c.height)}b.__esModule=!0,b.getAxis=d,b.getDistance=e,b.getRadian=f,b.getRadianBetween=g,b.rotate=h,b.rotatei=i,b.calcPivotRotateMatrix=j,b.hitTestWithBoundary=k},function(a,b,c){"use strict";function d(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,d=c;b.save(),b.setTransform(1,0,0,1,0,0),null!=c&&b.setTransform(d[0],d[1],d[2],d[3],d[4],d[5]),b.drawImage(a,0,0),b.restore()}function e(a,b,c,d,f,g,h){var i=c,j=d;if(c!=f&&(c=c+h*(f-c)|0,Math.abs(.6*c*(1-h))>Math.abs(f-c)&&(c=f),c<f&&(c=f)),d!=g&&(d=d+h*(g-d)|0,Math.abs(.6*d*(1-h))>Math.abs(g-d)&&(d=g),d<g&&(d=g)),c==f&&d==g)return a;var k=b[0];return b.unshift(b.pop()),k.canvas.width=c,k.canvas.height=d,k.drawImage(a,0,0,i,j,0,0,c,d),e(k.canvas,b,c,d,f,g,h)}function f(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5,j=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,k=b.canvas.width,l=b.canvas.height;if(-1==c&&(c=a.width||a.naturalWidth),-1==d&&(d=a.height||a.naturalHeight),j)g.canvas.width=c,g.canvas.height=d,g.setTransform(j[0],j[1],j[2],j[3],j[4],j[5]),g.drawImage(a,0,0),f(g.canvas,b,c,d,i);else{var m=e(a,[h,g],c,d,k,l,i);b.drawImage(m,0,0,m.width||m.naturalWidth,m.height||m.naturalHeight,0,0,k,l)}}b.__esModule=!0,b.transformImage=d,b.resizeImage=f;var g=document.createElement("canvas").getContext("2d"),h=document.createElement("canvas").getContext("2d")},function(a,b,c){"use strict";(function(a){var b=c(4),d=function(a){return a&&a.__esModule?a:{"default":a}}(b);!function(){var b={};b.getDefaultParameters=function(a,b){return void 0===a||null===a?b:a},void 0!==(0,d.default)(a)&&void 0!==(0,d.default)(a.exports)?a.exports=b:usenamespace("editor.es5.utils").Func=b}()}).call(b,c(6)(a))},function(a,b,c){"use strict";var d=c(64);a.exports=function(a){if(!d(a))throw new TypeError("Cannot use null or undefined");return a}},function(a,b){function c(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function d(a){return"function"==typeof a}function e(a){return"number"==typeof a}function f(a){return"object"==typeof a&&null!==a}function g(a){return void 0===a}a.exports=c,c.EventEmitter=c,c.prototype._events=void 0,c.prototype._maxListeners=void 0,c.defaultMaxListeners=10,c.prototype.setMaxListeners=function(a){if(!e(a)||a<0||isNaN(a))throw TypeError("n must be a positive number");return this._maxListeners=a,this},c.prototype.emit=function(a){var b,c,e,h,i,j;if(this._events||(this._events={}),"error"===a&&(!this._events.error||f(this._events.error)&&!this._events.error.length)){if((b=arguments[1])instanceof Error)throw b;var k=new Error('Uncaught, unspecified "error" event. ('+b+")");throw k.context=b,k}if(c=this._events[a],g(c))return!1;if(d(c))switch(arguments.length){case 1:c.call(this);break;case 2:c.call(this,arguments[1]);break;case 3:c.call(this,arguments[1],arguments[2]);break;default:h=Array.prototype.slice.call(arguments,1),c.apply(this,h)}else if(f(c))for(h=Array.prototype.slice.call(arguments,1),j=c.slice(),e=j.length,i=0;i<e;i++)j[i].apply(this,h);return!0},c.prototype.addListener=function(a,b){var e;if(!d(b))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",a,d(b.listener)?b.listener:b),this._events[a]?f(this._events[a])?this._events[a].push(b):this._events[a]=[this._events[a],b]:this._events[a]=b,f(this._events[a])&&!this._events[a].warned&&(e=g(this._maxListeners)?c.defaultMaxListeners:this._maxListeners)&&e>0&&this._events[a].length>e&&(this._events[a].warned=!0,void 0,"function"==typeof console.trace&&void 0),this},c.prototype.on=c.prototype.addListener,c.prototype.once=function(a,b){function c(){this.removeListener(a,c),e||(e=!0,b.apply(this,arguments))}if(!d(b))throw TypeError("listener must be a function");var e=!1;return c.listener=b,this.on(a,c),this},c.prototype.removeListener=function(a,b){var c,e,g,h;if(!d(b))throw TypeError("listener must be a function");if(!this._events||!this._events[a])return this;if(c=this._events[a],g=c.length,e=-1,c===b||d(c.listener)&&c.listener===b)delete this._events[a],this._events.removeListener&&this.emit("removeListener",a,b);else if(f(c)){for(h=g;h-->0;)if(c[h]===b||c[h].listener&&c[h].listener===b){e=h;break}if(e<0)return this;1===c.length?(c.length=0,delete this._events[a]):c.splice(e,1),this._events.removeListener&&this.emit("removeListener",a,b)}return this},c.prototype.removeAllListeners=function(a){var b,c;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[a]&&delete this._events[a],this;if(0===arguments.length){for(b in this._events)"removeListener"!==b&&this.removeAllListeners(b);return this.removeAllListeners("removeListener"),this._events={},this}if(c=this._events[a],d(c))this.removeListener(a,c);else if(c)for(;c.length;)this.removeListener(a,c[c.length-1]);return delete this._events[a],this},c.prototype.listeners=function(a){return this._events&&this._events[a]?d(this._events[a])?[this._events[a]]:this._events[a].slice():[]},c.prototype.listenerCount=function(a){if(this._events){var b=this._events[a];if(d(b))return 1;if(b)return b.length}return 0},c.listenerCount=function(a,b){return a.listenerCount(b)}},function(a,b,c){a.exports={"default":c(252),__esModule:!0}},function(a,b,c){a.exports={"default":c(267),__esModule:!0}},function(a,b,c){"use strict";(function(a){function b(a){return a&&a.__esModule?a:{"default":a}}var d=c(37),e=b(d),f=c(4),g=b(f),h=c(22),i=b(h);!function(b){function c(a,b){if(b.length<=0)return a;var d=b.shift();return void 0===a[d]&&(a[d]={}),c(a[d],b)}function d(a,b){return b.prototype=(0,
i.default)(a.prototype),b.prototype.constructor=b,b.prototype}function f(a,b,c,d,e,f,g){function h(){d[0]=i,i=c.apply(e,d),f(i,b),i<b?setTimeout(h,10):setTimeout(g,10,i,b)}var i=a,d=[i,b].concat(d);h()}b.usenamespace&&(b.__bak_usenamespace_=b.usenamespace),b.usenamespace=function(a){return b.nts=b.nts||{},c(b.nts,a.split("."))},void 0!==(0,g.default)(a)&&void 0!==(0,g.default)(a.exports)?(a.exports.loop=f,a.exports.MAXIMUM_PROCESS=1e5,a.exports.CONVOLUTION_DELAY=20,a.exports.extend=d):(usenamespace("common").extend=d,usenamespace("editor.util").loop=f,usenamespace("editor.filter").MAXIMUM_PROCESS=1e5,usenamespace("editor.filter").CONVOLUTION_DELAY=20),"function"!=typeof e.default&&(Object.assign=function(a){if(null==a)throw new TypeError("Cannot convert undefined or null to object");a=Object(a);for(var b=1;b<arguments.length;b++){var c=arguments[b];if(null!=c)for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a}),function(){var a=Array.prototype.slice;try{a.call(document.documentElement)}catch(b){Array.prototype.slice=function(b,c){if(c=void 0!==c?c:this.length,"[object Array]"===Object.prototype.toString.call(this))return a.call(this,b,c);var d,e,f=[],g=this.length,h=b||0;h=h>=0?h:Math.max(0,g+h);var i="number"==typeof c?Math.min(c,g):g;if(c<0&&(i=g+c),(e=i-h)>0)if(f=new Array(e),this.charAt)for(d=0;d<e;d++)f[d]=this.charAt(h+d);else for(d=0;d<e;d++)f[d]=this[h+d];return f}}}(),window.CanvasPixelArray&&(CanvasPixelArray.prototype.set=function(a,b){var c=b||0,d=a.length;if(c+d>this.length)throw new Error("RangeError: Source is too large");for(var e=0;c<d;c++)this[c]=a[e++]},CanvasPixelArray.prototype.subarray=function(a,b){for(var c=b-a,d=new Uint8Array(c),e=0,f=a;f<b;f++)d[e++]=this[f];return d})}(window)}).call(b,c(6)(a))},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(1),h=d(g),i=null,j=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;(0,f.default)(this,a),this._gl=b}return a.initialize=function(a){i=a},(0,h.default)(a,null,[{key:"shared",get:function(){return i}}]),(0,h.default)(a,[{key:"gl",get:function(){return this._gl||i}}]),a}();b.default=j},function(a,b,c){"use strict";a.exports=function(a){if("function"!=typeof a)throw new TypeError(a+" is not a function");return a}},function(a,b,c){var d=c(65);a.exports=function(a,b,c){if(d(a),void 0===b)return a;switch(c){case 1:return function(c){return a.call(b,c)};case 2:return function(c,d){return a.call(b,c,d)};case 3:return function(c,d,e){return a.call(b,c,d,e)}}return function(){return a.apply(b,arguments)}}},function(a,b,c){var d=c(28),e=c(81);a.exports=c(27)?function(a,b,c){return d.f(a,b,e(1,c))}:function(a,b,c){return a[b]=c,a}},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(21),f=d(e),g=c(0),h=d(g),i=c(2),j=d(i),k=c(1),l=d(k),m=c(3),n=d(m),o=c(93),p=d(o),q=c(129),r=d(q),s=c(128),t=null,u=function(a){function b(){var c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;(0,h.default)(this,b);var d=(0,j.default)(this,a.call(this,c));return d._frame=new r.default(d.gl),d}return(0,n.default)(b,a),b.initializeFilterContext=function(a){t=a},(0,l.default)(b,null,[{key:"shared",get:function(){return t}}]),b.prototype.initWithSize=function(b,c){return a.prototype.initWithSize.call(this,b,c),this.frameBuffer.initWithSize(b,c),this._world=(0,s.projection2d)(b,c,-1),this},b.prototype.clear=function(){a.prototype.clear.call(this),this.frameBuffer&&this.frameBuffer.clear()},b.prototype.dispose=function(){return this.frameBuffer&&this.frameBuffer.dispose(),a.prototype.dispose.call(this)},b.prototype.applyFilter=function(a,b){var c=this;if(!1===this.changed)return a;this.gl;return this.frameBuffer.activeFrameBuffer(function(d){c.program.using||c.program.use(),c.setTransform(),c.bindSourceTexture(a),c.bindDestTexture(b),c.draw()}),b},b.prototype.applyFilterAsync=function(a,b){var c=this;return new f.default(function(d,e){d(c.applyFilter(a,b))})},b.prototype.setTransform=function(){this.program.setTransformMat3(this._world,"world")},b.prototype.bindSourceTexture=function(a){this.bindTexture(a,0)},b.prototype.bindDestTexture=function(a){this.frameBuffer.bindColorAttachment(a)},b.prototype.draw=function(){this.program.draw(this.buffer)},(0,l.default)(b,[{key:"frameBuffer",get:function(){return this._frame}},{key:"gl",get:function(){return this._gl||t}}]),b}(p.default);b.default=u},function(a,b,c){a.exports={"default":c(282),__esModule:!0}},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(66),f=d(e),g=c(4),h=d(g),i=c(30),j=d(i),k=c(45),l=d(k),m=c(0),n=d(m),o=c(1),p=d(o),q=c(2),r=d(q),s=c(3),t=d(s),u=c(24),v=c(40),w=d(v),x=c(127),y=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b.default=a,b}(x),z=[["wrapS",y.CLAMP_TO_EDGE],["wrapT",y.CLAMP_TO_EDGE],["minFilter",y.NEAREST],["magFilter",y.NEAREST]],A=function(a){function b(c){(0,n.default)(this,b);var d=(0,r.default)(this,a.call(this,c));return d._initTexture(),d}return(0,t.default)(b,a),b.createTextureForSingleImage=function(a){var c=new b(a);return c.bind(function(){return z.forEach(function(a){var b=a[0],d=a[1];return c[b]=d})})},b.prototype.keys=j.default.mark(function c(){var a,b,d,e,f,g,h;return j.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:a=z,b=Array.isArray(a),d=0,a=b?a:(0,l.default)(a);case 1:if(!b){c.next=7;break}if(!(d>=a.length)){c.next=4;break}return c.abrupt("break",16);case 4:e=a[d++],c.next=11;break;case 7:if(d=a.next(),!d.done){c.next=10;break}return c.abrupt("break",16);case 10:e=d.value;case 11:return f=e,g=f[0],h=f[1],c.next=14,[g,(0,u.keyof)(this[g])];case 14:c.next=1;break;case 16:case"end":return c.stop()}},c,this)}),b.prototype._initTexture=function(){var a=this.gl;this._texture=a.createTexture(),this._width=0,this._height=0},b.prototype.initWithPixels=function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return this._width=a,this._height=b,this.bind(function(d){d.texImage2D(d.TEXTURE_2D,0,d.RGBA,a,b,0,d.RGBA,d.UNSIGNED_BYTE,c)}),this},b.prototype.initWithSource=function(a){return this._width=a.width||a.naturalWidth,this._height=a.height||a.naturalHeight,this.bind(function(b){b.texImage2D(b.TEXTURE_2D,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,a)}),this},b.prototype.dispose=function(){if(this.texture){this.gl.deleteTexture(this.texture)}},b.prototype.clearTexture=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.width,d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.height;this.updateTexturePixels(a,b,c,d,new Uint8Array(4*c*d))},b.prototype.updateTexturePixels=function(a,b,c,d,e){var f=this.gl;f.texSubImage2D(f.TEXTURE_2D,0,a,b,c,d,f.RGBA,f.UNSIGNED_BYTE,e)},b.prototype.updateTextureSource=function(a,b,c){var d=this.gl;d.texSubImage2D(d.TEXTURE_2D,0,a,b,d.RGBA,d.UNSIGNED_BYTE,c)},b.prototype.generateMipmap=function(){var a=this.gl;a.generateMipmap(a.TEXTURE_2D)},b.prototype.bind=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,b=this.gl,c=void 0===a?"undefined":(0,h.default)(a);return"number"===c&&b.activeTexture(b.TEXTURE0+a),b.bindTexture(b.TEXTURE_2D,this.texture),"function"===c?(a(b),this.unbind()):this},b.prototype.unbind=function(){var a=this.gl;return a.bindTexture(a.TEXTURE_2D,null),this},b.prototype[f.default]=function(){return(0,l.default)([this.width,this.height])},(0,p.default)(b,[{key:"texture",get:function(){return this._texture}},{key:"wrapS",get:function(){var a=this.gl;return a.getTexParameter(a.TEXTURE_2D,a.TEXTURE_WRAP_S)},set:function(a){var b=this.gl;b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,a)}},{key:"wrapT",get:function(){var a=this.gl;return a.getTexParameter(a.TEXTURE_2D,a.TEXTURE_WRAP_T)},set:function(a){var b=this.gl;b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,a)}},{key:"minFilter",get:function(){var a=this.gl;return a.getTexParameter(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER)},set:function(a){var b=this.gl;b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,a)}},{key:"magFilter",get:function(){var a=this.gl;return a.getTexParameter(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER)},set:function(a){var b=this.gl;b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,a)}},{key:"binding",get:function(){var a=this.gl;return a.getParameter(a.TEXTURE_BINDING_2D)===this.texture}},{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}}]),b}(w.default);b.default=A},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(30),f=d(e),g=c(45),h=d(g),i=c(66),j=d(i),k=c(0),l=d(k),m=c(1),n=d(m),o=["m11","m12","m21","m22","tx","ty"],p=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,f=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,g=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;(0,l.default)(this,a),this._raw=new Float32Array(6),this.setTo(b,c,d,e,f,g)}return(0,n.default)(a,null,[{key:"TEMP",get:function(){return q}}]),a.prototype[j.default]=function(){var a=this.raw,b=0;return{next:function(){return b>=a.length?{done:!0}:{value:a[b++],done:!1}}}},a.prototype.entries=f.default.mark(function b(){var a,c,d,e,g;return f.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:a=o,c=Array.isArray(a),d=0,a=c?a:(0,h.default)(a);case 1:if(!c){b.next=7;break}if(!(d>=a.length)){b.next=4;break}return b.abrupt("break",16);case 4:e=a[d++],b.next=11;break;case 7:if(d=a.next(),!d.done){b.next=10;break}return b.abrupt("break",16);case 10:e=d.value;case 11:return g=e,b.next=14,[g,this[g]];case 14:b.next=1;break;case 16:case"end":return b.stop()}},b,this)}),a.prototype.values=function(){return(0,h.default)(this)},a.prototype.keys=function(){return(0,h.default)(o)},a.prototype.setTo=function(a,b,c,d,e,f){var g=this._raw;return g[0]=a,g[2]=b,g[4]=e,g[1]=c,g[3]=d,g[5]=f,this},a.prototype.setBy=function(a){var b=this._raw;return b[0]=a.m11,b[2]=a.m12,b[4]=a.tx,b[1]=a.m21,b[3]=a.m22,b[5]=a.ty,this},a.prototype.identity=function(){var a=this._raw;return a[0]=1,a[2]=0,a[4]=0,a[1]=0,a[3]=1,a[5]=0,this},a.prototype.apply=function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return c[0]=this.m11*a+this.m12*b+this.tx,c[1]=this.m21*a+this.m22*b+this.ty,c},a.prototype.applyInverse=function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],d=this.m11,e=this.m21,f=this.m12,g=this.m22,h=this.tx,i=this.ty,j=d*g-e*f;if(c[0]=a,c[1]=b,0==j)return c;var k=1/j;return c[0]=k*g*a-k*f*b+k*(f*i-g*h),c[1]=k*d*b-k*e*a+k*(e*h-d*i),c},a.prototype.inverse=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this,b=this,c=b.m11,d=b.m12,e=b.tx,f=b.m21,g=b.m22,h=b.ty,i=c*g-d*f;return 0!=i?(c=b.m22/i,d=-b.m12/i,f=-b.m21/i,g=b.m11/i,e=(b.m12*b.ty-b.tx*b.m22)/i,h=-(b.m11*b.ty-b.tx*b.m21)/i,a.setTo(c,d,f,g,e,h)):a.identity(),a},a.prototype.preppend=function(a){var b=a.raw,c=this._raw,d=this._raw,e=b[0],f=b[2],g=b[4],h=b[1],i=b[3],j=b[5],k=c[0],l=c[2],m=c[4],n=c[1],o=c[3],p=c[5];d[0]=e*k+f*n,d[2]=e*l+f*o,d[4]=e*m+f*p+g,d[1]=h*k+i*n,d[3]=h*l+i*o,d[5]=h*m+i*p+j},a.prototype.proj2D=function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,d=this._raw;return d[0]=2/a,d[2]=0,d[4]=-1,d[1]=0,d[3]=2/b,d[5]=-1*c,this},a.prototype.append=function(a){var b=this._raw,c=a.raw,d=this._raw,e=b[0],f=b[2],g=b[4],h=b[1],i=b[3],j=b[5],k=c[0],l=c[2],m=c[4],n=c[1],o=c[3],p=c[5];d[0]=e*k+f*n,d[2]=e*l+f*o,d[4]=e*m+f*p+g,d[1]=h*k+i*n,d[3]=h*l+i*o,d[5]=h*m+i*p+j},a.prototype.clone=function(){return new a(this.m11,this.m12,this.m21,this.m22,this.tx,this.ty)},a.prototype.toString=function(){for(var a="",b=this._raw,c=0;c<2;c++)a+=b[c]+"	"+b[c+2]+"	"+b[c+4]+"\n";return a},(0,n.default)(a,[{key:"dirty",get:function(){var a=this._raw;return 1!=a[0]||0!=a[2]||0!=a[4]||0!=a[1]||1!=a[3]||0!=a[5]}},{key:"a",get:function(){return this._raw[0]}},{key:"b",get:function(){return this._raw[1]}},{key:"c",get:function(){return this._raw[2]}},{key:"d",get:function(){return this._raw[3]}},{key:"e",get:function(){return this._raw[4]}},{key:"f",get:function(){return this._raw[5]}},{key:"m11",get:function(){return this._raw[0]},set:function(a){this._raw[0]=a}},{key:"m12",get:function(){return this._raw[2]},set:function(a){this._raw[2]=a}},{key:"m21",get:function(){return this._raw[1]},set:function(a){this._raw[1]=a}},{key:"m22",get:function(){return this._raw[3]},set:function(a){this._raw[3]=a}},{key:"tx",get:function(){return this._raw[4]},set:function(a){this._raw[4]=a}},{key:"ty",get:function(){return this._raw[5]},set:function(a){this._raw[5]=a}},{key:"raw",get:function(){return this._raw}},{key:"raw3x3",get:function(){var a=this._raw;return[a[0],a[1],0,a[2],a[3],0,a[4],a[5],1]}}]),a}();b.default=p;var q=new p},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){return function(b){var c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document.createElement("img");return null!=a&&(c.crossOrigin=a),new n.default(function(a,d){c.onload=function(b){f(c)?a(c):d("image element validation error")},c.onerror=function(a){return d(a)},c.src=b})}}function f(a){return 0!==(a.width||a.naturalWidth)&&0!==(a.height||a.naturalHeight)}function g(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return b=b||s,b.canvas.width=a.width||a.naturalWidth,b.canvas.height=a.height||a.naturalHeight,b.drawImage(a,0,0),b.getImageData(0,0,b.canvas.width,b.canvas.height)}function h(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET";return new n.default(function(c,d){var e=new XMLHttpRequest;e.onload=function(){return c(e.responseText)},e.onerror=function(a){return d(a)},e.open(b,a),e.send(null)})}function i(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t,b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return b&&b.length&&a.setAttribute("accept",b),new n.default(function(b,c){var d=function e(a){var d=a.target,f=d.files;f.length?b(f):c({type:"user cancel",files:f}),d.removeEventListener(a.type,e),d==t&&d.parentElement&&d.parentElement.removeChild(d)};null==a.parentElement&&document.body.appendChild(a),a.addEventListener("change",d),a.click()})}function j(a){return new n.default(function(b,c){var d=new FileReader,e=function(a){b(a.target.result),g(a.target)},f=function(a){c(a),g(a.target)},g=function(a){a.removeEventListener("load",e),a.removeEventListener("error",f)};d.addEventListener("load",e),d.addEventListener("error",f),d.readAsDataURL(a)})}function k(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:60;return new n.default(function(c,d){a.running?a.once("complete",function(a){return c(a)}):setTimeout(function(){a.running?a.once("complete",function(a){return c(a)}):c("unstarted")},b)})}function l(a){for(var b=arguments.length,c=Array(b>1?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];return a.apply(void 0,c).then(function(b){return b.done?n.default.resolve(b.args):l.apply(void 0,[a].concat(b.args))})}b.__esModule=!0,b.loadImage=b.all=void 0;var m=c(21),n=d(m);b.makeLoadImage=e,b.validation=f,b.getImageData=g,b.request=h,b.browseFile=i,b.readAsDataURL=j,b.completeMotion=k,b.re=l;var o=c(323),p=d(o),q=c(60),r=d(q);c(10);window.Promise||(window.Promise=p.default);var s=document.createElement("canvas").getContext("2d");(0,r.default)(s,"CanvasRenderingContext2D를 찾을 수 없습니다.");var t=(b.all=n.default.all.bind(n.default),b.loadImage=e(),document.createElement("input"));t.setAttribute("type","file"),t.setAttribute("multiple",""),t.style.display="none"},function(a,b,c){"use strict";a.exports=c(391)()?Symbol:c(392)},function(a,b){a.exports=function(a){try{return!!a()}catch(b){return!0}}},function(a,b){var c={}.hasOwnProperty;a.exports=function(a,b){return c.call(a,b)}},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(2),h=d(g),i=c(1),j=d(i),k=c(3),l=d(k),m=c(17),n=function(a){function b(){(0,f.default)(this,b);var c=(0,h.default)(this,a.call(this));return c.ticker=PIXI.ticker.shared,c._a={},c._running=!1,c}return(0,l.default)(b,a),b.linear=function(a){return a},b.easeOut=function(a){return 1-Math.pow(a-1,4)},b.easeIn=function(a){return Math.pow(a,4)},b.easeInOut=function(a){return a<=.5?8*Math.pow(a,4):1-8*Math.pow(a-1,4)},b.to=function(a,c,d,e){var f=new b;return f.play(a,c,d,e),f},(0,j.default)(b,null,[{key:"UPDATE",get:function(){return"update"}},{key:"COMPLETE",get:function(){return"complete"}}]),b.prototype.play=function(a,b,c,d){var e=this;this.stop(),this.target=a||this.bitmap,this.startTime=this.ticker.lastTime,this.ticker.add(this.onRender,this),this.duration=c,this.ease=d,this._a=(0,m.map)(b,function(a,b){return e.target[b]}),this._b=b,this._running=!0},b.prototype.stop=function(){var a=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.ticker.remove(this.onRender,this),this._running=!1,a)for(var b in this._b)this.target[b]=this._b[b]},b.prototype.dispose=function(){this.stop()},b.prototype.onComplete=function(){var a=this;(0,m.each)(this._b,function(b,c){return a.target[c]=b}),this.emit(b.COMPLETE,b.COMPLETE),this.stop()},b.prototype.onRender=function(a){var b=this.ticker.lastTime-this.startTime,c=this.ease(Math.max(0,Math.min(1,b/this.duration)));c>1&&(c=1);for(var d in this._b)this.target[d]=this._a[d]+c*(this._b[d]-this._a[d]);this.emit("update","update"),b>=this.duration&&this.onComplete()},(0,j.default)(b,[{key:"running",get:function(){return this._running}}]),b}(PIXI.utils.EventEmitter);b.default=n},function(a,b,c){"use strict";function d(a){return a<0?-1:a?1:0}function e(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5,d=Math.pow(10,b);return(a*d+c|0)/d}function f(a){return a>0?a:-a}b.__esModule=!0,b.sign=d,b.roundoffNth=e,b.abs=f},function(a,b,c){"use strict";b.__esModule=!0;var d=c(0),e=function(a){return a&&a.__esModule?a:{"default":a}}(d),f=function(){function a(){(0,e.default)(this,a)}return a.prototype.applyTransform=function(){},a.prototype.identity=function(){},a.prototype.getSourceSize=function(a){return[this.getSourceWidth(a),this.getSourceHeight(a)]},a.prototype.getSourceWidth=function(a){return a.width||a.naturalWidth},a.prototype.getSourceHeight=function(a){return a.height||a.naturalHeight},a}();b.default=f},function(a,b,c){"use strict";function d(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"0";return a.length>=b?a:d(c+a,b,c)}function e(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"_";return function(b){for(var c=arguments.length,d=Array(c>1?c-1:0),e=1;e<c;e++)d[e-1]=arguments[e];return b.replace(new RegExp(a,"g"),function(a){return d.shift()})+d.join()}}function f(a){return"undefined"==typeof DOMParser?null:(new DOMParser).parseFromString(a,"text/xml")}function g(a){if("undefined"==typeof ActiveXObject)return null;var b=new ActiveXObject("Microsoft.XMLDOM");return void 0===b?null:(b.async="false",b.loadXML(a),b)}function h(a){var b=f(a)||g(a);if(null===b)throw new Error("No XML parser found");return b}b.__esModule=!0,b.zfill=d,b.makePrintf=e,b.parseXMLbyDOMParser=f,b.parseXMLbyActiveXObject=g,b.parseXML=h;var i=b.printf=e();b.log=function(a){for(var b=arguments.length,c=Array(b>1?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];void 0},b.makeDebugLog=function(){var a=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(b){for(var c=arguments.length,d=Array(c>1?c-1:0),e=1;e<c;e++)d[e-1]=arguments[e];a&&void 0}}},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(2),h=d(g),i=c(1),j=d(i),k=c(3),l=d(k),m=c(97),n=d(m),o=c(53),p=c(173),q=d(p),r=c(17),s=function(a){function b(){(0,f.default)(this,b);var c=(0,h.default)(this,a.call(this));return c._changEvent={type:b.CHANGE_SIZE,target:c},c._frame=new q.default(3,100,100,100,65280),c._width=100,c._height=100,c._boundary={x:0,y:0,width:100,height:100},c._clipRect=null,c._graphics=new PIXI.Graphics,c._border={top:0,left:0,right:0,bottom:0},c}return(0,l.default)(b,a),(0,j.default)(b,null,[{key:"CHANGE_SIZE",get:function(){return"changeSize"}}]),b.prototype.updateSize=function(a,b){this._width=a,this._height=b,this.scale.x=this.scale.y=1,this._frame.setSize(a,b),this.emit(this._changEvent.type,this._changEvent)},b.prototype.markUp=function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16711680,d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,e=arguments.length>4&&void 0!==arguments[4]?arguments[4]:10,f=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,g=this._g=this._g||new PIXI.Graphics;g.lineStyle(d,c,f),g.moveTo(a-e,b-e),g.lineTo(a+e,b+e),g.moveTo(a+e,b-e),g.lineTo(a-e,b+e),this.addChild(g)},b.prototype.clearPoints=function(){this._g&&this._g.clear()},b.prototype.setMaskTransform=function(a,b,c){var d=this.mask;d&&(d.x=a.x/d.scale.x,d.y=a.y/d.scale.y,d.rotation=a.radian,d.pivot.x=a.offsetX/d.scale.x,d.pivot.y=a.offsetY/d.scale.y)},b.prototype.getBounds=function(a){return{x:1e7,y:1e7,width:-1e9,height:-1e9}},(0,j.default)(b,[{key:"actualWidth",get:function(){return this._width}},{key:"width",get:function(){return Math.abs(this.scale.x)*this._width},set:function(a){this.scale.x=(0,o.sign)(this.scale.x)*a/this._width}},{key:"actualHeight",get:function(){return this._height}},{key:"height",get:function(){return Math.abs(this.scale.y)*this._height},set:function(a){this.scale.y=(0,o.sign)(this.scale.y)*a/this._height}},{key:"graphics",get:function(){return this._graphics}},{key:"clipShape",get:function(){return this._clipShape},set:function(a){a!=this.clipShape&&(this._clipShape=a,this.graphics.clear(),a?(n.default.drawSVG(this.graphics,a),this.addChild(this.graphics),this.mask=this.graphics):(this.graphics.parent&&this.graphics.parent.removeChild(this.graphics),this.mask=null))}},{key:"clipRectPoints",get:function(){return this._clipRectPoints},set:function(a){(0,r.every)(a,function(a){return!isNaN(a.x)&&!isNaN(a.y)})||(a=null),this._clipRectPoints=a;var b=this._graphics;if(b.clear(),null==a)return this.mask=null,void(b.parent&&b.parent.removeChild(b));b.moveTo(a.tl.x,a.tl.y),[a.tr,a.br,a.bl,a.tl].forEach(function(a){return b.lineTo(a.x,a.y)}),this.mask=b,this.addChild(b)}},{key:"mouseChildren",get:function(){if(!this.children)return!1;var a=!1;return this.children.every(function(b){return!b.renderableObject||(a=b.interactive,!1)}),a},set:function(a){this.children&&this.children.forEach(function(b){b.renderableObject&&(b.interactive=a)})}},{key:"debug",get:function(){return null!=this._frame.parent},set:function(a){a?this.addChild(this._frame):this._frame.parent&&this._frame.parent.removeChild(this._frame)}},{key:"border",get:function(){return this._border},set:function(a){this._border=a}}]),b}(PIXI.Container);b.default=s},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(1),h=d(g),i=function(){function a(){(0,f.default)(this,a)}return(0,h.default)(a,null,[{key:"DESKTOP_MOUSE",get:function(){return this.renderer.plugins.interaction.mouse}},{key:"MOBILE_MOUSE",get:function(){return this.renderer.plugins.interaction.pointer}},{key:"renderer",set:function(a){this._renderer=a},get:function(){return this._renderer}},{key:"mouse",set:function(a){this._mouse=a},get:function(){return this._mouse||(this._mouse=this.DESKTOP_MOUSE),this._mouse}},{key:"global",get:function(){return this.mouse.global}},{key:"globalX",get:function(){return this.mouse.global.x}},{key:"globalY",get:function(){return this.mouse.global.y}},{key:"currentCursorStyle",set:function(b){a.renderer.plugins.interaction.currentCursorStyle=b},get:function(){return a.renderer.plugins.interaction.currentCursorStyle}},{key:"currentTime",get:function(){return(new Date).getTime()}}]),a}();b.default=i},function(a,b,c){"use strict";var d,e=c(145),f=c(209),g=c(387),h=c(210);d=a.exports=function(a,b){var c,d,g,i,j;return arguments.length<2||"string"!=typeof a?(i=b,b=a,a=null):i=arguments[2],null==a?(c=g=!0,d=!1):(c=h.call(a,"c"),d=h.call(a,"e"),g=h.call(a,"w")),j={value:b,configurable:c,enumerable:d,writable:g},i?e(f(i),j):j},d.gs=function(a,b,c){var d,i,j,k;return"string"!=typeof a?(j=c,c=b,b=a,a=null):j=arguments[3],null==b?b=void 0:g(b)?null==c?c=void 0:g(c)||(j=c,c=void 0):(j=b,b=c=void 0),null==a?(d=!0,i=!1):(d=h.call(a,"c"),i=h.call(a,"e")),k={get:b,set:c,configurable:d,enumerable:i},j?e(f(j),k):k}},function(a,b,c){var d=c(108),e=c(106);a.exports=function(a){return d(e(a))}},function(a,b,c){"use strict";function d(a,b){if(!a)throw new Error("[Assertion Error] "+b)}b.__esModule=!0,b.default=d},function(a,b,c){"use strict";(function(a){var b=c(4),d=function(a){return a&&a.__esModule?a:{"default":a}}(b);!function(){var b={};b.Func=c(34);var e={};e.HitSide=c(96);var f={};f.LIMIT_LEFT=-1e5,f.LIMIT_TOP=-1e5,f.LIMIT_RIGHT=1e5,f.LIMIT_BOTTOM=1e5,f._DEG_TO_RAD=Math.PI/180,f._RAD_TO_DEG=180/Math.PI,f._RADIAN_1=1*f._DEG_TO_RAD,f._RADIAN_45=45*f._DEG_TO_RAD,f._RADIAN_90=90*f._DEG_TO_RAD,f._RADIAN_180=180*f._DEG_TO_RAD,f._RADIAN_360=360*f._DEG_TO_RAD,f.EPSILON=2.220446049250313e-16,Object.defineProperty(f,"DEG_TO_RAD",{get:function(){return f._DEG_TO_RAD}}),Object.defineProperty(f,"RAD_TO_DEG",{get:function(){return f._RAD_TO_DEG}}),Object.defineProperty(f,"RADIAN_1",{get:function(){return f._RADIAN_1}}),Object.defineProperty(f,"RADIAN_45",{get:function(){return f._RADIAN_45}}),Object.defineProperty(f,"RADIAN_90",{get:function(){return f._RADIAN_90}}),Object.defineProperty(f,"RADIAN_180",{get:function(){return f._RADIAN_180}}),Object.defineProperty(f,"RADIAN_360",{get:function(){return f._RADIAN_360}}),f.getDiagonal=function(a,b){return Math.sqrt(a*a+b*b)},f.getHeightMaintainAspectRatio=function(a,b,c){return c*b/a},f.getY2=function(a,b,c){return c/(a/b)},f.getWidthMaintainAspectRatio=function(a,b,c){return c*a/b},f.getX2=function(a,b,c){return a/b*c},f.getWidthByAspectRatio=function(a,b){return b*a},f.getHeightByAspectRatio=function(a,b){return b/a},f.getAspectRatio=function(a,b){return a/b||0},f.getAspectRatioBackup=function(a,b,c){return c?Math.max(a,b)/Math.min(a,b)||0:Math.min(a,b)/Math.max(a,b)||0},f.toRadians=function(a){return a*f.DEG_TO_RAD},f.toDegrees=function(a){return a*f.RAD_TO_DEG},f.toRoundDegreesByRadians=function(a){return Math.round(f.toDegrees(a))},f.toRoundRadiansByRadians=function(a){return f.toRadians(f.toRoundDegreesByRadians(a))},f.toRoundRadiansByDegrees=function(a){return f.toRadians(f.toRoundDegreesByDegrees(a))},f.toRoundDegreesByDegrees=function(a){return Math.round(a)},f.getModulusDegreesByRadians=function(a,b){return f.toRoundDegreesByRadians(a)%b},f.getModulusDegreesByDegrees=function(a,b){return f.toRoundDegreesByDegrees(a)%b},f.getRotateCountByRadians=function(a){var b=f.getModulusDegreesByRadians(a,360);return parseInt(Math.abs(b)/90)},f.getRotateCountByDegrees=function(a){var b=f.getModulusDegreesByDegrees(a,360);return parseInt(Math.abs(b)/90)},f.sqr=function(a){return a*a},f.dist2=function(a,b){return f.sqr(a.x-b.x)+f.sqr(a.y-b.y)},f.getScale=function(a,b){var c=b.width/a.width,d=b.height/a.height;return c<d?{min:c,max:d}:{min:d,max:c}},f.getSizeFitInBounds=function(a,b){var c=f.getScale(a,b),d=c.min;return{x:0,y:0,width:d*a.width,height:d*a.height}},f.getRotation=function(a,b){var c=b.x-a.x,d=b.y-a.y,e=Math.atan2(d,c);return f.toDegrees(e)},f.triangleArea=function(a,b,c){return c.x*b.y-b.x*c.y-(c.x*a.y-a.x*c.y)+(b.x*a.y-a.x*b.y)},f.isInsideSquare=function(a,b,c,d,e){return!(f.triangleArea(a,b,c)>0||f.triangleArea(a,c,d)>0||f.triangleArea(a,d,e)>0||f.triangleArea(a,e,b)>0)},f.isHit=function(a,b){return f.triangleArea(a,b.s,b.e)>0},f.sampleCodeHitTest=function(a,b,c,d,e){var g={isHitLeft:!1,isHitRight:!1,isHitTop:!1,isHitBottom:!1};return f.triangleArea(a,b,c)>0&&(g.isHitTop=!0),f.triangleArea(a,c,d)>0&&(g.isHitRight=!0),f.triangleArea(a,d,e)>0&&(g.isHitBottom=!0),f.triangleArea(a,e,b)>0&&(g.isHitLeft=!0),g},f.getPointsByBounds=function(a){return{lt:{x:a.x,y:a.y},rt:{x:a.x+a.width,y:a.y},rb:{x:a.x+a.width,y:a.y+a.height},lb:{x:a.x,y:a.y+a.height}}},f.getOneToOne=function(a,b,c,d,e){return(e-d)/(c-b)*(a-b)+d},f.getTweenValue=function(a,b,c){return a+(b-a)*c},f.getTweenValueByObject=function(a,b,c,d){return b[a]+(c[a]-b[a])*d},f.getRotationPoint=function(a,b,c){var d=b.x-a.x,e=b.y-a.y,g=Math.sqrt(d*d+e*e),h=Math.atan2(e,d)*f._RAD_TO_DEG,i=(h+c)%360*f._DEG_TO_RAD;return{x:a.x+g*Math.cos(i)+.5|0,y:a.y+g*Math.sin(i)+.5|0}},f.getRotationPoints=function(a,b,c){return{lt:f.getRotationPoint(a,b.lt,c),rt:f.getRotationPoint(a,b.rt,c),rb:f.getRotationPoint(a,b.rb,c),lb:f.getRotationPoint(a,b.lb,c)}},f.getBoundsByRotationPoints=function(a){var b=Math.min(a.lt.x,a.rt.x,a.rb.x,a.lb.x),c=Math.min(a.lt.y,a.rt.y,a.rb.y,a.lb.y);return{x:b,y:c,width:Math.max(a.lt.x,a.rt.x,a.rb.x,a.lb.x)-b,height:Math.max(a.lt.y,a.rt.y,a.rb.y,a.lb.y)-c}},f.getBoundsByPoints=function(a){return{x:a.lt.x,y:a.lt.y,width:a.rb.x-a.lt.x,height:a.rb.y-a.lt.y}},f.getShortestDistancePoint=function(a,b,c){var d=f.dist2(b,c);if(0==d)return b;var e=((a.x-b.x)*(c.x-b.x)+(a.y-b.y)*(c.y-b.y))/d;return e=Math.max(0,Math.min(1,e)),{x:b.x+e*(c.x-b.x),y:b.y+e*(c.y-b.y)}},f.distToSegmentSquared=function(a,b,c){var d=f.getShortestDistancePoint(a,b,c);return f.dist2(a,d)},f.distToSegment=function(a,b,c){return Math.sqrt(f.distToSegmentSquared(a,b,c))},f.getReturnPoint=function(a,b){return{x:a.x-b.x,y:a.y-b.y}},f.goByCollision=function(a,c,d,e,g){e=b.Func.getDefaultParameters(e,0),g=b.Func.getDefaultParameters(g,0);var h=f.getShortestDistancePoint(c,d.s,d.e),i=f.getReturnPoint(c,h);a.x=a.x+i.x+e,a.y=a.y+i.y+g},f.goByCollisionNoSpace=function(a,b,c){var d=f.getShortestDistancePoint(b,c.s,c.e),e=f.getReturnPoint(b,d);a.x=a.x+e.x,a.y=a.y+e.y},f.pointsUpdateByCollision=function(a,c,d,e,g){e=b.Func.getDefaultParameters(e,0),g=b.Func.getDefaultParameters(g,0);var h=f.getShortestDistancePoint(c,d.s,d.e),i=f.getReturnPoint(c,h),j=i.x+e,k=i.y+g;return f.translate(a,j,k)},f.getNextMovePosition=function(a,b,c,d){return{x:a+c*Math.cos(d),y:b+c*Math.sin(d)}},f.getActualPixelSize=function(a,b,c,d){var e=d.bounds,f=c.width/a,g=c.height/b;return{width:e.width/f,height:e.height/g}},f.getLineIntersection=function(a,b,c,d){var e,f,g,h,i=a.x,j=a.y,k=b.x,l=b.y,m=c.x,n=c.y,o=d.x,p=d.y,q={x:null,y:null,onLine1:!1,onLine2:!1},r=(p-n)*(k-i)-(o-m)*(l-j);return 0==r?q:(e=j-n,f=i-m,g=(o-m)*e-(p-n)*f,h=(k-i)*e-(l-j)*f,e=g/r,f=h/r,q.x=i+e*(k-i),q.y=j+e*(l-j),e>0&&e<1&&(q.onLine1=!0),f>0&&f<1&&(q.onLine2=!0),q)},f.intersection=function(a,b,c,d){var e,f,g,h,i=a.x,j=a.y,k=b.x,l=b.y,m=c.x,n=c.y,o=d.x,p=d.y,q=k-i,r=l-j,s=o-m,t=p-n,u=q*t-s*r;return 0==u?null:(e=i-m,f=j-n,g=(q*f-r*e)/u,g>=0&&g<=1&&(h=(s*f-t*e)/u)>=0&&h<=1?{x:i+h*q,y:j+h*r}:null)},f.translate=function(a,b,c){return a.lt.x+=b,a.lt.y+=c,a.rt.x+=b,a.rt.y+=c,a.rb.x+=b,a.rb.y+=c,a.lb.x+=b,a.lb.y+=c,a.leftLine={s:a.lb,e:a.lt},a.topLine={s:a.lt,e:a.rt},a.rightLine={s:a.rt,e:a.rb},a.bottomLine={s:a.lb,e:a.rb},a},f.rotate=function(a,b){for(var c=Math.cos(a),d=Math.sin(a),e=0;e<b.length;e++){var f=b[e],g=f.x,h=f.y;f.x=c*g-d*h,f.y=d*g+c*h}},f.getRotationPionts=function(a,b,c){return{lt:f.getRotationPoint(a,b.lt,c),rt:f.getRotationPoint(a,b.rt,c),rb:f.getRotationPoint(a,b.rb,c),lb:f.getRotationPoint(a,b.lb,c)}},f.getRotationBox=function(a,b,c){var d=f.getRotationPionts(a,b,c);return{left:f.getLeftPoint(d).x,right:f.getRightPoint(d).x,top:f.getTopPoint(d).y,bottom:f.getBottomPoint(d).y}},f.getLeftPoint=function(a){var b=a.lt;for(var c in a)b.x>a[c].x&&(b=a[c]);return b},f.getTopPoint=function(a){var b=a.lt;
for(var c in a)b.y>a[c].y&&(b=a[c]);return b},f.getRightPoint=function(a){var b=a.lt;for(var c in a)b.x>a[c].x&&(b=a[c]);return b},f.getBottomPoint=function(a){var b=a.lt;for(var c in a)b.y<a[c].y&&(b=a[c]);return b},f.getNearPoint=function(a,b,c){if(!c||0===c.length)return null;for(var d,e,f=0,g=null,h=9007199254740991,i=0;i<c.length;i++)d=c[i][b],e=d-a[b],(f=e<0?-e:e)<h&&(h=f,g=c[i]);return g},f.getNear=function(a,b){for(var c,d,e=0,f=0,g=9007199254740991,h=0;h<b.length;h++)c=b[h],d=c-a,(e=d<0?-d:d)<g&&(g=e,f=c);return f},f.fixLimit=function(a,b,c){var d,e,g,h,i,j,k,l,m=c.lt,n=c.rt,o=c.rb,p=c.lb;return d=null!==m&&null!==m.x?m.x.x:f.LIMIT_LEFT,e=null!==p&&null!==p.x?p.x.x:f.LIMIT_LEFT,i=Math.max(d,e),g=null!==m&&null!==m.y?m.y.y:f.LIMIT_TOP,h=null!==n&&null!==n.y?n.y.y:f.LIMIT_TOP,j=Math.max(g,h),d=null!==n&&null!==n.x?n.x.x:f.LIMIT_RIGHT,e=null!==o&&null!==o.x?o.x.x:f.LIMIT_RIGHT,k=Math.min(d,e),g=null!==p&&null!==p.y?p.y.y:f.LIMIT_BOTTOM,h=null!==o&&null!==o.y?o.y.y:f.LIMIT_BOTTOM,l=Math.min(g,h),a=a<i?i:a,a=a>k?k:a,b=b<j?j:b,b=b>l?l:b,{x:a,y:b}},f.digit=function(a,c){0===(c=b.Func.getDefaultParameters(c,1))&&(c=1);var d=Math.pow(10,c);return parseInt(a*d)/d},f.leadingZero=function(a,c){c=b.Func.getDefaultParameters(c,4);var d="";if(a=a.toString(),a.length<c)for(var e=0;e<c-a.length;e++)d+="0";return d+a},f.trace=function(a){return f.leadingZero(parseInt(a))},f.copyObject=function(a){var b={};for(var c in a)b[c]=a[c];return b},f.getLeftHeight=function(a){return a.lb.y-a.lt.y||0},f.getRightHeight=function(a){return a.rb.y-a.rt.y||0},f.round=function(a){for(var b in a)a[b]=Math.round(a[b]);return a},f.flipX=function(a,b){return b.x=a-b.x,b},f.flipY=function(a,b){return b.y=a-b.y,b},f.getIsFitImageToBounds=function(a,b){for(var c=[b.lt,b.rt,b.rb,b.lb],d=0;d<c.length;d++)if(!1===f.isInsideSquare(c[d],a.lt,a.rt,a.rb,a.lb))return!1;return!0},f.getHitSide=function(a,b){var c=a.lt,d=a.rt,g=a.rb,h=a.lb,i=e.HitSide.NONE;return(f.triangleArea(b.lt,h,c)>0||f.triangleArea(b.lb,h,c)>0)&&(i=e.HitSide.LEFT),(f.triangleArea(b.rt,d,g)>0||f.triangleArea(b.rb,d,g)>0)&&(i=e.HitSide.RIGHT),(f.triangleArea(b.lt,c,d)>0||f.triangleArea(b.rt,c,d)>0)&&(i=i===e.HitSide.NONE?e.HitSide.TOP:i+="-"+e.HitSide.TOP),(f.triangleArea(b.rb,g,h)>0||f.triangleArea(b.lb,g,h)>0)&&(i=i===e.HitSide.NONE?e.HitSide.BOTTOM:i+="-"+e.HitSide.BOTTOM),i},f.getSizeByPoints=function(a){var b=a.rt.x-a.lt.x,c=a.rt.y-a.lt.y,d=Math.sqrt(b*b+c*c);return b=a.rt.x-a.rb.x,c=a.rt.y-a.rb.y,{width:d,height:Math.sqrt(b*b+c*c)}},f.toLocalPoints=function(a,b){var c={};for(var d in b)c[d]=a.applyInverse(b[d]);return c},f.convertCanvasMatrixToPixiMatrix=function(a){var b=new PIXI.Matrix;return b.a=a.m11,b.b=a.m21,b.c=a.m12,b.d=a.m22,b.tx=a.tx,b.ty=a.ty,b},f.isPassedLeftLine=function(a,b){return f.triangleArea(b,a.lb,a.lt)>0},f.isPassedTopLine=function(a,b){return f.triangleArea(b,a.lt,a.rt)>0},f.isPassedRightLine=function(a,b){return f.triangleArea(b,a.rt,a.rb)>0},f.isPassedBottomLine=function(a,b){return f.triangleArea(b,a.rb,a.lb)>0},void 0!==(0,d.default)(a)&&void 0!==(0,d.default)(a.exports)?a.exports=f:usenamespace("editor.es5.utils").Calc=f}()}).call(b,c(6)(a))},function(a,b,c){"use strict";!function(b){var c={linear:function(a){return a},easeInQuad:function(a){return a*a},easeOutQuad:function(a){return-1*a*(a-2)},easeInOutQuad:function(a){return(a/=.5)<1?.5*a*a:-.5*(--a*(a-2)-1)},easeInCubic:function(a){return a*a*a},easeOutCubic:function(a){return 1*((a=a/1-1)*a*a+1)},easeInOutCubic:function(a){return(a/=.5)<1?.5*a*a*a:.5*((a-=2)*a*a+2)},easeInQuart:function(a){return a*a*a*a},easeOutQuart:function(a){return-1*((a=a/1-1)*a*a*a-1)},easeInOutQuart:function(a){return(a/=.5)<1?.5*a*a*a*a:-.5*((a-=2)*a*a*a-2)},easeInQuint:function(a){return 1*(a/=1)*a*a*a*a},easeOutQuint:function(a){return 1*((a=a/1-1)*a*a*a*a+1)},easeInOutQuint:function(a){return(a/=.5)<1?.5*a*a*a*a*a:.5*((a-=2)*a*a*a*a+2)},easeInSine:function(a){return-1*Math.cos(a/1*(Math.PI/2))+1},easeOutSine:function(a){return 1*Math.sin(a/1*(Math.PI/2))},easeInOutSine:function(a){return-.5*(Math.cos(Math.PI*a/1)-1)},easeInExpo:function(a){return 0===a?1:1*Math.pow(2,10*(a/1-1))},easeOutExpo:function(a){return 1===a?1:1*(1-Math.pow(2,-10*a/1))},easeInOutExpo:function(a){return 0===a?0:1===a?1:(a/=.5)<1?.5*Math.pow(2,10*(a-1)):.5*(2-Math.pow(2,-10*--a))},easeInCirc:function(a){return a>=1?a:-1*(Math.sqrt(1-(a/=1)*a)-1)},easeOutCirc:function(a){return 1*Math.sqrt(1-(a=a/1-1)*a)},easeInOutCirc:function(a){return(a/=.5)<1?-.5*(Math.sqrt(1-a*a)-1):.5*(Math.sqrt(1-(a-=2)*a)+1)},easeInElastic:function(a){var b=1.70158,c=0,d=1;return 0===a?0:1==(a/=1)?1:(c||(c=.3),d<Math.abs(1)?(d=1,b=c/4):b=c/(2*Math.PI)*Math.asin(1/d),-d*Math.pow(2,10*(a-=1))*Math.sin((1*a-b)*(2*Math.PI)/c))},easeOutElastic:function(a){var b=1.70158,c=0,d=1;return 0===a?0:1==(a/=1)?1:(c||(c=.3),d<Math.abs(1)?(d=1,b=c/4):b=c/(2*Math.PI)*Math.asin(1/d),d*Math.pow(2,-10*a)*Math.sin((1*a-b)*(2*Math.PI)/c)+1)},easeInOutElastic:function(a){var b=1.70158,c=0,d=1;return 0===a?0:2==(a/=.5)?1:(c||(c=.3*1.5*1),d<Math.abs(1)?(d=1,b=c/4):b=c/(2*Math.PI)*Math.asin(1/d),a<1?d*Math.pow(2,10*(a-=1))*Math.sin((1*a-b)*(2*Math.PI)/c)*-.5:d*Math.pow(2,-10*(a-=1))*Math.sin((1*a-b)*(2*Math.PI)/c)*.5+1)},easeInBack:function(a){var b=1.70158;return 1*(a/=1)*a*((b+1)*a-b)},easeOutBack:function(a){var b=1.70158;return 1*((a=a/1-1)*a*((b+1)*a+b)+1)},easeInOutBack:function(a){var b=1.70158;return(a/=.5)<1?a*a*((1+(b*=1.525))*a-b)*.5:.5*((a-=2)*a*((1+(b*=1.525))*a+b)+2)},easeInBounce:function(a){return 1-c.easeOutBounce(1-a)},easeOutBounce:function(a){return(a/=1)<1/2.75?7.5625*a*a*1:a<2/2.75?1*(7.5625*(a-=1.5/2.75)*a+.75):a<2.5/2.75?1*(7.5625*(a-=2.25/2.75)*a+.9375):1*(7.5625*(a-=2.625/2.75)*a+.984375)},easeInOutBounce:function(a){return a<.5?.5*c.easeInBounce(2*a):.5*c.easeOutBounce(2*a-1)+.5}},d=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){return window.setTimeout(a,1e3/60)}}(),e=function(){return window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||function(a){return window.clearTimeout(a,1e3/60)}}(),f=function(a,b,e,f,g,h){var i=0,j=c[e]||c.linear;d(function k(){i++;var c=i/b,e=j(c);if(a.call(h,e,c,i),f.call(h,e,c),i<b)try{h.animationFrame=d(k)}catch(l){void 0}else g.apply(h)})};void 0===a||void 0===a.exports?(b.easingEffects=c,b.requestAnimFrame=d,b.cancelAnimFrame=e,b.animationLoop=f):(a.exports.easingEffects=c,a.exports.requestAnimFrame=d,a.exports.cancelAnimFrame=e,a.exports.animationLoop=f)}("undefined"==typeof window?void 0:window)},function(a,b,c){"use strict";b.__esModule=!0;var d=c(0),e=function(a){return a&&a.__esModule?a:{"default":a}}(d),f=function(){function a(){(0,e.default)(this,a)}return a.getCircle=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16724736,e=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,f=new PIXI.Graphics;return f.beginFill(d,e),f.drawCircle(a,b,c),f.endFill(),f},a.getRectangle=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16724736,e=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,f=new PIXI.Graphics;return f.beginFill(d,e),f.drawRect(a,b,c,c),f.endFill(),f},a}();b.default=f},function(a,b,c){"use strict";var d=c(205)();a.exports=function(a){return a!==d&&null!==a}},function(a,b){a.exports=function(a){if("function"!=typeof a)throw TypeError(a+" is not a function!");return a}},function(a,b,c){a.exports={"default":c(219),__esModule:!0}},function(a,b){a.exports={}},function(a,b,c){var d=c(150),e=c(112);a.exports=Object.keys||function(a){return d(a,e)}},function(a,b){var c={}.toString;a.exports=function(a){return c.call(a).slice(8,-1)}},function(a,b,c){var d=c(28).f,e=c(51),f=c(19)("toStringTag");a.exports=function(a,b,c){a&&!e(a=c?a:a.prototype,f)&&d(a,f,{configurable:!0,value:b})}},function(a,b,c){"use strict";b.__esModule=!0;var d=c(21),e=function(a){return a&&a.__esModule?a:{"default":a}}(d);b.default=function(a){return function(){var b=a.apply(this,arguments);return new e.default(function(a,c){function d(f,g){try{var h=b[f](g),i=h.value}catch(j){return void c(j)}if(!h.done)return e.default.resolve(i).then(function(a){d("next",a)},function(a){d("throw",a)});a(i)}return d("next")})}}},function(a,b,c){var d=c(42),e=c(235),f=c(236),g=c(29),h=c(109),i=c(158),j={},k={},b=a.exports=function(a,b,c,l,m){var n,o,p,q,r=m?function(){return a}:i(a),s=d(c,l,b?2:1),t=0;if("function"!=typeof r)throw TypeError(a+" is not iterable!");if(f(r)){for(n=h(a.length);n>t;t++)if((q=b?s(g(o=a[t])[0],o[1]):s(a[t]))===j||q===k)return q}else for(p=r.call(a);!(o=p.next()).done;)if((q=e(p,s,o.value,b))===j||q===k)return q};b.BREAK=j,b.RETURN=k},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(2),h=d(g),i=c(1),j=d(i),k=c(3),l=d(k),m=c(173),n=d(m),o=c(52),p=d(o),q=c(23),r=d(q),s=c(10),t=function(a){function b(c,d,e){var g=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"move";(0,f.default)(this,b);var i=(0,h.default)(this,a.call(this,c,d));return i.stage.motion.on("update",i.onMotionUpdate,i),i.cursorStyleTarget=e,i.draggableStyle=g,i._init(),i._bindEventListeners(),i.dragEnable=!0,i._pivotMin={x:0,y:0},i._pivotMax={x:0,y:0},i._boundaryChanged=!1,i._border={top:0,left:0,right:0,bottom:0},i._editingScale=1,i}return(0,l.default)(b,a),(0,j.default)(b,null,[{key:"CHANGE",get:function(){return"zoomChange"}},{key:"VIEWPORT_CHANGE",get:function(){return"viewportChange"}},{key:"DRAG",get:function(){return"drag"}}]),b.prototype.initWithTarget=function(a,b){return this._target&&this._disposeTarget(),b&&(this._boundary=b),this._target=a,this._boundaryChanged=!0,this},b.prototype.dispose=function(){this._disposeTarget(),document.removeEventListener("keyup",this._onKeyUp),this.stage.motion.off("complete",this.onMotionComplete,this)},b.prototype.fitToScreen=function(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0]||!this.stage.motion.running){var a=Math.min(this.boundary.width/this.textureWidth,this.boundary.height/this.textureHeight);this.scale=Math.min(1,a)}},b.prototype.alignToCenter=function(){this.target.pivot.x=this._textureFrame.width>>1,this.target.pivot.y=this._textureFrame.height>>1},b.prototype.updateTargetTexture=function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this._textureFrame.width=a.width,this._textureFrame.height=a.height,this._editingScale=b,this._checkDraggable()},b.prototype.getFitScale=function(a){return Math.min(a.width/this.textureWidth,a.height/this.textureHeight)},b.prototype.autoScale=function(){var a=arguments.length>0&&void 0!==arguments[0]&&arguments[0],b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0,d=this.getFitScale(this.boundary);if(b!=1/0&&c!=1/0){var e=s.TEMP_POINT_A,f=s.TEMP_POINT_B;e.x=b,e.y=c,this.target.toLocal(e,null,f),b=f.x,c=f.y}a?this.scaleTo(Math.min(1,d),b,c):this.scaleTo(1,b,c)},b.prototype.viewportTo=function(a){var b=arguments.length>1&&void 0!==arguments[1]&&arguments[1],c=this.getFitScale(a);b?this.scaleTo(c):this.scaleTo(Math.min(1,c))},b.prototype.moveTo=function(a,b){var c=s.TEMP_POINT_A,d=s.TEMP_POINT_B,e=p.default[this.options.scaleMotion]||p.default.linear;c.x=a,c.y=b,this.target.toLocal(c,null,d),this._checkBoundary(d),this.stage.motion.play(this,{pivotX:d.x,pivotY:d.y},this.options.scaleDuration,e)},b.prototype.scaleTo=function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0,d=p.default[this.options.scaleMotion]||p.default.linear,e=this._textureFrame;b==1/0&&(b=(e.width+this.border.right-this.border.left)/2),c==1/0&&(c=(e.height+this.border.bottom-this.border.top)/2),this.stage.motion.play(this,{scale:a,pivotX:b,pivotY:c},this.options.scaleDuration,d)},b.prototype._init=function(){this._tempMat=new PIXI.Matrix,this._tempPoint={x:0,y:0},this.point={x:0,y:0},this.inversePoint={x:0,y:0},this.zoomEnable=!0,this._frame=new n.default(3,100),this._frame.centerGridVisible=!0,this._textureFrame={x:0,y:0,width:1,height:1}},b.prototype._bindEventListeners=function(){this._onMouseUp=this.onMouseUp.bind(this),this._onMouseLeave=this.onMouseLeave.bind(this),this._onKeyUp=this.onKeyUp.bind(this),this._onTimeout=this.onTimeout.bind(this),this.stage.motion.on("update",this.onMotionUpdate,this),this.stage.motion.on("complete",this.onMotionComplete,this)},b.prototype._disposeTarget=function(){this.enable=!1},b.prototype._addMouseEvents=function(a){for(var b=0;b<a.length;b+=2)this.target.on(a[b],a[b+1],this)},b.prototype._removeMouseEvents=function(a){for(var b=0;b<a.length;b+=2)this.target.off(a[b],a[b+1],this)},b.prototype._checkDraggable=function(){var a=this.target,b=a.width,c=a.height,d=this.boundary.width,e=this.boundary.height;this.enable=(0|b)>d||(0|c)>e,this.enable?this._checkBoundary():(a.pivot.x=this.centerX,a.pivot.y=this.centerY),this._boundaryChanged=!0},b.prototype._checkBoundary=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;null==a&&(a=this.target.pivot),this._updatePivotBoundary();var b=this.target,c=this.boundary,d=this._textureFrame.width,e=this._textureFrame.height,f=void 0,g=void 0,h=void 0,i=void 0;b.width>c.width?(f=this._pivotMin.x,g=d-this._pivotMax.x,a.x=Math.max(f,Math.min(a.x,g))):b.width<=c.width&&(a.x=this.centerX),b.height>c.height?(h=this._pivotMin.y,i=e-this._pivotMax.y,a.y=Math.max(h,Math.min(a.y,i))):b.height<=c.height&&(a.y=this.centerY)},b.prototype._updatePivotBoundary=function(){if(this._boundaryChanged){var a={x:0,y:0},b=this.target.scale.x*this._editingScale;a.x=this.boundary.width/2-this.border.left*b,a.y=this.boundary.height/2-this.border.top*b,this._getTransform(this.target).applyInverse(a,this._pivotMin),a.x=this.boundary.width/2-this.border.right*b,a.y=this.boundary.height/2-this.border.bottom*b,this._getTransform(this.target).applyInverse(a,this._pivotMax),this._boundaryChanged=!1}},b.prototype._getTransform=function(a){var b,c,d,e,f=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(0!=a.rotation){var g=f?-1:1,h=Math.cos(g*a.rotation),i=Math.sin(g*a.rotation),j=a.scale;b=h*j.x,c=i*j.x,d=-i*j.y,e=h*j.y}else b=a.scale.x,c=0,d=0,e=a.scale.y;return this._tempMat.set(b,c,d,e,0,0),this._tempMat},b.prototype.onMouseOver=function(a){this.dragEnable},b.prototype.onMouseOut=function(a){this.dragEnable},b.prototype.onMouseDown=function(a){this.dragEnable&&(this._px=a.data.global.x,this._py=a.data.global.y,this.target.on("mousemove",this.onMouseMove,this),document.body.addEventListener("mouseup",this._onMouseUp),document.addEventListener("mouseout",this._onMouseLeave))},b.prototype.onMouseMove=function(a){var c=a.data.global.x,d=a.data.global.y,e=c-this._px,f=d-this._py,g=this.target,h=this.target.worldTransform;this._tempMat.set(h.a,h.b,h.c,h.d,0,0),this._tempPoint.x=e,this._tempPoint.y=f,this._tempMat.applyInverse(this._tempPoint,this._tempPoint),g.pivot.x-=this._tempPoint.x,g.pivot.y-=this._tempPoint.y,this._checkBoundary(),this._px=c,this._py=d,this.emit(b.DRAG),this.compareOriginalEnable&&(Math.abs(c-this._cx)<this.options.compareEnableBoundary&&Math.abs(d-this._cy)<this.options.compareEnableBoundary||(this.stage.showOriginal=!1,clearTimeout(this._timeoutID)))},b.prototype.onMouseUp=function(a){this.target.off("mousemove",this.onMouseMove,this),document.body.removeEventListener("mouseup",this._onMouseUp),document.removeEventListener("mouseout",this._onMouseUp),this.compareOriginalEnable&&(this.stage.showOriginal=!1,clearTimeout(this._timeoutID))},b.prototype.onMouseLeave=function(a){var b=a.relatedTarget||a.toElement;b&&"HTML"!=b.nodeName||this.onMouseUp(null)},b.prototype.onKeyUp=function(a){if(this.zoomEnable)switch(a.keyCode){case 32:this.autoScale()}},b.prototype.onMotionUpdate=function(a){this._checkDraggable(),this.emit(b.CHANGE,{type:b.CHANGE,target:this})},b.prototype.onMotionComplete=function(a){this._checkDraggable()},b.prototype.onTimeout=function(a){this.stage.showOriginal=!0},b.prototype.onCompareDown=function(a){if(document.body.addEventListener("mouseup",this._onMouseUp),document.addEventListener("mouseout",this._onMouseLeave),!this.enable)return void(this.stage.showOriginal=!0);this._timeoutID=setTimeout(this._onTimeout,this.options.showOriginalDelay),this._cx=a.data.global.x,this._cy=a.data.global.y},(0,j.default)(b,[{key:"target",get:function(){return this._target}},{key:"textureFrame",get:function(){return this._textureFrame}},{key:"enable",get:function(){return this._enable||!1},set:function(a){this._enable=a,this.target&&(a?(this.target.interactive=!0,this._addMouseEvents(["mousedown",this.onMouseDown])):this._removeMouseEvents(["mouseover",this.onMouseOver,"mouseout",this.onMouseOut,"mousedown",this.onMouseDown,"mousemove",this.onMouseMove,"mouseup",this.onMouseUp]))}},{key:"compareOriginalEnable",get:function(){return this._compareOriginalEnable||!1},set:function(a){this._compareOriginalEnable=a,this.target&&(a?this._addMouseEvents(["mousedown",this.onCompareDown]):this._removeMouseEvents(["mousedown",this.onCompareDown]))}},{key:"boundary",get:function(){return this._boundary},set:function(a){this._boundary=a,this._frame.x=a.x,this._frame.y=a.y,this._frame.setSize(a.width,a.height),this._checkDraggable()}},{key:"fitToScreenAvailable",get:function(){return 1>Math.min(this.boundary.width/this._textureFrame.width,this.boundary.height/this._textureFrame.height)}},{key:"frameVisible",get:function(){return null!=this._frame.parent},set:function(a){a!=this.frameVisible&&(a?this.stage.addChild(this._frame):this._frame.parent&&this._frame.parent.removeChild(this._frame))}},{key:"scale",get:function(){return this.target.scale.x},set:function(a){this.target.scale.x=this.target.scale.y=a,this._checkDraggable()}},{key:"pivotX",get:function(){return this.target.pivot.x},set:function(a){this.target.pivot.x=a}},{key:"pivotY",get:function(){return this.target.pivot.y},set:function(a){this.target.pivot.y=a}},{key:"border",get:function(){return this._border},set:function(a){this._border=a,this._checkDraggable()}},{key:"textureWidth",get:function(){return this._textureFrame.width+(this._border.left+this._border.right)}},{key:"textureHeight",get:function(){return this._textureFrame.height+(this._border.top+this._border.bottom)}},{key:"centerX",get:function(){return(this._textureFrame.width+this._border.right-this.border.left)/2}},{key:"centerY",get:function(){return(this._textureFrame.height+this._border.bottom-this.border.top)/2}}]),b}(r.default);b.default=t},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(2),h=d(g),i=c(1),j=d(i),k=c(3),l=d(k),m=c(23),n=d(m),o=c(25),p=d(o),q=c(47),r=(d(q),c(10),c(17)),s=c(31),t=d(s),u=c(132),v=d(u),w=c(313),x={};x.Cropper=c(315);var y={};y.Func=c(34),y.Calc=c(61),y.Painter=c(133),y.Mouse=c(75);var z={};z.KeyCode=c(183),z.HitSide=c(96);var A=Math.PI/180,B=function(a){function b(c,d){(0,f.default)(this,b);var e=(0,h.default)(this,a.call(this,c,d));return e._init(d),e}return(0,l.default)(b,a),(0,j.default)(b,null,[{key:"CROP_START",get:function(){return"cropStart"}},{key:"CROP_END",get:function(){return"cropEnd"}},{key:"BOUNDARY_CHANGE",get:function(){return"boundaryChange"}},{key:"CROP_COMPLETE",get:function(){return"cropComplete"}}]),b.prototype._init=function(a){this._transforms.push(new p.default),this._imageTransform=new v.default,y.Mouse.renderer=a.renderer,this.cropVO=null,this.isStart=!1,this.pe=a,this._delayStartId=0,this._nextStepCheckId=0,this._autoRotateAngle=0,this._externalRotateAngle=0,this.canvas=a.canvas,this.cropper=new x.Cropper(this.canvas,this._options),this.cropper.on(x.Cropper.MOVE_START,this.onMoveStart.bind(this)),this.cropper.on(x.Cropper.MOVE,this.onMove.bind(this)),this.cropper.on(x.Cropper.MOVE_END,this.onMoveEnd.bind(this)),this.cropper.on(x.Cropper.ROTATE_START,this.onRotateStart.bind(this)),this.cropper.on(x.Cropper.ROTATE,this.onRotate.bind(this)),this.cropper.on(x.Cropper.ROTATE_END,this.onRotateEnd.bind(this)),this.cropper.on(x.Cropper.UI_CHANGE,this.onUIChange.bind(this)),this.cropper.on(x.Cropper.UI_MOVE_START,this.onUIMoveStart.bind(this)),this.cropper.on(x.Cropper.UI_MOVE,this.onUIMove.bind(this)),this.cropper.on(x.Cropper.UI_MOVE_END,this.onUIMoveEnd.bind(this)),this.cropper.on(x.Cropper.CHANGE_CURSOR,this.onChangeCursor.bind(this)),this.cropper.on(x.Cropper.CHANGE_ASPECT_RATIO,this.onChangeAspectRatio.bind(this)),this.cropper.on(x.Cropper.ASPECT_RATIO_MOTION_START,this.onAspectRatioMotionStart.bind(this)),this.cropper.on(x.Cropper.RESET,this.onReset.bind(this)),this.cropper.on(x.Cropper.RESET_COMPLETE,this.onReset.bind(this)),this.cropper.visible=!1,this.pe.addChild(this.cropper),this._boundaryChangeEvent={type:b.BOUNDARY_CHANGE,points:null},this._enlargable=!0,this.stage.on(t.default.SAVE_CROP,this.onSaveCrop,this),this.stage.on(t.default.RESTORE_CROP,this.onRestoreCrop,this)},b.prototype._checkReadyToNextStep=function(a){var b=this;this._nextStepCallback=a.bind(this),this._loopCount=0,this._lastLoop=new Date,clearInterval(this._nextStepCheckId),this._nextStepCheckId=setInterval(function(){b._fpsCheck()},10)},b.prototype._fpsCheck=function(){this._thisLoop=new Date,(1e3/(this._thisLoop-this._lastLoop)>=60||30===this._loopCount)&&this._nextStepCallback(),this._lastLoop=this._thisLoop,this._loopCount=this._loopCount+1},b.prototype._noticeStart=function(){var a=this;clearInterval(this._nextStepCheckId),this._delayStartId=setTimeout(function(){a.emit(b.CROP_START)},20)},b.prototype._noticeEnd=function(){var a=this;clearInterval(this._nextStepCheckId),this.hide(),this.emitBoundaryChange(null),this.screenFitEnable||(this.screenFitEnable=!1),this.emit(b.CROP_END),this._delayStartId=setTimeout(function(){a.screenFitEnable||(a.screenFitEnable=!1),a.emit(b.CROP_END)},20)},b.prototype.identity=function(a,b){this.cropVO=null,this._autoRotateAngle=Number.MAX_VALUE,this.transform.identity()},b.prototype.snapshot=function(){var a={};return this.running?a.cropVO=this.cropper.getCropVO():a.cropVO=this.cropVO,this.isStart&&this._saved?a.transform=(0,r.map)(this._saved,function(a){return a}):a.transform=this.transform.save(),a},b.prototype.reset=function(b){var c=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(b){this.cropVO=b.cropVO||null,this.transform.restore(b.transform);var d=(360+(b.externalRotation||0)%360)%360,e=-1==this.transform.canvasWidth?this.bitmapdata.sourceWidth:this.transform.canvasWidth,f=-1==this.transform.canvasHeight?this.bitmapdata.sourceHeight:this.transform.canvasHeight;d%360&&this.transform.rotate(d*A,e,f,(d/90|0)%2),this.setCropVOExternalAngle(),b.externalRotation=0,this.running&&this.cropper.restore(this.cropVO)}else this.running&&this.cropper.reset(),this.cropVO=null,this._saved=null,this.transform.identity();a.prototype.reset.call(this,c)},b.prototype.setCropVOExternalAngle=function(){var a=this.cropVO?this.cropVO.imageRestoreVO.rotation:0,b=this.transform.radian;this._externalRotateAngle=180*(b-a)/Math.PI},b.prototype.start=function(){a.prototype.start.call(this),this._cropped=!1,this.stage.emit("photoFrameDisable",{type:"photoFrameDisable",visible:!1}),this.stage.emit("historyChanged",{type:"historyChanged",target:this,redoable:!1,undoable:!1}),this.pe.on("bitmapDataUpdate",this.onInvalidate,this),this.pe.motion.on("complete",this.onMotionComplete,this),this.stage.emit(t.default.MOUSE_CHILDREN_CHANGE,{type:t.default.MOUSE_CHILDREN_CHANGE,interactive:!1})},b.prototype.suspend=function(){return this.stage.emit(t.default.MOUSE_CHILDREN_CHANGE,{type:t.default.MOUSE_CHILDREN_CHANGE,interactive:!0}),this.isStart=!1,this._externalRotateAngle=0,clearTimeout(this._delayStartId),clearInterval(this._nextStepCheckId),this.pe.off("bitmapDataUpdate",this.onInvalidate,this),this.pe.motion.off("complete",this.onMotionComplete,this),this.cropper.suspend(),this._saved&&this.transform.restore(this._saved),this._cropped?(this.pe.once("bitmapDataUpdate",this.onSuspendUpdateBitmapData,this),this.pe.updateBitmapData(),!0):(this.stage.emit(t.default.RESTORE_MASK,{flush:!1}),this.stage.emit(t.default.RESTORE_RESIZE),this.isEditingImageChanged()?(this.pe.once("bitmapDataUpdate",this.onSuspendUpdateBitmapData,this),this.pe.updateBitmapData()):this.onSuspendUpdateBitmapData(),a.prototype.suspend.call(this))},b.prototype.crop=function(){var a=this.cropper.cropByMatrix(this.stage.imageTransformControls.resize.maxScale);this.cropVO=this.cropper.getCropVO(),this.isNewChanged&&(this.transform.setTo(a),this._saved=null,this.pushHistory(),this._cropped=!0,this.stage.emit(t.default.RESTORE_MASK,{flush:!0}),this.stage.emit(t.default.RESTORE_RESIZE))},b.prototype.rotate=function(){var a=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.cropper.rotate(a)},b.prototype.autoRotate=function(){if(this._autoRotateAngle==Number.MAX_VALUE){var a=this.bitmapdata.transformedImageData,b=new w;this._autoRotateAngle=b.process(a,30)}return!(Math.abs(this._autoRotateAngle)<Math.PI/180)&&(this.cropper.autoRotate(this._autoRotateAngle),!0)},b.prototype.changeAspectRatio=function(a,b){this.cropper.changeAspectRatio(a,b)},b.prototype.emitBoundaryChange=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this._boundaryChangeEvent.points=a,this.stage.emit(this._boundaryChangeEvent.type,this._boundaryChangeEvent)},b.prototype.flipX=function(){this.cropper.flipX(),this.emitBoundaryChange(this.cropper.ui.points)},b.prototype.flipY=function(){this.cropper.flipY(),this.emitBoundaryChange(this.cropper.ui.points)},b.prototype.show=function(){this.cropper.visible=!0,this.pe._container.visible=!1},b.prototype.hide=function(){this.cropper.visible=!1,this.pe._container.visible=!0},b.prototype.onSaveCrop=function(a){this._backup=this.snapshot(),this.reset(null)},b.prototype.onRestoreCrop=function(a){this._backup&&this.reset(this._backup)},b.prototype.onSuspendUpdateBitmapData=function(a){this.hide(),this.cropper&&this.cropper.removeMask(),this.stage.enableMask(),this.stage._maskContainer.addChild(this.stage._objectContainer),this.emitBoundaryChange(null),this.stage.emit("photoFrameDisable",{type:"photoFrameDisable",visible:!0}),this.stage.emit(b.CROP_COMPLETE),this.stage._emitHistoryChange(),this.emitBoundaryChange(null),this.screenFitEnable||(this.screenFitEnable=!1),this.emit(b.CROP_END)},b.prototype.onMotionComplete=function(a){if(this.pe.motion.off("complete",this.onMotionComplete,this),this.isEditingImageChanged())return this.stage.emit(t.default.SAVE_RESIZE),this.stage.emit(t.default.SAVE_MASK),this._saved=this.transform.save(this._saved),this.transform.canvasWidth=this.bitmapdata.sourceWidth,this.transform.canvasHeight=this.bitmapdata.sourceHeight,this.transform.identity(),void this.invalidate();this._saved=null,this.onInvalidate()},b.prototype.isEditingImageChanged=function(){return this.modified||this.stage.getModifiedStateAt("resize")||this.stage.getModifiedStateAt("clip")||this.stage.entrySize>0},b.prototype.onInvalidate=function(){this.isStart=!0,this.pe.off("bitmapDataUpdate",this.onInvalidate,this),this.cropper.start(this.canvas,this.bitmapdata,this.cropVO,this._externalRotateAngle,this.stage.imageTransformControls.resize),this.cropVO=this.cropper.getCropVO(),this.cropper.addContainer(this.stage._objectContainer);var a=this.stage.disableMask(),c=a[0],d=a[1];if(d){this.stage._objectContainer.addChild(c),this.cropper.setMask(d)}this.show(),this.cropper.updateTransform(),this.emitBoundaryChange(this.cropper.ui.points),this.emit(b.CROP_START)},b.prototype.onUIChange=function(a){this.emitBoundaryChange(this.cropper.ui.points),this.emit(x.Cropper.UI_CHANGE,a)},b.prototype.onMoveStart=function(a){this.emitBoundaryChange(this.cropper.ui.points),this.emit(x.Cropper.MOVE_START,a)},b.prototype.onMove=function(a){this.emitBoundaryChange(this.cropper.ui.points),this.emit(x.Cropper.MOVE,a)},b.prototype.onMoveEnd=function(a){this.emitBoundaryChange(this.cropper.ui.points),this.emit(x.Cropper.MOVE_END,a)},b.prototype.onUIMoveStart=function(a){this.emitBoundaryChange(this.cropper.ui.points),this.emit(x.Cropper.UI_MOVE_START,a)},b.prototype.onUIMove=function(a){this.emitBoundaryChange(this.cropper.ui.points),this.emit(x.Cropper.UI_MOVE,a)},b.prototype.onUIMoveEnd=function(a){this.emitBoundaryChange(this.cropper.ui.points),this.emit(x.Cropper.UI_MOVE_END,a)},b.prototype.onRotateStart=function(a){this.emitBoundaryChange(this.cropper.ui.points),this.emit(x.Cropper.ROTATE_START,a)},b.prototype.onRotate=function(a){this.emitBoundaryChange(this.cropper.ui.points),this.emit(x.Cropper.ROTATE,a)},b.prototype.onRotateEnd=function(a){this.emitBoundaryChange(this.cropper.ui.points),this.emit(x.Cropper.ROTATE_END,a)},b.prototype.onChangeCursor=function(a){this.emit(x.Cropper.CHANGE_CURSOR,a)},b.prototype.onChangeAspectRatio=function(a){this.emitBoundaryChange(this.cropper.ui.points),this.emit(x.Cropper.CHANGE_ASPECT_RATIO,a)},b.prototype.onAspectRatioMotionStart=function(a){this.emit(x.Cropper.ASPECT_RATIO_MOTION_START,a)},b.prototype.onReset=function(a){this.stage.emit(b.CROP_COMPLETE)},(0,j.default)(b,[{key:"transform",get:function(){return this.imageTransform.transform}},{key:"modified",get:function(){return!!this.stage.ready&&(!!this.transform.modified||(-1!=this.transform.canvasWidth||-1!=this.transform.canvasHeight)&&(this.transform.modified||this.transform.canvasWidth!=this.bitmapdata.sourceWidth||this.transform.canvasHeight!=this.bitmapdata.sourceHeight))}},{key:"viewport",get:function(){return this.cropper.viewport},set:function(a){this.cropper.viewport=a,this.isStart&&this.cropper.resize()}},{key:"isPossibleAutoRotate",get:function(){if(-1===this._autoRotateAngle){var a=this.bitmapdata.transformedImageData,b=new w;this._autoRotateAngle=b.process(a,30)}return-1!==this._autoRotateAngle&&Math.abs(this._autoRotateAngle)>=y.Calc.RADIAN_1}},{key:"rotation",get:function(){return this.isStart?y.Calc.toDegrees(this.cropper.uiRotation):0}},{key:"isChanged",get:function(){return this.cropper.isChanged}},{key:"isNewChanged",get:function(){if(!this.cropper||!this.bitmapdata)return!1;var a=this.stage.history.getPrevHistory(),b=a.snapshot.crop,c=b.transform,d=this.cropper.cropByMatrix(this.stage.imageTransformControls.resize.maxScale);return(-1!=c.canvasWidth&&-1!=c.canvasHeight?c.canvasWidth!=d.canvasWidth||c.canvasHeight!=d.canvasHeight:this.stage.maskedWidth!=d.canvasWidth||this.stage.maskedHeight!=d.canvasHeight)||d.offsetX!=c.offsetX||d.offsetY!=c.offsetY||d.radian!=c.radian||d.scaleX!=c.scaleX||d.scaleY!=c.scaleY}},{key:"isMinimum",get:function(){return this.cropper.isMinimum}},{key:"isEditable",get:function(){return this.cropper.isEditable}},{key:"uiSize",get:function(){return this.cropper.getUISize(this.cropVO)}},{key:"isHorizontalImage",get:function(){return this.cropper.isHorizontal}},{key:"offsetX",set:function(a){this.cropper.offsetX=a},get:function(){return this.cropper.offsetX}},{key:"offsetY",set:function(a){this.cropper.offsetY=a},get:function(){return this.cropper.offsetY}},{key:"isHorizontal",get:function(){return y.Calc.toRoundDegreesByRadians(this.cropper.stageRotation)%180==0}},{key:"isImageRotated",get:function(){return y.Calc.toRoundDegreesByRadians(this.cropper.snapImageRotation)%90!=0}},{key:"enlargable",get:function(){return!this.stage.imageTransformControls.mask.modified}}]),b}(n.default);b.default=B},function(a,b,c){"use strict";(function(a){var b=c(4),d=function(a){return a&&a.__esModule?a:{
"default":a}}(b);!function(){var b={};Object.defineProperty(b,"renderer",{get:function(){return b._renderer},set:function(a){b._renderer=a}}),Object.defineProperty(b,"global",{get:function(){return b._renderer.plugins.interaction.mouse.global}}),Object.defineProperty(b,"globalX",{get:function(){return b._renderer.plugins.interaction.mouse.global.x}}),Object.defineProperty(b,"globalY",{get:function(){return b._renderer.plugins.interaction.mouse.global.y}}),Object.defineProperty(b,"currentCursorStyle",{get:function(){return b._renderer.plugins.interaction.currentCursorStyle},set:function(a){b._renderer.plugins.interaction.currentCursorStyle=a}}),void 0!==(0,d.default)(a)&&void 0!==(0,d.default)(a.exports)?a.exports=b:usenamespace("editor.es5.utils").Mouse=b}()}).call(b,c(6)(a))},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(2),h=d(g),i=c(1),j=d(i),k=c(3),l=d(k),m=c(15),n=d(m),o=c(77),p=d(o),q=function(a){function b(){var c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4e3;(0,f.default)(this,b);var d=(0,h.default)(this,a.call(this));return d.canvasLimitSize=c,d.initialize(),d.addEvent(),d}return(0,l.default)(b,a),(0,j.default)(b,null,[{key:"LOAD_COMPLETE",get:function(){return"drawComplete"}},{key:"TEXTURE_UPDATE",get:function(){return"textureUpdate"}}]),b.prototype.initialize=function(){this.image=null,this.scaleSignX=1,this.scaleSignY=1,this._restoreScaleSignX=-1,this._restoreScaleSignY=-1,this.interactive=!0,this.isFirstLoad=!0,this.renderableObject=!0,this.childScaleX=1,this.childScaleY=1,this.canvgCanvas=document.createElement("CANVAS"),this.canvgCanvas.id="canvgCanvas",this.canvgContext=this.canvgCanvas.getContext("2d")},b.prototype.addEvent=function(){this.drawCompleteListener=this.onDrawComplete.bind(this),this.transformCompleteListener=this.onTransformComplete.bind(this),this.on(p.default.TRANSFORM_COMPLETE,this.transformCompleteListener)},b.prototype.removeEvent=function(){this.off(p.default.TRANSFORM_COMPLETE,this.transformCompleteListener),this.drawCompleteListener=null,this.transformCompleteListener=null},b.prototype.load=function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100,e=arguments.length>4&&void 0!==arguments[4]?arguments[4]:100;this.url=a,this.originW=d,this.originH=e,this.drawSvg(b,c,d,e)},b.prototype.setSVG=function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100,e=arguments.length>4&&void 0!==arguments[4]?arguments[4]:100;this.svg=a,this.originW=d,this.originH=e,this.drawSvg(b,c,d,e)},b.prototype.setPivot=function(a){this.pivot=a},b.prototype.drawSvg=function(a,b,c,d){this.drawX=a,this.drawY=b,this.drawWidth=c,this.drawHeight=d;var e=c<0?-1:1,f=d<0?-1:1;this.scaleSignX=this.scaleSignX*e,this.scaleSignY=this.scaleSignY*f,c=Math.abs(c),d=Math.abs(d),c=c>this.canvasLimitSize?this.canvasLimitSize:c,d=d>this.canvasLimitSize?this.canvasLimitSize:d,this._timeout&&clearTimeout(this._timeout),this.canvgCanvas.style.display="none",document.body.appendChild(this.canvgCanvas),this.canvgCanvas.width=c,this.canvgCanvas.height=d,this.canvgContext.drawSvg(this.url||this.svg,a,b,c,d,{renderCallback:this.drawCompleteListener.call(this)})},b.prototype.delete=function(){this.removeEvent(),this.interactive=!1,null!==this.image&&(this.image.texture.destroy(),this.image.texture=null,this.removeChild(this.image),this.image.renderableObject=!1,this.image.destroy(),this.image=null),this.destroy(),this.svg&&this.svg.parentNode&&this.svg.parentNode.removeChild(this.svg),this._timeout&&(clearTimeout(this._timeout),this._timeout=-1),this.canvgCanvas.parentNode&&document.body.removeChild(this.canvgCanvas),this.svg=null,this.canvgCanvas.svg=null,this.canvgCanvas=null,this.canvgContext=null,this.drawCompleteListener=null,this.transformCompleteListener=null},b.prototype.checkAlphaPoint=function(a){var b=this.worldTransform.applyInverse(a);return 0==this.canvgContext.getImageData(b.x,b.y,1,1).data[3]},b.prototype.onTransformComplete=function(a){"middleCenter"==a.type?this.notifyTextureUpdate():this.drawSvg(0,0,this.width,this.height)},b.prototype.onDrawComplete=function(){!0===this.isFirstLoad?(this.isFirstLoad=!1,this.createImage()):(this.resetScale(),this.notifyTextureUpdate()),this._timeout=setTimeout(function(){this.canvgCanvas.parentNode&&document.body.removeChild(this.canvgCanvas)}.bind(this),500)},b.prototype.createImage=function(){this.image=new PIXI.Sprite(new PIXI.Texture.fromCanvas(this.canvgCanvas)),this.image.renderableObject=!0,this.addChild(this.image),this.emit(b.LOAD_COMPLETE,{target:this})},b.prototype.resetScale=function(){var a=this.pivot.x,b=this.pivot.y,c=this.width*Math.abs(1/this.scale.x),d=this.height*Math.abs(1/this.scale.y),e=a/c,f=b/d;this.scale.x=this.scale.y=1,this.image.scale={x:this.scaleSignX,y:this.scaleSignY},this.image.texture.update(),this.image.updateTransform(),this.pivot.x=e*this.width,this.pivot.y=f*this.height},b.prototype.notifyTextureUpdate=function(){this.emit(b.TEXTURE_UPDATE,{target:this,scaleSignX:this.scaleSignX,scaleSignY:this.scaleSignY})},b.prototype.toString=function(){void 0;var a=this.getLocalBounds(),b=this.image.getLocalBounds();void 0,void 0},(0,j.default)(b,[{key:"ID",get:function(){return this._id},set:function(a){this._id=a}},{key:"scaleForOrigin",get:function(){return{x:this.width/this.originW,y:this.height/this.originH}}},{key:"snapshot",get:function(){return{url:this.url,svg:this.svg,x:this.drawX,y:this.drawY,width:this.drawWidth,height:this.drawHeight,transform:{x:this.x,y:this.y,scaleX:this.scale.x,scaleY:this.scale.y,pivotX:this.pivot.x,pivotY:this.pivot.y,rotation:this.rotation,childIndex:this.parent.getChildIndex(this),childScaleX:this.image.scale.x,childScaleY:this.image.scale.y,originW:this.originW,originH:this.originH,scaleSignX:this.scaleSignX,scaleSignY:this.scaleSignY},pngSource:!1}}},{key:"complete",get:function(){return!0}}]),b}(PIXI.Container);b.default=q},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(2),h=d(g),i=c(1),j=d(i),k=c(3),l=d(k),m=c(57),n=d(m),o=c(15),p=d(o),q=c(78),r=d(q),s=c(98),t=d(s),u=c(185),v=d(u),w=c(186),x=d(w),y=c(76),z=d(y),A=c(17),B={tl:null,tr:null,tc:null,bl:null,br:null,bc:null,ml:null,mr:null,mc:null,rtl:null,rtc:null,rtr:null,rml:null,rmr:null,rbl:null,rbc:null,rbr:null},C=new PIXI.Matrix,D=function(a){function b(c,d){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{useSnap:!0,snapAngle:5,deleteButtonOffsetY:0};(0,f.default)(this,b);var g=(0,h.default)(this,a.call(this));return g.stageLayer=c,g.targetLayer=d,g.options=e,g.useSnap=e.useSnap,g.snapAngle=e.snapAngle,g.selectedControl=null,g.deleteButtonSize=28,g.deleteButtonOffsetY=e.deleteButtonOffsetY,g.initialize(),g.addEvent(),g._px=0,g._py=0,g}return(0,l.default)(b,a),(0,j.default)(b,null,[{key:"DELETE",get:function(){return"delete"}},{key:"SET_TARGET",get:function(){return"setTarget"}},{key:"TRANSFORM_COMPLETE",get:function(){return"transformComplete"}},{key:"SELECT",get:function(){return"select"}},{key:"DESELECT",get:function(){return"deselect"}},{key:"REQ_INPUT",get:function(){return"requestInput"}},{key:"DBCLICK",get:function(){return"dbClick"}},{key:"CONTROL_UP",get:function(){return"controlUp"}}]),b.prototype.initialize=function(){this.target=null,this.transform=new PIXI.Matrix,this.invertTransform=new PIXI.Matrix,this.g=this.graphics=new PIXI.Graphics,this.stageLayer.addChild(this.graphics),this.rotationCursorList=[new PIXI.Sprite.fromImage("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAOCAYAAAA8E3wEAAAAAXNSR0IArs4c6QAAAyRJREFUOBGNVF1IU2EY9pz9z9YkRdaPIfhHiV4V3Sy80S4jijLqwvDGO/Uq6KLLqBtpN+G9SndJmSBZlDYbNjeGLWSW2CQxt0E65+bmfk7Pc/I7HRdELzx7v/d7f7/3fc+kiv8jSWemPyu6e/1Zd334qHemhrJwFDryctCWRNtyiHvyv0gflEohC0PKMmDQcZFcJCpBVwQEF/e40uLxjqQwmAggJ5PJ85AZnDACZsAK2IBKwK5DuWyBjvb0EzEY8xxkfR41IQ3MhULBt7y8fBHnI8BR4FhLS8uJ2dnZqxsbG4/hPJnNZkPAJ2BxZ2dnKhaLPfH7/bc7OztP0x5wACymErpr+Xz+Gc4mgDnUDjI7q7JDGUqn03PT09OXqqurTwaDwTu7u7tvw+Hw68HBwZnW1tavJpMpB1vFaDTmUcxqb2/vnM/newW/D5FIZKC9vf0U9LVLS0s39/b2/Llc7jlkdog5JDEjCpb9/X1vV1eXPDExkYbhWiKRqO3p6XEFAoEzkiQpCPYFSLhcrlw8HjejG1ULCwtni8Wiob6+/vvo6Gikra0tH41G39TV1V3v6+uTR0ZG4na7/Rbis9ACoPaXvXciySK40tHR8dnj8bwzGAwFh8ORHBoamkqlUu/R8nHYPALuAQ8hP81kMnNjY2OTNTU1Cfr29/d7Nzc3PzY1Na01NzdH0aFJ3LPNbKvWUias4mzAxZYpbrc7vLW15UWyBysrK43QcQ4cgQa85jiS3gW83d3d8/Q3m81q23UJuQ9qQjqSmKTEtqnSwY/NZitYLJYKVPyysbExSpsyKGhlDC3zYF7jw8PDRXQkhdHwASTlICb9tNh8prY0BwrtlZhpAAFmtre3ud5qS8D1JGNhrmBjZxoaGr5Bofnihavo2gvccWnULWUAgi81YPjzoVDoh6IoamBWhzmWEKgSlbPqAdwFwTWC7WUI97FEP9fX1/P0Ff7wkeCbxWbfgA3/HNTAomoZs3KjIhmJ1TskU6xWawmfAD8DIqNPiMCs+gKWxwBIhN4f4yjJspx2Op0sUn25SFbOoT9ENCYJ/lv68/svf72P8gunF5KUe/EFxQAAAABJRU5ErkJggg=="),new PIXI.Sprite.fromImage("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAZCAYAAADE6YVjAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyppVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTMyIDc5LjE1OTI4NCwgMjAxNi8wNC8xOS0xMzoxMzo0MCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUuNSAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo1Rjc3NTE3RDZEQTcxMUU2OTkwNzk1ODBGOTZCN0JBOSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo1Rjc3NTE3RTZEQTcxMUU2OTkwNzk1ODBGOTZCN0JBOSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjVGNzc1MTdCNkRBNzExRTY5OTA3OTU4MEY5NkI3QkE5IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjVGNzc1MTdDNkRBNzExRTY5OTA3OTU4MEY5NkI3QkE5Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+bXt2owAAA1tJREFUeNqsVt1LWmEY99XjR7ZNZ8yGC0YrG2ODddXNBjXGrlpjH25rhKj76Cbovqv9A4PddN9N7kLYYNiFoMyltmBusUqIIHJCzTJD0yzNr/1e9xrH0wfH2gsPnvfjPL/3eZ7f7zkSycFBJIePsuSEQ3oIAGHr0kKh8Ix3hkj+w6g652DKTCbzulQq+fEsh8lOAyIVRECdyTc2Nmy5XM5cLBbpvoKtS5mRegGlghTJV1dXX+bz+RddXV2XkS66pmJA1YhkvHdIvZHI1tfXLYSQp52dndfw3IR0Kbxe752RkRED9ht4gJwATFQtuGQyORiNRr16vT5GmaRQKHJjY2OeQCDgTqVS37HvmJ2d7W9vb7+A/XMMVM7LxvEgqMFV5P9nT0/PL0bVGuM4Lt/b2/tjfn6eAjodDsdtrJ+HNYoFqqQqHo8/3tra8uGmv6ljjUaTDIfDkx6Px2Wz2fxqtXqbrpvN5m+IanpmZsaMeZNYoP2iI12mRCLhp0BarTYBhk0vLS09B51H0+m0b3h4+AsFovubm5tTDEgHU7M6ETEaUaDgT2hEYFcILPOz3Csikcj1vb09u9vtnkC9shQI56bHx8dvYV9DtSVGT/sRIe8Pd3d3fWDXJLthRSNOp1MNoPcul2uCRmS1WgM4+7m1tbWZpY0TRQLmUJbNZh+Uy2WvQEuEAX0YGhqie+VQKOQJBoP9eNayaKRiKV0xgNwVaKFyibW1tRuIwKdSqTJ9fX1BSm9GgobTtqAaNiLSUYvF4qP0pjoCKYxYPyNgGpGIDe2QzwAB4yYHBgbSaD0c9JM0mUw3GQDH63WVs5xY70gdvaWJNk2wjsD5pY6ODtpiJKA5uYeB34vQUwFWVCqVJUjgE6SQFA2CnrYNoLhMJnuLQkfn5uY40L0Smd1u1+/s7EgxrhiNxkJ3d3cz2PkOAKnqDY81IRZlHYT5ta2tLSxsPy0tLX9isZh/ZWXFyprpPxLUC0JfRFd4RAULoEgVwGAwRMG6qcXFxTeYn2XdWnpSkIpgaWeotiAaAeaBhYWFQaYXVQ2V6wSpaUG019GI0MV9y8vLr1h7UfG6RAWEHOGIX/DjBEtTdx8+GnU63UfMi8z4tToxiETwCSZCx/y/UNwplF8+4v/YgVv/FWAAZA0E5twGSyUAAAAASUVORK5CYII="),new PIXI.Sprite.fromImage("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAcCAYAAABRVo5BAAAAAXNSR0IArs4c6QAAAztJREFUOBF9VN9rUnEU915NS5BV2JRqa7CYkOAeEgqmSTF7jC2IPfU22Nvajzehl6CHHmR/xN6FbCP6icsZgYrDLXFzNFcgONlQNyf+urfP+d77vdwN6sC53+/3nPM53/PrewWDQoK60qLf01mmj0ra3gQBNxTVPZ25jOwlMAE4iK0EJCKQEUxnYjoT9VTuqisHMyPh+PjYZ7ValyRJEsCiLMsCiD6cm41GY76vry9J3kDMgVipVB6mUqlVVUBCxoFAIAvA+vb2th+yC2AeibLp9XoC3QKFRgD9jEajjUQi8crlcm1oCnXDczwvN0xOTlZarVZ5YmJiC0p9wWgvs6uNRiPLhdDBYHDD5/NtLS4u+pFCfzwefwwxXUDFOxOViOIEMpnMO4BSp6en8aOjo3WbzVbzer25k5OTLwj1OkA28Jk8hWaz+aBer39tt9uxQqFwH45eh8Ph9zCUNzc3P62trT3F/gr4Ili7Weh0On4UZ71arXqhMO3u7t4G+BvaIc3NzcVKpdIS5NfAVtKDlZABukusCkho7Ha7kdHR0bzb7S7UarUVyBxgHq7AigPPaWIotB6iRQWPx1PZ2dkZtFgsN6AjhxprDYXwPNWcTmcLaZih4HkpIULwP6Dt4ODAbDKZaE7ZiOlWBYj8yCMnFg56ewujdnl4ePgPql2CUv9KlAGA8B7AT7BSBEKxWOyH8WAymbwzNjZWQrt+qUAOVgxRQbrxJQaawCa73f48EolUUSDj9PR0Y39//zvk/InxsA1sAMrl8gcMQezw8HCepgfgytDQ0G84S4yPjw8CSK2gQml1YSOXTqdXkM8exi0xNTX1AwYyJuZjPp9/gf1V8CUwry628KB/j5jROmTy7OxsHJO0il7exFl/G2sJu1b/HjFqNjS8HQqFzCjS52w22waQisILw3LU4oVCI7xDMx6yY2Bg4Fkul3sEhVYQbsQeMm6QEKIwMjKyBwXrI9pjmJmZEZeXlxdQuI7D4Xir6pgTZoQh9uJnFULIIjFASh6iKGEQJFEUe6j0G/ysUurtzICBIaCK8ZdOKZBnYuofjZ0+T/Vd6aYeBtwRtoy4A/2qAcmChafY/vNLYEZ/ARukibLGcoOhAAAAAElFTkSuQmCC"),new PIXI.Sprite.fromImage("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAZCAYAAADE6YVjAAAAAXNSR0IArs4c6QAAA71JREFUSA2lVUlPU1EYhU6UYi1qJIGwYlghsIGVkQ0JG8QRg4YgjVNMmhB/gQv+gAsXpCtcgFEjJgoaQouFUuwCIYHCCoSSME9lKnR+nvPoNWD7kMYvOX33ft+999xvuk1P+z9JV9guHderjk9SHJOAUK2vrxfjq+Y4rlMih/nsIh+O5dqNjY070Wh0dHt7+xnmGYAGEGQYHk3kQQo/wgPN8vLyTa1W+6K6ulp9eHj4YHV19RHO0QH0SqxL4eijpX88wIF3fT7fUFFRkRcmKScnZ21paWlwcXHRgnkmkOARdGcSkqh3d3dv7ezsOAUBdEy0IBpAjp5jztAJjzA8u6QHAoEbCI2zsrLSYzKZfMA2tks6nS5oNBr3SLy1tTXo9/ufQJ86iSRJ1YAjFosNhsPhoWAw6J6bmxskSXt7ux0Hj+ICbtiGscYViUQaYKP3KYnICeOdOTMz02C323sxllwul83hcNRjfAnIArSAXGX8SVUY/xgQzc3NvdbZ2Zml0WgiZWVlpr6+vgnog0A4vuZEU0KXXBCec39ZZG/m5+dL9vb2nAaDwV9bW/sTffIB6y4AekDkQjFUNMgAwXXAHJ/jc6Tv7u42hEKhzpaWlu/QSR6PxzY+Pn4fYyPAMCkeDptsZAjVrCIQjCB5bDBBrIoTvLLZbD3QS01NTT9Q0t2oqsuYGwDmS5GEBhJo0WS3EYoBt9v9BdXyOL5RvbKycgUevO3t7e1ByQZYrgiTu6ur6yrWnAfY7TwjKYkg0LGT2WiFhYVzVqv1G8hebm5u3sPhr3Fjp8ViceAQiQTQD4+NjTVhzlyILj+VQIu3qJ5PBQjmeVBra6vd6/XaUDVfm5ubnXq93k+92Wx24SLuOEFCyWJNgpBZzRDFnwqZADr5qRBflGm4rq5uZHJy0g6PPnd0dDBEF4ETPYF5gjBJlHQkOQshSUPCWR2y1NTUTDQ2Nq4hNFJpaWk2utg7PT39qby83IFOD2AR+4GIAuJSGCaK7AnUmbOzs4+RE1deXt4y5lJbW1s/Xlar0+msR7nyj4mhyQZ4+6T/HdAniPCEt4gWFBR8nJqa0iDWDysqKiSVShU7ODjwVFVV9cMubix3O+bcwzGFY0VhuQk36XKwpKTkPXLzBkS/iouLI+joCPQMDZ+LEHCcTOyF+t/CkJGQnvFZMC4sLJjxtzqGPniKOfOkWP+wnSrHw8WFdJ83jeXn57/b398PZWRksP6pT+nWWK8o9Eh4xUdODU/YaEKvuPE0Azcnk2T6U5Ob7BCh+w13D8jLwsORsAAAAABJRU5ErkJggg=="),new PIXI.Sprite.fromImage("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAOCAYAAAA8E3wEAAAAAXNSR0IArs4c6QAAAy1JREFUOBF9VE1IG1EQdpNs/jQNiAlW0h8UYkEIWCN4EQ/V3irFXgoFLd682PRorz3YS6iXHjwK4qktLRWkhlKtqWColcSSotEmXiS2KElM1MRkt9+87ixbKX3wMfPmzcw3M5mNVPfnSJokYdTZrGoKS7az5BiWbGfJcSo7kJTy+XyXoij15XLZRJ5ms1m12+2KxWJRNdRgXpMkiaQ4qqp2VatVJyARzs7OTLVaTeTleJfLFYWzQgEWQJBBmp1O55Pd3V378fGxqAiJVYLP55O9Xm8jfJ4ayXAXB8VMnp6eVhBbApkJRQhCiu3s7LwMpx7NVZDSoxlwoLq3fr//B3QiFGhra0sXCoWlUql0FzbROaTxSLlcLlipVJYGBga+4EGPJf38/HwD0glwc6JDujQg6TsQpsmRgFEUjo6OPh8eHj7G3QoQoagekg/dLalUqufk5GQFpESgk+LnieN+CZABE1dMQTwKkdBqtVYwWtfY2JjZ4XAMFYvFUDqd9sJP+JI/Y2dn53pzc/MdJK/DaKl4/Wjj/atQSkDsLiSdR4eZ9vb2TDabXRsfH1+BXW1qavo1Ozs7jw6iWIw5JJ4EJoBnuL9GYZ/C4fACJpLHolSnpqY+9vX1faNY+FCHbkBMiMgIVJUNCeeGh4e909PTyt7e3svW1tZb8XhcHhkZuZHJZK4gWa27uzuJgnLoqLy/v29PJBIewE+dBIPB7zMzM1mPx/PTZrNdGxwcrI9EIgqm1Yv8ZaAK6IQOVPMGI4klk8n7sHsDgYBve3v7EX7bVZz3o6OjUVoq6gLvqizL5Y6OjlQoFFra3NyMYEIf1tfXH2LbWxYXF28jLnphacRPSB3Slsp4fHVwcHAPer0GF2Rjf3//1Vgs9gBvL7CxC9jmOJAANvDtzqPT58vLy0PovIX8AVqShq2trV6MfBU6jZM4JB6pkPThu93ur3jgQxWRI42cfmfSeVmg6ttI3xd1zaA/BtrUOuS8iZz650JEdC5K4azZ6Y2JWIoCYef1JwIiZcnxMInDd/2vjR8uSmMhTMKSfZnUKOmNScifdb0zDv6fZHLyMep6MtiN+j9z/Qasm4fFL/kTlgAAAABJRU5ErkJggg=="),new PIXI.Sprite.fromImage("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAZCAYAAADE6YVjAAAAAXNSR0IArs4c6QAAA6lJREFUSA2lVUlLW1EUNiZGY4zGxhoiIggqQqtLEVqo0KVYOqTowqYKHRFcdeOy/oFuCl260S5EkFYLYtLGTKTUKg3RhSixLpI4GzXikOH1+0KuxDHRHji8e84993xnuvfJss4n2Tlq6RxdRirFKSvhnF/BdC4AxPfUscvF7JRt4ZQ6gis3Nzfbtra2HmAtB4t9LK9GIhPhQADk+nw+YywWe65UKrOCwaDcYDB8heto0v21MiIIo80Da2dnZ1+vrKw4y8vLA1VVVX+RjQPyE+zlgBkI7a9EPMCDSrBmbm7u5fLysqusrCwIOdEPAm1vb9sB9gg6UTosM6fjLPx+f+fq6qqDGeB4AkB8q6urfbu7uxMHBwfs0ZUyoXEik3A43KpSqd7ZbLaV+fl5RTwezx4eHi4ZHx+v7+3t/a7X64/q6+ujjY2NBpx5L5PJRvHNiBKND4VChXK5XIVIP9XW1sorKioU+fn5deA4QLJMJpOk0+l+KhQKP4ZBgm2JJEkFAApnhAIjkQ1rzcaqwMV2u93ocrnGsZYA9G1jY+Mp1gxK2GOZGbHhYhzjWMfAHNPI0NCQp66uTovoowMDAxq1Wn0vxVacgerqxCiZEbPRoYyDLS0tk3l5eXs7Ozt2TN1t6FNHOJEVSncfepEhv2mJTnLB2snJybaZmRkL1lJXV5f16Ojo88jISD7kVIfZALEmp44BpgYB8XyiA9ZeXVlZqUcGXzo6OpyQpbGxsVEAfUgC0RmZk2jb39+3w/Yh5IwuLEEYEbMp6u/vv4OL6OaFxBNzYDabCTSwtLR0C/u8wKpIJOJoaGjw8sImXwbq02YksmFpbkxPTz/DdLkIBFnq7u7+gXG37+3tfVxYWGg9PDx0a7XaLfEE4a0zwi5tRgRhJDRUg3UAMmEQ3O3t7W7IEu5QuLOz02GxWMYWFxdtRUVFIerFE7S+vv4YMitCXxfSaaDiwcHBu6j7iNfrNTc3N//GeEdw+sTzQ7mpqekPLu3U2tpaDeRLQYieCsSxLkSkNz0eTxvHGz345XQ6zX19fRb06xD7Umlp6SrKNYH9V5DF5cXychJAPMCGsk8acHFPT0+N1Wo1ojdTGo1mlwCBQGACzX+LfQ5O2nLB5pgIlArGXvHfUwDWYXwT0wcAG17yLugYCINKO2GwOUOpYIySmakxwi78qm3owRvILGvayYJNRkRAAuXgMjpRshdYs0TXzgBnz5DISh6NRluxS0DymRLR8H/oovMnXul/F7SWjoEFkdEAAAAASUVORK5CYII="),new PIXI.Sprite.fromImage("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAcCAYAAABRVo5BAAAAAXNSR0IArs4c6QAAAz9JREFUOBFtVN9LU3EU997b7nJrG+hkYWKGOEFBIhdIWFHMFx+iN4NASv+A8EXfetxTkD304rNo0INgVhhkybURbmuwcDCnDRNxOtT9cIr7cW+f83Xf23XswNn5nvP9fs4538/33Al1F0W46Nb0NIpeMmwRqFr5Nh3mSjHNCKQAAUUoxaWKTzEVWoaWKlavyCplMplei8UyoaqqVC6XRVhKUicIgiZJkkp6cnLiczgcQV6R2hAQ+LW3tzdjt9snhoeH1UgkcpWAENbm/Px8zOVyWeFTIV3IoUSWaDT65ODgwN/R0bEFn99NCwQCn5LJ5EPERNYKFkYRurq6lra3t98ripKUZblg3ORrDmR3RJB8saenR25ra/P6fL4CRLbZbDkCVO5KHehCQGKxHtqwvr7+Ynl5+QvW2tDQ0M/Dw8Mf7e3tiVAotJDL5e4jzguyhYyAzev1tubzeT8q/nU6nSmwqOC+Y9ls9juIWzw9Pb2Hc1SI/VC1y9CG1dXVp36/fxFrbXp6euH4+HgcaxnJHmuaFigWi3fh60Bik2huQta3IyMjK3izEqqtJBIJehJ2dwAfQe/AZ0JoE9QGdaGlz263+09fX1+kVCrNIMYnCEu0oWnks0wE5CqC/ubNzc3Wzs7ONKZni85WFAYHBYFG7z87FKMARABAwoTQ+2VZpMaPTiv2eOayyWQq7O7umhFz1MCwEJHCAcyenZ3t4I5XMKdNIMiNfX4Nut8tQqHdEK9IIOpdBe3xgYGBHQDdeDPnxsbGDcSldDrdC/sGhFlgBSOQvrlSPB5XRkdHi8guTE1N5XHX54h58Lm9wtQUAORc4Pg5SexJwGYzHv2rx+OJYkYzR0dHCk0PJioUDoc/VI8cZdFnFTP5bG1tbYmGoL+//zdaD2NfCwaDH1Op1INKIZhzAqhtmld7Y2Pjtf39/XeTk5Pf4OvkGb/HC/8A/NDs7Gy32Wy+Pjc3R9NUUzhQ34zFYjdbWlpeDg4OWvFpdesbWBi/R84QWQF/VretVutrMFpPrHIlgCiKKlQDUWMgTeFASkxruieRRJ2QZQMNy54Klv89qtVAVhkHeBIsmegEwaMk+mCz3SrfmJT2CcxF+wduL3Nt3V5HIgAAAABJRU5ErkJggg=="),new PIXI.Sprite.fromImage("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAZCAYAAADE6YVjAAAAAXNSR0IArs4c6QAAA5hJREFUSA2lVklMU1EUtb/fTlIpihgIG2TYOCxYsGFDYsIGMYoTCVaKGKNpQly4YeOCuHehG5Yk6IKEhaKGUBT6EZtQJRJgQUgaSJgqQylQZvo9p/aZ30mmm9z8++5775x777vv5etOHE90Sbar8T4p3nGIcYRgeXnZhj3EodInFOZfOQ4JESSj0Vi1trZ2D/ZJqEwfNIboqCQCRNra2tKbzebnU1NT1QA3QkkWQ3QYkn/AURA9vvL6+rrkdrv9BoOhfmxsjEQm+qFcH5GDkGjBCcxIDVBGbQKJPD4+LhcXF+enp6c7RkdHWTrOcW1k734kgiASdXSzGV9LQ0NDtqIoVy0Wy+VwOCyhXNkgupCZmWn3+Xy3NSQwUwsJGAQjt0DT8/Lyznu93mp0VNvKyspAf39/V0tLi6u8vHwI82xdNTc3d2Z+fl5ZWlq6j3FM2TCOES3BKcycaW1tLQXw+5GRke7KykqvLMs78EeAtd+CgoKJYDCoBAKBm/CLksGMlXiCs4ODg3Zs9Dgcjm9YqppMplBtba3S1dX1aWJiwtXU1NRNPwkA3jc7O8tyabsslgEjkjBN1j4DBA8WFxf7CYCx6nQ6e5CRsr29/Rr+O6urqy+am5s/FxYW+piB3++/hXVsDJaaWAkisuCi0+3t7aWov4cEaNHNzs7OjwB/Nzc3dwnzkWbY2Nio93g8H0DWGy3RfzMgo8jCAuBziLjDbrd/h191uVwkeNXR0cEmEFHqdnd3H6qq6t3c3LwOP4nFHMzkQhJGYh0aGqoeHh52wVbRrl9B8DZKwDVUig4EDug12hrlXIKIBYyENzaDbVpRUfED92ANpVAmJycvwp8QJQjSEtCSOLQEPIu0xsbGIhziANu0rq6uLxQKvYFfe5gikyRwiS5GRuEm2iyVEZfrCkoVRL3lmpqaEFqyD/4D1RvrEoStegJgdyVJcu7t7UmwJTwThra2tgDn8vPzzTk5Oc92dnacer1e1el0Ybhf4vuF8wcVZqFHSR7hKXCzXa1W6ypadgt+FY/ess1mC5SUlAyjXZVoFx2qXAwkQoKvEW/Ok5mZGXdWVtZvEgglMS8aWvoGfCzbkUh4HpFbPj097QRRryAiAZ+K6E3e96IBJ6UwMnHwFgA+xWH3lJWV/WIGsPkWabsrJdB+E4KIGRlxTx6jEX4uLCxUYXysDOKJBRHrLuOMivA9cusKcILGSzIf1yT8T8VvTDX+A7nQiRk9jngZAAAAAElFTkSuQmCC")];for(var a=0;a<this.rotationCursorList.length;a++){var b=this.rotationCursorList[a];b.visible=!1,b.anchor={x:.5,y:.5},this.stageLayer.addChild(b)}var c={photoEditor:this.stageLayer},d={photoEditor:this.stageLayer,rotationCursorList:this.rotationCursorList},e={photoEditor:this.stageLayer};this.c=this.controls={de:new t.default(v.default.DELETE,e),tl:new t.default(v.default.TOP_LEFT,c),tc:new t.default(v.default.TOP_CENTER,c),tr:new t.default(v.default.TOP_RIGHT,c),ml:new t.default(v.default.MIDDLE_LEFT,c),mr:new t.default(v.default.MIDDLE_RIGHT,c),bl:new t.default(v.default.BOTTOM_LEFT,c),bc:new t.default(v.default.BOTTOM_CENTER,c),br:new t.default(v.default.BOTTOM_RIGHT,c),mc:new t.default(v.default.MIDDLE_CENTER,c),rde:new t.default(v.default.ROTATION,d,x.default.DELETE),rtl:new t.default(v.default.ROTATION,d,x.default.TOP_LEFT),rtc:new t.default(v.default.ROTATION,d,x.default.TOP_CENTER),rtr:new t.default(v.default.ROTATION,d,x.default.TOP_RIGHT),rml:new t.default(v.default.ROTATION,d,x.default.MIDDLE_LEFT),rmr:new t.default(v.default.ROTATION,d,x.default.MIDDLE_RIGHT),rbl:new t.default(v.default.ROTATION,d,x.default.BOTTOM_LEFT),rbc:new t.default(v.default.ROTATION,d,x.default.BOTTOM_CENTER),rbr:new t.default(v.default.ROTATION,d,x.default.BOTTOM_RIGHT)},this.c.mc.on(t.default.MOVE_START,this.onControlMoveStart.bind(this)),this.c.mc.on(t.default.MOVE,this.onControlMove.bind(this)),this.c.mc.on(t.default.MOVE_END,this.onControlMoveEnd.bind(this)),this.c.mc.on(t.default.DBCLICK,this.onControlDBClick.bind(this)),this.stageLayer.addChild(this.c.rde),this.stageLayer.addChild(this.c.rtl),this.stageLayer.addChild(this.c.rtc),this.stageLayer.addChild(this.c.rtr),this.stageLayer.addChild(this.c.rml),this.stageLayer.addChild(this.c.rmr),this.stageLayer.addChild(this.c.rbl),this.stageLayer.addChild(this.c.rbc),this.stageLayer.addChild(this.c.rbr),this.stageLayer.addChild(this.c.mc);for(var f in this.controls){var g=this.controls[f];switch(g.visible=!1,g.centerPoint=this.controls.mc,g.targetLayer=this.targetLayer,g.type){case v.default.DELETE:this.stageLayer.addChild(g),g.on("click",this.onDelete.bind(this));break;case v.default.ROTATION:g.on(t.default.ROTATE_START,this.onRotateStart.bind(this)),g.on(t.default.ROTATE,this.onRotate.bind(this)),g.on(t.default.ROTATE_END,this.onRotateEnd.bind(this)),g.on(t.default.CHANGE_ROTATION_CURSOR,this.onChangeRotationCursor.bind(this));break;case v.default.TOP_LEFT:case v.default.TOP_RIGHT:case v.default.TOP_CENTER:case v.default.MIDDLE_LEFT:case v.default.MIDDLE_RIGHT:case v.default.BOTTOM_LEFT:case v.default.BOTTOM_RIGHT:case v.default.BOTTOM_CENTER:this.stageLayer.addChild(g),g.on(t.default.MOVE_START,this.onControlMoveStart.bind(this)),g.on(t.default.MOVE,this.onControlMove.bind(this)),g.on(t.default.MOVE_END,this.onControlMoveEnd.bind(this))}}},b.prototype.addEvent=function(){this.stageLayer.on(b.SET_TARGET,this.onSetTarget.bind(this)),this.stageLayer.root.on("mousedown",this.onMouseDown,this),this.stageLayer.root.on("mouseup",this.onMouseUp,this),this.downCnt=0},b.prototype.onMouseDown=function(a){a.data.originalEvent.target==this.stageLayer.renderer.view&&(this._px=a.data.global.x,this._py=a.data.global.y)},b.prototype.onMouseUp=function(a){if(a.data.originalEvent.target==this.stageLayer.renderer.view){if(--this.downCnt<0&&this.target){var c=a.data.global.x-this._px,d=a.data.global.y-this._py;c*c+d*d<=100&&(this.target.emit(b.DESELECT),this.target.visible=!0,this.releaseTarget())}this.downCnt=0}},b.prototype.show=function(){this.controls&&!this.g.visible&&(this.g.visible=!0,(0,A.each)(this.controls,function(a){return a.visible=!0}))},b.prototype.hide=function(){this.controls&&!1!==this.g.visible&&(this.g.visible=!1,(0,A.each)(this.controls,function(a){return a.visible=!1}),(0,A.each)(this.rotationCursorList,function(a){return a.visible=!1}))},b.prototype.activeTarget=function(a){this.target=a,this.removeTextureUpdateEvent(),this.addTextureUpdateEvent(),this.update(),this.drawCenter(),this.target.emit(b.SELECT,a),this.stageLayer.emit(b.SET_TARGET,a)},b.prototype.drawCenter=function(){null!==this.target&&(this.stageLayer.updateTransform(),this.c.mc.drawCenter(p.default.toRadians(this.c.mc.angle),this.width,this.height))},b.prototype.setTarget=function(a){var c=a.target;c.emit(b.SET_TARGET,c),this.activeTarget(c),this.c.mc.emit("mousedown",a),this.enableCurrentStyleCursor("move")},b.prototype.releaseTarget=function(){null!==this.target&&(this.hide(),this.removeTextureUpdateEvent(),this.target=null)},b.prototype.addTextureUpdateEvent=function(){this.target._targetTextureUpdateListener=this.onTextureUpdate.bind(this),this.target.on(z.default.TEXTURE_UPDATE,this.target._targetTextureUpdateListener)},b.prototype.removeTextureUpdateEvent=function(){null!==this.target&&null!==this.target._targetTextureUpdateListener&&(this.target.off(z.default.TEXTURE_UPDATE,this.target._targetTextureUpdateListener),this.target._targetTextureUpdateListener=null)},b.prototype.update=function(){null!==this.target&&(this.setControls(),this.updateTransform(),this.draw(),this.updatePrevTargetLt())},b.prototype.setControls=function(){var a=this.target.scaleSignX,b=this.target.scaleSignY,c=this.target.getLocalBounds(),d=c.width*a,e=c.height*b,f=this.deleteButtonOffsetY*b;this.c.tl.localPoint=new PIXI.Point(0,0),this.c.tr.localPoint=new PIXI.Point(d,0),this.c.tc.localPoint=r.default.interpolate(this.c.tr.localPoint,this.c.tl.localPoint,.5),this.c.bl.localPoint=new PIXI.Point(0,e),this.c.br.localPoint=new PIXI.Point(d,e),this.c.bc.localPoint=r.default.interpolate(this.c.br.localPoint,this.c.bl.localPoint,.5),this.c.ml.localPoint=r.default.interpolate(this.c.bl.localPoint,this.c.tl.localPoint,.5),this.c.mr.localPoint=r.default.interpolate(this.c.br.localPoint,this.c.tr.localPoint,.5),this.c.mc.localPoint=r.default.interpolate(this.c.bc.localPoint,this.c.tc.localPoint,.5),this.c.de.localPoint=r.default.add(this.c.tl.localPoint.clone(),new PIXI.Point(0,f));var g=this.c;this.c.rde.localPoint=new PIXI.Point(g.de.localPoint.x,g.de.localPoint.y),this.c.rtl.localPoint=new PIXI.Point(g.tl.localPoint.x,g.tl.localPoint.y),this.c.rtc.localPoint=new PIXI.Point(g.tc.localPoint.x,g.tc.localPoint.y),this.c.rtr.localPoint=new PIXI.Point(g.tr.localPoint.x,g.tr.localPoint.y),this.c.rml.localPoint=new PIXI.Point(g.ml.localPoint.x,g.ml.localPoint.y),this.c.rmr.localPoint=new PIXI.Point(g.mr.localPoint.x,g.mr.localPoint.y),this.c.rbl.localPoint=new PIXI.Point(g.bl.localPoint.x,g.bl.localPoint.y),this.c.rbc.localPoint=new PIXI.Point(g.bc.localPoint.x,g.bc.localPoint.y),this.c.rbr.localPoint=new PIXI.Point(g.br.localPoint.x,g.br.localPoint.y);for(var h in this.controls){this.controls[h].target=this.target}},b.prototype.updateTransform=function(){this.transform=this.target.worldTransform.clone(),this.invertTransform=this.transform.clone(),this.invertTransform.invert();for(var a in this.controls){this.controls[a].transform=this.transform}this.targetFlipScale={x:this.target.scale.x,y:this.target.scale.y}},b.prototype.updatePrevTargetLt=function(){null!==this.target&&(this.prevLtX=this.lt.x,this.prevLtY=this.lt.y)},b.prototype.scaleCorner=function(a){var b=a.target,c=a.currentMousePoint,d=this.invertTransform.apply(c),e=this.invertTransform.apply(this.startMousePoint),f=r.default.subtract(d,e),b=this.invertTransform.apply(b.globalPoint),g=this.invertTransform.apply(this.c.mc.globalPoint),h=r.default.subtract(b,g),i=2*h.x,j=2*h.y,k=(1+f.x/i)*this.targetFlipScale.x,l=(1+f.y/j)*this.targetFlipScale.y,m=Math.abs(k),n=Math.abs(l),o=k>0?1:-1,p=l>0?1:-1;m>n?l=m*p:k=n*o,this.target.scale.x=k,this.target.scale.y=l},b.prototype.scaleMiddle=function(a){var b=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],c=a.target,d=a.currentMousePoint,e=1,f=1,g=this.invertTransform.apply(d),h=this.invertTransform.apply(this.startMousePoint),i=r.default.subtract(g,h),c=this.invertTransform.apply(c.globalPoint),j=this.invertTransform.apply(this.c.mc.globalPoint),k=r.default.subtract(c,j),l=2*k.x,m=2*k.y;b?e=1+i.x/l:f=1+i.y/m,e*=this.targetFlipScale.x,f*=this.targetFlipScale.y,this.target.scale.x=e,this.target.scale.y=f},b.prototype.move=function(a){var b=a.targetChangeMovement;this.target.x+=b.x,this.target.y+=b.y},b.prototype.doTransform=function(a){switch(a.target.type){case v.default.TOP_LEFT:case v.default.TOP_RIGHT:case v.default.BOTTOM_LEFT:case v.default.BOTTOM_RIGHT:this.scaleCorner(a);break;case v.default.MIDDLE_LEFT:case v.default.MIDDLE_RIGHT:this.scaleMiddle(a,!0);break;case v.default.TOP_CENTER:case v.default.BOTTOM_CENTER:this.scaleMiddle(a,!1);break;case v.default.MIDDLE_CENTER:this.move(a)}},b.prototype.draw=function(){this.stageLayer.updateTransform();var a=this.g;a.visible=!0;var b=this.target.worldTransform.clone(),c={de:this.deleteButtonPosition,tl:b.apply(this.c.tl.localPoint),tr:b.apply(this.c.tr.localPoint),tc:b.apply(this.c.tc.localPoint),bl:b.apply(this.c.bl.localPoint),br:b.apply(this.c.br.localPoint),bc:b.apply(this.c.bc.localPoint),ml:b.apply(this.c.ml.localPoint),mr:b.apply(this.c.mr.localPoint),mc:b.apply(this.c.mc.localPoint),rde:this.deleteButtonPosition,rtl:b.apply(this.c.rtl.localPoint),rtc:b.apply(this.c.rtc.localPoint),rtr:b.apply(this.c.rtr.localPoint),rml:b.apply(this.c.rml.localPoint),rmr:b.apply(this.c.rmr.localPoint),rbl:b.apply(this.c.rbl.localPoint),rbc:b.apply(this.c.rbc.localPoint),rbr:b.apply(this.c.rbr.localPoint)};a.clear(),a.lineStyle(.5,16777215),this.drawRect(a,c);for(var d in this.controls){var e=c[d],f=this.controls[d];f.x=e.x,f.y=e.y,f.visible=!0}},b.prototype.updateGraphics=function(){if(this.target){this.stageLayer.updateTransform(),this.g.visible=!0;var a=this.c,b=this.target.worldTransform,c=(0,A.map)(B,function(c,d){return b.apply(a[d].localPoint)});c.de=c.rde=this.deleteButtonPosition,this.g.clear(),this.g.lineStyle(.5,16777215),this.drawRect(this.g,c),(0,A.each)(this.controls,function(a,b){a.x=c[b].x,a.y=c[b].y,a.visible=!0})}},b.prototype.drawRect=function(a,b){a.moveTo(b.tl.x,b.tl.y),a.lineTo(b.tr.x,b.tr.y),a.lineTo(b.br.x,b.br.y),a.lineTo(b.bl.x,b.bl.y),a.lineTo(b.tl.x,b.tl.y)},b.prototype.setPivotByControl=function(a){this.pivot=this.getPivot(a),this.setPivot(this.target,this.pivot.localPoint.x,this.pivot.localPoint.y)},b.prototype.setPivot=function(a,b,c){a.updateTransform();var d=b-a.pivot.x,e=c-a.pivot.y,f={x:d,y:e},g=C;g.setTransform(0,0,0,0,a.scale.x,a.scale.y,a.rotation,0,0);var h=g.apply(f);a.pivot.x=b,a.pivot.y=c,a.position.x+=h.x,a.position.y+=h.y},b.prototype.adjustPosition=function(){var a=this.lt.x-this.prevLtX,b=this.lt.y-this.prevLtY,c=1,d=1;this.stageLayer&&(c=this.stageLayer.croppedScaleX,d=this.stageLayer.croppedScaleY);var e=a/(this.diffScaleX*c),f=b/(this.diffScaleY*d),g=a-e,h=b-f;this.target.x=this.target.x-a+g,this.target.y=this.target.y-b+h,this.updatePrevTargetLt()},b.prototype.getPivot=function(a){switch(a.type){case v.default.DELETE:case v.default.ROTATION:return this.c.mc;case v.default.TOP_LEFT:return this.c.br;case v.default.TOP_CENTER:return this.c.bc;case v.default.TOP_RIGHT:return this.c.bl;case v.default.MIDDLE_LEFT:return this.c.mr;case v.default.MIDDLE_RIGHT:return this.c.ml;case v.default.BOTTOM_LEFT:return this.c.tr;case v.default.BOTTOM_CENTER:return this.c.tc;case v.default.BOTTOM_RIGHT:return this.c.tl;case v.default.MIDDLE_CENTER:return this.c.mc}},b.prototype.enableCurrentStyleCursor=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(null!==this.target){this.target.buttonMode=!1,this.target.interactive=!1,this.target.defaultCursor="inherit";for(var b in this.c){var c=this.c[b];c.buttonMode=!1,c.interactive=!1,c.defaultCursor="inherit"}this.stageLayer.buttonMode=!0,this.stageLayer.interactive=!0,this.stageLayer.defaultCursor=""!==a?a:n.default.currentCursorStyle}},b.prototype.disableCurrentStyleCursor=function(){if(null!==this.target){this.target.buttonMode=!0,this.target.interactive=!0,this.target.defaultCursor="inherit";for(var a in this.c){var b=this.c[a];b.buttonMode=!0,b.interactive=!0,b.defaultCursor="inherit"}this.stageLayer.buttonMode=!1,this.stageLayer.interactive=!1,this.stageLayer.defaultCursor="inherit",this.selectedControl.onMouseOver()}},b.prototype.emitControlUp=function(a){a&&this.emit(b.CONTROL_UP,{type:b.CONTROL_UP})},b.prototype.onSetTarget=function(a){this.target!==a&&this.releaseTarget()},b.prototype.onDelete=function(a){this.target&&(this.target.emit(b.DELETE,this.target),this.emit(b.CONTROL_UP,{type:b.CONTROL_UP}))},b.prototype.onRotateStart=function(a){this.target&&(this.downCnt++,this.target._rotation=this.target.rotation,this.selectedControl=a.target,this.setPivotByControl(a.target),this.enableCurrentStyleCursor())},b.prototype.onRotate=function(a){
if(this.target){var b=!1,c=this.stageLayer;if(c.crop&&(!0,b=c.crop.isImageRotated),1==this.useSnap&&0==b){var d=this.target._rotation+a.changeRadian,e=p.default.toDegrees(d),f=Math.round(Math.abs(e)%90);f<this._startSnapAngle||f>this._endSnapAngle?this.target.rotation=p.default.toRadians(p.default.snapTo(e,90)):this.target.rotation=d,this.target._rotation=d}else this.target.rotation+=a.changeRadian,this.target._rotation=this.target.rotation;this.draw(),this.updatePrevTargetLt()}},b.prototype.onRotateEnd=function(a){this.target&&(this.update(),this.drawCenter(),this.disableCurrentStyleCursor(),this.emitControlUp(a.modified))},b.prototype.onControlMoveStart=function(a){this.target&&(this.downCnt++,this.startMousePoint={x:a.currentMousePoint.x,y:a.currentMousePoint.y},this.selectedControl=a.target,this.setPivotByControl(a.target),this.updatePrevTargetLt(),this.enableCurrentStyleCursor())},b.prototype.onControlMove=function(a){this.target&&(this.doTransform(a),this.draw(),this.updatePrevTargetLt())},b.prototype.onControlMoveEnd=function(a){this.target&&(this.target.emit(b.TRANSFORM_COMPLETE,a),this.disableCurrentStyleCursor(),this.emitControlUp(a.modified))},b.prototype.onControlDBClick=function(a){this.target&&this.target.emit(b.DBCLICK,{target:this.target})},b.prototype.onChangeRotationCursor=function(a){this.stageLayer.defaultCursor=a},b.prototype.onTextureUpdate=function(a){var b=a.target;b.width,b.height;this.setPivot(b,0,0),this.update(),this.drawCenter()},(0,j.default)(b,[{key:"lt",get:function(){this.target.displayObjectUpdateTransform();var a=this.target.worldTransform.clone();return a.rotate(-this.targetLayer.rotation),a.apply({x:0,y:0})}},{key:"deleteButtonPosition",get:function(){if(!this.c)return new PIXI.Point(0,0);var a=this.target.worldTransform.clone(),b=a.apply(this.c.tl.localPoint),c=a.apply(this.c.ml.localPoint);return r.default.add(r.default.getAddedInterpolate(b,c,this.deleteButtonOffsetY),new PIXI.Point(-this.deleteButtonSize,-this.deleteButtonSize))}},{key:"rotateControlPosition",get:function(){if(!this.c)return new PIXI.Point(0,0);var a=this.target.worldTransform.clone(),b=a.apply(this.c.tc.localPoint),c=a.apply(this.c.ro.localPoint);return r.default.getAddedInterpolate(b,c,this.rotationLineLength)}},{key:"diffScaleX",get:function(){var a=this.target.worldTransform;return Math.sqrt(a.a*a.a+a.b*a.b)}},{key:"diffScaleY",get:function(){var a=this.target.worldTransform;return Math.sqrt(a.c*a.c+a.d*a.d)}},{key:"width",get:function(){return this.target.width*this.diffScaleX}},{key:"height",get:function(){return this.target.height*this.diffScaleY}},{key:"useSnap",set:function(a){this._useSnap=a},get:function(){return this._useSnap}},{key:"snapAngle",set:function(a){this._snapAngle=a,this._startSnapAngle=a,this._endSnapAngle=90-a},get:function(){return this._snapAngle}}]),b}(PIXI.utils.EventEmitter);b.default=D},function(a,b,c){"use strict";b.__esModule=!0;var d=c(0),e=function(a){return a&&a.__esModule?a:{"default":a}}(d),f=function(){function a(){(0,e.default)(this,a)}return a.add=function(a,b){return new PIXI.Point(a.x+b.x,a.y+b.y)},a.subtract=function(a,b){return new PIXI.Point(a.x-b.x,a.y-b.y)},a.distance=function(a,b){return Math.sqrt((a.x-b.x)*(a.x-b.x)+(a.y-b.y)*(a.y-b.y))},a.getAddedInterpolate=function(b,c,d){var e=a.distance(b,c),f=(e+d)/e;return a.interpolate(b,c,f)},a.interpolate=function(a,b,c){return new PIXI.Point(b.x+c*(a.x-b.x),b.y+c*(a.y-b.y))},a.getLeft=function(a){for(var b=[a.lt,a.rt,a.rb,a.lb],c=b[0],d=1;d<b.length;d++){var e=b[d];e.x<c.x&&(c=e)}return c.x},a.getRight=function(a){for(var b=[a.lt,a.rt,a.rb,a.lb],c=b[0],d=1;d<b.length;d++){var e=b[d];e.x>c.x&&(c=e)}return c.x},a.getTop=function(a){for(var b=[a.lt,a.rt,a.rb,a.lb],c=b[0],d=1;d<b.length;d++){var e=b[d];e.y<c.y&&(c=e)}return c.y},a.getBottom=function(a){for(var b=[a.lt,a.rt,a.rb,a.lb],c=b[0],d=1;d<b.length;d++){var e=b[d];e.y>c.y&&(c=e)}return c.y},a.getBoundsWithPoints=function(a){var b=a.lt||a.tl,c=a.rt||a.tr,d=a.rb||a.br;a.lb||a.bl;return{x:b.x,y:b.y,width:c.x-b.x,height:d.y-c.y}},a}();b.default=f},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(1),h=d(g),i=c(15),j=d(i),k=function(){function a(){(0,f.default)(this,a)}return a.initialize=function(a,b){this.bitmapData=a,this.viewport=b,this.isInitialized=!0},(0,h.default)(a,null,[{key:"isAvailable",get:function(){return!!this.isInitialized&&this.isInitialized}},{key:"windowWidth",get:function(){return window.innerWidth*window.devicePixelRatio}},{key:"windowHeight",get:function(){return window.innerHeight*window.devicePixelRatio}},{key:"windowSize",get:function(){return new PIXI.Rectangle(0,0,a.windowWidth,a.windowHeight)}},{key:"windowCenterX",get:function(){return this.windowWidth/2}},{key:"windowCenterY",get:function(){return this.windowHeight/2}},{key:"canvasLimitWidth",get:function(){return 4096}},{key:"canvasLimitHeight",get:function(){return 4096}},{key:"maskMaxWidth",get:function(){return 600}},{key:"maskMaxHeight",get:function(){return 600}},{key:"initializedBackgroundImageSize",get:function(){return this._initBackgroundImageSize}},{key:"screenBounds",get:function(){if(!this._viewport)throw new Error("ScreenManager must initialize.");return this._viewport}},{key:"viewport",set:function(a){if(a){this._viewport=a,this._viewportHalfWidth=a.width/2,this._viewportHalfHeight=a.height/2;var b=j.default.getSizeFitInBounds(this.bitmapData,this.screenBounds);b.x=this.viewportCenterX,b.y=this.viewportCenterY,this._initBackgroundImageSize=b}},get:function(){if(!this._viewport)throw new Error("ScreenManager must initialize.");return this._viewport}},{key:"viewportX",get:function(){return this._viewport.x}},{key:"viewportY",get:function(){return this._viewport.y}},{key:"viewportWidth",get:function(){return this._viewport.width}},{key:"viewportHeight",get:function(){return this._viewport.height}},{key:"viewportHalfWidth",get:function(){return this._viewportHalfWidth}},{key:"viewportHalfHeight",get:function(){return this._viewportHalfHeight}},{key:"viewportCenterX",get:function(){return this.viewportX+this.viewportHalfWidth}},{key:"viewportCenterY",get:function(){return this.viewportY+this.viewportHalfHeight}},{key:"bitmapData",set:function(a){this._bitmapData=a,this._bitmapDataHalfWidth=a.width/2,this._bitmapDataHalfHeight=a.height/2},get:function(){if(!this._bitmapData)throw new Error("ScreenManager must initialize.");return this._bitmapData}},{key:"bitmapDataHalfWidth",get:function(){return this._bitmapDataHalfWidth}},{key:"bitmapDataHalfHeight",get:function(){return this._bitmapDataHalfHeight}}]),a}();b.default=k},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(15),h=(d(g),function(){function a(){(0,f.default)(this,a)}return a.drawPoint=function(a,b){var c=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,e=arguments.length>4&&void 0!==arguments[4]?arguments[4]:16724736,f=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.7;!0===c&&a.clear(),a.beginFill(e,f),a.drawCircle(b.x,b.y,d),a.endFill()},a.drawRectByBounds=function(a,b){var c=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,e=arguments.length>4&&void 0!==arguments[4]?arguments[4]:16724736,f=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.7;!0===c&&a.clear(),a.lineStyle(d,e,f),a.drawRect(b.x,b.y,b.width,b.height),a.endFill()},a.drawRectByPoints=function(a,b){var c=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,e=arguments.length>4&&void 0!==arguments[4]?arguments[4]:16724736,f=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.7;!0===c&&a.clear(),a.lineStyle(d,e,f),a.moveTo(b.lt.x,b.lt.y),a.lineTo(b.rt.x,b.rt.y),a.lineTo(b.rb.x,b.rb.y),a.lineTo(b.lb.x,b.lb.y),a.lineTo(b.lt.x,b.lt.y)},a.drawPointsByPoints=function(a,b){var c=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,e=arguments.length>4&&void 0!==arguments[4]?arguments[4]:16724736,f=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.7;!0===c&&a.clear(),a.beginFill(e,f),a.drawCircle(b.lt.x,b.lt.y,d),a.drawCircle(b.rt.x,b.rt.y,d),a.drawCircle(b.rb.x,b.rb.y,d),a.drawCircle(b.lb.x,b.lb.y,d),a.endFill()},a}());b.default=h},function(a,b){a.exports=function(a,b){return{enumerable:!(1&a),configurable:!(2&a),writable:!(4&a),value:b}}},function(a,b,c){"use strict";var d=c(220)(!0);c(107)(String,"String",function(a){this._t=String(a),this._i=0},function(){var a,b=this._t,c=this._i;return c>=b.length?{value:void 0,done:!0}:(a=d(b,c),this._i+=a.length,{value:a,done:!1})})},function(a,b){a.exports=!0},function(a,b,c){var d=c(29),e=c(149),f=c(112),g=c(110)("IE_PROTO"),h=function(){},i=function(){var a,b=c(103)("iframe"),d=f.length;for(b.style.display="none",c(151).appendChild(b),b.src="javascript:",a=b.contentWindow.document,a.open(),a.write("<script>document.F=Object</script>"),a.close(),i=a.F;d--;)delete i.prototype[f[d]];return i()};a.exports=Object.create||function(a,b){var c;return null!==a?(h.prototype=d(a),c=new h,h.prototype=null,c[g]=a):c=i(),void 0===b?c:e(c,b)}},function(a,b){var c=0,d=Math.random();a.exports=function(a){return"Symbol(".concat(void 0===a?"":a,")_",(++c+d).toString(36))}},function(a,b,c){var d=c(106);a.exports=function(a){return Object(d(a))}},function(a,b,c){c(225);for(var d=c(18),e=c(43),f=c(67),g=c(19)("toStringTag"),h="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),i=0;i<h.length;i++){var j=h[i],k=d[j],l=k&&k.prototype;l&&!l[g]&&e(l,g,j),f[j]=f.Array}},function(a,b,c){a.exports={"default":c(227),__esModule:!0}},function(a,b){b.f={}.propertyIsEnumerable},function(a,b,c){a.exports={"default":c(249),__esModule:!0}},function(a,b){var c;c=function(){return this}();try{c=c||Function("return this")()||(0,eval)("this")}catch(d){"object"==typeof window&&(c=window)}a.exports=c},function(a,b,c){"use strict";b.__esModule=!0;var d=c(0),e=function(a){return a&&a.__esModule?a:{"default":a}}(d),f=function(){function a(){(0,e.default)(this,a)}return a.initialize=function(b){a.shared=b},a}();b.default=f},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(1),h=d(g),i=c(2),j=d(i),k=c(3),l=d(k),m=c(281),n=d(m),o=c(128),p=c(302),q=d(p),r=c(40),s=d(r),t=c(46),u=d(t),v=[0,0,1,0,1,1,0,1],w=[[4,9],[8,13]],x=new Float32Array(1),y=function(a){function b(){var c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;(0,f.default)(this,b);var d=(0,j.default)(this,a.call(this,c));return d.initWithProgram(),d._buf=q.default.quadGeometry(d.gl,100,100,v),d._tex2d=null,d.updateWorldTransform(d.gl.canvas.width,d.gl.canvas.height),d}return(0,l.default)(b,a),b.prototype.initWithProgram=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.vertexSource,b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.fragmentSource;this._program&&this._program.dispose(),this._program=new n.default(this.gl,a,b)},b.prototype.initWithSize=function(a,b){var c=this;this.gl;this.clear(),this._width=a,this._height=b;var d=[a,b];return w.forEach(function(a){a.forEach(function(a,b){x[0]=d[b],c.buffer.updateVertexBuffer(a,x)})}),this},b.prototype.initWithSource=function(a){return this.initWithSize(a.width||a.naturalWidth,a.height||a.naturalHeight),this},b.prototype.updateWorldTransform=function(a,b){this._world=(0,o.projection2d)(a,b)},b.prototype.bindTexture=function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"texture",d=this.gl;d.activeTexture(d.TEXTURE0+(0|b)),d.bindTexture(d.TEXTURE_2D,a),this.program.setUniformi(c,0|b)},b.prototype.clear=function(){},b.prototype.dispose=function(){this.buffer&&this.buffer.dispose(),this._gl=null,this._program=null},b.prototype.draw=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.gl;this.program.using||this.program.use(),a&&this.bindTexture(a),this.program.setTransformMat3(this._world,"world"),this.program.draw(this.buffer)},b.prototype.drawImage=function(a){this.gl;this.program.using||this.program.use();var b=this._getTempTexture2D(a);this.draw(b.texture)},b.prototype._getTempTexture2D=function(a){return this._tex2d=this._tex2d||u.default.createTextureForSingleImage(this.gl),this._tex2d.initWithSource(a),this._tex2d},(0,h.default)(b,[{key:"buffer",get:function(){return this._buf}},{key:"program",get:function(){return this._program}},{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}},{key:"vertexSource",get:function(){return"\n	attribute vec2 position;\n	attribute vec2 texCoord;\n\n	uniform mat3 world;\n\n	varying vec2 vTexCoord;\n\n	void main() {\n		gl_Position = vec4(vec3(world * vec3(position, 1.0)).xy, 0.0, 1.0);\n\n		vTexCoord = texCoord;\n	}\n"}},{key:"fragmentSource",get:function(){return"\n	precision highp float;\n\n	uniform sampler2D texture;\n\n	varying vec2 vTexCoord;\n\n	void main() {\n		gl_FragColor = texture2D(texture, vTexCoord);\n	}\n"}}]),b}(s.default);b.default=y},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(1),h=d(g),i=c(2),j=d(i),k=c(3),l=d(k),m=c(54),n=d(m),o=c(25),p=d(o),q=c(33),r=c(95),s=d(r);s.default.WW=!1;var t={quality:3,alpha:!0,unsharpAmount:0,unsharpRadius:.6,unsharpThreshold:2},u=function(a){function b(){(0,f.default)(this,b);var c=(0,j.default)(this,a.call(this));return c._transform=new p.default,c.updateResizedSize=!0,c.identity(),c}return(0,l.default)(b,a),b.prototype.applyTransform=function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,d=this.size,e=this.getSourceSize(a),f=e[0],g=e[1];if(this.width<=0||f<=d)return this.resetResizedCache();var h=this.updateScale(f,g);return h>=1&&this.resetResizedCache(),this.updateCanvasSize(b,f*h|0,g*h|0),c&&c.matrix.preppend(this.transform.matrix),this.width<=Math.ceil(f/100)?(0,q.resizeImage)(a,b.getContext("2d"),f,g,.5):s.default.resizeCanvas(a,b,t,function(){}),b},b.prototype.updateScale=function(a,b){var c=Math.min(1,this.maximum/Math.max(a,b)),d=a*c,e=this.width<=0?Math.min(d,a):Math.min(d,this.width),f=Math.min(1,Math.max(e/a,1/b));return this.transform.scaleX=this.transform.scaleY=f,this.updateResizedSize&&(this._maxScale=c),f>=1&&this.resetResizedCache(),f},b.prototype.updateCanvasSize=function(a,b,c){a.width=Math.max(1,b),a.height=Math.max(1,c),this.updateResizedSize&&(this._resizedWidth=b,this._resizedHeight=c)},b.prototype.resetResizedCache=function(){return this.updateResizedSize&&(this._resizedWidth=0,this._resizedHeight=0),null},b.prototype.identity=function(){this.transform.identity(),this._width=0,this._maximum=8e3,this._maxScale=1,this._resizedWidth=0,this._resizedHeight=0},(0,h.default)(b,[{key:"maxScale",get:function(){return this._maxScale}},{key:"modified",get:function(){return this.width>0}},{key:"width",get:function(){return this._width},set:function(a){this._width=a+.5|0}},{key:"maximum",get:function(){return this._maximum},set:function(a){this._maximum=a}},{key:"size",get:function(){return this.width<=0?this.maximum:Math.min(this.width,this.maximum)}},{key:"transform",get:function(){return this._transform}},{key:"resizedWidth",get:function(){return this._resizedWidth}},{key:"resizedHeight",get:function(){return this._resizedHeight}},{key:"picaOption",get:function(){return t}}]),b}(n.default);b.default=u},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}var e,f,g,h,h,i=c(90),j=d(i),k=c(171),l=d(k),m=c(123),n=d(m),o=c(310),p=d(o),q=c(37),r=d(q),s=c(4),t=d(s);!function(c){if("object"===(0,t.default)(b)&&void 0!==a)a.exports=c();else{f=[],e=c,void 0!==(g="function"==typeof e?e.apply(b,f):e)&&(a.exports=g)}}(function(){return function a(b,c,d){function e(g,i){if(!c[g]){if(!b[g]){var j="function"==typeof h&&h;if(!i&&j)return h(g,!0);if(f)return f(g,!0);var k=new Error("Cannot find module '"+g+"'");throw k.code="MODULE_NOT_FOUND",k}var l=c[g]={exports:{}};b[g][0].call(l.exports,function(a){var c=b[g][1][a];return e(c||a)},l,l.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof h&&h,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){b.exports=function(){return document.createElement("canvas")}},{}],2:[function(a,b,c){var d=1;b.exports=function(){return d++}},{}],3:[function(a,b,c){function d(a){this.create=a,this.available=[],this.acquired={},this.lastId=1,this.timeoutId=0}d.prototype.acquire=function(){var a,b=this;return 0!==this.available.length?a=this.available.pop():(a=this.create(),a.id=this.lastId++,a.release=function(){b.release(a)}),this.acquired[a.id]=a,a},d.prototype.release=function(a){delete this.acquired[a.id],a.lastUsed=Date.now(),this.available.push(a),0===this.timeoutId&&(this.timeoutId=setTimeout(this.gc.bind(this),500))},d.prototype.gc=function(){var a=Date.now();this.available=this.available.filter(function(b){return!(a-b.lastUsed>2e3)||(b.destroy(),!1)}),0!==this.available.length?this.timeoutId=setTimeout(this.gc.bind(this),500):this.timeoutId=0},b.exports=d},{}],4:[function(a,b,c){function d(a){return a<0?0:a>255?255:a}function e(a){return Math.round(a*((1<<k)-1))}function f(a,b,c,d,f){var g,h,i,j,k,m,n,o,p,q,r,s,t,u,v,w,x,y=l[a].filter,z=1/d,A=Math.min(1,d),B=l[a].win/A,C=Math.floor(2*(B+1)),D=new Int16Array((C+2)*c),E=0;for(g=0;g<c;g++){for(h=(g+.5)*z+f,i=Math.max(0,Math.floor(h-B)),j=Math.min(b-1,Math.ceil(h+B)),k=j-i+1,m=new Float32Array(k),n=new Int16Array(k),o=0,p=i,q=0;p<=j;p++,q++)r=y((p+.5-h)*A),o+=r,m[q]=r;for(s=0,q=0;q<m.length;q++)t=m[q]/o,s+=t,n[q]=e(t);for(n[c>>1]+=e(1-s),u=0;u<n.length&&0===n[u];)u++;if(u<n.length){for(v=n.length-1;v>0&&0===n[v];)v--;w=i+u,x=v-u+1,D[E++]=w,D[E++]=x,D.set(n.subarray(u,v+1),E),E+=x}else D[E++]=0,D[E++]=0}return D}function g(a,b,c,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s=0,t=0;for(p=0;p<e;p++){for(l=0,q=0;q<f;q++){for(m=g[l++],n=g[l++],o=s+4*m|0,h=i=j=k=0;n>0;n--)r=g[l++],k=k+r*a[o+3]|0,j=j+r*a[o+2]|0,i=i+r*a[o+1]|0,h=h+r*a[o]|0,o=o+4|0;b[t+3]=d(k+8192>>14),b[t+2]=d(j+8192>>14),b[t+1]=d(i+8192>>14),b[t]=d(h+8192>>14),t=t+4*e|0}t=4*(p+1)|0,s=(p+1)*c*4|0}}function h(a,b,c,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s=0,t=0;for(p=0;p<e;p++){for(l=0,q=0;q<f;q++){for(m=g[l++],n=g[l++],o=s+4*m|0,h=i=j=k=0;n>0;n--)r=g[l++],k=k+r*a[o+3]|0,j=j+r*a[o+2]|0,i=i+r*a[o+1]|0,h=h+r*a[o]|0,o=o+4|0;b[t+3]=d(k+8192>>14),b[t+2]=d(j+8192>>14),b[t+1]=d(i+8192>>14),b[t]=d(h+8192>>14),t=t+4*e|0}t=4*(p+1)|0,s=(p+1)*c*4|0}}function i(a,b,c){for(var d=3,e=b*c*4|0;d<e;)a[d]=255,d=d+4|0}function j(a){var b=a.src,c=a.width,d=a.height,e=a.toWidth,j=a.toHeight,k=a.scaleX||a.toWidth/a.width,l=a.scaleY||a.toHeight/a.height,m=a.offsetX||0,n=a.offsetY||0,o=a.dest||new Uint8Array(e*j*4),p=void 0===a.quality?3:a.quality,q=a.alpha||!1;if(c<1||d<1||e<1||j<1)return[];var r=f(p,c,e,k,m),s=f(p,d,j,l,n),t=new Uint8Array(e*d*4);return g(b,t,c,d,e,r),h(t,o,d,e,j,s),q||i(o,e,j),o}var k=14,l=[{win:.5,filter:function(a){return a>=-.5&&a<.5?1:0}},{win:1,filter:function(a){if(a<=-1||a>=1)return 0;if(a>-1.1920929e-7&&a<1.1920929e-7)return 1;var b=a*Math.PI;return Math.sin(b)/b*(.54+.46*Math.cos(b/1))}},{win:2,filter:function(a){if(a<=-2||a>=2)return 0;if(a>-1.1920929e-7&&a<1.1920929e-7)return 1;var b=a*Math.PI;return Math.sin(b)/b*Math.sin(b/2)/(b/2)}},{win:3,filter:function(a){if(a<=-3||a>=3)return 0;if(a>-1.1920929e-7&&a<1.1920929e-7)return 1;var b=a*Math.PI;return Math.sin(b)/b*Math.sin(b/3)/(b/3)}}];b.exports=j},{}],5:[function(a,b,c){function d(a,b,c){for(var d,e,f,g,h,i=b*c,j=new Uint16Array(i),k=0;k<i;k++)d=a[4*k],e=a[4*k+1],f=a[4*k+2],h=d>=e&&d>=f?d:e>=f&&e>=d?e:f,g=d<=e&&d<=f?d:e<=f&&e<=d?e:f,j[k]=257*(h+g)>>1;return j}function e(a,b,c,e,g,h){var i,j,k,l,m,n,o,p,q,r,s,t,u;if(!(0===e||g<.5)){g>2&&(g=2);var v=d(a,b,c),w=new Uint16Array(v);f(w,b,c,g);for(var x=e/100*4096+.5|0,y=257*h|0,z=b*c,A=0;A<z;A++)t=2*(v[A]-w[A]),Math.abs(t)>=y&&(u=4*A,i=a[u],j=a[u+1],k=a[u+2],p=i>=j&&i>=k?i:j>=i&&j>=k?j:k,o=i<=j&&i<=k?i:j<=i&&j<=k?j:k,n=257*(p+o)>>1,o===p?l=m=0:(m=n<=32767?4095*(p-o)/(p+o)|0:4095*(p-o)/(510-p-o)|0,l=i===p?65535*(j-k)/(6*(p-o))|0:j===p?21845+(65535*(k-i)/(6*(p-o))|0):43690+(65535*(i-j)/(6*(p-o))|0)),n+=x*t+2048>>12,n>65535?n=65535:n<0&&(n=0),0===m?i=j=k=n>>8:(r=n<=32767?n*(4096+m)+2048>>12:n+((65535-n)*m+2048>>12),q=2*n-r>>8,r>>=8,s=l+21845&65535,i=s>=43690?q:s>=32767?q+(6*(r-q)*(43690-s)+32768>>16):s>=10922?r:q+(6*(r-q)*s+32768>>16),s=65535&l,j=s>=43690?q:s>=32767?q+(6*(r-q)*(43690-s)+32768>>16):s>=10922?r:q+(6*(r-q)*s+32768>>16),s=l-21845&65535,k=s>=43690?q:s>=32767?q+(6*(r-q)*(43690-s)+32768>>16):s>=10922?r:q+(6*(r-q)*s+32768>>16)),a[u]=i,a[u+1]=j,a[u+2]=k)}}var f=a("glur/mono16");b.exports=e,b.exports.lightness=d},{"glur/mono16":11}],6:[function(a,b,c){function d(a){var b=Math.round(a);return Math.abs(a-b)<f?b:Math.floor(a)}function e(a){var b=Math.round(a);return Math.abs(a-b)<f?b:Math.ceil(a)}var f=1e-5;b.exports.createRegions=function(a){var b,c,f,g,h,i,j,k=a.toWidth/a.width,l=a.toHeight/a.height,m=d(a.srcTileSize*k)-2*a.destTileBorder,n=d(a.srcTileSize*l)-2*a.destTileBorder,o=[];for(g=0;g<a.toHeight;g+=n)for(f=0;f<a.toWidth;f+=m)b=f-a.destTileBorder,b<0&&(b=0),h=f+m+a.destTileBorder-b,b+h>=a.toWidth&&(h=a.toWidth-b),c=g-a.destTileBorder,c<0&&(c=0),i=g+n+a.destTileBorder-c,c+i>=a.toHeight&&(i=a.toHeight-c),j={toX:b,toY:c,toWidth:h,toHeight:i,toInnerX:f,toInnerY:g,toInnerWidth:m,toInnerHeight:n,offsetX:b/k-d(b/k),offsetY:c/l-d(c/l),scaleX:k,scaleY:l,x:d(b/k),y:d(c/l),width:e(h/k),height:e(i/l)},o.push(j);return o},b.exports.eachLimit=function(a,b,c,d){function e(b){if(!h){if(b)return h=!0,void d(b);g++,g===a.length?d():f<a.length&&c(a[f++],e)}}0===a.length&&d();for(var f=0,g=0,h=!1;f<b&&f<a.length;)c(a[f++],e)}},{}],7:[function(a,b,c){b.exports=function(b){var c=a("./resize_array"),d=a("./unsharp");b.onmessage=function(a){var e=a.data;e.dest=new Uint8Array(e.toWidth*e.toHeight*4),c(e),e.unsharpAmount&&d(e.dest,e.toWidth,e.toHeight,e.unsharpAmount,e.unsharpRadius,e.unsharpThreshold),b.postMessage({output:e.dest},[e.dest.buffer])}}},{"./resize_array":4,"./unsharp":5}],8:[function(a,b,c){function d(a,b,c,d){var m=b.getContext("2d",{alpha:Boolean(c.alpha)}),n=j();n.width=Math.min(k,a.width),n.height=Math.min(k,a.height);var o=n.getContext("2d",{alpha:Boolean(c.alpha)});o.globalCompositeOperation="copy";var p=g({width:a.naturalWidth||a.width,height:a.naturalHeight||a.height,srcTileSize:k,toWidth:b.width,toHeight:b.height,destTileBorder:Math.ceil(Math.max(l,2.5*c.unsharpRadius|0))});return h(p,1,function(b,d){o.drawImage(a,b.x,b.y,b.width,b.height,0,0,b.width,b.height);var g=o.getImageData(0,0,b.width,b.height),h=m.createImageData(b.toWidth,b.toHeight),i={src:g.data,dest:h.data,width:b.width,height:b.height,toWidth:b.toWidth,toHeight:b.toHeight,scaleX:b.scaleX,scaleY:b.scaleY,offsetX:b.offsetX,offsetY:b.offsetY,quality:c.quality,alpha:c.alpha,unsharpAmount:c.unsharpAmount,unsharpRadius:c.unsharpRadius,unsharpThreshold:c.unsharpThreshold};e(i),c.unsharpAmount&&f(i.dest,i.toWidth,i.toHeight,i.unsharpAmount,i.unsharpRadius,i.unsharpThreshold),m.putImageData(h,b.toX,b.toY,b.toInnerX-b.toX,b.toInnerY-b.toY,b.toInnerWidth,b.toInnerHeight),d()},d),i()}var e=a("./js/resize_array"),f=a("./js/unsharp"),g=a("./js/utils").createRegions,h=a("./js/utils").eachLimit,i=a("./js/generate_id"),j=a("./js/create_canvas"),k=1024,l=3;b.exports=d,b.exports.terminate=function(){}},{"./js/create_canvas":1,"./js/generate_id":2,"./js/resize_array":4,"./js/unsharp":5,"./js/utils":6}],9:[function(a,b,c){function d(a,b,c,d){var e=b.getContext("2d",{alpha:Boolean(c.alpha)}),f=k();f.width=Math.min(m,a.naturalWidth||a.width),f.height=Math.min(m,a.naturalHeight||a.height);var g=f.getContext("2d",{alpha:Boolean(c.alpha)});g.globalCompositeOperation="copy";var l=h({width:a.naturalWidth||a.width,height:a.naturalHeight||a.height,srcTileSize:m,toWidth:b.width,toHeight:b.height,destTileBorder:Math.ceil(Math.max(n,2.5*c.unsharpRadius|0))}),p=1;"undefined"!=typeof navigator&&(p=navigator.hardwareConcurrency||1);var s=c._id||j();return r[s]=!0,i(l,p,function(b,d){g.drawImage(a,b.x,b.y,b.width,b.height,0,0,b.width,b.height);var f=g.getImageData(0,0,b.width,b.height),h={src:f.data,width:b.width,height:b.height,toWidth:b.toWidth,toHeight:b.toHeight,scaleX:b.scaleX,scaleY:b.scaleY,offsetX:b.offsetX,offsetY:b.offsetY,quality:c.quality,alpha:c.alpha,unsharpAmount:c.unsharpAmount,unsharpRadius:c.unsharpRadius,unsharpThreshold:c.unsharpThreshold},i=q.acquire();i.value.onmessage=function(a){var c,f,g,h,j;if(i.release(),!r[s])return void d(!0);if(a.data.err)return void d(a.data.err);if(g=e.createImageData(b.toWidth,b.toHeight),h=a.data.output,j=g.data,j.set)j.set(h);else for(c=0,f=h.length;c<f;c++)j[c]=h[c];o?e.putImageData(g,b.toX,b.toY,b.toInnerX-b.toX,b.toInnerY-b.toY,b.toInnerWidth+1e-5,b.toInnerHeight+1e-5):e.putImageData(g,b.toX,b.toY,b.toInnerX-b.toX,b.toInnerY-b.toY,b.toInnerWidth,b.toInnerHeight),d()},i.value.postMessage(h,[h.src.buffer])},function(a){r[s]&&(delete r[s],d(a))}),s}function e(a){r[a]&&delete r[a]}var f=a("webworkify"),g=a("./js/worker.js"),h=a("./js/utils").createRegions,i=a("./js/utils").eachLimit,j=a("./js/generate_id"),k=a("./js/create_canvas"),l=a("./js/pool"),m=1024,n=3,o=!1;try{o=-1!==navigator.userAgent.indexOf("Safari")}catch(p){}var q=new l(function(){return{value:f(g),destroy:function(){if(this.value.terminate(),"undefined"!=typeof window){var a=window.URL||window.webkitURL||window.mozURL||window.msURL;a&&a.revokeObjectURL&&this.value.objectURL&&a.revokeObjectURL(this.value.objectURL)}}}}),r={};b.exports=d,b.exports.terminate=e},{"./js/create_canvas":1,"./js/generate_id":2,"./js/pool":3,"./js/utils":6,"./js/worker.js":7,webworkify:13}],10:[function(a,b,c){function d(a){try{(window.console.error||window.console.log).call(window.console,a)}catch(b){}}function e(a){var b=a.getError();if(b!==a.NO_ERROR)throw new Error("gl error "+b)}function f(a){return a.getContext("webgl")||a.getContext("experimental-webgl")}function g(a,b,c){var e=a.createShader(b);return a.shaderSource(e,c),a.compileShader(e),a.getShaderParameter(e,a.COMPILE_STATUS)?e:(d("Shader compile error: "+a.getShaderInfoLog(e)+". Source: `"+c+"`"),a.deleteShader(e),null)}function h(a,b,c){var f=a.createProgram();return a.attachShader(f,b),a.attachShader(f,c),a.linkProgram(f),a.getProgramParameter(f,a.LINK_STATUS)||(d("Program linking error: "+a.getProgramInfoLog(f)),a.deleteProgram(f)),e(a),f}function i(a,b,c,d,f){var g=a.getAttribLocation(b,c);a.bindBuffer(a.ARRAY_BUFFER,a.createBuffer()),a.bufferData(a.ARRAY_BUFFER,new Float32Array(d),a.STATIC_DRAW),a.enableVertexAttribArray(g),a.vertexAttribPointer(g,f.elementSize,a.FLOAT,!1,0,0),e(a)}function j(a,b,c,d){var e=a.getUniformLocation(b,c);a.uniform1i(e,d)}function k(a,b,c,d,e){var f=a.getUniformLocation(b,c);a.uniform2f(f,d,e)}function l(a,b,c){var d=a.createTexture();return a.activeTexture(a.TEXTURE0+b),a.bindTexture(a.TEXTURE_2D,d),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST),a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,!0),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,c),e(a),d}function m(a,b,c,d){var f=a.createTexture();return a.activeTexture(a.TEXTURE0+b),a.bindTexture(a.TEXTURE_2D,f),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,c,d,0,a.RGBA,a.UNSIGNED_BYTE,null),e(a),f}function n(a,b,c,d){var f=m(a,b,c,d),g=a.getParameter(a.FRAMEBUFFER_BINDING),h=a.createFramebuffer();return a.bindFramebuffer(a.FRAMEBUFFER,h),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,f,0),e(a),{fbo:h,texture:f,oldFbo:g}}function o(a,b,c,d){var e=a,f=a+c,g=b,h=b+d;return[e,g,f,g,e,h,e,h,f,g,f,h]}function p(a){function b(a){return a.toFixed(20)}for(var c=v["#fsh-lanczos1d-optimized-tpl"],d=a.direction,e=a.texW/a.destW,f=a.texH/a.destH,g="horizontal"===d?e:f,h=w[3].filter,i=w[3].win,j="horizontal"===d,k=1/a.texW,l=1/a.texH,m=j?k:l,n=2*Math.ceil(i*g),o="float total = 0.0;\ngl_FragColor = vec4(0.0);\n",p=0;p<n+1;p++){var q=p-n/2,r=q/g,s=h(r),t=m*q,u=j?t:0,x=j?0:t;o+="addPoint(vec2("+b(u)+", "+b(x)+"), "+b(s)+", total);\n"}return o+="gl_FragColor /= vec4(total);",c.replace("__CODE__",o)}function q(a,b){return h(a,g(a,a.VERTEX_SHADER,v["#vsh-basic"]),g(a,a.FRAGMENT_SHADER,p(b)))}function r(a,b,c,d,f,g,h,l,m){var p={direction:g,texW:c,texH:d,destW:h,destH:l},r=q(a,p);a.useProgram(r),j(a,r,"u_image",b),k(a,r,"u_resolution",h,l),i(a,r,"a_texCoord",[0,0,1,0,0,1,0,1,1,0,1,1],{elementSize:2}),i(a,r,"a_position",m?o(0,l,h,-l):o(0,0,h,l),{elementSize:2}),a.viewport(0,0,h,l);var s=n(a,f,h,l);return a.viewport(0,0,h,l),a.drawArrays(a.TRIANGLES,0,6),a.bindFramebuffer(a.FRAMEBUFFER,s.oldFbo),e(a),s}function s(a,b,c){var d=a.naturalWidth||a.width,e=a.naturalHeight||a.height,f=b.canvas.width,g=b.canvas.height;l(b,0,a),r(b,0,d,e,1,"horizontal",f,e,!1);var h=r(b,1,f,e,2,"vertical",f,g,!0);b.flush();var i=b.createFramebuffer();b.bindFramebuffer(b.FRAMEBUFFER,i),b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,h.texture,0);var j=b.checkFramebufferStatus(b.FRAMEBUFFER);if(j!==b.FRAMEBUFFER_COMPLETE)throw new Error("Bad framebuffer status: "+j);c.alpha||(b.clearColor(1,1,1,1),b.colorMask(!1,!1,!1,!0),b.clear(b.COLOR_BUFFER_BIT));var k=new Uint8Array(f*g*4);b.readPixels(0,0,f,g,b.RGBA,b.UNSIGNED_BYTE,k);var m=void 0===c.unsharpAmount?0:0|c.unsharpAmount,n=void 0===c.unsharpRadius?0:c.unsharpRadius,o=void 0===c.unsharpThreshold?0:0|c.unsharpThreshold;return m&&t(k,f,g,m,n,o),k}var t=a("./js/unsharp"),u=a("./js/generate_id"),v={};v["#vsh-basic"]="precision highp float;\nattribute vec2 a_position;\nattribute vec2 a_texCoord;\n\nuniform vec2 u_resolution;\n\nvarying vec2 v_texCoord;\n\nvoid main() {\n   vec2 clipSpace = a_position / u_resolution * 2.0 - 1.0;\n\n   gl_Position = vec4(clipSpace, 0, 1);\n   v_texCoord = a_texCoord;\n}\n",v["#fsh-lanczos1d-optimized-tpl"]="precision highp float;\n\nvarying vec2 v_texCoord;\n\nuniform sampler2D u_image;\n\n#define addPoint(offset, kv, total)   {vec2 pos = v_texCoord + offset; gl_FragColor += texture2D(u_image, pos) * kv; total += kv; }\n\nvoid main()\n{\n__CODE__\n}\n";var w=[{win:.5,filter:function(a){return a>=-.5&&a<.5?1:0}},{win:1,filter:function(a){if(a<=-1||a>=1)return 0;if(a>-1.1920929e-7&&a<1.1920929e-7)return 1;var b=a*Math.PI;return Math.sin(b)/b*(.54+.46*Math.cos(b/1))}},{win:2,filter:function(a){if(a<=-2||a>=2)return 0;if(a>-1.1920929e-7&&a<1.1920929e-7)return 1;var b=a*Math.PI;return Math.sin(b)/b*Math.sin(b/2)/(b/2)}},{win:3,filter:function(a){if(a<=-3||a>=3)return 0;if(a>-1.1920929e-7&&a<1.1920929e-7)return 1;var b=a*Math.PI;return Math.sin(b)/b*Math.sin(b/3)/(b/3)}}];b.exports=function(a,b,c,e){var g,h;try{h=document.createElement("canvas"),h.id="pica-webgl-temporarry-canvas",h.height=b.height,h.width=b.width,document.body.appendChild(h),g=f(h);var i=s(a,g,c);g.finish(),document.body.removeChild(h);var j=b.getContext("2d"),k=j.createImageData(b.width,b.height);k.data.set(i),j.putImageData(k,0,0),e(null,i)}catch(l){d(l),
g.finish(),document.body.removeChild(h),e(l)}return u()},b.exports.terminate=function(){}},{"./js/generate_id":2,"./js/unsharp":5}],11:[function(a,b,c){function d(a){a<.5&&(a=.5);var b=Math.exp(.527076)/a,c=Math.exp(-b),d=Math.exp(-2*b),e=(1-c)*(1-c)/(1+2*b*c-d);return g=e,h=e*(b-1)*c,i=e*(b+1)*c,j=-e*d,k=2*c,l=-d,m=(g+h)/(1-k-l),n=(i+j)/(1-k-l),new Float32Array([g,h,i,j,k,l,m,n])}function e(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o,p,q,r,s,t;for(o=0;o<f;o++){for(l=o*e,m=o,n=0,g=a[l],k=g*d[6],j=k,q=d[0],r=d[1],s=d[4],t=d[5],p=0;p<e;p++)h=a[l],i=h*q+g*r+j*s+k*t,k=j,j=i,g=h,c[n]=j,n++,l++;for(l--,n--,m+=f*(e-1),g=a[l],k=g*d[7],j=k,h=g,q=d[2],r=d[3],p=e-1;p>=0;p--)i=h*q+g*r+j*s+k*t,k=j,j=i,g=h,h=a[l],b[m]=c[n]+j,l--,n--,m-=f}}function f(a,b,c,f){if(f){var g=new Uint16Array(a.length),h=new Float32Array(Math.max(b,c)),i=d(f);e(a,g,h,i,b,c,f),e(g,a,h,i,c,b,f)}}var g,h,i,j,k,l,m,n;b.exports=f},{}],12:[function(a,b,c){function d(a){if(null===a||void 0===a)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(a)}var e=Object.prototype.hasOwnProperty,f=Object.prototype.propertyIsEnumerable;b.exports=function(){try{if(!r.default)return!1;var a=new String("abc");if(a[5]="de","5"===(0,p.default)(a)[0])return!1;for(var b={},c=0;c<10;c++)b["_"+String.fromCharCode(c)]=c;if("0123456789"!==(0,p.default)(b).map(function(a){return b[a]}).join(""))return!1;var d={};return"abcdefghijklmnopqrst".split("").forEach(function(a){d[a]=a}),"abcdefghijklmnopqrst"===(0,n.default)((0,r.default)({},d)).join("")}catch(e){return!1}}()?r.default:function(a,b){for(var c,g,h=d(a),i=1;i<arguments.length;i++){c=Object(arguments[i]);for(var j in c)e.call(c,j)&&(h[j]=c[j]);if(l.default){g=(0,l.default)(c);for(var k=0;k<g.length;k++)f.call(c,g[k])&&(h[g[k]]=c[g[k]])}}return h}},{}],13:[function(a,b,c){var d=arguments[3],e=arguments[4],f=arguments[5],g=j.default;b.exports=function(a,b){function c(a){r[a]=!0;for(var b in e[a][1]){var d=e[a][1][b];r[d]||c(d)}}for(var h,i=(0,n.default)(f),j=0,k=i.length;j<k;j++){var l=i[j],m=f[l].exports;if(m===a||m&&m.default===a){h=l;break}}if(!h){h=Math.floor(Math.pow(16,8)*Math.random()).toString(16);for(var o={},j=0,k=i.length;j<k;j++){var l=i[j];o[l]=l}e[h]=[Function(["require","module","exports"],"("+a+")(self)"),o]}var p=Math.floor(Math.pow(16,8)*Math.random()).toString(16),q={};q[h]=h,e[p]=[Function(["require"],"var f = require("+g(h)+");(f.default ? f.default : f)(self);"),q];var r={};c(p);var s="("+d+")({"+(0,n.default)(r).map(function(a){return g(a)+":["+e[a][0]+","+g(e[a][1])+"]"}).join(",")+"},{},["+g(p)+"])",t=window.URL||window.webkitURL||window.mozURL||window.msURL,u=new Blob([s],{type:"text/javascript"});if(b&&b.bare)return u;var v=t.createObjectURL(u),w=new Worker(v);return w.objectURL=v,w}},{}],"/":[function(a,b,c){function d(a){return Object.prototype.toString.call(a)}function e(a){return"[object Function]"===d(a)}function f(a,b,d,g){if(e(d)&&(g=d,d={}),isNaN(d)||(d={quality:d,alpha:!1}),l||(c.WEBGL=!1),l&&c.WEBGL){c.debug("Resize canvas with WebGL");var h=o(a,b,d,function(e){e?(c.debug("WebGL resize failed, do fallback and cancel next attempts"),c.debug(e),l=!1,f(a,b,r({},d,{_id:h}),g)):g()});return h}return i||(c.WW=!1),i&&c.WW?(c.debug("Resize buffer in WebWorker"),n(a,b,d,g)):(c.debug("Resize buffer sync (freeze event loop)"),m(a,b,d,g))}function g(a,b){var c={src:a.src,dest:a.dest,width:0|a.width,height:0|a.height,toWidth:0|a.toWidth,toHeight:0|a.toHeight,quality:a.quality,alpha:a.alpha,unsharpAmount:a.unsharpAmount,unsharpRadius:a.unsharpRadius,unsharpThreshold:a.unsharpThreshold};c.dest=p(c),c.unsharpAmount&&q(c.dest,c.toWidth,c.toHeight,c.unsharpAmount,c.unsharpRadius,c.unsharpThreshold),b(null,c.dest)}function h(a){m.terminate(a),n.terminate(a),o.terminate(a)}var i="undefined"!=typeof window&&"Worker"in window;if(i)try{a("webworkify")(function(){}).terminate()}catch(j){i=!1}var k,l=!1;try{"undefined"!=typeof document&&"undefined"!=typeof window&&window.WebGLRenderingContext&&(k=document.createElement("canvas"),(k.getContext("webgl")||k.getContext("experimental-webgl"))&&(l=!0))}catch(j){}finally{k=null}var m=a("./lib/resize_js"),n=a("./lib/resize_js_ww"),o=a("./lib/resize_webgl"),p=a("./lib/js/resize_array"),q=a("./lib/js/unsharp"),r=a("object-assign");c.resizeCanvas=f,c.resizeBuffer=g,c.terminate=h,c.WW=i,c.WEBGL=!1,c.debug=function(){}},{"./lib/js/resize_array":4,"./lib/js/unsharp":5,"./lib/resize_js":8,"./lib/resize_js_ww":9,"./lib/resize_webgl":10,"object-assign":12,webworkify:13}]},{},[])("/")})},function(a,b,c){"use strict";(function(a){var b=c(4),d=function(a){return a&&a.__esModule?a:{"default":a}}(b);!function(){var b={};b.NONE="none",b.LEFT="left",b.TOP="top",b.RIGHT="right",b.BOTTOM="bottom",b.LEFT_TOP="left-top",b.LEFT_BOTTOM="left-bottom",b.RIGHT_TOP="right-top",b.RIGHT_BOTTOM="right-bottom",void 0!==(0,d.default)(a)&&void 0!==(0,d.default)(a.exports)?a.exports=b:usenamespace("editor.es5.consts").HitSide=b}()}).call(b,c(6)(a))},function(a,b,c){"use strict";function d(a){this._graphics=a}c(331);d.prototype.drawNode=function(a){var b=a.tagName,c=b.charAt(0).toUpperCase()+b.slice(1);this["draw"+c+"Node"]?this["draw"+c+"Node"](a):void 0},d.prototype.drawSvgNode=function(a){this.drawGNode(a)},d.prototype.drawGNode=function(a){for(var b,c=a.children||a.childNodes,d=0,e=c.length;d<e;d++)b=c[d],1===b.nodeType&&this.drawNode(b)},d.prototype.drawLineNode=function(a){this.applySvgAttributes(a);var b=parseFloat(a.getAttribute("x1")),c=parseFloat(a.getAttribute("y1")),d=parseFloat(a.getAttribute("x2")),e=parseFloat(a.getAttribute("y2"));this._graphics.moveTo(b,c),this._graphics.lineTo(d,e)},d.prototype.drawPolylineNode=function(a){this.applySvgAttributes(a);for(var b,c="(-?[\\d\\.?]+),(-?[\\d\\.?]+)",d=a.getAttribute("points").match(new RegExp(c,"g")),e=0,f=d.length;e<f;e++){b=d[e];var g=b.match(new RegExp(c));g[1]=parseFloat(g[1]),g[2]=parseFloat(g[2]),0===e?this._graphics.moveTo(g[1],g[2]):this._graphics.lineTo(g[1],g[2])}},d.prototype.drawCircleNode=function(a){this.applySvgAttributes(a);var b=parseFloat(a.getAttribute("cx"))||0,c=parseFloat(a.getAttribute("cy"))||0,d=parseFloat(a.getAttribute("r"))||100;this._graphics.drawCircle(b,c,d)},d.prototype.drawEllipseNode=function(a){this.applySvgAttributes(a);var b=parseFloat(a.getAttribute("cx")),c=parseFloat(a.getAttribute("cy")),d=parseFloat(a.getAttribute("rx")),e=parseFloat(a.getAttribute("ry"));this._graphics.drawEllipse(b,c,d,e)},d.prototype.drawRectNode=function(a){this.applySvgAttributes(a);var b=parseFloat(a.getAttribute("x"))||0,c=parseFloat(a.getAttribute("y"))||0,d=parseFloat(a.getAttribute("width"))||100,e=parseFloat(a.getAttribute("height"))||100,f=parseFloat(a.getAttribute("rx"))||0;parseFloat(a.getAttribute("ry"));isNaN(f)?this._graphics.drawRect(b,c,d,e):this._graphics.drawRoundedRect(b,c,d,e,f)},d.prototype.drawPolygonNode=function(a){for(var b,c="(-?[\\d\\.?]+),(-?[\\d\\.?]+)",d=a.getAttribute("points").match(new RegExp(c,"g")),e=[],f=0,g=d.length;f<g;f++){b=d[f];var h=b.match(new RegExp(c));h[1]=parseFloat(h[1]),h[2]=parseFloat(h[2]),e.push(new PIXI.Point(h[1],h[2]))}this.applySvgAttributes(a),this._graphics.drawPolygon(e)},d.prototype.drawPathNode=function(a){this.applySvgAttributes(a);for(var b,c,d,e,f,g,h=a.getAttribute("d").trim(),i=h.match(/[a-df-z][^a-df-z]*/gi),j={x:0,y:0},k=0,l=i.length;k<l;k++){b=i[k];var m=b[0],n=b.slice(1).trim().split(/[\s,]+|(?=\s?[+\-])/);for(d=0,e=n.length;d<e;d++)n[d]=parseFloat(n[d]);var o={x:0,y:0};switch(m===m.toLowerCase()&&(o=j),m){case"M":f=n[0],g=n[1],this._graphics.moveTo(f,g),j.x=f,j.y=g;break;case"m":f=n[0]+j.x,g=n[1]+j.y,this._graphics.moveTo(f,g),j.x=f,j.y=g;break;case"L":for(d=0,e=n.length;d<e;d+=2)f=n[d],g=n[d+1],this._graphics.lineTo(f,g),j.x=f,j.y=g;break;case"l":for(d=0,e=n.length;d<e;d+=2)f=j.x+n[d],g=j.y+n[d+1],this._graphics.lineTo(f,g),j.x=f,j.y=g;break;case"c":for(var p=0,q=n.length;p<q;p+=2)n[p]+=o.x,n[p+1]+=o.y;this._graphics.bezierCurveTo(n[0],n[1],n[2],n[3],n[4],n[5]),j={x:n[4],y:n[5]},c={x:n[2],y:n[3]};break;case"H":this._graphics.lineTo(n[0],j.y),j.x=n[0];break;case"h":f=j.y+n[0],this._graphics.lineTo(f,j.y),j.x=f;break;case"v":n[0]+=o.y,this._graphics.lineTo(j.x,n[0]),j.y=n[0];break;case"s":for(var r=0,s=n.length;r<s;r+=2)n[r]+=o.x,n[r+1]+=o.y;var t=2*j.x-c.x,u=2*j.y-c.y;this._graphics.bezierCurveTo(t,u,n[0],n[1],n[2],n[3]),j={x:n[2],y:n[3]},c={x:n[0],y:n[1]};break;case"Z":case"z":this._graphics.closePath();break;default:throw new Error("Could not handle path command: "+m+" "+n.join(","))}}},d.prototype.applySvgAttributes=function(a){return},d.drawSVG=function(a,b){for(var c=new d(a),e=b.children||b.childNodes,f=0,g=e.length;f<g;f++)1===e[f].nodeType&&c.drawNode(e[f])},a.exports=d},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(2),h=d(g),i=c(1),j=d(i),k=c(3),l=d(k),m=c(57),n=d(m),o=c(15),p=d(o),q=c(185),r=d(q),s=c(186),t=d(s),u=c(32),v=c(187),w=null,x=null,y={origin:{x:0,y:0},width:0,height:0,radian:0,center:{x:0,y:0}},z=function(a){function b(c){var d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.default.NONE;(0,f.default)(this,b);var g=(0,h.default)(this,a.call(this));return g.type=c,g.options=d,g.photoEditor=d.photoEditor,g.rotationControlType=e,g.rotationCursorList=d.rotationCursorList,g._cursorIndex=g.getCursorIndex(),g.currentRadian=0,g.currentRotation=0,g.drawAlpha=0,g.buttonMode=!0,g.interactive=!0,g.defaultCursor="inherit",g._isMouseDown=!1,g._localPoint=new PIXI.Point,g._pressedPos={x:0,y:0},g.initialize(),g.render(),g.addCursorEvent(),g.addMouseDownEvent(),g}return(0,l.default)(b,a),(0,j.default)(b,null,[{key:"DELETE",get:function(){return"delete"}},{key:"MOVE_START",get:function(){return"moveStart"}},{key:"MOVE",get:function(){return"move"}},{key:"MOVE_END",get:function(){return"moveEnd"}},{key:"ROTATE_START",get:function(){return"rotateStart"}},{key:"ROTATE",get:function(){return"rotate"}},{key:"ROTATE_END",get:function(){return"rotateEnd"}},{key:"CHANGE_ROTATION_CURSOR",get:function(){return"changeRotationCursor"}},{key:"DBCLICK",get:function(){return"dbClick"}},{key:"DBCLICK_TIME",get:function(){return 400}},{key:"mouseBoundary",get:function(){return w},set:function(a){w=a;var b=a.tl,c=a.tr,d=a.bl,e=a.br;x=[b.x,b.y,c.x,c.y,c.x,c.y,e.x,e.y,e.x,e.y,d.x,d.y,d.x,d.y,b.x,b.y]}},{key:"imageRect",get:function(){return y},set:function(a){y=a;var b=(0,u.rotate)(a.width>>1,a.height>>1,a.radian),c=y.center=y.center||{};c.x=a.origin.x+b.x,c.y=a.origin.y+b.y}}]),b.prototype.initialize=function(){this.g=this.graphics=new PIXI.Graphics,this.addChild(this.graphics)},b.prototype.render=function(){switch(this.type){case r.default.TOP_LEFT:case r.default.TOP_CENTER:case r.default.TOP_RIGHT:case r.default.MIDDLE_LEFT:case r.default.MIDDLE_RIGHT:case r.default.BOTTOM_LEFT:case r.default.BOTTOM_CENTER:case r.default.BOTTOM_RIGHT:case r.default.MIDDLE_CENTER:this.drawControl();break;case r.default.ROTATION:this.drawRotation();break;case r.default.DELETE:this.drawDeleteButton()}},b.prototype.drawControl=function(){this.g.clear(),this.g.beginFill(16724991,this.drawAlpha),this.g.drawRect(-5,-5,10,10),this.g.beginFill(16777215,1),this.g.drawRect(-2.5,-2.5,5,5),this.g.beginFill(0,1),this.g.drawRect(-1.5,-1.5,3,3),this.g.endFill()},b.prototype.drawCenter=function(a,b,c){var d=this.target.scale.x,e=this.target.scale.y;this.rotation=a,this.g.clear(),this.g.beginFill(16724991,this.drawAlpha),this.g.drawRect(-b/2*d,-c/2*e,b*d,c*e),this.g.endFill()},b.prototype.drawRotation=function(){this.g.clear(),this.g.beginFill(16724736,this.drawAlpha),this.g.drawRect(-11,-11,22,22),this.g.endFill()},b.prototype.drawDeleteButton=function(){this.deleteTexture=PIXI.Texture.fromImage("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABsAAAAbCAYAAACN1PRVAAAB2UlEQVRIie2VTUsqYRTHj2M4MhHUIKLDCC58QxHdulHEnWsXfYco0kUUVHKDXqgJLtw2fYC+haDixpUgA8KIgsj4Hm1qTCf03EW3W9xL40yCtPC/eRbnPOd3Dvyf8+gA4AYWpJU/5/0CWCZiAZC/WsKWsK/DotEoPZlMjg0Gg25WIURMzwXLZrMPLpfrajQaHVutVoMSiCTJk7lgAAD1ev05Fov9arVaB6FQaP1jLBKJ0IiYttlsF7Is49wwgNcJE4nEbaFQ2Ha73dQbKJfLbdM0fSqK4lhNHR287kZV64plWbLZbO47nc7LWq22ZzabzwaDwYuauwBgWpmd8y5RFMcEQfxAxHQymbzTAAIAjdYPh8MbiJj2+/3XHMdtqnGpZpjRaCTsdrsxn8/v+Hw+rlKpPAWDwZ/D4fDQ4/GsEoS6nvUAEAeAoVJSPB43F4vFXYvFct5oNEaICP1+X65Wq7VMJrPF83xVEIQnREVDUjMNQlEUIUnSEcMw551OR/43HggE1kqlUtLr9XKCICg1rfyfsSxLSpJ05HA4Lnu93n8gAIByufyo1+tPeJ7fTaVSTqV6mqyvJIZhyG63O55Op5+laLO+ktrt9syH/X22/hL2LWFvbjQtAvYb9NC0/9Sr3AYAAAAASUVORK5CYII="),this.deleteOverTexture=PIXI.Texture.fromImage("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABsAAAAbCAYAAACN1PRVAAABCElEQVRIie3UvWrDMBDA8VNtD8EfIojYwlPA0Rrw4HcIef9XyRAh9O/SlgaaWC4htGDBLcdJP4HupEQEedF6exW0Yiv2jzDnnIQQJMuy2YMgbVx5FMYYYozUdX23BiDLsofnfMRsAc45Yozs9/ub/OFwAEBrnQKlYSLCOI5479ntdjfQZrNJhdIxEUFrTYwRYwwAZVkugZZh39/odDot3rcIG4YBAGst1+s1tSmWYXmes91uAei6DqUU1lq897Rti1LqedjxeASgqqqb/DRNeO8ZxzEVfFxQFAXA3Tnr+54QwleX/hrTWgNgjJm9+eVy4Xw+P78bf4qmaWYvpD7FV6y/8+uv2Iq9A1yTczX16ka0AAAAAElFTkSuQmCC"),this.texture=this.deleteTexture},b.prototype.hideAllRotationCursor=function(){if(this.type===r.default.ROTATION)for(var a=this.rotationCursorList.length,b=0;b<a;b++)this.rotationCursorList[b].visible=!1},b.prototype.addCursorEvent=function(){this.mouseover=this.onMouseOver.bind(this),this.mouseout=this.onMouseOut.bind(this),this.mousemove=this.onMouseOverMove.bind(this)},b.prototype.addMouseDownEvent=function(){this._mouseDownListener=this.onMouseDown.bind(this),this.on("mousedown",this._mouseDownListener)},b.prototype.removeMouseDownEvent=function(){this.off("mousedown",this._mouseDownListener)},b.prototype.addMouseMoveEvent=function(){this._mouseMoveListener=this.onMouseMove.bind(this),this._mouseUpListener=this.onMouseUp.bind(this),window.document.addEventListener("mousemove",this._mouseMoveListener)},b.prototype.removeMouseMoveEvent=function(){window.document.removeEventListener("mousemove",this._mouseMoveListener),window.document.removeEventListener("mouseup",this._mouseUpListener)},b.prototype.onMouseDown=function(a){a.stopPropagation(),this._isMouseDown=!0,this._pressedPos.x=a.data.global.x,this._pressedPos.y=a.data.global.y;var c={x:a.data.global.x,y:a.data.global.y};this.prevMousePoint=this.currentMousePoint=c,this.targetPrevMousePoint=this.targetCurrentMousePoint=this.targetLayer.toLocal(c);var d=(new Date).getTime();if(this.startTime&&this.type==r.default.MIDDLE_CENTER&&this.downTarget&&this.downTarget==this.target&&d-this.startTime<b.DBCLICK_TIME)return this.emit(b.DBCLICK),this.startTime=null,void(this.downTarget=null);this.startTime=d,this.downTarget=this.target,this.type===r.default.ROTATION?(this.prevRotation=this.currentRotation=p.default.getRotation(this.centerPoint.globalPoint,{x:a.data.global.x,y:a.data.global.y}),this.prevRotation=this.currentRotation=this.getFlipRotation(this.currentRotation),this.currentRadian=p.default.toRadians(this.currentRotation),this.emit(b.ROTATE_START,{target:this,type:this.type,currentRadian:this.currentRadian,currentRotation:this.currentRotation,currentMousePoint:this.currentMousePoint})):this.emit(b.MOVE_START,{target:this,type:this.type,currentMousePoint:this.currentMousePoint,targetCurrentMousePoint:this.targetCurrentMousePoint}),this.addMouseMoveEvent(),window.document.addEventListener("mouseup",this._mouseUpListener),this.prevMousePoint=this.targetPrevMousePoint=null},b.prototype.getFlipRotation=function(a){if(this.photoEditor){var b=this.photoEditor.croppedScaleX,c=this.photoEditor.croppedScaleY;-1==b&&1==c?a*=-1:1==b&&-1==c&&(a*=-1)}return a},b.prototype.hitTest=function(a,c){return(0,u.hitTestWithBoundary)(a.x,a.y,b.imageRect)?(this._lastPoint=a,a):this._lastPoint||(0,v.getIntersectionWithlines)(c.x,c.y,a.x,a.y,x)||a},b.prototype.onMouseMove=function(a){var c=n.default.global;this.currentMousePoint=c,this.targetCurrentMousePoint=this.targetLayer.toLocal(c),this.prevMousePoint=this.prevMousePoint||this.currentMousePoint,this.targetPrevMousePoint=this.targetPrevMousePoint||this.targetCurrentMousePoint,this.targetCurrentMousePoint=this.hitTest(this.targetCurrentMousePoint,this._lastPoint||b.imageRect.center),this.changeMovement={x:this.currentMousePoint.x-this.prevMousePoint.x,y:this.currentMousePoint.y-this.prevMousePoint.y},this.targetChangeMovement={x:this.targetCurrentMousePoint.x-this.targetPrevMousePoint.x,y:this.targetCurrentMousePoint.y-this.targetPrevMousePoint.y},this.moveRotationCursor(),this.type===r.default.ROTATION?(this.currentRotation=p.default.getRotation(this.centerPoint.globalPoint,n.default.global),this.currentRotation=this.getFlipRotation(this.currentRotation),this.changeRotation=this.currentRotation-this.prevRotation,this.absChangeRotation=this.changeRotation<0?-1*this.changeRotation:this.changeRotation,this.absChangeRotation<100&&this.emit(b.ROTATE,{prevRotation:this.prevRotation,changeRotation:this.changeRotation,currentRotation:this.currentRotation,currentRadian:p.default.toRadians(this.currentRotation),changeRadian:p.default.toRadians(this.changeRotation)}),this.emit(b.CHANGE_ROTATION_CURSOR,this.getRotationCursor())):this.emit(b.MOVE,{target:this,type:this.type,prevMousePoint:this.prevMousePoint,changeMovement:this.changeMovement,currentMousePoint:this.currentMousePoint,targetPrevMousePoint:this.targetPrevMousePoint,targetChangeMovement:this.targetChangeMovement,targetCurrentMousePoint:this.targetCurrentMousePoint}),this.prevRotation=this.currentRotation,this.prevMousePoint=this.currentMousePoint,this.targetPrevMousePoint=this.targetCurrentMousePoint},b.prototype.onMouseUp=function(a){this._isMouseDown=!1;var c=n.default.global,d=this.currentMousePoint.x!=this._pressedPos.x&&this.currentMousePoint.y!=this._pressedPos.y;this.currentMousePoint=c,this.targetCurrentMousePoint=this.targetLayer.toLocal(c),this.prevMousePoint=this.prevMousePoint||this.currentMousePoint,this.targetPrevMousePoint=this.targetPrevMousePoint||this.targetCurrentMousePoint,this.changeMovement={x:this.currentMousePoint.x-this.prevMousePoint.x,y:this.currentMousePoint.y-this.prevMousePoint.y},this.targetChangeMovement={x:this.targetCurrentMousePoint.x-this.targetPrevMousePoint.x,y:this.targetCurrentMousePoint.y-this.targetPrevMousePoint.y},this.moveRotationCursor(),this.type===r.default.ROTATION?(this.currentRotation=p.default.getRotation(this.centerPoint.globalPoint,n.default.global),this.currentRotation=this.getFlipRotation(this.currentRotation),this.changeRotation=this.currentRotation-this.prevRotation,this.absChangeRotation=this.changeRotation<0?-1*this.changeRotation:this.changeRotation,this.absChangeRotation<100&&this.emit(b.ROTATE_END,{target:this,type:this.type,modified:d,prevRotation:this.prevRotation,changeRotation:this.changeRotation,currentRotation:this.currentRotation,currentRadian:p.default.toRadians(this.currentRotation),changeRadian:p.default.toRadians(this.changeRotation)})):this.emit(b.MOVE_END,{target:this,type:this.type,modified:d,prevMousePoint:this.prevMousePoint,changeMovement:this.changeMovement,currentMousePoint:this.currentMousePoint,targetPrevMousePoint:this.targetPrevMousePoint,targetChangeMovement:this.targetChangeMovement,targetCurrentMousePoint:this.targetCurrentMousePoint}),this.removeMouseMoveEvent()},b.prototype.onMouseOver=function(){this.defaultCursor=this.getCursor(),this.type===r.default.DELETE&&(this.texture=this.deleteOverTexture),this.type===r.default.ROTATION&&(this.rotationCursor=this.rotationCursorList[this.cursorIndex],this.moveRotationCursor(),this.rotationCursor.visible=!0)},b.prototype.onMouseOut=function(){this.type===r.default.DELETE&&(this.texture=this.deleteTexture),"none"!==n.default.defaultCursor&&(this.rotationCursor=null,this.hideAllRotationCursor())},b.prototype.onMouseOverMove=function(){this.type===r.default.ROTATION&&this.moveRotationCursor()},b.prototype.moveRotationCursor=function(){if(this.rotationCursor&&null!==this.rotationCursor){var a=this.rotationCursorList[this.cursorIndex];this.rotationCursor!==a&&(this.rotationCursor.visible=!1,this.rotationCursor=a,this.rotationCursor.visible=!0),this.rotationCursor.x=n.default.globalX,this.rotationCursor.y=n.default.globalY}},b.prototype.getAngleIndex=function(){var a=this.angle;return a>337.5&&a<=22.5?0:a>22.5&&a<=67.5?1:a>67.5&&a<=112.5?2:a>112.5&&a<=157.5?3:a>157.5&&a<=202.5?4:a>202.5&&a<=247.5?5:a>247.5&&a<=292.5?6:a>292.5&&a<=337.5?7:0},b.prototype.getCursor=function(){switch(this.type){case r.default.TOP_LEFT:case r.default.TOP_CENTER:case r.default.TOP_RIGHT:case r.default.MIDDLE_LEFT:case r.default.MIDDLE_RIGHT:case r.default.BOTTOM_LEFT:case r.default.BOTTOM_CENTER:case r.default.BOTTOM_RIGHT:return this.getScaleCursor();case r.default.ROTATION:return this.getRotationCursor();case r.default.DELETE:return"pointer";case r.default.MIDDLE_CENTER:return"move"}},b.prototype.getScaleCursor=function(){switch(this.cursorIndex){case 0:return"ns-resize";case 1:return"nesw-resize";case 2:return"ew-resize";case 3:return"nwse-resize";case 4:return"ns-resize";case 5:return"nesw-resize";case 6:return"ew-resize";case 7:return"nwse-resize"}},b.prototype.getRotationCursor=function(){return"none"},b.prototype.getFlipCursor=function(a){if(!this.photoEditor)return a;if(this.target.scale.x*this.target.scale.y*this.photoEditor.croppedScaleX*this.photoEditor.croppedScaleY<1)switch(a){case 0:return 0;case 1:return 7;case 2:return 6;case 3:return 5;case 4:return 4;case 5:return 3;case 6:return 2;case 7:return 1}return a},b.prototype.getCursorIndex=function(){if(this.type===r.default.ROTATION)return this.getRotationCursorIndex();var a=this.target?this.target.scaleSignX:1,b=this.target?this.target.scaleSignY:1;if(1===a&&1===b)switch(this.type){case r.default.TOP_CENTER:return 0;case r.default.TOP_RIGHT:return 1;case r.default.MIDDLE_RIGHT:return 2;case r.default.BOTTOM_RIGHT:return 3;case r.default.BOTTOM_CENTER:return 4;case r.default.BOTTOM_LEFT:return 5;case r.default.MIDDLE_LEFT:return 6;case r.default.TOP_LEFT:return 7}else if(-1===a&&1===b)switch(this.type){case r.default.TOP_CENTER:return 0;case r.default.TOP_RIGHT:return 7;case r.default.MIDDLE_RIGHT:return 6;case r.default.BOTTOM_RIGHT:return 5;case r.default.BOTTOM_CENTER:return 4;case r.default.BOTTOM_LEFT:return 3;case r.default.MIDDLE_LEFT:return 2;case r.default.TOP_LEFT:return 1}else if(1===a&&-1===b)switch(this.type){case r.default.TOP_CENTER:return 4;case r.default.TOP_RIGHT:return 3;case r.default.MIDDLE_RIGHT:return 2;case r.default.BOTTOM_RIGHT:return 1;case r.default.BOTTOM_CENTER:return 0;case r.default.BOTTOM_LEFT:return 7;case r.default.MIDDLE_LEFT:return 6;case r.default.TOP_LEFT:return 5}else if(-1===a&&-1===b)switch(this.type){case r.default.TOP_CENTER:return 4;case r.default.TOP_RIGHT:return 5;case r.default.MIDDLE_RIGHT:return 6;case r.default.BOTTOM_RIGHT:return 7;case r.default.BOTTOM_CENTER:return 0;case r.default.BOTTOM_LEFT:return 1;case r.default.MIDDLE_LEFT:return 2;case r.default.TOP_LEFT:return 3}else switch(this.type){case r.default.TOP_CENTER:return 0;case r.default.TOP_RIGHT:return 1;case r.default.MIDDLE_RIGHT:return 2;case r.default.BOTTOM_RIGHT:return 3;case r.default.BOTTOM_CENTER:return 4;case r.default.BOTTOM_LEFT:return 5;case r.default.MIDDLE_LEFT:return 6;case r.default.TOP_LEFT:return 7}},b.prototype.getRotationCursorIndex=function(){var a=this.target?this.target.scaleSignX:1,b=this.target?this.target.scaleSignY:1;if(1===a&&1===b)switch(this.rotationControlType){case t.default.TOP_CENTER:return 0;case t.default.TOP_RIGHT:return 1;case t.default.MIDDLE_RIGHT:return 2;case t.default.BOTTOM_RIGHT:return 3;case t.default.BOTTOM_CENTER:return 4;case t.default.BOTTOM_LEFT:return 5;case t.default.MIDDLE_LEFT:return 6;case t.default.TOP_LEFT:case t.default.DELETE:return 7}else if(-1===a&&1===b)switch(this.rotationControlType){case t.default.TOP_CENTER:return 0;case t.default.TOP_RIGHT:return 7;case t.default.MIDDLE_RIGHT:return 6;case t.default.BOTTOM_RIGHT:return 5;case t.default.BOTTOM_CENTER:return 4;case t.default.BOTTOM_LEFT:return 3;case t.default.MIDDLE_LEFT:return 2;case t.default.TOP_LEFT:case t.default.DELETE:return 1}else if(1===a&&-1===b)switch(this.rotationControlType){case t.default.TOP_CENTER:return 4;case t.default.TOP_RIGHT:return 3;case t.default.MIDDLE_RIGHT:return 2;case t.default.BOTTOM_RIGHT:return 1;case t.default.BOTTOM_CENTER:return 0;case t.default.BOTTOM_LEFT:return 7;case t.default.MIDDLE_LEFT:return 6;case t.default.TOP_LEFT:case t.default.DELETE:return 5}else if(-1===a&&-1===b)switch(this.rotationControlType){case t.default.TOP_CENTER:return 4;case t.default.TOP_RIGHT:return 5;case t.default.MIDDLE_RIGHT:return 6;case t.default.BOTTOM_RIGHT:return 7;case t.default.BOTTOM_CENTER:return 0;case t.default.BOTTOM_LEFT:return 1;case t.default.MIDDLE_LEFT:return 2;case t.default.TOP_LEFT:case t.default.DELETE:return 3}else switch(this.rotationControlType){case t.default.TOP_CENTER:return 0;case t.default.TOP_RIGHT:return 1;case t.default.MIDDLE_RIGHT:return 2;case t.default.BOTTOM_RIGHT:return 3;case t.default.BOTTOM_CENTER:return 4;case t.default.BOTTOM_LEFT:return 5;case t.default.MIDDLE_LEFT:return 6;case t.default.TOP_LEFT:case t.default.DELETE:return 7}},(0,j.default)(b,[{key:"target",set:function(a){this._target=a},get:function(){return this._target}},{key:"transform",set:function(a){this._transform=a},get:function(){return this._transform}},{key:"localPoint",set:function(a){this._localPoint=a},get:function(){return this._localPoint}},{key:"globalPoint",get:function(){return this.transform.apply(this._localPoint)}},{key:"centerPoint",set:function(a){this._centerPoint=a},get:function(){return this._centerPoint}},{key:"angle",get:function(){var a=this.target.worldTransform.clone(),b=p.default.getSkewX(a);return b=b<0?b+360:b}},{key:"cursorIndex",get:function(){return(this.getAngleIndex()+this.getFlipCursor(this.getCursorIndex()))%8}},{key:"targetLayer",set:function(a){this._targetLayer=a},get:function(){return this._targetLayer}},{key:"isMouseDown",get:function(){return this._isMouseDown}}]),b}(PIXI.Sprite);b.default=z},function(a,b,c){"use strict";a.exports=c(207)()?Object.setPrototypeOf:c(208)},function(a,b,c){"use strict";var d=Object.prototype.toString,e=d.call(function(){return arguments}());a.exports=function(a){return d.call(a)===e}},function(a,b,c){"use strict";var d=Object.prototype.toString,e=d.call("");a.exports=function(a){return"string"==typeof a||a&&"object"==typeof a&&(a instanceof String||d.call(a)===e)||!1}},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(1),h=d(g),i=c(2),j=d(i),k=c(3),l=d(k),m=c(36),n=d(m),o=c(7),p=(d(o),c(8)),q=d(p),r=c(5),s=d(r);q.default.SLIDE={SLIDE_AREA:".npe_slide_area",SLIDE_INPUT:".npe_slide",SLIDE_NUM:".npe_slide_number",SLIDE_THUMB:".npe_slide_background_thumb",SLIDE_TRACK:".npe_slide_background_track"};var t=function(a){function b(c,d){(0,f.default)(this,b);var e=(0,j.default)(this,a.call(this));return e._$wrapper=null,e._$target=null,e._options=null,e._disabled=!1,e._initialize(c,d),e}return(0,l.default)(b,a),b.prototype._initialize=function(a,b){this.setTarget(a,b)},b.prototype._setOptions=function(a){this._options=s.default.extend({base:0,min:0,max:100,baseData:0,minData:0,maxData:100,center:50},a),this._$target.prop("min",this._options.min),this._$target.prop("max",this._options.max)},b.prototype.setTarget=function(a,b){a&&(this._$target=a instanceof s.default?a:(0,s.default)(a),this._$wrapper=this._$target.closest(q.default.SLIDE.SLIDE_AREA),this._setOptions(b),this._render(),this.activate())},b.prototype.setValueByData=function(a){if(this._$target){var b=this._getValueFromData(a);this._$target.val(b),this._render()}},b.prototype.setValue=function(a){this._$target&&(this._$target.val(a),this._render())},b.prototype.getDataValue=function(){if(this._$target){var a=Number(this._$target.val());return this._getDataFromValue(a)}},b.prototype.getValue=function(){if(this._$target){return Number(this._$target.val())}},b.prototype._getDataFromValue=function(a){var b=this._options.baseData,c=void 0;return a<this._options.base?(c=(a-this._options.min)/(this._options.base-this._options.min),b=this._options.minData+(this._options.baseData-this._options.minData)*c):a>this._options.base&&(c=(a-this._options.base)/(this._options.max-this._options.base),b=this._options.baseData+(this._options.maxData-this._options.baseData)*c),b},b.prototype._getValueFromData=function(a){var b=this._options.base,c=void 0;return a=Number(a),a<this._options.baseData?(c=Math.abs(this._options.baseData-a)/Math.abs(this._options.baseData-this._options.minData),b=this._options.base-Math.abs(this._options.base-this._options.min)*c):a>this._options.baseData&&(c=Math.abs(a-this._options.baseData)/Math.abs(this._options.maxData-this._options.baseData),b=this._options.base+Math.abs(this._options.max-this._options.base)*c),b},b.prototype.activate=function(){this._$wrapper&&this._$wrapper.off("mousedown.Slider input.Slider change.Slider mouseup.Slider").on("mousedown.Slider input.Slider change.Slider mouseup.Slider",q.default.SLIDE.SLIDE_INPUT,this._onSlide.bind(this))},b.prototype.deactivate=function(){this._$wrapper&&this._$wrapper.off("mousedown.Slider input.Slider change.Slider mouseup.Slider"),this.removeAllListeners()},b.prototype._render=function(){var a=Number(this._$target.val()),b=(a-this._options.min)/(this._options.max-this._options.min)*100,c=this._options.center,d=b-c,e=c;b<=c&&(d*=-1,e=b),this._$wrapper.find(q.default.SLIDE.SLIDE_NUM).css("left",b+"%"),this._$wrapper.find(q.default.SLIDE.SLIDE_THUMB).css("left",b+"%"),c>0&&this._$wrapper.find(q.default.SLIDE.SLIDE_TRACK).css("left",e+"%"),this._$wrapper.find(q.default.SLIDE.SLIDE_TRACK).css("width",d+"%"),this._$wrapper.find(q.default.SLIDE.SLIDE_NUM).html(a)},b.prototype._onSlide=function(a){var b=a.type;if(!this._disabled){switch(b){case"mousedown":this.emit("slideStart",a);break;case"mouseup":this.emit("slideEnd",a);break;case"change":case"input":a.preventDefault(),a.dataValue=this.getDataValue(),a.value=this.getValue(),this.emit("slide",a)}this._render()}},b.prototype.show=function(){this._$wrapper.show()},b.prototype.hide=function(){this._$wrapper.hide()},(0,h.default)(b,[{key:"disabled",get:function(){return this._disabled},set:function(a){this._disabled=a,this._$wrapper.toggleClass(q.default.DISABLE_TOGGLE_CLASS,a)}}]),b}(n.default);b.default=t},function(a,b,c){var d=c(26),e=c(18).document,f=d(e)&&d(e.createElement);a.exports=function(a){return f?e.createElement(a):{}}},function(a,b,c){var d=c(26);a.exports=function(a,b){if(!d(a))return a;var c,e;if(b&&"function"==typeof(c=a.toString)&&!d(e=c.call(a)))return e;if("function"==typeof(c=a.valueOf)&&!d(e=c.call(a)))return e;if(!b&&"function"==typeof(c=a.toString)&&!d(e=c.call(a)))return e;throw TypeError("Can't convert object to primitive value")}},function(a,b){var c=Math.ceil,d=Math.floor;a.exports=function(a){return isNaN(a=+a)?0:(a>0?d:c)(a)}},function(a,b){a.exports=function(a){if(void 0==a)throw TypeError("Can't call method on  "+a);return a}},function(a,b,c){"use strict";var d=c(83),e=c(13),f=c(148),g=c(43),h=c(51),i=c(67),j=c(221),k=c(70),l=c(224),m=c(19)("iterator"),n=!([].keys&&"next"in[].keys()),o=function(){return this};a.exports=function(a,b,c,p,q,r,s){j(c,b,p);var t,u,v,w=function(a){if(!n&&a in A)return A[a];switch(a){case"keys":case"values":return function(){return new c(this,a)}}return function(){return new c(this,a)}},x=b+" Iterator",y="values"==q,z=!1,A=a.prototype,B=A[m]||A["@@iterator"]||q&&A[q],C=!n&&B||w(q),D=q?y?w("entries"):C:void 0,E="Array"==b?A.entries||B:B;if(E&&(v=l(E.call(new a)))!==Object.prototype&&v.next&&(k(v,x,!0),d||h(v,m)||g(v,m,o)),y&&B&&"values"!==B.name&&(z=!0,C=function(){return B.call(this)}),d&&!s||!n&&!z&&A[m]||g(A,m,C),i[b]=C,i[x]=o,q)if(t={values:y?C:w("values"),keys:r?C:w("keys"),entries:D},s)for(u in t)u in A||f(A,u,t[u]);else e(e.P+e.F*(n||z),b,t);return t}},function(a,b,c){var d=c(69);a.exports=Object("z").propertyIsEnumerable(0)?Object:function(a){
return"String"==d(a)?a.split(""):Object(a)}},function(a,b,c){var d=c(105),e=Math.min;a.exports=function(a){return a>0?e(d(a),9007199254740991):0}},function(a,b,c){var d=c(111)("keys"),e=c(85);a.exports=function(a){return d[a]||(d[a]=e(a))}},function(a,b,c){var d=c(18),e=d["__core-js_shared__"]||(d["__core-js_shared__"]={});a.exports=function(a){return e[a]||(e[a]={})}},function(a,b){a.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(a,b,c){b.f=c(19)},function(a,b,c){var d=c(85)("meta"),e=c(26),f=c(51),g=c(28).f,h=0,i=Object.isExtensible||function(){return!0},j=!c(50)(function(){return i(Object.preventExtensions({}))}),k=function(a){g(a,d,{value:{i:"O"+ ++h,w:{}}})},l=function(a,b){if(!e(a))return"symbol"==typeof a?a:("string"==typeof a?"S":"P")+a;if(!f(a,d)){if(!i(a))return"F";if(!b)return"E";k(a)}return a[d].i},m=function(a,b){if(!f(a,d)){if(!i(a))return!0;if(!b)return!1;k(a)}return a[d].w},n=function(a){return j&&o.NEED&&i(a)&&!f(a,d)&&k(a),a},o=a.exports={KEY:d,NEED:!1,fastKey:l,getWeak:m,onFreeze:n}},function(a,b,c){var d=c(18),e=c(9),f=c(83),g=c(113),h=c(28).f;a.exports=function(a){var b=e.Symbol||(e.Symbol=f?{}:d.Symbol||{});"_"==a.charAt(0)||a in b||h(b,a,{value:g.f(a)})}},function(a,b){b.f=Object.getOwnPropertySymbols},function(a,b){},function(a,b,c){var d=c(69),e=c(19)("toStringTag"),f="Arguments"==d(function(){return arguments}()),g=function(a,b){try{return a[b]}catch(c){}};a.exports=function(a){var b,c,h;return void 0===a?"Undefined":null===a?"Null":"string"==typeof(c=g(b=Object(a),e))?c:f?d(b):"Object"==(h=d(b))&&"function"==typeof b.callee?"Arguments":h}},function(a,b){a.exports=function(a,b,c,d){if(!(a instanceof b)||void 0!==d&&d in a)throw TypeError(c+": incorrect invocation!");return a}},function(a,b,c){var d,e,f,g=c(42),h=c(237),i=c(151),j=c(103),k=c(18),l=k.process,m=k.setImmediate,n=k.clearImmediate,o=k.MessageChannel,p=k.Dispatch,q=0,r={},s=function(){var a=+this;if(r.hasOwnProperty(a)){var b=r[a];delete r[a],b()}},t=function(a){s.call(a.data)};m&&n||(m=function(a){for(var b=[],c=1;arguments.length>c;)b.push(arguments[c++]);return r[++q]=function(){h("function"==typeof a?a:Function(a),b)},d(q),q},n=function(a){delete r[a]},"process"==c(69)(l)?d=function(a){l.nextTick(g(s,a,1))}:p&&p.now?d=function(a){p.now(g(s,a,1))}:o?(e=new o,f=e.port2,e.port1.onmessage=t,d=g(f.postMessage,f,1)):k.addEventListener&&"function"==typeof postMessage&&!k.importScripts?(d=function(a){k.postMessage(a+"","*")},k.addEventListener("message",t,!1)):d="onreadystatechange"in j("script")?function(a){i.appendChild(j("script")).onreadystatechange=function(){i.removeChild(this),s.call(a)}}:function(a){setTimeout(g(s,a,1),0)}),a.exports={set:m,clear:n}},function(a,b,c){"use strict";function d(a){var b,c;this.promise=new a(function(a,d){if(void 0!==b||void 0!==c)throw TypeError("Bad Promise constructor");b=a,c=d}),this.resolve=e(b),this.reject=e(c)}var e=c(65);a.exports.f=function(a){return new d(a)}},function(a,b,c){var d=c(43);a.exports=function(a,b,c){for(var e in b)c&&a[e]?a[e]=b[e]:d(a,e,b[e]);return a}},function(a,b,c){a.exports={"default":c(273),__esModule:!0}},function(a,b,c){"use strict";(function(a){function b(a){return a&&a.__esModule?a:{"default":a}}var d=c(4),e=b(d),f=c(38),g=b(f);!function(){function b(){f.call(this),this._brightness=0,this._contrast=1,this._saturation=1,this._hue=0,this._kelvin=0,this._needToUpdate=!0,this.rotateMat=new h}var d=c(39),f=c(280),h=c(125),i=new h,j=new h,k=new h,l=new Float32Array(16),m=j;if(m.setTo(1.5,0,0,0,0,1.5,0,0,0,0,.5,0),m=k,m.setTo(.5,0,0,0,0,.5,0,0,0,0,2,0),d.extend(f,b),(0,g.default)(b.prototype,{colorMatrix:{get:function(){if(this._needToUpdate){var a=this._contrast,b=.5*(1-a),c=a*this._brightness+b,d=this._saturation,e=.2125*(1-d),f=.7154*(1-d),g=.0721*(1-d),h=c*(e+f+g+d);if(this._colorMatrix.setTo(a*(e+d),a*f,a*g,h,a*e,a*(f+d),a*g,h,a*e,a*f,a*(g+d),h),0!=this._hue){var b=this._hue*Math.PI/180,l=Math.cos(b),m=Math.sin(b),n=i;n.m11=.213+.787*l+-.213*m,n.m12=.715+-.715*l+-.715*m,n.m13=.072+-.072*l+.928*m,n.m14=0,n.m21=.213+-.213*l+.143*m,n.m22=.715+.285*l+.14*m,n.m23=.072+-.072*l+-.283*m,n.m24=0,n.m31=.213+-.213*l+-.787*m,n.m32=.715+-.715*l+.715*m,n.m33=.072+.928*l+.072*m,n.m34=0,this._colorMatrix.append(n)}0!=this._kelvin&&(i.identity(),this._kelvin<0?i.interpolate(j,Math.abs(this._kelvin)):i.interpolate(k,this._kelvin),this._colorMatrix.append(i))}return this._needToUpdate=!1,this._colorMatrix}},colorMat4:{get:function(){var a=this.colorMatrix.raw;return l[0]=a[0],l[4]=a[3],l[8]=a[6],l[12]=a[9],l[1]=a[1],l[5]=a[4],l[9]=a[7],l[13]=a[10],l[2]=a[2],l[6]=a[5],l[10]=a[8],l[14]=a[11],l[3]=0,l[7]=0,l[11]=0,l[15]=1,l}},brightness:{get:function(){return this._brightness},set:function(a){this._brightness!=a&&(this._brightness=a,this._needToUpdate=!0)}},contrast:{get:function(){return this._contrast},set:function(a){this._contrast!=a&&(this._contrast=a,this._needToUpdate=!0)}},saturation:{get:function(){return this._saturation},set:function(a){this._saturation!=a&&(this._saturation=a,this._needToUpdate=!0)}},hue:{get:function(){return this._hue},set:function(a){this._hue!=a&&(this._hue=a,this._needToUpdate=!0)}},kelvin:{get:function(){return this._kelvin},set:function(a){this._kelvin!=a&&(this._kelvin=a,this._needToUpdate=!0)}},name:{get:function(){return"ColorTransformFilter"}}}),void 0!==(0,e.default)(a)&&void 0!==(0,e.default)(a.exports))a.exports=b;else{usenamespace("editor.filter").ColorTransformFilter=b}}()}).call(b,c(6)(a))},function(a,b,c){"use strict";(function(a){function b(a){return a&&a.__esModule?a:{"default":a}}var d=c(4),e=b(d),f=c(38),g=b(f);!function(){function b(a,b,c,d,e,f,g,h,i,j,k,l){this._raw=new Float32Array(12),this.setTo(a||1,b||0,c||0,d||0,e||0,f||1,g||0,h||0,i||0,j||0,k||1,l||0)}if(b.prototype={constructor:b,setTo:function(a,b,c,d,e,f,g,h,i,j,k,l){var m=this._raw;return m[0]=a,m[3]=b,m[6]=c,m[9]=d,m[1]=e,m[4]=f,m[7]=g,m[10]=h,m[2]=i,m[5]=j,m[8]=k,m[11]=l,this},identity:function(){var a=this._raw;return a[0]=1,a[3]=0,a[6]=0,a[9]=0,a[1]=0,a[4]=1,a[7]=0,a[10]=0,a[2]=0,a[5]=0,a[8]=1,a[11]=0,this},interpolate:function(a,b){var c=this._raw,d=a._raw;c[0]=c[0]+b*(d[0]-c[0]),c[1]=c[1]+b*(d[1]-c[1]),c[2]=c[2]+b*(d[2]-c[2]),c[3]=c[3]+b*(d[3]-c[3]),c[4]=c[4]+b*(d[4]-c[4]),c[5]=c[5]+b*(d[5]-c[5]),c[6]=c[6]+b*(d[6]-c[6]),c[7]=c[7]+b*(d[7]-c[7]),c[8]=c[8]+b*(d[8]-c[8]),c[9]=c[9]+b*(d[9]-c[9]),c[10]=c[10]+b*(d[10]-c[10]),c[11]=c[11]+b*(d[11]-c[11])},rotateRed:function(a){var b=this._raw,c=Math.cos(a),d=Math.sin(a);b[0]=0,b[3]=0,b[6]=0,b[9]=0,b[1]=0,b[4]=c,b[7]=-d,b[10]=0,b[2]=0,b[5]=d,b[8]=c,b[11]=0},rotateGreen:function(a){var b=this._raw,c=Math.cos(a),d=Math.sin(a);b[0]=c,b[3]=0,b[6]=-d,b[9]=0,b[1]=0,b[4]=0,b[7]=0,b[10]=0,b[2]=d,b[5]=0,b[8]=c,b[11]=0},rotateBlue:function(a){var b=this._raw,c=Math.cos(a),d=Math.sin(a);b[0]=c,b[3]=-d,b[6]=0,b[9]=0,b[1]=d,b[4]=c,b[7]=0,b[10]=0,b[2]=0,b[5]=0,b[8]=1,b[11]=0},transformColor:function(a,b,c,d){b=b||0,d=d||0,c=c||new Uint8ClampedArray(3);var e=a[b]/255,f=a[b+1]/255,g=a[b+2]/255,h=this._raw;return c[d]=255*(e*h[0]+f*h[3]+g*h[6]+h[9]),c[d+1]=255*(e*h[1]+f*h[4]+g*h[7]+h[10]),c[d+2]=255*(e*h[2]+f*h[5]+g*h[8]+h[11]),this},prepend:function(a){var b=a._raw,c=this._raw,d=b[0],e=b[3],f=b[6],g=b[9],h=b[1],i=b[4],j=b[7],k=b[10],l=b[2],m=b[5],n=b[8],o=b[11],p=c[0],q=c[3],r=c[6],s=c[9],t=c[1],u=c[4],v=c[7],w=c[10],x=c[2],y=c[5],z=c[8],A=c[11];return c[0]=d*p+e*t+f*x,c[3]=d*q+e*u+f*y,c[6]=d*r+e*v+f*z,c[9]=d*s+e*w+f*A+g,c[1]=h*p+i*t+j*x,c[4]=h*q+i*u+j*y,c[7]=h*r+i*v+j*z,c[10]=h*s+i*w+j*A+k,c[2]=l*p+m*t+n*x,c[5]=l*q+m*u+n*y,c[8]=l*r+m*v+n*z,c[11]=l*s+m*w+n*A+o,this},append:function(a){var b=a._raw,c=this._raw,d=c[0],e=c[3],f=c[6],g=c[9],h=c[1],i=c[4],j=c[7],k=c[10],l=c[2],m=c[5],n=c[8],o=c[11],p=b[0],q=b[3],r=b[6],s=b[9],t=b[1],u=b[4],v=b[7],w=b[10],x=b[2],y=b[5],z=b[8],A=b[11];return c[0]=d*p+e*t+f*x,c[3]=d*q+e*u+f*y,c[6]=d*r+e*v+f*z,c[9]=d*s+e*w+f*A+g,c[1]=h*p+i*t+j*x,c[4]=h*q+i*u+j*y,c[7]=h*r+i*v+j*z,c[10]=h*s+i*w+j*A+k,c[2]=l*p+m*t+n*x,c[5]=l*q+m*u+n*y,c[8]=l*r+m*v+n*z,c[11]=l*s+m*w+n*A+o,this},clone:function(){var a=this._raw;return new b(a[0],a[3],a[6],a[9],a[1],a[4],a[7],a[10],a[2],a[5],a[8],a[11])},toString:function(){for(var a="",b=0;b<3;b++)a+=this._raw[b]+"	"+this._raw[b+3]+"	"+this._raw[b+6]+"	"+this._raw[b+9]+"\n";return a}},(0,g.default)(b.prototype,{raw:{get:function(){return this._raw}},dirty:{get:function(){var a=this._raw;return 1!=a[0]||0!=a[3]||0!=a[6]||0!=a[9]||0!=a[1]||1!=a[4]||0!=a[7]||0!=a[10]||0!=a[2]||0!=a[5]||1!=a[8]||0!=a[11]}},m11:{get:function(){return this._raw[0]},set:function(a){this._raw[0]=a}},m12:{get:function(){return this._raw[3]},set:function(a){this._raw[3]=a}},m13:{get:function(){return this._raw[6]},set:function(a){this._raw[6]=a}},m14:{get:function(){return this._raw[9]},set:function(a){this._raw[9]=a}},m21:{get:function(){return this._raw[1]},set:function(a){this._raw[1]=a}},m22:{get:function(){return this._raw[4]},set:function(a){this._raw[4]=a}},m23:{get:function(){return this._raw[7]},set:function(a){this._raw[7]=a}},m24:{get:function(){return this._raw[10]},set:function(a){this._raw[10]=a}},m31:{get:function(){return this._raw[2]},set:function(a){this._raw[2]=a}},m32:{get:function(){return this._raw[5]},set:function(a){this._raw[5]=a}},m33:{get:function(){return this._raw[8]},set:function(a){this._raw[8]=a}},m34:{get:function(){return this._raw[11]},set:function(a){this._raw[11]=a}}}),void 0!==(0,e.default)(a)&&void 0!==(0,e.default)(a.exports))a.exports=b;else{usenamespace("editor.filter").ColorMatrix=b}}()}).call(b,c(6)(a))},function(a,b,c){a.exports={"default":c(284),__esModule:!0}},function(a,b,c){"use strict";b.__esModule=!0;b.DEPTH_BUFFER_BIT=256,b.STENCIL_BUFFER_BIT=1024,b.COLOR_BUFFER_BIT=16384,b.POINTS=0,b.LINES=1,b.LINE_LOOP=2,b.LINE_STRIP=3,b.TRIANGLES=4,b.TRIANGLE_STRIP=5,b.TRIANGLE_FAN=6,b.ZERO=0,b.ONE=1,b.SRC_COLOR=768,b.ONE_MINUS_SRC_COLOR=769,b.SRC_ALPHA=770,b.ONE_MINUS_SRC_ALPHA=771,b.DST_ALPHA=772,b.ONE_MINUS_DST_ALPHA=773,b.DST_COLOR=774,b.ONE_MINUS_DST_COLOR=775,b.SRC_ALPHA_SATURATE=776,b.FUNC_ADD=32774,b.BLEND_EQUATION=32777,b.BLEND_EQUATION_RGB=32777,b.BLEND_EQUATION_ALPHA=34877,b.FUNC_SUBTRACT=32778,b.FUNC_REVERSE_SUBTRACT=32779,b.BLEND_DST_RGB=32968,b.BLEND_SRC_RGB=32969,b.BLEND_DST_ALPHA=32970,b.BLEND_SRC_ALPHA=32971,b.CONSTANT_COLOR=32769,b.ONE_MINUS_CONSTANT_COLOR=32770,b.CONSTANT_ALPHA=32771,b.ONE_MINUS_CONSTANT_ALPHA=32772,b.BLEND_COLOR=32773,b.ARRAY_BUFFER=34962,b.ELEMENT_ARRAY_BUFFER=34963,b.ARRAY_BUFFER_BINDING=34964,b.ELEMENT_ARRAY_BUFFER_BINDING=34965,b.STREAM_DRAW=35040,b.STATIC_DRAW=35044,b.DYNAMIC_DRAW=35048,b.BUFFER_SIZE=34660,b.BUFFER_USAGE=34661,b.CURRENT_VERTEX_ATTRIB=34342,b.FRONT=1028,b.BACK=1029,b.FRONT_AND_BACK=1032,b.TEXTURE_2D=3553,b.CULL_FACE=2884,b.BLEND=3042,b.DITHER=3024,b.STENCIL_TEST=2960,b.DEPTH_TEST=2929,b.SCISSOR_TEST=3089,b.POLYGON_OFFSET_FILL=32823,b.SAMPLE_ALPHA_TO_COVERAGE=32926,b.SAMPLE_COVERAGE=32928,b.NO_ERROR=0,b.INVALID_ENUM=1280,b.INVALID_VALUE=1281,b.INVALID_OPERATION=1282,b.OUT_OF_MEMORY=1285,b.CW=2304,b.CCW=2305,b.LINE_WIDTH=2849,b.ALIASED_POINT_SIZE_RANGE=33901,b.ALIASED_LINE_WIDTH_RANGE=33902,b.CULL_FACE_MODE=2885,b.FRONT_FACE=2886,b.DEPTH_RANGE=2928,b.DEPTH_WRITEMASK=2930,b.DEPTH_CLEAR_VALUE=2931,b.DEPTH_FUNC=2932,b.STENCIL_CLEAR_VALUE=2961,b.STENCIL_FUNC=2962,b.STENCIL_FAIL=2964,b.STENCIL_PASS_DEPTH_FAIL=2965,b.STENCIL_PASS_DEPTH_PASS=2966,b.STENCIL_REF=2967,b.STENCIL_VALUE_MASK=2963,b.STENCIL_WRITEMASK=2968,b.STENCIL_BACK_FUNC=34816,b.STENCIL_BACK_FAIL=34817,b.STENCIL_BACK_PASS_DEPTH_FAIL=34818,b.STENCIL_BACK_PASS_DEPTH_PASS=34819,b.STENCIL_BACK_REF=36003,b.STENCIL_BACK_VALUE_MASK=36004,b.STENCIL_BACK_WRITEMASK=36005,b.VIEWPORT=2978,b.SCISSOR_BOX=3088,b.COLOR_CLEAR_VALUE=3106,b.COLOR_WRITEMASK=3107,b.UNPACK_ALIGNMENT=3317,b.PACK_ALIGNMENT=3333,b.MAX_TEXTURE_SIZE=3379,b.MAX_VIEWPORT_DIMS=3386,b.SUBPIXEL_BITS=3408,b.RED_BITS=3410,b.GREEN_BITS=3411,b.BLUE_BITS=3412,b.ALPHA_BITS=3413,b.DEPTH_BITS=3414,b.STENCIL_BITS=3415,b.POLYGON_OFFSET_UNITS=10752,b.POLYGON_OFFSET_FACTOR=32824,b.TEXTURE_BINDING_2D=32873,b.SAMPLE_BUFFERS=32936,b.SAMPLES=32937,b.SAMPLE_COVERAGE_VALUE=32938,b.SAMPLE_COVERAGE_INVERT=32939,b.COMPRESSED_TEXTURE_FORMATS=34467,b.DONT_CARE=4352,b.FASTEST=4353,b.NICEST=4354,b.GENERATE_MIPMAP_HINT=33170,b.BYTE=5120,b.UNSIGNED_BYTE=5121,b.SHORT=5122,b.UNSIGNED_SHORT=5123,b.INT=5124,b.UNSIGNED_INT=5125,b.FLOAT=5126,b.DEPTH_COMPONENT=6402,b.ALPHA=6406,b.RGB=6407,b.RGBA=6408,b.LUMINANCE=6409,b.LUMINANCE_ALPHA=6410,b.UNSIGNED_SHORT_4_4_4_4=32819,b.UNSIGNED_SHORT_5_5_5_1=32820,b.UNSIGNED_SHORT_5_6_5=33635,b.FRAGMENT_SHADER=35632,b.VERTEX_SHADER=35633,b.MAX_VERTEX_ATTRIBS=34921,b.MAX_VERTEX_UNIFORM_VECTORS=36347,b.MAX_VARYING_VECTORS=36348,b.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661,b.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660,b.MAX_TEXTURE_IMAGE_UNITS=34930,b.MAX_FRAGMENT_UNIFORM_VECTORS=36349,b.SHADER_TYPE=35663,b.DELETE_STATUS=35712,b.LINK_STATUS=35714,b.VALIDATE_STATUS=35715,b.ATTACHED_SHADERS=35717,b.ACTIVE_UNIFORMS=35718,b.ACTIVE_ATTRIBUTES=35721,b.SHADING_LANGUAGE_VERSION=35724,b.CURRENT_PROGRAM=35725,b.NEVER=512,b.LESS=513,b.EQUAL=514,b.LEQUAL=515,b.GREATER=516,b.NOTEQUAL=517,b.GEQUAL=518,b.ALWAYS=519,b.KEEP=7680,b.REPLACE=7681,b.INCR=7682,b.DECR=7683,b.INVERT=5386,b.INCR_WRAP=34055,b.DECR_WRAP=34056,b.VENDOR=7936,b.RENDERER=7937,b.VERSION=7938,b.NEAREST=9728,b.LINEAR=9729,b.NEAREST_MIPMAP_NEAREST=9984,b.LINEAR_MIPMAP_NEAREST=9985,b.NEAREST_MIPMAP_LINEAR=9986,b.LINEAR_MIPMAP_LINEAR=9987,b.TEXTURE_MAG_FILTER=10240,b.TEXTURE_MIN_FILTER=10241,b.TEXTURE_WRAP_S=10242,b.TEXTURE_WRAP_T=10243,b.TEXTURE=5890,b.TEXTURE_CUBE_MAP=34067,b.TEXTURE_BINDING_CUBE_MAP=34068,b.TEXTURE_CUBE_MAP_POSITIVE_X=34069,b.TEXTURE_CUBE_MAP_NEGATIVE_X=34070,b.TEXTURE_CUBE_MAP_POSITIVE_Y=34071,b.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,b.TEXTURE_CUBE_MAP_POSITIVE_Z=34073,b.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,b.MAX_CUBE_MAP_TEXTURE_SIZE=34076,b.TEXTURE0=33984,b.TEXTURE1=33985,b.TEXTURE2=33986,b.TEXTURE3=33987,b.TEXTURE4=33988,b.TEXTURE5=33989,b.TEXTURE6=33990,b.TEXTURE7=33991,b.TEXTURE8=33992,b.TEXTURE9=33993,b.TEXTURE10=33994,b.TEXTURE11=33995,b.TEXTURE12=33996,b.TEXTURE13=33997,b.TEXTURE14=33998,b.TEXTURE15=33999,b.TEXTURE16=34e3,b.TEXTURE17=34001,b.TEXTURE18=34002,b.TEXTURE19=34003,b.TEXTURE20=34004,b.TEXTURE21=34005,b.TEXTURE22=34006,b.TEXTURE23=34007,b.TEXTURE24=34008,b.TEXTURE25=34009,b.TEXTURE26=34010,b.TEXTURE27=34011,b.TEXTURE28=34012,b.TEXTURE29=34013,b.TEXTURE30=34014,b.TEXTURE31=34015,b.ACTIVE_TEXTURE=34016,b.REPEAT=10497,b.CLAMP_TO_EDGE=33071,b.MIRRORED_REPEAT=33648,b.FLOAT_VEC2=35664,b.FLOAT_VEC3=35665,b.FLOAT_VEC4=35666,b.INT_VEC2=35667,b.INT_VEC3=35668,b.INT_VEC4=35669,b.BOOL=35670,b.BOOL_VEC2=35671,b.BOOL_VEC3=35672,b.BOOL_VEC4=35673,b.FLOAT_MAT2=35674,b.FLOAT_MAT3=35675,b.FLOAT_MAT4=35676,b.SAMPLER_2D=35678,b.SAMPLER_CUBE=35680,b.VERTEX_ATTRIB_ARRAY_ENABLED=34338,b.VERTEX_ATTRIB_ARRAY_SIZE=34339,b.VERTEX_ATTRIB_ARRAY_STRIDE=34340,b.VERTEX_ATTRIB_ARRAY_TYPE=34341,b.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922,b.VERTEX_ATTRIB_ARRAY_POINTER=34373,b.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975,b.IMPLEMENTATION_COLOR_READ_TYPE=35738,b.IMPLEMENTATION_COLOR_READ_FORMAT=35739,b.COMPILE_STATUS=35713,b.LOW_FLOAT=36336,b.MEDIUM_FLOAT=36337,b.HIGH_FLOAT=36338,b.LOW_INT=36339,b.MEDIUM_INT=36340,b.HIGH_INT=36341,b.FRAMEBUFFER=36160,b.RENDERBUFFER=36161,b.RGBA4=32854,b.RGB5_A1=32855,b.RGB565=36194,b.DEPTH_COMPONENT16=33189,b.STENCIL_INDEX=6401,b.STENCIL_INDEX8=36168,b.DEPTH_STENCIL=34041,b.RENDERBUFFER_WIDTH=36162,b.RENDERBUFFER_HEIGHT=36163,b.RENDERBUFFER_INTERNAL_FORMAT=36164,b.RENDERBUFFER_RED_SIZE=36176,b.RENDERBUFFER_GREEN_SIZE=36177,b.RENDERBUFFER_BLUE_SIZE=36178,b.RENDERBUFFER_ALPHA_SIZE=36179,b.RENDERBUFFER_DEPTH_SIZE=36180,b.RENDERBUFFER_STENCIL_SIZE=36181,b.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048,b.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049,b.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050,b.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051,b.COLOR_ATTACHMENT0=36064,b.DEPTH_ATTACHMENT=36096,b.STENCIL_ATTACHMENT=36128,b.DEPTH_STENCIL_ATTACHMENT=33306,b.NONE=0,b.FRAMEBUFFER_COMPLETE=36053,b.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054,b.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055,b.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057,b.FRAMEBUFFER_UNSUPPORTED=36061,b.FRAMEBUFFER_BINDING=36006,b.RENDERBUFFER_BINDING=36007,b.MAX_RENDERBUFFER_SIZE=34024,b.INVALID_FRAMEBUFFER_OPERATION=1286,b.UNPACK_FLIP_Y_WEBGL=37440,b.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441,b.CONTEXT_LOST_WEBGL=37442,b.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443,b.BROWSER_DEFAULT_WEBGL=37444,b.drawingBufferWidth=300,b.drawingBufferHeight=150},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return new Float32Array([2/a,0,0,0,-2/b*c,0,-1,1*c,1])}b.__esModule=!0;var f=c(45),g=d(f),h=c(30),i=d(h),j=c(66),k=d(j),l=c(0),m=d(l),n=c(1),o=d(n),p=c(88),q=d(p);b.projection2d=e;var r=(0,q.default)("values"),s=(0,q.default)("matrix"),t=["x","y","scaleX","scaleY","pivotX","pivotY","rotation"],u=[0,1,3,4,6,7],v=function(){function a(){(0,m.default)(this,a),this[r]=new Float32Array(7),this[s]=new Float32Array(9),this[s][8]=1,this.changed=!0,this.scaleX=this.scaleY=1}return a.prototype[k.default]=i.default.mark(function b(){return i.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.delegateYield(this[r],"t0",1);case 1:case"end":return a.stop()}},b,this)}),a.prototype.entries=i.default.mark(function c(){var a,b,d,e,f;return i.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:a=t,b=Array.isArray(a),d=0,a=b?a:(0,g.default)(a);case 1:if(!b){c.next=7;break}if(!(d>=a.length)){c.next=4;break}return c.abrupt("break",16);case 4:e=a[d++],c.next=11;break;case 7:if(d=a.next(),!d.done){c.next=10;break}return c.abrupt("break",16);case 10:e=d.value;case 11:return f=e,c.next=14,[f,this[f]];case 14:c.next=1;break;case 16:case"end":return c.stop()}},c,this)}),a.prototype.keys=i.default.mark(function d(){return i.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.delegateYield(t,"t0",1);case 1:case"end":return a.stop()}},d,this)}),a.prototype.matrix2d=i.default.mark(function e(){var a,b,c,d,f,h;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=this.matrix,b=u,c=Array.isArray(b),d=0,b=c?b:(0,g.default)(b);case 2:if(!c){e.next=8;break}if(!(d>=b.length)){e.next=5;break}return e.abrupt("break",17);case 5:f=b[d++],e.next=12;break;case 8:if(d=b.next(),!d.done){e.next=11;break}return e.abrupt("break",17);case 11:f=d.value;case 12:return h=f,e.next=15,a[h];case 15:e.next=2;break;case 17:case"end":return e.stop()}},e,this)}),a.prototype.calcMatrix=function(){var a=void 0,b=void 0,c=void 0,d=void 0,e=void 0,f=void 0;if(this.rotation%2*Math.PI==0)a=this.scaleX,b=0,c=0,d=this.scaleY,e=this.x-a*this.pivotX,f=this.y-d*this.pivotY;else{var g=this.rotation,h=Math.cos(g),i=Math.sin(g);a=h*this.scaleX,b=i*this.scaleX,c=-i*this.scaleY,d=h*this.scaleY,e=this.x-a*this.pivotX-c*this.pivotY,f=this.y-b*this.pivotX-d*this.pivotY}var j=this[s];j[0]=a,j[3]=c,j[6]=e,j[1]=b,j[4]=d,j[7]=f,this.changed=!1},(0,o.default)(a,[{key:"matrix",get:function(){return this.changed&&this.calcMatrix(),this[s]}},{key:"x",get:function(){return this[r][0]},set:function(a){a!==this.x&&(this[r][0]=a,this.changed=!0)}},{key:"y",get:function(){return this[r][1]},set:function(a){a!==this.y&&(this[r][1]=a,this.changed=!0)}},{key:"scaleX",get:function(){return this[r][2]},set:function(a){a!==this.scaleX&&(this[r][2]=a,this.changed=!0)}},{key:"scaleY",get:function(){return this[r][3]},set:function(a){a!==this.scaleY&&(this[r][3]=a,this.changed=!0)}},{key:"pivotX",get:function(){return this[r][4]},set:function(a){a!==this.pivotX&&(this[r][4]=a,this.changed=!0)}},{key:"pivotY",get:function(){return this[r][5]},set:function(a){a!==this.pivotY&&(this[r][5]=a,this.changed=!0)}},{key:"rotation",get:function(){return this[r][6]},set:function(a){a!==this.rotation&&(this[r][6]=a,this.changed=!0)}}]),a}();b.default=v},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(1),h=d(g),i=c(2),j=d(i),k=c(3),l=d(k),m=c(127),n=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b.default=a,b}(m),o=(c(24),c(128)),p=c(40),q=d(p),r=c(60),s=d(r),t=new Float32Array([1,0,0,0,1,0,0,0,1]),u=function(a){function b(c,d){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},g=e.target,h=void 0===g?n.TEXTURE_2D:g,i=e.wrapS,k=void 0===i?n.CLAMP_TO_EDGE:i,l=e.wrapT,m=void 0===l?n.CLAMP_TO_EDGE:l,o=e.minFilter,p=void 0===o?n.NEAREST:o,q=e.magFilter,r=void 0===q?n.NEAREST:q,s=e.generateMipmap,t=void 0!==s&&s;(0,f.default)(this,b);var u=(0,j.default)(this,a.call(this,c));return u._program=d,u._frame=c.createFramebuffer(),u._param={target:h,wrapS:k,wrapT:m,minFilter:p,magFilter:r,generateMipmap:t},u}return(0,l.default)(b,a),b.prototype.initWithSize=function(a,b){return this.clear(),this._width=a,this._height=b,this._world=(0,o.projection2d)(a,b,-1),this},b.prototype.clear=function(){this.gl;this.frame&&(this.unbindColorAttachment(),this.unbind())},b.prototype.dispose=function(){var a=this.gl;this.clear(),a.deleteFramebuffer(this.frame),this._program=null,this._gl=null},b.prototype.bind=function(){(0,s.default)(this.frame,"WebGLFrameBuffer 객체를 찾을 수 없습니다.");var a=this.gl;a.bindFramebuffer(a.FRAMEBUFFER,this.frame)},b.prototype.unbind=function(){var a=this.gl;a.bindFramebuffer(a.FRAMEBUFFER,null)},b.prototype.bindColorAttachment=function(a){var b=this.gl;this.bind(),b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,a,0)},b.prototype.unbindColorAttachment=function(){var a=this.gl;this.bind(),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,null,0)},b.prototype.activeFrameBuffer=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,b=this.gl;b.bindFramebuffer(b.FRAMEBUFFER,this.frame),b.viewport(0,0,this.width,this.height),"function"==typeof a?(a(this.program),this.deactiveFrameBuffer()):a instanceof WebGLTexture&&(b.bindTexture(b.TEXTURE_2D,a),this.program.setUniformMat3("world",this.world),this.program.setUniformMat3("model",t))},b.prototype.deactiveFrameBuffer=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.gl.canvas.width,b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.gl.canvas.height,c=this.gl;c.bindFramebuffer(c.FRAMEBUFFER,null),c.viewport(0,0,a,b)},(0,h.default)(b,[{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}},{key:"world",get:function(){return this._world}},{key:"frame",get:function(){return this._frame}},{key:"program",get:function(){return this._program},set:function(a){this._program=a}}]),b}(q.default);b.default=u},function(a,b,c){"use strict";(function(a){function b(a){return a&&a.__esModule?a:{"default":a}}var d=c(4),e=b(d),f=c(38),g=b(f);!function(){function b(){this._enabled=!1}function d(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){this.rgbLeft=a||0,this.rgbCenter=b||1,this.rgbRight=c||255,this.rLeft=d||0,this.rCenter=e||1,this.rRight=f||255,this.gLeft=g||0,this.gCenter=h||1,this.gRight=i||255,this.bLeft=j||0,this.bCenter=k||1,this.bRight=l||255,this.rgbMax=m||255,this.rMax=o||255,this.gMax=q||255,this.bMax=s||255,this.rgbMin=n||0,this.rMin=p||0,this.gMin=r||0,this.bMin=t||0}function f(){}function h(){this.mean=0,this.stdDev=0,this.median=0,this.counts=null,this.graphHeights=null,this.total=0}var i=c(39),j=i.loop;if(b.prototype={constructor:b,applyFilter:function(a,b,c,e,g,h){if(!this._enabled)return!1;var i=new f;i.setSource(a);var j=this._getLeftRight(i.red.counts,i.red.total),k=this._getLeftRight(i.green.counts,i.green.total),l=this._getLeftRight(i.blue.counts,i.blue.total),m=new d;m.rLeft=j[0],m.rRight=j[1],m.gLeft=k[0],m.gRight=k[1],m.bLeft=l[0],m.bRight=l[1];for(var n,o,p,q=m.getTransArrays(),r=b.data,s=a.data,t=s.length,u=0;u<t;u+=4)n=s[u],o=s[u+1],p=s[u+2],r[u]=q[0][n],r[u+1]=q[1][o],r[u+2]=q[2][p],r[u+3]=s[u+3];return!0},applyFilterAsync:function(a,b,c,e,g,h,i,k){if(!this._enabled)return!1;var l=new f;l.setSource(a);var m=this._getLeftRight(l.red.counts,l.red.total),n=this._getLeftRight(l.green.counts,l.green.total),o=this._getLeftRight(l.blue.counts,l.blue.total),p=new d;p.rLeft=m[0],p.rRight=m[1],p.gLeft=n[0],p.gRight=n[1],p.bLeft=o[0],p.bRight=o[1];var q=p.getTransArrays(),r=b.data,s=a.data,t=s.length;return j(0,t,this.onFilterLoop,[q,r,s],this,i,k),!0},onFilterLoop:function(a,b,c,d,e){var f,g,h,j=c,k=d,l=e,m=a+4*i.MAXIMUM_PROCESS;for(m>b&&(m=b);a<m;a+=4)f=l[a],g=l[a+1],h=l[a+2],k[a]=j[0][f],k[a+1]=j[1][g],k[a+2]=j[2][h],k[a+3]=l[a+3];return a},_logValue:function(a){return a=1-a,a<=.001&&(a=.001),a>=.99&&(a=.99),Math.log(a)/Math.log(.5)},_getLeftRight:function(a,b){for(var c=0,d=0,e=0;e<a.length&&!((d+=a[e])/b>.002);e++)c=e;var f=255;for(d=0,e=a.length-1;e>=0&&!((d+=a[e])/b>.002);e--)f=e;return[c,f]}},(0,g.default)(b.prototype,{enabled:{get:function(){return this._enabled},set:function(a){this._enabled=Boolean(a)}},name:{get:function(){return"AutoAdjustment"}},changed:{get:function(){return this._enabled}}}),d.prototype={constructor:d,equals:function(a){return a.rgbLeft==this.rgbLeft&&a.rgbCenter==this.rgbCenter&&a.rgbRight==this.rgbRight&&a.rLeft==this.rLeft&&a.rCenter==this.rCenter&&a.rRight==this.rRight&&a.gLeft==this.gLeft&&a.gCenter==this.gCenter&&a.gRight==this.gRight&&a.bLeft==this.bLeft&&a.bCenter==this.bCenter&&a.bRight==this.bRight&&a.rgbMax==this.rgbMax&&a.rMax==this.rMax&&a.gMax==this.gMax&&a.bMax==this.bMax&&a.rgbMin==this.rgbMin&&a.rMin==this.rMin&&a.gMin==this.gMin&&a.bMin==this.bMin},getTransArrays:function(){for(var a,b,c,d=new Array(256),e=new Array(256),f=new Array(256),g=this.rgbRight-this.rgbLeft,h=this.rRight-this.rLeft,i=this.gRight-this.gLeft,j=this.bRight-this.bLeft,k=1/this.rgbCenter,l=1/this.rCenter,m=1/this.gCenter,n=1/this.bCenter,o=this.rgbMax,p=this.rMax,q=this.gMax,r=this.bMax,s=this.rgbMin,t=this.rMin,u=this.gMin,v=this.bMin,w=0;w<256;w++)a=w,b=w,c=w,a=a<=this.rLeft?t:a>=this.rRight?p:t+Math.round(Math.pow((a-this.rLeft)/h,l)*(p-t)),b=b<=this.gLeft?u:b>=this.gRight?q:u+Math.round(Math.pow((b-this.gLeft)/i,m)*(q-u)),c=c<=this.bLeft?v:c>=this.bRight?r:v+Math.round(Math.pow((c-this.bLeft)/j,n)*(r-v)),a=a<this.rgbLeft?s:a>this.rgbRight?o:s+Math.round(Math.pow((a-this.rgbLeft)/g,k)*(o-s)),b=b<this.rgbLeft?s:b>this.rgbRight?o:s+Math.round(Math.pow((b-this.rgbLeft)/g,k)*(o-s)),c=c<this.rgbLeft?s:c>this.rgbRight?o:s+Math.round(Math.pow((c-this.rgbLeft)/g,k)*(o-s)),d[w]=a,e[w]=b,f[w]=c;return[d,e,f]}},f.prototype={constructor:f,setSource:function(a){this.source=a;var b=Math.ceil(this.source.width*this.source.height/1e5);this.generate(b)},generate:function(a){if(this.source){this.pixels=this.source.width*this.source.height;var b,c=this.source.data,d=[],e=[],f=[],g=[],h=[];for(b=0;b<256;b++)d[b]=0,e[b]=0,f[b]=0,g[b]=0,h[b]=0;for(b=0;b<this.pixels/a;b++){var i=c[4*b*a],j=c[4*b*a+1],k=c[4*b*a+2],l=Math.round(.299*i+.587*j+.114*k);e[i]++,f[j]++,g[k]++,d[i]++,d[j]++,d[k]++,h[l]++}this.rgb=this.setChannelInfo(d),this.red=this.setChannelInfo(e),this.green=this.setChannelInfo(f),this.blue=this.setChannelInfo(g),this.luminosity=this.setChannelInfo(h)}},setChannelInfo:function(a){var b=new h;b.counts=a.slice();var c,d=0,e=0,f=Math.ceil(this.pixels/2);for(c=0;c<256;c++)d+=c*a[c],(e+=a[c])<f&&(b.median=c+1);b.mean=d/this.pixels;var g=0;for(c=0;c<256;c++)g+=a[c]*((c-b.mean)*(c-b.mean));b.stdDev=Math.sqrt(g/this.pixels);var i,j=0,k=0,l=0;for(c=0;c<256;c++)l+=a[c],a[c]>0&&k++,a[c]>j&&(j=a[c]);for(i=e/k,j=Math.min(4*i,j),b.graphHeights=[],c=0;c<256;c++){var m=Math.round(a[c]/j*100);m>100&&(m=100),a[c]>0&&m<1&&(m=1),b.graphHeights[c]=m}return b.total=l,b}},h.prototype={constructor:h},void 0!==(0,e.default)(a)&&void 0!==(0,e.default)(a.exports))a.exports.AutoAdjustment=b,a.exports.LevelInfo=d,a.exports.Histogram=f,a.exports.ChannelInfo=h;else{var k=usenamespace("editor.filter");k.AutoAdjustment=b,k.LevelInfo=d,k.Histogram=f,k.ChannelInfo=h}}()}).call(b,c(6)(a))},function(a,b,c){"use strict";function d(a){var b=(a.match(/[0-9a-fA-F]+/g)||[])[0];if(!b)return void void 0;for(var c=b.length/3|0,d=[],e=void 0,f=0;f<b.length;f+=c)e=b.slice(f,f+c),1==e.length&&(e+=e),d.push(Number("0x"+e));return d}function e(a){return"#"+(0,h.zfill)(a.toString(16),6,"0")}function f(a){for(var b=arguments.length,c=Array(b>1?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];var e=c.shift();return c.length<=0?a[e]:null===a[e]||void 0===a[e]?null:f.apply(void 0,[a[e]].concat(c))}function g(a){return"function"==typeof a.toDataURL}b.__esModule=!0,b.toHex=d,b.toHexString=e,b.retrieveValueIn=f,b.instanceofCanvas=g;var h=c(55)},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(1),h=d(g),i=c(2),j=d(i),k=c(3),l=d(k),m=c(54),n=d(m),o=c(25),p=d(o),q=c(33),r=function(a){function b(){(0,f.default)(this,b);var c=(0,j.default)(this,a.call(this));return c._transform=new p.default,c.identity(),c}return(0,l.default)(b,a),b.prototype.applyTransform=function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,d=this.getCanvasSize(a),e=d[0],f=d[1];return this._compare(a,e,f)&&!this.transform.modified?null:(b.width=e,b.height=f,(0,q.transformImage)(a,b.getContext("2d"),this.transform.matrix.raw),c&&c.matrix.preppend(this.transform.matrix),b)},b.prototype.identity=function(){this.transform.identity(),this.transform.canvasWidth=this.transform.canvasHeight=-1},b.prototype.getCanvasSize=function(a){var b=a.width||a.naturalWidth,c=a.height||a.naturalHeight,d=this.transform.canvasWidth<=0?b:this.transform.canvasWidth,e=this.transform.canvasHeight<=0?c:this.transform.canvasHeight;return this._compare(a,d,e)||d<=0||e<=0?[b,c]:[d,e]},b.prototype._compare=function(a,b,c){return(a.width||a.naturalWidth)==b&&(a.height||a.naturalHeight)==c},(0,h.default)(b,[{key:"transform",get:function(){return this._transform}}]),b}(n.default);b.default=r},function(a,b,c){"use strict";(function(a){var b=c(4),d=function(a){return a&&a.__esModule?a:{"default":a}}(b);!function(){var b={};b.Func=c(34);var e={};e.getRect=function(a,c,d){a=b.Func.getDefaultParameters(a,4),c=b.Func.getDefaultParameters(c,16724736),d=b.Func.getDefaultParameters(d,1);var e=a/2,f=new PIXI.Graphics;return f.beginFill(c,d),f.drawRect(-e,-e,a,a),f.endFill(),f},e.getCircle=function(a,c,d){a=b.Func.getDefaultParameters(a,2),c=b.Func.getDefaultParameters(c,16724736),d=b.Func.getDefaultParameters(d,1);var e=new PIXI.Graphics;return e.beginFill(c,d),e.drawRect(0,0,a),e.endFill(),e},e.drawBounds=function(a,c,d,e,f,g){d=b.Func.getDefaultParameters(d,!0),e=b.Func.getDefaultParameters(e,1),f=b.Func.getDefaultParameters(f,16724736),g=b.Func.getDefaultParameters(g,.7),d&&a.clear(),a.lineStyle(e,f,g),a.drawRect(c.x,c.y,c.width,c.height),a.endFill()},e.drawBox=function(a,c,d,e,f,g){d=b.Func.getDefaultParameters(d,!0),e=b.Func.getDefaultParameters(e,1),f=b.Func.getDefaultParameters(f,16724736),g=b.Func.getDefaultParameters(g,.5),d&&a.clear(),a.lineStyle(e,f,g),a.drawRect(c.left,c.top,c.right-c.left,c.bottom-c.top),a.endFill()},e.drawPoints=function(a,c,d,e,f,g){d=b.Func.getDefaultParameters(d,!0),e=b.Func.getDefaultParameters(e,1),f=b.Func.getDefaultParameters(f,16724736),g=b.Func.getDefaultParameters(g,.5),d&&a.clear();var h=c.lt,i=c.rt,j=c.rb,k=c.lb;a.lineStyle(e,f,g),a.moveTo(h.x,h.y),a.lineTo(i.x,i.y),a.lineTo(j.x,j.y),a.lineTo(k.x,k.y),a.lineTo(h.x,h.y),a.endFill()},e.drawCircle=function(a,c,d,e,f,g){null!==c&&(d=b.Func.getDefaultParameters(d,5),e=b.Func.getDefaultParameters(e,16724736),f=b.Func.getDefaultParameters(f,.5),g=b.Func.getDefaultParameters(g,!1),g&&a.clear(),a.lineStyle(1,0,f),a.beginFill(e,f),a.drawCircle(c.x,c.y,d),a.endFill())},e.drawGrid=function(a,b,c){for(var d=.5;d<b;d+=10)(d-.5)%50==0?a.lineStyle(1,10066329,.3):a.lineStyle(1,14540253,.1),
a.moveTo(d,0),a.lineTo(d,c);for(var e=.5;e<c;e+=10)(e-.5)%50==0?a.lineStyle(1,10066329,.3):a.lineStyle(1,14540253,.1),a.moveTo(0,e),a.lineTo(b,e);a.endFill()},e.drawDistToSegment=function(a,b,c,d,e){a.beginFill(52275,.2),a.lineStyle(1,39219,.1),a.moveTo(c.x,c.y),a.lineTo(d.x,d.y),a.drawCircle(c.x,c.y,3),a.drawCircle(d.x,d.y,3),a.beginFill(16764159,.2),a.lineStyle(1,13408716,.1),a.moveTo(b.x,b.y),a.lineTo(b.x,e.y),a.lineTo(e.x,e.y),a.drawCircle(b.x,b.y,3),a.drawCircle(e.x,e.y,3),a.endFill()},e.drawLine=function(a,c,d,e,f,g){e=b.Func.getDefaultParameters(e,1),f=b.Func.getDefaultParameters(f,16724736),g=b.Func.getDefaultParameters(g,1),a.lineStyle(e,f,g),a.moveTo(c.x,c.y),a.lineTo(d.x,d.y)},void 0!==(0,d.default)(a)&&void 0!==(0,d.default)(a.exports)?a.exports=e:usenamespace("editor.es5.utils").Painter=e}()}).call(b,c(6)(a))},function(a,b,c){"use strict";(function(a){function b(a){return a&&a.__esModule?a:{"default":a}}var d=c(4),e=b(d),f=c(38),g=b(f);!function(){function b(a,b){a=parseInt(a||512),b=parseInt(b||64),this._colorTable=null,this._table=null,this.interpolate=!1,this._init(a,b)}var d=c(39),f=d.loop;if(b.original=-1,b.prototype={constructor:b,_init:function(a,b){this._table=this._makeQuadIndexLookupTable(a,b),this._tableSize=a,this._quadSize=b,this._value=1},_makeQuadIndexLookupTable:function(a,b){for(var c=parseInt(a/b),d=new Uint32Array(c*c),e=d.length,f=4*b,g=b*f,h=0;h<e;h++)d[h]=g*(c*parseInt(h/c))+f*(h%c);return d},applyFilter:function(a,b,c,d,e,f){if(!this.interpolate)return this.applyFilterNoInterpolation(a,b,c,d,e,f);if(null==this._colorTable)return!1;c=parseInt(c||0),d=parseInt(d||0),e=parseInt(e||a.width),f=parseInt(f||a.height);for(var g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F=a.data,G=b.data,H=parseInt(F.length),I=parseInt(this._quadSize-1),J=parseInt(this._tableSize),K=parseInt(4*J),L=this._colorTable.data,M=this._table,N=0;N<H;N+=4)q=F[N]/4,j=0|q,n=q-j|0,q=F[N+1]/4,k=0|q,o=q-k|0,q=F[N+2]/4,l=0|q,p=q-l|0,m=l+1,m>I&&(m=0|I),l=M[l],m=M[m],A=l+4*(J*k+j)|0,D=!!(j+1>I),E=!!(k+1>I),B=D?0|A:A+4|0,C=E?0|A:A+K|0,D?0|C:C+4|0,g=L[A],h=L[A+1],i=L[A+2],r=g+n*(L[B]-g),s=h+n*(L[B+1]-h),t=i+n*(L[B+2]-i),g=L[C],h=L[C+1],i=L[C+2],u=g+n*(L[C]-g),v=h+n*(L[C+1]-h),w=i+n*(L[C+2]-i),x=r+o*(u-r),y=s+o*(v-s),z=t+o*(w-t),A=m+4*(J*k+j)|0,B=D?0|A:A+4|0,C=E?0|A:A+K|0,D?0|C:C+4|0,g=L[A],h=L[A+1],i=L[A+2],r=g+n*(L[B]-g),s=h+n*(L[B+1]-h),t=i+n*(L[B+2]-i),g=L[C],h=L[C+1],i=L[C+2],u=g+n*(L[C]-g),v=h+n*(L[C+1]-h),w=i+n*(L[C+2]-i),g=r+o*(u-r),h=s+o*(v-s),i=t+o*(w-t),g=x+p*(g-x),h=y+p*(h-y),i=z+p*(i-z),G[N]=0|g,G[N+1]=0|h,G[N+2]=0|i,G[N+3]=F[N+3];return!0},applyFilterAsync:function(a,b,c,d,e,g,h,i){if(null==this._colorTable||0==this.value)return!1;c=parseInt(c||0),d=parseInt(d||0),e=parseInt(e||a.width),g=parseInt(g||a.height);var j=a.data,k=b.data,l=parseInt(j.length),m=parseInt(this._quadSize-1),n=parseInt(this._tableSize),o=this._colorTable.data,p=this._table;return f(0,l,this.onFilterLoop,[j,k,m,n,o,p,this.value],this,h,i),!0},onFilterLoop:function(a,b,c,e,f,g,h,i,j){var k,l,m,n,o,p,q,r,s=c,t=e,u=a+4*d.MAXIMUM_PROCESS;for(u>b&&(u=b);a<u;a+=4)k=s[a],n=k/4|0,q=k%4,q>2&&n+1<=f&&++n,l=s[a+1],o=l/4|0,q=l%4,q>2&&o+1<=f&&++o,m=s[a+2],p=m/4|0,q=m%4,q>.5&&p+1<=f&&++p,r=i[p]+4*(g*o+n)|0,1==j?(t[a]=h[r],t[a+1]=h[r+1],t[a+2]=h[r+2]):(n=h[r],o=h[r+1],p=h[r+2],t[a]=k+j*(n-k),t[a+1]=l+j*(o-l),t[a+2]=m+j*(p-m)),t[a+3]=s[a+3];return a},applyFilterNoInterpolation:function(a,b,c,d,e,f){if(null==this._colorTable||0==this.value)return!1;c=parseInt(c||0),d=parseInt(d||0),e=parseInt(e||a.width),f=parseInt(f||a.height);for(var g,h,i,j,k,l,m,n,o=a.data,p=b.data,q=parseInt(o.length),r=parseInt(this._quadSize-1),s=parseInt(this._tableSize),t=this._colorTable.data,u=this._table,v=this.value,w=0;w<q;w+=4)g=o[w],j=g/4|0,m=g%4,m>2&&j+1<=r&&++j,h=o[w+1],k=h/4|0,m=h%4,m>2&&k+1<=r&&++k,i=o[w+2],l=i/4|0,m=i%4,m>.5&&l+1<=r&&++l,n=u[l]+4*(s*k+j)|0,1==v?(p[w]=t[n],p[w+1]=t[n+1],p[w+2]=t[n+2]):(j=t[n],k=t[n+1],l=t[n+2],p[w]=g+v*(j-g),p[w+1]=h+v*(k-h),p[w+2]=i+v*(l-i)),p[w+3]=o[w+3];return!0},getPixelOnColorTable:function(a){var b,c,d,e,f,g,h,i,j,k,l,m=this._quadSize-1,n=this._colorTable.data,o=this._table,p=[];return b=a[0],c=a[1],d=a[2],k=d/4,g=parseInt(k),k-g,j=g+1,j>m&&(j=m),k=b/4,e=parseInt(k),k-e,h=e+1,h>m&&(h=m),k=c/4,f=parseInt(k),k-f,i=f+1,i>m&&(i=m),l=o[g]+4*(this._tableSize*f+e),void 0,p[0]=n[l],p[1]=n[l+1],p[2]=n[l+2],p}},(0,g.default)(b.prototype,{colorTable:{get:function(){return this._colorTable},set:function(a){a!=this._colorTable&&(this._colorTable=a)}},value:{get:function(){return this._value},set:function(a){this._value=a}},name:{get:function(){return"FoodieFilter"}},changed:{get:function(){return null!=this._colorTable}}}),void 0!==(0,e.default)(a)&&void 0!==(0,e.default)(a.exports))a.exports=b;else{usenamespace("editor.filter").FoodieFilter=b}}()}).call(b,c(6)(a))},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(2),h=d(g),i=c(1),j=d(i),k=c(3),l=d(k),m=c(76),n=d(m),o=c(33),p=null,q=function(a){function b(){var c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4e3;(0,f.default)(this,b);var d=(0,h.default)(this,a.call(this));return d.canvasLimitSize=c,d.source=document.createElement("img"),d.source.crossOrigin=b.crossOrigin,d.source.onload=d.onSourceLoadComplete.bind(d),d._complete=!1,d}return(0,l.default)(b,a),(0,j.default)(b,null,[{key:"crossOrigin",get:function(){return p},set:function(a){p=a}}]),b.prototype.load=function(a){var c=(arguments.length>1&&void 0!==arguments[1]&&arguments[1],arguments.length>2&&void 0!==arguments[2]&&arguments[2],arguments.length>3&&void 0!==arguments[3]?arguments[3]:100),d=arguments.length>4&&void 0!==arguments[4]?arguments[4]:100;this._complete=!1,this.url=a,this.originW=c,this.originH=d,this.source.crossOrigin=b.crossOrigin,this.source.src=this.url},b.prototype.delete=function(){a.prototype.delete.call(this),this.source.onload=null},b.prototype.drawSvg=function(a,b,c,d){this.drawX=a,this.drawY=b,this.drawWidth=c,this.drawHeight=d;var e=c<0?-1:1,f=d<0?-1:1;this.scaleSignX=this.scaleSignX*e,this.scaleSignY=this.scaleSignY*f,c=Math.abs(c),d=Math.abs(d),c=c>this.canvasLimitSize?this.canvasLimitSize:c,d=d>this.canvasLimitSize?this.canvasLimitSize:d,this.resizeSource(c,d),this.onDrawComplete()},b.prototype.resizeSource=function(a,b){var c=this.canvgContext;c.canvas.width=0|a,c.canvas.height=0|b,(0,o.resizeImage)(this.source,c)},b.prototype.onSourceLoadComplete=function(a){if(this._complete=!0,this._restored)this.drawSvg(0,0,this.originW,this.originH),this.scaleSignX=this._restoreScaleSignX,this.scaleSignY=this._restoreScaleSignY;else{var b=this.originW/Math.max(this.sourceWidth,this.sourceHeight);this.drawSvg(0,0,b*this.sourceWidth|0,b*this.sourceHeight|0)}},(0,j.default)(b,[{key:"sourceWidth",get:function(){return this.source.complete?this.source.width||this.source.naturalWidth:0}},{key:"sourceHeight",get:function(){return this.source.complete?this.source.height||this.source.naturalHeight:0}},{key:"snapshot",get:function(){return{url:this.url,svg:this.svg,x:this.drawX,y:this.drawY,width:this.drawWidth,height:this.drawHeight,transform:{x:this.x,y:this.y,scaleX:this.scale.x,scaleY:this.scale.y,pivotX:this.pivot.x,pivotY:this.pivot.y,rotation:this.rotation,childIndex:this.parent.getChildIndex(this),childScaleX:this.image?this.image.scale.x:1,childScaleY:this.image?this.image.scale.y:1,originW:this.originW,originH:this.originH,scaleSignX:this.scaleSignX,scaleSignY:this.scaleSignY},pngSource:!0,stickerID:this.stickerID}}},{key:"complete",get:function(){return this._complete}}]),b}(n.default);b.default=q},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(30),f=d(e),g=c(45),h=d(g),i=c(66),j=d(i),k=c(0),l=d(k),m=c(1),n=d(m),o=c(88),p=d(o),q=(Math.PI,180/Math.PI),r=(0,p.default)("props"),s=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,l.default)(this,a),this[r]=new Float32Array(2),this.setTo(b,c)}return a.prototype[j.default]=function(){return(0,h.default)(this[r])},a.prototype.values=function(){return(0,h.default)(this)},a.prototype.keys=function(){return(0,h.default)("xy")},a.prototype.entries=f.default.mark(function b(){var a,c,d,e,g;return f.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:a="xy",c=Array.isArray(a),d=0,a=c?a:(0,h.default)(a);case 1:if(!c){b.next=7;break}if(!(d>=a.length)){b.next=4;break}return b.abrupt("break",16);case 4:e=a[d++],b.next=11;break;case 7:if(d=a.next(),!d.done){b.next=10;break}return b.abrupt("break",16);case 10:e=d.value;case 11:return g=e,b.next=14,[g,this[g]];case 14:b.next=1;break;case 16:case"end":return b.stop()}},b,this)}),a.prototype.setTo=function(a,b){this.x=a,this.y=b},a.prototype.dot=function(a){return this.x*a.x+this.y*a.y},a.prototype.len=function(a){return this.length=a,this},a.prototype.scale=function(a){return this.x*=a,this.y*=a,this},a.prototype.division=function(a){return this.x/=a,this.y/=a,this},a.prototype.add=function(a){return this.x+=a.x,this.y+=a.y,this},a.prototype.cross=function(a){return{x:0,y:0,z:this.x*a.y-this.x*a.x}},a.prototype.sub=function(a){return this.x-=a.x,this.y-=a.y,this},a.prototype.clone=function(){return new a(this.x,this.y)},a.prototype.normalize=function(){return this.x/=this.length,this.y/=this.length,this},(0,n.default)(a,[{key:"x",get:function(){return this._x},set:function(a){this._x!=a&&(this._x=a,this._invaildate=!0,this[r][0]=a)}},{key:"y",get:function(){return this._y},set:function(a){this._y!=a&&(this._y=a,this._invaildate=!0,this[r][1]=a)}},{key:"length",get:function(){if(this._invaildate){var a=this.x,b=this.y;this._length=Math.sqrt(a*a+b*b),this._invaildate=!1}return this._length},set:function(a){var b=this.length,c=a/b;this.scale(c)}},{key:"angle",get:function(){return this.rad*q}},{key:"rad",get:function(){return Math.atan2(this._y,this._x)}}]),a}();b.default=s},function(a,b,c){"use strict";(function(a){var b=c(4),d=function(a){return a&&a.__esModule?a:{"default":a}}(b);!function(){var b={left:10,top:5,right:10,bottom:5},c=function(a){this.limitWH=a||8e3};if(c.prototype={constructor:c,init:function(a){this.option=a,this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d")},clear:function(){this.option=this.canvas=this.ctx=null},findTextRect:function(a,b,c,d,e){a.width=b.width+2*d,a.height=b.height+2*d;var f,g,h,i,j,k=a.getContext("2d"),l=a.width,m=a.height;if(k.textBaseline="top",k.font=(c.italic?"Italic ":"")+(c.bold?"Bold ":"")+c.fontSize+"px "+c.font,k.fillText(c.text,d,d),f=k.getImageData(0,0,l,m).data,!e.l){if(0==(g=this.checkLimit(f,l,m,"left")))return this.findTextRect(a,b,c,d+10,e);e.l=g-d}if(!e.r){if((h=this.checkLimit(f,l,m,"right"))==l)return this.findTextRect(a,b,c,d+10,e);e.r=h-(b.width+d)}if(!e.t){if(0==(i=this.checkLimit(f,l,m,"top")))return this.findTextRect(a,b,c,d+10,e);e.t=i-d}if(!e.b){if((j=this.checkLimit(f,l,m,"bottom"))==m)return this.findTextRect(a,b,c,d+10,e);e.b=j-(b.height+d)}return e},checkLimit:function(a,b,c,d){var e,f,g;switch(d){case"left":for(e=0;e<b;e++){for(f=0;f<c;f++)if(a[4*(f*b+e)+3]>0){g=e-1;break}if(0==isNaN(g))break}break;case"right":for(e=b-1;e>=0;e--){for(f=0;f<c;f++)if(a[4*(f*b+e)+3]>0){g=e+1;break}if(0==isNaN(g))break}break;case"top":for(f=0;f<c;f++){for(e=0;e<b;e++)if(a[4*(f*b+e)+3]>0){g=f-1;break}if(0==isNaN(g))break}break;case"bottom":for(f=c-1;f>=0;f--){for(e=0;e<b;e++)if(a[4*(f*b+e)+3]>0){g=f+1;break}if(0==isNaN(g))break}}return g},drawSign:function(a){var c,e,f,g,h,i,j=this.option=a||a;return j.textPadding&&"object"===(0,d.default)(j.textPadding)||(j.textPadding=b),this.canvas=h=this.canvas||document.createElement("canvas"),this.ctx=i=this.ctx||this.canvas.getContext("2d"),""==j.text?(h.width=h.height=1,h.rect={l:0,t:0,r:0,b:0},h):(c=(j.italic?"Italic ":"")+(j.bold?"Bold ":"")+j.fontSize+"px "+j.font,i.save(),f=this.getTextHeight(j.font,j.text,j.fontSize,j.bold,j.italic,j.scale),g=this.findTextRect(h,f,j,10,{l:null,t:null,r:null,b:null}),i.textBaseline="top",i.font=c,e=f.width-g.l+g.r,i.restore(),h.width=e+j.textPadding.left+j.textPadding.right,h.height=f.height-g.t+g.b+j.textPadding.top+j.textPadding.bottom,i.save(),i.globalAlpha=j.bgAlpha,i.fillStyle=j.bgColor,i.fillRect(0,0,h.width,h.height),i.globalAlpha=j.textAlpha,i.fillStyle=j.textColor,i.textBaseline="top",i.font=(j.italic?"Italic ":"")+(j.bold?"Bold ":"")+j.fontSize+"px "+j.font,i.fillText(j.text,j.textPadding.left-g.l,j.textPadding.top-g.t),i.restore(),h.rect=g,h)},getTextHeight:function(a,b,c,d,e,f){var g=document.createElement("span");g.innerText=b,g.style.fontFamily=a,g.style.fontSize=c+"px",g.style.fontWeight=d?"bold":"normal",g.style.fontStyle=e?"italic":"normal",g.style.whiteSpace="pre";var h=document.createElement("div");h.setAttribute("style","display: inline-block; width: 1px; height: 0px;");var i=document.createElement("div");i.style.whiteSpace="pre",i.appendChild(g),i.appendChild(h),document.body.appendChild(i);try{var j={};h.style.verticalAlign="baseline",j.ascent=h.offsetTop-g.offsetTop,h.style.verticalAlign="bottom",j.height=h.offsetTop-g.offsetTop,j.width=g.offsetWidth,j.descent=j.height-j.ascent}finally{i.parentNode.removeChild(i)}return f||(f={x:1,y:1}),j.width*f.x>this.limitWH&&(j.width=this.limitWH/f.x),j.height*f.y>this.limitWH&&(j.height=this.limitWH/f.y),j}},void 0!==(0,d.default)(a)&&void 0!==(0,d.default)(a.exports))a.exports=c;else{usenamespace("editor.filter").SignText=c}}()}).call(b,c(6)(a))},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(1),h=d(g),i=c(2),j=d(i),k=c(3),l=d(k),m=c(340),n=d(m),o=c(25),p=d(o),q=c(54),r=d(q),s=c(95),t=d(s),u=document.createElement("canvas").getContext("2d"),v=function(a){function b(){(0,f.default)(this,b);var c=(0,j.default)(this,a.call(this));return c._init(),c}return(0,l.default)(b,a),b.prototype._init=function(){this._stroke=new n.default,this._transform=new p.default,this.identity()},b.prototype.applyTransform=function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!this.stroke.source)return null;this.stroke.update();var d=b.getContext("2d"),e=this.transform.matrix.raw;return b.width=this.stroke.maskWidth,b.height=this.stroke.maskHeight,d.setTransform(e[0],e[1],e[2],e[3],e[4],e[5]),d.drawImage(a,0,0),d.setTransform(1,0,0,1,0,0),c&&c.matrix.preppend(this.transform.matrix),b},b.prototype.applyFinalMask=function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this.modified){var c=u.canvas.width=a.canvas.width;u.canvas.height=a.canvas.height;this.applyMatrixTo(u,b),a.save(),this.stroke.thickness>0&&this.stroke.opacity>0&&(u.drawImage(this.stroke.strokeCanvas,0,0),a.drawImage(u.canvas,0,0),u.canvas.width=c,this.applyMatrixTo(u,b)),u.drawImage(this.stroke.innerStrokeClippingCanvas,0,0),a.globalCompositeOperation="destination-in",a.drawImage(u.canvas,0,0),a.restore()}},b.prototype.applyMatrixTo=function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;b&&a.setTransform(b[0],b[1],b[2],b[3],b[4],b[5])},b.prototype.drawCanvasTo=function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"source-over",d=b.canvas;if(a.width!=d.width||a.height!=d.height){var e=u.canvas;e.width=d.width,e.height=d.height,t.default.resizeCanvas(a,e,{alpha:!0},function(){}),a=e}b.globalCompositeOperation=c,b.drawImage(a,0,0)},b.prototype.identity=function(){this.stroke.initWithSVG(null,this._selector),this.transform.identity()},b.prototype.restore=function(a){this.stroke.thickness=a.thickness,this.stroke.opacity=a.opacity,this.stroke.colorHex=a.color,this.stroke.maskWidth=a.maskWidth,this.stroke.maskHeight=a.maskHeight,this.transform.restore(a.transform)},(0,h.default)(b,[{key:"snapshot",get:function(){return{thickness:this.stroke.thickness,opacity:this.stroke.opacity,color:this.stroke.colorHex,maskWidth:this.stroke.maskWidth,maskHeight:this.stroke.maskHeight,transform:this.transform.save()}}},{key:"modified",get:function(){return!!this.stroke.source}},{key:"stroke",get:function(){return this._stroke}},{key:"transform",get:function(){return this._transform}}]),b}(r.default);b.default=v},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(1),h=d(g),i=function(){function a(b,c,d,e){(0,f.default)(this,a),this.lt=b,this.rt=c,this.rb=d,this.lb=e,this.points=[this.lt,this.rt,this.rb,this.lb]}return a.prototype.rotate=function(a){for(var b=this.points,c=Math.cos(a),d=Math.sin(a),e=0;e<b.length;e++){var f=b[e],g=f.x,h=f.y;f.x=c*g-d*h,f.y=d*g+c*h}},(0,h.default)(a,[{key:"left",get:function(){for(var a=this.points,b=a[0],c=1;c<a.length;c++){var d=a[c];d.x<b.x&&(b=d)}return b.x}},{key:"right",get:function(){for(var a=this.points,b=a[0],c=1;c<a.length;c++){var d=a[c];d.x>b.x&&(b=d)}return b.x}},{key:"top",get:function(){for(var a=this.points,b=a[0],c=1;c<a.length;c++){var d=a[c];d.y<b.y&&(b=d)}return b.y}},{key:"bottom",get:function(){for(var a=this.points,b=a[0],c=1;c<a.length;c++){var d=a[c];d.y>b.y&&(b=d)}return b.y}},{key:"bounds",get:function(){return new PIXI.Rectangle(this.left,this.top,this.right-this.left,this.bottom-this.top)}},{key:"area",get:function(){var a=this.bounds;return a.width*a.height}}]),a}();b.default=i},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(2),h=d(g),i=c(1),j=d(i),k=c(3),l=d(k),m=c(57),n=d(m),o=c(15),p=d(o),q=c(78),r=d(q),s=c(343),t=d(s),u=c(141),v=d(u),w=c(195),x=d(w),y=c(142),z=(d(y),c(17)),A=c(196),B=d(A),C=c(79),D=d(C),E=c(143),F=d(E),G=c(10),H=c(32),I=c(80),J=(d(I),{tl:null,tr:null,tc:null,bl:null,br:null,bc:null,ml:null,mr:null,mc:null,rtl:null,rtc:null,rtr:null,rml:null,rmr:null,rbl:null,rbc:null,rbr:null}),K=function(a){function b(c,d){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{useSnap:!0,snapAngle:2,deleteButtonOffsetY:0,useDelete:!1};(0,f.default)(this,b);var g=(0,h.default)(this,a.call(this));return g.stageLayer=c,g.targetLayer=d,g.options=e,g.useSnap=e.useSnap||!0,g.snapAngle=e.snapAngle||2,g.deleteButtonOffsetY=e.deleteButtonOffsetY||0,g.useDelete=e.useDelete||!1,g.collision=null,g.initialize(),g.addEvent(),g}return(0,l.default)(b,a),(0,j.default)(b,null,[{key:"CHANGE",get:function(){return"change"}},{key:"DELETE",get:function(){return"delete"}},{key:"SELECT",get:function(){return"select"}},{key:"DESELECT",get:function(){return"deselect"}},{key:"SET_TARGET",get:function(){return"setTarget"}},{key:"RELEASE_TARGET",get:function(){return"releaseTarget"}},{key:"TRANSFORM_COMPLETE",get:function(){return"transformComplete"}},{key:"CONTROL_UP",get:function(){return"controlUp"}}]),b.prototype.initialize=function(){this.target=null,this.selectedControl=null,this.isLimit=!1,this.isNeedGridDisplay=!1,this.transform=new PIXI.Matrix,this.invertTransform=new PIXI.Matrix,this.g=this.graphics=new PIXI.Graphics,this.stageLayer.addChild(this.graphics),this.outSideLocalPoint=new PIXI.Point(-5e3,-5e3),this.rotationCursorList=[new PIXI.Sprite.fromImage("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAOCAYAAAA8E3wEAAAAAXNSR0IArs4c6QAAAyRJREFUOBGNVF1IU2EY9pz9z9YkRdaPIfhHiV4V3Sy80S4jijLqwvDGO/Uq6KLLqBtpN+G9SndJmSBZlDYbNjeGLWSW2CQxt0E65+bmfk7Pc/I7HRdELzx7v/d7f7/3fc+kiv8jSWemPyu6e/1Zd334qHemhrJwFDryctCWRNtyiHvyv0gflEohC0PKMmDQcZFcJCpBVwQEF/e40uLxjqQwmAggJ5PJ85AZnDACZsAK2IBKwK5DuWyBjvb0EzEY8xxkfR41IQ3MhULBt7y8fBHnI8BR4FhLS8uJ2dnZqxsbG4/hPJnNZkPAJ2BxZ2dnKhaLPfH7/bc7OztP0x5wACymErpr+Xz+Gc4mgDnUDjI7q7JDGUqn03PT09OXqqurTwaDwTu7u7tvw+Hw68HBwZnW1tavJpMpB1vFaDTmUcxqb2/vnM/newW/D5FIZKC9vf0U9LVLS0s39/b2/Llc7jlkdog5JDEjCpb9/X1vV1eXPDExkYbhWiKRqO3p6XEFAoEzkiQpCPYFSLhcrlw8HjejG1ULCwtni8Wiob6+/vvo6Gikra0tH41G39TV1V3v6+uTR0ZG4na7/Rbis9ACoPaXvXciySK40tHR8dnj8bwzGAwFh8ORHBoamkqlUu/R8nHYPALuAQ8hP81kMnNjY2OTNTU1Cfr29/d7Nzc3PzY1Na01NzdH0aFJ3LPNbKvWUias4mzAxZYpbrc7vLW15UWyBysrK43QcQ4cgQa85jiS3gW83d3d8/Q3m81q23UJuQ9qQjqSmKTEtqnSwY/NZitYLJYKVPyysbExSpsyKGhlDC3zYF7jw8PDRXQkhdHwASTlICb9tNh8prY0BwrtlZhpAAFmtre3ud5qS8D1JGNhrmBjZxoaGr5Bofnihavo2gvccWnULWUAgi81YPjzoVDoh6IoamBWhzmWEKgSlbPqAdwFwTWC7WUI97FEP9fX1/P0Ff7wkeCbxWbfgA3/HNTAomoZs3KjIhmJ1TskU6xWawmfAD8DIqNPiMCs+gKWxwBIhN4f4yjJspx2Op0sUn25SFbOoT9ENCYJ/lv68/svf72P8gunF5KUe/EFxQAAAABJRU5ErkJggg=="),new PIXI.Sprite.fromImage("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAZCAYAAADE6YVjAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyppVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTMyIDc5LjE1OTI4NCwgMjAxNi8wNC8xOS0xMzoxMzo0MCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUuNSAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo1Rjc3NTE3RDZEQTcxMUU2OTkwNzk1ODBGOTZCN0JBOSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo1Rjc3NTE3RTZEQTcxMUU2OTkwNzk1ODBGOTZCN0JBOSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjVGNzc1MTdCNkRBNzExRTY5OTA3OTU4MEY5NkI3QkE5IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjVGNzc1MTdDNkRBNzExRTY5OTA3OTU4MEY5NkI3QkE5Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+bXt2owAAA1tJREFUeNqsVt1LWmEY99XjR7ZNZ8yGC0YrG2ODddXNBjXGrlpjH25rhKj76Cbovqv9A4PddN9N7kLYYNiFoMyltmBusUqIIHJCzTJD0yzNr/1e9xrH0wfH2gsPnvfjPL/3eZ7f7zkSycFBJIePsuSEQ3oIAGHr0kKh8Ix3hkj+w6g652DKTCbzulQq+fEsh8lOAyIVRECdyTc2Nmy5XM5cLBbpvoKtS5mRegGlghTJV1dXX+bz+RddXV2XkS66pmJA1YhkvHdIvZHI1tfXLYSQp52dndfw3IR0Kbxe752RkRED9ht4gJwATFQtuGQyORiNRr16vT5GmaRQKHJjY2OeQCDgTqVS37HvmJ2d7W9vb7+A/XMMVM7LxvEgqMFV5P9nT0/PL0bVGuM4Lt/b2/tjfn6eAjodDsdtrJ+HNYoFqqQqHo8/3tra8uGmv6ljjUaTDIfDkx6Px2Wz2fxqtXqbrpvN5m+IanpmZsaMeZNYoP2iI12mRCLhp0BarTYBhk0vLS09B51H0+m0b3h4+AsFovubm5tTDEgHU7M6ETEaUaDgT2hEYFcILPOz3Csikcj1vb09u9vtnkC9shQI56bHx8dvYV9DtSVGT/sRIe8Pd3d3fWDXJLthRSNOp1MNoPcul2uCRmS1WgM4+7m1tbWZpY0TRQLmUJbNZh+Uy2WvQEuEAX0YGhqie+VQKOQJBoP9eNayaKRiKV0xgNwVaKFyibW1tRuIwKdSqTJ9fX1BSm9GgobTtqAaNiLSUYvF4qP0pjoCKYxYPyNgGpGIDe2QzwAB4yYHBgbSaD0c9JM0mUw3GQDH63WVs5xY70gdvaWJNk2wjsD5pY6ODtpiJKA5uYeB34vQUwFWVCqVJUjgE6SQFA2CnrYNoLhMJnuLQkfn5uY40L0Smd1u1+/s7EgxrhiNxkJ3d3cz2PkOAKnqDY81IRZlHYT5ta2tLSxsPy0tLX9isZh/ZWXFyprpPxLUC0JfRFd4RAULoEgVwGAwRMG6qcXFxTeYn2XdWnpSkIpgaWeotiAaAeaBhYWFQaYXVQ2V6wSpaUG019GI0MV9y8vLr1h7UfG6RAWEHOGIX/DjBEtTdx8+GnU63UfMi8z4tToxiETwCSZCx/y/UNwplF8+4v/YgVv/FWAAZA0E5twGSyUAAAAASUVORK5CYII="),new PIXI.Sprite.fromImage("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAcCAYAAABRVo5BAAAAAXNSR0IArs4c6QAAAztJREFUOBF9VN9rUnEU915NS5BV2JRqa7CYkOAeEgqmSTF7jC2IPfU22Nvajzehl6CHHmR/xN6FbCP6icsZgYrDLXFzNFcgONlQNyf+urfP+d77vdwN6sC53+/3nPM53/PrewWDQoK60qLf01mmj0ra3gQBNxTVPZ25jOwlMAE4iK0EJCKQEUxnYjoT9VTuqisHMyPh+PjYZ7ValyRJEsCiLMsCiD6cm41GY76vry9J3kDMgVipVB6mUqlVVUBCxoFAIAvA+vb2th+yC2AeibLp9XoC3QKFRgD9jEajjUQi8crlcm1oCnXDczwvN0xOTlZarVZ5YmJiC0p9wWgvs6uNRiPLhdDBYHDD5/NtLS4u+pFCfzwefwwxXUDFOxOViOIEMpnMO4BSp6en8aOjo3WbzVbzer25k5OTLwj1OkA28Jk8hWaz+aBer39tt9uxQqFwH45eh8Ph9zCUNzc3P62trT3F/gr4Ili7Weh0On4UZ71arXqhMO3u7t4G+BvaIc3NzcVKpdIS5NfAVtKDlZABukusCkho7Ha7kdHR0bzb7S7UarUVyBxgHq7AigPPaWIotB6iRQWPx1PZ2dkZtFgsN6AjhxprDYXwPNWcTmcLaZih4HkpIULwP6Dt4ODAbDKZaE7ZiOlWBYj8yCMnFg56ewujdnl4ePgPql2CUv9KlAGA8B7AT7BSBEKxWOyH8WAymbwzNjZWQrt+qUAOVgxRQbrxJQaawCa73f48EolUUSDj9PR0Y39//zvk/InxsA1sAMrl8gcMQezw8HCepgfgytDQ0G84S4yPjw8CSK2gQml1YSOXTqdXkM8exi0xNTX1AwYyJuZjPp9/gf1V8CUwry628KB/j5jROmTy7OxsHJO0il7exFl/G2sJu1b/HjFqNjS8HQqFzCjS52w22waQisILw3LU4oVCI7xDMx6yY2Bg4Fkul3sEhVYQbsQeMm6QEKIwMjKyBwXrI9pjmJmZEZeXlxdQuI7D4Xir6pgTZoQh9uJnFULIIjFASh6iKGEQJFEUe6j0G/ysUurtzICBIaCK8ZdOKZBnYuofjZ0+T/Vd6aYeBtwRtoy4A/2qAcmChafY/vNLYEZ/ARukibLGcoOhAAAAAElFTkSuQmCC"),new PIXI.Sprite.fromImage("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAZCAYAAADE6YVjAAAAAXNSR0IArs4c6QAAA71JREFUSA2lVUlPU1EYhU6UYi1qJIGwYlghsIGVkQ0JG8QRg4YgjVNMmhB/gQv+gAsXpCtcgFEjJgoaQouFUuwCIYHCCoSSME9lKnR+nvPoNWD7kMYvOX33ft+999xvuk1P+z9JV9guHderjk9SHJOAUK2vrxfjq+Y4rlMih/nsIh+O5dqNjY070Wh0dHt7+xnmGYAGEGQYHk3kQQo/wgPN8vLyTa1W+6K6ulp9eHj4YHV19RHO0QH0SqxL4eijpX88wIF3fT7fUFFRkRcmKScnZ21paWlwcXHRgnkmkOARdGcSkqh3d3dv7ezsOAUBdEy0IBpAjp5jztAJjzA8u6QHAoEbCI2zsrLSYzKZfMA2tks6nS5oNBr3SLy1tTXo9/ufQJ86iSRJ1YAjFosNhsPhoWAw6J6bmxskSXt7ux0Hj+ICbtiGscYViUQaYKP3KYnICeOdOTMz02C323sxllwul83hcNRjfAnIArSAXGX8SVUY/xgQzc3NvdbZ2Zml0WgiZWVlpr6+vgnog0A4vuZEU0KXXBCec39ZZG/m5+dL9vb2nAaDwV9bW/sTffIB6y4AekDkQjFUNMgAwXXAHJ/jc6Tv7u42hEKhzpaWlu/QSR6PxzY+Pn4fYyPAMCkeDptsZAjVrCIQjCB5bDBBrIoTvLLZbD3QS01NTT9Q0t2oqsuYGwDmS5GEBhJo0WS3EYoBt9v9BdXyOL5RvbKycgUevO3t7e1ByQZYrgiTu6ur6yrWnAfY7TwjKYkg0LGT2WiFhYVzVqv1G8hebm5u3sPhr3Fjp8ViceAQiQTQD4+NjTVhzlyILj+VQIu3qJ5PBQjmeVBra6vd6/XaUDVfm5ubnXq93k+92Wx24SLuOEFCyWJNgpBZzRDFnwqZADr5qRBflGm4rq5uZHJy0g6PPnd0dDBEF4ETPYF5gjBJlHQkOQshSUPCWR2y1NTUTDQ2Nq4hNFJpaWk2utg7PT39qby83IFOD2AR+4GIAuJSGCaK7AnUmbOzs4+RE1deXt4y5lJbW1s/Xlar0+msR7nyj4mhyQZ4+6T/HdAniPCEt4gWFBR8nJqa0iDWDysqKiSVShU7ODjwVFVV9cMubix3O+bcwzGFY0VhuQk36XKwpKTkPXLzBkS/iouLI+joCPQMDZ+LEHCcTOyF+t/CkJGQnvFZMC4sLJjxtzqGPniKOfOkWP+wnSrHw8WFdJ83jeXn57/b398PZWRksP6pT+nWWK8o9Eh4xUdODU/YaEKvuPE0Azcnk2T6U5Ob7BCh+w13D8jLwsORsAAAAABJRU5ErkJggg=="),new PIXI.Sprite.fromImage("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAOCAYAAAA8E3wEAAAAAXNSR0IArs4c6QAAAy1JREFUOBF9VE1IG1EQdpNs/jQNiAlW0h8UYkEIWCN4EQ/V3irFXgoFLd682PRorz3YS6iXHjwK4qktLRWkhlKtqWColcSSotEmXiS2KElM1MRkt9+87ixbKX3wMfPmzcw3M5mNVPfnSJokYdTZrGoKS7az5BiWbGfJcSo7kJTy+XyXoij15XLZRJ5ms1m12+2KxWJRNdRgXpMkiaQ4qqp2VatVJyARzs7OTLVaTeTleJfLFYWzQgEWQJBBmp1O55Pd3V378fGxqAiJVYLP55O9Xm8jfJ4ayXAXB8VMnp6eVhBbApkJRQhCiu3s7LwMpx7NVZDSoxlwoLq3fr//B3QiFGhra0sXCoWlUql0FzbROaTxSLlcLlipVJYGBga+4EGPJf38/HwD0glwc6JDujQg6TsQpsmRgFEUjo6OPh8eHj7G3QoQoagekg/dLalUqufk5GQFpESgk+LnieN+CZABE1dMQTwKkdBqtVYwWtfY2JjZ4XAMFYvFUDqd9sJP+JI/Y2dn53pzc/MdJK/DaKl4/Wjj/atQSkDsLiSdR4eZ9vb2TDabXRsfH1+BXW1qavo1Ozs7jw6iWIw5JJ4EJoBnuL9GYZ/C4fACJpLHolSnpqY+9vX1faNY+FCHbkBMiMgIVJUNCeeGh4e909PTyt7e3svW1tZb8XhcHhkZuZHJZK4gWa27uzuJgnLoqLy/v29PJBIewE+dBIPB7zMzM1mPx/PTZrNdGxwcrI9EIgqm1Yv8ZaAK6IQOVPMGI4klk8n7sHsDgYBve3v7EX7bVZz3o6OjUVoq6gLvqizL5Y6OjlQoFFra3NyMYEIf1tfXH2LbWxYXF28jLnphacRPSB3Slsp4fHVwcHAPer0GF2Rjf3//1Vgs9gBvL7CxC9jmOJAANvDtzqPT58vLy0PovIX8AVqShq2trV6MfBU6jZM4JB6pkPThu93ur3jgQxWRI42cfmfSeVmg6ttI3xd1zaA/BtrUOuS8iZz650JEdC5K4azZ6Y2JWIoCYef1JwIiZcnxMInDd/2vjR8uSmMhTMKSfZnUKOmNScifdb0zDv6fZHLyMep6MtiN+j9z/Qasm4fFL/kTlgAAAABJRU5ErkJggg=="),new PIXI.Sprite.fromImage("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAZCAYAAADE6YVjAAAAAXNSR0IArs4c6QAAA6lJREFUSA2lVUlLW1EUNiZGY4zGxhoiIggqQqtLEVqo0KVYOqTowqYKHRFcdeOy/oFuCl260S5EkFYLYtLGTKTUKg3RhSixLpI4GzXikOH1+0KuxDHRHji8e84993xnuvfJss4n2Tlq6RxdRirFKSvhnF/BdC4AxPfUscvF7JRt4ZQ6gis3Nzfbtra2HmAtB4t9LK9GIhPhQADk+nw+YywWe65UKrOCwaDcYDB8heto0v21MiIIo80Da2dnZ1+vrKw4y8vLA1VVVX+RjQPyE+zlgBkI7a9EPMCDSrBmbm7u5fLysqusrCwIOdEPAm1vb9sB9gg6UTosM6fjLPx+f+fq6qqDGeB4AkB8q6urfbu7uxMHBwfs0ZUyoXEik3A43KpSqd7ZbLaV+fl5RTwezx4eHi4ZHx+v7+3t/a7X64/q6+ujjY2NBpx5L5PJRvHNiBKND4VChXK5XIVIP9XW1sorKioU+fn5deA4QLJMJpOk0+l+KhQKP4ZBgm2JJEkFAApnhAIjkQ1rzcaqwMV2u93ocrnGsZYA9G1jY+Mp1gxK2GOZGbHhYhzjWMfAHNPI0NCQp66uTovoowMDAxq1Wn0vxVacgerqxCiZEbPRoYyDLS0tk3l5eXs7Ozt2TN1t6FNHOJEVSncfepEhv2mJTnLB2snJybaZmRkL1lJXV5f16Ojo88jISD7kVIfZALEmp44BpgYB8XyiA9ZeXVlZqUcGXzo6OpyQpbGxsVEAfUgC0RmZk2jb39+3w/Yh5IwuLEEYEbMp6u/vv4OL6OaFxBNzYDabCTSwtLR0C/u8wKpIJOJoaGjw8sImXwbq02YksmFpbkxPTz/DdLkIBFnq7u7+gXG37+3tfVxYWGg9PDx0a7XaLfEE4a0zwi5tRgRhJDRUg3UAMmEQ3O3t7W7IEu5QuLOz02GxWMYWFxdtRUVFIerFE7S+vv4YMitCXxfSaaDiwcHBu6j7iNfrNTc3N//GeEdw+sTzQ7mpqekPLu3U2tpaDeRLQYieCsSxLkSkNz0eTxvHGz345XQ6zX19fRb06xD7Umlp6SrKNYH9V5DF5cXychJAPMCGsk8acHFPT0+N1Wo1ojdTGo1mlwCBQGACzX+LfQ5O2nLB5pgIlArGXvHfUwDWYXwT0wcAG17yLugYCINKO2GwOUOpYIySmakxwi78qm3owRvILGvayYJNRkRAAuXgMjpRshdYs0TXzgBnz5DISh6NRluxS0DymRLR8H/oovMnXul/F7SWjoEFkdEAAAAASUVORK5CYII="),new PIXI.Sprite.fromImage("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAcCAYAAABRVo5BAAAAAXNSR0IArs4c6QAAAz9JREFUOBFtVN9LU3EU997b7nJrG+hkYWKGOEFBIhdIWFHMFx+iN4NASv+A8EXfetxTkD304rNo0INgVhhkybURbmuwcDCnDRNxOtT9cIr7cW+f83Xf23XswNn5nvP9fs4538/33Al1F0W46Nb0NIpeMmwRqFr5Nh3mSjHNCKQAAUUoxaWKTzEVWoaWKlavyCplMplei8UyoaqqVC6XRVhKUicIgiZJkkp6cnLiczgcQV6R2hAQ+LW3tzdjt9snhoeH1UgkcpWAENbm/Px8zOVyWeFTIV3IoUSWaDT65ODgwN/R0bEFn99NCwQCn5LJ5EPERNYKFkYRurq6lra3t98ripKUZblg3ORrDmR3RJB8saenR25ra/P6fL4CRLbZbDkCVO5KHehCQGKxHtqwvr7+Ynl5+QvW2tDQ0M/Dw8Mf7e3tiVAotJDL5e4jzguyhYyAzev1tubzeT8q/nU6nSmwqOC+Y9ls9juIWzw9Pb2Hc1SI/VC1y9CG1dXVp36/fxFrbXp6euH4+HgcaxnJHmuaFigWi3fh60Bik2huQta3IyMjK3izEqqtJBIJehJ2dwAfQe/AZ0JoE9QGdaGlz263+09fX1+kVCrNIMYnCEu0oWnks0wE5CqC/ubNzc3Wzs7ONKZni85WFAYHBYFG7z87FKMARABAwoTQ+2VZpMaPTiv2eOayyWQq7O7umhFz1MCwEJHCAcyenZ3t4I5XMKdNIMiNfX4Nut8tQqHdEK9IIOpdBe3xgYGBHQDdeDPnxsbGDcSldDrdC/sGhFlgBSOQvrlSPB5XRkdHi8guTE1N5XHX54h58Lm9wtQUAORc4Pg5SexJwGYzHv2rx+OJYkYzR0dHCk0PJioUDoc/VI8cZdFnFTP5bG1tbYmGoL+//zdaD2NfCwaDH1Op1INKIZhzAqhtmld7Y2Pjtf39/XeTk5Pf4OvkGb/HC/8A/NDs7Gy32Wy+Pjc3R9NUUzhQ34zFYjdbWlpeDg4OWvFpdesbWBi/R84QWQF/VretVutrMFpPrHIlgCiKKlQDUWMgTeFASkxruieRRJ2QZQMNy54Klv89qtVAVhkHeBIsmegEwaMk+mCz3SrfmJT2CcxF+wduL3Nt3V5HIgAAAABJRU5ErkJggg=="),new PIXI.Sprite.fromImage("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAZCAYAAADE6YVjAAAAAXNSR0IArs4c6QAAA5hJREFUSA2lVklMU1EUtb/fTlIpihgIG2TYOCxYsGFDYsIGMYoTCVaKGKNpQly4YeOCuHehG5Yk6IKEhaKGUBT6EZtQJRJgQUgaSJgqQylQZvo9p/aZ30mmm9z8++5775x777vv5etOHE90Sbar8T4p3nGIcYRgeXnZhj3EodInFOZfOQ4JESSj0Vi1trZ2D/ZJqEwfNIboqCQCRNra2tKbzebnU1NT1QA3QkkWQ3QYkn/AURA9vvL6+rrkdrv9BoOhfmxsjEQm+qFcH5GDkGjBCcxIDVBGbQKJPD4+LhcXF+enp6c7RkdHWTrOcW1k734kgiASdXSzGV9LQ0NDtqIoVy0Wy+VwOCyhXNkgupCZmWn3+Xy3NSQwUwsJGAQjt0DT8/Lyznu93mp0VNvKyspAf39/V0tLi6u8vHwI82xdNTc3d2Z+fl5ZWlq6j3FM2TCOES3BKcycaW1tLQXw+5GRke7KykqvLMs78EeAtd+CgoKJYDCoBAKBm/CLksGMlXiCs4ODg3Zs9Dgcjm9YqppMplBtba3S1dX1aWJiwtXU1NRNPwkA3jc7O8tyabsslgEjkjBN1j4DBA8WFxf7CYCx6nQ6e5CRsr29/Rr+O6urqy+am5s/FxYW+piB3++/hXVsDJaaWAkisuCi0+3t7aWov4cEaNHNzs7OjwB/Nzc3dwnzkWbY2Nio93g8H0DWGy3RfzMgo8jCAuBziLjDbrd/h191uVwkeNXR0cEmEFHqdnd3H6qq6t3c3LwOP4nFHMzkQhJGYh0aGqoeHh52wVbRrl9B8DZKwDVUig4EDug12hrlXIKIBYyENzaDbVpRUfED92ANpVAmJycvwp8QJQjSEtCSOLQEPIu0xsbGIhziANu0rq6uLxQKvYFfe5gikyRwiS5GRuEm2iyVEZfrCkoVRL3lmpqaEFqyD/4D1RvrEoStegJgdyVJcu7t7UmwJTwThra2tgDn8vPzzTk5Oc92dnacer1e1el0Ybhf4vuF8wcVZqFHSR7hKXCzXa1W6ypadgt+FY/ess1mC5SUlAyjXZVoFx2qXAwkQoKvEW/Ok5mZGXdWVtZvEgglMS8aWvoGfCzbkUh4HpFbPj097QRRryAiAZ+K6E3e96IBJ6UwMnHwFgA+xWH3lJWV/WIGsPkWabsrJdB+E4KIGRlxTx6jEX4uLCxUYXysDOKJBRHrLuOMivA9cusKcILGSzIf1yT8T8VvTDX+A7nQiRk9jngZAAAAAElFTkSuQmCC")];for(var a=0;a<this.rotationCursorList.length;a++){var b=this.rotationCursorList[a];b.visible=!1,b.anchor={x:.5,y:.5},this.stageLayer.addChild(b)}var c={photoEditor:this.stageLayer},d={photoEditor:this.stageLayer,rotationCursorList:this.rotationCursorList},e={photoEditor:this.stageLayer};this.c=this.controls={de:new t.default(v.default.DELETE,e),tl:new t.default(v.default.TOP_LEFT,c),tc:new t.default(v.default.TOP_CENTER,c),tr:new t.default(v.default.TOP_RIGHT,c),ml:new t.default(v.default.MIDDLE_LEFT,c),mr:new t.default(v.default.MIDDLE_RIGHT,c),bl:new t.default(v.default.BOTTOM_LEFT,c),bc:new t.default(v.default.BOTTOM_CENTER,c),br:new t.default(v.default.BOTTOM_RIGHT,c),mc:new t.default(v.default.MIDDLE_CENTER,c),rde:new t.default(v.default.ROTATION,d,x.default.DELETE),rtl:new t.default(v.default.ROTATION,d,x.default.TOP_LEFT),rtc:new t.default(v.default.ROTATION,d,x.default.TOP_CENTER),rtr:new t.default(v.default.ROTATION,d,x.default.TOP_RIGHT),rml:new t.default(v.default.ROTATION,d,x.default.MIDDLE_LEFT),rmr:new t.default(v.default.ROTATION,d,x.default.MIDDLE_RIGHT),rbl:new t.default(v.default.ROTATION,d,x.default.BOTTOM_LEFT),rbc:new t.default(v.default.ROTATION,d,x.default.BOTTOM_CENTER),rbr:new t.default(v.default.ROTATION,d,x.default.BOTTOM_RIGHT)},this._controlMoveStartListener=this.onControlMoveStart.bind(this),
this._controlMoveListener=this.onControlMove.bind(this),this._controlMoveEndListener=this.onControlMoveEnd.bind(this),this._rotateStartListener=this.onRotateStart.bind(this),this._rotateListener=this.onRotate.bind(this),this._rotateEndListener=this.onRotateEnd.bind(this),this._changeRotationCursorListener=this.onChangeRotationCursor.bind(this),this._deleteListener=this.onDelete.bind(this),this.c.mc.on(t.default.MOVE_START,this._controlMoveStartListener),this.c.mc.on(t.default.MOVE,this._controlMoveListener),this.c.mc.on(t.default.MOVE_END,this._controlMoveEndListener),!0===this.useDelete&&this.stageLayer.addChild(this.c.rde),this.stageLayer.addChild(this.c.rtl),this.stageLayer.addChild(this.c.rtc),this.stageLayer.addChild(this.c.rtr),this.stageLayer.addChild(this.c.rml),this.stageLayer.addChild(this.c.rmr),this.stageLayer.addChild(this.c.rbl),this.stageLayer.addChild(this.c.rbc),this.stageLayer.addChild(this.c.rbr),this.stageLayer.addChild(this.c.mc);for(var f in this.controls){var g=this.controls[f];switch(g.visible=!1,g.centerPoint=this.controls.mc,g.targetLayer=this.targetLayer,g.type){case v.default.DELETE:!0===this.useDelete&&(this.stageLayer.addChild(g),g.on("click",this._deleteListener));break;case v.default.ROTATION:g.on(t.default.ROTATE_START,this._rotateStartListener),g.on(t.default.ROTATE,this._rotateListener),g.on(t.default.ROTATE_END,this._rotateEndListener),g.on(t.default.CHANGE_ROTATION_CURSOR,this._changeRotationCursorListener);break;case v.default.TOP_LEFT:case v.default.TOP_RIGHT:case v.default.TOP_CENTER:case v.default.MIDDLE_LEFT:case v.default.MIDDLE_RIGHT:case v.default.BOTTOM_LEFT:case v.default.BOTTOM_RIGHT:case v.default.BOTTOM_CENTER:this.stageLayer.addChild(g),g.on(t.default.MOVE_START,this._controlMoveStartListener),g.on(t.default.MOVE,this._controlMoveListener),g.on(t.default.MOVE_END,this._controlMoveEndListener)}}},b.prototype.addEvent=function(){this._setTargetListener=this.onSetTarget.bind(this),this.stageLayer.on(b.SET_TARGET,this._setTargetListener)},b.prototype.show=function(){this.controls&&!this.g.visible&&(this.g.visible=!0,(0,z.each)(this.controls,function(a){return a.visible=!0}))},b.prototype.hide=function(){this.controls&&!1!==this.g.visible&&(this.g.visible=!1,(0,z.each)(this.controls,function(a){return a.visible=!1}),(0,z.each)(this.rotationCursorList,function(a){return a.visible=!1}))},b.prototype.activeTarget=function(a){this.target=a,this.isNeedGridDisplay=!1,this.removeTextureUpdateEvent(),this.addTextureUpdateEvent(),this.update(),this.drawCenter(),this.emit(b.SELECT,a),this.target.emit(b.SELECT,a),this.stageLayer.emit(b.SET_TARGET,a)},b.prototype.drawCenter=function(){null!==this.target&&(this.stageLayer.updateTransform(),this.c.mc.drawCenter(p.default.toRadians(this.c.mc.angle),this.target.width,this.target.height))},b.prototype.setTarget=function(a){a.emit(b.SET_TARGET,a),this.activeTarget(a)},b.prototype.setTargetByEvent=function(a){var c=a.target;c.emit(b.SET_TARGET,c),this.activeTarget(c),this.c.mc.emit("mousedown",a),this.enableCurrentStyleCursor("move")},b.prototype.releaseTarget=function(){null!==this.target&&(this.hide(),this.removeTextureUpdateEvent(),this.target=null,this.emit(b.RELEASE_TARGET))},b.prototype.addTextureUpdateEvent=function(){},b.prototype.removeTextureUpdateEvent=function(){},b.prototype.update=function(){null!==this.target&&(this.setControls(),this.updateTransform(),this.draw(),this.updatePrevTargetLt())},b.prototype.destroy=function(){if(this.stageLayer.off(b.SET_TARGET,this._setTargetListener),this.rotationCursorList){for(var a=0;a<this.rotationCursorList.length;a++){var c=this.rotationCursorList[a];this.stageLayer.removeChild(c),c.texture.destroy(),c.texture=null,c.destroy()}this.rotationCursorList=null}for(var d in this.controls){var e=this.controls[d];switch(this.stageLayer.removeChild(e),e.type){case v.default.DELETE:!0===this.useDelete&&e.off("click",this._deleteListener);break;case v.default.ROTATION:e.off(t.default.ROTATE_START,this._rotateStartListener),e.off(t.default.ROTATE,this._rotateListener),e.off(t.default.ROTATE_END,this._rotateEndListener),e.off(t.default.CHANGE_ROTATION_CURSOR,this._changeRotationCursorListener);break;case v.default.TOP_LEFT:case v.default.TOP_RIGHT:case v.default.TOP_CENTER:case v.default.MIDDLE_LEFT:case v.default.MIDDLE_RIGHT:case v.default.BOTTOM_LEFT:case v.default.BOTTOM_RIGHT:case v.default.BOTTOM_CENTER:case v.default.MIDDLE_CENTER:e.off(t.default.MOVE_START,this._controlMoveStartListener),e.off(t.default.MOVE,this._controlMoveListener),e.off(t.default.MOVE_END,this._controlMoveEndListener)}e.destroy()}this.g&&(this.stageLayer.removeChild(this.g),this.g.destroy(),this.g=this.graphics=null),this.c=this.controls=this.target=this.options=this.stageLayer=this.targetLayer=this.transform=this.invertTransform=null},b.prototype.setControls=function(){var a=this.target.scaleSignX,b=this.target.scaleSignY,c=this.target.getLocalBounds(),d=c.width*a,e=c.height*b,f=d/2,g=e/2,h=-f,i=-g,j=this.deleteButtonOffsetY*b;this.c.tl.localPoint=new PIXI.Point(h,i),this.c.tr.localPoint=new PIXI.Point(f,i),this.c.tc.localPoint=r.default.interpolate(this.c.tr.localPoint,this.c.tl.localPoint,.5),this.c.bl.localPoint=new PIXI.Point(h,g),this.c.br.localPoint=new PIXI.Point(f,g),this.c.bc.localPoint=r.default.interpolate(this.c.br.localPoint,this.c.bl.localPoint,.5),this.c.ml.localPoint=r.default.interpolate(this.c.bl.localPoint,this.c.tl.localPoint,.5),this.c.mr.localPoint=r.default.interpolate(this.c.br.localPoint,this.c.tr.localPoint,.5),this.c.mc.localPoint=r.default.interpolate(this.c.bc.localPoint,this.c.tc.localPoint,.5),this.c.de.localPoint=r.default.add(this.c.tl.localPoint.clone(),new PIXI.Point(0,j)),this.c.tc.enable=this.target.useMiddleControl,this.c.bc.enable=this.target.useMiddleControl,this.c.ml.enable=this.target.useMiddleControl,this.c.mr.enable=this.target.useMiddleControl;var k=this.c;!0===this.target.rotatable?(this.c.rde.localPoint=new PIXI.Point(k.de.localPoint.x,k.de.localPoint.y),this.c.rtl.localPoint=new PIXI.Point(k.tl.localPoint.x,k.tl.localPoint.y),this.c.rtc.localPoint=new PIXI.Point(k.tc.localPoint.x,k.tc.localPoint.y),this.c.rtr.localPoint=new PIXI.Point(k.tr.localPoint.x,k.tr.localPoint.y),this.c.rml.localPoint=new PIXI.Point(k.ml.localPoint.x,k.ml.localPoint.y),this.c.rmr.localPoint=new PIXI.Point(k.mr.localPoint.x,k.mr.localPoint.y),this.c.rbl.localPoint=new PIXI.Point(k.bl.localPoint.x,k.bl.localPoint.y),this.c.rbc.localPoint=new PIXI.Point(k.bc.localPoint.x,k.bc.localPoint.y),this.c.rbr.localPoint=new PIXI.Point(k.br.localPoint.x,k.br.localPoint.y),!1===this.target.useMiddleControl&&(this.c.rtc.localPoint=this.outSideLocalPoint,this.c.rbc.localPoint=this.outSideLocalPoint,this.c.rml.localPoint=this.outSideLocalPoint,this.c.rmr.localPoint=this.outSideLocalPoint)):(this.c.rde.localPoint=this.outSideLocalPoint,this.c.rtl.localPoint=this.outSideLocalPoint,this.c.rtc.localPoint=this.outSideLocalPoint,this.c.rtr.localPoint=this.outSideLocalPoint,this.c.rml.localPoint=this.outSideLocalPoint,this.c.rmr.localPoint=this.outSideLocalPoint,this.c.rbl.localPoint=this.outSideLocalPoint,this.c.rbc.localPoint=this.outSideLocalPoint,this.c.rbr.localPoint=this.outSideLocalPoint);for(var l in this.controls){this.controls[l].target=this.target}},b.prototype.updateTransform=function(){this.transform=this.target.worldTransform.clone(),this.invertTransform=this.transform.clone(),this.invertTransform.invert();for(var a in this.controls){this.controls[a].transform=this.transform}this.targetFlipScale=new PIXI.Point(1,1)},b.prototype.updatePrevTargetLt=function(){if(null!==this.target){var a=this.lt;this.prevLtX=a.x,this.prevLtY=a.y}},b.prototype.scaleCorner=function(a){!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.isNeedGridDisplay=!0;var b=a.currentMousePoint,c=this.getScale.apply(this,this.collision.target.pivot.concat([b.x,b.y,this.target]));if(this.target.scale.x=this.target.scale.y=c,!0===B.default.isMask(this.target)){var d=this.target.checkLimitSize();this.isLimit=this.isLimit?this.isLimit:d}else this.target.checkLimitSize();void 0!==this._minimumScale?this.target.scale.x=this.target.scale.y=Math.max(this._minimumScale,this.target.scale.x):void 0!==this._maximumScale&&(this.target.scale.x=this.target.scale.y=Math.min(this._maximumScale,this.target.scale.x)),this.scaleTest(!(this.target instanceof F.default))},b.prototype.getScale=function(a,b,c,d,e){var f=c-a,g=d-b,h=void 0,i=void 0,j=void 0;return e instanceof F.default?(h=this.collision.target,i=this._targetWidth,j=this._targetHeight):h=this.collision.boundary,Math.max(h.getHorizontalScale(f,g,i),h.getVerticalScale(f,g,j))},b.prototype.scaleTest=function(){var a=arguments.length>0&&void 0!==arguments[0]&&arguments[0],b=this.collision.boundary,c=this.collision.target,d=a?b:c;d.width=this.target.width,d.height=this.target.height;var e=b.containTestPolygon(c),f=G.maxLength.apply(void 0,e);f<=0||(a?(this.scaleTestBoundary(e,f),this.target.width=d.width,this.target.height=d.height,this._minimumScale=this.target.scale.x):(this.scaleTestTarget(e,f),this.target.width=d.width,this.target.height=d.height,this._maximumScale=this.target.scale.x))},b.prototype.scaleTestTarget=function(a,b){var c=(this.collision.boundary,this.collision.target);c.radius?c.radius=c.radius-b:this.scaleTestTargetWithPolygon(a)},b.prototype.scaleTestTargetWithPolygon=function(a){var b=this.collision.boundary,c=this.collision.target,d=c.pivot,e=G.maxVertex.apply(void 0,a),f=b.hitTestEdge.apply(b,d.concat(e)),g=H.getDistance.apply(void 0,d.concat(e)),h=H.getDistance.apply(void 0,d.concat(f));c.scale=h*c.scale/g},b.prototype.scaleTestBoundary=function(a,b){var c=this.collision.boundary,d=this.collision.target;d.radius?c.scaleToCircle(d.radius):this.scaleTestBoundaryWithPolygon(a)},b.prototype.scaleTestBoundaryWithPolygon=function(a){var b=this.collision.boundary,c=this.collision.target,d=c.pivot,e=G.maxVertex.apply(void 0,a),f=e.map(function(a,b){return a-d[b]}),g=f[0],h=f[1];b.scaleToVector(g,h)},b.prototype.scaleMiddle=function(a){var b=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.isNeedGridDisplay=!0;var c=a.target,d=a.currentMousePoint,e=this.targetScaleX,f=this.targetScaleY,g=this.invertTransform.apply(d),h=this.invertTransform.apply(this.startMousePoint),i=r.default.subtract(g,h),j=this.invertTransform.apply(c.globalPoint),k=this.invertTransform.apply(this.c.mc.globalPoint),l=r.default.subtract(j,k),m=2*l.x,n=2*l.y;if(b?e+=i.x/m:f+=i.y/n,this.target.scale={x:e,y:f},!0===B.default.isMask(this.target)){var o=this.target.checkLimitSize();this.isLimit=this.isLimit?this.isLimit:o}},b.prototype.move=function(a){var c=a.targetChangeMovement,d=this.collision.target,e=this.collision.boundary,f=this.target instanceof F.default,g=f?d:e;g.x+=c.x,g.y+=c.y;var h=e.containTestPolygon(d),i=f?1:-1;h.reduce(function(a,b){return a+b.largestLength},0)>0&&h.forEach(function(a){return a.translate(g,i)}),this.target.x=g.x,this.target.y=g.y,this.target.emit(b.CHANGE,a)},b.prototype.moveTest=function(){var a=this.collision.boundary,b=this.collision.target,c=a.containTestPolygon(b);return!(G.maxLength.apply(void 0,c)<=0)&&(c.forEach(function(b){return b.translate(a,-1)}),!0)},b.prototype.doTransform=function(a){switch(a.target.type){case v.default.TOP_LEFT:case v.default.TOP_RIGHT:case v.default.BOTTOM_LEFT:case v.default.BOTTOM_RIGHT:this.scaleCorner(a);break;case v.default.MIDDLE_LEFT:case v.default.MIDDLE_RIGHT:this.scaleCorner(a);break;case v.default.TOP_CENTER:case v.default.BOTTOM_CENTER:this.scaleCorner(a,!1);break;case v.default.MIDDLE_CENTER:this.move(a)}this.target.emit(b.CHANGE,a)},b.prototype.draw=function(){this.stageLayer.updateTransform();var a=void 0,b=this.target.worldTransform.clone();if(!1===this.isLimit)a={de:this.deleteButtonPosition,tl:b.apply(this.c.tl.localPoint),tr:b.apply(this.c.tr.localPoint),tc:b.apply(this.c.tc.localPoint),bl:b.apply(this.c.bl.localPoint),br:b.apply(this.c.br.localPoint),bc:b.apply(this.c.bc.localPoint),ml:b.apply(this.c.ml.localPoint),mr:b.apply(this.c.mr.localPoint),mc:b.apply(this.c.mc.localPoint),rde:this.deleteButtonPosition,rtl:b.apply(this.c.rtl.localPoint),rtc:b.apply(this.c.rtc.localPoint),rtr:b.apply(this.c.rtr.localPoint),rml:b.apply(this.c.rml.localPoint),rmr:b.apply(this.c.rmr.localPoint),rbl:b.apply(this.c.rbl.localPoint),rbc:b.apply(this.c.rbc.localPoint),rbr:b.apply(this.c.rbr.localPoint)};else{var c=this.target.lt,d=this.target.rt,e=this.target.lb,f=this.target.rb,g=r.default.interpolate(e,d,.5);c=r.default.interpolate(g,f,2);var h=r.default.interpolate(f,e,.5),i=r.default.interpolate(f,d,.5),j=r.default.interpolate(d,c,.5),k=r.default.interpolate(e,c,.5),l=r.default.add(r.default.getAddedInterpolate(c,k,this.deleteButtonOffsetY),new PIXI.Point(-28,-28));a={de:l,tl:c,tr:d,tc:j,bl:e,br:f,bc:h,ml:k,mr:i,mc:g},this.target.rotatable?(a.rde=l,a.rtl=c,a.rtc=j,a.rtr=d,a.rml=k,a.rmr=i,a.rbl=e,a.rbc=h,a.rbr=f):(a.rde=this.outSideLocalPoint,a.rtl=this.outSideLocalPoint,a.rtc=this.outSideLocalPoint,a.rtr=this.outSideLocalPoint,a.rml=this.outSideLocalPoint,a.rmr=this.outSideLocalPoint,a.rbl=this.outSideLocalPoint,a.rbc=this.outSideLocalPoint,a.rbr=this.outSideLocalPoint)}var m=this.g;m.visible=!0,m.clear(),m.lineStyle(.5,16777215),this.drawRect(m,a);for(var n in this.controls){var o=a[n],p=this.controls[n];p.x=o.x,p.y=o.y,p.visible=p.enable}if(!0===(this.target.useGrid||!1)&&!0===this.isNeedGridDisplay){var q=a.tl,s=a.tr,t=a.bl,u=(a.br,s.x-q.x),v=t.y-q.y,w=u/3,x=v/3;m.lineStyle(1,16777215,.5);for(var y=void 0,z=void 0,A=void 0,B=0;B<2;B++)y=B+1,z=q.x+w*y,A=q.y+x*y,m.moveTo(z,q.y),m.lineTo(z,t.y),m.moveTo(q.x,A),m.lineTo(s.x,A)}},b.prototype.updateGraphics=function(){if(this.target){this.stageLayer.updateTransform(),this.g.visible=!0;var a=this.c,b=this.target.worldTransform,c=(0,z.map)(J,function(c,d){return b.apply(a[d].localPoint)});c.de=c.rde=this.deleteButtonPosition,this.g.clear(),this.g.lineStyle(.5,16777215),this.drawRect(this.g,c),(0,z.each)(this.controls,function(a,b){a.x=c[b].x,a.y=c[b].y,a.visible=!0})}},b.prototype.drawRect=function(a,b){a.moveTo(b.tl.x,b.tl.y),a.lineTo(b.tr.x,b.tr.y),a.lineTo(b.br.x,b.br.y),a.lineTo(b.bl.x,b.bl.y),a.lineTo(b.tl.x,b.tl.y)},b.prototype.setPivotByLocalPoint=function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.target,c=b.pivot.x,d=b.pivot.y;b.setPivot(a);var e=b.pivot.x-c,f=b.pivot.y-d,g=b.rotation,h=b.scale.x,i=b.scale.y,j=Math.cos(g),k=Math.sin(g),l=j*h*e-k*i*f,m=k*h*e+j*i*f;b.x+=l,b.y+=m;var n=this.collision.boundary;n.x=b.x,n.y=b.y,n.pivotX=b.pivot.x+Math.abs(b.bitmap.x),n.pivotY=b.pivot.y+Math.abs(b.bitmap.y)},b.prototype.setPivotByTarget=function(a){B.default.isMask(a)||this.setPivotByLocalPoint(B.default.backgroundImageLocalPivot)},b.prototype.setPivotCenter=function(){var a=this.c.mc;this.target.setPivot(a.localPoint),this.adjustPosition()},b.prototype.adjustPosition=function(){this.updatePrevTargetLt()},b.prototype.getPivot=function(a){switch(a.type){case v.default.DELETE:case v.default.ROTATION:return this.c.mc;case v.default.TOP_LEFT:return this.c.br;case v.default.TOP_CENTER:return this.c.bc;case v.default.TOP_RIGHT:return this.c.bl;case v.default.MIDDLE_LEFT:return this.c.mr;case v.default.MIDDLE_RIGHT:return this.c.ml;case v.default.BOTTOM_LEFT:return this.c.tr;case v.default.BOTTOM_CENTER:return this.c.tc;case v.default.BOTTOM_RIGHT:return this.c.tl;case v.default.MIDDLE_CENTER:return this.c.mc}},b.prototype.enableCurrentStyleCursor=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(null!==this.target){this.target.buttonMode=!1,this.target.interactive=!1,this.target.defaultCursor="inherit";for(var b in this.c){var c=this.c[b];c.buttonMode=!1,c.interactive=!1,c.defaultCursor="inherit"}this.stageLayer.buttonMode=!0,this.stageLayer.interactive=!0,this.stageLayer.defaultCursor=""!==a?a:n.default.currentCursorStyle}},b.prototype.disableCurrentStyleCursor=function(){if(null!==this.target){this.target.buttonMode=!0,this.target.interactive=!0,this.target.defaultCursor="inherit";for(var a in this.c){var b=this.c[a];b.buttonMode=!0,b.interactive=!0,b.defaultCursor="inherit"}this.stageLayer.buttonMode=!1,this.stageLayer.interactive=!1,this.stageLayer.defaultCursor="inherit",this.selectedControl.onMouseOver()}},b.prototype.emitControlUp=function(a){a&&this.emit(b.CONTROL_UP,{type:b.CONTROL_UP})},b.prototype.onSetTarget=function(a){this.target!==a&&this.releaseTarget()},b.prototype.onDelete=function(a){this.target&&(this.target.emit(b.DELETE,this.target),this.emit(b.CONTROL_UP,{type:b.CONTROL_UP}))},b.prototype.onRotateStart=function(a){this.target&&(this.isLimit=!1,this.isNeedGridDisplay=!0,this.target._rotation=this.target.rotation,this.selectedControl=a.target,this.enableCurrentStyleCursor())},b.prototype.onRotate=function(a){if(this.target){var b=this.target._rotation+a.changeRadian,c=b<0?-1:1;if(this.target.maxRotation){b=Math.abs(b)>this.target.maxRotation?c*this.target.maxRotation:b}if(this.useSnap&&!B.default.isImageRotated){var d=p.default.toDegrees(b),e=Math.round(Math.abs(d)%90);e<this._startSnapAngle||e>this._endSnapAngle?this.target.rotation=p.default.toRadians(p.default.snapTo(d,90)):this.target.rotation=b}else this.target.rotation=b;this.target._rotation=b,this.rotationTest(this.target.rotation),this.draw(),this.updatePrevTargetLt()}},b.prototype.rotationTest=function(a){var b=this.collision.boundary,c=this.collision.target;b.radian=a;var d=b.containTestPolygon(c),e=G.maxLength.apply(void 0,d);e<=0||(b.scale+=e/b._width*2,this.target.scale.x=this.target.scale.y=b.scale)},b.prototype.onRotateEnd=function(a){this.target&&(this.update(),this.drawCenter(),this.disableCurrentStyleCursor(),this.emitControlUp(a.modified))},b.prototype.onControlMoveStart=function(a){this.target&&(this._minimumScale=this._maximumScale=void 0,this.target instanceof F.default&&(this._targetWidth=this.target.canvas.textureCanvas.width,this._targetHeight=this.target.canvas.textureCanvas.height),this.isLimit=!1,this.isNeedGridDisplay=!1,this.targetScaleX=this.target.scale.x,this.targetScaleY=this.target.scale.y,this.startMousePoint=new PIXI.Point(a.currentMousePoint.x,a.currentMousePoint.y),this.selectedControl=a.target,this.updatePrevTargetLt(),this.enableCurrentStyleCursor(),B.default.isMask(this.target)?this.setMoveLimitByViewport():this.setMoveLimitByMask())},b.prototype.setMoveLimitByViewport=function(){var a=D.default.viewport,b=this.limitLeft=a.x,c=this.limitRight=a.x+a.width,d=this.limitTop=a.y,e=this.limitBottom=a.y+a.height,f=this.target.lt.clone(),g=this.target.rt.clone(),h=this.target.rb.clone(),i=this.target.lb.clone(),j=[f,g,h,i];j.sort(function(a,b){return a.x-b.x});var k=j[0],l=j[j.length-1];this._limitLeftX=this.target.x+(b-l.x),this._limitRightX=this.target.x+(c-k.x),j.sort(function(a,b){return a.y-b.y});var m=j[0],n=j[j.length-1];this._limitTopY=this.target.y+(d-n.y),this._limitBottomY=this.target.y+(e-m.y)},b.prototype.setMoveLimitByMask=function(){var a=B.default.mask,b=a.width,c=a.height,d=b/2,e=c/2,f=this.limitLeft=a.x-d,g=this.limitRight=a.x+d,h=this.limitTop=a.y-e,i=this.limitBottom=a.y+e,j=this.target.lt.clone(),k=this.target.rt.clone(),l=this.target.rb.clone(),m=this.target.lb.clone(),n=[j,k,l,m];n.sort(function(a,b){return a.x-b.x});var o=n[0],p=n[n.length-1];this._limitLeftX=this.target.x+(f-p.x),this._limitRightX=this.target.x+(g-o.x),n.sort(function(a,b){return a.y-b.y});var q=n[0],r=n[n.length-1];this._limitTopY=this.target.y+(h-r.y),this._limitBottomY=this.target.y+(i-q.y)},b.prototype.onControlMove=function(a){this.target&&(this.doTransform(a),this.draw(),this.updatePrevTargetLt())},b.prototype.onControlMoveEnd=function(a){this.target&&(this.setPivotByTarget(this.target),this.isNeedGridDisplay=!1,this.emit(b.TRANSFORM_COMPLETE,a),this.target.emit(b.TRANSFORM_COMPLETE,a),this.disableCurrentStyleCursor(),this.emitControlUp(a.modified))},b.prototype.onChangeRotationCursor=function(a){this.stageLayer.defaultCursor=a},b.prototype.onTextureUpdate=function(a){this.setPivotByLocalPoint(new PIXI.Point(0,0)),this.update(),this.drawCenter()},(0,j.default)(b,[{key:"lt",get:function(){this.target.displayObjectUpdateTransform();var a=this.target.worldTransform.clone();return a.rotate(-this.targetLayer.rotation),a.apply(this.target.localLt)}},{key:"deleteButtonPosition",get:function(){if(!this.c)return new PIXI.Point(0,0);var a=this.target.worldTransform.clone(),b=a.apply(this.c.tl.localPoint),c=a.apply(this.c.ml.localPoint);return r.default.add(r.default.getAddedInterpolate(b,c,this.deleteButtonOffsetY),new PIXI.Point(-28,-28))}},{key:"diffScaleX",get:function(){var a=this.target.worldTransform;return Math.sqrt(a.a*a.a+a.b*a.b)}},{key:"diffScaleY",get:function(){var a=this.target.worldTransform;return Math.sqrt(a.c*a.c+a.d*a.d)}},{key:"width",get:function(){return this.target.width*this.diffScaleX}},{key:"height",get:function(){return this.target.height*this.diffScaleY}},{key:"useSnap",set:function(a){this._useSnap=a},get:function(){return this._useSnap}},{key:"snapAngle",set:function(a){this._snapAngle=a,this._startSnapAngle=a,this._endSnapAngle=90-a},get:function(){return this._snapAngle}},{key:"isOverControl",get:function(){for(var a in this.c){var b=this.c[a];if(b!==this.c.mc){if(!0===b.hitTestWithGlobalPoint(n.default.global))return!0}}return!1}}]),b}(PIXI.utils.EventEmitter);b.default=K},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(1),h=d(g),i=function(){function a(){(0,f.default)(this,a)}return(0,h.default)(a,null,[{key:"DELETE",get:function(){return"delete"}},{key:"ROTATION",get:function(){return"rotation"}},{key:"TOP_LEFT",get:function(){return"topLeft"}},{key:"TOP_CENTER",get:function(){return"topCenter"}},{key:"TOP_RIGHT",get:function(){return"topRight"}},{key:"MIDDLE_LEFT",get:function(){return"middleLeft"}},{key:"MIDDLE_CENTER",get:function(){return"middleCenter"}},{key:"MIDDLE_RIGHT",get:function(){return"middleRight"}},{key:"BOTTOM_LEFT",get:function(){return"bottomLeft"}},{key:"BOTTOM_CENTER",get:function(){return"bottomCenter"}},{key:"BOTTOM_RIGHT",get:function(){return"bottomRight"}}]),a}();b.default=i},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(1),h=d(g),i=c(2),j=d(i),k=c(3),l=d(k),m=c(79),n=(d(m),c(15)),o=d(n),p=c(191),q=d(p),r=c(344),s=d(r),t=function(a){function b(c){(0,f.default)(this,b);var d=(0,j.default)(this,a.call(this,c));return d.initialize(),d}return(0,l.default)(b,a),b.prototype.initialize=function(){this.name="BackgroundImage",this.buttonMode=!1,this.interactive=!0,this.rotatable=!0,this.useGrid=!1,this.useMiddleControl=!0,this.maxRotation=o.default.toRadians(45),this.scaleSignX=1,this.scaleSignY=1,this.minSize=o.default.getSizeFitInBounds(this.bitmapData,{x:0,y:0,width:50,height:50}),this.minSizeX=this.minSize.width,this.minSizeY=this.minSize.height,this.maxSize=o.default.getSizeFitInBounds(this.bitmapData,{x:0,y:0,width:4096,height:4096}),this.maxSizeX=this.maxSize.width,this.maxSizeY=this.maxSize.height},b.prototype.toString=function(){var a=" BackgroundImage[pivot["+this.pivot.x+", "+this.pivot.y+"], "+this.x+", "+this.y+", "+this.bitmapWidth+", "+this.bitmapHeight+", "+this.width+", "+this.height+", "+this.rotation+", "+this.scale.x+", "+this.scale.y+"]";return void 0,a},b.prototype.checkLimitSize=function(){var a=!1,b=this.width,c=this.height;return b>this.maxSizeX?(a=!0,this.width=this.maxSizeX):b<this.minSizeX&&(a=!0,this.width=this.minSizeX),c>this.maxSizeY?(a=!0,this.height=this.maxSizeY):c<this.minSizeY&&(a=!0,this.height=this.minSizeY),a},(0,h.default)(b,[{key:"restoreVO",get:function(){return new s.default({x:this.pivot.x,y:this.pivot.y},this.x,this.y,this.bitmapWidth,this.bitmapHeight,this.width,this.height,this.rotation,this.scale.x,this.scale.y)}}]),b}(q.default);b.default=t},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(1),h=d(g),i=c(2),j=d(i),k=c(3),l=d(k),m=c(15),n=(d(m),c(346)),o=d(n),p=c(198),q=d(p),r=function(a){function b(c){(0,f.default)(this,b);var d=(0,j.default)(this,a.call(this,c));return d.initialize(),d}return(0,l.default)(b,a),b.prototype.initialize=function(){this.name="MaskCanvas",this.buttonMode=!1,this.interactive=!0,this.rotatable=!1,this.useGrid=!0,this.useMiddleControl=!1,this.scaleSignX=1,this.scaleSignY=1},b.prototype.destroy=function(){this._maskVO=null,a.prototype.destroy.call(this)},b.prototype.checkLimitSize=function(){var a=!1,b=this.width;return b>this.maxSizeX?(a=!0,this.width=this.maxSizeX,this.scale.y=this.scale.x):b<this.minSizeX&&(a=!0,this.width=this.minSizeX,this.scale.y=this.scale.x),a},b.prototype.toString=function(){var a=" MaskCanvas["+this.x+", "+this.y+", "+this.width+", "+this.height+", "+this.scale.x+", "+this.scale.y+"]";return void 0,a},(0,h.default)(b,[{key:"maskVO",set:function(a){this._maskVO=a,this.maxSize=a.maxSize,this.defaultSize=a.defaultSize,this.minSize=a.minSize,this.setDefaultMaskSize(a)},get:function(){return this._maskVO}},{key:"maxSize",set:function(a){if(a&&""!==a){this._maxSize=a;var b=a.split("x");this.maxSizeX=b[0],this.maxSizeY=b[1]}},get:function(){return this._maxSize}},{key:"defaultSize",set:function(a){if(a&&""!==a){this._defaultSize=a;var b=a.split("x");this.defaultSizeX=b[0],this.defaultSizeY=b[1]}},get:function(){return this._defaultSize}},{key:"minSize",set:function(a){if(a&&""!==a){this._minSize=a;var b=a.split("x");this.minSizeX=b[0],this.minSizeY=b[1]}},get:function(){return this._minSize}},{key:"restoreVO",get:function(){return new q.default(this.maskVO.clone(),this.x,this.y,this.width,this.height)}}]),b}(o.default);b.default=r},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(45),f=d(e),g=c(21),h=d(g),i=c(0),j=d(i),k=c(1),l=d(k),m=c(25),n=d(m),o=c(47),p=(d(o),c(10)),q=c(33),r=c(95),s=c(17),t=c(48),u=(c(55),c(39),function(){function a(b){(0,j.default)(this,a),this._init(b)}return a.prototype.oomCallback=function(){void 0},a.prototype.assertion=function(a){return null==a&&(this.oomCallback(),!0)},a.prototype.initWithSize=function(a,b){return[this._offContext.canvas].forEach(function(c){c.width=a,c.height=b}),this._worldTransform.canvasWidth=a,this._worldTransform.canvasHeight=b,this},a.prototype.initWithSource=function(a){return this.clear(),this.initWithSize(a.width||a.naturalWidth,a.height||a.naturalHeight),this._sourceImage=a,this},a.prototype.clear=function(){this._clearCache(),this._emptyPool(),this._filterAppliedData=null,this._transformedImageData=null},a.prototype.dispose=function(){this.clear(),this._updatedImageData=this._filterAppliedData=this._transformedImageData=null},a.prototype.setCanvasSize=function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;c=c||this.canvas,a==c.width&&b==c.height||(c.width=a,c.height=b,c.dispatchEvent(this._event))},a.prototype.save=function(a,b){var c=this,d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.tempCanvases[0].getContext("2d");return this.worldTransform.identity(),(0,t.re)(this.applyImageTransformsAsync,this.source,this.tempCanvases,a,this.worldTransform,0).then(function(a){var e=a[0];return(0,t.re)(c.applyImageFiltersAsync,e,null,b,d)}).then(function(a){var b=a[0];return d.canvas.width=b.width,d.canvas.height=b.height,d.putImageData(b,0,0),d})},a.prototype.applyImageTransformsAsync=function(a,b,c){var d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.worldTransform,e=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return new h.default(function(f){var g=[a,b[0]],h=g[0],i=g[1],j=c[e];if(!j)return f({done:!0,args:[(0,s.lastOf)(c).imageData]});j.applyTransform(h,i,d)&&(h=i,b.reverse()),setTimeout(function(){return f({done:!1,args:[h,b,c,d,++e]})},20)})},a.prototype.applyImageFiltersAsync=function(a,b,c,d){var e=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return new h.default(function(f){if(0==c.length||!c.some(function(a){return a.changed}))return f({done:!0,args:[a]});var g=c[e],h=[a.width,a.height],i=h[0],j=h[1];if(!g)return f({done:!0,args:[a]});b||(b=(0,p.createImageData)(d,i,j)),g.applyFilterAsync(a,b,0,0,i,j,function(){},function(){return f({done:!1,args:[b,a,c,d,++e]})})||setTimeout(function(){return f({done:!1,args:[a,b,c,d,++e]})},20)})},a.prototype.update=function(){var a=arguments.length>0&&void 0!==arguments[0]&&arguments[0],b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.updateImageTransforms(),a?this.updateFiltersAsync(null,b,c):(this.updateFilters(null),this.updateCanvas())},a.prototype.updateImageTransforms=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.transforms;this.worldTransform.identity(),this.applyImageTransforms(this.source,a,this.tempCanvases,this.worldTransform);var b=[this.transformedWidth,this.transformedHeight],c=b[0],d=b[1];this._transformedImageData=a[a.length-1].imageData,this.assertion(this.transformedImageData)||c===this.transformedWidth&&d===this.transformedHeight||(this._clearCache(),this._emptyPool())},a.prototype.applyImageTransforms=function(a,b,c){for(var d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,e=[a,c[0]],g=e[0],h=e[1],i=b,j=Array.isArray(i),k=0,i=j?i:(0,f.default)(i);;){var l;if(j){if(k>=i.length)break;l=i[k++]}else{if(k=i.next(),k.done)break;l=k.value}if(l.applyTransform(g,h,d)){c.reverse();var m=[h,c[0]];g=m[0],h=m[1]}}return[g,h]},a.prototype.updateFilters=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this._filterAppliedData=this.applyFilters(this._filters,a)},a.prototype.applyFilters=function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,c=a.length;if(0==c)return null;for(var d=void 0,e=void 0,f=b?a.indexOf(b):0,g=this._getCacheImage(f-1),h=g.width,i=g.height;f<c;f++)if(d=a[f]){if(e=this._cache[f]||this._allocImageData(),this.assertion(e))return;d.applyFilter(g,e,0,0,h,i)?(this._cache[f]=e,g=e,e=null):(this._freeImageData(e),this._cache[f]=null)}return g},a.prototype.updateFiltersAsync=function(a,b,c){if(!this._filters||0==this._filters.length)return void c();var d=Math.max(this._filters.indexOf(a),0);this.applyFiltersAsync(d,this._getCacheImage(d-1),b,c)},a.prototype.applyFiltersAsync=function(a,b,c,d){function e(b,d){var e=1/j._filters.length*100;c((b/d+a)*e,100,j._filters[a].name)}function f(){j._debug&&void 0;j._filters.length;j.applyFiltersAsync(a+1,b,c,d)}if(a>=this._filters.length)return this._filterAppliedData=b,void d();var g=this._filters[a];if(!g)return void this.applyFiltersAsync(a+1,c,d);var h=+new Date,i="  "+a+". "+g.name+" : source-"+b.__instanceID+", ",j=this,k=b.width,l=b.height,m=this._cache[a]||this._allocImageData();g.applyFilterAsync(b,m,0,0,k,l,e,f)?(this._cache[a]=m,b=m,m=null):(this._freeImageData(m),this._cache[a]=null,f())},a.prototype.updateCanvas=function(){this.setCanvasSize(this.transformedWidth,this.transformedHeight),this._updatedImageData=this.drawTo(this._filterAppliedData||this.transformedImageData,this._offContext)},a.prototype.drawTo=function(a,b){return b.putImageData(a,0,0,0,0,a.width,a.height),a},a.prototype.getPixel=function(a,b){var c=this._updatedImageData,d=c.data,e=4*(b*c.width+a);return d[e]<<16|d[e+1]<<8|d[e+2]},a.prototype.setPixel=function(a,b,c){var d=this._updatedImageData,e=d.data,f=4*(b*d.width+a),g=c>>16&255,h=c>>8&255,i=255&c;e[f]=g,e[f+1]=h,e[f+2]=i},a.prototype.getPixelv=function(a,b){var c=this._updatedImageData,d=c.data,e=4*(b*c.width+a);return new Uint8Array([d[e],d[e+1],d[e+2]])},a.prototype.setPixelv=function(a,b,c){var d=this._updatedImageData,e=d.data,f=4*(b*d.width+a);e[f]=c[0],e[f+1]=c[1],e[f+2]=c[2]},a.prototype.fillRect=function(a,b,c,d,e){for(var f=Math.max(0,Math.min(a+c,this.width)),g=Math.max(0,Math.min(b+d,this.height)),h=e>>16&255,i=e>>8&255,j=255&e,k=0,l=0,m=this._updatedImageData,n=m.width,o=m.data,p=b;p<g;p++){
k=4*p*n;for(var q=a;q<f;q++)l=k+4*q,o[l]=h,o[l+1]=i,o[l+2]=j}},a.prototype.clone=function(){return(new a).initWithSource(this)},a.prototype._init=function(a){var b=this;this.resizeRatio=.5,this._debug=!1,this._imageDataID=0,this._transformDataID=0,this._offContext=this._makeCanvasContext(a),this.tempCanvases=[document.createElement("canvas"),document.createElement("canvas")],["a","b"].forEach(function(a,c){return b.tempCanvases[c].id="npe-bmpd-temp-canvas-"+a}),this._transformedImageData=null,this._filterAppliedData=null,this._transforms=[],this._filters=[],this._pool=[],this._cache=[],this._worldTransform=new n.default,this._boundary={w:0,h:0},this._event=document.createEvent("CustomEvent"),this._event.initCustomEvent("change",!1,!1,void 0)},a.prototype._makeCanvasContext=function(a){a=a||document.createElement("canvas");var b=null;if(a&&(b=a.getContext("2d")),null==b)throw new Error("CanvasRenderingContext2D 객체를 찾을 수 없습니다. 브라우져의 Canvas 지원 여부를 확인 하세요");return b},a.prototype._drawToCanvas=function(b,c){var d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;null!=d?b.setTransform(d[0],d[1],d[2],d[3],d[4],d[5]):b.setTransform(1,0,0,1,0,0),c instanceof a&&(c=c.canvas),this.bitmapDrawable=c,b.drawImage(c,0,0)},a.prototype._concatMatrix=function(a,b,c){for(var d,e=a.length,f=b.matrix,g=0;g<e;g++)d=a[g],d.onConcat?d.onConcat(c,d):-1!=d.canvasWidth&&(c.w=d.canvasWidth,c.h=d.canvasHeight),d.cacheWidth=c.w,d.cacheHeight=c.h,b.scaleX*=d.scaleX,b.scaleY*=d.scaleY,d.matrix.dirty&&f.preppend(d.matrix);b._changed=!1},a.prototype._getCacheImage=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(a<0)return this.transformedImageData;var b=this._cache[a];return b||this._getCacheImage(a-1)},a.prototype._allocImageData=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,b=void 0;if(0==this._pool.length){if(b=(0,p.createImageData)(this._offContext,this.transformedWidth,this.transformedHeight),this.assertion(b))return null;this._pool.push(b)}return b=this._pool.pop(),a&&b.data.set(a.data),b},a.prototype._freeImageData=function(a){var b=this;null!=a&&(a instanceof Array?a.forEach(function(a){a&&b._pool.push(a)}):this._pool.push(a))},a.prototype._emptyPool=function(){this._pool.length=0},a.prototype._clearCache=function(){this._freeImageData(this._cache),this._cache.length=0},a.prototype.updateTransform=function(){var a=this._boundary,b=this._worldTransform,c=this.tempCanvases[0].getContext("2d"),d=this.source,e=this.transforms,f=this.resizeTransforms;a.w=this.sourceWidth,a.h=this.sourceHeight;var g=this.applyCropTransform(d,c,e,b,a),h=this.applyResizeTransform(g,c,f,b,a);this.isCanvasSizeChanged(h)&&(this._clearCache(),this._emptyPool(),c.canvas.dispatchEvent(this._event)),this._transformedImageData=h,this._filterAppliedData=null},a.prototype.isCanvasSizeChanged=function(a){return a.width!=this.transformedWidth||a.height!=this.transformedHeight},a.prototype.applyCropTransform=function(a,b,c,d,e){return d.identity(),this._concatMatrix(c,d,e),b.canvas.width=e.w,b.canvas.height=e.h,(0,q.transformImage)(a,b,d.matrix.raw),(0,p.getImageData)(b,0,0,b.canvas.width,b.canvas.height)},a.prototype.applyResizeTransform=function(a,b,c,d,e){if(this._concatMatrix(c,d,e),!(e.w!=a.width||e.h!=a.height))return a;b.canvas.width=e.w,b.canvas.height=e.h;var f=(0,p.createImageData)(b,b.canvas.width,b.canvas.height),g={src:a.data,dest:f.data,width:a.width,height:a.height,toWidth:f.width,toHeight:f.height};return(0,r.resizeBuffer)(g,function(a,b){return"complete"}),f},(0,l.default)(a,[{key:"transforms",get:function(){return this._transforms},set:function(a){this._transforms=a}},{key:"resizeTransforms",get:function(){return this._resizeTransforms}},{key:"transformedImageData",get:function(){return this._transformedImageData}},{key:"filters",get:function(){return this._filters},set:function(a){this._filters=a||[],this._clearCache()}},{key:"showOriginal",get:function(){return this._showOriginal||!1},set:function(a){if(this._showOriginal!=a){this._showOriginal=a;var b=a?this.transformedImageData:this._filterAppliedData||this.transformedImageData;this.drawTo(b,this._offContext)}}},{key:"width",get:function(){return this.canvas.width||this.canvas.naturalWidth}},{key:"height",get:function(){return this.canvas.height||this.canvas.naturalHeight}},{key:"canvas",get:function(){return this._offContext.canvas}},{key:"originalCanvas",get:function(){return this._orgContext?this._orgContext.canvas:null}},{key:"source",get:function(){return this._sourceImage||this.originalCanvas}},{key:"sourceWidth",get:function(){return this.source?this.source.width||this.source.naturalWidth:0}},{key:"sourceHeight",get:function(){return this.source?this.source.height||this.source.naturalHeight:0}},{key:"transformedWidth",get:function(){return this.transformedImageData?this.transformedImageData.width:this.sourceWidth}},{key:"transformedHeight",get:function(){return this.transformedImageData?this.transformedImageData.height:this.sourceHeight}},{key:"image",get:function(){var a=document.createElement("img");return a.src=this.canvas.toDataURL("image/png"),a}},{key:"worldTransform",get:function(){return this._worldTransform}}]),a}());b.default=u},function(a,b,c){"use strict";a.exports=c(382)()?Object.assign:c(383)},function(a,b,c){"use strict";var d,e=c(204),f=c(145),g=c(41),h=c(35),i=c(58),j=c(399),k=c(49),l=Object.defineProperty,m=Object.defineProperties;a.exports=d=function(a,b){if(!(this instanceof d))throw new TypeError("Constructor requires 'new'");m(this,{__list__:i("w",h(a)),__context__:i("w",b),__nextIndex__:i("w",0)}),b&&(g(b.on),b.on("_add",this._onAdd),b.on("_delete",this._onDelete),b.on("_clear",this._onClear))},delete d.prototype.constructor,m(d.prototype,f({_next:i(function(){var a;if(this.__list__)return this.__redo__&&void 0!==(a=this.__redo__.shift())?a:this.__nextIndex__<this.__list__.length?this.__nextIndex__++:void this._unBind()}),next:i(function(){return this._createResult(this._next())}),_createResult:i(function(a){return void 0===a?{done:!0,value:void 0}:{done:!1,value:this._resolve(a)}}),_resolve:i(function(a){return this.__list__[a]}),_unBind:i(function(){this.__list__=null,delete this.__redo__,this.__context__&&(this.__context__.off("_add",this._onAdd),this.__context__.off("_delete",this._onDelete),this.__context__.off("_clear",this._onClear),this.__context__=null)}),toString:i(function(){return"[object "+(this[k.toStringTag]||"Object")+"]"})},j({_onAdd:i(function(a){if(!(a>=this.__nextIndex__)){if(++this.__nextIndex__,!this.__redo__)return void l(this,"__redo__",i("c",[a]));this.__redo__.forEach(function(b,c){b>=a&&(this.__redo__[c]=++b)},this),this.__redo__.push(a)}}),_onDelete:i(function(a){var b;a>=this.__nextIndex__||(--this.__nextIndex__,this.__redo__&&(b=this.__redo__.indexOf(a),-1!==b&&this.__redo__.splice(b,1),this.__redo__.forEach(function(b,c){b>a&&(this.__redo__[c]=--b)},this)))}),_onClear:i(function(){this.__redo__&&e.call(this.__redo__),this.__nextIndex__=0})}))),l(d.prototype,k.iterator,i(function(){return this}))},function(a,b,c){a.exports=!c(27)&&!c(50)(function(){return 7!=Object.defineProperty(c(103)("div"),"a",{get:function(){return 7}}).a})},function(a,b,c){a.exports=c(43)},function(a,b,c){var d=c(28),e=c(29),f=c(68);a.exports=c(27)?Object.defineProperties:function(a,b){e(a);for(var c,g=f(b),h=g.length,i=0;h>i;)d.f(a,c=g[i++],b[c]);return a}},function(a,b,c){var d=c(51),e=c(59),f=c(222)(!1),g=c(110)("IE_PROTO");a.exports=function(a,b){var c,h=e(a),i=0,j=[];for(c in h)c!=g&&d(h,c)&&j.push(c);for(;b.length>i;)d(h,c=b[i++])&&(~f(j,c)||j.push(c));return j}},function(a,b,c){var d=c(18).document;a.exports=d&&d.documentElement},function(a,b){a.exports=function(a,b){return{value:b,done:!!a}}},function(a,b,c){"use strict";var d=c(18),e=c(51),f=c(27),g=c(13),h=c(148),i=c(114).KEY,j=c(50),k=c(111),l=c(70),m=c(85),n=c(19),o=c(113),p=c(115),q=c(228),r=c(154),s=c(29),t=c(26),u=c(59),v=c(104),w=c(81),x=c(84),y=c(155),z=c(157),A=c(28),B=c(68),C=z.f,D=A.f,E=y.f,F=d.Symbol,G=d.JSON,H=G&&G.stringify,I=n("_hidden"),J=n("toPrimitive"),K={}.propertyIsEnumerable,L=k("symbol-registry"),M=k("symbols"),N=k("op-symbols"),O=Object.prototype,P="function"==typeof F,Q=d.QObject,R=!Q||!Q.prototype||!Q.prototype.findChild,S=f&&j(function(){return 7!=x(D({},"a",{get:function(){return D(this,"a",{value:7}).a}})).a})?function(a,b,c){var d=C(O,b);d&&delete O[b],D(a,b,c),d&&a!==O&&D(O,b,d)}:D,T=function(a){var b=M[a]=x(F.prototype);return b._k=a,b},U=P&&"symbol"==typeof F.iterator?function(a){return"symbol"==typeof a}:function(a){return a instanceof F},V=function(a,b,c){return a===O&&V(N,b,c),s(a),b=v(b,!0),s(c),e(M,b)?(c.enumerable?(e(a,I)&&a[I][b]&&(a[I][b]=!1),c=x(c,{enumerable:w(0,!1)})):(e(a,I)||D(a,I,w(1,{})),a[I][b]=!0),S(a,b,c)):D(a,b,c)},W=function(a,b){s(a);for(var c,d=q(b=u(b)),e=0,f=d.length;f>e;)V(a,c=d[e++],b[c]);return a},X=function(a,b){return void 0===b?x(a):W(x(a),b)},Y=function(a){var b=K.call(this,a=v(a,!0));return!(this===O&&e(M,a)&&!e(N,a))&&(!(b||!e(this,a)||!e(M,a)||e(this,I)&&this[I][a])||b)},Z=function(a,b){if(a=u(a),b=v(b,!0),a!==O||!e(M,b)||e(N,b)){var c=C(a,b);return!c||!e(M,b)||e(a,I)&&a[I][b]||(c.enumerable=!0),c}},$=function(a){for(var b,c=E(u(a)),d=[],f=0;c.length>f;)e(M,b=c[f++])||b==I||b==i||d.push(b);return d},_=function(a){for(var b,c=a===O,d=E(c?N:u(a)),f=[],g=0;d.length>g;)!e(M,b=d[g++])||c&&!e(O,b)||f.push(M[b]);return f};P||(F=function(){if(this instanceof F)throw TypeError("Symbol is not a constructor!");var a=m(arguments.length>0?arguments[0]:void 0),b=function(c){this===O&&b.call(N,c),e(this,I)&&e(this[I],a)&&(this[I][a]=!1),S(this,a,w(1,c))};return f&&R&&S(O,a,{configurable:!0,set:b}),T(a)},h(F.prototype,"toString",function(){return this._k}),z.f=Z,A.f=V,c(156).f=y.f=$,c(89).f=Y,c(116).f=_,f&&!c(83)&&h(O,"propertyIsEnumerable",Y,!0),o.f=function(a){return T(n(a))}),g(g.G+g.W+g.F*!P,{Symbol:F});for(var aa="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ba=0;aa.length>ba;)n(aa[ba++]);for(var ca=B(n.store),da=0;ca.length>da;)p(ca[da++]);g(g.S+g.F*!P,"Symbol",{"for":function(a){return e(L,a+="")?L[a]:L[a]=F(a)},keyFor:function(a){if(!U(a))throw TypeError(a+" is not a symbol!");for(var b in L)if(L[b]===a)return b},useSetter:function(){R=!0},useSimple:function(){R=!1}}),g(g.S+g.F*!P,"Object",{create:X,defineProperty:V,defineProperties:W,getOwnPropertyDescriptor:Z,getOwnPropertyNames:$,getOwnPropertySymbols:_}),G&&g(g.S+g.F*(!P||j(function(){var a=F();return"[null]"!=H([a])||"{}"!=H({a:a})||"{}"!=H(Object(a))})),"JSON",{stringify:function(a){for(var b,c,d=[a],e=1;arguments.length>e;)d.push(arguments[e++]);if(c=b=d[1],(t(b)||void 0!==a)&&!U(a))return r(b)||(b=function(a,b){if("function"==typeof c&&(b=c.call(this,a,b)),!U(b))return b}),d[1]=b,H.apply(G,d)}}),F.prototype[J]||c(43)(F.prototype,J,F.prototype.valueOf),l(F,"Symbol"),l(Math,"Math",!0),l(d.JSON,"JSON",!0)},function(a,b,c){var d=c(69);a.exports=Array.isArray||function(a){return"Array"==d(a)}},function(a,b,c){var d=c(59),e=c(156).f,f={}.toString,g="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],h=function(a){try{return e(a)}catch(b){return g.slice()}};a.exports.f=function(a){return g&&"[object Window]"==f.call(a)?h(a):e(d(a))}},function(a,b,c){var d=c(150),e=c(112).concat("length","prototype");b.f=Object.getOwnPropertyNames||function(a){return d(a,e)}},function(a,b,c){var d=c(89),e=c(81),f=c(59),g=c(104),h=c(51),i=c(147),j=Object.getOwnPropertyDescriptor;b.f=c(27)?j:function(a,b){if(a=f(a),b=g(b,!0),i)try{return j(a,b)}catch(c){}if(h(a,b))return e(!d.f.call(a,b),a[b])}},function(a,b,c){var d=c(118),e=c(19)("iterator"),f=c(67);a.exports=c(9).getIteratorMethod=function(a){if(void 0!=a)return a[e]||a["@@iterator"]||f[d(a)]}},function(a,b,c){var d=c(29),e=c(65),f=c(19)("species");a.exports=function(a,b){var c,g=d(a).constructor;return void 0===g||void 0==(c=d(g)[f])?b:e(c)}},function(a,b){a.exports=function(a){try{return{e:!1,v:a()}}catch(b){return{e:!0,v:b}}}},function(a,b,c){var d=c(29),e=c(26),f=c(121);a.exports=function(a,b){if(d(a),e(b)&&b.constructor===a)return b;var c=f.f(a);return(0,c.resolve)(b),c.promise}},function(a,b,c){"use strict";var d=c(18),e=c(9),f=c(28),g=c(27),h=c(19)("species");a.exports=function(a){var b="function"==typeof e[a]?e[a]:d[a];g&&b&&!b[h]&&f.f(b,h,{configurable:!0,get:function(){return this}})}},function(a,b,c){"use strict";b.__esModule=!0;var d=c(5),e=function(a){return a&&a.__esModule?a:{"default":a}}(d),f=[],g={clear:function(){f=[]},action:function(a,b){var c=e.default.Deferred();return f.push({type:a,defer:c}),b&&b(),c},callback:function(a,b){var c=void 0;f.forEach(function(b,d){c||b.type!==a||(c=f.splice(d,1)[0])}),c&&c.defer.resolve(b)}};b.default=g},function(a,b,c){"use strict";b.__esModule=!0,b.default={txt_filter:"Filter",txt_crop:"Crop, Rotate",txt_resize:"Size",txt_adjust:"Adjust",txt_mosaic:"Mosaic",txt_signature:"Signature",txt_text:"Text",txt_sticker:"Sticker",txt_clip:"Mask",txt_frame:"Frame",txt_return_origin:"Original",txt_cancel:"Cancel",txt_done:"Complete",txt_apply:"Apply",txt_open:"Open",txt_close:"Close",txt_undo:"Undo",txt_redo:"Redo",txt_image_save:"Save",txt_image_list:"Image List",txt_none_apply:"Do not apply",txt_original:"Original",txt_max:"Maximum",txt_optimum:"Optimum",txt_original_size:"Original Size",txt_filter_original:"Original",txt_filter_clear:"Clear",txt_filter_bright:"Bright",txt_filter_cream:"Cream",txt_filter_delight:"Delight",txt_filter_blossom:"Blossom",txt_filter_warm:"Warm",txt_filter_lollipop:"Lollipop",txt_filter_candy:"Candy",txt_filter_mint:"Mint",txt_filter_cool:"Cool",txt_filter_cobalt:"Cobalt",txt_filter_classic:"Classic",txt_filter_vintage:"Vintage",txt_filter_urban:"Urban",txt_filter_chic:"Chic",txt_filter_blank:"Blank",txt_filter_tintp:"Tint P",txt_filter_tinty:"Tint Y",txt_frame_1:"White Frame",txt_frame_2:"Black Frame",txt_frame_3:"Round Frame",txt_frame_4:"Old Frame",txt_frame_5:"Paper Frame",txt_frame_6:"Transparent Edge",txt_reset:"Reset",txt_rotate:"Rotate",txt_flip_horizon:"Flip Horizontal",txt_flip_vertical:"Flip Vertical",txt_original_ratio:"Original",txt_free_ratio:"Free",txt_16_9_ratio:"16:9",txt_3_2_ratio:"3:2",txt_4_3_ratio:"4:3",txt_1_1_ratio:"1:1",txt_3_4_ratio:"3:4",txt_2_3_ratio:"2:3",txt_9_16_ratio:"9:16",txt_mask_oval:"원",txt_mask_triangle:"삼각",txt_mask_round_square:"둥근사각",txt_mask_polygon:"다각",txt_mask_star1:"별1",txt_mask_star2:"별2",txt_mask_round_star:"둥근별",txt_confirm:"OK",txt_auto_adjustment:"Auto Adjust",txt_brightness:"Brightness",txt_saturation:"Saturation",txt_sharpen:"Sharpen",txt_kelvin:"Temperature",txt_contrast:"Contrast",txt_square:"Square",txt_circle:"Circle",txt_none_signature:"No Signature",txt_image_signature:"Image Signature",txt_text_signature:"Text Signature",txt_notice_compare:"Press the image<br>to compare with the original",txt_notice_resize:"You can't make it bigger than the original",txt_notice_crop_minimum:"'You can't crop small images (less than 60*60px). You can only rotate it 90°.",txt_notice_has_thumbnail:"Images are saved in 3000px maximum",txt_direct:"Manual entry",txt_auto:"AUTO",txt_apply_all:"All Photos",txt_apply_select:"Selected Photos",txt_signature_image_input:"Less than 400x200px, 200kb",txt_signature_image_load:"Import",txt_signature_opacity:"Transparency",txt_signature_size:"Size",txt_all:"All",txt_selected:"Selected",txt_notice_resize_apply:"The image width has been changed to %spx.",txt_notice_resize_apply_exception:"<br />However, if the original is smaller, its original size will be maintained.",txt_notice_resize_apply_exception_by_type:"<br />However, if the original is small, its original size will be maintained and %s will be exempted.",txt_notice_apply_exception_by_type:"<br />However, %s will be exempted.",txt_animation_gif:"GIF",txt_vr360:"360 VR Image",txt_panorama:"Panorama Image",txt_alert_ok:"OK",txt_alert_cancel:"Cancel",txt_alert_try:"Could you try again?",txt_alert_error:"Oops, an error has occurred!",txt_alert_out_of_memory:"Too many photos for browser memory.<br />Please restart the browser.",txt_confirm_close_tit:"Would you like to cancel editing?",txt_confirm_close_desc:"Changes have not been saved.",txt_confirm_crop_tit:"Would you like to save changes made during Crop?",txt_confirm_save_crop_tit:"Would you like to save changes made during Crop?",txt_confirm_clip_tit:"마스크에서 편집한 내용을 저장하시겠습니까?",txt_confirm_save_clip_tit:"마스크에서 편집한 내용도 저장하시겠습니까?",txt_notice_file_type_error:"File Format Error",txt_notice_animation_gif:"Image editing isn't available for GIFs.",txt_notice_vr360:"Editing isn't available for 360 VR images.",txt_notice_panorama:"Editing isn't available for panorama images.",txt_notice_signature_image_size:"Only available for photos less than 400x200px, 200KB.",txt_notice_signature_image_type_error:"Only JPG, JPEG, GIF, PNG, and BMP are supported.",txt_notice_signature_apply_none:"The signature has been removed from the photo.",txt_notice_signature_apply_image:"The image signature has been applied to the photo.",txt_notice_signature_apply_text:"The text signature has been applied to the photo.",txt_notice_filter_apply_none:"The filter has been removed from the photo.",txt_notice_filter_apply:"The filter has been applied to the photo.",txt_notice_frame_apply_none:"The frame has been removed from the photo.",txt_notice_frame_apply:"The frame has been applied to the photo.",txt_signature_text_placeholder:"Up to 21 Korean letters or 42 English letters.",txt_add_text:"Add Text",txt_edit_order:"Change Order",txt_apply_edit_order:"Apply",txt_reverse:"Reverse Order",txt_image_load_fail:"Unable to import the selected photo(s) due to error.",txt_editor_sort_tooltip:"You can change the order of images by dragging them. The changes will also apply to the order of images attached on Editor.",txt_choice_photos_apply:"Please select photos to apply",txt_drag_photos:"Drag a photo to change the order. The changes will also apply to the order of the photos attached on the document.",txt_facebook:"Facebook",txt_instagram:"Instagram",txt_pholar:"Pholar",txt_mypc:"My Computer",txt_navercloud:"NAVER Cloud",txt_dont_see_again:"Don't show me this again",txt_selected_count:'<em class="now_num">6</em> selected',txt_fill_the_screen:"Screen Fit",txt_font_default:"Default Font",txt_font_nanumgothic:"Nanum Gothic",txt_font_nanummyeongjo:"Nanum Myeongjo",txt_font_nanumbarungothic:"Barun Gothic",txt_input_text:"Please enter contents.",image_upload_error_key_expired:"Session Expired",image_upload_error_client:"Client Error",image_upload_error_system:"Unclassified Server Error",image_upload_error_login:"Please sign in.",image_upload_error_fail_to_load_iframe:'Failed to load "phup_frame.html" on ifram',image_upload_error_fail_to_get_session_key:'Failed to load "upload session key value"',image_upload_error_broken_image:"Broken Image (image file format that cannot be read)",image_upload_error_unknown_broken_image:"Broken Image (not an image file format)",image_upload_error_unsupported_image:"Image format not supported",image_upload_error_unsupported_extension:"In case of unauthorized extension",image_upload_error_abuse:"Detected as abuser; upload restricted",image_upload_error_limitation_by_session_count:"Exceeded maximum number of uploads per session",image_upload_error_limitation_by_session_size:"Exceeded maximum size of uploads per session",image_upload_error_limitation_by_image:"Restricted image size",image_upload_error_limitation_by_width_height:"Restricted image width or height",image_upload_error_limitation_by_resolution:"Restricted image area",image_upload_error_limitation_by_aspect_ratio:"Restricted image ratio",image_upload_error_invalid_parameter:"Call Error",image_upload_error_illegal_state:"Call Order Error; in case of saving images that are not uploaded",image_upload_error_file_overwrite_fail:"Overwrite Error",image_upload_error_fail_convert_bmp2png_fail:"Failed to convert file",image_upload_error_config:"Server Internal Settings Load Error",image_upload_error_fail_file_copy:"Failed to upload final edited file",image_upload_error_fail_resize:"File Conversion Error"}},function(a,b,c){"use strict";b.__esModule=!0,b.default={txt_filter:"Filtrer",txt_crop:"Rogner, tourner",txt_resize:"Taille",txt_adjust:"Ajuster",txt_mosaic:"Mosaïque",txt_signature:"Signature",txt_text:"Texte",txt_sticker:"Sticker",txt_clip:"Mask",txt_frame:"Cadre",txt_return_origin:"Retour à l'original",txt_cancel:"Annuler",txt_done:"Terminer",txt_apply:"Appliquer",txt_open:"Ouvrir",txt_close:"Fermer",txt_undo:"Défaire",txt_redo:"Refaire",txt_image_save:"Sauvegarder",txt_image_list:"Liste d'images",txt_none_apply:"Ne pas appliquer",txt_original:"Original",txt_max:"Maximal",txt_optimum:"Optimal",txt_original_size:"Taille originale",txt_filter_original:"Original",txt_filter_clear:"Clear",txt_filter_bright:"Bright",txt_filter_cream:"Cream",txt_filter_delight:"Delight",txt_filter_blossom:"Blossom",txt_filter_warm:"Warm",txt_filter_lollipop:"Lollipop",txt_filter_candy:"Candy",txt_filter_mint:"Mint",txt_filter_cool:"Cool",txt_filter_cobalt:"Cobalt",txt_filter_classic:"Classic",txt_filter_vintage:"Vintage",txt_filter_urban:"Urban",txt_filter_chic:"Chic",txt_filter_blank:"Blank",txt_filter_tintp:"Tint P",txt_filter_tinty:"Tint Y",txt_frame_1:"Cadre blanc",txt_frame_2:"Cadre noir",txt_frame_3:"Cadre rond",txt_frame_4:"Vieux cadre",txt_frame_5:"Cadre papier",txt_frame_6:"Bords transparents",txt_reset:"Réinitialiser",txt_rotate:"Tourner",txt_flip_horizon:"Flip horizontal",txt_flip_vertical:"Flip vertical",txt_original_ratio:"Original",txt_free_ratio:"Libre",txt_16_9_ratio:"16:9",txt_3_2_ratio:"3:2",txt_4_3_ratio:"4:3",txt_1_1_ratio:"1:1",txt_3_4_ratio:"3:4",txt_2_3_ratio:"2:3",txt_9_16_ratio:"9:16",txt_mask_oval:"원",txt_mask_triangle:"삼각",txt_mask_round_square:"둥근사각",txt_mask_polygon:"다각",txt_mask_star1:"별1",txt_mask_star2:"별2",txt_mask_round_star:"둥근별",txt_confirm:"OK",txt_auto_adjustment:"Auto adjust",txt_brightness:"Luminosité",txt_saturation:"Saturation",txt_sharpen:"Netteté",txt_kelvin:"Température",txt_contrast:"Contraste",txt_square:"Carré",txt_circle:"Cercle",txt_none_signature:"Aucune signature",txt_image_signature:"Signature d'image",txt_text_signature:"Signature de texte",txt_notice_compare:"Appuyez sur l'image<br>pour la comparer avec l'originale.",txt_notice_resize:"Vous ne pouvez pas le rendre plus gros que l'original.",txt_notice_crop_minimum:"Vous ne pouvez pas rogner les petites images (moins de 60x60 px.). Vous pouvez uniquement les tourner de 90°.",txt_notice_has_thumbnail:"Les images sont enregistrées à 3 000 px. Maximum.",txt_direct:"Saisie manuelle",txt_auto:"AUTO",txt_apply_all:"Toutes les photos",txt_apply_select:"Photos sélectionnées",txt_signature_image_input:"Moins de 400x200 px., 200 Ko",txt_signature_image_load:"Importer",txt_signature_opacity:"Transparence",txt_signature_size:"Taille",txt_all:"Tout",txt_selected:"Sélectionné",txt_notice_resize_apply:"La largeur de l'image a été changée en %s px.",txt_notice_resize_apply_exception:"<br />Cependant, si l'original est plus petite, sa taille originale sera conservée.",txt_notice_resize_apply_exception_by_type:"<br />Cependant, si l'original est plus petite, sa taille originale sera conservée et %s ne sera pas pris en compte.",txt_notice_apply_exception_by_type:"<br />Cependant, %s ne sera pas pris en compte.",txt_animation_gif:"GIF",txt_vr360:"Image 360 VR",txt_panorama:"Image panorama",txt_alert_ok:"OK",txt_alert_cancel:"Annuler",txt_alert_try:"Pourriez-vous réessayer ?",txt_alert_error:"Oups, une erreur est survenue !",txt_alert_out_of_memory:"Trop de photos pour la mémoire du navigateur.<br />Veuillez redémarrer le navigateur.",txt_confirm_close_tit:"Voulez-vous annuler la modification ?",txt_confirm_close_desc:"Les modifications n'ont pas été enregistrées.",txt_confirm_crop_tit:"Voulez-vous sauvegarder les modifications faites pendant le rognage ?",txt_confirm_save_crop_tit:"Voulez-vous sauvegarder les modifications faites pendant le rognage ?",txt_confirm_clip_tit:"마스크에서 편집한 내용을 저장하시겠습니까?",txt_confirm_save_clip_tit:"마스크에서 편집한 내용도 저장하시겠습니까?",txt_notice_file_type_error:"Erreur de format de fichier",txt_notice_animation_gif:"La modification d'images n'est pas disponible pour les GIF.",txt_notice_vr360:"La modification n'est pas disponible pour les images 360 VR.",txt_notice_panorama:"La modification n'est pas disponible pour les images panorama.",txt_notice_signature_image_size:"Uniquement disponible pour les photos de moins de 400x200 px., 200 Ko.",txt_notice_signature_image_type_error:"Seuls les JPG, JPEG, GIF, PNG et BMP sont pris en charge.",txt_notice_signature_apply_none:"La signature a été enlevée de la photo.",txt_notice_signature_apply_image:"La signature de l'image a été appliquée à la photo.",txt_notice_signature_apply_text:"La signature du texte a été appliquée à la photo.",txt_notice_filter_apply_none:"Le filtre a été enlevé de la photo.",txt_notice_filter_apply:"Le filtre a été appliqué à la photo.",txt_notice_frame_apply_none:"Le cadre a été enlevé de la photo.",txt_notice_frame_apply:"Le cadre a été appliqué à la photo.",txt_signature_text_placeholder:"Jusqu'à 21 caractères coréens ou 42 caractère anglais.",txt_add_text:"Ajouter du texte",txt_edit_order:"Modifier l'ordre",txt_apply_edit_order:"Appliquer",txt_reverse:"Inverser l'ordre",txt_image_load_fail:"Impossible d'importe les photos sélectionnées en raison d'une erreur.",txt_editor_sort_tooltip:"Vous pouvez modifier l'ordre des images en les tirant. Les modifications d'appliqueront également à l'ordre des images jointes sur Editor.",txt_choice_photos_apply:"Veuillez sélectionner des photos pour appliquer.",txt_drag_photos:"Tirez une photo pour changer l'ordre. Les modifications s'appliqueront aussi à l'ordre des photos jointes au document.",txt_facebook:"Facebook",txt_instagram:"Instagram",txt_pholar:"Pholar",txt_mypc:"Mon ordinateur",txt_navercloud:"NAVER Cloud",txt_dont_see_again:"Ne plus afficher ce message",txt_selected_count:'<em class="now_num">6</em> sélectionnées',txt_fill_the_screen:"Ajuster à l'écran",txt_font_default:"Police par défaut",txt_font_nanumgothic:"Nanum Gothic",txt_font_nanummyeongjo:"Nanum Myeongjo",txt_font_nanumbarungothic:"Barun Gothic",txt_input_text:"Veuillez saisir du contenu.",image_upload_error_key_expired:"Session expirée",image_upload_error_client:"Erreur du client",image_upload_error_system:"Erreur du serveur non classifiée",image_upload_error_login:"Se connecter",image_upload_error_fail_to_load_iframe:"Échec du chargement de phup_frame.html sur ifram",image_upload_error_fail_to_get_session_key:'Échec du chargement de  "upload session key value"',image_upload_error_broken_image:"Image illisible (format de fichier de l'image illisible)",image_upload_error_unknown_broken_image:"Image illisible (n'est pas un format de fichier d'image)",image_upload_error_unsupported_image:"'Format d'image non pris en charge",image_upload_error_unsupported_extension:"En case d'une extension non autorisée",image_upload_error_abuse:"Abus détecté ; téléchargement restreint",image_upload_error_limitation_by_session_count:"Nombre maximal de téléchargements par sessions atteint",image_upload_error_limitation_by_session_size:"Taille maximale de téléchargements par session atteinte",image_upload_error_limitation_by_image:"Taille d'image restreinte",image_upload_error_limitation_by_width_height:"Hauteur ou largeur d'image restreinte",image_upload_error_limitation_by_resolution:"Zone d'image restreinte",image_upload_error_limitation_by_aspect_ratio:"Ratio d'image restreint",image_upload_error_invalid_parameter:"Erreur d'appel",image_upload_error_illegal_state:"Erreur d'appel d'ordre ; en cas de sauvegarde d'images non téléchargées",image_upload_error_file_overwrite_fail:"Erreur d'écrasement",image_upload_error_fail_convert_bmp2png_fail:"Échec de conversion du fichier",image_upload_error_config:"Erreur de téléchargement des paramètres internes du serveur",image_upload_error_fail_file_copy:"Échec du téléchargement du fichier final modifié",image_upload_error_fail_resize:"Échec de conversion du fichier"}},function(a,b,c){"use strict";b.__esModule=!0,b.default={txt_filter:"フィルター",txt_crop:"トリミング、回転",txt_resize:"サイズ",txt_adjust:"補正",txt_mosaic:"モザイク",txt_signature:"署名",txt_text:"テキスト",txt_sticker:"スタンプ",txt_clip:"Mask",txt_frame:"フレーム",txt_return_origin:"元に戻す",txt_cancel:"取消",txt_done:"完了",txt_apply:"適用",txt_open:"開く",txt_close:"閉じる",txt_undo:"前へ",txt_redo:"もう一度",txt_image_save:"保存",txt_image_list:"画像リスト",txt_none_apply:"適用しない",txt_original:"オリジナル",txt_max:"最大",txt_optimum:"最適",txt_original_size:"オリジナルサイズ",txt_filter_original:"Original",txt_filter_clear:"Clear",txt_filter_bright:"Bright",txt_filter_cream:"Cream",txt_filter_delight:"Delight",txt_filter_blossom:"Blossom",txt_filter_warm:"Warm",txt_filter_lollipop:"Lollipop",txt_filter_candy:"Candy",txt_filter_mint:"Mint",txt_filter_cool:"Cool",txt_filter_cobalt:"Cobalt",txt_filter_classic:"Classic",txt_filter_vintage:"Vintage",txt_filter_urban:"Urban",txt_filter_chic:"Chic",txt_filter_blank:"Blank",txt_filter_tintp:"Tint P",txt_filter_tinty:"Tint Y",txt_frame_1:"白枠",txt_frame_2:"黒枠",txt_frame_3:"角丸",txt_frame_4:"レトロ",txt_frame_5:"ペーパー",txt_frame_6:"透明な角",txt_reset:"再設定",txt_rotate:"回転",txt_flip_horizon:"左右反転",txt_flip_vertical:"上下反転",txt_original_ratio:"オリジナル",txt_free_ratio:"自由",txt_16_9_ratio:"16:9",txt_3_2_ratio:"3:2",txt_4_3_ratio:"4:3",txt_1_1_ratio:"1:1",txt_3_4_ratio:"3:4",txt_2_3_ratio:"2:3",txt_9_16_ratio:"9:16",txt_mask_oval:"원",txt_mask_triangle:"삼각",txt_mask_round_square:"둥근사각",txt_mask_polygon:"다각",txt_mask_star1:"별1",txt_mask_star2:"별2",txt_mask_round_star:"둥근별",txt_confirm:"確認",txt_auto_adjustment:"自動補正",txt_brightness:"明るさ",txt_saturation:"彩度",txt_sharpen:"コントラスト",txt_kelvin:"色温度",txt_contrast:"対比",txt_square:"四角",txt_circle:"円形",txt_none_signature:"署名しない",txt_image_signature:"イメージ署名",txt_text_signature:"テキスト署名",txt_notice_compare:"画像にタッチすると<br>オリジナルと比較できます。",txt_notice_resize:"オリジナルより大きいサイズに変更することはできません。",txt_notice_crop_minimum:"小さい画像(60×60px未満)は、トリミングメニューを使用することができません。90°回転のみ使用できます。",txt_notice_has_thumbnail:"画像サイズは最大3000pxまで保存できます。",txt_direct:"直接入力",txt_auto:"自動",txt_apply_all:"全ての写真",txt_apply_select:"一部の写真",txt_signature_image_input:"400×200ｐｘ、200kb以下",txt_signature_image_load:"読み込む",txt_signature_opacity:"透明度",txt_signature_size:"サイズ",txt_all:"すべての",txt_selected:"選択された",txt_notice_resize_apply:"画像の幅が%spxに変更されました。",txt_notice_resize_apply_exception:"<br />ただし、オリジナルがこのサイズより小さい場合はオリジナルサイズが維持されます。",txt_notice_resize_apply_exception_by_type:"<br />ただし、オリジナルがこのサイズより小さい場合はオリジナルサイズが維持され、%sは対象外となります。",txt_notice_apply_exception_by_type:"<br />ただし、%sは対象外となります。",txt_animation_gif:"GIFアニメーション",txt_vr360:"360°VR画像",txt_panorama:"パノラマ画像",txt_alert_ok:"確認",txt_alert_cancel:"取消",txt_alert_try:"リトライしますか？",txt_alert_error:"エラーが発生しました。",txt_alert_out_of_memory:"画像の枚数が多いため、ブラウザのメモリーが足りません。<br />ブラウザを再起動してください。",txt_confirm_close_tit:"編集を取消しますか？",txt_confirm_close_desc:"変更内容は保存されません。",txt_confirm_crop_tit:"トリミングで編集した内容を保存しますか？",txt_confirm_save_crop_tit:"トリミングで編集した内容も保存しますか？",txt_confirm_clip_tit:"마스크에서 편집한 내용을 저장하시겠습니까?",txt_confirm_save_clip_tit:"마스크에서 편집한 내용도 저장하시겠습니까?",txt_notice_file_type_error:"ファイル形式エラー",txt_notice_animation_gif:"GIFアニメーションの編集機能は提供しておりません。",txt_notice_vr360:"360°VR画像の編集機能は提供しておりません。",txt_notice_panorama:"パノラマ画像の編集機能は提供しておりません。",txt_notice_signature_image_size:"400×200px、200kb以下の画像のみ使用できます。",txt_notice_signature_image_type_error:"JPG・JPEG・GIF・PNG・BMP形式のみ対応します。",txt_notice_signature_apply_none:"画像から署名を削除しました。",txt_notice_signature_apply_image:"画像にイメージ署名が適用されました。",txt_notice_signature_apply_text:"画像にテキスト署名が適用されました。",txt_notice_filter_apply_none:"画像からフィルターを消しました。",txt_notice_filter_apply:"画像にフィルターを適用しました。",txt_notice_frame_apply_none:"画像からフレームを消しました。",txt_notice_frame_apply:"画像にフレームを適用しました。",txt_signature_text_placeholder:"全角最大２１文字、半角４２文字",txt_add_text:"テキスト追加",
txt_edit_order:"順序編集",txt_apply_edit_order:"適用",txt_reverse:"逆順に",txt_image_load_fail:"選択した画像にエラーがあるため読み込めません。",txt_editor_sort_tooltip:"ドラッグして画像の順序を変更できます。変更するとエディターに添付された画像の順序も同時に変更されます。",txt_choice_photos_apply:"適用する画像を選択してください。",txt_drag_photos:"画像をドラッグして順序を変更できます。投稿に添付された画像の順序も同時に変更されます。",txt_facebook:"Facebook",txt_instagram:"Instagram",txt_pholar:"PHOLAR",txt_mypc:"マイコンピュータ",txt_navercloud:"NAVER Cloud",txt_dont_see_again:"これ以上表示しない",txt_selected_count:'<em class="now_num">6</em>枚選択',txt_fill_the_screen:"画像調整",txt_font_default:"デフォルトフォント",txt_font_nanumgothic:"NanumGothic",txt_font_nanummyeongjo:"NanumMyeongjo",txt_font_nanumbarungothic:"Barun Gothic",txt_input_text:"内容を入力してください。",image_upload_error_key_expired:"セッション満了",image_upload_error_client:"クライアントエラー",image_upload_error_system:"未分類サーバーエラー",image_upload_error_login:"ログインが必要です。",image_upload_error_fail_to_load_iframe:"phup_frame.htmlファイルをiframに読み込めない",image_upload_error_fail_to_get_session_key:"アップロードセッションキー値を読み込めない",image_upload_error_broken_image:"画像エラー(画像ファイル形式だけど読み込めない)",image_upload_error_unknown_broken_image:"画像エラー(画像ファイル形式ではない)",image_upload_error_unsupported_image:"対応していない画像ファイル形式",image_upload_error_unsupported_extension:"許可されていない拡張子の場合",image_upload_error_abuse:"アビューズ行為が検知されたため、アップロードを制限",image_upload_error_limitation_by_session_count:"１つのセッションにおけるアップロード数の上限を超過",image_upload_error_limitation_by_session_size:"１つのセッションにおけるアップロード容量の上限を超過",image_upload_error_limitation_by_image:"画像の容量制限に引っかかる",image_upload_error_limitation_by_width_height:"画像の幅、もしくは高さの制限に引っかかる",image_upload_error_limitation_by_resolution:"画像の面積制限に引っかかる",image_upload_error_limitation_by_aspect_ratio:"画像の比率制限に引っかかる",image_upload_error_invalid_parameter:"呼び出しエラー",image_upload_error_illegal_state:"呼び出し順序エラー、アップロードされていない画像を保存した場合",image_upload_error_file_overwrite_fail:"上書きエラー",image_upload_error_fail_convert_bmp2png_fail:"ファイル変換に失敗",image_upload_error_config:"サーバー内部設定読み込みエラー",image_upload_error_fail_file_copy:"編集した最終ファイルのアップロードに失敗",image_upload_error_fail_resize:"ファイル変換エラー"}},function(a,b,c){"use strict";b.__esModule=!0,b.default={txt_filter:"필터",txt_crop:"자르기, 회전",txt_resize:"크기",txt_adjust:"보정",txt_mosaic:"모자이크",txt_signature:"서명",txt_text:"텍스트",txt_sticker:"스티커",txt_clip:"마스크",txt_frame:"액자",txt_return_origin:"원본으로",txt_cancel:"취소",txt_done:"완료",txt_apply:"적용",txt_open:"열기",txt_close:"닫기",txt_undo:"이전",txt_redo:"다시",txt_image_save:"사진저장",txt_image_list:"이미지 목록",txt_none_apply:"적용 안함",txt_original:"원본",txt_max:"최대",txt_optimum:"최적",txt_original_size:"원본크기",txt_filter_original:"Original",txt_filter_clear:"Clear",txt_filter_bright:"Bright",txt_filter_cream:"Cream",txt_filter_delight:"Delight",txt_filter_blossom:"Blossom",txt_filter_warm:"Warm",txt_filter_lollipop:"Lollipop",txt_filter_candy:"Candy",txt_filter_mint:"Mint",txt_filter_cool:"Cool",txt_filter_cobalt:"Cobalt",txt_filter_classic:"Classic",txt_filter_vintage:"Vintage",txt_filter_urban:"Urban",txt_filter_chic:"Chic",txt_filter_blank:"Blank",txt_filter_tintp:"Tint P",txt_filter_tinty:"Tint Y",txt_frame_1:"하얀액자",txt_frame_2:"검은액자",txt_frame_3:"둥근액자",txt_frame_4:"낡은액자",txt_frame_5:"종이액자",txt_frame_6:"투명 모서리",txt_reset:"재설정",txt_rotate:"회전",txt_flip_horizon:"좌우반전",txt_flip_vertical:"상하반전",txt_original_ratio:"원본비율",txt_free_ratio:"자유",txt_16_9_ratio:"16:9",txt_3_2_ratio:"3:2",txt_4_3_ratio:"4:3",txt_1_1_ratio:"1:1",txt_3_4_ratio:"3:4",txt_2_3_ratio:"2:3",txt_9_16_ratio:"9:16",txt_mask_oval:"원",txt_mask_triangle:"삼각",txt_mask_round_square:"둥근사각",txt_mask_polygon:"다각",txt_mask_star1:"별1",txt_mask_star2:"별2",txt_mask_round_star:"둥근별",txt_outline:"테두리",txt_confirm:"확인",txt_auto_adjustment:"자동보정",txt_brightness:"밝기",txt_saturation:"채도",txt_sharpen:"선명도",txt_kelvin:"색온도",txt_contrast:"대비",txt_square:"사각",txt_circle:"원",txt_none_signature:"서명 안함",txt_image_signature:"이미지 서명",txt_text_signature:"텍스트 서명",txt_notice_compare:"이미지를 누르면<br>원본과 비교할 수 있어요",txt_notice_mosaic_drag:"Shift 키를 누르면 이미지를 드래그할 수 있어요.",txt_notice_resize:"원본보다 크게 변경 불가합니다",txt_notice_crop_minimum:"작은 이미지(60*60px미만)는 자르기 메뉴 사용이 제한됩니다. 90도 회전만 이용할 수 있어요.",txt_notice_has_thumbnail:"이미지는 최대 3000px로 저장됩니다",txt_direct:"직접입력",txt_auto:"자동",txt_apply_all:"모든 사진 적용",txt_apply_select:"일부 사진 적용",txt_signature_image_input:"400x200px, 200kb 이하",txt_signature_image_load:"불러오기",txt_signature_opacity:"투명도",txt_signature_size:"크기",txt_all:"모든 ",txt_selected:"선택된 ",txt_notice_resize_apply:"이미지의 가로 크기가 %spx로 변경되었습니다.",txt_notice_resize_apply_exception:"<br />단, 원본이 이보다 작은 경우 원본 크기가 유지됩니다.",txt_notice_resize_apply_exception_by_type:"<br />단, 원본이 작은 경우 원본 크기가 유지되며, %s는 대상에서 제외됩니다. ",txt_notice_apply_exception_by_type:"<br />단, %s는 대상에서 제외됩니다. ",txt_animation_gif:"움직이는 GIF",txt_vr360:"360 VR 이미지",txt_panorama:"파노라마 이미지",txt_alert_ok:"확인",txt_alert_cancel:"취소",txt_alert_try:"다시 한 번 시도해 주시겠어요?",txt_alert_error:"앗, 에러가 발생했습니다!",txt_alert_out_of_memory:"사진이 많아 브라우저 메모리가 부족합니다.<br />브라우저를 다시 시작해 주세요.",txt_confirm_close_tit:"편집을 취소하시겠습니까?",txt_confirm_close_desc:"변경사항이 저장되지 않습니다.",txt_confirm_crop_tit:"자르기에서 편집한 내용을 저장하시겠습니까?",txt_confirm_save_crop_tit:"자르기에서 편집한 내용도 저장하시겠습니까?",txt_confirm_clip_tit:"마스크에서 편집한 내용을 저장하시겠습니까?",txt_confirm_save_clip_tit:"마스크에서 편집한 내용도 저장하시겠습니까?",txt_notice_file_type_error:"파일 형식 오류",txt_notice_animation_gif:"움직이는 GIF는 이미지 편집 기능을 제공하지 않습니다.",txt_notice_vr360:"360 VR 이미지는 편집 기능을 제공하지 않습니다.",txt_notice_panorama:"파노라마 이미지는 편집 기능을 제공하지 않습니다.",txt_notice_signature_image_size:"400x200px, 200KB 이하의 사진만 사용할 수 있습니다.",txt_notice_signature_image_type_error:"JPG, JPEG, GIF, PNG, BMP만 지원합니다.",txt_notice_signature_apply_none:"사진에서 서명을 삭제하였습니다.",txt_notice_signature_apply_image:"사진에 이미지 서명이 적용되었습니다.",txt_notice_signature_apply_text:"사진에 텍스트 서명이 적용되었습니다.",txt_notice_filter_apply_none:"사진에서 필터를 제거했습니다.",txt_notice_filter_apply:"사진에 필터를 적용했습니다.",txt_notice_frame_apply_none:"사진에서 액자를 제거했습니다.",txt_notice_frame_apply:"사진에 액자를 적용했습니다.",txt_signature_text_placeholder:"국문 최대 21자, 영문 42자",txt_add_text:"텍스트 추가",txt_edit_order:"순서 편집",txt_apply_edit_order:"순서 편집 완료",txt_reverse:"역순으로",txt_image_load_fail:"선택하신 사진에 오류가 있어 불러올 수 없습니다.",txt_editor_sort_tooltip:"끌어서 이미지 순서를 변경할 수 있어요. 변경시 에디터에 첨부된 이미지 순서도 함께 변경됩니다.",txt_choice_photos_apply:"적용할 사진을 선택하세요",txt_drag_photos:"사진을 끌어서 순서를 바꿔 보세요. 문서에 첨부된 사진 순서도 함께 바뀝니다.",txt_facebook:"페이스북",txt_instagram:"인스타그램",txt_pholar:"폴라",txt_mypc:"내 컴퓨터",txt_navercloud:"네이버 클라우드",txt_dont_see_again:"다시 보지 않기",txt_selected_count:'<em class="now_num">6</em>장 선택함',txt_fill_the_screen:"화면 맞춤",txt_font_default:"기본서체",txt_font_nanumgothic:"나눔고딕",txt_font_nanummyeongjo:"나눔명조",txt_font_nanumbarungothic:"바른고딕",txt_input_text:"내용을 입력하세요.",image_upload_error_key_expired:"세션 만료",image_upload_error_client:"클라이언트 오류",image_upload_error_system:"분류되지 않은 서버 오류",image_upload_error_login:"로그인이 필요합니다.",image_upload_error_fail_to_load_iframe:"phup_frame.html 파일을 ifram에 로드하지 못함",image_upload_error_fail_to_get_session_key:"업로드 세션키 값을 로드하지 못함",image_upload_error_broken_image:"이미지 깨짐 (이미지 파일 형식이지만 읽을 수 없음)",image_upload_error_unknown_broken_image:"이미지 깨짐 (이미지 파일 형식이 아님)",image_upload_error_unsupported_image:"지원되지 않는 이미지 포멧",image_upload_error_unsupported_extension:"허용하지 않은 확장자인 경우",image_upload_error_abuse:"어뷰저로 탐지되어 업로드 제한",image_upload_error_limitation_by_session_count:"한 세션의 최대 업로드 개수 초과",image_upload_error_limitation_by_session_size:"한 세션의 최대 업로드 용량 초과",image_upload_error_limitation_by_image:"이미지 용량 제약 걸림",image_upload_error_limitation_by_width_height:"이미지 너비 혹은 높이 범위 제약 걸림",image_upload_error_limitation_by_resolution:"이미지 면적 제약 걸림",image_upload_error_limitation_by_aspect_ratio:"이미지 비율 제약 걸림",image_upload_error_invalid_parameter:"호출 오류",image_upload_error_illegal_state:"호출 순서 오류, 업로드 되지 않은 이미지를 저장하는 경우",image_upload_error_file_overwrite_fail:"덮어쓰기 오류",image_upload_error_fail_convert_bmp2png_fail:"파일 변환 실패",image_upload_error_config:"서버 내부 설정 로드 오류",image_upload_error_fail_file_copy:"편집된 최종파일 업로드 실패",image_upload_error_fail_resize:"파일 변환 오류"}},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(37),f=d(e),g=c(0),h=d(g),i=c(1),j=d(i),k=c(36),l=(d(k),c(7)),m=(d(l),c(8)),n=d(m),o=c(5),p=d(o);n.default.MODAL={ALERT_WRAP:".npe_alert_wrap",ALERT_INNER:".npe_alert",ALERT_TITLE:".npe_alert_title",ALERT_TITLE_SMALL:".npe_alert_title_small",ALERT_DESCRIPTION:".npe_alert_description",ALERT_DESCRIPTION_LONG:".npe_alert_description_long",ALERT_BTN_AREA:".npe_alert_btn_area",ALERT_OK_BTN:".npe_alert_btn_ok",ALERT_CANCEL_BTN:".npe_alert_btn_cancel",ALERT_BTN_HIDE:".npe_alert_btn_hide",ALERT_BTN_HIDE_CHECK:".npe_alert_hide_check",ALERT_CLOSE_BTN:".npe_alert_btn_close",ALERT_SNS_AREA:".npe_alert_sns_area",ALERT_SAVE_AREA:".npe_alert_save_area",ALERT_UPLOADING_AREA:".npe_alert_uploading_area"};var q=function(){function a(){return(0,h.default)(this,a),a.instance||(a.instance=this,a.prototype._initialize.apply(this,arguments)),a.instance}return a.prototype._initialize=function(a){this.type=null,this.popupType=null,this.options=null,this._storage=a,this._defaultOption={title:"",content:"",smallTitle:!1,longDescription:!1,useCheckHideBtn:!1,useCheckHideKey:null,useCloseBtn:!1,useBtns:!1,yesCallback:null,noCallback:null,afterClose:null},this.$alertWrap=(0,p.default)(n.default.MODAL.ALERT_WRAP),this.$alertInner=this.$alertWrap.find(n.default.MODAL.ALERT_INNER),this.$alertTitle=this.$alertWrap.find(n.default.MODAL.ALERT_TITLE),this.$alertTitleSmall=this.$alertWrap.find(n.default.MODAL.ALERT_TITLE_SMALL),this.$alertDesc=this.$alertWrap.find(n.default.MODAL.ALERT_DESCRIPTION),this.$alertDescLong=this.$alertWrap.find(n.default.MODAL.ALERT_DESCRIPTION_LONG),this.$alertBtnArea=this.$alertWrap.find(n.default.MODAL.ALERT_BTN_AREA),this.$alertOkBtn=this.$alertWrap.find(n.default.MODAL.ALERT_OK_BTN),this.$alertCancelBtn=this.$alertWrap.find(n.default.MODAL.ALERT_CANCEL_BTN),this.$alertBtnHide=this.$alertWrap.find(n.default.MODAL.ALERT_BTN_HIDE),this.$alertBtnHideCheck=this.$alertWrap.find(n.default.MODAL.ALERT_BTN_HIDE_CHECK),this.$alertCloseBtn=this.$alertWrap.find(n.default.MODAL.ALERT_CLOSE_BTN),this.$alertSnsArea=this.$alertWrap.find(n.default.MODAL.ALERT_SNS_AREA),this.$alertSaveArea=this.$alertWrap.find(n.default.MODAL.ALERT_SAVE_AREA),this.$alertUploadingArea=this.$alertWrap.find(n.default.MODAL.ALERT_UPLOADING_AREA),this.activate()},a.prototype.activate=function(){this.$alertCloseBtn.on("click.modal",this._onClickCloseBtn.bind(this))},a.prototype.deactivate=function(){this.$alertCloseBtn.off("click.modal")},a.prototype.alert=function(a){a=(0,f.default)({useCheckHideBtn:!1,useCloseBtn:!1,useBtns:!0},a),this.popupType=null,this._open("alert",a)},a.prototype.confirm=function(a){a=(0,f.default)({useCheckHideBtn:!1,useCloseBtn:!1,useBtns:!0},a),this.popupType=null,this._open("confirm",a)},a.prototype.popup=function(a){a=(0,f.default)({useCheckHideBtn:!0,useCloseBtn:!0},a),a.useCheckHideBtn&&a.useCheckHideKey&&this._storage.getItem(a.useCheckHideKey)||(this.popupType=null,this._open("popup",a))},a.prototype.snsImagePopup=function(a){a=(0,f.default)({useCheckHideBtn:!1,useCloseBtn:!0},a),this.popupType="sns",this._open("popup",a)},a.prototype.saveImagePopup=function(a){a=(0,f.default)({useCheckHideBtn:!1,useCloseBtn:!0},a),this.popupType="saveImage",this._open("popup",a)},a.prototype.uploadingPopup=function(a){a=(0,f.default)({useCheckHideBtn:!1,useCloseBtn:!1,useBtns:!0},a),this.popupType="uploading",this._open("popup",a)},a.prototype.store=function(){this._store={type:this.type,popupType:this.popupType,isOpened:this.isOpened,options:(0,f.default)({},this.option)}},a.prototype.restore=function(){this._store&&this._store.isOpened&&(this.popupType=this._store.popupType,this._open(this._store.type,(0,f.default)({},this._store.options)))},a.prototype._open=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"alert",b=arguments[1];b=(0,f.default)({},this._defaultOption,b),this.option=b,this.type=a,this.option&&this.option.beforeOpen&&this.option.beforeOpen(),this.$alertInner.children().hide(),this.$alertOkBtn.hide(),this.$alertCancelBtn.hide(),this.$alertBtnArea.toggle(b.useBtns),this._setTitle(b.title,b.smallTitle),this._setContent(b.content,b.longDescription),this._setHideBtn(b.useCheckHideBtn,b.useCheckHideKey),this._setCloseBtn(b.useCloseBtn),"alert"===a&&this._setOkBtn(b.yesCallback),"confirm"===a&&(this._setOkBtn(b.yesCallback),this._setCancelBtn(b.noCallback)),"sns"===this.popupType&&this.$alertSnsArea.show(),"saveImage"===this.popupType&&this.$alertSaveArea.show(),"uploading"===this.popupType&&this.$alertUploadingArea.show(),this.$alertWrap.addClass(n.default.ACTIVE_TOGGLE_CLASS)},a.prototype._setTitle=function(a){var b=arguments.length>1&&void 0!==arguments[1]&&arguments[1];a&&0!==a.length&&(b?this.$alertTitleSmall.html(a).show():this.$alertTitle.html(a).show())},a.prototype._setContent=function(a){var b=arguments.length>1&&void 0!==arguments[1]&&arguments[1];a&&0!==a.length&&(b?this.$alertDescLong.empty().append(a).show():this.$alertDesc.empty().append(a).show())},a.prototype._setOkBtn=function(a){var b=this;this.$alertOkBtn.show().off("click.modal").one("click.modal",function(){b.$alertWrap.removeClass(n.default.ACTIVE_TOGGLE_CLASS),a&&a()})},a.prototype._setCancelBtn=function(a){var b=this;this.$alertCancelBtn.show().off("click.modal").one("click.modal",function(){b.$alertWrap.removeClass(n.default.ACTIVE_TOGGLE_CLASS),a&&a()})},a.prototype._setCloseBtn=function(){var a=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.$alertCloseBtn.toggle(a)},a.prototype._setHideBtn=function(){var a=this,b=arguments.length>0&&void 0!==arguments[0]&&arguments[0],c=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.$alertBtnHide.toggle(b&&c),b&&c?this.$alertBtnHideCheck.off("change.modal").on("change.modal",function(){a.$alertBtnHideCheck.is(":checked")?a._storage.setItem(c,1):a._storage.removeItem(c)}):this.$alertBtnHideCheck.off("change.modal")},a.prototype.close=function(){var a=this.option&&this.option.afterClose;this.$alertWrap.removeClass(n.default.ACTIVE_TOGGLE_CLASS),a&&a()},a.prototype._onClickCloseBtn=function(){this.close()},(0,j.default)(a,[{key:"isOpened",get:function(){return this.$alertWrap.hasClass(n.default.ACTIVE_TOGGLE_CLASS)}}]),a}();q.getInstance=function(){return q.instance||(q.instance=new q),q.instance},b.default=q},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(22),f=d(e),g=c(0),h=d(g),i=c(2),j=d(i),k=c(1),l=d(k),m=c(3),n=d(m),o=c(31),p=d(o),q=c(52),r=d(q),s=c(367),t=d(s),u=c(368),v=d(u),w=c(56),x=(d(w),c(370)),y=d(x),z=(c(181),c(10)),A=c(33),B=c(17),C=c(25),D=d(C),E=function(a){function b(c,d){var e=arguments.length>2&&void 0!==arguments[2]&&arguments[2],f=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2631720;(0,h.default)(this,b);var g=(0,j.default)(this,a.call(this,(0,z.pull)(c||b.defaultOptions,b.defaultOptions),d,e,f));return g._initPUEditor(),g}return(0,n.default)(b,a),(0,l.default)(b,null,[{key:"SHOW_ORIGINAL",get:function(){return"showOriginal"}},{key:"PUSH_HISTORY",get:function(){return"pushHistory"}},{key:"HISTORY_CHANGED",get:function(){return"historyChanged"}},{key:"BORDER_CHANGED",get:function(){return"borderChanged"}},{key:"PHOTOFRAME_DISABLE",get:function(){return"photoFrameDisable"}},{key:"defaultOptions",get:function(){var a=(0,f.default)(p.default.defaultOptions);return a.photoFrame={imgPath:"img/frame.png",crossOrigin:null},a.mosaic=a.mosaic||{modes:[{name:"square1",size:10,color:16777215,alpha:1},{name:"square2",size:15,color:16777215,alpha:1},{name:"square3",size:20,color:16777215,alpha:1},{name:"square4",size:30,color:16777215,alpha:1},{name:"square5",size:40,color:16777215,alpha:1},{name:"circle1",size:10,color:16777215,alpha:1},{name:"circle2",size:15,color:16777215,alpha:1},{name:"circle3",size:20,color:16777215,alpha:1},{name:"circle4",size:30,color:16777215,alpha:1},{name:"circle5",size:40,color:16777215,alpha:1}]},a.useControls.push("photoFrame"),a.fitToScreenDisableMenus=["crop","clip"],a.controlsMap.photoFrame=v.default,a.mosaic.keyCode=16,a.signature.renderOnClient=!1,a}}]),b.prototype._initPUEditor=function(){var a=this;this._screenFitEnable=!0,this._history=new t.default,this._thumbEditor=new y.default(this.options),this.on(b.PUSH_HISTORY,this.onPushHistory,this),this.on(b.BORDER_CHANGED,this.onBorderChanged,this),this.clip&&this.clip.on("ready",function(){return a._thumbEditor.initMaskAssets(a.clip.assets)})},b.prototype._getMenuname=function(a){switch(a){case"MosaicFilter":return"mosaic";case"FoodieFilter":return"filter";case"ColorTransformFilter":case"SharpenAdjustment":case"AutoAdjustment":return"adjust"}return null},b.prototype._historyRestore=function(a){a&&(this.debug&&void 0,"main"==a.menu?this._restoreFromHistory(a):this[a.menu].reset(a.snapshot,!0))},b.prototype._restoreFromHistory=function(a){var b=this,c=a.snapshot||{};this.options.useControls.forEach(function(a){b[a].reset(c[a])}),this._alignStickersDepth(),this.updateBitmapData(),this._emitHistoryChange()},b.prototype._emitHistoryChange=function(){this.emit(b.HISTORY_CHANGED,{type:b.HISTORY_CHANGED,target:this,redoable:this._history.redoable,undoable:this._history.undoable})},b.prototype.onPushHistory=function(a){this.pushHistory(a.history)},b.prototype.onBorderChanged=function(a){this.screenFitEnable?this.magnify.fitToScreen(!0):this.magnify.scale=this.magnify.scale},b.prototype.onProcessComplete=function(a){var b=this._encode||"image/jpeg",c=this._encodeOption||.92,d={type:p.default.PROCESS_COMPLETE,target:this,context:a,dataURL:""},e=this.imageTransformControls.mask;if(this.drawRenderableObjects(a,this.options.signature.renderOnClient),e.modified){var f=D.default.TEMP;f.prependTransforms.apply(f,this.imageTransformControls.transforms.slice(2,3)),this.imageTransformControls.mask.applyFinalMask(a,f.matrix.raw)}a=this.drawPhotoFrameObject(a),d.context=a,this.imageTransformControls.mask.modified&&(b="image/png");try{d.dataURL=a.canvas.toDataURL(b,c)}catch(g){this.outofmemory()}return this._encode=null,this._encodeOption=null,this.emit(p.default.PROCESS_COMPLETE,d),d},b.prototype.onFilterReady=function(){a.prototype.onFilterReady.call(this),this.filter&&this.filter.complete&&this._thumbEditor.initWithColorTable(this.filter.colorTables)},b.prototype.setFilterColorTables=function(b){var c=this;return a.prototype.setFilterColorTables.call(this,b).then(function(){return c._thumbEditor.initWithColorTable(c.filter.colorTables)})},b.prototype.reset=function(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,c=arguments.length>1&&void 0!==arguments[1]&&arguments[1];a.prototype.reset.call(this,b,c),this._history.clear(),this.pushHistory()},b.prototype.restore=function(a){var b=this;a=a||{},this.options.useControls.forEach(function(c){b[c].reset(a[c])}),this._alignStickersDepth()},b.prototype.pushHistory=function(){var a=(arguments.length>0&&void 0!==arguments[0]&&arguments[0],void 0),b=void 0;a=this.snapshot(),b="main",this._history.push({menu:b,snapshot:a}),this._emitHistoryChange()},b.prototype.undo=function(){this._historyRestore(this._history.undo())},b.prototype.redo=function(){this._historyRestore(this._history.redo())},b.prototype.viewportTo=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,d=this,e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,f=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"easeOut";this._targetvp=this._targetvp||{};var g={},h={x:a,y:b,width:c,height:e};if((0,B.each)(h,function(a,b){-1!=a&&(g[b]=a),d._targetvp[b]=-1==a?d.viewport[b]:a}),this._viewportMotion.play(this.viewport,g,this.options.viewportDuration,r.default[f]),this.screenFitEnable){var i=!!this._current&&this._current.enlargable;this.magnify.viewportTo(g,i)}else"crop"==this.phase||"clip"==this.phase?this.magnify.viewportTo(g,this._current.enlargable):"main"!=this.phase&&"resize"==this.phase||this.magnify.scaleTo(1);this.emit(p.default.TARGET_VIEWPORT_CHANGE)},b.prototype.updateSignContainer=function(){var a=this,b=this.getResizeRect(this.maskedWidth,this.maskedHeight,this.imageTransformControls.resize.width),c=b[0],d=b[1],e=this.options.originalMaxSize,f=Math.max(c,d),g=Math.min(c,d),h=Math.max(e/f,1/g);h<1&&(c=c*h|0,d=d*h|0),[this.signatureContainer,this.photoFrameContainer].forEach(function(b){b.updateSize(c,d),b.width=a._editingCanvas.width,b.height=a._editingCanvas.height})},b.prototype.getResizeRect=function(a,b,c){var d=a,e=b;if(c>0){var f=Math.min(1,Math.max(c/d,1/Math.min(d,e)));if(f<1){var g=[d*f,e*f];d=g[0],e=g[1]}}return[d,e]},b.prototype.toDataURL=function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"image/jpeg",d=this._editingBmpd.canvas,e=z.__context.canvas,f=a/d.width,g=this.bitmapdata.tempCanvases[0],h=g.getContext("2d"),i=this.imageTransformControls.mask;if(e.width=a,e.height=b,(0,A.resizeImage)(d,z.__context),i.modified){g.width=this.signatureContainer.actualWidth,g.height=this.signatureContainer.actualHeight;var j=new D.default;j.scaleX=j.scaleY=f;var k=D.default.TEMP;k.prependTransforms.apply(k,this.imageTransformControls.transforms.slice(2,3).concat([j])),this.drawRenderableObjects(h,!0),(0,A.resizeImage)(g,z.__context),i.applyFinalMask(z.__context,k.matrix.raw),c="image/png"}else this.drawRenderableObjects(z.__context,!0);return this.drawPhotoFrameObject(z.__context,Math.min(1,f)).canvas.toDataURL(c)},b.prototype._copyAndApplyMask=function(a,b){var c=this.imageTransformControls.mask;return c.modified?(b.width=a.width,b.height=a.height,b.drawImage(a,0,0),c.applyFinalMask(b),b.canvas):a},b.prototype.signToDataURL=function(){return this.signature?this.signature.displayObject&&this.signature.displayObject.toDataURL?this.signature.displayObject.toDataURL():null:(void 0,null)},b.prototype.getCroppedDataURL=function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"image/jpeg",d=this.bitmapdata.transformedImageData,e=z.__photoFrameContext.canvas,f=this.imageTransformControls.mask;if(e.width=d.width,e.height=d.height,z.__photoFrameContext.putImageData(d,0,0),f.modified){var g=D.default.TEMP;g.prependTransforms.apply(g,this.imageTransformControls.transforms.slice(2,3)),this.imageTransformControls.mask.applyFinalMask(z.__photoFrameContext,g.matrix.raw)}var h=z.__context.canvas;e.width;return h.width=a,h.height=b,(0,A.resizeImage)(e,z.__context),this.imageTransformControls.mask.modified&&(c="image/png"),h.toDataURL(c)},b.prototype.drawPhotoFrameObject=function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(!this.photoFrame||!this.photoFrame.modified)return a;var c=(0,B.map)(this.magnify.border,function(a){return a*b}),d=z.__photoFrameContext.canvas,e=this.photoFrame.source;return d.width=a.canvas.width+(c.left+c.right),d.height=a.canvas.height+(c.top+c.bottom),z.__photoFrameContext.drawImage(a.canvas,c.left,c.top),z.__photoFrameContext.drawImage(e,0,0,e.width,e.height,0,0,d.width,d.height),z.__photoFrameContext},b.prototype.applySnapshotTo=function(a,b,c,d){var e=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"image/jpeg",f=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.92,g=this._thumbEditor,h=this.options.originalMaxSize,i=Math.min(1,Math.max(Math.min(h/c.width,h/c.height),Math.max(1/c.width,1/c.height)));return c.width=c.width*i|0,c.height=c.height*i|0,void 0!==b.clip&&b.clip.modified&&(e="image/png"),g.setImageByDataURL(a).then(function(){return g.updateOriginalSize(c.width,c.height),g.restore(b)}).then(function(){return g.toDataURL(e,f)})},(0,l.default)(b,[{key:"viewport",get:function(){return this.magnify.boundary},set:function(a){this.magnify.boundary=a,this.crop&&(this.crop.viewport=a),this.clip&&(this.clip.viewport=a),this.viewportMotion.running||(this._current?this._current.fitToScreen():this.screenFitEnable&&this.magnify.fitToScreen()),this._align(),this.emit(p.default.VIEWPORT_MOTION_UPDATE)}},{key:"screenFitEnable",get:function(){return this._screenFitEnable},set:function(a){this._screenFitEnable=a,this._current&&(this._current.screenFitEnable=a),"main"==this.phase&&this.magnify.autoScale(a)}},{key:"showOriginal",get:function(){return this.bitmapdata.showOriginal},set:function(a){this.bitmapdata.showOriginal=a,this.emit(b.SHOW_ORIGINAL,{type:b.SHOW_ORIGINAL,target:this,visible:a})}},{key:"history",get:function(){return this._history}},{key:"photoFrameContainer",get:function(){return this._frameLayer}},{key:"fitToScreenAvailable",get:function(){if(this._current){this._current._menu;if(-1!=this.options.fitToScreenDisableMenus.indexOf(this._current._menu))return!1}return this.magnify.fitToScreenAvailable}},{key:"entrySize",get:function(){return this.resize?this.resize.entrySize:0}}]),b}(p.default);b.default=E},function(a,b,c){a.exports={"default":c(264),__esModule:!0}},function(a,b,c){a.exports={"default":c(269),__esModule:!0}},function(a,b,c){var d=c(13),e=c(9),f=c(50);a.exports=function(a,b){var c=(e.Object||{})[a]||Object[a],g={};g[a]=b(c),d(d.S+d.F*f(function(){c(1)}),"Object",g)}},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(1),h=d(g),i=c(2),j=d(i),k=c(3),l=d(k),m=function(a){function b(){var c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:550,g=arguments.length>3&&void 0!==arguments[3]?arguments[3]:400,h=arguments.length>4&&void 0!==arguments[4]?arguments[4]:16763904;(0,f.default)(this,b);var i=(0,j.default)(this,a.call(this));return i.color=h,i._init(c,d),i.setSize(e,g),i}return(0,l.default)(b,a),b.prototype.setSize=function(a,b){this._graphics[1].x=this._graphics[2].x=a,this._graphics[2].y=this._graphics[3].y=b,this._g.x=a/2,this._g.y=b/2},b.prototype._init=function(a,b){this._graphics=[];for(var c=[1,1,-1,1,-1,-1,1,-1],d=void 0,e=0;e<c.length;e+=2)d=new PIXI.Graphics,d.beginFill(this.color,1),d.drawRect(0,0,b,a),d.drawRect(0,0,a,b),d.endFill(),d.scale.x=c[e],d.scale.y=c[e+1],this.addChild(d),this._graphics.push(d);this._g=new PIXI.Graphics,this._g.beginFill(this.color,1),this._g.drawRect(-1,-b/2,2,b),this._g.drawRect(-b/2,-1,b,2),this._g.endFill(),this.addChild(this._g)},(0,h.default)(b,[{key:"centerGridVisible",get:function(){return null!=this._g.parent},set:function(a){a?this.addChild(this._g):this._g.parent&&this._g.parent.removeChild(this._g)}}]),b}(PIXI.Container);b.default=m},function(a,b,c){a.exports={"default":c(276),__esModule:!0}},function(a,b,c){var d=c(26);a.exports=function(a,b){if(!d(a)||a._t!==b)throw TypeError("Incompatible receiver, "+b+" required!");return a}},function(a,b){function c(){throw new Error("setTimeout has not been defined")}function d(){throw new Error("clearTimeout has not been defined")}function e(a){if(k===setTimeout)return setTimeout(a,0);if((k===c||!k)&&setTimeout)return k=setTimeout,setTimeout(a,0);try{return k(a,0)}catch(b){try{return k.call(null,a,0)}catch(b){return k.call(this,a,0)}}}function f(a){if(l===clearTimeout)return clearTimeout(a);if((l===d||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(a);try{return l(a)}catch(b){try{return l.call(null,a)}catch(b){return l.call(this,a)}}}function g(){p&&n&&(p=!1,n.length?o=n.concat(o):q=-1,o.length&&h())}function h(){if(!p){var a=e(g);p=!0;for(var b=o.length;b;){for(n=o,o=[];++q<b;)n&&n[q].run();q=-1,b=o.length}n=null,p=!1,f(a)}}function i(a,b){this.fun=a,this.array=b}function j(){}var k,l,m=a.exports={};!function(){try{k="function"==typeof setTimeout?setTimeout:c}catch(a){k=c}try{l="function"==typeof clearTimeout?clearTimeout:d}catch(a){l=d}}();var n,o=[],p=!1,q=-1;m.nextTick=function(a){var b=new Array(arguments.length-1);if(arguments.length>1)for(var c=1;c<arguments.length;c++)b[c-1]=arguments[c];o.push(new i(a,b)),1!==o.length||p||e(h)},i.prototype.run=function(){this.fun.apply(null,this.array)},m.title="browser",m.browser=!0,m.env={},m.argv=[],m.version="",m.versions={},m.on=j,m.addListener=j,m.once=j,m.off=j,m.removeListener=j,m.removeAllListeners=j,m.emit=j,m.prependListener=j,m.prependOnceListener=j,m.listeners=function(a){return[]},m.binding=function(a){throw new Error("process.binding is not supported")},m.cwd=function(){return"/"},m.chdir=function(a){throw new Error("process.chdir is not supported")},m.umask=function(){return 0}},function(a,b,c){"use strict";function d(a,b){for(var c=a,d=Array.isArray(c),e=0,c=d?c:(0,j.default)(c);;){var f;if(d){if(e>=c.length)break;f=c[e++]}else{if(e=c.next(),e.done)break;f=e.value}b(f)}}function e(a,b){var c=[];return d(a,function(a){return c.push(b(a))}),c}function f(a,b){var c=[];return d(a,function(a){return b(a)&&c.push(a)}),c}function g(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(void 0===c)throw new Error("기본 값이 없습니다.");return d(a,function(a){return c=b(c,a)}),c}function h(a){for(var b=arguments.length,c=Array(b>1?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];return c.map(function(b){return a[b]})}b.__esModule=!0;var i=c(45),j=function(a){return a&&a.__esModule?a:{"default":a}}(i);b.eachi=d,b.mapi=e,b.filteri=f,b.reducei=g,b.iterateValues=h},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(1),h=d(g),i=c(17),j=c(129),k=d(j),l=c(24),m=c(40),n=(d(m),c(44)),o=d(n),p="\n	attribute vec4 a_position;\n	attribute vec4 aTextureCoord;\n\n	uniform float imageWidthFactor; \n	uniform float imageHeightFactor; \n	uniform float sharpness;\n\n	varying vec2 textureCoordinate;\n	varying vec2 leftTextureCoordinate;\n	varying vec2 rightTextureCoordinate; \n	varying vec2 topTextureCoordinate;\n	varying vec2 bottomTextureCoordinate;\n\n	varying float centerMultiplier;\n	varying float edgeMultiplier;\n\n	void main()\n	{\n	    gl_Position = a_position;\n	    \n	    vec2 widthStep = vec2(imageWidthFactor, 0.0);\n	    vec2 heightStep = vec2(0.0, imageHeightFactor);\n	    \n	    textureCoordinate = aTextureCoord.xy;\n	    leftTextureCoordinate = aTextureCoord.xy - widthStep;\n	    rightTextureCoordinate = aTextureCoord.xy + widthStep;\n	    topTextureCoordinate = aTextureCoord.xy + heightStep;     \n	    bottomTextureCoordinate = aTextureCoord.xy - heightStep;\n	    \n	    centerMultiplier = 1.0 + 4.0 * sharpness;\n	    edgeMultiplier = sharpness;\n	}\n",q="\n	precision highp float;\n	 \n	varying highp vec2 textureCoordinate;\n	varying highp vec2 leftTextureCoordinate;\n	varying highp vec2 rightTextureCoordinate; \n	varying highp vec2 topTextureCoordinate;\n	varying highp vec2 bottomTextureCoordinate;\n\n	varying highp float centerMultiplier;\n	varying highp float edgeMultiplier;\n\n	uniform sampler2D texture;\n\n	void main()\n	{\n	    mediump vec3 textureColor = texture2D(texture, textureCoordinate).rgb;\n	    mediump vec3 leftTextureColor = texture2D(texture, leftTextureCoordinate).rgb;\n	    mediump vec3 rightTextureColor = texture2D(texture, rightTextureCoordinate).rgb;\n	    mediump vec3 topTextureColor = texture2D(texture, topTextureCoordinate).rgb;\n	    mediump vec3 bottomTextureColor = texture2D(texture, bottomTextureCoordinate).rgb;\n	    \n	    gl_FragColor = vec4(\n	    (textureColor * centerMultiplier \n	    - (leftTextureColor * edgeMultiplier \n	    + rightTextureColor * edgeMultiplier \n	    + topTextureColor * edgeMultiplier \n	    + bottomTextureColor * edgeMultiplier))\n	    , texture2D(texture, bottomTextureCoordinate).w);\n	}\n",r=function(){function a(b){(0,f.default)(this,a),this._gl=b,this._frameBuffer=new k.default(this.gl),this.sharpness=0,this._initProgram(),this._initBuffer()}return a.prototype._initBuffer=function(){this.triangleData=[-1,-1,1,-1,-1,1,1,1],this.uvData=[0,0,1,0,0,1,1,1],this.vertices=new Float32Array(this.triangleData),this.texCoords=new Float32Array(this.uvData),this.uvBuffer=this.gl.createBuffer(),this.triBuffer=this.gl.createBuffer()},a.prototype._initProgram=function(){this.sharpenProgram=(0,l.createProgram)(this.gl,p,q);
},a.prototype.initWithSize=function(a,b){this.frameBuffer.initWithSize(a,b)},a.prototype.applyFilter=function(a,b){var c=this;if(!this.changed)return a;var d=this.gl;return this.frameBuffer.activeFrameBuffer(function(e){d.useProgram(c.sharpenProgram),c.setAttributes(c.sharpenProgram,d),c.setUniformsf(c.sharpenProgram,{sharpness:[c.sharpness],imageWidthFactor:[1/d.canvas.width],imageHeightFactor:[1/d.canvas.height]}),c.setUniformsi(c.sharpenProgram,{texture:[0]}),c.bindTextureAt(a),c.frameBuffer.bindColorAttachment(b),c.draw()}),b},a.prototype.draw=function(){var a=this.gl;a.drawArrays(a.TRIANGLE_STRIP,0,4)},a.prototype.setAttributes=function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.gl,c=[2,b.FLOAT,!1,0,0];this.uploadBuffer(this.triBuffer,this.vertices),this.enableVertexAttribute.apply(this,[a,"a_position"].concat(c)),this.uploadBuffer(this.uvBuffer,this.texCoords),this.enableVertexAttribute.apply(this,[a,"aTextureCoord"].concat(c))},a.prototype.setUniformsf=function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.gl;(0,i.each)(b,function(b,d){c["uniform"+b.length+"f"].apply(c,[c.getUniformLocation(a,d)].concat(b))})},a.prototype.setUniformsi=function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.gl;(0,i.each)(b,function(b,d){c["uniform"+b.length+"i"].apply(c,[c.getUniformLocation(a,d)].concat(b))})},a.prototype.bindTextureAt=function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.gl;c.activeTexture(c.TEXTURE0+b),c.bindTexture(c.TEXTURE_2D,a)},a.prototype.uploadBuffer=function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.gl,d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:c.ARRAY_BUFFER;c.bindBuffer(d,a),c.bufferData(d,b,c.STATIC_DRAW)},a.prototype.enableVertexAttribute=function(a,b,c,d,e,f){var g=arguments.length>6&&void 0!==arguments[6]&&arguments[6],h=arguments.length>7&&void 0!==arguments[7]?arguments[7]:this.gl,i=h.getAttribLocation(a,b);h.enableVertexAttribArray(i),h.vertexAttribPointer(i,c,d,g,e,f)},(0,h.default)(a,[{key:"changed",get:function(){return 0!=this.sharpness}},{key:"sharpness",get:function(){return this._sharpness},set:function(a){this._sharpness=a}},{key:"value",get:function(){return this.sharpness},set:function(a){this.sharpness=a}},{key:"vertexSource",get:function(){return p}},{key:"fragmentSource",get:function(){return q}},{key:"frameBuffer",get:function(){return this._frameBuffer}},{key:"name",get:function(){return"SharpenFilter"}},{key:"gl",get:function(){return this._gl||o.default.shared}}]),a}();b.default=r},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(1),h=d(g),i=c(2),j=d(i),k=c(3),l=d(k),m=c(54),n=d(m),o=c(131),p=function(a){function b(){(0,f.default)(this,b);var c=(0,j.default)(this,a.call(this));return c.identity(),c}return(0,l.default)(b,a),b.prototype.applyTransform=function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,d=void 0;if((0,o.instanceofCanvas)(a))d=a;else{var e=this.getSourceSize(a),f=e[0],g=e[1];b.width=f,b.height=g;b.getContext("2d").drawImage(a,0,0),d=b}return this._imageData=d.getContext("2d").getImageData(0,0,d.width,d.height),c&&c.decompose(),d},b.prototype.identity=function(){this._imageData=null},(0,h.default)(b,[{key:"imageData",get:function(){return this._imageData}}]),b}(n.default);b.default=p},function(a,b,c){"use strict";(function(a){function b(a){return a&&a.__esModule?a:{"default":a}}var d=c(4),e=b(d),f=c(38),g=b(f);!function(){function b(){arguments.length>0&&void 0,this.sharpen=0,this._blurFilter=new d}var d=c(307),f=c(308),h=c(309);if(Object.defineProperty(b,"BLUR_TYPE_STACK",{get:function(){return void 0,"stack"}}),Object.defineProperty(b,"BLUR_TYPE_GAUSSIAN",{get:function(){return void 0,"gaussian"}}),b.prototype={constructor:b,setBlurType:function(a){switch(void 0,a){case b.BLUR_TYPE_STACK:this._blurFilter=new d,this._blurRadiusFactory=function(a){return 50*Math.abs(a)<<0};break;case b.BLUR_TYPE_GAUSSIAN:this._blurFilter=new f,this._blurRadiusFactory=function(a){return Math.abs(20*a)};break;default:void 0,this.setBlurType(b.BLUR_TYPE_STACK)}},applyFilter:function(a,b,c,d,e,f){return this._callFilterFunc(a,b,c,d,e,f,null,null,!1)},applyFilterAsync:function(a,b,c,d,e,f,g,h){return this._callFilterFunc(a,b,c,d,e,f,g,h,!0)},_callFilterFunc:function(a,b,c,d,e,f,g,h,i){return 0!=this.sharpen&&(this.sharpen<0?this._applyBlurFilter(a,b,c,d,e,f,g,h,i):this._applyConvolutionFilter(a,b,c,d,e,f,g,h,i),!0)},_applyBlurFilter:function(a,b,c,d,e,f,g,h,i){this._blurFilter.radius=50*Math.abs(this.sharpen)<<0,i?this._blurFilter.applyFilterAsync(a,b,c,d,e,f,g,h):this._blurFilter.applyFilter(a,b,c,d,e,f)},_applyConvolutionFilter:function(a,b,c,d,e,f,g,i,j){this._convulutionFilter=this._convulutionFilter||new h,this._convulutionFilter.setFactor(this.sharpen),j?this._convulutionFilter.applyFilterAsync(a,b,c,d,e,f,g,i):this._convulutionFilter.applyFilter(a,b,c,d,e,f)}},(0,g.default)(b.prototype,{name:{get:function(){return"SharpenAdjustment"}},changed:{get:function(){return 0!=this.sharpen}},blurFilter:{get:function(){return this._blurFilter}}}),void 0!==(0,e.default)(a)&&void 0!==(0,e.default)(a.exports))a.exports=b;else{usenamespace("editor.filter").SharpenAdjustment=b}}()}).call(b,c(6)(a))},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){return function(b,c){var d=Math.max(b.w,b.h),e=Math.min(b.w,b.h),f=Math.max(a/d,1/e);f>1?c.identity():(b.w=b.w*f|0,b.h=b.h*f|0,c.scaleX=c.scaleY=f)}}function f(a,b,c,d){var e=Math.max(b,c),f=Math.min(b,c);if(e>d){var g=Math.min(1,Math.max(d/e,1/f));b*=g,c*=g}return Math.min(1,a/b)}b.__esModule=!0;var g=c(0),h=d(g),i=c(1),j=d(i),k=c(2),l=d(k),m=c(3),n=d(m);b.onMaximumSize=e,b.getEditingScale=f;var o=c(94),p=d(o),q=c(23),r=d(q),s=c(74),t=(d(s),c(25)),u=d(t),v=c(31),w=d(v),x=function(a){function b(c,d){(0,h.default)(this,b);var e=(0,l.default)(this,a.call(this,c,d));return e._init(),e}return(0,n.default)(b,a),b.prototype._init=function(){this.entrySize=0,this._transforms.push(new u.default),this._backup=0,this._targetWidth=0,this._sizeChanged=!1,this._imageTransform=new p.default,this.stage.on(w.default.SAVE_RESIZE,this.onResizeSave,this),this.stage.on(w.default.RESTORE_RESIZE,this.onResizeRestore,this)},b.prototype.start=function(){a.prototype.start.call(this),this.screenFitEnable=this.screenFitEnable,this._disable=this._sizeChanged=!1,this.stage.emit("photoFrameDisable",{type:"photoFrameDisable",visible:!0}),this.stage.motion.on("complete",this.onMotionComplete,this),this.stage.on(w.default.BITMAPDATA_UPDATE,this.onBitmapDataUpdate,this)},b.prototype.suspend=function(){return this.stage.motion.off("complete",this.onMotionComplete,this),this.stage.off(w.default.BITMAPDATA_UPDATE,this.onBitmapDataUpdate,this),this.stage.magnify.autoScale(this.screenFitEnable),a.prototype.suspend.call(this)},b.prototype.snapshot=function(){return{width:this._targetWidth,resizedWidth:this.stage.resizedWidth,resizedHeight:this.stage.resizedHeight}},b.prototype.reset=function(b){var c=arguments.length>1&&void 0!==arguments[1]&&arguments[1];b=b||{},this._targetWidth=b.width||this.entrySize||0,this._targetWidth<=0?this.imageTransform.identity():this.imageTransform.width=this._targetWidth,a.prototype.reset.call(this,c)},b.prototype.save=function(){this._targetWidth<=0||(this._backup=this._targetWidth,this.imageTransform.identity())},b.prototype.restore=function(){this._backup<=0||(this.imageTransform.width=this._backup,this._backup=0)},b.prototype.scaleTo=function(a){if(!this._disable){this._disable=!0;var b=this.stage.magnify.border.left+this.stage.magnify.border.right;if(this._targetWidth=Math.max(1,a-b),this._targetWidth==this.stage.resizedWidth)return this._disable=!1,void this.stage.emitBitmapDataUpdate();this.stage.emit("photoFrameDisable",{type:"photoFrameDisable",visible:!1}),a<=0&&(a=this.stage.maskedWidth);var c=a/this.stage.bitmapdata.width;this.stage.magnify.scaleTo(c),this._sizeChanged=!0}},b.prototype.onConcat=function(a){return function(b,c){var d=Math.max(a/b.w,1/b.h);if(d>=1)return void c.identity();b.w=b.w*d|0,b.h=b.h*d|0,c.scaleX=c.scaleY=d}},b.prototype.onMotionComplete=function(a){if(!this._sizeChanged)return void this.stage.emit("photoFrameDisable",{type:"photoFrameDisable",visible:!0});this._targetWidth<=0?this.imageTransform.identity():this.imageTransform.width=this._targetWidth,this.invalidate(),this._disable=!1,this._sizeChanged=!1;var b=this.stage.root;Math.max(b.width,b.height)>Math.min(this.stage.viewport.width,this.stage.viewport.height)&&(this.stage.screenFitEnable=!1),this.pushHistory()},b.prototype.onBitmapDataUpdate=function(a){var b,c=this._targetWidth;c<=0&&(c=this.stage.maskedWidth),b=c/this.stage._editingCanvas.width,this.stage.magnify.scale=b,this.stage.magnify.pivotX=this.stage.editingSprite.width>>1,this.stage.magnify.pivotY=this.stage.editingSprite.height>>1,this.stage.emit("photoFrameDisable",{type:"photoFrameDisable",visible:!0})},b.prototype.onReset=function(a){this.stage.once(w.default.BITMAPDATA_UPDATE,this.onResetComplete,this),this.reset(this._backupSnapshot,!0)},b.prototype.onResetComplete=function(a){this.stage.magnify.fitToScreen()},b.prototype.onResizeSave=function(){this.save()},b.prototype.onResizeRestore=function(){this.restore()},(0,j.default)(b,[{key:"transform",get:function(){return this._transforms[0]}},{key:"modified",get:function(){return!!this.stage.ready&&(this.entrySize>0?this._targetWidth!=this.entrySize:this._targetWidth>0&&this.stage.bitmapdata.sourceWidth!=this._targetWidth)}},{key:"screenFitEnable",get:function(){return this.stage.screenFitEnable},set:function(a){if(a)this.stage.magnify.autoScale(a);else{var b=this._targetWidth<=0?this.stage.maskedWidth:this._targetWidth,c=b/this.stage.bitmapdata.width;this.stage.magnify.scaleTo(c)}}}]),b}(r.default);b.default=x},function(a,b,c){"use strict";(function(a){function b(a){return a&&a.__esModule?a:{"default":a}}var d=c(4),e=b(d),f=c(22),g=b(f);!function(){function b(a,b,c,d){PIXI.Sprite.call(this),this.initialize(a,b,c,d),this.draw(a)}var d={};d.Func=c(34),b.LEFT_TOP="leftTop",b.RIGHT_TOP="rightTop",b.RIGHT_BOTTOM="rightBottom",b.LEFT_BOTTOM="leftBottom";var f=b.prototype=(0,g.default)(PIXI.Sprite.prototype);f.initialize=function(a,b,c,e){this.type=a,this.size=d.Func.getDefaultParameters(b,20),this.half=this.size/2,this.defaultColor=16777215,this.thickness=d.Func.getDefaultParameters(c,4),this.shapeColor=d.Func.getDefaultParameters(e,this.defaultColor),this.buttonAreaAlpha=0,this.buttonAreaColor=4359668,this.interactive=!0,this.buttonMode=!0,this.defaultCursor="default",this.graphics=new PIXI.Graphics,this.buttonArea=new PIXI.Graphics,this.addChild(this.graphics),this.addChild(this.buttonArea)},f.draw=function(a){switch(this.drawButtonArea(),a){case b.LEFT_TOP:this.drawLeftTop();break;case b.RIGHT_TOP:this.drawRightTop();break;case b.RIGHT_BOTTOM:this.drawRightBottom();break;case b.LEFT_BOTTOM:this.drawLeftBottom()}},f.changeColor=function(a){this.shapeColor=a,this.draw(this.type)},f.drawButtonArea=function(){var a=this.half,b=this.size;this.buttonArea.clear(),this.buttonArea.beginFill(this.buttonAreaColor,this.buttonAreaAlpha),this.buttonArea.drawRect(-a,-a,b,b),this.buttonArea.endFill()},f.drawLeftTop=function(){var a=this.half,b=this.thickness;this.graphics.clear(),this.graphics.beginFill(this.shapeColor),this.graphics.drawRect(-b,-b,a,b),this.graphics.drawRect(-b,-b,b,a),this.graphics.endFill()},f.drawRightTop=function(){var a=this.half,b=this.thickness;this.graphics.clear(),this.graphics.beginFill(this.shapeColor),this.graphics.drawRect(-(a-b),-b,a,b),this.graphics.drawRect(0,-b,b,a),this.graphics.endFill()},f.drawRightBottom=function(){var a=this.half,b=this.thickness;this.graphics.clear(),this.graphics.beginFill(this.shapeColor),this.graphics.drawRect(-(a-b),0,a,b),this.graphics.drawRect(0,b,b,-a),this.graphics.endFill()},f.drawLeftBottom=function(){var a=this.half,b=this.thickness;this.graphics.clear(),this.graphics.beginFill(this.shapeColor),this.graphics.drawRect(-b,0,a,b),this.graphics.drawRect(-b,b,b,-a),this.graphics.endFill()},void 0!==(0,e.default)(a)&&void 0!==(0,e.default)(a.exports)?a.exports=b:usenamespace("editor.es5.ui").CornerShape=b}()}).call(b,c(6)(a))},function(a,b,c){"use strict";(function(a){var b=c(4),d=function(a){return a&&a.__esModule?a:{"default":a}}(b);!function(){var b={};b.NUM_0=48,b.NUM_1=49,b.NUM_2=50,b.NUM_3=51,b.NUM_4=52,b.NUM_5=53,b.NUM_6=54,b.NUM_7=55,b.NUM_8=56,b.NUM_9=57,b.SPACE=32,b.BACK_SPACE=8,b.ENTER=13,b.SHIFT=16,b.CTRL=17,b.ALT=18,b.ESC=27,b.LEFT_ARROW=37,b.RIGHT_ARROW=39,b.UP_ARROW=39,b.DOWN_ARROW=40,b.DELETE=46,b.F1=112,b.F2=113,b.F3=114,b.F4=115,b.Q=81,b.W=87,b.E=69,b.R=82,b.A=65,b.S=83,b.D=68,b.F=70,b.Z=90,b.X=88,b.C=67,b.V=86,b.T=84,b.B=66,void 0!==(0,d.default)(a)&&void 0!==(0,d.default)(a.exports)?a.exports=b:usenamespace("editor.es5.consts").KeyCode=b}()}).call(b,c(6)(a))},function(a,b,c){"use strict";(function(a){function b(a){return a&&a.__esModule?a:{"default":a}}var d=c(4),e=b(d),f=c(38),g=b(f);!function(){function b(a){this._worldTransform=a,r=document.createElement("canvas"),s=document.createElement("canvas"),t=r.getContext("2d"),u=s.getContext("2d")}function d(a,b,c,d){for(var e=c,g=0,h=1-e,i={},j=function(a,b){if(a<<=0,!((b<<=0)<0||b>d)){var c=i[b];c?c.setValue(a):i[b]=new f(a)}};e>=g;)j(e+a,g+b),j(g+a,e+b),j(-e+a,g+b),j(-g+a,e+b),j(-e+a,-g+b),j(-g+a,-e+b),j(e+a,-g+b),j(g+a,-e+b),g++,h<=0?h+=2*g+1:(e--,h+=2*(g-e)+1);return i}function f(a){this.min=a,this.max=a}function h(a,b,c){for(var d,e=b.length,f=0;f<e;f++)d=b[f],"rect"==d.type?p(d,c):q(d,c);a.data.set(t.getImageData(0,0,r.width,r.height).data)}function i(a,b,c,d,e,f,g,h,i){if(e<2||f<2)return null;var j=g.matrix.clone(),m=h.matrix.clone(),n=e*g.scaleX>>0,o=f*g.scaleY>>0,p=c*g.scaleX>>0,q=d*g.scaleY>>0;if(n<1||o<1)return null;var t,v,w={x:p,y:q,w:n,h:o},x=i.width,y=i.height;return m=m.inverse(),m.preppend(j),s.width=s.height=Math.max(x,y),k(u,m,r,{x:0,y:0}),t=u.getImageData(p,q,n,o),v=l(t,w,e,b),{mosaic:v,origin:t}}function j(a,b,c){for(var d=0;d<c.length;d++)a[b+d]=c[d]}function k(a,b,c,d){a.save(),a.transform(b.m11,b.m21,b.m12,b.m22,b.tx,b.ty),a.drawImage(c,d.x,d.y),a.restore()}function l(a,b,c,d){var e,f,g,h=a,i=h.width/c*d>>0,j=h.width,k=h.height,l=0,n=0,o=h.data;return i<=1?h:(b.x<0&&(l-=b.x),b.y<0&&(n-=b.y),4*l,e=(k-n)%i,f=(k-n)/i>>0,g=0==e?f:f+1,m(o,l,n,i,g,e,j),h)}function m(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,p,q,r,s,t,u,v,w,x=4*b|0,y=4*g|0;for(j=0;j<e;j++){for(h=(c+j*d)*y+x|0,i=(c+j*d+1)*y|0,m=(i/4|0)%g,n=0===m?g:m,p=(n-b)%d,q=a.subarray(h,i),0,s=4*n-x,t=j<e-1||j==e-1&&0===f?d:f,r=o(s,h,d,a,y,t,p),w=-1,s=n-b,k=0;k<s;k++)k%d==0&&w++,m=r[w],u=4*k|0,q[u]=m.r,q[u+1]=m.g,q[u+2]=m.b;for(v=f>0&&j==e-1?f:d,l=0;l<v;l++){w=h+l*y|0;for(var z=0;z<q.length;z+=4)a[w+z]=q[z],a[w+z+1]=q[z+1],a[w+z+2]=q[z+2]}}}function n(a,b,c){var d,e,f=b||{r:0,g:0,b:0},g=f.r,h=f.g,i=f.b;d=b?1:0;for(var j=0;j<c.length;j++)e=c[j],a[e+3]>0&&(g+=a[e],h+=a[e+1],i+=a[e+2],d++);return f.r=g/d|0,f.g=h/d|0,f.b=i/d|0,f}function o(a,b,c,d,e,f,g){var h,i,j,k,l,m,o,p,q,r,s,t,u,v=[],w=Math.ceil(a/(4*c)),x=f*e|0,y=c/3|0,z=g/3|0;for(h=0;h<w;h++)u=b+4*h*c|0,o=(h==w-1?g:c)>>1,p=f>>1,q=u+4*o+p*e|0,j=u+4*((h==w-1?g:c)-1)|0,k=u+x,l=j+x,t=n(d,null,[u,j,k,l,q]),c<6||h==w-1&&g>0||f<6||(m=h==w-1?z:y,r=m*e|0,s=4*m+r|0,i=u+s|0,j=i+s|0,k=i+r|0,l=j+r|0,t=n(d,t,[i,j,k,l])),v.push(t);return v.slice()}function p(a,b){if(a.result){var c=a.result.mosaic,d=a.transform,e=d.matrix.clone(),f=b.matrix.clone();e=e.inverse(),e.preppend(f),s.width=c.width,s.height=c.height,u.putImageData(c,0,0),k(t,e,s,{x:a.x*d.scaleX,y:a.y*d.scaleY})}}function q(a,b){if(a.result){var c,e,f,g,h,i,l=a.transform,m=l.matrix.clone(),n=b.matrix.clone(),o=a.result.origin,p=a.result.mosaic,q=a.radius*l.scaleX>>0,r=d(q,q,q,p.height),v=p.width,w=p.width,x=p.height,y=Math.min(x,p.height),z=u.createImageData(p).data;m=m.inverse(),m.preppend(n);for(var A=0;A<y;A++)(f=r[A])&&(g=f.min<<0,h=f.max+1<<0,g<0&&(g=0),h>v&&(h=v),i=A*w,e=p.data.subarray(4*(i+g)|0,4*(i+h)|0),e.length&&(c=v*A+g,j(z,4*c|0,e)));s.width=p.width,s.height=p.height,j(o.data,0,z),u.putImageData(o,0,0),k(t,m,s,{x:a.x*l.scaleX-q|0,y:a.y*l.scaleY-q|0})}}var r,s,t,u,v=c(39).loop;if(b.prototype={constructor:b,applyFilter:function(a,b,c,d,e,f){var g=this._areas;if(!g||!g.length)return!1;b.data.set(a.data),r.width=b.width,r.height=b.height,t.putImageData(b,0,0);for(var i=0;i<g.length;i++)this.onFilterLoop(i,g.length,b,b);return h(b,g,this._worldTransform),!0},applyFilterAsync:function(a,b,c,d,e,f,g,i){var j=this._areas;if(!j||!j.length)return!1;var k=a,l=parseInt(j.length);return b.data.set(k.data),r.width=b.width,r.height=b.height,t.putImageData(b,0,0),v(0,l,this.onFilterLoop,[b,b],this,g,function(){h(b,j,this._worldTransform),i()}.bind(this)),!0},onFilterLoop:function(a,b,c,d){var e=this._areas[a];switch(e.type){case"rect":e.result=this.applyRect(d,d,e.blockSize,e.x,e.y,e.width,e.height,e.transform,e.originRect);break;case"circle":e.result=this.applyCircle(d,d,e.blockSize,e.x,e.y,e.radius,e.transform,e.originRect)}return a+1},addArea:function(a){a&&(this._areas||(this._areas=[]),this._areas.push(a))},removeAll:function(){if(this._areas&&this._areas.length>0){for(var a=0;a<this._areas.length;a++)this.removeArea(this._areas[a]);this._areas=[]}},removeLastArea:function(){return this._areas&&this.removeArea(this._areas.pop()),this.filterCount},removeArea:function(a){for(var b in a)delete a[b]},applyCircle:function(a,b,c,d,e,f,g,h){if(c=parseInt(c),d=parseInt(d),e=parseInt(e),f=parseInt(f),c<1)throw new RangeError("blockSize 값은 1보다 작을 수 없습니다.");var j=d-f<<0,k=e-f<<0,l=2*f+1<<0,m=2*f+1<<0,n=i(a,c,j,k,l,m,g,this._worldTransform,h);if(n)return n},applyRect:function(a,b,c,d,e,f,g,h,j){d=d||0,e=e||0,f=f||a.width,g=g||a.height;var k=i(a,c,d,e,f,g,h,this._worldTransform,j);if(k)return k}},(0,g.default)(b.prototype,{name:{get:function(){return"MosaicFilter"}},filterCount:{get:function(){return this._areas?this._areas.length:0}},changed:{get:function(){return this._areas&&this._areas.length}},areas:{get:function(){return this._areas?this._areas:[]},set:function(a){this._areas=a}}}),f.prototype={setValue:function(a){a<this.min&&(this.min=a),this.max<a&&(this.max=a)}},void 0!==(0,e.default)(a)&&void 0!==(0,e.default)(a.exports))a.exports=b;else{usenamespace("editor.filter").MosaicFilter=b}}()}).call(b,c(6)(a))},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(1),h=d(g),i=function(){function a(){(0,f.default)(this,a)}return(0,h.default)(a,null,[{key:"DELETE",get:function(){return"delete"}},{key:"ROTATION",get:function(){return"rotation"}},{key:"TOP_LEFT",get:function(){return"topLeft"}},{key:"TOP_CENTER",get:function(){return"topCenter"}},{key:"TOP_RIGHT",get:function(){return"topRight"}},{key:"MIDDLE_LEFT",get:function(){return"middleLeft"}},{key:"MIDDLE_CENTER",get:function(){return"middleCenter"}},{key:"MIDDLE_RIGHT",get:function(){return"middleRight"}},{key:"BOTTOM_LEFT",get:function(){return"bottomLeft"}},{key:"BOTTOM_CENTER",get:function(){return"bottomCenter"}},{key:"BOTTOM_RIGHT",get:function(){return"bottomRight"}}]),a}();b.default=i},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(1),h=d(g),i=function(){function a(){(0,f.default)(this,a)}return(0,h.default)(a,null,[{key:"NONE",get:function(){return"rotationNone"}},{key:"DELETE",get:function(){return"rotationDelete"}},{key:"TOP_LEFT",get:function(){return"rotationTopLeft"}},{key:"TOP_CENTER",get:function(){return"rotationTopCenter"}},{key:"TOP_RIGHT",get:function(){return"rotationTopRight"}},{key:"MIDDLE_LEFT",get:function(){return"rotationMiddleLeft"}},{key:"MIDDLE_RIGHT",get:function(){return"rotationMiddleRight"}},{key:"BOTTOM_LEFT",get:function(){return"rotationBottomLeft"}},{key:"BOTTOM_CENTER",get:function(){return"rotationBottomCenter"}},{key:"BOTTOM_RIGHT",get:function(){return"rotationBottomRight"}}]),a}();b.default=i},function(a,b,c){"use strict";function d(a,b,c,d,e,f,g,h){return!(Math.min(a,c)>Math.max(e,g)||Math.max(a,c)<Math.min(e,g)||Math.min(b,d)>Math.max(f,h)||Math.max(b,d)<Math.min(f,h))}function e(a,b,c,d,e,f,g,h){var i=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,j=c-a,k=d-b,l=g-e,m=h-f,n=j*j+k*k,o=l*j+m*k,p=o,q=l*l+m*m,r=-n*q+o*p;if(0==r)return null;var s=e-a,t=f-b,u=s*j+t*k,v=s*l+t*m,w=(-u*q+o*v)/r,x=(n*v-p*u)/r;return w<0||w>1||x<0||x>1?null:(i=i||{},i.x=a+w*(c-a),i.y=b+w*(d-b),i)}function f(a,b,c,d,e,f,g,h){var i=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,j=c-a,k=d-b,l=g-e,m=h-f,n=j*j+k*k,o=l*j+m*k,p=o,q=l*l+m*m,r=-n*q+o*p;if(0==r)return null;var s=e-a,t=f-b,u=s*j+t*k,v=s*l+t*m,w=(-u*q+o*v)/r;return i=i||{},i.x=a+w*(c-a),i.y=b+w*(d-b),i}function g(a,b,c,d,f){for(var g=void 0,h=void 0,i=void 0,j=void 0,k=void 0,l=0,m=f.length;l<m&&(g=f[l],h=f[l+1],i=f[l+2],j=f[l+3],!(k=e(a,b,c,d,g,h,i,j)));l+=4);return k}b.__esModule=!0,b.pseudoTestLine=d,b.getIntersection=e,b.externalDivision=f,b.getIntersectionWithlines=g;c(53)},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(123),f=d(e),g=c(37),h=d(g),i=c(0),j=d(i),k=c(2),l=d(k),m=c(1),n=d(m),o=c(3),p=d(o),q=c(76),r=d(q),s=c(77),t=d(s),u=c(98),v=d(u),w=c(189),x=c(137),y=d(x),z=c(10),A=c(136),B=d(A),C=c(338),D=d(C),E=function(a){function b(c,d){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{useSnap:!0,snapAngle:5};(0,j.default)(this,b);var f=(0,l.default)(this,a.call(this));return f.stageLayer=c,f.textLayer=d,f.options=e,f.idCnt=0,f.texts={},f.isEditing=!1,f.addDebug(),f}return(0,p.default)(b,a),(0,n.default)(b,null,[{key:"SELECT",get:function(){return"select"}},{key:"DESELECT",get:function(){return"deselect"}},{key:"DELETED",get:function(){return"deleted"}},{key:"REQ_INPUT",get:function(){return"requestInput"}},{key:"TEXT_MARGIN",get:function(){return{bottom:5,left:10,right:10,top:5}}}]),b.prototype.initialize=function(){this.textLayer.updateTransform(),this.options.deleteButtonOffsetY=0,this.transformTool=new t.default(this.stageLayer,this.textLayer,this.options),this.transformTool.on(t.default.CONTROL_UP,this.onControlUp,this)},b.prototype.textDelete=function(){this.transformTool.target&&this.onTextDeleteClick(this.transformTool.target)},b.prototype.createText=function(a){var c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,d=this.addText(a,null,c);return d.pivot.x=d.width/2,d.pivot.y=d.height/2,this.emit(b.SELECT,{id:d.ID,option:a,scale:d.scaleForOrigin}),d},b.prototype.setTarget=function(a){this.transformTool.activeTarget(a),this.transformTool.draw()},b.prototype.addText=function(a,b,c){a.textPadding||(a.textPadding={left:0,top:0,right:0,bottom:0});var d=new y.default(this.stageLayer.options.canvasLimitSize),e=new r.default(this.stageLayer.options.canvasLimitSize);if(e.ID=this.idCnt,e.signText=d,b&&b.transform){var f=b.transform;e.x=f.x,e.y=f.y,e.scale.x=f.scaleX,e.scale.y=f.scaleY,e.rotation=f.rotation}return this.addEvents(e),this.applyText(e,a,b,c?{x:c,y:c}:null),this.textLayer.addChild(e),this.texts[this.idCnt]=e,this.idCnt++,e},b.prototype.updateText=function(a,b){var c=this.texts[a];c&&(""==b.text&&(b.text=c.option.text),this.applyText(c,b,null,c.scaleForOrigin),c.visible=!0,this.isEditing=!1,this.checkBound(c))},b.prototype.addEvents=function(a){a._textDownListener=this.onTextDown.bind(this),a._textDeselectListener=this.onDeselect.bind(this),a._textDBClickListener=this.onDBClick.bind(this),a._textDeleteListener=this.onTextDeleteClick.bind(this),a.on("mousedown",a._textDownListener),a.on(t.default.DELETE,a._textDeleteListener),a.on(t.default.DESELECT,a._textDeselectListener),a.on(t.default.DBCLICK,a._textDBClickListener)},b.prototype.removeEvents=function(a){a.off("mousedown",a._textDownListener),a.off(t.default.DELETE,a._textDeleteListener),a.off(t.default.DESELECT,a._textDeselectListener),a.off(t.default.DBCLICK,a._textDBClickListener),a._textDownListener=null,a._textDeselectListener=null,a._textDBClickListener=null,a._textDeleteListener=null},b.prototype.checkBound=function(a){var b=v.default.mouseBoundary,c=Math.cos(a.rotation),d=Math.sin(a.rotation),e=new PIXI.Matrix,f=void 0,g=void 0,h=void 0,i=void 0,j=void 0,k=void 0,l=void 0,m=void 0,n=void 0,o=void 0,p=new B.default(a.width/2,a.height/2);e.set(a.scale.x*c,a.scale.x*d,a.scale.y*-d,a.scale.y*c,a.x,a.y),f=new D.default({x:0,y:0},{x:a.width,y:0},{x:a.width,y:a.height},{x:0,y:a.height}),g=this.textLayer.scale.x<0?this.textLayer.scale.y<0?new D.default(e.applyInverse(b.br),e.applyInverse(b.bl),e.applyInverse(b.tl),e.applyInverse(b.tr)):new D.default(e.applyInverse(b.tr),e.applyInverse(b.tl),e.applyInverse(b.bl),e.applyInverse(b.br)):this.textLayer.scale.y<0?new D.default(e.applyInverse(b.bl),e.applyInverse(b.br),e.applyInverse(b.tr),e.applyInverse(b.tl)):new D.default(e.applyInverse(b.tl),e.applyInverse(b.tr),e.applyInverse(b.br),e.applyInverse(b.bl)),this.checkBoxCollision(f,g)||(i=[p.clone().sub(g._tlv),p.clone().sub(g._trv),p.clone().sub(g._brv),p.clone().sub(g._blv)],h=[new B.default(g._a.y,-g._a.x).normalize(),new B.default(g._b.y,-g._b.x).normalize(),new B.default(g._c.y,-g._c.x).normalize(),new B.default(g._d.y,-g._d.x).normalize()],j=this.checkLength(h,i),(k=j.index)<0||(o=g._basevs[k],l=i[k].clone().add(h[k].scale(-j.len)),l.length>o.length?l=o.clone():(0!==l.x&&0!==o.x&&l.x/Math.abs(l.x)!=o.x/Math.abs(o.x)||0!==l.y&&0!==o.y&&l.y/Math.abs(l.y)!=o.y/Math.abs(o.y))&&(l=new B.default),m=g._boundvs[k].clone().add(l),n=e.apply(new PIXI.Point(m.x-p.x,m.y-p.y)),a.x=n.x,a.y=n.y))},b.prototype.checkBoxCollision=function(a,b){var c=void 0,d=void 0;return!(!a.AABB(b)||(c=a.clone(),d=b.clone(),c.setPoints(d.transform.applyInverse(c._tl),d.transform.applyInverse(c._tr),d.transform.applyInverse(c._br),d.transform.applyInverse(c._bl)),d.setPoints({x:0,y:0},{x:d._width,y:0},{x:d._width,y:d._height},{x:0,y:d._height}),!d.AABB(c)))},b.prototype.checkLength=function(a,b){for(var c,d=1/0,e=-1,f=0;f<a.length;f++)(c=a[f].dot(b[f]))>0&&c<d&&(d=c,e=f);return{index:e,len:d}},b.prototype.checkInner=function(a,b){for(var c,d=0;d<b.length;d++)if(c=a[d],c.cross(b[d]>0))return!1;return!0},b.prototype.restore=function(a){if(a){this.texts={},this.idCnt=0;for(var b=0;b<a.length;b++){var c=a[b],d=this.addText(c.option,c),e=c.transform;d.x=e.x,d.y=e.y,d.scale.x=e.scaleX,d.scale.y=e.scaleY,d.pivot.x=e.pivotX,d.pivot.y=e.pivotY,d.rotation=e.rotation,d.childIndex=c.childIndex,d.originW=e.originW,d.originH=e.originH,d.image.scale.x=e.childScaleX,d.image.scale.y=e.childScaleY,d.childIndex=c.childIndex}}},b.prototype.updateTransformTool=function(){this.transformTool.updateGraphics()},b.prototype.applyText=function(a,c,d,e){var f=(0,h.default)(c,{}),g=void 0,i=void 0,j=c.text.split("\n"),k=0,l=0,m=.4*c.fontSize,n=[],o=0,p="",q=void 0,r=void 0,s=void 0,t=void 0,u=void 0;this.textLayer.scale.x,this.textLayer.scale.y;f.scale=a.scaleForOrigin,f.text="말말",g=a.signText.drawSign(f),s={w:g.width,h:g.height};for(var v=0;v<j.length;v++){r=f.text=j[v],0;var x=/[^(가-힣ㄱ-ㅎㅏ-ㅣa-zA-Z0-9)]/gi;x.test(r)&&(p=r.match(x)),f.text.length>1?(t=f.text.charAt(0),u=f.text.charAt(f.text.length-1),f.text=(" "==t?"말"+t:t+"말")+f.text.substr(1,f.text.length-2)+(" "==u?u+"말":"말"+u),g=a.signText.drawSign(f),f.text=j[v],o=g.height,q=g.rect,g.rect=q,g.rect.h=o,g.rect.w=g.width-s.w):(p.length!=f.text.length&&""!=f.text||(f.text+="ㅣ",g=a.signText.drawSign(f),o=g.height,q=g.rect),f.text=j[v],g=a.signText.drawSign(f),o||(o=g.height,q=g.rect),g.rect=q,g.rect.h=o,g.rect.w=g.width),n.push((0,h.default)(g.rect,{})),l+=g.rect.h,g.rect.w>k&&(k=g.rect.w),q=null,o=0}l+=m*(j.length-1),i={mainRect:{x:b.TEXT_MARGIN.left,y:b.TEXT_MARGIN.top,w:k+b.TEXT_MARGIN.left+b.TEXT_MARGIN.right,h:l+b.TEXT_MARGIN.top+b.TEXT_MARGIN.bottom},rects:n,gap:m},c.text=j.join("\n");var y=w.SVGCreator.createText(c,i,this.idCnt),z=void 0;z=d||{x:0,y:0,width:i.mainRect.w,height:i.mainRect.h},a.option=c,a.setSVG(y,z.x,z.y,z.width,z.height),e&&(z.width*=e.x,z.height*=e.y,a.drawSvg(0,0,z.width,z.height))},b.prototype.show=function(){for(var a in this.texts)this.texts[a].visible=!0;this.transformTool.show()},b.prototype.hide=function(){for(var a in this.texts)this.texts[a].visible=!1;this.transformTool.hide()},b.prototype.deleteText=function(a){if(null!==a){var b=this.transformTool.selectedControl;b&&b.isMouseDown&&b.onMouseUp(),this.removeEvents(a),delete this.texts[a.ID],this.textLayer.removeChild(a),this.transformTool.releaseTarget(),a.signText.clear(),a.signText=null,a.option=null,a.delete()}},b.prototype.addDebug=function(){window.document.addEventListener("keyup",this.onKeyUp.bind(this))},b.prototype.onTextDown=function(a){1!=this.isEditing&&(a.stopPropagation(),this.downTarget=a.target,this.downMouseX=a.data.global.x,this.downMouseY=a.data.global.y,this.textLayer.setChildIndex(a.target,this.textLayer.children.length-1),this.transformTool.setTarget(a),this.emit(b.SELECT,{id:this.downTarget.ID,option:this.downTarget.option}))},b.prototype.onDeselect=function(a){this.emit(b.DESELECT)},b.prototype.releaseTarget=function(){this.transformTool&&this.transformTool.releaseTarget()},b.prototype.clear=function(){var a=(0,h.default)({},this.texts);for(var b in a)this.deleteText(a[b])},b.prototype.onControlUp=function(a){this.emit(a.type,a)},b.prototype.onDBClick=function(a){var c=a.target,d=this.stageLayer.magnify.scale,e=void 0,f=new PIXI.Matrix,g=void 0,h=void 0,i={x:1,y:1};c.updateTransform(),e=c.worldTransform.apply({x:c.width/2*c.scaleSignX,y:c.height/2*c.scaleSignY}),g=c.scaleForOrigin,h=c.parent,g.x=Math.abs(g.x),g.y=Math.abs(g.y),i.x*=Math.abs(h.scale.x*d),i.y*=Math.abs(h.scale.y*d),e={x:e.x-c.width/2*i.x,y:e.y-c.height/2*i.y},this.emit(b.REQ_INPUT,{id:c.ID,option:c.option,scale:{x:g.x*i.x,y:g.y*i.y},position:e,transform:f}),c.visible=!1,this.isEditing=!0,this.releaseTarget()},b.prototype.onTextDeleteClick=function(a){this.deleteText(a),this.emit(b.DELETED,a)},b.prototype.onKeyUp=function(a){a.keyCode},b.prototype.resize=function(){},(0,n.default)(b,[{key:"snapshot",get:function(){var a=[];for(var b in this.texts){var c=this.texts[b],d=c.snapshot;d.option=c.option,d.childIndex=this.textLayer.getChildIndex(c),a.push(d)}return a.sort(function(a,b){return a.childIndex<b.childIndex?-1:a.childIndex>b.childIndex?1:0}),a}},{key:"lastText",get:function(){for(var a=this.textLayer.children,b=a.length;b--;)if((0,z.indexOf)(this.texts,a[b]))return a[b];return null}},{key:"modified",get:function(){return(0,f.default)(this.texts).length>0}}]),b}(PIXI.utils.EventEmitter);b.default=E},function(a,b,c){"use strict";b.__esModule=!0,b.SVGCreator=void 0;var d=c(0),e=function(a){return a&&a.__esModule?a:{"default":a}}(d);b.SVGCreator=function(){function a(){(0,e.default)(this,a)}return a.createText=function(b,c,d){for(var e=b.text.split("\n"),f="",g=0,h=void 0,i=0;i<e.length;i++)h=-c.rects[i].t+(0==i?0:c.rects[i-1].h+c.gap),f+=a.getTextElement(e[i],b,{x:-c.rects[i].l+c.mainRect.x,y:g+h+c.mainRect.y}),g+=h+c.rects[i].t;return'<svg width="'+c.mainRect.w+'" height="'+c.mainRect.h+'" id="'+d+'"><rect width="100%" height="100%" fill="'+b.bgColor+'" fill-opacity="'+b.bgAlpha+'"></rect>'+f+"</svg>"},a.getTextElement=function(a,b,c){return'<text opacity="'+b.textAlpha+'" dominant-baseline="text-before-edge" text-anchor="start" font-family="'+b.font+'" font-size="'+b.fontSize+'" fill="'+b.textColor+'" x="'+c.x+'" y="'+c.y+'" font-weight="'+(b.bold?"bold":"normal")+'" font-style="'+(b.italic?"italic":"normal")+'"><![CDATA['+a+"]]></text>"},a}()},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(2),h=d(g),i=c(1),j=d(i),k=c(3),l=d(k),m=c(191),n=d(m),o=function(a){function b(){(0,f.default)(this,b);var c=(0,h.default)(this,a.call(this));return c.initialize(),
c}return(0,l.default)(b,a),(0,j.default)(b,null,[{key:"READY",get:function(){return"ready"}}]),b.prototype.initialize=function(){this.name="Mask",this.buttonMode=!1,this.interactive=!0,this.rotatable=!1,this.useGrid=!0,this.scaleSignX=1,this.scaleSignY=1,this.maskVO=maskVO},b.prototype.onReady=function(){this.initialize(),this.emit(b.READY)},b.prototype.initialize=function(){this.bitmapWidth=this.defaultSizeX,this.bitmapHeight=this.defaultSizeY},b.prototype.checkLimitSize=function(){var a=!1,b=this.width,c=this.height;return b>this.maxSizeX?(a=!0,this.width=this.maxSizeX):b<this.minSizeX&&(a=!0,this.width=this.minSizeX),c>this.maxSizeY?(a=!0,this.height=this.maxSizeY):c<this.minSizeY&&(a=!0,this.height=this.minSizeY),a},(0,j.default)(b,[{key:"maskVO",set:function(a){a&&(this._maskVO=a,this.maxSize=a.maxSize,this.defaultSize=a.defaultSize,this.minSize=a.minSize)},get:function(){return this._maskVO}},{key:"maxSize",set:function(a){if(a&&""!==a){this._maxSize=a;var b=a.split("x");this.maxSizeX=b[0],this.maxSizeY=b[1],void 0}},get:function(){return this._maxSize}},{key:"defaultSize",set:function(a){if(a&&""!==a){this._defaultSize=a;var b=a.split("x");this.defaultSizeX=b[0],this.defaultSizeY=b[1],void 0}},get:function(){return this._defaultSize}},{key:"minSize",set:function(a){if(a&&""!==a){this._minSize=a;var b=a.split("x");this.minSizeX=b[0],this.minSizeY=b[1],void 0}},get:function(){return this._minSize}}]),b}(n.default);b.default=o},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(1),h=d(g),i=c(2),j=d(i),k=c(3),l=d(k),m=c(79),n=(d(m),c(192)),o=d(n),p=c(15),q=(d(p),c(78)),r=(d(q),c(139)),s=d(r),t=c(80),u=(d(t),function(a){function b(c){(0,f.default)(this,b);var d=(0,j.default)(this,a.call(this));return d.bitmapData=c,d}return(0,l.default)(b,a),b.prototype._initialize=function(){this._bitmapHalfWidth=this.bitmapData.width/2,this._bitmapHalfHeight=this.bitmapData.height/2,this.bitmap||(this.bitmap=new o.default,this.addChild(this.bitmap),this.pivotOffset=new PIXI.Point,this.registrationPoint=new PIXI.Graphics,this.registrationPoint.beginFill(5025616,1),this.registrationPoint.drawCircle(0,0,0),this.registrationPoint.endFill(),this.addChild(this.registrationPoint)),this.bitmap.x=-this.bitmapHalfWidth,this.bitmap.y=-this.bitmapHalfHeight},b.prototype.hitTestWithGlobalPoint=function(a){var b=this.toLocal(a),c=this.getLocalBounds();return b.x>=c.x&&b.x<=c.x+c.width&&b.y>=c.y&&b.y<=c.y+c.height},b.prototype.setPivot=function(a){this.pivot.x=a.x,this.pivot.y=a.y},b.prototype.destroy=function(){this.bitmap&&(this.removeChild(this.bitmap),this.bitmap.destroy(),this.bitmap=null),this.registrationPoint&&(this.removeChild(this.registrationPoint),this.registrationPoint.destroy(),this.registrationPoint=null),this.graphics&&(this.removeChild(this.graphics),this.graphics.destroy(),this.graphics=null),this.bitmapData=null,a.prototype.destroy.call(this)},b.prototype.getMovedRect=function(a,b){var c=this.lt,d=this.rt,e=this.rb,f=this.lb;return c.x+=a,c.y+=b,d.x+=a,d.y+=b,e.x+=a,e.y+=b,f.x+=a,f.y+=b,new s.default(c,d,e,f)},b.prototype.getRotatedRect=function(a){var b=this.rotation;this.rotation=a,this.updateTransform();var c=this.lt.clone(),d=this.rt.clone(),e=this.rb.clone(),f=this.lb.clone();return this.rotation=b,new s.default(c,d,e,f)},b.prototype.getScaledRect=function(a){var b=this.scale.x;this.scale.x=a,this.scale.y=a,this.updateTransform();var c=this.lt.clone(),d=this.rt.clone(),e=this.rb.clone(),f=this.lb.clone();return this.scale.x=b,this.scale.y=b,new s.default(c,d,e,f)},b.prototype.getScale=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,c=this.width,d=this.height;this.width=a,this.height=b,this.updateTransform();var e=this.scale.x,f=this.scale.y;return this.width=c,this.height=d,{scaleX:e,scaleY:f}},b.prototype.drawDimmed=function(){this.graphics||(this.graphics=new PIXI.Graphics,this.addChild(this.graphics)),this.graphics.clear(),this.graphics.beginFill(0,.83),this.graphics.drawRect(-1,-1,this.bitmapWidth+2,this.bitmapHeight+2),this.graphics.endFill(),this.graphics.x=-this.bitmapHalfWidth,this.graphics.y=-this.bitmapHalfHeight},b.prototype.drawBounds=function(){this.graphics||(this.graphics=new PIXI.Graphics,this.addChild(this.graphics)),this.graphics.clear(),this.graphics.beginFill(16724736,0),this.graphics.lineStyle(1,16724736),this.graphics.drawRect(0,0,this.bitmapWidth,this.bitmapHeight),this.graphics.endFill(),this.graphics.x=-this.bitmapHalfWidth,this.graphics.y=-this.bitmapHalfHeight},(0,h.default)(b,[{key:"bitmapWidth",set:function(a){this.bitmap.width=a,this._bitmapHalfWidth=a/2,this.bitmap.x=-this.bitmapHalfWidth,this.prevBitmapRegistrationPoint=this.localLt},get:function(){return this.bitmap.width}},{key:"bitmapHalfWidth",get:function(){return this._bitmapHalfWidth}},{key:"bitmapHeight",set:function(a){this.bitmap.height=a,this._bitmapHalfHeight=a/2,this.bitmap.y=-this.bitmapHalfHeight,this.prevBitmapRegistrationPoint=this.localLt},get:function(){return this.bitmap.height}},{key:"bitmapHalfHeight",get:function(){return this._bitmapHalfHeight}},{key:"bitmapRotation",set:function(a){this.rotation=a;var b=this.localLt,c=this.prevBitmapRegistrationPoint;this.pivotOffset=new PIXI.Point(b.x-c.x,b.y-c.y)},get:function(){return this.rotation}},{key:"bitmap",set:function(a){this._bitmap=a},get:function(){return this._bitmap}},{key:"lt",get:function(){return this.toGlobal(this.localLt)}},{key:"rt",get:function(){return this.toGlobal(this.localRt)}},{key:"rb",get:function(){return this.toGlobal(this.localRb)}},{key:"lb",get:function(){return this.toGlobal(this.localLb)}},{key:"center",get:function(){return this.toGlobal(new PIXI.Point)}},{key:"globalPivot",get:function(){return this.toGlobal(this.pivot)}},{key:"localLt",get:function(){return this.toLocal(this.bitmap.lt,this.bitmap)}},{key:"localRt",get:function(){return this.toLocal(this.bitmap.rt,this.bitmap)}},{key:"localRb",get:function(){return this.toLocal(this.bitmap.rb,this.bitmap)}},{key:"localLb",get:function(){return this.toLocal(this.bitmap.lb,this.bitmap)}},{key:"distanceBetweenLtAndCenter",get:function(){if(!this.registrationPoint)return new PIXI.Point(0,0);var a=this.localLt;return new PIXI.Point(this.registrationPoint.x-a.x,this.registrationPoint.y-a.y)}},{key:"left",get:function(){for(var a=this.bitmap.points,b=this.toGlobal(this.toLocal(a[0],this.bitmap)),c=1;c<a.length;c++){var d=this.toGlobal(this.toLocal(a[c],this.bitmap));d.x<b.x&&(b=d)}return b.x}},{key:"right",get:function(){for(var a=this.bitmap.points,b=this.toGlobal(this.toLocal(a[0],this.bitmap)),c=1;c<a.length;c++){var d=this.toGlobal(this.toLocal(a[c],this.bitmap));d.x>b.x&&(b=d)}return b.x}},{key:"top",get:function(){for(var a=this.bitmap.points,b=this.toGlobal(this.toLocal(a[0],this.bitmap)),c=1;c<a.length;c++){var d=this.toGlobal(this.toLocal(a[c],this.bitmap));d.y<b.y&&(b=d)}return b.y}},{key:"bottom",get:function(){for(var a=this.bitmap.points,b=this.toGlobal(this.toLocal(a[0],this.bitmap)),c=1;c<a.length;c++){var d=this.toGlobal(this.toLocal(a[c],this.bitmap));d.y>b.y&&(b=d)}return b.y}},{key:"points",get:function(){return{lt:this.lt.clone(),rt:this.rt.clone(),rb:this.rb.clone(),lb:this.lb.clone()}}},{key:"collisionRect",get:function(){return new s.default(this.lt,this.rt,this.rb,this.lb)}},{key:"bitmapData",set:function(a){this._bitmapData=a,this._initialize(),this.bitmap.bitmapData=a},get:function(){return this._bitmapData}},{key:"originalImageSize",get:function(){return this.bitmap.originalImageSize}}]),b}(PIXI.Container));b.default=u},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(1),h=d(g),i=c(2),j=d(i),k=c(3),l=d(k),m=c(15),n=(d(m),c(63)),o=d(n),p={x:0,y:0},q=function(a){function b(){var c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;(0,f.default)(this,b);var d=(0,j.default)(this,a.call(this));return d.bitmapData=c,d}return(0,l.default)(b,a),b.prototype.initialize=function(){this._image?(this._image.texture.destroy(),this._image.texture=PIXI.Texture.fromCanvas(this.textureCanvas),this._image.texture.update()):(this._image=new PIXI.Sprite(new PIXI.Texture(new PIXI.BaseTexture(this.textureCanvas))),this._mask=new PIXI.Graphics,this.addChild(this._image),this.addChild(this._mask)),this._originalImageWidth=this.bitmapData.width,this._originalImageHeight=this.bitmapData.height,this._mask.clear(),this._mask.drawRect(0,0,this._originalImageWidth,this._originalImageHeight),this.mask=this._mask,this._originalImageSize?(this._originalImageSize.width=this.originalImageWidth,this._originalImageSize.height=this.originalImageHeight):this._originalImageSize=new PIXI.Rectangle(0,0,this.originalImageWidth,this.originalImageHeight),this.lt||(this.lt=this.registrationPoint=o.default.getRectangle(0,0,0),this.rt=o.default.getRectangle(-0,0,0),this.rb=o.default.getRectangle(-0,-0,0),this.lb=o.default.getRectangle(0,-0,0),this.addChild(this.lt),this.addChild(this.rt),this.addChild(this.rb),this.addChild(this.lb),this.points=[this.lt,this.rt,this.rb,this.lb]),this.rt.x=this.rb.x=this._image.width,this.rb.y=this.lb.y=this._image.height},b.prototype.initDimmedLayer=function(){this._dimmedCanvas||(this._dimmedCanvas=document.createElement("canvas"),this._dimmedContext=this._dimmedCanvas.getContext("2d"),this._dimmedCanvas.style.display="none",document.body.appendChild(this._dimmedCanvas),this._dimmed=new PIXI.Sprite(new PIXI.Texture(new PIXI.BaseTexture(this._dimmedCanvas))),this.dimmedMaskAlpha=this.dimmedMaskAlpha,this.addChild(this._dimmed)),this._dimmedCanvas.width=this.originalImageWidth,this._dimmedCanvas.height=this.originalImageHeight;var a=this._dimmed.texture,b=a.frame;a.baseTexture.update(),b.width=this.originalImageWidth,b.height=this.originalImageHeight,a.frame=b},b.prototype.drawDimmedLayer=function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.8,c=a.canvas.width,d=a.canvas.height;a.save(),a.setTransform(1,0,0,1,0,0),a.clearRect(0,0,c,d),a.globalCompositeOperation="source-over",a.globalAlpha=b,a.fillStyle="#000",a.fillRect(0,0,c,d),a.restore()},b.prototype.showDimmed=function(){this._dimmed.visible=!0},b.prototype.hideDimmed=function(){this._dimmed.visible=!1},b.prototype.addSticker=function(a){this._stickerContainer=a,this.image.addChild(a)},b.prototype.removeSticker=function(){return this.image&&this.hasChild(this._stickerContainer,this.image)?this.image.removeChild(this._stickerContainer):null},b.prototype.saveTransform=function(a){return{pivotX:a.pivot.x,pivotY:a.pivot.y,scaleX:a.scale.x,scaleY:a.scale.y}},b.prototype.restoreTransform=function(a,b){var c=b.pivotX,d=void 0===c?0:c,e=b.pivotY,f=void 0===e?0:e,g=b.scaleX,h=void 0===g?1:g,i=b.scaleY,j=void 0===i?1:i;a.pivot.x=d,a.pivot.y=f,a.scale.x=h,a.scale.y=j},b.prototype.addSignature=function(a){this._signatureContainer=a,this.addChildAt(a,1)},b.prototype.removeSignature=function(){return this.hasChild(this._signatureContainer)?this.removeChild(this._signatureContainer):null},b.prototype.hasChild=function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;return a&&a.parent==b},b.prototype.punch=function(a,b,c,d,e,f){p.x=a,p.y=b;var g=this.image,h=g.worldTransform.clone(),i=this._dimmedContext,j=1/g.scale.x*(1/c),k=1/g.scale.y*(1/d);h.applyInverse(p,p),h.setTransform(p.x,p.y,0,0,j,k,f,0,0),this.dimmedMaskAlpha=this.dimmedMaskAlpha,i.save(),i.globalCompositeOperation="destination-out",i.setTransform(h.a,h.b,h.c,h.d,h.tx,h.ty),i.drawImage(e,0,0),i.restore()},(0,h.default)(b,[{key:"dimmedMaskAlpha",get:function(){return this._dimmedOpacity||0},set:function(a){this._dimmedOpacity=a,this._dimmedContext&&this.drawDimmedLayer(this._dimmedContext,a)}},{key:"width",set:function(a){this._image.width=a,this.rt.x=this.rb.x=a,this._dimmed&&(this._dimmed.width=a)},get:function(){return this._image.width}},{key:"height",set:function(a){this._image.height=a,this.rb.y=this.lb.y=a,this._dimmed&&(this._dimmed.height=a)},get:function(){return this._image.height}},{key:"bitmapData",set:function(a){null!==a&&(this._bitmapData=a,this._textureCanvas=a.canvas,this.initialize(),this.initDimmedLayer())},get:function(){return this._bitmapData}},{key:"textureCanvas",get:function(){return this._textureCanvas}},{key:"image",get:function(){return this._image}},{key:"originalImageSize",get:function(){return this._originalImageSize}},{key:"originalImageWidth",get:function(){return this._originalImageWidth}},{key:"originalImageHeight",get:function(){return this._originalImageHeight}}]),b}(PIXI.Container);b.default=q},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(2),h=d(g),i=c(1),j=d(i),k=c(3),l=d(k),m=c(15),n=(d(m),c(342)),o=d(n),p=c(198),q=d(p),r=function(a){function b(){(0,f.default)(this,b);var c=(0,h.default)(this,a.call(this));return c.initialize(),c}return(0,l.default)(b,a),(0,j.default)(b,null,[{key:"READY",get:function(){return"ready"}}]),b.prototype.initialize=function(){this.name="MaskVector",this.buttonMode=!1,this.interactive=!0,this.rotatable=!1,this.useGrid=!0,this.scaleSignX=1,this.scaleSignY=1},b.prototype.onReady=function(){this.emit(b.READY)},b.prototype.destroy=function(){this._maskVO=null,a.prototype.destroy.call(this)},b.prototype.checkLimitSize=function(){var a=!1,b=this.width;return b>this.maxSizeX?(a=!0,this.width=this.maxSizeX,this.scale.y=this.scale.x):b<this.minSizeX&&(a=!0,this.width=this.minSizeX,this.scale.y=this.scale.x),a},b.prototype.toString=function(){var a=" MaskVector["+this.x+", "+this.y+", "+this.width+", "+this.height+", "+this.scale.x+", "+this.scale.y+"]";return void 0,a},(0,j.default)(b,[{key:"maskVO",set:function(a){this._maskVO=a,this.maxSize=a.maxSize,this.defaultSize=a.defaultSize,this.minSize=a.minSize,this.loadDefaultSize(a)},get:function(){return this._maskVO}},{key:"maxSize",set:function(a){if(a&&""!==a){this._maxSize=a;var b=a.split("x");this.maxSizeX=b[0],this.maxSizeY=b[1]}},get:function(){return this._maxSize}},{key:"defaultSize",set:function(a){if(a&&""!==a){this._defaultSize=a;var b=a.split("x");this.defaultSizeX=b[0],this.defaultSizeY=b[1]}},get:function(){return this._defaultSize}},{key:"minSize",set:function(a){if(a&&""!==a){this._minSize=a;var b=a.split("x");this.minSizeX=b[0],this.minSizeY=b[1]}},get:function(){return this._minSize}},{key:"restoreVO",get:function(){return new q.default(this.maskVO.clone(),this.x,this.y,this.width,this.height)}}]),b}(o.default);b.default=r},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(2),h=d(g),i=c(1),j=d(i),k=c(3),l=d(k),m=c(63),n=d(m),o=function(a){function b(){var c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,g=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:100;(0,f.default)(this,b);var j=(0,h.default)(this,a.call(this));return j.url=c,j.drawX=d,j.drawY=e,j.drawWidth=g,j.drawHeight=i,j.initialize(),j.addEvent(),""!==c&&j.load(c,d,e,g,i),j}return(0,l.default)(b,a),(0,j.default)(b,null,[{key:"LOAD_COMPLETE",get:function(){return"drawComplete"}},{key:"TEXTURE_UPDATE",get:function(){return"textureUpdate"}}]),b.prototype.initialize=function(){this.image=null,this.isFirstLoad=!0,this.canvgCanvas=document.createElement("canvas"),this.canvgCanvas.id="canvgCanvas",this.canvgCanvas.style.display="none",this.canvgContext=this.canvgCanvas.getContext("2d"),document.body.appendChild(this.canvgCanvas),this.contextImageSmoothingEnabledSetting(this.canvgContext,!0)},b.prototype.addEvent=function(){this.drawCompleteListener=this.onDrawComplete.bind(this)},b.prototype.removeEvent=function(){this.drawCompleteListener=null},b.prototype.load=function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100,e=arguments.length>4&&void 0!==arguments[4]?arguments[4]:100;this.url=a,this.drawSvg(b,c,d,e)},b.prototype.drawSvg=function(a,b,c,d){var e=this;this.drawX=a,this.drawY=b,this.drawWidth=c,this.drawHeight=d,c=Math.abs(c),d=Math.abs(d),c=c>4e3?4e3:c,d=d>4e3?4e3:d,this.canvgCanvas.width=c,this.canvgCanvas.height=d,this.canvgContext.drawSvg(this.url,a,b,c,d,{renderCallback:function(){e.drawCompleteListener.call(e)}})},b.prototype.destroy=function(){this.removeEvent(),this.interactive=!1,null!==this.image&&(this.removeChild(this.image),this.image.texture.destroy(),this.image.texture=null,this.image.destroy(),this.image=null,this.lt.destroy(),this.rt.destroy(),this.rb.destroy(),this.lb.destroy(),this.removeChild(this.lt),this.removeChild(this.rt),this.removeChild(this.rb),this.removeChild(this.lb),this.lt=this.rt=this.rb=this.lb=this.registrationPoint=this.points=null),this._timeout&&(clearTimeout(this._timeout),this._timeout=-1),this.canvgCanvas&&document.body.removeChild(this.canvgCanvas),this.canvgCanvas=this.canvgContext=null,a.prototype.destroy.call(this)},b.prototype.onDrawComplete=function(){!0===this.isFirstLoad?(this.isFirstLoad=!1,this.createImage()):(this.resetScale(),this.updatePoints(),this.notifyTextureUpdate())},b.prototype.createImage=function(){this.image=new PIXI.Sprite(new PIXI.Texture.fromCanvas(this.canvgCanvas)),this.addChild(this.image),this.lt=this.registrationPoint=n.default.getRectangle(0,0,0),this.rt=n.default.getRectangle(-0,0,0),this.rb=n.default.getRectangle(-0,-0,0),this.lb=n.default.getRectangle(0,-0,0),this.rt.x=this.rb.x=this.image.width,this.rb.y=this.lb.y=this.image.height,this.addChild(this.lt),this.addChild(this.rt),this.addChild(this.rb),this.addChild(this.lb),this.points=[this.lt,this.rt,this.rb,this.lb],this.emit(b.LOAD_COMPLETE,{target:this})},b.prototype.updatePoints=function(){this.rt.x=this.rb.x=this.image.width,this.rb.y=this.lb.y=this.image.height},b.prototype.resetScale=function(){this.scale=new PIXI.Point(1,1),this.image.scale=new PIXI.Point(1,1),this.image.texture.update(),this.image.updateTransform()},b.prototype.notifyTextureUpdate=function(){this.emit(b.TEXTURE_UPDATE,{target:this})},b.prototype.contextImageSmoothingEnabledSetting=function(a){var b=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];a.imageSmoothingEnabled?a.imageSmoothingEnabled=b:a.oImageSmoothingEnabled?a.oImageSmoothingEnabled=b:a.msImageSmoothingEnabled?a.msImageSmoothingEnabled=b:a.mozImageSmoothingEnabled?a.mozImageSmoothingEnabled=b:a.webkitImageSmoothingEnabled&&(a.webkitImageSmoothingEnabled=b)},b}(PIXI.Container);b.default=o},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(1),h=d(g),i=function(){function a(){(0,f.default)(this,a)}return(0,h.default)(a,null,[{key:"NONE",get:function(){return"rotationNone"}},{key:"DELETE",get:function(){return"rotationDelete"}},{key:"TOP_LEFT",get:function(){return"rotationTopLeft"}},{key:"TOP_CENTER",get:function(){return"rotationTopCenter"}},{key:"TOP_RIGHT",get:function(){return"rotationTopRight"}},{key:"MIDDLE_LEFT",get:function(){return"rotationMiddleLeft"}},{key:"MIDDLE_RIGHT",get:function(){return"rotationMiddleRight"}},{key:"BOTTOM_LEFT",get:function(){return"rotationBottomLeft"}},{key:"BOTTOM_CENTER",get:function(){return"rotationBottomCenter"}},{key:"BOTTOM_RIGHT",get:function(){return"rotationBottomRight"}}]),a}();b.default=i},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(1),h=d(g),i=c(15),j=d(i),k=c(80),l=(d(k),c(345)),m=d(l),n=c(197),o=d(n),p=c(190),q=d(p),r=c(193),s=d(r),t=c(143),u=d(t),v=c(142),w=(d(v),function(){function a(){(0,f.default)(this,a)}return a.initialize=function(a,b,c){this.mask=a,this.back=this.backgroundImage=b,this.collision=c,this.vo=new m.default},a.changeMask=function(a){this.mask=null,this.mask=a},a.virtualMoveCollisionCheck=function(a,b){var c,d,e=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return!0===e?(d=this.back.collisionRect,c=this.mask.getMovedRect(a,b)):(c=this.mask.collisionRect,d=this.back.getMovedRect(a,b)),this.getFixPosition(c,d,this.backgroundImage.rotation)},a.virtualRotateCollisionCheck=function(a){return this.getFixPosition(this.mask.collisionRect,this.backgroundImage.getRotatedRect(a),a)},a.virtualScaleCollisionCheck=function(a){var b,c,d=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,f=this.backgroundImage.rotation;return!0===d?(b=this.mask.getScaledRect(a),c=this.back.collisionRect):(b=this.mask.collisionRect,c=this.back.getScaledRect(a)),this.getFixPosition(b,c,f,e)},a.getFitScale=function(b){var c,d=this.mask.collisionRect,e=this.back.collisionRect,f=this.back.rotation,g=this.getExpectedScaleCollisionVO(d,e,f),h=g.type,i=a.isMask(b),b=this.mask,j=2*g.offsetX,k=2*g.offsetY;!1===i&&(b=this.backgroundImage,j*=-1,k*=-1),c=h.indexOf(o.default.LEFT)>-1||h.indexOf(o.default.RIGHT)>-1?b.getScale(b.width+j,0).scaleX:b.getScale(0,b.height+k).scaleY;var l=void 0,m=b.scale.x;if(i){l=c-1,c+=1;for(var n=l;n<c&&this.virtualScaleCollisionCheck(n,i,0).type===o.default.NONE;n+=.002)m=n}else{l=c+1,c-=1;for(var n=l;n>c&&this.virtualScaleCollisionCheck(n,i,0).type===o.default.NONE;n-=.002)m=n}return m},a.getCollisionVO=function(){return this.getFixPosition(this.mask.collisionRect,this.back.collisionRect,this.back.rotation)},a.getFixPosition=function(a,b,c){var d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,e=-c;a.rotate(e),b.rotate(e);var f=a.left,g=a.right,h=a.top,i=a.bottom,j=b.left,k=b.right,l=b.top,m=b.bottom;return this.vo.reset(),f<j&&(this.vo.type=o.default.LEFT,this.vo.offsetX=j-f+d),g>k&&(this.vo.type=o.default.RIGHT,this.vo.offsetX=k-g-d),h<l&&(this.vo.type=o.default.TOP,this.vo.offsetY=l-h+d),i>m&&(this.vo.type=o.default.BOTTOM,this.vo.offsetY=m-i-d),this.vo},a.getExpectedScaleCollisionVO=function(a,b,c){var d=(arguments.length>3&&void 0!==arguments[3]&&arguments[3],-c);a.rotate(d),b.rotate(d);var e=b.left,f=b.right,g=b.top,h=b.bottom,i=a.left,j=a.right,k=a.top,l=a.bottom,n=Math.abs(e-i),p=f-j,q=Math.min(n,p),r=Math.abs(g-k),s=h-l,t=Math.min(r,s);return q<t?new m.default(q===n?o.default.LEFT:o.default.RIGHT,q):new m.default(t===r?o.default.TOP:o.default.BOTTOM,0,t)},a.isMask=function(a){return a instanceof q.default||a instanceof s.default||a instanceof u.default},(0,h.default)(a,null,[{key:"isMaskInside",get:function(){return j.default.isInsideSquare(this.mask.center,this.back.lt,this.back.rt,this.back.rb,this.back.lb)}},{key:"backgroundImageLocalPivot",get:function(){if(!0===a.isMaskInside){return this.backgroundImage.toLocal(this.mask.toGlobal(this.mask.registrationPoint))}return this.backgroundImage.registrationPoint}},{key:"isImageRotated",get:function(){return j.default.toRoundDegreesByRadians(this.back.rotation)%90!=0}}]),a}());b.default=w},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(1),h=d(g),i=function(){function a(){(0,f.default)(this,a)}return(0,h.default)(a,null,[{key:"LEFT",get:function(){return"left"}},{key:"RIGHT",get:function(){return"right"}},{key:"TOP",get:function(){return"top"}},{key:"BOTTOM",get:function(){return"bottom"}},{key:"NONE",get:function(){return"none"}},{key:"LEFT_TOP",get:function(){return"leftTop"}},{key:"LEFT_BOTTOM",get:function(){return"leftBottom"}},{key:"RIGHT_TOP",get:function(){return"rightTop"}},{key:"RIGHT_BOTTOM",get:function(){return"rightBottom"}},{key:"TOP_BOTTOM",get:function(){return"topBottom"}},{key:"BOTTOM_TOP",get:function(){return"bottomTop"}},{key:"LEFT_RIGHT",get:function(){return"leftRight"}},{key:"RIGHT_LEFT",get:function(){return"rightLeft"}},{key:"TOP_LEFT",get:function(){return"topLeft"}},{key:"TOP_RIGHT",get:function(){return"topRight"}},{key:"BOTTOM_LEFT",get:function(){return"bottomLeft"}},{key:"BOTTOM_RIGHT",get:function(){return"bottomRight"}}]),a}();b.default=i},function(a,b,c){"use strict";b.__esModule=!0;var d=c(0),e=function(a){return a&&a.__esModule?a:{"default":a}}(d),f=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,f=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,g=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;(0,e.default)(this,a),this.maskVO=b,this.x=c,this.y=d,this.width=f,this.height=g}return a.prototype.clone=function(){return new a(this.maskVO.clone(),this.x,this.y,this.width,this.height)},a.prototype.toString=function(){var a="MaskRestoreVO["+this.x+", "+this.y+", "+this.width+", "+this.height+", "+this.scaleX+", "+this.scaleY+"]";return void 0,a},a}();b.default=f},function(a,b,c){"use strict";b.__esModule=!0;var d=c(0),e=function(a){return a&&a.__esModule?a:{"default":a}}(d),f=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,f=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1;return(0,e.default)(this,a),this.url=b,this.maxSize=c,this.defaultSize=d,this.minSize=f,this}return a.prototype.setTestData=function(a){switch(a=parseInt(a)){case 0:this.url="./../assets/img/mask-oval@3x.png",this.maxSize="500x500",this.defaultSize="300x300",this.minSize="100x100";break;case 1:default:this.url="./../assets/img/mask-triangle@3x.png",this.maxSize="530x480",this.defaultSize="330x300",this.minSize="120x110";break;case 2:this.url="./../assets/img/mask-round-squre@3x.png",this.maxSize="500x500",this.defaultSize="300x300",this.minSize="120x120";break;case 3:this.url="./../assets/img/mask-polygon@3x.png",this.maxSize="520x500",this.defaultSize="335x320",this.minSize="130x125";break;case 4:this.url="./../assets/img/mask-star@3x.png",this.maxSize="500x477",this.defaultSize="325x310",this.minSize="120x114";break;case 5:this.url="./../assets/img/mask-star-2@3x.png",this.maxSize="500x500",this.defaultSize="320x320",this.minSize="100x100";break;case 6:this.url="./../assets/img/mask-round-star@3x.png",this.maxSize="500x500",this.defaultSize="335x335",this.minSize="100x100"}},a.prototype.setSVGTestData=function(a){switch(a=parseInt(a)){case 0:this.url="./../assets/svg/mask-oval.svg",this.maxSize="500x500",this.defaultSize="300x300",this.minSize="100x100";break;case 1:default:this.url="./../assets/svg/mask-triangle.svg",this.maxSize="530x480",this.defaultSize="330x300",this.minSize="120x110";break;case 2:this.url="./../assets/svg/mask-round-square.svg",this.maxSize="500x500",this.defaultSize="300x300",this.minSize="120x120";break;case 3:this.url="./../assets/svg/mask-polygon.svg",this.maxSize="520x500",this.defaultSize="335x320",this.minSize="130x125";break;case 4:this.url="./../assets/svg/mask-star-1.svg",this.maxSize="500x477",this.defaultSize="325x310",this.minSize="120x114";break;case 5:this.url="./../assets/svg/mask-star-2.svg",this.maxSize="500x500",this.defaultSize="320x320",this.minSize="100x100";break;case 6:this.url="./../assets/svg/mask-round-star.svg",this.maxSize="500x500",this.defaultSize="335x335",this.minSize="100x100"}},a.prototype.setDataByURL=function(a){a&&(this.url=a,a.indexOf("mask-oval.svg")>-1?(this.maxSize="500x500",this.defaultSize="300x300",this.minSize="100x100"):a.indexOf("mask-triangle.svg")>-1?(this.maxSize="530x480",this.defaultSize="330x300",this.minSize="120x110"):a.indexOf("mask-round-square.svg")>-1?(this.maxSize="500x500",this.defaultSize="300x300",this.minSize="120x120"):a.indexOf("mask-round-star.svg")>-1?(this.maxSize="500x500",this.defaultSize="335x335",this.minSize="100x100"):a.indexOf("mask-star-1.svg")>-1?(this.maxSize="500x477",this.defaultSize="325x310",this.minSize="120x114"):a.indexOf("mask-star-2.svg")>-1?(this.maxSize="500x500",this.defaultSize="320x320",this.minSize="100x100"):a.indexOf("mask-polygon.svg")>-1?(this.maxSize="520x500",this.defaultSize="335x320",this.minSize="130x125"):(this.maxSize="500x500",this.defaultSize="300x300",this.minSize="100x100"))},a.prototype.clone=function(){return new a(this.url,this.maxSize,this.defaultSize,this.minSize)},a}();b.default=f},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(1),h=d(g),i=c(2),j=d(i),k=c(3),l=d(k),m=c(47),n=(d(m),c(201)),o=d(n),p=c(202),q=d(p),r=c(32),s=(Math.PI,Math.PI,function(a){function b(c){var d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;(0,f.default)(this,b);var g=(0,j.default)(this,a.call(this,d,e));return g.initWithVertices(c),g.mtv={len:0,axisX:0,axisY:0},g}return(0,l.default)(b,a),b.prototype.initWithVertices=function(a){this.invalidate=!0,this._original=a,this._axes=a.map(function(a){return[]}),this._vertices=a.map(function(a){return[]}),this._projections=a.map(function(a){return new q.default}),0!=this.width&&0!=this.height||this.calcFrame(),this.edgeColors=this.getRandomColors(this._original.length),this.axisColors=this.getDimedColors(this.edgeColors),this.fillColor="#222",this.axisLength=400},b.prototype.calcFrame=function(){var a=this.original.map(function(a){var b=a[0];a[1];return b}),b=this.original.map(function(a){a[0];return a[1]}),c=[a,b].map(function(a){var b=Math.min.apply(Math,a);return Math.max.apply(Math,a)-b});this.updateFrame.apply(this,c)},b.prototype.scaleToVector=function(a,b){this.scale=Math.max(this.getHorizontalScale(a,b),this.getVerticalScale(a,b))},b.prototype.getHorizontalScale=function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this._width;return Math.abs(this.projectToTop(a,b))/(a<0?c*this.anchorX:c*(1-this.anchorX))},b.prototype.getVerticalScale=function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this._height;return Math.abs(this.projectToLeft(a,b))/(b<0?c*this.anchorY:c*(1-this.anchorY))},b.prototype.projectToTop=function(a,b){var c=this.matrix.apply(0,0),d=this.matrix.apply(this._width,0),e=r.getAxis.apply(void 0,c.concat(d));return a*e[0]+b*e[1]},b.prototype.projectToLeft=function(a,b){var c=this.matrix.apply(0,0),d=this.matrix.apply(0,this._height),e=r.getAxis.apply(void 0,c.concat(d));return a*e[0]+b*e[1]},b.prototype.hitTestPolygon=function(a){this._hitProj=null;var b=this._hitTestPolyWithProj(a,this.projections);if(null==b)return null;var c=this._hitTestPolyWithProj(this,a.projections);if(null==c)return null;var d=c[0],e=c[1];return b[0]<d&&(d=b[0],e=b[1]),this._hitProj=e,this.mtv.len=d,this.mtv.axisX=e.axisX,this.mtv.axisY=e.axisY,this.mtv},b.prototype._hitTestPolyWithProj=function(a,b){for(var c=new q.default,d=void 0,e=void 0,f=void 0,g=void 0,h=0,i=b.length;h<i;h++){if(d=b[h],c.initWithAxis(d.axisX,d.axisY).projectPolygon(a.vertices),!(e=d.overlap(c)))return null;e>=f||(f=e,g=d)}return[f,g]},b.prototype.hitTestPoint=function(a,b){for(var c=this.axes,d=this._projections,e=0;e<c.length;e++){var f=c[e],g=f[0],h=f[1],i=d[e],j=g*a+h*b;if(!i.contains(j))return!1}return!0},b.prototype.render=function(a){var b=this;a.save(),a.setTransform(1,0,0,1,0,0),a.lineCap="round";this.axes;this.vertices.forEach(function(c,d,e){var f=c[0],g=c[1],h=e[d+1]||e[0],i=h[0],j=h[1];b.drawLine(a,f,g,i,j,b.edgeColors[d])}),a.restore(),this.__hit&&this.fill(a,this.fillColor)},b.prototype.fill=function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#fff";a.beginPath();var c=this.vertices[0];a.moveTo.apply(a,c);for(var d=1;d<=this.vertices.length;d++)c=this.vertices[d]||this.vertices[0],a.lineTo.apply(a,c);a.fillStyle=b,a.fill()},b.prototype.drawLine=function(a,b,c,d,e){var f=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"#000",g=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;
a.beginPath(),a.lineWidth=g,a.strokeStyle=f,a.moveTo(b,c),a.lineTo(d,e),a.stroke()},b.prototype.getRandomColors=function(a){for(var b=[],c=0;c<a;c++){var d=50+205*Math.random()|0,e=50+205*Math.random()|0,f=50+205*Math.random()|0;b.push("rgb("+d+", "+e+", "+f+")")}return b},b.prototype.getDimedColors=function(a){return a.map(function(a){var b=a.match(/\d+/g);return"rgb("+(.5*b[0]|0)+", "+(.5*b[1]|0)+", "+(.5*b[2]|0)+")"})},b.prototype.getPerpendicularAxis=function(a,b,c,d){var e=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],f=c-a,g=d-b,h=Math.sqrt(f*f+g*g);return e[0]=-g/h,e[1]=f/h,e},(0,h.default)(b,[{key:"axes",get:function(){var a=this;if(this._invaildateAxes){var b=this._axes;this.vertices.forEach(function(c,d,e){var f=c[0],g=c[1],h=e[d+1]||e[0],i=h[0],j=h[1];a.getPerpendicularAxis(f,g,i,j,b[d])}),b.forEach(function(b,c){var d=b[0],e=b[1];a._projections[c].initWithAxis(d,e).projectPolygon(a.vertices)}),this._invaildateAxes=!1}return this._axes}},{key:"projections",get:function(){return this._invaildateAxes&&this.axes,this._projections}},{key:"pivot",get:function(){return this.matrix.apply(this.pivotX,this.pivotY)}},{key:"vertices",get:function(){var a=this;if(this._invaildateVertices){var b=this._vertices;this._original.forEach(function(c,d){var e=c[0],f=c[1],g=a.matrix.apply(e,f);b[d][0]=g[0],b[d][1]=g[1]}),this._invaildateVertices=!1}return this._vertices}},{key:"original",get:function(){return this._original}},{key:"invalidate",get:function(){return this._invalidate},set:function(a){this._invalidate=a,a&&(this._invaildateAxes=a,this._invaildateVertices=a)}}]),b}(o.default));b.default=s},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(1),h=d(g),i=c(47),j=d(i),k=180/Math.PI,l=Math.PI/180,m=function(){function a(b,c){(0,f.default)(this,a),this.identity(),this.updateFrame(b,c)}return a.prototype.identity=function(){this._matrix=this._matrix||new j.default,this._matrix.identity(),this._pivotX=this._pivotY=0,this._x=this._y=0,this._scaleX=this._scaleY=1,this._radian=0,this.invalidate=!0},a.prototype.updateFrame=function(a,b){this._width=a,this._height=b},a.prototype.evaluateMatrix=function(){if(0==this.radian)this._matrix.setTo(this._scaleX,0,0,this._scaleY,this._x-this._scaleX*this._pivotX,this._y-this._scaleY*this._pivotY);else{var a=this._radian,b=Math.cos(a),c=Math.sin(a),d=this._scaleX*b,e=this._scaleX*c,f=this._scaleY*-c,g=this._scaleY*b,h=this._x-d*this._pivotX-f*this._pivotY,i=this._y-e*this._pivotX-g*this._pivotY;this._matrix.setTo(d,f,e,g,h,i)}this.invalidate=!1},(0,h.default)(a,[{key:"matrix",get:function(){return this.invalidate&&this.evaluateMatrix(),this._matrix}},{key:"invalidate",get:function(){return this._invaildate},set:function(a){this._invaildate=a}},{key:"width",get:function(){return this._width*this.scaleX},set:function(a){this.scaleX=a/this._width}},{key:"height",get:function(){return this._height*this.scaleY},set:function(a){this.scaleY=a/this._height}},{key:"pivotX",get:function(){return this._pivotX},set:function(a){this._pivotX!=a&&(this._pivotX=a,this.invalidate=!0)}},{key:"pivotY",get:function(){return this._pivotY},set:function(a){this._pivotY!=a&&(this._pivotY=a,this.invalidate=!0)}},{key:"anchorX",get:function(){return this.pivotX/this._width},set:function(a){this.pivotX=a*this._width}},{key:"anchorY",get:function(){return this.pivotY/this._height},set:function(a){this.pivotY=a*this._height}},{key:"x",get:function(){return this._x},set:function(a){this._x!=a&&(this._x=a,this.invalidate=!0)}},{key:"y",get:function(){return this._y},set:function(a){this._y!=a&&(this._y=a,this.invalidate=!0)}},{key:"scaleX",get:function(){return this._scaleX},set:function(a){this._scaleX!=a&&(this._scaleX=a,this.invalidate=!0)}},{key:"scale",get:function(){return this.scaleX},set:function(a){this.scaleX=this.scaleY=a}},{key:"scaleY",get:function(){return this._scaleY},set:function(a){this._scaleY!=a&&(this._scaleY=a,this.invalidate=!0)}},{key:"radian",get:function(){return this._radian},set:function(a){this._radian!=a&&(this._radian=a,this.invalidate=!0)}},{key:"rotation",get:function(){return this.radian*k},set:function(a){this.radian=a*l}}]),a}();b.default=m},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0,b.MIN=b.MAX=void 0;var e=c(0),f=d(e),g=c(1),h=d(g),i=c(352),j=d(i),k=c(174),l=d(k),m=b.MAX=l.default||9007199254740991,n=b.MIN=j.default||-9007199254740991,o=function(){function a(b,c){(0,f.default)(this,a),this.initWithAxis(b,c)}return a.prototype.initWithAxis=function(a,b){return this._axisX=a,this._axisY=b,this.clear(),this},a.prototype.clear=function(){return this._min=m,this._max=n,this._minVertex=[],this._maxVertex=[],this},a.prototype.projectPolygon=function(a){var b=this,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.axisX,d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.axisY;return a.forEach(function(a){return b.project.apply(b,a.concat([c,d]))}),this},a.prototype.projectCircle=function(a,b){var c=a[0],d=a[1],e=c*this.axisX+d*this.axisY;return this._min=e-b,this._max=e+b,this},a.prototype.project=function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.axisX,d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.axisY,e=a*c+b*d;e<this.min&&(this._min=e,this._cacheVertex(this._minVertex,a,b)),e>this.max&&(this._max=e,this._cacheVertex(this._maxVertex,a,b))},a.prototype._cacheVertex=function(a,b,c){a[0]=b,a[1]=c},a.prototype.overlap=function(a){return a.max<this.min||a.min>this.max?0:Math.min(a.max-this.min,this.max-a.min)},a.prototype.getMTV=function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return b.x=this.axisX,b.y=this.axisY,b.min=Math.max(0,this.min-a.min),b.max=Math.min(0,this.max-a.max),b.minVertex=a._minVertex,b.maxVertex=a._maxVertex,b},a.prototype.outOfRange=function(a){return a.min>=this.min&&a.max<=this.max?0:a.min<this.min?a.min-this.min:a.max-this.max},a.prototype.contains=function(a){return!(a<this.min||a>this.max)},(0,h.default)(a,[{key:"axisX",get:function(){return this._axisX}},{key:"axisY",get:function(){return this._axisY}},{key:"min",get:function(){return this._min}},{key:"max",get:function(){return this._max}},{key:"len",get:function(){return this.max-this.min}}]),a}();b.default=o},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(1),h=d(g),i=c(369),j=d(i),k=(c(10),function(){function a(b){(0,f.default)(this,a),this.container=b,this.frameNum=0,this.suffixImageStrs=["_1_left_top.png","_2_center_top.png","_3_right_top.png","_4_left_middle.png","_5_right_middle.png","_6_left_bottom.png","_7_center_bottom.png","_8_right_bottom.png"]}return a.prototype.initialize=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Anonymous";this.canvas=this.canvas||document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.view=new PIXI.Sprite,this.drawPoint={left:0,right:0,top:0,bottom:0},a=a||"img/frame.png",this.loadImg(a,function(a){this.bgImage=a,this.start()}.bind(this),b)},a.prototype.applyFrame=function(a){switch(this.frameNum=a,this.frameNum){case 1:this.drawPoint={left:11,top:11,right:11,bottom:11};break;case 2:this.drawPoint={left:8,top:8,right:8,bottom:8};break;case 3:case 4:this.drawPoint={left:12,top:12,right:12,bottom:12};break;case 5:this.drawPoint={left:20,top:20,right:20,bottom:20};break;case 6:this.drawPoint={left:18,top:18,right:18,bottom:69};break;default:return this.displayObject=null,void(this.ctx.canvas.width=this.ctx.canvas.width)}this.canvas.width=this.drawPoint.left+this.drawPoint.right+this.container.actualWidth,this.canvas.height=this.drawPoint.top+this.drawPoint.bottom+this.container.actualHeight,this.setFrame(),this.start()},a.prototype.start=function(){this.displayObject=this.canvas},a.prototype.loadImg=function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Anonymous",d=document.createElement("img");d.crossOrigin=c,d.onload=function(a){b(d)}.bind(this),d.src=a},a.prototype.setFrame=function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.setBg()},a.prototype.drawImagePos=function(a,b,c,d){var e=j.default.frames[b].frame;a.drawImage(this.bgImage,e.x,e.y,e.w,e.h,c,d,e.w,e.h)},a.prototype.getPosAtFrame=function(a,b){var c,d=j.default.frames[a].frame,e=this.container.actualWidth,f=this.container.actualHeight;switch(b){case"lt":c={x:0,y:0,w:d.w,h:d.h};break;case"rt":c={x:this.drawPoint.left+e+this.drawPoint.right-d.w,y:0,w:d.w,h:d.h};break;case"lb":c={x:0,y:this.drawPoint.top+f+this.drawPoint.bottom-d.h,w:d.w,h:d.h};break;case"rb":c={x:this.drawPoint.left+e+this.drawPoint.right-d.w,y:this.drawPoint.top+f+this.drawPoint.bottom-d.h,w:d.w,h:d.h}}return c},a.prototype.repeatDraw=function(a,b,c){var d=0;switch(c){case"x":for(;d<b.w;)d+a.width<=b.w?this.ctx.drawImage(a,b.x+d,b.y):this.ctx.drawImage(a,0,0,b.w-d,a.height,b.x+d,b.y,b.w-d,a.height),d+=a.width;break;case"y":for(;d<b.h;)d+a.height<=b.h?this.ctx.drawImage(a,b.x,b.y+d):this.ctx.drawImage(a,0,0,a.width,b.h-d,b.x,b.y+d,a.width,b.h-d),d+=a.height}},a.prototype.setBg=function(){var a,b,c="0"+this.frameNum,d=[this.getPosAtFrame(c+this.suffixImageStrs[0],"lt"),this.getPosAtFrame(c+this.suffixImageStrs[2],"rt"),this.getPosAtFrame(c+this.suffixImageStrs[5],"lb"),this.getPosAtFrame(c+this.suffixImageStrs[7],"rb")],e=this.container.actualWidth,f=this.container.actualHeight;this.offCanvas=this.offCanvas||document.createElement("canvas"),this.offCtx=this.offCtx||this.offCanvas.getContext("2d"),this.drawImagePos(this.ctx,c+this.suffixImageStrs[0],0,0),a=j.default.frames[c+this.suffixImageStrs[1]].frame,this.offCanvas.width=a.w,this.offCanvas.height=a.h,this.drawImagePos(this.offCtx,c+this.suffixImageStrs[1],0,0),b={x:d[0].w,y:0,w:e-(d[0].w-this.drawPoint.left)-(d[1].w-this.drawPoint.right),h:this.offCanvas.height},this.repeatDraw(this.offCanvas,b,"x"),this.drawImagePos(this.ctx,c+this.suffixImageStrs[2],d[1].x,d[1].y),a=j.default.frames[c+this.suffixImageStrs[3]].frame,this.offCanvas.width=a.w,this.offCanvas.height=a.h,this.drawImagePos(this.offCtx,c+this.suffixImageStrs[3],0,0),b={x:0,y:d[0].h,w:this.offCanvas.width,h:f-(d[0].h-this.drawPoint.top)-(d[2].h-this.drawPoint.bottom)},this.repeatDraw(this.offCanvas,b,"y"),a=j.default.frames[c+this.suffixImageStrs[4]].frame,this.offCanvas.width=a.w,this.offCanvas.height=a.h,this.drawImagePos(this.offCtx,c+this.suffixImageStrs[4],0,0),b={x:d[0].w+e-(d[0].w-this.drawPoint.left)-(this.offCanvas.width-this.drawPoint.right),y:d[1].h,w:this.offCanvas.width,h:f-(d[1].h-this.drawPoint.top)-(d[3].h-this.drawPoint.bottom)},this.repeatDraw(this.offCanvas,b,"y"),this.drawImagePos(this.ctx,c+this.suffixImageStrs[5],d[2].x,d[2].y),a=j.default.frames[c+this.suffixImageStrs[6]].frame,this.offCanvas.width=a.w,this.offCanvas.height=a.h,this.drawImagePos(this.offCtx,c+this.suffixImageStrs[6],0,0),b={x:d[2].w,y:d[0].h+f-(d[0].h-this.drawPoint.top)-(this.offCanvas.height-this.drawPoint.bottom),w:e-(d[2].w-this.drawPoint.left)-(d[3].w-this.drawPoint.right),h:this.offCanvas.height},this.repeatDraw(this.offCanvas,b,"x"),this.drawImagePos(this.ctx,c+this.suffixImageStrs[7],d[3].x,d[3].y)},a.prototype.clearDisplayObject=function(){this.displayObject&&(this.view.parent&&this.view.parent.removeChild(this.view),this.view.renderableObject=!1,this.view.texture=null)},(0,h.default)(a,[{key:"displayObject",get:function(){return this._displayObject},set:function(a){this.clearDisplayObject(),this._displayObject=a,this._displayObject&&(this.view.texture=new PIXI.Texture(new PIXI.BaseTexture(a)),this.view.renderableObject=!0,this.view.x=-this.drawPoint.left,this.view.y=-this.drawPoint.top,this.view.interactive=!1,this.container.addChild(this.view))}},{key:"visible",get:function(){return this.view.visible},set:function(a){this.view.visible=a}},{key:"modified",get:function(){return this.frameNum>=1&&this.frameNum<=6}},{key:"border",get:function(){return this.modified?this.drawPoint:{top:0,left:0,right:0,bottom:0}}},{key:"source",get:function(){return this.ctx.canvas}}]),a}());b.default=k},function(a,b,c){"use strict";var d=c(35);a.exports=function(){return d(this).length=0,this}},function(a,b,c){"use strict";a.exports=function(){}},function(a,b,c){"use strict";var d=c(376),e=Math.max;a.exports=function(a){return e(0,d(a))}},function(a,b,c){"use strict";var d=Object.create,e=Object.getPrototypeOf,f={};a.exports=function(){var a=Object.setPrototypeOf,b=arguments[0]||d;return"function"==typeof a&&e(a(b(null),f))===f}},function(a,b,c){"use strict";var d,e=c(380),f=c(35),g=Object.prototype.isPrototypeOf,h=Object.defineProperty,i={configurable:!0,enumerable:!1,writable:!0,value:void 0};d=function(a,b){if(f(a),null===b||e(b))return a;throw new TypeError("Prototype must be null or an object")},a.exports=function(a){var b,c;return a?(2===a.level?a.set?(c=a.set,b=function(a,b){return c.call(d(a,b),b),a}):b=function(a,b){return d(a,b).__proto__=b,a}:b=function e(a,b){var c;return d(a,b),c=g.call(e.nullPolyfill,a),c&&delete e.nullPolyfill.__proto__,null===b&&(b=e.nullPolyfill),a.__proto__=b,c&&h(e.nullPolyfill,"__proto__",i),a},Object.defineProperty(b,"level",{configurable:!1,enumerable:!1,writable:!1,value:a.level})):null}(function(){var a,b=Object.create(null),c={},d=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__");if(d){try{a=d.set,a.call(b,c)}catch(e){}if(Object.getPrototypeOf(b)===c)return{set:a,level:2}}return b.__proto__=c,Object.getPrototypeOf(b)===c?{level:2}:(b={},b.__proto__=c,Object.getPrototypeOf(b)===c&&{level:1})}()),c(381)},function(a,b,c){"use strict";var d=c(64),e=Array.prototype.forEach,f=Object.create,g=function(a,b){var c;for(c in a)b[c]=a[c]};a.exports=function(a){var b=f(null);return e.call(arguments,function(a){d(a)&&g(Object(a),b)}),b}},function(a,b,c){"use strict";a.exports=c(388)()?String.prototype.contains:c(389)},function(a,b,c){"use strict";var d=c(395);a.exports=function(a){if(!d(a))throw new TypeError(a+" is not iterable");return a}},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(2),h=d(g),i=c(3),j=d(i),k=c(36),l=d(k),m=c(14),n=(d(m),c(7)),o=d(n),p=c(12),q=d(p),r=c(8),s=d(r),t=c(11),u=d(t),v=c(213),w=d(v),x=c(5),y=d(x),z=c(431),A=d(z),B=c(16),C=d(B),D=c(20),E=d(D),F=[200,160,120,80,40,34,28,19,16,14,11,10],G=[["Abel","sans-serif"],["Arvo","serif"],["Bungee Shade","cursive"],["Cookie","cursive"],["Crimson Text","serif"],["Dancing Script","cursive"],["Dosis","sans-serif"],["Duru Sans","sans-serif"],["Inconsolata","monospace"],["Kreon","serif"],["Lancelot","cursive"],["Lobster","cursive"],["Mandali","sans-serif"],["Noto Sans","sans-serif"],["Noto Serif","serif"],["Podkova","serif"],["Quicksand","sans-serif"],["Rasa","serif"],["Sanchez","serif "]];s.default.TEXT_TOOL={TEXT_TOOL_BTN:".npe_text_tool",TEXT_TOOL_BTN_TITLE:".npe_tool_title",TEXT_TOOL_BTN_SUBLIST:".npe_tool_list",TEXT_TOOL_BTN_SUBLIST_ITEM:".npe_tool_item",TEXT_TOOL_FONT_BTN:".npe_text_font_family",TEXT_TOOL_FONT_LIST:".npe_text_font_family_list",TEXT_TOOL_FONT_LIST_ITEM:".npe_tool_item",TEXT_TOOL_SIZE_BTN:".npe_text_font_size",TEXT_TOOL_SIZE_LIST:".npe_text_font_size_list",TEXT_TOOL_SIZE_LIST_ITEM:".npe_tool_item",TEXT_TOOL_BOLD_BTN:".npe_text_font_bold",TEXT_TOOL_ITALIC_BTN:".npe_text_font_italic",TEXT_TOOL_FONT_COLOR_BTN:".npe_text_font_color",TEXT_TOOL_BACK_COLOR_BTN:".npe_text_back_color",TEXT_TOOL_COLOR_PREVIEW:".npe_text_color_preview"};var H=function(a){function b(c,d,e){(0,f.default)(this,b);var g=(0,h.default)(this,a.call(this));return g._storage=d,g._$wrapper=(0,y.default)(s.default.PHOTOEDITOR_WRAP),g._$textToolWrapper=(0,y.default)(c),g._$textInput=g._$textToolWrapper.find(s.default.TEXT_TOOL.TEXT_INPUT),g._$textToolBtn=g._$textToolWrapper.find(s.default.TEXT_TOOL.TEXT_TOOL_BTN),g._$textToolSublist=g._$textToolWrapper.find(s.default.TEXT_TOOL.TEXT_TOOL_BTN_SUBLIST),g._$textToolFontList=g._$textToolWrapper.find(s.default.TEXT_TOOL.TEXT_TOOL_FONT_LIST),g._$textToolSizeList=g._$textToolWrapper.find(s.default.TEXT_TOOL.TEXT_TOOL_SIZE_LIST),g._$textToolFontBtn=g._$textToolWrapper.find(s.default.TEXT_TOOL.TEXT_TOOL_FONT_BTN),g._$textToolSizeBtn=g._$textToolWrapper.find(s.default.TEXT_TOOL.TEXT_TOOL_SIZE_BTN),g._$textToolBoldBtn=g._$textToolWrapper.find(s.default.TEXT_TOOL.TEXT_TOOL_BOLD_BTN),g._$textToolItalicBtn=g._$textToolWrapper.find(s.default.TEXT_TOOL.TEXT_TOOL_ITALIC_BTN),g._$textToolFontColorBtn=g._$textToolWrapper.find(s.default.TEXT_TOOL.TEXT_TOOL_FONT_COLOR_BTN),g._$textToolFontColorPreview=g._$textToolFontColorBtn.find(s.default.TEXT_TOOL.TEXT_TOOL_COLOR_PREVIEW),g._$textToolBackColorBtn=g._$textToolWrapper.find(s.default.TEXT_TOOL.TEXT_TOOL_BACK_COLOR_BTN),g._$textToolBackColorPreview=g._$textToolBackColorBtn.find(s.default.TEXT_TOOL.TEXT_TOOL_COLOR_PREVIEW),g._fontsData=[{type:"default",title:E.default.getMessage("txt_font_default"),i18nClass:"_txt_font_default-text",fontFamily:"'malgun gothic','맑은 고딕','Helvetica Neue',helvetica,AppleSDGothicNeo-Regular,sans-serif,simhei","default":!0},{type:"nanumgothic",title:E.default.getMessage("txt_font_nanumgothic"),i18nClass:"_txt_font_nanumgothic-text",fontFamily:"'나눔고딕',nanumgothic,se_NanumGothic,AppleSDGothicNeo-Regular,sans-serif,simhei"},{type:"nanummyeongjo",title:E.default.getMessage("txt_font_nanummyeongjo"),i18nClass:"_txt_font_nanummyeongjo-text",fontFamily:"'나눔명조',nanummyeongjo,se_NanumMyeongjo,serif,simsun"},{type:"nanumbarungothic",title:E.default.getMessage("txt_font_nanumbarungothic"),i18nClass:"_txt_font_nanumbarungothic-text",fontFamily:"'나눔바른고딕',nanumbarungothic,se_NanumBarunGothic,AppleSDGothicNeo-Regular,sans-serif,simhei"}],g._colorPicker=new w.default(c,d),g._makeFontsData(),g._setOptions(e),g._renderTextTools(),g}return(0,j.default)(b,a),b.prototype._makeFontsData=function(){var a=o.default.getFontsDetected(),b=this._fontsData;G.forEach(function(a){b.push({type:a[0],title:a[0],fontFamily:"'"+a.join("','")+"'"})}),a.forEach(function(a){b.push({type:a,title:a,fontFamily:"'"+a+"',sans-serif,simhei"})})},b.prototype._setOptions=function(a){this._options=y.default.extend({callback:function(){}},a)},b.prototype.activate=function(){this._$textToolBtn.on("click.textToolbar",this._onClickTextToolBtn.bind(this)),this._$textToolBtn.on("change.textToolbar",this._onChangeTextToolBtn.bind(this)),this._$textToolSublist.on("click.textToolbar",s.default.TEXT_TOOL.TEXT_TOOL_BTN_SUBLIST_ITEM,this._onClickTextToolSublistItem.bind(this)),this._colorPicker.activate()},b.prototype.deactivate=function(){this._$textToolBtn.off("click.textToolbar"),this._$textToolBtn.off("change.textToolbar"),this._$textToolSublist.off("click.textToolbar"),this._colorPicker.deactivate(),this.removeAllListeners()},b.prototype._renderTextTools=function(){this._render(this._$textToolFontList,{fonts:this._fontsData}),this._$textToolFontListItems=this._$textToolFontList.find(s.default.TEXT_TOOL.TEXT_TOOL_FONT_LIST_ITEM),this._render(this._$textToolSizeList,{sizes:F}),this._$textToolSizeListItems=this._$textToolSizeList.find(s.default.TEXT_TOOL.TEXT_TOOL_SIZE_LIST_ITEM),this._$textToolFontColorPreview.css("background-color","#ffffff"),this._$textToolBackColorPreview.css("background-color","#000000"),this._$textToolFontColorBtn.data({color:"#ffffff",alpha:1}),this._$textToolBackColorBtn.data({color:"#000000",alpha:.5})},b.prototype._render=function(a,b){q.default.render(a,b)},b.prototype.loadGoogleWebfonts=function(){if(!b._loadedGoogleWebfonts){var a={active:function(){sessionStorage.fonts=!0},google:{families:[]}};b._loadedGoogleWebfonts=!0,G.forEach(function(b){a.google.families.push(b[0])}),A.default.load(a)}},b.prototype._getFontFamilyByFontType=function(a){var b=null;return this._fontsData.forEach(function(c){a===c.type&&(b=c.fontFamily)}),b},b.prototype.setFont=function(a){var b=this,c=this._$textToolFontListItems.filter(function(){return b._getFontFamilyByFontType((0,y.default)(this).data("type"))===a});c.length?c.trigger("click"):this._$textToolFontListItems.filter("[data-default]").trigger("click")},b.prototype.setDefaultFontSize=function(a){this._$textToolSizeListItems.filter("[data-default]").attr("data-type")||this.setFontSize(a)},b.prototype.setFontSize=function(a){a?this._$textToolSizeListItems.filter("[data-type='"+a+"']").attr("data-default",!0).trigger("click"):this._$textToolSizeListItems.filter("[data-default]").removeAttr("data-default")},b.prototype.setBold=function(a){a?this._$textToolBoldBtn.addClass(s.default.ACTIVE_TOGGLE_CLASS).trigger("change"):this._$textToolBoldBtn.removeClass(s.default.ACTIVE_TOGGLE_CLASS).trigger("change")},b.prototype.setItalic=function(a){a?this._$textToolItalicBtn.addClass(s.default.ACTIVE_TOGGLE_CLASS).trigger("change"):this._$textToolItalicBtn.removeClass(s.default.ACTIVE_TOGGLE_CLASS).trigger("change")},b.prototype.setFontColor=function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this._changeColorWithType(a,u.default.COOKIES.SIGNATURE_TEXT_FONT),this._changeAlphaWithType(b,u.default.COOKIES.SIGNATURE_TEXT_FONT),this._callbackFontColorSelect({color:a,alpha:b})},b.prototype.setBackColor=function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this._changeColorWithType(a,u.default.COOKIES.SIGNATURE_TEXT_BACK),this._changeAlphaWithType(b,u.default.COOKIES.SIGNATURE_TEXT_BACK),this._callbackBackColorSelect({color:a,alpha:b})},b.prototype._onClickTextToolBtn=function(a){var b=a.currentTarget,c=a.target,d=(0,y.default)(b),e=d.data("clickcode");if(!(0,y.default)(c).is(s.default.TEXT_TOOL.TEXT_TOOL_BTN_SUBLIST_ITEM)&&!(0,y.default)(c).closest(this._colorPicker.container).length)return e&&C.default.log(e,b,a),this._hasTextToolSublist(d)?void this._toggleTextToolSublist(d):d.is(this._$textToolFontColorBtn)?void this._toggleTextToolColorLayer(d,{typePrefix:u.default.COOKIES.SIGNATURE_TEXT_FONT,callback:this._callbackFontColorSelect.bind(this),defaultColor:d.data("color")||this._options.defaultTextColor,defaultAlpha:void 0===d.data("alpha")||null===d.data("alpha")?this._options.defaultTextAlpha:d.data("alpha")}):d.is(this._$textToolBackColorBtn)?void this._toggleTextToolColorLayer(d,{typePrefix:u.default.COOKIES.SIGNATURE_TEXT_BACK,callback:this._callbackBackColorSelect.bind(this),defaultColor:d.data("color")||this._options.defaultBgColor,defaultAlpha:void 0===d.data("alpha")||null===d.data("alpha")?this._options.defaultBgAlpha:d.data("alpha")}):void d.toggleClass(s.default.ACTIVE_TOGGLE_CLASS).trigger("change")},b.prototype._callbackFontColorSelect=function(a){var b=a.color,c=a.alpha,d=this._$textToolFontColorBtn;d.find(s.default.TEXT_TOOL.TEXT_TOOL_COLOR_PREVIEW).css({"background-color":b}),d.data({color:b,alpha:c}).trigger("change")},b.prototype._callbackBackColorSelect=function(a){var b=a.color,c=a.alpha,d=this._$textToolBackColorBtn,e=d.find(s.default.TEXT_TOOL.TEXT_TOOL_COLOR_PREVIEW),f=d.find(s.default.TEXT_TOOL.TEXT_TOOL_BTN_TITLE),g=0;b.match(/[a-f0-9]{2}/gi).forEach(function(a){g+=parseInt(a,16)}),g/3>128?f.addClass("black"):f.removeClass("black"),e.css({"background-color":b}),d.data({color:b,alpha:c}).trigger("change")},b.prototype.enableEmit=function(){this._disableEmit=!1},b.prototype.disableEmit=function(){this._disableEmit=!0},b.prototype._onChangeTextToolBtn=function(){this._disableEmit||this.emit("update")},b.prototype.getData=function(){var a={},b=this._$textToolFontBtn.attr("data-type"),c=this._fontsData.filter(function(a){return a.type===b}),d=c[0];return this._$textToolFontBtn.css("font-family",d.fontFamily),a.font=d.fontFamily,a.fontSize=this._$textToolSizeBtn.attr("data-type"),a.bold=this._$textToolBoldBtn.hasClass(s.default.ACTIVE_TOGGLE_CLASS),a.italic=this._$textToolItalicBtn.hasClass(s.default.ACTIVE_TOGGLE_CLASS),a.textColor=this._$textToolFontColorBtn.data("color"),a.textAlpha=this._$textToolFontColorBtn.data("alpha"),a.bgColor=this._$textToolBackColorBtn.data("color"),a.bgAlpha=this._$textToolBackColorBtn.data("alpha"),a},b.prototype._hasTextToolSublist=function(a){return!!a.find(s.default.TEXT_TOOL.TEXT_TOOL_BTN_SUBLIST).length},b.prototype._toggleTextToolSublist=function(a){var b=this,c=a.find(s.default.TEXT_TOOL.TEXT_TOOL_BTN_SUBLIST),d="click."+o.default.getUniqueId();c.hasClass(s.default.ACTIVE_TOGGLE_CLASS)||(c.addClass(s.default.ACTIVE_TOGGLE_CLASS),c.scrollTop(c.data("scrollTop")||c.scrollTop()+c.children("."+s.default.ACTIVE_TOGGLE_CLASS).position().top),setTimeout(function(){b._$wrapper.off(d).on(d,function(a){c.data("scrollTop",c.scrollTop()),c.removeClass(s.default.ACTIVE_TOGGLE_CLASS),b._$wrapper.off(d)})},10))},b.prototype._toggleTextToolColorLayer=function(a,b){this._colorPicker.setOptions(b);var c=this._colorPicker.isChildOf(a);c&&!this._colorPicker.isVisible()?this._colorPicker.show():c||(this._colorPicker.appendTo(a),this._colorPicker.show())},b.prototype._onClickTextToolSublistItem=function(a){var b=(0,y.default)(a.currentTarget),c=b.closest(s.default.TEXT_TOOL.TEXT_TOOL_BTN),d=c.find(s.default.TEXT_TOOL.TEXT_TOOL_BTN_TITLE),e=c.find(s.default.TEXT_TOOL.TEXT_TOOL_BTN_SUBLIST),f=b.data("type"),g=b.text();b.hasClass(s.default.DISABLE_TOGGLE_CLASS)||(b.addClass(s.default.ACTIVE_TOGGLE_CLASS).siblings().removeClass(s.default.ACTIVE_TOGGLE_CLASS),d.css("font-family",b.css("font-family")).text(g),e.data("scrollTop",e.scrollTop()+b.position().top),c.attr("data-type",f).trigger("change"))},b.prototype._changeColorWithType=function(a,b){this._colorPicker.setOptions({typePrefix:b}),this._colorPicker.setColor(a)},b.prototype._changeAlphaWithType=function(a,b){this._colorPicker.setOptions({typePrefix:b}),this._colorPicker.setAlpha(a)},b}(l.default);b.default=H},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(1),h=d(g),i=c(2),j=d(i),k=c(3),l=d(k),m=c(36),n=d(m),o=c(14),p=(d(o),c(7)),q=(d(p),c(12)),r=(d(q),c(8)),s=(d(r),c(11)),t=(d(s),c(5)),u=d(t),v=c(16),w=(d(v),c(426)),x=d(w),y=function(a){function b(c,d,e){(0,f.default)(this,b);var g=(0,j.default)(this,a.call(this));return g._storage=d,g._colorPickerStorage={},e=e||{typePrefix:"",callback:function(){},defaultColor:"#ffffff",defaultAlpha:.5},g._setOptions(e),g._view=new x.default({selector:c,use:g._options.use||{colorTable:!0,opacitySlider:!0,outlineSlider:!1}}),g._setRecentColors(),g}return(0,l.default)(b,a),b.prototype._setOptions=function(a){this._options=u.default.extend(!0,this._options,a),this._color=this._options.defaultColor,this._alpha=Number(this._options.defaultAlpha),this._outline=Number(this._options.defaultOutline)},b.prototype.activate=function(){this._view.on("changeColor",this._onChangeColor.bind(this)),this._view.on("changeOpacity",this._onChangeOpacity.bind(this)),this._view.on("changeOutline",this._onChangeOutline.bind(this)),this._view.on("show",this._onShow.bind(this)),this._view.on("hide",this._onHide.bind(this)),this._view.activate()},b.prototype.deactivate=function(){this._view.deactivate(),this.removeAllListeners()},b.prototype._onChangeColor=function(a){this.setColor(a),this.emit("changeColor",a),this.emit("update"),this._doCallback()},b.prototype._onChangeOpacity=function(a){this.setAlpha(a),this.emit("changeOpacity",a),this.emit("update"),this._doCallback()},b.prototype._onChangeOutline=function(a){this.setOutline(a),this.emit("changeOutline",a),this.emit("update"),this._doCallback()},b.prototype._onShow=function(){this.emit("show")},b.prototype._onHide=function(){this.emit("hide")},b.prototype._doCallback=function(){var a=this._options.callback||function(){};"function"==typeof a&&a({color:this.color,alpha:this.alpha,outline:this.outline})},b.prototype.appendTo=function(a){this._view.appendTo(a)},b.prototype.isChildOf=function(a){return this._view.isChildOf(a)},b.prototype.setColor=function(a){var b=this._options.typePrefix;/^#[0-9a-z]{6}$/.test(a)||(a=this._options.defaultColor),this._color=a,this._colorPickerStorage[b]=this._colorPickerStorage[b]||{},this._colorPickerStorage[b].selectedColor=a,this._addColorUsedHistory(a),this._setRecentColors(),this._view.setColor(a)},b.prototype.setAlpha=function(a){var b=this._options.typePrefix;a=Number(a),this._alpha=a,this._colorPickerStorage[b]=this._colorPickerStorage[b]||{},this._colorPickerStorage[b].selectedAlpha=a,this._view.setOpacity(a)},b.prototype.setOutline=function(a){var b=this._options.typePrefix;a=Number(a),this._outline=a,this._colorPickerStorage[b]=this._colorPickerStorage[b]||{},this._colorPickerStorage[b].selectedOutline=a,this._view.setOutline(a)},b.prototype.setOptions=function(a){this._setOptions(a)},b.prototype.isVisible=function(){return this._view.isVisible()},b.prototype.show=function(){var a=this._options,b=a.typePrefix,c=this._colorPickerStorage[b]||{},d=c.selectedColor||a.defaultColor,e=void 0===c.selectedAlpha?a.defaultAlpha:c.selectedAlpha,f=c.selectedOutline||a.defaultOutline;this._view.show(b),this._view.setColor(d),this._view.setOpacity(e),this._view.setOutline(f)},b.prototype.hide=function(){this._view.hide()},b.prototype._addColorUsedHistory=function(a){var b=this._options.typePrefix+"Colors",c=this._storage.getItem(b)||"";if(c=""===c?[]:c.split(","),7===a.length){var d=c.indexOf(a);-1!==d&&c.splice(d,1),c.push(a),c.length>=20&&(c.reverse(),c=c.splice(0,20).reverse()),this._storage.setItem(b,c)}},b.prototype._setRecentColors=function(){var a=this._options.typePrefix+"Colors",b=this._storage.getItem(a);b=b?b.split(",").reverse():[],this._view.setRecentColors(b)},(0,h.default)(b,[{key:"color",get:function(){return this._color}},{key:"alpha",get:function(){return this._alpha}},{key:"outline",get:function(){return this._outline}},{key:"container",get:function(){return this._view.container}}]),b}(n.default);b.default=y},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}var e=c(0),f=d(e),g=c(1),h=d(g),i=c(218),j=d(i),k=c(414),l=d(k),m=c(417),n=d(m),o=c(419),p=d(o),q=c(420),r=d(q),s=c(421),t=d(s),u=c(422),v=d(u),w=c(423),x=d(w),y=c(424),z=d(y),A=c(425),B=d(A),C=c(432),D=d(C),E=c(433),F=d(E),G=c(434),H=d(G),I=c(435),J=d(I),K=c(14),L=(d(K),c(7)),M=d(L),N=c(8),O=d(N),P=c(12),Q=d(P),R=c(5),S=d(R),T=function(){function a(){return(0,f.default)(this,a),a.instance||(a.instance=this),void 0,a.instance}return a.prototype.init=function(a){var b={},c=void 0;this._controller=new j.default,this._controller.setup(a),c=this._controller.options.functions,this._renderTemplate(),this._controller.setViews(b),this._controller.init(),b.common=new l.default(this._controller),b.list=new n.default(this._controller),b.control=new p.default(this._controller),c.useFilter&&(b.filterControl=new r.default(this._controller)),c.useResize&&(b.resizeControl=new t.default(this._controller)),c.useCrop&&(b.cropControl=new v.default(this._controller)),c.useAdjust&&(b.adjustControl=new x.default(this._controller)),c.useMosaic&&(b.mosaicControl=new z.default(this._controller)),c.useSignature&&(b.signatureControl=new B.default(this._controller)),c.useSticker&&(b.stickerControl=new D.default(this._controller)),c.useText&&(b.textControl=new F.default(this._controller)),c.usePhotoFrame&&(b.frameControl=new H.default(this._controller)),c.useClip&&(b.clipControl=new J.default(this._controller))},a.prototype._renderTemplate=function(){(0,S.default)(O.default.PHOTOEDITOR_WRAP).length||(0,S.default)(this._controller.options.container).append(Q.default.html)},a.prototype.setup=function(a){this._controller.setup(a)},a.prototype.open=function(a){var b=this;if(!this._controller.opened){var c=M.default.getIEVersion();this.setup(a),10===c?setTimeout(function(){return b._controller.open()},0):this._controller.open()}},a.prototype.close=function(){this._controller.close()},a.prototype.changeLanguage=function(a){this._controller.changeLanguage(a)},a.prototype.updatePhotos=function(a){this._controller.updatePhotos(a)},a.prototype.uploadFailed=function(a){this._controller.uploadFailed(a);
},(0,h.default)(a,[{key:"editor",get:function(){return this._controller._editor}},{key:"opened",get:function(){return Boolean(this._controller.opened)}}]),a}();window&&(window.PhotoEditorApp=T),a.exports=T},function(a,b,c){a.exports={"default":c(216),__esModule:!0}},function(a,b,c){c(217);var d=c(9).Object;a.exports=function(a,b,c){return d.defineProperty(a,b,c)}},function(a,b,c){var d=c(13);d(d.S+d.F*!c(27),"Object",{defineProperty:c(28).f})},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(4),f=d(e),g=c(30),h=d(g),i=c(71),j=d(i),k=c(0),l=d(k),m=c(1),n=d(m),o=c(2),p=d(o),q=c(3),r=d(q),s=c(36),t=d(s),u=c(248),v=d(u),w=c(251),x=d(w),y=c(14),z=d(y),A=c(7),B=d(A),C=c(163),D=d(C),E=c(20),F=d(E),G=c(168),H=d(G),I=c(11),J=d(I),K=c(8),L=d(K),M=c(16),N=d(M),O=c(259),P=d(O),Q=c(261),R=d(Q),S=c(169),T=d(S),U=c(371),V=(d(U),c(5)),W=d(V),X=c(413),Y=d(X),Z=function(a){function b(){(0,l.default)(this,b);var c=(0,p.default)(this,a.call(this));return c._options=W.default.extend(!0,{},z.default.defaultOptions),c._views={},c}return(0,r.default)(b,a),b.prototype.init=function(){this._canvas=document.querySelector(L.default.CANVAS),this._editor=null,this._latelyMouseDownEvent=null,this._storage=new P.default(this._options.setting.userId||$SE_CONFIG.USER_INFO.id),this._grafolio=new x.default(this._options,this._options.popupUploaderStickerType),this._photoinfraRequest=new R.default(this),this._modal=new H.default(this._storage),this._state={photos:[],opened:!1,prevPhoto:null,currentPhoto:null,selectedControl:null,selectedCropType:J.default.CONTROL.CROP.FREE,isLoading:!1,canvasReady:!1,hasThumbnail:!1,isCheckedHasThumbnail:!1,onceTooltip:{},viewport:{},upload:{}},this._waitAsyncPool=[],(0,W.default)(window).on("popstate.pe",this._onPopstate.bind(this))},b.prototype.setViews=function(a){this._views=a},b.prototype.setEditor=function(){this.resizeCanvas(),this.createEditor(),this.activateEditor()},b.prototype.createEditor=function(){var a=this._getEditorOptions();this._editor=new T.default(a,this._canvas,!1,this._options.backgroundColor)},b.prototype.setEditorColorTables=function(){function a(){return b.apply(this,arguments)}var b=(0,j.default)(h.default.mark(function c(){var a=this;return h.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(this._state.filterReady){b.next=4;break}return b.next=3,this._editor.setFilterColorTables(z.default.filters.map(function(b){return a._options.filterPath+b.path}));case 3:this._state.filterReady=!0;case 4:case"end":return b.stop()}},c,this)}));return a}(),b.prototype._getEditorOptions=function(){var a=(0,W.default)(this._canvas),b=this._options.filterPath,c=this._options.theme,d=c?"0x"+z.default.themes[c].signatureColor:void 0,e=this._options.cors?"Anonymous":null,f=e,g={magnify:{compareOriginalEnable:!0},resize:{preset:this.options.resizePreset},filter:{crossOrigin:f,colorTableURLs:z.default.filters.map(function(a){return b+a.path}),comparable:!0,defaultValue:1},adjust:{comparable:!0},crop:{offsetX:parseInt(a.offset().left,10),offsetY:parseInt(a.offset().top,10),aspectRatioType:this._options.cropDefault,cursorDefaultColor:d,cursorAspectRatioColor:d},autoRotateSize:1600,editingFilterAsyncMode:!1,signature:{lineWidth:1,lineColor:16775936,w:10,h:10,exitBtnImageURL:b+"sign_close.png",exitBtnMouseoverImageURL:b+"sign_close_hover.png",renderOnClient:!0},useControls:[],sticker:{crossOrigin:f,horizontalGap:10,verticalGap:5,useSnap:!0,snapAngle:5},photoFrame:{crossOrigin:f,imgPath:b+"frame.png"},clip:{assets:z.default.masks.map(function(a){return b+a.path}),entry:{index:this._options.clip.index,lineWidth:this._options.clip.lineWidth,opacity:this._options.clip.opacity,color:this._options.clip.color},dimmedOpacity:this._options.clip.dimmedOpacity},mosaic:{crossOrigin:f},text:{crossOrigin:f},crossOrigin:e,webglFilterEnable:this._options.webglFilterEnable};B.default.isSafari()&&(g.crossOrigin=null);var h={useFilter:"filter",useCrop:"crop",useResize:"resize",useAdjust:"adjust",useMosaic:"mosaic",useSignature:"signature",useSticker:"sticker",useText:"text",usePhotoFrame:"photoFrame",useClip:"clip"};for(var i in h)this.options.functions[i]&&g.useControls.push(h[i]);return g},b.prototype.activateEditor=function(){this._editor.on("ready",this._onReadyEditor.bind(this)),this._editor.on("imageReady",this._onCanvasImageReady.bind(this)),this._editor.on("imageLoadFail",this._onCanvasImageLoadFail.bind(this)),this._editor.on("bitmapDataUpdate",this._onUpdateBitmapdata.bind(this)),this._editor.on("viewportMotionComplete",this._onViewportMotionComplete.bind(this)),this._editor.on("imageProcessingComplete",this._onProcessComplete.bind(this)),this._editor.on("imageProcessing",this._onProcessing.bind(this)),this._editor.on("editImageComplete",this._onEditComplete.bind(this)),this._editor.on("phaseChange",this._onPhaseChange.bind(this)),this._editor.on("OUT_OF_MEMORY",this._onOutOfMemory.bind(this)),this._editor.on("historyChanged",this._onChangeHistory.bind(this))},b.prototype.activate=function(){(0,W.default)(window).on("resize.pe",this._onResizeWindow.bind(this));for(var a in this._views)this._views[a].activate()},b.prototype.deactivate=function(){(0,W.default)(window).off("resize.pe");for(var a in this._views)this._views[a].deactivate();this.removeAllListeners()},b.prototype.waitAsyncResponseEvent=function(a){return-1!==this._waitAsyncPool.indexOf(a)?1:(this._waitAsyncPool.push(a),0)},b.prototype.isWaitingAsyncResponseEvent=function(){return!!this._waitAsyncPool.length},b.prototype.removeAsyncReponseEvent=function(a){if(a&&this._waitAsyncPool.length){var b=this._waitAsyncPool.indexOf(a);-1!==b&&this._waitAsyncPool.splice(b,1)}else this._waitAsyncPool=[]},b.prototype._onCanvasImageReady=function(){this._state.canvasReady=!0,this.resetControls(!0),this.unsetHold(),this.unsetDimmed(),this.emit("canvasReady"),this._applyBatchOptions(),this._checkHasThumbnail()},b.prototype._onCanvasImageLoadFail=function(a){var b=this,c=this._state.prevPhoto,d=this._state.currentPhoto;this.unsetHold(),this.alert(F.default.getMessage("txt_alert_error"),null,function(){c&&c.key!==d.key?(b.setHold(),b.changeCurrentPhoto(c)):b.close()})},b.prototype._onUpdateBitmapdata=function(a){this.emit("changeBitmapdata",a),this.removeAsyncReponseEvent(a.type),this.checkFitToViewport()},b.prototype._onViewportMotionComplete=function(a){this.checkFitToViewport()},b.prototype._applyBatchOptions=function(){var a=this.getCurrentPhoto(),b=a.getBatchOption();b.resize&&this.emit("changeResize",b.resize),b.signature&&this.emit("changeSignature",b.signature.type)},b.prototype._onCanvasRotateChange=function(a){this.emit("rotateChange",a)},b.prototype.setup=function(a){var b=this;a&&void 0!==(void 0===a?"undefined":(0,f.default)(a))&&(a.photos&&(this._options.photos=null),this._options.resizePreset=a.resizePreset||this._options.resizePreset,this._options.cropPreset=a.cropPreset||this._options.cropPreset,this._options=W.default.extend(!0,this._options,a),this._options.photos=B.default.objectToArray(this._options.photos),this._options.setting||(this._options.setting={env:this._options.env,lang:this._options.lang,userId:$SE_CONFIG.USER_INFO.id,serviceName:$SE_CONFIG.ENV_SETTING.SERVICE_NAME}),N.default.setOptions({serviceCode:this._options.setting.serviceName}),this._options.resizePreset.map(function(a,c){a>2880&&b._options.resizePreset.splice(c,1)}))},b.prototype.open=function(){function a(){return b.apply(this,arguments)}var b=(0,j.default)(h.default.mark(function c(){var a=this;return h.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(B.default.isFunction(this._options.beforeOpen)&&this._options.beforeOpen(),v.default.resetIndex(),this.activate(),this.setHold(),this.changeLanguage(this._options.setting.lang),this._resetStates(),this._editor){b.next=11;break}return b.next=9,D.default.action(J.default.CALLBACK_TYPES.SET_EDITOR,function(){return a.setEditor()});case 9:return b.next=11,this.setEditorColorTables();case 11:this.emit("open"),this._setHistoryState(),this.setPhotos(this._options.photos),this.resizeCanvas(),B.default.isFunction(this._options.afterOpen)&&this._options.afterOpen();case 16:case"end":return b.stop()}},c,this)}));return a}(),b.prototype._resetStates=function(){this._state.opened=!0,this._state.prevPhoto=null,this._state.isCheckedHasThumbnail=!1;for(var a in this._state.onceTooltip)this._state.onceTooltip[a]=!1},b.prototype._onPopstate=function(){function a(a){return b.apply(this,arguments)}var b=(0,j.default)(h.default.mark(function c(a){var b,d,e,f,g;return h.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(b=this._state.opened,d=a.originalEvent.state||{},e=this._hasChangedOrSorted()||this._hasChanged(),f=F.default.getMessage("txt_confirm_close_tit"),g=F.default.getMessage("txt_confirm_close_desc"),this._listMode===J.default.LIST_MODE.LIST){c.next=9;break}return this._setHistoryState(),this.changeListMode(J.default.LIST_MODE.LIST),c.abrupt("return");case 9:if(!b||d.photoeditorMode){c.next=19;break}if(!e){c.next=16;break}return this._setHistoryState(),c.next=14,this._asyncConfirm(f,g);case 14:if(c.sent){c.next=16;break}return c.abrupt("return");case 16:this.close(),c.next=20;break;case 19:!b&&d.photoeditorMode&&(d.photoeditorMode=!1,history.replaceState(d,null,location.href));case 20:case"end":return c.stop()}},c,this)}));return a}(),b.prototype._setHistoryState=function(){var a=history.state||{};a.photoeditorMode||(a.photoeditorMode=!0,history.pushState(a,null,location.href))},b.prototype._historyBack=function(){var a=history.state||{};a.photoeditorMode&&(a.photoeditorMode=!1,history.replaceState(a,null,location.href),history.back())},b.prototype._getUploadErrorMessage=function(a){var b="image_upload_error_"+a.toLowerCase();return F.default.getMessage[b]||a||"unknown error"},b.prototype._onReadyEditor=function(){var a=this,b=this._editor.options.controlsMap;this.resizeViewport(),this.options.functions.useCrop&&(this._editor.crop.on("rotateStart",function(b){a.emit("changeCropAngleStart",b)}),this._editor.crop.on("rotate",function(b){a.emit("changeCropAngle",b)}),this._editor.crop.on("uiChange",this._onCropUiChange.bind(this)),this._editor.crop.on("uiMoveStart",function(b){a.emit("changeCropAreaStart",b)}),this._editor.crop.on("uiMove",function(b){a.emit("changeCropArea",b)}),this._editor.crop.on("uiMoveEnd",function(b){a.emit("changeCropAreaEnd",b)}),this._editor.crop.on("changeAspectRatio",function(b){a.emit("changeAspectRatio",b)}),this._editor.crop.on("aspectRatioMotionStart",function(b){a.emit("aspectRatioMotionStart",b)}),this._editor.crop.on(b.crop.CROP_START,this._onReadyCropStart.bind(this))),this.options.functions.useSignature&&(this._editor.signature.on(b.signature.UPDATE_W_TOOLTIP,function(b){a.emit("updateSignatureWidthTooltip",b)}),this._editor.signature.on(b.signature.ADD_W_TOOLTIP,function(b){a.emit("addSignatureWidthTooltip",b)}),this._editor.signature.on(b.signature.REMOVE_W_TOOLTIP,function(b){a.emit("removeSignatureWidthTooltip",b)}),this._editor.signature.on(b.signature.UPDATE_H_TOOLTIP,function(b){a.emit("updateSignatureHeightTooltip",b)}),this._editor.signature.on(b.signature.ADD_H_TOOLTIP,function(b){a.emit("addSignatureHeightTooltip",b)}),this._editor.signature.on(b.signature.REMOVE_H_TOOLTIP,function(b){a.emit("removeSignatureHeightTooltip",b)}),this._editor.signature.on(b.signature.EXIT_BUTTON_CLICK,function(b){a.emit("exitSignature",b)}),this._editor.signature.on(b.signature.IMAGE_SIGN_READY,function(b){a.emit("imageSignReady",b)})),this.options.functions.useSticker&&(this._editor.sticker.on(b.sticker.DELETED,function(b){a.emit("deleteSticker",b)}),this._editor.sticker.on(b.sticker.SELECTED,function(b){a.emit("selectSticker",b)}),this._editor.sticker.on(b.sticker.DESELECTED,function(b){a.emit("deselectSticker",b)})),this.options.functions.useText&&(this._editor.text.on(b.text.DELETED,function(b){a.emit("deleteText",b)}),this._editor.text.on(b.text.SELECT,function(b){a.emit("selectText",b)}),this._editor.text.on(b.text.DESELECT_TEXT,function(b){a.emit("deselectText",b)}),this._editor.text.on(b.text.ACTIVE_INPUT,function(b){a.emit("activeInput",b)})),this.options.functions.useClip&&this._editor.clip.on(b.clip.CLIP_READY,function(b){setTimeout(function(){return a._emitClipState()},20)}),D.default.callback(J.default.CALLBACK_TYPES.SET_EDITOR)},b.prototype.setPhotos=function(a){var b=this._state.photos=[];a.forEach(function(a){var c=new v.default(a);b.push(c)}),this.emit("setPhotos",this._state),this._initCurrentPhoto()},b.prototype._initCurrentPhoto=function(){var a=this,b=this.getPhotosArray(),c=void 0;this._state.hasThumbnail=!1,b.forEach(function(b){c||(a._options.initKey?a._options.initKey===b.key&&(c=b):b.isReady&&(c=b)),a._state.hasThumbnail||Math.max(b.width,b.height)>z.default.thumbnailTypeSize&&(a._state.hasThumbnail=!0)}),c&&this.changeCurrentPhoto(c)},b.prototype._checkHasThumbnail=function(){var a=this._options.functions,b=this.getCurrentPhoto();!this._state.isCheckedHasThumbnail&&this._options.usePhotoinfraThumbnailType&&a.useResize&&b.isEditable&&(Math.max(b.width,b.height)>z.default.thumbnailTypeSize&&this.changeControl(J.default.CONTROLS.RESIZE),this._state.hasThumbnail&&this.showTooltipOnce("resize",F.default.getMessage("txt_notice_has_thumbnail")),this._state.isCheckedHasThumbnail=!0)},b.prototype.updatePhotos=function(){var a=this,b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],c=this._state.photos,d=[],e=[];this._state.opened&&(b=B.default.objectToArray(b),b.forEach(function(b){var f=c.filter(function(a){return a.key===b.key}),g=f[0];g?(g.update(b),d.push(g)):(g=new v.default(b),c.push(g),e.push(g)),a.emit("updatePhotos",{photosAdded:e,photosUpdated:d})}),this.checkUploadComplete())},b.prototype.isHolded=function(){return this._state.isLoading},b.prototype.setHold=function(){this._state.isLoading||(this._state.isLoading=!0,this.emit("setHold"))},b.prototype.unsetHold=function(){!this.isUploading()&&this._state.isLoading&&(this._state.isLoading=!1,this.emit("unsetHold"))},b.prototype.setDimmed=function(){this.emit("setDimmed")},b.prototype.unsetDimmed=function(){this.emit("unsetDimmed")},b.prototype.abort=function(){this.finishUpload()},b.prototype.startUploading=function(a){var b=this;return W.default.Deferred(function(c){b._state.upload.uploading=!0,b._state.upload.photo=a,b._state.upload.callback=function(){c.resolve()}}).promise()},b.prototype.isUploading=function(){return this._state.upload.uploading},b.prototype.finishUpload=function(){this.isUploading()&&(this._state.upload.uploading=!1,this._state.upload.callback=null)},b.prototype.checkUploadComplete=function(){this.isUploading()&&this.runUploadCallback()},b.prototype.runUploadCallback=function(){if(B.default.isFunction(this._state.upload.callback)){var a=this._state.upload.callback;setTimeout(a,10)}},b.prototype.uploadFailed=function(a){this.isUploading()&&(this.finishUpload(),this.unsetHold(),a.code&&this.alert(this._getUploadErrorMessage(a.code)))},b.prototype.alert=function(a,b,c){this.emit("alert",a,b,c)},b.prototype._asyncConfirm=function(a,b){var c=W.default.Deferred();return this.emit("confirm",a,b,function(){return c.resolve(!0)},function(){return c.resolve(!1)}),c},b.prototype.changeCurrentPhoto=function(){function a(a){return b.apply(this,arguments)}var b=(0,j.default)(h.default.mark(function c(a){return h.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return this._state.currentPhoto=a,a.isEditable||this.changeControl(null),this.emit("changeCurrentPhoto"),b.prev=3,b.next=6,this.setEditorImage(a);case 6:b.next=12;break;case 8:b.prev=8,b.t0=b.catch(3),B.default.debug(b.t0),this._onCanvasImageLoadFail(b.t0);case 12:case"end":return b.stop()}},c,this,[[3,8]])}));return a}(),b.prototype.getInitValues=function(a){var b={filter:{index:-1,value:0},frame:0,crop:this._options.cropDefault,resize:J.default.CONTROL.RESIZE.ORIGINAL,adjust:{autoAdjust:!1,brightness:0,saturation:1,sharpen:0,kelvin:0,contrast:1},signature:J.default.CONTROL.SIGNATURE.NONE,clip:{index:this._options.clip.index,lineWidth:this._options.clip.lineWidth,opacity:this._options.clip.opacity,color:this._options.clip.color}};return W.default.isEmptyObject(a)||(a.filter&&a.filter.index>-1&&(b.filter.index=a.filter.index,b.filter.value=a.filter.values[a.filter.index]),a.resize&&a.resize.width&&(b.resize=a.resize.width),a.adjust&&a.adjust.modified&&(b.adjust.autolevel=a.adjust.autolevel,b.adjust.brightness=a.adjust.brightness,b.adjust.saturation=a.adjust.saturation,b.adjust.sharpen=a.adjust.sharpen,b.adjust.kelvin=a.adjust.kelvin,b.adjust.contrast=a.adjust.contrast),a.signature&&a.signature.signature&&(b.signature=a.signature.signature),a.photoFrame&&a.photoFrame.index&&(b.frame=a.photoFrame.index),b.crop=this._getCurrentCropTypeFromSnapshot(a),a.clip&&a.clip.index>-1&&(b.clip.index=a.clip.index,b.clip.lineWidth=a.clip.mask.thickness,b.clip.opacity=a.clip.mask.opacity,b.clip.color="#"+Number(a.clip.mask.color).toString(16))),this._state.selectedCropType=b.crop,b},b.prototype._getCurrentCropTypeFromSnapshot=function(a){return a.crop&&a.crop.cropVO&&a.crop.cropVO.aspectRatioVO&&a.crop.cropVO.aspectRatioVO.aspectRatioWidth?a.crop.cropVO.aspectRatioVO.aspectRatioWidth+":"+a.crop.cropVO.aspectRatioVO.aspectRatioHeight:this._options.cropDefault},b.prototype._asyncGetPhotoImageURL=function(){function a(a){return b.apply(this,arguments)}var b=(0,j.default)(h.default.mark(function c(a){var b,d,e;return h.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(b=W.default.Deferred(),d=a.domain+a.path,e=B.default.getIEVersion(),this._options.usePhotoinfraThumbnailType&&Math.max(a.width,a.height)>z.default.thumbnailTypeSize&&(d=d.split("?")[0],d+=z.default.thumbnailTypeQueryString),-1===d.indexOf("?")&&(d+="?"),10!==e){c.next=13;break}return c.t0=b,c.next=9,B.default.urlToBlob(d);case 9:c.t1=c.sent,c.t0.resolve.call(c.t0,c.t1),c.next=22;break;case 13:if(!B.default.isSafari()){c.next=21;break}return c.t2=b,c.next=17,B.default.urlToBase64(d);case 17:c.t3=c.sent,c.t2.resolve.call(c.t2,c.t3),c.next=22;break;case 21:b.resolve(d);case 22:return c.abrupt("return",b);case 23:case"end":return c.stop()}},c,this)}));return a}(),b.prototype.setEditorImage=function(){function a(a){return b.apply(this,arguments)}var b=(0,j.default)(h.default.mark(function c(a){var b,d,e;return h.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return b=this,d=a.getSnapshotFromBatchOption(),c.next=4,this._asyncGetPhotoImageURL(a);case 4:e=c.sent,this._state.canvasReady=!1,this._editor.setImageByURL(e,d);case 7:case"end":return c.stop()}},c,this)}));return a}(),b.prototype.changeLanguage=function(a){F.default.setLang(a),this._options.setting.lang=a,this.emit("changeLanguage",a)},b.prototype._asyncConfirmCropSave=function(){function a(a,c){return b.apply(this,arguments)}var b=(0,j.default)(h.default.mark(function c(a,b){var d,e;return h.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(d=this.currentControl===J.default.CONTROLS.CROP){c.next=3;break}return c.abrupt("return");case 3:if(!this._isCropNewChanged()){c.next=9;break}return e=F.default.getMessage(a),c.next=7,this._asyncConfirm(e);case 7:if(!c.sent){c.next=9;break}this._saveCropForced(b);case 9:case"end":return c.stop()}},c,this)}));return a}(),b.prototype._asyncConfirmClipSave=function(){function a(a,c){return b.apply(this,arguments)}var b=(0,j.default)(h.default.mark(function c(a,b){var d,e;return h.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(d=this.currentControl===J.default.CONTROLS.CLIP){c.next=3;break}return c.abrupt("return");case 3:if(!this._isClipNewChanged()){c.next=9;break}return e=F.default.getMessage(a),c.next=7,this._asyncConfirm(e);case 7:if(!c.sent){c.next=9;break}this._saveClipForced(b);case 9:case"end":return c.stop()}},c,this)}));return a}(),b.prototype.selectControl=function(a){var b=this;!this.getCurrentPhoto()||this.isHolded()||this.isWaitingAsyncResponseEvent()||this._asyncConfirmCropSave("txt_confirm_crop_tit",!0).then(function(){return b._asyncConfirmClipSave("txt_confirm_clip_tit",!0)}).then(function(){return b.changeControl(a)})},b.prototype.changeControl=function(a){this.hideToastMessage();var b=(this.currentControl,this._state.cropDefer=W.default.Deferred());return a&&this.isHolded()&&!this.isUploading()?b.resolve():this.isWaitingAsyncResponseEvent()?b.resolve():(a===J.default.CONTROLS.CROP&&(this.waitAsyncResponseEvent("cropStart"),this.waitAsyncResponseEvent("uiChange")),this.emit("changeControl",a),this.setEditorPhase(a),this.resizeViewport(!0),b.resolve(),a===J.default.CONTROLS.CROP&&this.emit("changeCrop",this._state.selectedCropType),a===J.default.CONTROLS.CLIP&&this._emitClipState(),a!==J.default.CONTROLS.MOSAIC||this._editor.screenFitEnable||this.showTooltipOnce("mosaic",F.default.getMessage("txt_notice_mosaic_drag"),1e4),b)},b.prototype.setEditorPhase=function(a){this._state.selectedControl=a,this._editor.phase=a||"main"},b.prototype._onPhaseChange=function(a){this.changeControl(a.phase)},b.prototype._onOutOfMemory=function(a){this.isUploading()&&this.finishUpload(),this.unsetHold(),this.alert(F.default.getMessage("txt_alert_out_of_memory")),this._editor.clear(),this.changeCurrentPhoto(this.getCurrentPhoto())},b.prototype._onChangeHistory=function(a){var b=a.undoable,c=a.redoable;this.checkModified(),this.emit("changeHistory",{undoable:b,redoable:c})},b.prototype._onCropUiChange=function(a){this.removeAsyncReponseEvent("uiChange"),this.emit("changeCropArea",a)},b.prototype._onReadyCropStart=function(a){this.checkCropRotation(),this.checkCropEditable(),this.checkCropMinimum(),this.removeAsyncReponseEvent("cropStart")},b.prototype.close=function(){var a=this;B.default.isFunction(this._options.beforeClose)&&this._options.beforeClose(),this.changeControl().then(function(){var b=W.default.Deferred();a.isUploading()&&a.abort(),a._state.opened=!1,a.emit("close",b),a.deactivate(),a._historyBack(),a._editor.clear(),b.then(function(){B.default.isFunction(a._options.afterClose)&&a._options.afterClose()})})},b.prototype._onProcessComplete=function(a){var b=this,c=this._state.upload.photo;this._options.upload&&this.isLocal?this._options.upload(c,B.default.stripBase64Header(a.dataURL)):this._photoinfraRequest.upload(c,a.dataURL),this.isLocal&&setTimeout(function(){b.updatePhotos([])},20)},b.prototype._onProcessing=function(a){this.setHold()},b.prototype._onEditComplete=function(a){this.unsetHold()},b.prototype.saveCurrentPhotoSnapshot=function(){var a=this.getCurrentPhoto(),b=this._editor.snapshot();if(this.modified&&a.isEditable){a.setSnapshot(b);var c=a.cropWidth||a.width,d=a.cropHeight||a.height,e=B.default.getThumbnailImageSizeForCover(c,d,400,400),f=e[0],g=e[1];a.thumbnailSrc=this.getThumbnailDataURL(f,g),a.thumbnailCropped=this._editor.getCroppedDataURL(f,g),a.thumbnailLargeSrc=this._options.useSingleImageFitScreen?this.getThumbnailDataURL(c,d):null}else a.setSnapshot(null),a.thumbnailSrc=a.originalThumbnail,a.thumbnailCropped=null,a.thumbnailLargeSrc=null},b.prototype.saveCurrentPhoto=function(){function a(){return b.apply(this,arguments)}var b=(0,j.default)(h.default.mark(function c(){var a;return h.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return a=this.getCurrentPhoto(),b.next=3,this._asyncSavePhoto(a);case 3:return b.abrupt("return",b.sent);case 4:case"end":return b.stop()}},c,this)}));return a}(),b.prototype.savePhotos=function(){function a(){return b.apply(this,arguments)}var b=(0,j.default)(h.default.mark(function c(){var a,b,d,e,f;return h.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:a=this.getPhotosArray(),b=this.getCurrentPhoto(),d=a.length,e=void 0,e=0;case 5:if(!(e<d)){c.next=14;break}if(f=a[e],f.key===b.key||!f.modified){c.next=11;break}return this._editor.clear(),c.next=11,this._asyncSavePhoto(f);case 11:e++,c.next=5;break;case 14:case"end":return c.stop()}},c,this)}));return a}(),b.prototype._hasChangedOrSorted=function(){return this._hasChanged()||this._hasSorted()},b.prototype._hasChanged=function(){var a=this._state.photos,b=!1;return a.forEach(function(a){a.modified&&(b=!0)}),!!b},b.prototype._isCropChanged=function(){var a=this.currentControl,b=!(!this._editor||!this._editor.crop)&&this._editor.crop.isChanged;return Boolean(a===J.default.CONTROLS.CROP&&b)},b.prototype._isCropNewChanged=function(){var a=this.currentControl,b=!(!this._editor||!this._editor.crop)&&this._editor.crop.isNewChanged;return Boolean(a===J.default.CONTROLS.CROP&&b)},b.prototype._isClipChanged=function(){var a=this.currentControl,b=!(!this._editor||!this._editor.clip)&&this._editor.clip.isChange;return Boolean(a===J.default.CONTROLS.CLIP&&b)},b.prototype._isClipNewChanged=function(){var a=this.currentControl,b=!(!this._editor||!this._editor.clip)&&this._editor.clip.isChangeAfterStart;return Boolean(a===J.default.CONTROLS.CLIP&&b)},b.prototype._hasSorted=function(){var a=this._options.photos,b=this.getPhotosArray(),c=!1;return b.forEach(function(b,d){b.key!==a[d].key&&(c=!0)}),!!c},b.prototype._hasAnimationGIF=function(a){return a=a||this.getPhotosArray(),a.some(function(a){return Boolean(a.animationGIF)})},b.prototype._hasVr360=function(a){return a=a||this.getPhotosArray(),a.some(function(a){return Boolean(a.vr360)})},b.prototype._hasPanorama=function(a){return a=a||this.getPhotosArray(),a.some(function(a){return Boolean(a.panorama)})},b.prototype._asyncSavePhoto=function(){function a(a){return b.apply(this,arguments)}var b=(0,j.default)(h.default.mark(function c(a){var b,d,e,f;return h.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return b=this.startUploading(a),d=a.getSnapshotByBatchOption(),e=a.getMimeForExport(),a.setModificationBySnapshot(d),this.setHold(),c.next=7,this._asyncGetPhotoImageURL(a);case 7:return f=c.sent,this._editor.save(f,d,null,e),c.abrupt("return",b);case 10:case"end":return c.stop()}},c,this)}));return a}(),b.prototype.selectPhoto=function(a){this.getCurrentPhoto();this.isHolded()||this.isWaitingAsyncResponseEvent()||(this.setHold(),this.changePhoto(a))},b.prototype.beforeChangePhoto=function(){var a=this.getCurrentPhoto();this.emit("beforeChangeCurrentPhoto",{prevPhoto:a})},b.prototype.getMimeForThumbnail=function(){var a=this.getCurrentPhoto(),b="image/"+a.getImageType();return this._editor.clip&&this._editor.clip.modified?"image/png":b},b.prototype.getThumbnailDataURL=function(a,b){var c=this.getMimeForThumbnail();return this._editor.toDataURL(a,b,c)},b.prototype.changePhoto=function(){function a(a){return b.apply(this,arguments)}var b=(0,j.default)(h.default.mark(function c(a){var b,d,e=this;return h.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(b=this.getCurrentPhoto(),(d=this.getPhotoByKey(a))&&d.isReady){c.next=4;break}return c.abrupt("return");case 4:this.hasPhoto(b)&&(this.saveCurrentPhotoSnapshot(),this.beforeChangePhoto(),this._state.prevPhoto=b),setTimeout(function(){e.changeCurrentPhoto(d)},10);case 6:case"end":return c.stop()}},c,this)}));return a}(),b.prototype.isCropEditable=function(){return this._editor.crop.isEditable},b.prototype.isCropMinimum=function(){return this._editor.crop.isMinimum},b.prototype.checkCropEditable=function(){var a=this.isCropEditable();a||this.showTooltipOnce("crop",F.default.getMessage("txt_notice_crop_minimum")),this.emit("checkCropEditable",a)},b.prototype.checkCropMinimum=function(){this.emit("checkCropMinimum",this.isCropMinimum())},b.prototype.checkCropModified=function(){this._editor.crop&&this.emit("checkCropModified",this._editor.crop.isChanged)},b.prototype.checkCropRotation=function(){this._editor.crop&&this.emit("checkCropRotation",this._editor.crop.rotation)},b.prototype.checkAdjustModified=function(){this._editor.adjust&&this.emit("checkAdjustModified",this._editor.adjust.modified)},b.prototype.isBitmapModified=function(){var a=!1;return this._editor.filter&&this._editor.filter.modified&&(a=!0),this._editor.adjust&&this._editor.adjust.modified&&(a=!0),this._editor.mosaic&&this._editor.mosaic.modified&&(a=!0),a},b.prototype.checkModified=function(){var a=this.modified,b=this.getCurrentPhoto();this._state.canvasReady&&!this.isUploading()&&(b.modified=a),this.emit("checkModified",a)},b.prototype.getPhotoByKey=function(a){var b=this._state.photos.filter(function(b){return b.key===a});return b?b[0]:null},b.prototype.getCurrentPhoto=function(){return this._state.currentPhoto},b.prototype.hasPhoto=function(a){return-1!==this._state.photos.indexOf(a)},b.prototype.hasPhotoKey=function(a){var b=!1;return this._state.photos.forEach(function(c){c.key===a&&(b=!0)}),b},b.prototype.cancelEditing=function(){function a(){return b.apply(this,arguments)}var b=(0,j.default)(h.default.mark(function c(){var a,b;return h.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(!(this.modified||this._hasChanged()||this._isCropChanged()||this._isClipChanged())){c.next=6;break}return a=F.default.getMessage("txt_confirm_close_tit"),b=F.default.getMessage("txt_confirm_close_desc"),c.next=4,this._asyncConfirm(a,b);case 4:if(c.sent){c.next=6;break}return c.abrupt("return");case 6:this.close();case 7:case"end":return c.stop()}},c,this)}));return a}(),b.prototype.getPhotosArray=function(){return this._state.photos.sort(function(a,b){return Number(a.index)-Number(b.index)})},b.prototype.getPhotosArrayToJSON=function(){var a=this.getPhotosArray(),b=[];return a.forEach(function(a){b.push(a.toJSON())}),b},b.prototype.finishEditing=function(){var a=this;this.isHolded()||this._asyncConfirmCropSave("txt_confirm_save_crop_tit",!0).then(function(){return a._asyncConfirmClipSave("txt_confirm_save_clip_tit",!0)}).then((0,j.default)(h.default.mark(function b(){return h.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return a.setEditorPhase(),b.next=3,a._validationGrafolioStickers(!0);case 3:if(b.sent){b.next=5;break}return b.abrupt("return");case 5:if(!a.isLocal){b.next=8;break}return a._saveAndDone(),b.abrupt("return");case 8:a._photoinfraRequest.getSessionKey(function(){a._saveAndDone()},function(){a.uploadFailed({})});case 9:case"end":return b.stop()}},b,a)})))},b.prototype._asyncUploadCurrentSignatureText=function(){function a(){return b.apply(this,arguments)}var b=(0,j.default)(h.default.mark(function c(){var a,b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"text";return h.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(!(a=this._editor.signToDataURL())){c.next=5;break}return c.next=4,this._photoinfraRequest.uploadSignatureImage(a,"image/png",b);case 4:return c.abrupt("return",c.sent);case 5:case"end":return c.stop()}},c,this)}));return a}(),b.prototype._saveCropForced=function(a){this._editor.crop.crop(),this._state.selectedCropType=this._getCurrentCropTypeFromSnapshot(this._editor.snapshot()),a&&this.setEditorPhase("main"),this.checkModified()},b.prototype._saveClipForced=function(a){this._editor.clip.mask(),a&&this.setEditorPhase("main"),this.checkModified()},b.prototype._saveAndDone=function(){function a(){return b.apply(this,arguments)}var b=(0,j.default)(h.default.mark(function c(){return h.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(this.setHold(),!this.modified&&!this._hasChanged()){a.next=8;break}if(this.saveCurrentPhotoSnapshot(),!this.modified){a.next=6;break}return a.next=6,this.saveCurrentPhoto();case 6:return a.next=8,this.savePhotos();case 8:this._doneAndClose();case 9:case"end":return a.stop()}},c,this)}));return a}(),b.prototype._doneAndClose=function(){var a=this.getPhotosArrayToJSON();this.finishUpload(),this._hasChangedOrSorted()&&B.default.isFunction(this._options.done)&&(void 0,this._options.done(a)),this.close()},b.prototype.initControlValues=function(a){this.emit("changeFilter",a.filter),this.emit("changeFrame",a.frame),this.emit("changeCrop",a.crop),this.emit("changeResize",a.resize),this.emit("changeClip",a.clip),this.emit("initControlValues",a)},b.prototype.resetControls=function(){var a=arguments.length>0&&void 0!==arguments[0]&&arguments[0],b=this.getCurrentPhoto(),c=a&&b?b.getSnapshotFromBatchOption():null,d=this.getInitValues(c);
b.resetBatchOption("resize"),b.resetBatchOption("signature"),b.resetBatchOption("filter"),b.resetBatchOption("rotate"),b.resetBatchOption("frame"),this.initControlValues(d),this.options.functions.useMosaic&&this.setEditorMosaic(J.default.CONTROL.MOSAIC.SQUARE1),this.changeAdjust(J.default.CONTROL.ADJUST.BRIGHTNESS),this.resizeViewport(),this.checkCropModified(),this.checkAdjustModified(),this.checkModified()},b.prototype.restoreEditor=function(){this._editor.reset(null,!0),this.resetControls(),this.changeControl(),this.resizeViewport(!0)},b.prototype.setEditorScale=function(a){this._editor.magnify.scale=Number(a),this.checkModified()},b.prototype.setEditorToScale=function(a){this._editor.magnify.scaleTo(Number(a)),this.checkModified()},b.prototype.setEditorFrame=function(a){this.getCurrentPhoto().resetBatchOption("frame"),this._editor.photoFrame.addFrame(a),this.emit("changeFrame",a),this.checkModified()},b.prototype.setEditorFilter=function(a){this.getCurrentPhoto().resetBatchOption("filter"),this._editor.filter.index=a,this.emit("changeFilter",{index:this.getEditorFilterIndex(),value:this.getEditorFilterValue()}),this.showCompareTooltipOnce("filter",F.default.getMessage("txt_notice_compare")),this.checkModified()},b.prototype.getEditorFilterIndex=function(){return this._editor.filter.index},b.prototype.getEditorFilterValue=function(){return this._editor.filter.value},b.prototype.setEditorFilterValue=function(a){this._editor.filter.value=a},b.prototype.setEditorCrop=function(a){var b=this,c=this.getCurrentPhoto(),d=void 0,e=void 0;if(a===J.default.CONTROL.CROP.ORIGINAL)this._editor.crop.isHorizontalImage?(d=Math.max(c.width,c.height),e=Math.min(c.width,c.height)):(d=Math.min(c.width,c.height),e=Math.max(c.width,c.height));else if(a===J.default.CONTROL.CROP.FREE)d=0,e=0;else{var f=a.split(":");d=Number(f[0]),e=Number(f[1])}this._editor.crop.changeAspectRatio(d,e),this.emit("changeCrop",a),setTimeout(function(){b.checkCropModified(),b.checkModified()},10)},b.prototype.setEditorRotate=function(){this._editor.crop.rotate(Boolean(z.default.rotateClockwise))},b.prototype.setEditorAutoRotate=function(){var a=this._editor.crop.autoRotate();return this.checkCropModified(),a},b.prototype.setEditorCropConfirm=function(a){this._state.selectedCropType=a,this._editor.crop.crop(),this.changeControl(),this.resizeViewport(!0),this.checkModified()},b.prototype.setEditorResize=function(a){var b=this.getCurrentPhoto();if(!this.isWaitingAsyncResponseEvent()){if(a!==this._editor.resizedWidth){if(this.waitAsyncResponseEvent("bitmapDataUpdate"))return;a===J.default.CONTROL.RESIZE.ORIGINAL&&a!==this._editor.resize.entrySize&&(a=b.cropWidth||b.width),a||(a=J.default.CONTROL.RESIZE.ORIGINAL),b.resetBatchOption("resize"),a===J.default.CONTROL.RESIZE.ORIGINAL?this._editor.resize.scaleTo(0):this._editor.resize.scaleTo(Number(a))}this.emit("changeResize",a)}},b.prototype.setEditorCropReset=function(){var a=J.default.CONTROL.CROP.FREE;this._state.selectedCropType=a,this._editor.crop.reset(null,!0),this.emit("changeCrop",a),this.checkCropModified(),this.checkModified()},b.prototype.setEditorPreview=function(a){this._editor.showPreview=a,this.checkModified()},b.prototype.setEditorAdjust=function(a,b){this._editor.adjust[a]=Number(b),this._editor.showPreview||this.checkModified(),this.showCompareTooltipOnce("adjust",F.default.getMessage("txt_notice_compare"))},b.prototype.setEditorAdjustReset=function(){this._editor.adjust.reset(null,!0),this.checkAdjustModified(),this.checkModified()},b.prototype.setEditorAutoAdjust=function(a){this._editor.adjust.autolevel=a,this.emit("changeAutoAdjust",a),this.checkAdjustModified(),this.checkModified(),this.showCompareTooltipOnce("adjust",F.default.getMessage("txt_notice_compare"))},b.prototype.setEditorMosaic=function(a){void 0!==this._editor.mosaic[a]&&this._editor.mosaic[a](),this.emit("changeMosaic",a),this.checkModified()},b.prototype.setEditorMosaicReset=function(){this._editor.mosaic.reset(null,!0),this.checkModified()},b.prototype.setEditorSignatureReset=function(a){a&&this._storage.setItem(J.default.COOKIES.SIGNATURE_TYPE_LASTEST,J.default.CONTROL.SIGNATURE.NONE),this._editor.signature.reset()},b.prototype.setEditorSignatureImage=function(a){this._storage.setItem(J.default.COOKIES.SIGNATURE_TYPE_LASTEST,J.default.CONTROL.SIGNATURE.IMAGE),this._editor.signature.setImageSignature(a)},b.prototype.setEditorSignatureText=function(a){this._storage.setItem(J.default.COOKIES.SIGNATURE_TYPE_LASTEST,J.default.CONTROL.SIGNATURE.TEXT),this._editor.signature.setTextSignature(a)},b.prototype.setEditorFitToViewport=function(a){this._editor.screenFitEnable=a,this.checkFitToViewport(),this.resizeViewport(!0),this.currentControl!==J.default.CONTROLS.MOSAIC||a||this.showTooltipOnce("mosaic",F.default.getMessage("txt_notice_mosaic_drag"),1e4)},b.prototype.checkFitToViewport=function(){this.emit("checkFitToViewport",{fitToScreenAvailable:this._editor.fitToScreenAvailable,screenFitEnable:this._editor.screenFitEnable})},b.prototype.checkMosaicUndoRemain=function(){var a=this._editor.mosaic.getFilterCount();this.emit("changeUndoHistory",a)},b.prototype.setEditorSticker=function(){function a(a,c){return b.apply(this,arguments)}var b=(0,j.default)(h.default.mark(function c(a,b){var d;return h.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(10!==(d=B.default.getIEVersion())){c.next=5;break}return c.next=4,B.default.urlToBlob(a);case 4:a=c.sent;case 5:this._editor.sticker.createPNGSticker(a,b),this.checkModified();case 7:case"end":return c.stop()}},c,this)}));return a}(),b.prototype.setEditorDeleteSticker=function(){this._editor.sticker.delete(),this.checkModified()},b.prototype.setEditorAddText=function(a){this._editor.text.setText(a),this.checkModified()},b.prototype.setEditorUpdateText=function(a,b){this._editor.text.updateText(a,b),this.checkModified()},b.prototype.setEditorDeleteText=function(){this._editor.text.delete(),this.checkModified()},b.prototype.setEditorClip=function(a,b,c,d){var e=this,f=this.getCurrentPhoto(),g=this._editor;g.clip.index!==a&&(f.resetBatchOption("clip"),g.clip.index=a),g.clip.lineWidth=b,g.clip.opacity=c,g.clip.color=d,this._emitClipState(),setTimeout(function(){e.checkModified()},10)},b.prototype._emitClipState=function(){var a=this._editor,b=a.clip.color;b.indexOf("rgb")>-1&&(b=B.default.rgbToHex(b)),this.emit("changeClip",{index:a.clip.index,lineWidth:a.clip.lineWidth,opacity:a.clip.opacity,color:b})},b.prototype.setEditorClipDimmed=function(a){var b=this._options.clip.dimmedOpacity;this._editor.clip.dimmedOpacity=a?b+.05:b},b.prototype.setEditorClipConfirm=function(){this.currentControl===J.default.CONTROLS.CLIP&&(this._editor.clip.mask(),this.changeControl(),this.resizeViewport(!0),this.checkModified())},b.prototype.resizeViewport=function(){var a=arguments.length>0&&void 0!==arguments[0]&&arguments[0],b=this._editor,c=void 0,d=void 0;b&&(c=this._getViewportCalculcated(),a?b.viewportTo(c.left,c.top,c.width,c.height):(d=b.viewport,d.x=c.left,d.y=c.top,d.width=c.width,d.height=c.height,b.viewport=d,this.checkFitToViewport()))},b.prototype._getViewportCalculcated=function(){var a=this.currentControl,b=(0,W.default)(this._canvas),c=(0,W.default)(L.default.CONTROL_WRAP),d=(0,W.default)(L.default.CONTROL_DETAIL_WRAP),e=(0,W.default)(L.default.LIST.LIST_WRAP),f=b.parent(),g=Number(f.width()),h=Number(f.height()),i=c.is(":visible")?Number(c.outerWidth()):0,j=a?Number(d.height()+e.outerHeight()):Number(e.outerHeight()),k=0,l=0,m=0,n=j,o=void 0,p=void 0,q=void 0;return a===J.default.CONTROLS.CROP?(k=150,l=80,m=150,n=j+30):a===J.default.CONTROLS.CLIP&&(l=10,n=j+10),c.is(":visible")&&("left"===this.options.sideMenuPosition?k+=i:m+=i),o=g-(k+m),p=h-(l+n),q=this._state.viewport={left:k,top:l,right:m,bottom:n,width:o,height:p},this.emit("changeViewport",q),q},b.prototype._onResizeWindow=function(a){this.resizeCanvas(),this.resizeViewport()},b.prototype.resizeCanvas=function(){var a=(0,W.default)(this._canvas),b=a.parent(),c=b.width(),d=b.height();a.attr({width:c,height:d}),this._editor&&this._editor.changeStageSize(c,d)},b.prototype._getBatchApplyMessage=function(a,b,c){var d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"common",e="",f=[];return this._hasAnimationGIF(b)&&f.push(F.default.getMessage("txt_animation_gif")),this._hasVr360(b)&&f.push(F.default.getMessage("txt_vr360")),this._hasPanorama(b)&&f.push(F.default.getMessage("txt_panorama")),e+=c?F.default.getMessage("txt_all"):F.default.getMessage("txt_selected"),e+=a,"resize"===d?f.length?e+=F.default.getMessage("txt_notice_resize_apply_exception_by_type").replace("%s",f.join(", ")):e+=F.default.getMessage("txt_notice_resize_apply_exception"):f.length&&(e+=F.default.getMessage("txt_notice_apply_exception_by_type").replace("%s",f.join(", "))),e},b.prototype.setBatchResizeApply=function(){function a(a,c){return b.apply(this,arguments)}var b=(0,j.default)(h.default.mark(function c(a,b){var d,e,f,g,i;return h.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(d="",e=this.getPhotosArray(),f=!b||e.length===b.length,b=b||e,b.length){c.next=6;break}return c.abrupt("return");case 6:if(b.forEach(function(b){b.isEditable&&b.setBatchOption("resize",a||null)}),this.emit("changeBatchResize",a),a&&a!==J.default.CONTROL.RESIZE.ORIGINAL){c.next=11;break}return this.hideToastMessage(),c.abrupt("return");case 11:return this.setHold(),c.next=14,this.setBatchApplyToThumbnail(b.filter(function(a){return a.hasSnapshotAppliedSignatureOrFrame()}));case 14:g=c.sent,this.unsetHold(),g&&!this.isUploading()&&(i=F.default.getMessage("txt_notice_resize_apply").replace("%s",a),d=this._getBatchApplyMessage(i,b,f,"resize"),this.showToastMessage(d));case 17:case"end":return c.stop()}},c,this)}));return a}(),b.prototype.setBatchFilterApply=function(){function a(a){return b.apply(this,arguments)}var b=(0,j.default)(h.default.mark(function c(a){var b,d,e,f,g;return h.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return b=this._editor.snapshot().filter,d="",e="",f=void 0,a=a||this.getPhotosArray(),a.forEach(function(a){a.isEditable&&a.setBatchOption("filter",W.default.extend(!0,{},b))}),f=a.length===this._state.photos.length,e=-1===b.index?F.default.getMessage("txt_notice_filter_apply_none"):F.default.getMessage("txt_notice_filter_apply"),d=this._getBatchApplyMessage(e,a,f),this.setHold(),c.next=12,this.setBatchApplyToThumbnail(a);case 12:g=c.sent,this.unsetHold(),g&&this.showToastMessage(d);case 15:case"end":return c.stop()}},c,this)}));return a}(),b.prototype.setBatchSignatureApply=function(){function a(a,c){return b.apply(this,arguments)}var b=(0,j.default)(h.default.mark(function c(a,b){var d,e,f,g,i,j;return h.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return d=this._editor.snapshot().signature,e={type:a,snapshot:d},f="",g="",i=void 0,b=b||this.getPhotosArray(),b.forEach(function(a){a.isEditable&&a.setBatchOption("signature",W.default.extend(!0,{},e))}),i=b.length===this._state.photos.length,g=a===J.default.CONTROL.SIGNATURE.IMAGE?F.default.getMessage("txt_notice_signature_apply_image"):a===J.default.CONTROL.SIGNATURE.TEXT?F.default.getMessage("txt_notice_signature_apply_text"):F.default.getMessage("txt_notice_signature_apply_none"),f=this._getBatchApplyMessage(g,b,i),this.setHold(),c.next=13,this.setBatchApplyToThumbnail(b);case 13:j=c.sent,this.unsetHold(),j&&this.showToastMessage(f);case 16:case"end":return c.stop()}},c,this)}));return a}(),b.prototype.setBatchFrameApply=function(){function a(a){return b.apply(this,arguments)}var b=(0,j.default)(h.default.mark(function c(a){var b,d,e,f,g,i;return h.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return b=this._editor.snapshot().photoFrame,d=b&&b.index?b.index:0,e="",f="",g=void 0,a=a||this.getPhotosArray(),a.forEach(function(a){a.isEditable&&a.setBatchOption("frame",d)}),g=a.length===this._state.photos.length,f=0===d?F.default.getMessage("txt_notice_frame_apply_none"):F.default.getMessage("txt_notice_frame_apply"),e=this._getBatchApplyMessage(f,a,g),this.setHold(),c.next=13,this.setBatchApplyToThumbnail(a);case 13:i=c.sent,this.unsetHold(),i&&this.showToastMessage(e);case 16:case"end":return c.stop()}},c,this)}));return a}(),b.prototype.drawFilterThumbnails=function(a){var b=this;if(!this._editor._filter.complete||this.isHolded())return void setTimeout(function(){b.drawFilterThumbnails(a)},200);this._editor.drawFilterThumbnails(a)},b.prototype.showToastMessage=function(a){var b=this;this.hideToastMessage(),this.toastMessageDelay=setTimeout(function(){a&&b.emit("showToastMessage",{message:a})},320)},b.prototype.hideToastMessage=function(){this.toastMessageDelay&&clearTimeout(this.toastMessageDelay),this.emit("hideToastMessage")},b.prototype.showCompareTooltip=function(a){this.hideCompareTooltip(),this.emit("showCompareTooltip",{message:a})},b.prototype.hideCompareTooltip=function(){this.emit("hideToastMessage")},b.prototype.showTooltipOnce=function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5e3;this._state.onceTooltip[a]||(this._state.onceTooltip[a]=!0,this.showToastMessage(b,c))},b.prototype.showCompareTooltipOnce=function(a,b){this._state.onceTooltip[a]||(this._state.onceTooltip[a]=!0,this.showCompareTooltip(b))},b.prototype.changeAdjust=function(a){this.emit("changeAdjust",a)},b.prototype.changeSignature=function(a){var b=this.getCurrentPhoto();a&&a===J.default.CONTROL.SIGNATURE.NONE&&this.setEditorSignatureReset(!0),a||this.setEditorSignatureReset(),b.setBatchOption("signature",null),this.emit("changeSignature",a)},b.prototype.asyncMultiSelectPhotos=function(){return this._deferMultiSelectPhotos=W.default.Deferred(),this.changeListMode(J.default.LIST_MODE.SELECT),this._deferMultiSelectPhotos},b.prototype.changeListMode=function(a){this.emit("changeListMode",a)},b.prototype.callbackMultiSelectPhotos=function(a){this._deferMultiSelectPhotos&&a&&(this._deferMultiSelectPhotos.resolve(a),this._deferMultiSelectPhotos=null)},b.prototype.getCurrentPhotoSnapshotData=function(){var a=this.getMimeForThumbnail(),b=this.getCurrentPhoto(),c=this._editor.resizedWidth||b.cropWidth||b.width,d=this._editor.resizedHeight||b.cropHeight||b.height,e=B.default.getLimitedSize(c,d);return c=e[0],d=e[1],{mime:a,dataURL:this._editor.toDataURL(c,d,a),fileName:b.originalFileName||b.uploadFileName}},b.prototype.asyncGetCurrentPhotoSnapshotData=function(){function a(){return b.apply(this,arguments)}var b=(0,j.default)(h.default.mark(function c(){var a,b;return h.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return a=this.getCurrentPhoto(),b=this.getCurrentPhotoSnapshotData(),c.next=4,this._photoinfraRequest.uploadSnapshot(a,b.dataURL);case 4:return c.abrupt("return",c.sent);case 5:case"end":return c.stop()}},c,this)}));return a}(),b.prototype.downloadCurrentPhoto=function(){function a(){return b.apply(this,arguments)}var b=(0,j.default)(h.default.mark(function c(){var a;return h.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,this._validationGrafolioStickers(!0);case 2:if(b.sent){b.next=4;break}return b.abrupt("return");case 4:a=this.getCurrentPhotoSnapshotData(),(0,Y.default)(a.dataURL,a.fileName,a.mime);case 6:case"end":return b.stop()}},c,this)}));return a}(),b.prototype._getAttachedGrafolioStickerCodesFromSnapshots=function(a){var b=[];return a.forEach(function(a){a&&a.sticker&&a.sticker.length&&a.sticker.forEach(function(a){a.stickerID&&a.stickerID.length&&b.push(a.stickerID)})}),b},b.prototype._validationGrafolioStickers=function(){function a(){return b.apply(this,arguments)}var b=(0,j.default)(h.default.mark(function c(){var a,b,d,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return h.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(a=this._getAllPhotosSnapshots(e),b=this._getAttachedGrafolioStickerCodesFromSnapshots(a),d=!1,b.length){c.next=6;break}return d=!0,c.abrupt("return",d);case 6:return c.next=8,this._grafolio.multipleValidation(b);case 8:return d=c.sent,d||this.alert(F.default.getMessage("txt_notice_sticker_permission")),c.abrupt("return",d);case 11:case"end":return c.stop()}},c,this)}));return a}(),b.prototype.setEditorFlipX=function(){this._editor.crop.flipX(),this.checkCropModified()},b.prototype.setEditorFlipY=function(){this._editor.crop.flipY(),this.checkCropModified()},b.prototype.getDataURLAppiedSnapshot=function(){function a(a){return b.apply(this,arguments)}var b=(0,j.default)(h.default.mark(function c(a){var b,d,e,f;return h.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(b=B.default.getIEVersion(),d=this._options.useSingleImageFitScreen?a.domain+a.path:a.thumbnail,e=d,!a.thumbnailCropped){c.next=7;break}e=a.thumbnailCropped,c.next=24;break;case 7:if(!this._options.cors||!/^http/.test(d)){c.next=24;break}if(f="."+this._options.setting.serviceName+".editor",d=d.replace(/([^?]+)/,"$1"+f),this._options.usePhotoinfraThumbnailType&&Math.max(a.width,a.height)>z.default.thumbnailTypeSize&&(d=d.split("?")[0],d+=z.default.thumbnailTypeQueryString),10!==b){c.next=17;break}return c.next=14,B.default.urlToBlob(d);case 14:e=c.sent,c.next=24;break;case 17:if(!B.default.isSafari()){c.next=23;break}return c.next=20,B.default.urlToBase64(d);case 20:e=c.sent,c.next=24;break;case 23:e=d;case 24:return c.abrupt("return",this._editor.applySnapshotTo(e,a.getSnapshotByBatchOption(),{width:a.width,height:a.height},null,a.getMimeForExport()));case 25:case"end":return c.stop()}},c,this)}));return a}(),b.prototype.setBatchApplyToThumbnail=function(){function a(a){return b.apply(this,arguments)}var b=(0,j.default)(h.default.mark(function c(a){var b,d,e,f;return h.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:a=a||this.getPhotosArray(),b=a.length,d=void 0,c.prev=3,d=0;case 5:if(!(d<b)){c.next=15;break}if(e=a[d],!e.isEditable){c.next=12;break}return c.next=10,this.getDataURLAppiedSnapshot(e);case 10:f=c.sent,e.thumbnailSrc=f||e.thumbnailSrc;case 12:d++,c.next=5;break;case 15:c.next=21;break;case 17:return c.prev=17,c.t0=c.catch(3),B.default.debug(c.t0),c.abrupt("return",!1);case 21:return this.emit("setBatchApplyToThumbnail"),c.abrupt("return",!0);case 23:case"end":return c.stop()}},c,this,[[3,17]])}));return a}(),b.prototype.pushHistory=function(){this._editor.pushHistory()},b.prototype.undo=function(){this._editor.undo();var a=this._editor.snapshot(),b=this.getInitValues(a);this.initControlValues(b)},b.prototype.redo=function(){this._editor.redo();var a=this._editor.snapshot(),b=this.getInitValues(a);this.initControlValues(b)},b.prototype.setEditorShowOriginal=function(a){this._editor.showOriginal=a},b.prototype._getAllPhotosSnapshots=function(a){var b=[],c=this.getCurrentPhoto(),d=this.getPhotosArray();return a&&b.push(this._editor.snapshot()),d.forEach(function(d){a&&d.key===c.key||b.push(d.snapshot)}),b},(0,n.default)(b,[{key:"photos",get:function(){return this._state.photos}},{key:"opened",get:function(){return this._state.opened}},{key:"currentControl",get:function(){return this._state.selectedControl}},{key:"options",get:function(){return this._options}},{key:"viewport",get:function(){return this._editor.viewport}},{key:"modified",get:function(){return!(!this._state.canvasReady||!this._editor.modified)}},{key:"isLocal",get:function(){return"local"===this._options.setting.env}},{key:"isDev",get:function(){return"dev"===this._options.setting.env}},{key:"isReal",get:function(){return"real"===this._options.setting.env}}]),b}(t.default);b.default=Z},function(a,b,c){c(82),c(87),a.exports=c(113).f("iterator")},function(a,b,c){var d=c(105),e=c(106);a.exports=function(a){return function(b,c){var f,g,h=String(e(b)),i=d(c),j=h.length;return i<0||i>=j?a?"":void 0:(f=h.charCodeAt(i),f<55296||f>56319||i+1===j||(g=h.charCodeAt(i+1))<56320||g>57343?a?h.charAt(i):f:a?h.slice(i,i+2):g-56320+(f-55296<<10)+65536)}}},function(a,b,c){"use strict";var d=c(84),e=c(81),f=c(70),g={};c(43)(g,c(19)("iterator"),function(){return this}),a.exports=function(a,b,c){a.prototype=d(g,{next:e(1,c)}),f(a,b+" Iterator")}},function(a,b,c){var d=c(59),e=c(109),f=c(223);a.exports=function(a){return function(b,c,g){var h,i=d(b),j=e(i.length),k=f(g,j);if(a&&c!=c){for(;j>k;)if((h=i[k++])!=h)return!0}else for(;j>k;k++)if((a||k in i)&&i[k]===c)return a||k||0;return!a&&-1}}},function(a,b,c){var d=c(105),e=Math.max,f=Math.min;a.exports=function(a,b){return a=d(a),a<0?e(a+b,0):f(a,b)}},function(a,b,c){var d=c(51),e=c(86),f=c(110)("IE_PROTO"),g=Object.prototype;a.exports=Object.getPrototypeOf||function(a){return a=e(a),d(a,f)?a[f]:"function"==typeof a.constructor&&a instanceof a.constructor?a.constructor.prototype:a instanceof Object?g:null}},function(a,b,c){"use strict";var d=c(226),e=c(152),f=c(67),g=c(59);a.exports=c(107)(Array,"Array",function(a,b){this._t=g(a),this._i=0,this._k=b},function(){var a=this._t,b=this._k,c=this._i++;return!a||c>=a.length?(this._t=void 0,e(1)):"keys"==b?e(0,c):"values"==b?e(0,a[c]):e(0,[c,a[c]])},"values"),f.Arguments=f.Array,d("keys"),d("values"),d("entries")},function(a,b){a.exports=function(){}},function(a,b,c){c(153),c(117),c(229),c(230),a.exports=c(9).Symbol},function(a,b,c){var d=c(68),e=c(116),f=c(89);a.exports=function(a){var b=d(a),c=e.f;if(c)for(var g,h=c(a),i=f.f,j=0;h.length>j;)i.call(a,g=h[j++])&&b.push(g);return b}},function(a,b,c){c(115)("asyncIterator")},function(a,b,c){c(115)("observable")},function(a,b,c){var d=function(){return this}()||Function("return this")(),e=d.regeneratorRuntime&&Object.getOwnPropertyNames(d).indexOf("regeneratorRuntime")>=0,f=e&&d.regeneratorRuntime;if(d.regeneratorRuntime=void 0,a.exports=c(232),e)d.regeneratorRuntime=f;else try{delete d.regeneratorRuntime}catch(g){d.regeneratorRuntime=void 0}},function(a,b){!function(b){"use strict";function c(a,b,c,d){var f=b&&b.prototype instanceof e?b:e,g=Object.create(f.prototype),h=new n(d||[]);return g._invoke=j(a,c,h),g}function d(a,b,c){try{return{type:"normal",arg:a.call(b,c)}}catch(d){return{type:"throw",arg:d}}}function e(){}function f(){}function g(){}function h(a){["next","throw","return"].forEach(function(b){a[b]=function(a){return this._invoke(b,a)}})}function i(a){function b(c,e,f,g){var h=d(a[c],a,e);if("throw"!==h.type){var i=h.arg,j=i.value;return j&&"object"==typeof j&&s.call(j,"__await")?Promise.resolve(j.__await).then(function(a){b("next",a,f,g)},function(a){b("throw",a,f,g)}):Promise.resolve(j).then(function(a){i.value=a,f(i)},g)}g(h.arg)}function c(a,c){function d(){return new Promise(function(d,e){b(a,c,d,e)})}return e=e?e.then(d,d):d()}var e;this._invoke=c}function j(a,b,c){var e=z;return function(f,g){if(e===B)throw new Error("Generator is already running");if(e===C){if("throw"===f)throw g;return p()}for(c.method=f,c.arg=g;;){var h=c.delegate;if(h){var i=k(h,c);if(i){if(i===D)continue;return i}}if("next"===c.method)c.sent=c._sent=c.arg;else if("throw"===c.method){if(e===z)throw e=C,c.arg;c.dispatchException(c.arg)}else"return"===c.method&&c.abrupt("return",c.arg);e=B;var j=d(a,b,c);if("normal"===j.type){if(e=c.done?C:A,j.arg===D)continue;return{value:j.arg,done:c.done}}"throw"===j.type&&(e=C,c.method="throw",c.arg=j.arg)}}}function k(a,b){var c=a.iterator[b.method];if(c===q){if(b.delegate=null,"throw"===b.method){if(a.iterator.return&&(b.method="return",b.arg=q,k(a,b),"throw"===b.method))return D;b.method="throw",b.arg=new TypeError("The iterator does not provide a 'throw' method")}return D}var e=d(c,a.iterator,b.arg);if("throw"===e.type)return b.method="throw",b.arg=e.arg,b.delegate=null,D;var f=e.arg;return f?f.done?(b[a.resultName]=f.value,b.next=a.nextLoc,"return"!==b.method&&(b.method="next",b.arg=q),b.delegate=null,D):f:(b.method="throw",b.arg=new TypeError("iterator result is not an object"),b.delegate=null,D)}function l(a){var b={tryLoc:a[0]};1 in a&&(b.catchLoc=a[1]),2 in a&&(b.finallyLoc=a[2],b.afterLoc=a[3]),this.tryEntries.push(b)}function m(a){var b=a.completion||{};b.type="normal",delete b.arg,a.completion=b}function n(a){this.tryEntries=[{tryLoc:"root"}],a.forEach(l,this),this.reset(!0)}function o(a){if(a){var b=a[u];if(b)return b.call(a);if("function"==typeof a.next)return a;if(!isNaN(a.length)){var c=-1,d=function e(){for(;++c<a.length;)if(s.call(a,c))return e.value=a[c],e.done=!1,e;return e.value=q,e.done=!0,e};return d.next=d}}return{next:p}}function p(){return{value:q,done:!0}}var q,r=Object.prototype,s=r.hasOwnProperty,t="function"==typeof Symbol?Symbol:{},u=t.iterator||"@@iterator",v=t.asyncIterator||"@@asyncIterator",w=t.toStringTag||"@@toStringTag",x="object"==typeof a,y=b.regeneratorRuntime;if(y)return void(x&&(a.exports=y));y=b.regeneratorRuntime=x?a.exports:{},y.wrap=c;var z="suspendedStart",A="suspendedYield",B="executing",C="completed",D={},E={};E[u]=function(){return this};var F=Object.getPrototypeOf,G=F&&F(F(o([])));G&&G!==r&&s.call(G,u)&&(E=G);var H=g.prototype=e.prototype=Object.create(E);f.prototype=H.constructor=g,g.constructor=f,g[w]=f.displayName="GeneratorFunction",y.isGeneratorFunction=function(a){var b="function"==typeof a&&a.constructor;return!!b&&(b===f||"GeneratorFunction"===(b.displayName||b.name))},y.mark=function(a){return Object.setPrototypeOf?Object.setPrototypeOf(a,g):(a.__proto__=g,w in a||(a[w]="GeneratorFunction")),a.prototype=Object.create(H),a},y.awrap=function(a){return{__await:a}},h(i.prototype),i.prototype[v]=function(){return this},y.AsyncIterator=i,y.async=function(a,b,d,e){var f=new i(c(a,b,d,e));return y.isGeneratorFunction(b)?f:f.next().then(function(a){return a.done?a.value:f.next()})},h(H),H[w]="Generator",H[u]=function(){return this},H.toString=function(){return"[object Generator]"},y.keys=function(a){var b=[];for(var c in a)b.push(c);return b.reverse(),function d(){for(;b.length;){var c=b.pop();if(c in a)return d.value=c,d.done=!1,d}return d.done=!0,d}},y.values=o,n.prototype={constructor:n,reset:function(a){if(this.prev=0,this.next=0,this.sent=this._sent=q,this.done=!1,this.delegate=null,this.method="next",this.arg=q,this.tryEntries.forEach(m),!a)for(var b in this)"t"===b.charAt(0)&&s.call(this,b)&&!isNaN(+b.slice(1))&&(this[b]=q)},stop:function(){this.done=!0;var a=this.tryEntries[0],b=a.completion;if("throw"===b.type)throw b.arg;return this.rval},dispatchException:function(a){function b(b,d){return f.type="throw",f.arg=a,c.next=b,d&&(c.method="next",c.arg=q),!!d}if(this.done)throw a;for(var c=this,d=this.tryEntries.length-1;d>=0;--d){var e=this.tryEntries[d],f=e.completion;if("root"===e.tryLoc)return b("end");if(e.tryLoc<=this.prev){var g=s.call(e,"catchLoc"),h=s.call(e,"finallyLoc");if(g&&h){if(this.prev<e.catchLoc)return b(e.catchLoc,!0);if(this.prev<e.finallyLoc)return b(e.finallyLoc)}else if(g){if(this.prev<e.catchLoc)return b(e.catchLoc,!0)}else{if(!h)throw new Error("try statement without catch or finally");if(this.prev<e.finallyLoc)return b(e.finallyLoc)}}}},abrupt:function(a,b){for(var c=this.tryEntries.length-1;c>=0;--c){var d=this.tryEntries[c];if(d.tryLoc<=this.prev&&s.call(d,"finallyLoc")&&this.prev<d.finallyLoc){var e=d;break}}e&&("break"===a||"continue"===a)&&e.tryLoc<=b&&b<=e.finallyLoc&&(e=null);var f=e?e.completion:{};return f.type=a,f.arg=b,e?(this.method="next",this.next=e.finallyLoc,D):this.complete(f)},complete:function(a,b){if("throw"===a.type)throw a.arg;return"break"===a.type||"continue"===a.type?this.next=a.arg:"return"===a.type?(this.rval=this.arg=a.arg,this.method="return",this.next="end"):"normal"===a.type&&b&&(this.next=b),D},finish:function(a){for(var b=this.tryEntries.length-1;b>=0;--b){var c=this.tryEntries[b];if(c.finallyLoc===a)return this.complete(c.completion,c.afterLoc),m(c),D}},"catch":function(a){for(var b=this.tryEntries.length-1;b>=0;--b){var c=this.tryEntries[b];if(c.tryLoc===a){var d=c.completion;if("throw"===d.type){var e=d.arg;m(c)}return e}}throw new Error("illegal catch attempt")},delegateYield:function(a,b,c){return this.delegate={iterator:o(a),resultName:b,nextLoc:c},"next"===this.method&&(this.arg=q),D}}}(function(){return this}()||Function("return this")())},function(a,b,c){c(117),c(82),c(87),c(234),c(240),c(241),a.exports=c(9).Promise},function(a,b,c){"use strict";var d,e,f,g,h=c(83),i=c(18),j=c(42),k=c(118),l=c(13),m=c(26),n=c(65),o=c(119),p=c(72),q=c(159),r=c(120).set,s=c(238)(),t=c(121),u=c(160),v=c(161),w=i.TypeError,x=i.process,y=i.Promise,z="process"==k(x),A=function(){},B=e=t.f,C=!!function(){try{var a=y.resolve(1),b=(a.constructor={})[c(19)("species")]=function(a){a(A,A)};return(z||"function"==typeof PromiseRejectionEvent)&&a.then(A)instanceof b}catch(d){}}(),D=function(a){var b;return!(!m(a)||"function"!=typeof(b=a.then))&&b},E=function(a,b){if(!a._n){a._n=!0;var c=a._c;s(function(){for(var d=a._v,e=1==a._s,f=0;c.length>f;)!function(b){var c,f,g=e?b.ok:b.fail,h=b.resolve,i=b.reject,j=b.domain;try{g?(e||(2==a._h&&H(a),a._h=1),!0===g?c=d:(j&&j.enter(),c=g(d),j&&j.exit()),c===b.promise?i(w("Promise-chain cycle")):(f=D(c))?f.call(c,h,i):h(c)):i(d)}catch(k){i(k)}}(c[f++]);a._c=[],a._n=!1,b&&!a._h&&F(a)})}},F=function(a){r.call(i,function(){var b,c,d,e=a._v,f=G(a);if(f&&(b=u(function(){z?x.emit("unhandledRejection",e,a):(c=i.onunhandledrejection)?c({promise:a,reason:e}):(d=i.console)&&d.error&&void 0}),a._h=z||G(a)?2:1),a._a=void 0,f&&b.e)throw b.v})},G=function(a){return 1!==a._h&&0===(a._a||a._c).length},H=function(a){r.call(i,function(){var b;z?x.emit("rejectionHandled",a):(b=i.onrejectionhandled)&&b({promise:a,reason:a._v})})},I=function(a){var b=this;b._d||(b._d=!0,b=b._w||b,b._v=a,b._s=2,b._a||(b._a=b._c.slice()),E(b,!0))},J=function(a){var b,c=this;if(!c._d){c._d=!0,c=c._w||c;try{if(c===a)throw w("Promise can't be resolved itself");(b=D(a))?s(function(){var d={_w:c,_d:!1};try{b.call(a,j(J,d,1),j(I,d,1))}catch(e){I.call(d,e)}}):(c._v=a,c._s=1,E(c,!1))}catch(d){I.call({_w:c,_d:!1},d)}}};C||(y=function(a){o(this,y,"Promise","_h"),n(a),d.call(this);try{a(j(J,this,1),j(I,this,1))}catch(b){I.call(this,b)}},d=function(a){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},d.prototype=c(122)(y.prototype,{then:function(a,b){var c=B(q(this,y));return c.ok="function"!=typeof a||a,c.fail="function"==typeof b&&b,c.domain=z?x.domain:void 0,this._c.push(c),this._a&&this._a.push(c),this._s&&E(this,!1),c.promise},"catch":function(a){return this.then(void 0,a)}}),f=function(){var a=new d;this.promise=a,this.resolve=j(J,a,1),this.reject=j(I,a,1)},t.f=B=function(a){return a===y||a===g?new f(a):e(a)}),l(l.G+l.W+l.F*!C,{Promise:y}),c(70)(y,"Promise"),c(162)("Promise"),g=c(9).Promise,l(l.S+l.F*!C,"Promise",{reject:function(a){var b=B(this);return(0,b.reject)(a),b.promise}}),l(l.S+l.F*(h||!C),"Promise",{resolve:function(a){return v(h&&this===g?y:this,a)}}),l(l.S+l.F*!(C&&c(239)(function(a){y.all(a).catch(A)})),"Promise",{all:function(a){var b=this,c=B(b),d=c.resolve,e=c.reject,f=u(function(){var c=[],f=0,g=1;p(a,!1,function(a){var h=f++,i=!1;c.push(void 0),g++,b.resolve(a).then(function(a){i||(i=!0,c[h]=a,--g||d(c))},e)}),--g||d(c)});return f.e&&e(f.v),c.promise},race:function(a){var b=this,c=B(b),d=c.reject,e=u(function(){p(a,!1,function(a){b.resolve(a).then(c.resolve,d)})});return e.e&&d(e.v),c.promise}})},function(a,b,c){var d=c(29);a.exports=function(a,b,c,e){try{return e?b(d(c)[0],c[1]):b(c)}catch(f){var g=a.return;throw void 0!==g&&d(g.call(a)),f}}},function(a,b,c){var d=c(67),e=c(19)("iterator"),f=Array.prototype;a.exports=function(a){return void 0!==a&&(d.Array===a||f[e]===a)}},function(a,b){a.exports=function(a,b,c){var d=void 0===c;switch(b.length){case 0:return d?a():a.call(c);case 1:return d?a(b[0]):a.call(c,b[0]);case 2:return d?a(b[0],b[1]):a.call(c,b[0],b[1]);case 3:return d?a(b[0],b[1],b[2]):a.call(c,b[0],b[1],b[2]);case 4:return d?a(b[0],b[1],b[2],b[3]):a.call(c,b[0],b[1],b[2],b[3])}return a.apply(c,b)}},function(a,b,c){var d=c(18),e=c(120).set,f=d.MutationObserver||d.WebKitMutationObserver,g=d.process,h=d.Promise,i="process"==c(69)(g);a.exports=function(){var a,b,c,j=function(){var d,e;for(i&&(d=g.domain)&&d.exit();a;){e=a.fn,a=a.next;try{e()}catch(f){throw a?c():b=void 0,
f}}b=void 0,d&&d.enter()};if(i)c=function(){g.nextTick(j)};else if(!f||d.navigator&&d.navigator.standalone)if(h&&h.resolve){var k=h.resolve();c=function(){k.then(j)}}else c=function(){e.call(d,j)};else{var l=!0,m=document.createTextNode("");new f(j).observe(m,{characterData:!0}),c=function(){m.data=l=!l}}return function(d){var e={fn:d,next:void 0};b&&(b.next=e),a||(a=e,c()),b=e}}},function(a,b,c){var d=c(19)("iterator"),e=!1;try{var f=[7][d]();f.return=function(){e=!0},Array.from(f,function(){throw 2})}catch(g){}a.exports=function(a,b){if(!b&&!e)return!1;var c=!1;try{var f=[7],g=f[d]();g.next=function(){return{done:c=!0}},f[d]=function(){return g},a(f)}catch(h){}return c}},function(a,b,c){"use strict";var d=c(13),e=c(9),f=c(18),g=c(159),h=c(161);d(d.P+d.R,"Promise",{"finally":function(a){var b=g(this,e.Promise||f.Promise),c="function"==typeof a;return this.then(c?function(c){return h(b,a()).then(function(){return c})}:a,c?function(c){return h(b,a()).then(function(){throw c})}:a)}})},function(a,b,c){"use strict";var d=c(13),e=c(121),f=c(160);d(d.S,"Promise",{"try":function(a){var b=e.f(this),c=f(a);return(c.e?b.reject:b.resolve)(c.v),b.promise}})},function(a,b,c){a.exports={"default":c(243),__esModule:!0}},function(a,b,c){c(244),a.exports=c(9).Object.setPrototypeOf},function(a,b,c){var d=c(13);d(d.S,"Object",{setPrototypeOf:c(245).set})},function(a,b,c){var d=c(26),e=c(29),f=function(a,b){if(e(a),!d(b)&&null!==b)throw TypeError(b+": can't set as prototype!")};a.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(a,b,d){try{d=c(42)(Function.call,c(157).f(Object.prototype,"__proto__").set,2),d(a,[]),b=!(a instanceof Array)}catch(e){b=!0}return function(a,c){return f(a,c),b?a.__proto__=c:d(a,c),a}}({},!1):void 0),check:f}},function(a,b,c){c(247);var d=c(9).Object;a.exports=function(a,b){return d.create(a,b)}},function(a,b,c){var d=c(13);d(d.S,"Object",{create:c(84)})},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(1),h=d(g),i=c(14),j=(d(i),c(7)),k=d(j),l=c(11),m=d(l),n=c(5),o=d(n),p={png:"png",gif:"png",jpg:"jpeg",jpeg:"jpg",bmp:"png"},q={VR360:"vr360",PANORAMA:"panorama",NORMAL:"normal"},r=["vr360","panorama"],s=0,t=function(){function a(b){(0,f.default)(this,a),this.key=b.key||k.default.getUniqueId(),this.index=s++,this.modified=!1,this.modifications=[],this._setData(b)}return a.resetIndex=function(){s=0},a.prototype._setData=function(a){o.default.extend(!0,this,a),this.width=Number(this.width)||0,this.height=Number(this.height)||0,this.fileSize=Number(this.fileSize)||0,this.domain=this.domain||"",this.path=this.path||"",this.pathResized=this.pathResized||"",this.src=this.domain+this.path,this.thumbnail=this.thumbnail||"",this.thumbnailSrc=this.thumbnailSrc||this.thumbnail,this.dominantColor=this.dominantColor||"",this.generationFormat=this.generationFormat||"",this.animationGIF=Boolean(this.animationGIF),this.fileName=this.fileName||"",this.vr360=Boolean(this.generationFormat===q.VR360),this.panorama=Boolean(this.generationFormat===q.PANORAMA),this.isEditable=!this.animationGIF&&-1===r.indexOf(this.generationFormat),this.isReady=Boolean(this.path),this.originalPath=this.originalPath||this.path,this.originalThumbnail=this.originalThumbnail||this.thumbnail,this.batchOptions=a.batchOptions||{},this.snapshot=a.snapshot||null,this.signatureTypeChanged=null},a.prototype.toJSON=function(){return{key:this.key,originalFileName:this.originalFileName||this.fileName,width:this.width,height:this.height,domain:this.domain,path:this.path,fileSize:this.fileSize,animationGIF:this.animationGIF,modified:this.modified,modifications:this.modifications,originalPath:this.originalPath,originalThumbnail:this.originalThumbnail,dominantColor:this.dominantColor,generationFormat:this.generationFormat}},a.prototype.setModificationBySnapshot=function(a){var b=[];for(var c in a)a[c]&&a[c].modified&&b.push(c);this.modifications=b},a.prototype.getCloneData=function(){var a={};for(var b in this)this.hasOwnProperty(b)&&(a[b]=this[b]);return o.default.extend(!0,{},a)},a.prototype.update=function(a){this._setData(a)},a.prototype.getMaximumWidth=function(){var a=this.width,b=this.height;return k.default.getMaximumWidth(a,b)},a.prototype.getMinimumWidth=function(){var a=this.width,b=this.height;return k.default.getMinimumWidth(a,b)},a.prototype.resetBatchOption=function(a){this.batchOptions[a]=null},a.prototype.setBatchOption=function(a,b){if(this.isEditable){if("resize"===a&&b){var c=this.getMaximumWidth(),d=this.getMinimumWidth();b>c&&(b=c),b<d&&(b=d)}"signature"===a&&(this.signatureTypeChanged=!0),b&&(this.modified=!0),this.batchOptions[a]=b}},a.prototype.getBatchOption=function(a){return a?this.batchOptions[a]:this.batchOptions},a.prototype.hasBatchOption=function(){if(o.default.isEmptyObject(this.batchOptions))return!1;var a=!1;for(var b in this.batchOptions)if(this.batchOptions[b]){a=!0;break}return a},a.prototype.setSnapshot=function(a){this.isEditable&&a&&(this.modified=!0),this.snapshot=a||{}},a.prototype.getSnapshotFromBatchOption=function(){return o.default.isEmptyObject(this.snapshot)&&!this.hasBatchOption()?null:(this.snapshot=this.getSnapshotByBatchOption(),this.snapshot)},a.prototype.getSnapshotByBatchOption=function(){var a=o.default.extend(!0,{},this.snapshot);return o.default.isEmptyObject(a)&&!this.hasBatchOption()?null:(o.default.isEmptyObject(a)&&(a={}),this.batchOptions.resize&&(this.batchOptions.resize===m.default.CONTROL.RESIZE.ORIGINAL?a.resize={width:0}:(a.resize={width:this.batchOptions.resize||0},a.resize.modified=!0)),this.batchOptions.signature&&(a.signature=this.batchOptions.signature.snapshot,a.signature.modified=!0),this.batchOptions.filter&&(a.filter=this.batchOptions.filter,a.filter.modified=!0),this.batchOptions.rotate&&(o.default.isEmptyObject(a.crop)&&(a.crop={}),a.crop.externalRotation=this.batchOptions.rotate,a.crop.modified=!0),this.batchOptions.frame&&(a.photoFrame={backup:this.batchOptions.frame,index:this.batchOptions.frame,modified:!0}),a)},a.prototype.getImageType=function(){var a=this.originalFileName||this.fileName,b=void 0;if(/([_\.]PNG|[_\.]GIF)[_\.\/]/i.test(this.path))b="png";else if(/([_\.]JPG|[_\.]JPEG)[_\.\/]/i.test(this.path))b="jpeg";else{var c=k.default.parseFileName(a),d=c.extension;b=p[d.toLowerCase()]||"jpeg"}return b},a.prototype.getMimeForExport=function(){var a="image/"+this.getImageType(),b=this.getSnapshotByBatchOption();return b&&b.clip&&b.clip.modified?"image/png":a},a.prototype.hasSnapshotAppliedSignatureOrFrame=function(){var a=this.getSnapshotByBatchOption();return Boolean(a&&(a.signature&&a.signature.type!==m.default.CONTROL.SIGNATURE.NONE||a.photoFrame&&Number(a.photoFrame.index)>0))},(0,h.default)(a,[{key:"uploadFileName",get:function(){return this.key+".jpg"}}]),a}();b.default=t},function(a,b,c){var d=c(9),e=d.JSON||(d.JSON={stringify:JSON.stringify});a.exports=function(a){return e.stringify.apply(e,arguments)}},function(a,b,c){"use strict";b.__esModule=!0,b.default=function(){function a(a){var g=!1;for(var h in b){d.style.fontFamily=a+","+b[h],c.appendChild(d);var i=d.offsetWidth!==e[b[h]]||d.offsetHeight!==f[b[h]];c.removeChild(d),g=g||i}return g}var b=["monospace","sans-serif","serif"],c=document.getElementsByTagName("body")[0],d=document.createElement("span"),e={},f={};d.style.fontSize="72px",d.innerHTML="mmmmmmmmmmlli";for(var g in b)d.style.fontFamily=b[g],c.appendChild(d),e[b[g]]=d.offsetWidth,f[b[g]]=d.offsetHeight,c.removeChild(d);return{detect:a}}()},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(30),f=d(e),g=c(71),h=d(g),i=c(37),j=d(i),k=c(0),l=d(k),m=c(14),n=d(m),o=c(7),p=d(o),q=c(11),r=(d(q),c(5)),s=d(r),t=location.protocol.toLowerCase()+"//",u="https://"==t,v={MOCKUP:{STICKER_PACK_LIST:"mockup/stickerPackList.json",STICKER_LIST:"mockup/stickerList.json",MULTIPLE_VALIDATION:"mockup/multipleValidation.json"},GRAFOLIO:{STICKER_PACK_LIST:t+"{apidomain}/v1/photoupld/sticker/stickerPackList",STICKER_LIST:t+"{apidomain}/v1/photoupld/sticker/stickerList",MULTIPLE_VALIDATION:t+"{apidomain}/api/sticker/multiple/validation"},API_GATEWAY:{STICKER_PACK_LIST:t+"{apidomain}/naverPhotoeditor/gfmarket/proxyStickerPackList.json?servicecode=photoupld",STICKER_LIST:t+"{apidomain}/naverPhotoeditor/gfmarket/proxyStickerList.json?servicecode=photoupld",MULTIPLE_VALIDATION:t+"{apidomain}/naverPhotoeditor/gfmarket/proxyStickerMultiValidation.json?servicecode=photoupld"}},w=function(a){return-1!==a.indexOf("apis.naver.com")?"API_GATEWAY":"GRAFOLIO"},x=function(){function a(b,c){(0,l.default)(this,a),this._apiDomain=b.grafolioApiDomain||n.default.grafolioApiDomain[b.setting.env],this._baseDomain=u?b.grafolioBaseDomainSSL||n.default.grafolioBaseDomainSSL[b.setting.env]:b.grafolioBaseDomain||n.default.grafolioBaseDomain[b.setting.env],this._defaultAjaxOptions=this._getDefaultAjaxOptions(),this._popupUploaderStickerType=c,this._packs=[],this._stickers={}}return a.prototype._getDefaultAjaxOptions=function(){return{type:"get",dataType:"json",crossDomain:!0,xhrFields:{withCredentials:!0},error:function(){}}},a.prototype._getAPIUrl=function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=w(this._apiDomain),d=v[c][a].replace("{apidomain}",this._apiDomain);for(var e in b)d+=-1===d.indexOf("?")?"?":"&",d+=e+"="+b[e];return d},a.prototype._getAjaxOptions=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,j.default)({},this._defaultAjaxOptions,a)},a.prototype.getStickerPacks=function(){function a(){return b.apply(this,arguments)}var b=(0,h.default)(f.default.mark(function c(){var a,b;return f.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(a=this._getAPIUrl("STICKER_PACK_LIST"),b=this._getAjaxOptions({url:a}),!this._packs||!this._packs.length){c.next=4;break}return c.abrupt("return",this._packs);case 4:return c.next=6,s.default.ajax(b).done(this._onDoneGetStickerPacks.bind(this));case 6:return c.abrupt("return",this._packs);case 7:case"end":return c.stop()}},c,this)}));return a}(),a.prototype._onDoneGetStickerPacks=function(a){var b=this;this._packs=a.list.map(function(c){var d=p.default.addURLProtocol(b._baseDomain);return{type:"grafolio",code:null,packCode:c.packCode,isLine:c.isLine,tabOnImg:d+"/"+c.packCode+"/"+a.info.mobileTabOnName,tabOffImg:d+"/"+c.packCode+"/"+a.info.mobileTabOffName,previewImg:d+"/"+c.packCode+"/"+a.info.mobilePreviewName.replace("p100_100","p60_60")}}),this._packs=this._packs.filter(function(a){return"all"===b._popupUploaderStickerType||"grafolio"===b._popupUploaderStickerType&&!a.isLine})},a.prototype.getStickerPackInfo=function(){function a(a){return b.apply(this,arguments)}var b=(0,h.default)(f.default.mark(function c(a){var b;return f.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this.getStickerPacks();case 2:return c.t0=function(b){return b.packCode===a},b=c.sent.filter(c.t0),c.abrupt("return",b.length?b[0]:null);case 5:case"end":return c.stop()}},c,this)}));return a}(),a.prototype.getStickers=function(){function a(a){return b.apply(this,arguments)}var b=(0,h.default)(f.default.mark(function c(a){var b,d,e;return f.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return b=this._getAPIUrl("STICKER_LIST",{packCode:a}),d=this._getAjaxOptions({url:b}),c.next=4,this.getStickerPackInfo(a);case 4:if(e=c.sent,this._stickers[a]&&this._stickers[a].length){c.next=8;break}return c.next=8,s.default.ajax(d).done(this._onDoneGetStickers.bind(this,a,e));case 8:return c.abrupt("return",this._stickers[a]);case 9:case"end":return c.stop()}},c,this)}));return a}(),a.prototype._onDoneGetStickers=function(){function a(a,c,d){return b.apply(this,arguments)}var b=(0,h.default)(f.default.mark(function c(a,b,d){var e,g=this;return f.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:e=n.default.stickerPreview.grafolio,this._stickers[a]=d.list.map(function(a,c){var d=[c%e.cols*e.width*-1,Math.floor(c/e.cols)*e.height*-1];return a.type="grafolio",a.code=a.stickerCode,a.original=a.extendedUrl||a.originalUrl,a.thumbnail=b.previewImg,a.backgroundPosition=d.map(function(a){return a+"px"}).join(" "),a.original=a.original.replace(/:\/\/[^\/]+/gi,"://"+g._baseDomain),a.original+="?type=p100_100",a.original+="&d="+encodeURIComponent(location.host),a});case 2:case"end":return c.stop()}},c,this)}));return a}(),a.prototype.multipleValidation=function(){function a(){return b.apply(this,arguments)}var b=(0,h.default)(f.default.mark(function c(){var a,b,d,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return f.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return a=this._getAPIUrl("MULTIPLE_VALIDATION",{stickerCode:e.join(",")}),b=this._getAjaxOptions({url:a}),d=!e.length,c.next=5,s.default.ajax(b).done(function(a){"SUCCESS"===a.message.status&&(d=!0)});case 5:return c.abrupt("return",d);case 6:case"end":return c.stop()}},c,this)}));return a}(),a}();b.default=x},function(a,b,c){c(253),a.exports=c(9).Object.assign},function(a,b,c){var d=c(13);d(d.S+d.F,"Object",{assign:c(254)})},function(a,b,c){"use strict";var d=c(68),e=c(116),f=c(89),g=c(86),h=c(108),i=Object.assign;a.exports=!i||c(50)(function(){var a={},b={},c=Symbol(),d="abcdefghijklmnopqrst";return a[c]=7,d.split("").forEach(function(a){b[a]=a}),7!=i({},a)[c]||Object.keys(i({},b)).join("")!=d})?function(a,b){for(var c=g(a),i=arguments.length,j=1,k=e.f,l=f.f;i>j;)for(var m,n=h(arguments[j++]),o=k?d(n).concat(k(n)):d(n),p=o.length,q=0;p>q;)l.call(n,m=o[q++])&&(c[m]=n[m]);return c}:i},function(a,b,c){function d(a){return c(e(a))}function e(a){var b=f[a];if(!(b+1))throw new Error("Cannot find module '"+a+"'.");return b}var f={"./en-US":164,"./en-US.js":164,"./fr-FR":165,"./fr-FR.js":165,"./ja-JP":166,"./ja-JP.js":166,"./ko-KR":167,"./ko-KR.js":167};d.keys=function(){return Object.keys(f)},d.resolve=e,a.exports=d,d.id=255},function(a,b,c){"use strict";b.__esModule=!0,b.default={nsc:"blog.se3",ccsrv:"cc.naver.com",codes:{PTE:"pte",PTE_CANCEL:"pte.cancel",PTE_OK:"pte.ok",PTE_ORIGINAL:"pte.orig",PTE_UNDO:"pte.undo",PTE_REDO:"pte.redo",PTE_EXPORT:"pte.export",PTE_EXPTPC:"pte.exptpc",PTE_EXPTCLOUD:"pte.exptcloud",PTE_S:"pte*s",PTE_S_FILTER:"pte*s.fil",PTE_S_CROP:"pte*s.cut",PTE_S_RESIZE:"pte*s.siz",PTE_S_ADJUST:"pte*s.rev",PTE_S_MOSAIC:"pte*s.moz",PTE_S_SIGNATURE:"pte*s.sign",PTE_S_STICKER:"pte*s.sticker",PTE_S_TEXT:"pte*s.text",PTE_S_PHOTOFRAME:"pte*s.frame",PTE_S_CLIP:"pte*s.mask",PTE_S_FITSCREEN:"pte*s.fitscreen",PTE_L:"pte*l",PTE_L_OPEN:"pte*l.open",PTE_L_CLOSE:"pte*l.close",PTE_L_PREV:"	pte*l.prev",PTE_L_NEXT:"pte*l.next",PTE_L_DROP:"pte*l.drop",PTE_L_REVERSE:"pte*l.reverse",PTE_L_EDIT:"pte*l.edit",PTE_L_SAVE:"pte*l.save",PTE_F:"pte*f",PTE_F_ORIGINAL:"pte*f.org",PTE_F_FIL1:"pte*f.fil1",PTE_F_FIL2:"pte*f.fil2",PTE_F_FIL3:"pte*f.fil3",PTE_F_FIL4:"pte*f.fil4",PTE_F_FIL5:"pte*f.fil5",PTE_F_FIL6:"pte*f.fil6",PTE_F_FIL7:"pte*f.fil7",PTE_F_FIL8:"pte*f.fil8",PTE_F_FIL9:"pte*f.fil9",PTE_F_FIL10:"pte*f.fil10",PTE_F_FIL11:"pte*f.fil11",PTE_F_FIL12:"pte*f.fil12",PTE_F_FIL13:"pte*f.fil13",PTE_F_FIL14:"pte*f.fil14",PTE_F_FIL15:"pte*f.fil15",PTE_F_FIL16:"pte*f.fil16",PTE_F_FIL17:"pte*f.fil17",PTE_F_FIL18:"pte*f.fil18",PTE_F_BAR:"pte*f.bar",PTE_F_APPLYALL:"pte*f.applyall",PTE_F_PORTION:"pte*f.portion",PTE_C:"pte*c",PTE_C_RE:"pte*c.re",PTE_C_ROTATE:"pte*c.rotate",PTE_C_HORIZON:"pte*c.horizon",PTE_C_VERTICAL:"pte*c.vertical",PTE_C_ORIGINAL:"pte*c.orig",PTE_C_FREE:"pte*c.free",PTE_C_169:"pte*c.169",PTE_C_32:"pte*c.32",PTE_C_43:"pte*c.43",PTE_C_11:"pte*c.11",PTE_C_34:"pte*c.34",PTE_C_23:"pte*c.23",PTE_C_916:"pte*c.916",PTE_C_OK:"pte*c.ok",PTE_C_ANGLE:"pte*c.ran",PTE_C_AUTO:"pte*c.auto",PTE_C_DROP:"pte*c.drop",PTE_W:"pte*w",PTE_W_BATCH:"pte*w.all",PTE_W_INPUT:"pte*w.input",PTE_W_ORIGINAL:"pte*w.orig",PTE_W_400:"pte*w.400",PTE_W_600:"pte*w.600",PTE_W_700:"pte*w.700",PTE_W_773:"pte*w.773",PTE_W_966:"pte*w.966",PTE_W_580:"pte*w.580",PTE_W_900:"pte*w.900",PTE_W_1200:"pte*w.1200",PTE_W_PORTION:"pte*w.portion",PTE_R:"pte*r",PTE_R_RESET:"pte*r.re",PTE_R_AUTO:"pte*r.auto",PTE_R_BRIGHTNESS:"pte*r.brig",PTE_R_SATURATION:"pte*r.sat",PTE_R_SHARPEN:"pte*r.sha",PTE_R_KELVIN:"pte*r.col",PTE_R_CONTRAST:"pte*w.cont",PTE_M:"pte*m",PTE_M_RESET:"pte*m.re",PTE_M_UNDO:"pte*m.undo",PTE_M_SQUARE1:"pte*m.sq1",PTE_M_SQUARE2:"pte*m.sq2",PTE_M_SQUARE3:"pte*m.sq3",PTE_M_SQUARE4:"pte*m.sq4",PTE_M_SQUARE5:"pte*m.sq5",PTE_M_CIRCLE1:"pte*m.cir1",PTE_M_CIRCLE2:"pte*m.cir2",PTE_M_CIRCLE3:"pte*m.cir3",PTE_M_CIRCLE4:"pte*m.cir4",PTE_M_CIRCLE5:"pte*m.cir5",PTE_G:"pte*g",PTE_G_NONE:"pte*g.none",PTE_G_IMAGE:"pte*g.image",PTE_G_TEXT:"pte*g.text",PTE_G_FITSCREEN:"pte*g.fitscreen",PTE_G_APPLYALL:"pte*g.applyall",PTE_G_ATTACH:"pte*g.load",PTE_G_FONT:"pte*g.font",PTE_G_FONTSIZE:"pte*g.fontsize",PTE_G_BOLD:"pte*g.bold",PTE_G_ITALIC:"pte*g.italic",PTE_G_COLOR:"pte*g.color",PTE_G_BGCOLOR:"pte*g.bgcolor",PTE_G_PORTION:"pte*g.portion",PTE_H_NEWADD:"pte*h.newadd",PTE_H_FITSCREEN:"pte*h.fitscreen",PTE_T_NEWADD:"pte*t.newadd",PTE_T_FITSCREEN:"pte*t.fitscreen",PTE_T_FONT:"pte*t.font",PTE_T_FONTSIZE:"pte*t.fontsize",PTE_T_BOLD:"pte*t.bold",PTE_T_ITALIC:"pte*t.italic",PTE_T_COLOR:"pte*t.color",PTE_T_BGCOLOR:"pte*t.bgcolor",PTE_A:"pte*a",PTE_A_NONE:"pte*a.none",PTE_A_WHITE:"pte*a.white",PTE_A_BLACK:"pte*a.black",PTE_A_ROUND:"pte*a.round",PTE_A_TRANSPARENT:"pte*a.transparent",PTE_A_OLD:"pte*a.old",PTE_A_PAPER:"pte*a.paper",PTE_A_APPLYALL:"pte*a.applyall",PTE_A_PORTION:"pte*a.portion",PTE_K:"pte*k",PTE_K_NONE:"pte*k.none",PTE_K_CLIP0:"pte*k.white",PTE_K_CLIP1:"pte*k.triangle",PTE_K_CLIP2:"pte*k.roundsquare",PTE_K_CLIP3:"pte*k.polygon",PTE_K_CLIP4:"pte*k.star1",PTE_K_CLIP5:"pte*k.star2",PTE_K_CLIP6:"pte*k.roundstar",PTE_K_OUTLINE:"pte*k.outline",PTE_K_OK:"pte*k.ok"}}},function(a,b,c){"use strict";b.__esModule=!0,b.default={nsc:"post.se3",ccsrv:"cc.naver.com",codes:{PTE:"pte",PTE_CANCEL:"pte.cancel",PTE_OK:"pte.ok",PTE_ORIGINAL:"pte.orig",PTE_UNDO:"pte.undo",PTE_REDO:"pte.redo",PTE_EXPORT:"pte.export",PTE_EXPTPC:"pte.exptpc",PTE_EXPTCLOUD:"pte.exptcloud",PTE_S:"pte*s",PTE_S_FILTER:"pte*s.fil",PTE_S_CROP:"pte*s.cut",PTE_S_RESIZE:"pte*s.siz",PTE_S_ADJUST:"pte*s.rev",PTE_S_MOSAIC:"pte*s.moz",PTE_S_SIGNATURE:"pte*s.sign",PTE_S_STICKER:"pte*s.sticker",PTE_S_TEXT:"pte*s.text",PTE_S_PHOTOFRAME:"pte*s.frame",PTE_S_CLIP:"pte*s.mask",PTE_S_FITSCREEN:"pte*s.fitscreen",PTE_L:"pte*l",PTE_L_OPEN:"pte*l.open",PTE_L_CLOSE:"pte*l.close",PTE_L_PREV:"	pte*l.prev",PTE_L_NEXT:"pte*l.next",PTE_L_DROP:"pte*l.drop",PTE_L_REVERSE:"pte*l.reverse",PTE_L_EDIT:"pte*l.edit",PTE_L_SAVE:"pte*l.save",PTE_F:"pte*f",PTE_F_ORIGINAL:"pte*f.org",PTE_F_FIL1:"pte*f.fil1",PTE_F_FIL2:"pte*f.fil2",PTE_F_FIL3:"pte*f.fil3",PTE_F_FIL4:"pte*f.fil4",PTE_F_FIL5:"pte*f.fil5",PTE_F_FIL6:"pte*f.fil6",PTE_F_FIL7:"pte*f.fil7",PTE_F_FIL8:"pte*f.fil8",PTE_F_FIL9:"pte*f.fil9",PTE_F_FIL10:"pte*f.fil10",PTE_F_FIL11:"pte*f.fil11",PTE_F_FIL12:"pte*f.fil12",PTE_F_FIL13:"pte*f.fil13",PTE_F_FIL14:"pte*f.fil14",PTE_F_FIL15:"pte*f.fil15",PTE_F_FIL16:"pte*f.fil16",PTE_F_FIL17:"pte*f.fil17",PTE_F_FIL18:"pte*f.fil18",PTE_F_BAR:"pte*f.bar",PTE_F_APPLYALL:"pte*f.applyall",PTE_F_PORTION:"pte*f.portion",PTE_C:"pte*c",PTE_C_RE:"pte*c.re",PTE_C_ROTATE:"pte*c.rotate",PTE_C_HORIZON:"pte*c.horizon",PTE_C_VERTICAL:"pte*c.vertical",PTE_C_ORIGINAL:"pte*c.orig",PTE_C_FREE:"pte*c.free",PTE_C_169:"pte*c.169",PTE_C_32:"pte*c.32",PTE_C_43:"pte*c.43",PTE_C_11:"pte*c.11",PTE_C_34:"pte*c.34",PTE_C_23:"pte*c.23",PTE_C_916:"pte*c.916",PTE_C_OK:"pte*c.ok",PTE_C_ANGLE:"pte*c.ran",PTE_C_AUTO:"pte*c.auto",PTE_C_DROP:"pte*c.drop",PTE_W:"pte*w",PTE_W_BATCH:"pte*w.all",PTE_W_INPUT:"pte*w.input",PTE_W_ORIGINAL:"pte*w.orig",PTE_W_400:"pte*w.400",PTE_W_600:"pte*w.600",PTE_W_700:"pte*w.700",PTE_W_773:"pte*w.773",PTE_W_966:"pte*w.966",PTE_W_580:"pte*w.580",PTE_W_900:"pte*w.900",PTE_W_1200:"pte*w.1200",PTE_W_PORTION:"pte*w.portion",PTE_R:"pte*r",PTE_R_RESET:"pte*r.re",PTE_R_AUTO:"pte*r.auto",PTE_R_BRIGHTNESS:"pte*r.brig",PTE_R_SATURATION:"pte*r.sat",PTE_R_SHARPEN:"pte*r.sha",PTE_R_KELVIN:"pte*r.col",PTE_R_CONTRAST:"pte*w.cont",PTE_M:"pte*m",PTE_M_RESET:"pte*m.re",PTE_M_UNDO:"pte*m.undo",PTE_M_SQUARE1:"pte*m.sq1",PTE_M_SQUARE2:"pte*m.sq2",PTE_M_SQUARE3:"pte*m.sq3",PTE_M_SQUARE4:"pte*m.sq4",PTE_M_SQUARE5:"pte*m.sq5",PTE_M_CIRCLE1:"pte*m.cir1",PTE_M_CIRCLE2:"pte*m.cir2",PTE_M_CIRCLE3:"pte*m.cir3",PTE_M_CIRCLE4:"pte*m.cir4",PTE_M_CIRCLE5:"pte*m.cir5",PTE_G:"pte*g",PTE_G_NONE:"pte*g.none",PTE_G_IMAGE:"pte*g.image",PTE_G_TEXT:"pte*g.text",PTE_G_FITSCREEN:"pte*g.fitscreen",PTE_G_APPLYALL:"pte*g.applyall",PTE_G_ATTACH:"pte*g.load",PTE_G_FONT:"pte*g.font",PTE_G_FONTSIZE:"pte*g.fontsize",PTE_G_BOLD:"pte*g.bold",PTE_G_ITALIC:"pte*g.italic",PTE_G_COLOR:"pte*g.color",PTE_G_BGCOLOR:"pte*g.bgcolor",PTE_G_PORTION:"pte*g.portion",PTE_H_NEWADD:"pte*h.newadd",PTE_H_FITSCREEN:"pte*h.fitscreen",PTE_T_NEWADD:"pte*t.newadd",PTE_T_FITSCREEN:"pte*t.fitscreen",PTE_T_FONT:"pte*t.font",PTE_T_FONTSIZE:"pte*t.fontsize",PTE_T_BOLD:"pte*t.bold",PTE_T_ITALIC:"pte*t.italic",PTE_T_COLOR:"pte*t.color",PTE_T_BGCOLOR:"pte*t.bgcolor",PTE_A:"pte*a",PTE_A_NONE:"pte*a.none",PTE_A_WHITE:"pte*a.white",PTE_A_BLACK:"pte*a.black",PTE_A_ROUND:"pte*a.round",PTE_A_TRANSPARENT:"pte*a.transparent",PTE_A_OLD:"pte*a.old",PTE_A_PAPER:"pte*a.paper",PTE_A_APPLYALL:"pte*a.applyall",PTE_A_PORTION:"pte*a.portion",PTE_K:"pte*k",PTE_K_NONE:"pte*k.none",PTE_K_CLIP0:"pte*k.white",PTE_K_CLIP1:"pte*k.triangle",PTE_K_CLIP2:"pte*k.roundsquare",PTE_K_CLIP3:"pte*k.polygon",PTE_K_CLIP4:"pte*k.star1",PTE_K_CLIP5:"pte*k.star2",PTE_K_CLIP6:"pte*k.roundstar",PTE_K_OUTLINE:"pte*k.outline",PTE_K_OK:"pte*k.ok"}}},function(a,b,c){"use strict";b.__esModule=!0,b.default={nsc:"pholar.se3",ccsrv:"cc.naver.com",codes:{PTE:"edt",PTE_CANCEL:"edt.cancel",PTE_OK:"edt.ok",PTE_ORIGINAL:"edt.origin",PTE_UNDO:"edt.undo",PTE_REDO:"edt.redo",PTE_EXPORT:"edt.export",PTE_EXPTPC:"edt.exptpc",PTE_EXPTCLOUD:"edt.exptcloud",PTE_S_FILTER:"edt.filter",PTE_S_CROP:"edt.crop",PTE_S_ADJUST:"edt.correct",PTE_S_MOSAIC:"edt.mosaic",PTE_S_PHOTOFRAME:"edt.frame",PTE_S_FITSCREEN:"edt.fitscreen",PTE_L_OPEN:"edt.imgopen",PTE_L_CLOSE:"edt.imgclose",PTE_L_PREV:"edt.prev",PTE_L_NEXT:"edt.next",PTE_L_DROP:"edt.drag",PTE_L_REVERSE:"edt.reverse",PTE_F:"edt*f",PTE_F_ORIGINAL:"edt*f.origin",PTE_F_FIL1:"edt*f.filter1",PTE_F_FIL2:"edt*f.filter2",PTE_F_FIL3:"edt*f.filter3",PTE_F_FIL4:"edt*f.filter4",PTE_F_FIL5:"edt*f.filter5",PTE_F_FIL6:"edt*f.filter6",PTE_F_FIL7:"edt*f.filter7",PTE_F_FIL8:"edt*f.filter8",PTE_F_FIL9:"edt*f.filter9",PTE_F_FIL10:"edt*f.filter10",PTE_F_APPLYALL:"edt*f.applyall",PTE_F_PORTION:"edt*f.portion",PTE_C:"edt*c",PTE_C_RE:"edt*c.reset",PTE_C_ROTATE:"edt*c.rotation",PTE_C_HORIZON:"edt*c.horizon",PTE_C_VERTICAL:"edt*c.vertical",PTE_C_ORIGINAL:"edt*c.origin",PTE_C_FREE:"edt*c.free",PTE_C_169:"edt*c.ratio1",PTE_C_32:"edt*c.ratio2",PTE_C_43:"edt*c.ratio3",PTE_C_11:"edt*c.ratio4",PTE_C_34:"edt*c.ratio5",PTE_C_23:"edt*c.ratio6",PTE_C_916:"edt*c.ratio7",PTE_C_OK:"edt*c.ok",PTE_C_ANGLE:"edt*c.manual",PTE_C_AUTO:"edt*c.auto",PTE_C_DROP:"edt*c.resize",PTE_R:"edt*r",PTE_R_RESET:"edt*r.reset",PTE_R_AUTO:"edt*r.auto",PTE_R_BRIGHTNESS:"edt*r.bright",PTE_R_SATURATION:"edt*r.chroma",PTE_R_SHARPEN:"edt*r.sharp",PTE_R_KELVIN:"edt*r.color",PTE_M:"edt*m",PTE_M_RESET:"edt*m.reset",PTE_M_UNDO:"edt*m.undo",PTE_M_SQUARE1:"edt*m.squre1",PTE_M_SQUARE2:"edt*m.squre2",PTE_M_SQUARE3:"edt*m.squre3",PTE_M_SQUARE4:"edt*m.squre4",PTE_M_SQUARE5:"edt*m.squre5",PTE_M_CIRCLE1:"edt*m.round1",PTE_M_CIRCLE2:"edt*m.round2",PTE_M_CIRCLE3:"edt*m.round3",PTE_M_CIRCLE4:"edt*m.round4",PTE_M_CIRCLE5:"edt*m.round5",PTE_A:"edt*a",PTE_A_NONE:"edt*a.none",PTE_A_WHITE:"edt*a.white",PTE_A_BLACK:"edt*a.black",PTE_A_ROUND:"edt*a.round",PTE_A_TRANSPARENT:"edt*a.transparent",PTE_A_OLD:"edt*a.old",PTE_A_PAPER:"edt*a.paper",PTE_A_APPLYALL:"edt*a.applyall",PTE_A_PORTION:"edt*a.portion"}}},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(7),h=d(g),i=c(260),j=d(i),k=void 0,l=function(){function a(b){(0,f.default)(this,a),k||(k=this);return this._keyPrefix=b?b+"__":"",this._checkCookieClear(),k}return a.prototype._getStorageKeyCombinedUserId=function(a){return this._keyPrefix+a},a.prototype.getItem=function(a){return localStorage.getItem(this._getStorageKeyCombinedUserId(a))||localStorage.getItem(a)},a.prototype.setItem=function(a,b){return this._isExistsLegacyData(a)&&this._removeLegacyData(a),localStorage.setItem(this._getStorageKeyCombinedUserId(a),b)},a.prototype._isExistsLegacyData=function(a){return null!==localStorage.getItem(a)},a.prototype._removeLegacyData=function(a){localStorage.removeItem(a)},a.prototype._checkCookieClear=function(){var a="storageID";if(localStorage.getItem(this._getStorageKeyCombinedUserId(a))&&!j.default.get(this._getStorageKeyCombinedUserId(a)))for(var b in localStorage)-1!==b.indexOf(this._keyPrefix)&&(void 0,localStorage.removeItem(b));else if(!localStorage.getItem(this._getStorageKeyCombinedUserId(a))){var c=h.default.getUniqueId(),d=new Date;d.setMonth(d.getMonth()+1),localStorage.setItem(this._getStorageKeyCombinedUserId(a),c),j.default.set(this._getStorageKeyCombinedUserId(a),c,{expires:d.toGMTString()})}},a}();b.default=l},function(a,b,c){var d,e;!function(f,g){d=g,void 0!==(e="function"==typeof d?d.call(b,c,b,a):d)&&(a.exports=e)}(0,function(){"use strict";function a(b,c,d){if(void 0===c)return a.get(b);null===c?a.remove(b):a.set(b,c,d)}function b(a){return a.replace(/[.*+?^$|[\](){}\\-]/g,"\\$&")}function c(a){var b="";for(var c in a)if(a.hasOwnProperty(c)){if("expires"===c){var e=a[c];"object"!=typeof e&&(e+="number"==typeof e?"D":"",e=d(e)),a[c]=e.toUTCString()}b+=";"+c+"="+a[c]}return a.hasOwnProperty("path")||(b+=";path=/"),b}function d(a){var b=new Date,c=a.charAt(a.length-1),d=parseInt(a,10);switch(c){case"Y":b.setFullYear(b.getFullYear()+d);break;case"M":b.setMonth(b.getMonth()+d);break;case"D":b.setDate(b.getDate()+d);break;case"h":b.setHours(b.getHours()+d);break;case"m":b.setMinutes(b.getMinutes()+d);break;case"s":b.setSeconds(b.getSeconds()+d);break;default:b=new Date(a)}return b}return a.enabled=function(){var b,c="__test_key";return document.cookie=c+"=1",b=!!document.cookie,b&&a.remove(c),b},a.get=function(a,c){if("string"!=typeof a||!a)return null;a="(?:^|; )"+b(a)+"(?:=([^;]*?))?(?:;|$)";var d=new RegExp(a),e=d.exec(document.cookie);return null!==e?c?e[1]:decodeURIComponent(e[1]):null},a.getRaw=function(b){return a.get(b,!0)},a.set=function(a,b,d,e){!0!==d&&(e=d,d=!1),e=c(e?e:{});var f=a+"="+(d?b:encodeURIComponent(b))+e;document.cookie=f},a.setRaw=function(b,c,d){a.set(b,c,!0,d)},a.remove=function(b){a.set(b,"a",{expires:new Date})},a})},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(30),f=d(e),g=c(71),h=d(g),i=c(0),j=d(i),k=c(7),l=d(k),m=c(163),n=d(m),o=c(11),p=d(o),q=c(262),r=d(q),s=c(5),t=d(s),u=function(){function a(b){(0,j.default)(this,a),this._controller=b,this._storage=b._storage,this._phupOpts=this._getPhupOpts(),this._apiDomain=this._phupOpts.domain,this._sessionKeyOpts=this._getSessionKeyOpts(),this._phupBase64Uploader=this._getPhupUploader("BASE64"),this._phupSimpleUploader=this._getPhupUploader("SIMPLE"),this._sessionKey=null}return a.prototype._getPhupOpts=function(){return this._controller._options.phupOpts||(this._controller._options.phupOpts={domain:$SE_CONFIG.ENV_SETTING.PHOTO_UPLOADER_DOMAIN,imageDomain:$SE_CONFIG.ENV_SETTING.IMAGE_DOMAIN,userId:$SE_CONFIG.USER_INFO.id,sslEnabled:"https:"===document.location.protocol,extractDominantColor:!0}),t.default.extend(!0,{getSessionKey:this._getSessionKeyCallback.bind(this),userId:this._controller.options.setting.userId},this._controller._options.phupOpts)},a.prototype._getSessionKeyOpts=function(){return this._controller._options.sessionKeyOpts||(this._controller._options.sessionKeyOpts={url:"/PhotoUploader/SessionKey.json?uploaderType=simple",data:{userId:$SE_CONFIG.USER_INFO.id,serviceId:$SE_CONFIG.ENV_SETTING.SERVICE_NAME}}),t.default.extend(!0,{data:{userId:this._controller.options.setting.userId,serviceId:this._controller.options.setting.serviceName}},this._controller._options.sessionKeyOpts)},a.prototype._getPhupUploader=function(a){return r.default.getUploader(a,this._uploadComplete.bind(this),this._phupOpts)},a.prototype._getSessionKeyCallback=function(a){this.getSessionKey(a)},a.prototype.getSessionKey=function(){function a(a,c){return b.apply(this,arguments)}var b=(0,h.default)(f.default.mark(function c(a,b){return f.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(!this._controller.isLocal){c.next=6;break}return c.next=3,this._asyncGetSessionKeyFromPhotoinfra();case 3:c.t0=c.sent,c.next=9;break;case 6:return c.next=8,this._asyncGetSessionKeyFromSmarteditor();case 8:c.t0=c.sent;case 9:if(this._sessionKey=c.t0,null!==this._sessionKey){c.next=13;break}return b&&b(),c.abrupt("return");case 13:a&&a(this._sessionKey);case 14:case"end":return c.stop()}},c,this)}));return a}(),a.prototype._asyncGetSessionKeyFromSmarteditor=function(){function a(){return b.apply(this,arguments)}var b=(0,h.default)(f.default.mark(function c(){return f.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",t.default.ajax({url:this._sessionKeyOpts.url,cache:!1,dataType:"json",data:this._sessionKeyOpts.data}).then(function(a){return a.isSuccess&&a.result&&a.result.sessionKey||null}));case 1:case"end":return a.stop()}},c,this)}));return a}(),a.prototype._asyncGetSessionKeyFromPhotoinfra=function(){function a(){return b.apply(this,arguments)}var b=(0,h.default)(f.default.mark(function c(){return f.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",t.default.ajax({url:"http://test.upphoto.naver.com/key?serviceName=phinf&apiKey=c65e81279782ecbe54f4b172fcfd8c75",xhrFields:{withCredentials:!0},dataType:"xml"}).then(function(a){return a&&(0,t.default)(a).find("sessionKey").text()||null}));case 1:case"end":return a.stop()}},c,this)}));return a}(),a.prototype.checkError=function(a){return"false"===(0,t.default)(a).find("isSuccess").text()},a.prototype._uploadComplete=function(a){n.default.callback(p.default.CALLBACK_TYPES.PHUP_UPLOAD,a)},a.prototype.upload=function(){function a(a,c){return b.apply(this,arguments)}var b=(0,h.default)(f.default.mark(function c(a,b){var d,e,g,h=this;return f.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,n.default.action(p.default.CALLBACK_TYPES.PHUP_UPLOAD,function(){l.default.canUseNewFile()?h._phupSimpleUploader.upload({file:l.default.base64toFile(b,a.uploadFileName),imageFileName:a.uploadFileName,index:0}):h._phupBase64Uploader.upload({base64image:l.default.stripBase64Header(b),imageFileName:a.uploadFileName})});case 2:d=c.sent,d&&"IMAGE"===d.code?(e=d.fileName.split("."),g=e[0],this._controller.updatePhotos([{key:g,width:d.width,height:d.height,domain:this._phupOpts.imageDomain,path:d.url,fileSize:d.fileSize,animationGIF:d.animationGIF}])):this._controller.uploadFailed(d);case 4:case"end":return c.stop()}},c,this)}));return a}(),a.prototype.uploadSnapshot=function(){function a(a,c){return b.apply(this,arguments)}var b=(0,h.default)(f.default.mark(function c(a,b){var d,e,g,h,i=this;arguments.length>2&&void 0!==arguments[2]&&arguments[2];return f.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,n.default.action(p.default.CALLBACK_TYPES.PHUP_UPLOAD,function(){i._phupBase64Uploader.upload({base64image:l.default.stripBase64Header(b),imageFileName:a.uploadFileName})});case 2:if(!(d=c.sent)||"IMAGE"!==d.code){c.next=10;break}return e=this._phupOpts.imageDomain+d.url,g=d.fileName,h=d.fileSize,c.abrupt("return",{url:e,fileName:g,fileSize:h});case 10:this._controller.uploadFailed({});case 11:case"end":return c.stop()}},c,this)}));return a}(),a.prototype.uploadSignatureImage=function(a,b){var c=this,d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"image",e=t.default.Deferred();if("image"===d&&(this._signatureImageDataURLBuffered=a),
this._controller.isLocal)return void("image"===d&&this._storage.setItem(p.default.COOKIES.SIGNATURE_IMAGE_DATAURL,a));var f=new FormData,g=l.default.base64ToBlob(a,b);return f.append("type",d),f.append("image",g),this.getSessionKey(function(a){var b=document.location.protocol+"//"+c._apiDomain+"/"+a+"/upload/signature";t.default.ajax({type:"post",url:b,data:f,cache:!1,mimeType:"multipart/form-data",contentType:!1,processData:!1,crossDomain:!0,xhrFields:{withCredentials:!0}}).done(function(){e.resolve()}).fail(function(){e.reject()})},function(){e.reject(),c._controller.uploadFailed({})}),e},a.prototype.asyncGetSignatureImageURL=function(){var a=this,b=t.default.Deferred(),c=this._storage.getItem(p.default.COOKIES.SIGNATURE_IMAGE_DATAURL);return this._signatureImageDataURLBuffered?b.resolve(this._signatureImageDataURLBuffered):this._controller.isLocal?(c?b.resolve(c):b.reject(),b.promise()):c?(this.uploadSignatureImage(c,"image/png"),localStorage.removeItem(p.default.COOKIES.SIGNATURE_IMAGE_DATAURL),b.resolve(c)):(this.getSessionKey(function(c){var d=document.location.protocol+"//"+a._apiDomain+"/"+c+"/signature?_="+(new Date).getTime();l.default.fetchBlob(d,function(c){if(c){var d=new FileReader;d.onloadend=function(){a._signatureImageDataURLBuffered=d.result,b.resolve(d.result)},d.onerror=function(a){b.reject()};try{d.readAsDataURL(c)}catch(e){l.default.debug(e),b.reject()}}else b.reject()},function(){b.reject()})},function(){a._controller.uploadFailed({}),b.reject()}),b.promise())},a}();b.default=u},function(a,b,c){"use strict";(function(a){var d,e=c(4),f=function(a){return a&&a.__esModule?a:{"default":a}}(e);!function(){var e=function(){var a=function(){return(new Date).getMilliseconds()+Math.floor(1e5*Math.random())},b=function(a,b){var c=document.createElement("iframe");return c.src=b,c.style.display="none",c.style.position="absolute",c.style.width="1px",c.style.height="1px",c.style.left="-100px",c.style.top="-100px",a.appendChild(c),c},c=function(a,b){var c,d,e,f={},g=b.split("|");for(c=0;c<g.length;c+=1)d=g[c].split("="),d[1]?("exif"===d[0]?f[d[0]]=d[1].replace(/&quot;/g,'"'):!0===/^[0-9]+$/.test(d[1])?f[d[0]]=parseInt(d[1]):f[d[0]]=d[1],e=d[0]):f[e]=f[e]+"|"+d[0];return f.index=a,f},d=function(a,b){var c,d,e,f={};for(c=b.replace("<![CDATA[","").replace("]]>","").match(/<?[^>]*?>([\S\s]*)/)[1].match(/<([^>]*)>([^<]*)<\/([^>]*)>/g),d=0;d<c.length;d+=1)e=c[d].match(/<([^>]*)>([^<]*)<\/[^>]*>/),"exif"===e[1]&&(e[2]=e[2].replace(/&quot;/g,'"')),f[e[1]]=e[2];return void 0===f.code?f.code="IMAGE":f={index:a,code:f.code},f},e=function(a){return a?"https:":"http:"},f=function(){var a;try{if(window.XMLHttpRequest)a=new XMLHttpRequest;else if(window.ActiveXObject)try{a=new ActiveXObject("Msxml2.XMLHTTP")}catch(b){a=new ActiveXObject("Microsoft.XMLHTTP")}}finally{return a}},g=function(a,b){var c,d=a.substring(a.lastIndexOf(".")+1).toLowerCase();for(c=0;c<b.length;c+=1)if(d===b[c])return!0;return!1},h=function(a,b,c,e,g,h,i){var j=f(),k=new window.FormData;k.append("image",c),j.onload=function(){200===j.status?(a.value=null,e(d(b,j.responseText))):e({index:b,code:"CLIENT"})},j.open("POST",g,!0),i&&i({el:a,index:b,fileName:c.name,xhr:j}),h.millisecond>0&&(j.timeout=h.millisecond,j.ontimeout=function(){h.handler({index:b,fileName:c.name})}),j.send(k)},i=function(a){return e(a.sslEnabled)+"//"+a.domain+"/"+a.sessionKey+"/simpleUpload/"+a.index+"?userId="+a.userId+"&extractExif="+a.extractExif+"&extractAnimatedCnt="+a.extractAnimatedCnt+"&autorotate="+a.autorotate+"&extractDominantColor="+a.extractDominantColor+"&type="+a.type},j=[],k=function(a){return function(b){a.done=!0,a.handler(c(a.index,b)),window[a.callback]=null}},l=function(a){a.millisecond>0&&setTimeout(function(){a.done||(window[a.callback]=function(){window[a.callback]=null},a.timeoutHandler({index:a.index,fileName:a.fileName}))},a.millisecond)},m=function(a){if(""===a.el.value)return!1},n=function(a){if(!a.sessionKey)return a.handler({code:"FAIL_TO_GET_SESSION_KEY"}),!1},o=function(a){return a.form?!1!==g(a.imageFileName,a.allowedImageType)||(a.handler({code:"UNSUPPORTED_EXTENSION"}),!1):(a.handler({code:"FAIL_TO_LOAD_IFRAME"}),!1)},p=function(a){return{isNotEmptyString:function(b){if(!("string"==typeof b.value&&b.value.length>0))throw a+b.name+" must be a not empty string"},isString:function(b){if("string"!=typeof b.value)throw a+b.name+" must be a string"},isFunction:function(b){if(!b.value||"function"!=typeof b.value)throw a+b.name+" must be a function"},isBoolean:function(b){if("boolean"!=typeof b.value)throw a+b.name+" must be a boolean"},isNumber:function(b){if("number"!=typeof b.value)throw a+b.name+" must be a number"},isNotEmptyArray:function(b){if(!(b.value instanceof Array&&b.value.length>0))throw a+b.name+" must be a not empty array"},isNotNull:function(b){if(null==b.value)throw a+b.name+" must not be null"},isInputTag:function(b){if(!b.value||!b.value.tagName||"INPUT"!==b.value.tagName)throw a+b.name+" must be an input tag"},isFile:function(b){if(!(window.File&&b.value instanceof File))throw a+b.name+" must be a File"}}},q=void 0!==f()&&void 0!==window.File&&function(){return/naver\.net$/.test(document.domain)||/naver\.com$/.test(document.domain)||/navercorp\.com$/.test(document.domain)||/arcadur\.com$/.test(document.domain)||/webtoons\.com$/.test(document.domain)||/linedict\.com$/.test(document.domain)||/pholar\.co$/.test(document.domain)||/vlive\.tv$/.test(document.domain)||/line\.me$/.test(document.domain)||/modoo\.at$/.test(document.domain)}(),r={};return r.getUploader=function(c,e,g){var h,j,m,r,s,t,u,v,w,x,y,z,A,B,C,c,D=document.getElementsByTagName("body")[0],E=new p("[phup.js] usage : phup.getUploader(type, handler, options)\n[phup.js] error : "),F={BASE64:{upload:function(b){var m,p=b&&b.base64image,y=b&&b.imageFileName,D=b&&(b.index||0),F="phup_callback_"+a(),G={index:D,millisecond:B.millisecond,handler:e,timeoutHandler:B.handler,done:void 0,callback:F,fileName:y};H(g),E.isNotEmptyString({value:p,name:"param.base64image"}),E.isNotEmptyString({value:y,name:"param.imageFileName"}),A(function(a){var b,g,A=i({sslEnabled:t,domain:r,sessionKey:a,userId:s,extractExif:u,extractAnimatedCnt:v,extractDominantColor:w,autorotate:x,index:D,type:c});if(0!=n({sessionKey:a,handler:e}))if(q)b=f(),g=new window.FormData,g.append("imageFileName",y),g.append("base64image",p),b.onload=function(){e(200===b.status?d(D,b.responseText):{index:D,code:"CLIENT"})},b.open("POST",A,!0),C&&C({index:D,fileName:y,xhr:b}),B.millisecond>0&&(b.timeout=B.millisecond,b.ontimeout=function(){B.handler({index:D,fileName:file.name})}),b.send(g);else{if(j=h.contentWindow.document.getElementById("phup_upload_form"),0==o({form:j,handler:e,imageFileName:y,allowedImageType:z}))return;for(window[F]=k(G),m=j.firstChild;null!=m;m=m.nextSibling)switch(m.id){case"phup_callback_func":m.value=F;break;case"imageFileName":m.value=y,m.disabled=null;break;case"base64image":m.value=p,m.disabled=null}j.action=i({sslEnabled:t,domain:r,sessionKey:a,userId:s,extractExif:u,extractAnimatedCnt:v,extractDominantColor:w,autorotate:x,index:D,type:c}),C&&C({el:el,index:D,fileName:y}),j.submit(),l(G),j.reset()}})}},SIMPLE:{upload:function(b){var h=b&&b.file,j=b&&(b.imageFileName||""),k=b&&(b.index||0),l="phup_callback_"+a();B.millisecond,B.handler;H(g),E.isFile({value:h,name:"param.file"}),E.isString({value:j,name:"param.imageFileName"}),A(function(a){var b,g,l=i({sslEnabled:t,domain:r,sessionKey:a,userId:s,extractExif:u,extractAnimatedCnt:v,extractDominantColor:w,autorotate:x,index:k,type:c});if(0!=n({sessionKey:a,handler:e})){if(!q)throw"[phup.js] error : SIMPLE uploader requires File & FormData";b=f(),g=new window.FormData,j.length>0&&g.append("imageFileName",j),g.append("image",h),b.onload=function(){e(200===b.status?d(k,b.responseText):{index:k,code:"CLIENT"})},b.open("POST",l,!0),C&&C({index:k,fileName:h.name,xhr:b}),B.millisecond>0&&(b.timeout=B.millisecond,b.ontimeout=function(){B.handler({index:k,fileName:h.name})}),b.send(g)}})}}},G=F[c],H=function(a){m=a&&a.resourcePath||"",r=a&&a.domain,s=a&&a.userId,t=a&&(a.sslEnabled||!1),u=a&&(a.extractExif||!1),v=a&&(a.extractAnimatedCnt||!1),w=a&&(a.extractDominantColor||!1),x=a&&(a.autorotate||!1),y=a&&(a.maxFileSize||10485760),z=a&&a.allowedImageType||["png","jpg","jpeg","bmp","gif"],A=a&&a.getSessionKey,B=a&&(a.timeout||{millisecond:0,handler:function(){}}),C=a&&a.onstart,c=a&&a.type||"",E.isNotEmptyString({value:r,name:"options.domain"}),E.isNotEmptyString({value:s,name:"options.userId"}),E.isFunction({value:A,name:"options.getSessionKey"}),E.isBoolean({value:t,name:"options.sslEnabled"}),E.isBoolean({value:u,name:"options.extractExif"}),E.isBoolean({value:v,name:"options.extractAnimatedCnt"}),E.isBoolean({value:w,name:"options.extractDominantColor"}),E.isBoolean({value:x,name:"options.autorotate"}),E.isNumber({value:y,name:"options.maxFileSize"}),E.isNotEmptyArray({value:z,name:"options.allowedImageType"}),E.isNumber({value:B.millisecond,name:"options.timeout.millisecond"}),E.isFunction({value:B.handler,name:"options.timeout.handler"}),C&&E.isFunction({value:C,name:"options.onstart"}),E.isString({value:c,name:"options.type"}),h||q||(h=b(D,m+"/phup_frame.html"))};return E.isNotEmptyString({value:c,name:"type"}),E.isNotNull({value:g,name:"options"}),"function"!=typeof g&&H(g),G},r.config=function(c,d,e){var f,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I=document.getElementsByTagName("body")[0],J=document.createElement("div"),K=c&&c.onclick,L=c&&c.onchange,M=(c&&c.multiple,new p("[phup.js] usage : phup.config(el, handler, options)\n[phup.js] error : ")),N=function(a){t=a&&a.resourcePath||"",u=a&&a.domain,v=a&&a.userId,w=a&&(a.sslEnabled||!1),x=a&&(a.extractExif||!1),y=a&&(a.extractAnimatedCnt||!1),z=a&&(a.extractDominantColor||!1),A=a&&(a.autorotate||!1),B=a&&(a.maxFileSize||10485760),C=a&&a.allowedImageType||["png","jpg","jpeg","bmp","gif"],D=a&&a.getSessionKey,E=a&&(a.timeout||{millisecond:0,handler:function(){}}),F=a&&a.onstart,H=a&&a.type||"",M.isNotEmptyString({value:u,name:"options.domain"}),M.isNotEmptyString({value:v,name:"options.userId"}),M.isFunction({value:D,name:"options.getSessionKey"}),M.isBoolean({value:w,name:"options.sslEnabled"}),M.isBoolean({value:x,name:"options.extractExif"}),M.isBoolean({value:y,name:"options.extractAnimatedCnt"}),M.isBoolean({value:z,name:"options.extractDominantColor"}),M.isBoolean({value:A,name:"options.autorotate"}),M.isNumber({value:B,name:"options.maxFileSize"}),M.isNotEmptyArray({value:C,name:"options.allowedImageType"}),M.isNumber({value:E.millisecond,name:"options.timeout.millisecond"}),M.isFunction({value:E.handler,name:"options.timeout.handler"}),F&&M.isFunction({value:F,name:"options.onstart"}),M.isString({value:H,name:"options.type"}),r||q||(r=b(I,t+"/phup_frame.html"))};M.isInputTag({value:c,name:"el"});for(G in j)if(j.hasOwnProperty(G)&&j[G]==c)throw"[phup.js] error : el is already bound with phup.js";j.push(c),M.isFunction({value:d,name:"handler"}),M.isNotNull({value:e,name:"options"}),"function"!=typeof e&&N(e),c.onclick=function(a){K&&K(a),"function"==typeof e&&N(e()),D(function(a){f=a,s&&c.onupload(s)})},q?(c.onupload=function(){var a,b=c.files;if(L&&L(),0!=m({el:c})&&0!=n({sessionKey:f,handler:d}))for(a=0;a<b.length;a+=1)!1===g(b[a].name,C)?d({index:a,code:"UNSUPPORTED_EXTENSION"}):b[a].size>B?d({index:a,code:"LIMITATION_BY_IMAGE"}):h(c,a,b[a],d,i({sslEnabled:w,domain:u,sessionKey:f,userId:v,extractExif:x,extractAnimatedCnt:y,extractDominantColor:z,autorotate:A,index:a,type:H}),E,F)},c.onchange=function(a){f?(c.onupload(a),s=null):s=a}):(c.multiple=!1,c.onupload=function(b){var e,g=c.name,h=c.value.replace(/^C:\\fakepath\\/,""),j=c.parentNode,p=r.contentWindow.document.getElementById("phup_upload_form"),q="phup_callback_"+a(),s={index:0,millisecond:E.millisecond,handler:function(a){c.onclick=K,d(a)},timeoutHandler:function(a){c.onclick=K,E.handler(a)},done:void 0,callback:q,fileName:h};if(L&&L(b),0!=m({el:c})&&0!=n({sessionKey:f,handler:d})&&0!=o({form:p,handler:d,imageFileName:h,allowedImageType:C})){for(window[q]=k(s),c.name="image",c.onclick=function(a){a&&a.preventDefault&&a.preventDefault()},j.replaceChild(J,c),p.appendChild(c),e=p.firstChild;null!=e;e=e.nextSibling)switch(e.id){case"phup_callback_func":e.value=q}p.action=i({sslEnabled:w,domain:u,sessionKey:f,userId:v,extractExif:x,extractAnimatedCnt:y,extractDominantColor:z,autorotate:A,index:0,type:H}),F&&F({el:c,index:0,fileName:h}),p.submit(),l(s),p.reset(),c.name=g,j.replaceChild(c,J)}},c.onchange=function(a){f?(c.onupload(a),s=null):s=a})},r};void 0!==(0,f.default)(a)&&void 0!==(0,f.default)(a.exports)?a.exports=new e:void 0!==(d=function(){return new e}.call(b,c,b,a))&&(a.exports=d)}()}).call(b,c(6)(a))},function(a,b,c){"use strict";(function(d){function e(a){return a&&a.__esModule?a:{"default":a}}var f,g,h,i,i,j=c(170),k=e(j),l=c(38),m=e(l),n=c(171),o=e(n),p=c(37),q=e(p),r=c(22),s=e(r),t=c(270),u=e(t),v=c(123),w=e(v),x=c(4),y=e(x);!function(c){if("object"===(0,y.default)(b)&&void 0!==a)a.exports=c();else{g=[],f=c,void 0!==(h="function"==typeof f?f.apply(b,g):f)&&(a.exports=h)}}(function(){var a;return function b(a,c,d){function e(g,h){if(!c[g]){if(!a[g]){var j="function"==typeof i&&i;if(!h&&j)return i(g,!0);if(f)return f(g,!0);var k=new Error("Cannot find module '"+g+"'");throw k.code="MODULE_NOT_FOUND",k}var l=c[g]={exports:{}};a[g][0].call(l.exports,function(b){var c=a[g][1][b];return e(c||b)},l,l.exports,b,a,c,d)}return c[g].exports}for(var f="function"==typeof i&&i,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(b,c,e){(function(b,d){!function(){function e(){}function f(a){return a}function g(a){return!!a}function h(a){return!a}function i(a){return function(){if(null===a)throw new Error("Callback was already called.");a.apply(this,arguments),a=null}}function j(a){return function(){null!==a&&(a.apply(this,arguments),a=null)}}function k(a){return R(a)||"number"==typeof a.length&&a.length>=0&&a.length%1==0}function l(a,b){for(var c=-1,d=a.length;++c<d;)b(a[c],c,a)}function m(a,b){for(var c=-1,d=a.length,e=Array(d);++c<d;)e[c]=b(a[c],c,a);return e}function n(a){return m(Array(a),function(a,b){return b})}function o(a,b,c){return l(a,function(a,d,e){c=b(c,a,d,e)}),c}function p(a,b){l(T(a),function(c){b(a[c],c)})}function q(a,b){for(var c=0;c<a.length;c++)if(a[c]===b)return c;return-1}function r(a){var b,c,d=-1;return k(a)?(b=a.length,function(){return d++,d<b?d:null}):(c=T(a),b=c.length,function(){return d++,d<b?c[d]:null})}function s(a,b){return b=null==b?a.length-1:+b,function(){for(var c=Math.max(arguments.length-b,0),d=Array(c),e=0;e<c;e++)d[e]=arguments[e+b];switch(b){case 0:return a.call(this,d);case 1:return a.call(this,arguments[0],d)}}}function t(a){return function(b,c,d){return a(b,d)}}function v(a){return function(b,c,d){d=j(d||e),b=b||[];var f=r(b);if(a<=0)return d(null);var g=!1,h=0,k=!1;!function l(){if(g&&h<=0)return d(null);for(;h<a&&!k;){var e=f();if(null===e)return g=!0,void(h<=0&&d(null));h+=1,c(b[e],e,i(function(a){h-=1,a?(d(a),k=!0):l()}))}}()}}function x(a){return function(b,c,d){return a(O.eachOf,b,c,d)}}function z(a){return function(b,c,d,e){return a(v(c),b,d,e)}}function A(a){return function(b,c,d){return a(O.eachOfSeries,b,c,d)}}function B(a,b,c,d){d=j(d||e),b=b||[];var f=k(b)?[]:{};a(b,function(a,b,d){c(a,function(a,c){f[b]=c,d(a)})},function(a){d(a,f)})}function C(a,b,c,d){var e=[];a(b,function(a,b,d){c(a,function(c){c&&e.push({index:b,value:a}),d()})},function(){d(m(e.sort(function(a,b){return a.index-b.index}),function(a){return a.value}))})}function D(a,b,c,d){C(a,b,function(a,b){c(a,function(a){b(!a)})},d)}function E(a,b,c){return function(d,e,f,g){function h(){g&&g(c(!1,void 0))}function i(a,d,e){if(!g)return e();f(a,function(d){g&&b(d)&&(g(c(!0,a)),g=f=!1),e()})}arguments.length>3?a(d,e,i,h):(g=f,f=e,a(d,i,h))}}function F(a,b){return b}function G(a,b,c){c=c||e;var d=k(b)?[]:{};a(b,function(a,b,c){a(s(function(a,e){e.length<=1&&(e=e[0]),d[b]=e,c(a)}))},function(a){c(a,d)})}function H(a,b,c,d){var e=[];a(b,function(a,b,d){c(a,function(a,b){e=e.concat(b||[]),d(a)})},function(a){d(a,e)})}function I(a,b,c){function d(a,b,c,d){if(null!=d&&"function"!=typeof d)throw new Error("task callback must be a function");if(a.started=!0,R(b)||(b=[b]),0===b.length&&a.idle())return O.setImmediate(function(){a.drain()});l(b,function(b){var f={data:b,callback:d||e};c?a.tasks.unshift(f):a.tasks.push(f),a.tasks.length===a.concurrency&&a.saturated()}),O.setImmediate(a.process)}function f(a,b){return function(){g-=1;var c=!1,d=arguments;l(b,function(a){l(h,function(b,d){b!==a||c||(h.splice(d,1),c=!0)}),a.callback.apply(a,d)}),a.tasks.length+g===0&&a.drain(),a.process()}}if(null==b)b=1;else if(0===b)throw new Error("Concurrency must not be zero");var g=0,h=[],j={tasks:[],concurrency:b,payload:c,saturated:e,empty:e,drain:e,started:!1,paused:!1,push:function(a,b){d(j,a,!1,b)},kill:function(){j.drain=e,j.tasks=[]},unshift:function(a,b){d(j,a,!0,b)},process:function(){for(;!j.paused&&g<j.concurrency&&j.tasks.length;){var b=j.payload?j.tasks.splice(0,j.payload):j.tasks.splice(0,j.tasks.length),c=m(b,function(a){return a.data});0===j.tasks.length&&j.empty(),g+=1,h.push(b[0]);var d=i(f(j,b));a(c,d)}},length:function(){return j.tasks.length},running:function(){return g},workersList:function(){return h},idle:function(){return j.tasks.length+g===0},pause:function(){j.paused=!0},resume:function(){if(!1!==j.paused){j.paused=!1;for(var a=Math.min(j.concurrency,j.tasks.length),b=1;b<=a;b++)O.setImmediate(j.process)}}};return j}function J(a){return s(function(b,c){b.apply(null,c.concat([s(function(b,c){"object"===("undefined"==typeof console?"undefined":(0,y.default)(console))&&(b?console.error&&void 0:console[a]&&l(c,function(a){void 0}))})]))})}function K(a){return function(b,c,d){a(n(b),c,d)}}function L(a){return s(function(b,c){var d=s(function(c){var d=this,e=c.pop();return a(b,function(a,b,e){a.apply(d,c.concat([e]))},e)});return c.length?d.apply(this,c):d})}function M(a){return s(function(b){var c=b.pop();b.push(function(){var a=arguments;d?O.setImmediate(function(){c.apply(null,a)}):c.apply(null,a)});var d=!0;a.apply(this,b),d=!1})}var N,O={},P="object"===("undefined"==typeof self?"undefined":(0,y.default)(self))&&self.self===self&&self||"object"===(void 0===d?"undefined":(0,y.default)(d))&&d.global===d&&d||this;null!=P&&(N=P.async),O.noConflict=function(){return P.async=N,O};var Q=Object.prototype.toString,R=Array.isArray||function(a){return"[object Array]"===Q.call(a)},S=function(a){var b=void 0===a?"undefined":(0,y.default)(a);return"function"===b||"object"===b&&!!a},T=w.default||function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b},U="function"==typeof u.default&&u.default,V=U?function(a){U(a)}:function(a){setTimeout(a,0)};"object"===(void 0===b?"undefined":(0,y.default)(b))&&"function"==typeof b.nextTick?O.nextTick=b.nextTick:O.nextTick=V,O.setImmediate=U?V:O.nextTick,O.forEach=O.each=function(a,b,c){return O.eachOf(a,t(b),c)},O.forEachSeries=O.eachSeries=function(a,b,c){return O.eachOfSeries(a,t(b),c)},O.forEachLimit=O.eachLimit=function(a,b,c,d){return v(b)(a,t(c),d)},O.forEachOf=O.eachOf=function(a,b,c){function d(a){h--,a?c(a):null===f&&h<=0&&c(null)}c=j(c||e),a=a||[];for(var f,g=r(a),h=0;null!=(f=g());)h+=1,b(a[f],f,i(d));0===h&&c(null)},O.forEachOfSeries=O.eachOfSeries=function(a,b,c){function d(){var e=!0;if(null===g)return c(null);b(a[g],g,i(function(a){if(a)c(a);else{if(null===(g=f()))return c(null);e?O.setImmediate(d):d()}})),e=!1}c=j(c||e),a=a||[];var f=r(a),g=f();d()},O.forEachOfLimit=O.eachOfLimit=function(a,b,c,d){v(b)(a,c,d)},O.map=x(B),O.mapSeries=A(B),O.mapLimit=z(B),O.inject=O.foldl=O.reduce=function(a,b,c,d){O.eachOfSeries(a,function(a,d,e){c(b,a,function(a,c){b=c,e(a)})},function(a){d(a,b)})},O.foldr=O.reduceRight=function(a,b,c,d){var e=m(a,f).reverse();O.reduce(e,b,c,d)},O.transform=function(a,b,c,d){3===arguments.length&&(d=c,c=b,b=R(a)?[]:{}),O.eachOf(a,function(a,d,e){c(b,a,d,e)},function(a){d(a,b)})},O.select=O.filter=x(C),O.selectLimit=O.filterLimit=z(C),O.selectSeries=O.filterSeries=A(C),O.reject=x(D),O.rejectLimit=z(D),O.rejectSeries=A(D),O.any=O.some=E(O.eachOf,g,f),O.someLimit=E(O.eachOfLimit,g,f),O.all=O.every=E(O.eachOf,h,h),O.everyLimit=E(O.eachOfLimit,h,h),O.detect=E(O.eachOf,f,F),O.detectSeries=E(O.eachOfSeries,f,F),O.detectLimit=E(O.eachOfLimit,f,F),O.sortBy=function(a,b,c){function d(a,b){var c=a.criteria,d=b.criteria;return c<d?-1:c>d?1:0}O.map(a,function(a,c){b(a,function(b,d){b?c(b):c(null,{value:a,criteria:d})})},function(a,b){if(a)return c(a);c(null,m(b.sort(d),function(a){return a.value}))})},O.auto=function(a,b,c){function d(a){r.unshift(a)}function f(a){var b=q(r,a);b>=0&&r.splice(b,1)}function g(){i--,l(r.slice(0),function(a){a()})}"function"==typeof arguments[1]&&(c=b,b=null),c=j(c||e);var h=T(a),i=h.length;if(!i)return c(null);b||(b=i);var k={},m=0,n=!1,r=[];d(function(){i||c(null,k)}),l(h,function(e){function h(){return m<b&&o(t,function(a,b){return a&&k.hasOwnProperty(b)},!0)&&!k.hasOwnProperty(e)}function i(){h()&&(m++,f(i),l[l.length-1](r,k))}if(!n){for(var j,l=R(a[e])?a[e]:[a[e]],r=s(function(a,b){if(m--,b.length<=1&&(b=b[0]),a){var d={};p(k,function(a,b){d[b]=a}),d[e]=b,n=!0,c(a,d)}else k[e]=b,O.setImmediate(g)}),t=l.slice(0,l.length-1),u=t.length;u--;){if(!(j=a[t[u]]))throw new Error("Has nonexistent dependency in "+t.join(", "));if(R(j)&&q(j,e)>=0)throw new Error("Has cyclic dependencies")}h()?(m++,l[l.length-1](r,k)):d(i)}})},O.retry=function(a,b,c){function d(a,b){for(;h.times;){var c=!(h.times-=1);g.push(function(a,c){return function(d){a(function(a,b){d(!a||c,{err:a,result:b})},b)}}(h.task,c)),!c&&h.interval>0&&g.push(function(a){return function(b){setTimeout(function(){b(null)},a)}}(h.interval))}O.series(g,function(b,c){c=c[c.length-1],(a||h.callback)(c.err,c.result)})}var e=5,f=0,g=[],h={times:e,interval:f},i=arguments.length;if(i<1||i>3)throw new Error("Invalid arguments - must be either (task), (task, callback), (times, task) or (times, task, callback)");return i<=2&&"function"==typeof a&&(c=b,b=a),"function"!=typeof a&&function(a,b){if("number"==typeof b)a.times=parseInt(b,10)||e;else{if("object"!==(void 0===b?"undefined":(0,y.default)(b)))throw new Error("Unsupported argument type for 'times': "+(void 0===b?"undefined":(0,y.default)(b)));a.times=parseInt(b.times,10)||e,a.interval=parseInt(b.interval,10)||f}}(h,a),h.callback=c,h.task=b,h.callback?d():d},O.waterfall=function(a,b){function c(a){return s(function(d,e){if(d)b.apply(null,[d].concat(e));else{var f=a.next();f?e.push(c(f)):e.push(b),M(a).apply(null,e)}})}if(b=j(b||e),!R(a)){var d=new Error("First argument to waterfall must be an array of functions");return b(d)}if(!a.length)return b();c(O.iterator(a))()},O.parallel=function(a,b){G(O.eachOf,a,b)},O.parallelLimit=function(a,b,c){G(v(b),a,c)},O.series=function(a,b){G(O.eachOfSeries,a,b)},O.iterator=function(a){function b(c){function d(){return a.length&&a[c].apply(null,arguments),d.next()}return d.next=function(){return c<a.length-1?b(c+1):null},d}return b(0)},O.apply=s(function(a,b){return s(function(c){return a.apply(null,b.concat(c))})}),O.concat=x(H),O.concatSeries=A(H),O.whilst=function(a,b,c){if(c=c||e,a()){var d=s(function(e,f){e?c(e):a.apply(this,f)?b(d):c.apply(null,[null].concat(f))});b(d)}else c(null)},O.doWhilst=function(a,b,c){var d=0;return O.whilst(function(){return++d<=1||b.apply(this,arguments)},a,c)},O.until=function(a,b,c){return O.whilst(function(){return!a.apply(this,arguments)},b,c)},O.doUntil=function(a,b,c){return O.doWhilst(a,function(){return!b.apply(this,arguments)},c)},O.during=function(a,b,c){c=c||e;var d=s(function(b,d){b?c(b):(d.push(f),a.apply(this,d))}),f=function(a,e){a?c(a):e?b(d):c(null)};a(f)},O.doDuring=function(a,b,c){var d=0;O.during(function(a){d++<1?a(null,!0):b.apply(this,arguments)},a,c)},O.queue=function(a,b){return I(function(b,c){a(b[0],c)},b,1)},O.priorityQueue=function(a,b){function c(a,b){return a.priority-b.priority}function d(a,b,c){for(var d=-1,e=a.length-1;d<e;){var f=d+(e-d+1>>>1);c(b,a[f])>=0?d=f:e=f-1}return d}function f(a,b,f,g){if(null!=g&&"function"!=typeof g)throw new Error("task callback must be a function");if(a.started=!0,R(b)||(b=[b]),0===b.length)return O.setImmediate(function(){a.drain()});l(b,function(b){var h={data:b,priority:f,callback:"function"==typeof g?g:e};a.tasks.splice(d(a.tasks,h,c)+1,0,h),a.tasks.length===a.concurrency&&a.saturated(),O.setImmediate(a.process)})}var g=O.queue(a,b);return g.push=function(a,b,c){f(g,a,b,c)},delete g.unshift,g},O.cargo=function(a,b){return I(a,1,b)},O.log=J("log"),O.dir=J("dir"),O.memoize=function(a,b){var c={},d={},e=Object.prototype.hasOwnProperty;b=b||f;var g=s(function(f){var g=f.pop(),h=b.apply(null,f);e.call(c,h)?O.setImmediate(function(){g.apply(null,c[h])}):e.call(d,h)?d[h].push(g):(d[h]=[g],a.apply(null,f.concat([s(function(a){c[h]=a;var b=d[h];delete d[h];for(var e=0,f=b.length;e<f;e++)b[e].apply(null,a)})])))});return g.memo=c,g.unmemoized=a,g},O.unmemoize=function(a){return function(){return(a.unmemoized||a).apply(null,arguments)}},O.times=K(O.map),O.timesSeries=K(O.mapSeries),O.timesLimit=function(a,b,c,d){return O.mapLimit(n(a),b,c,d)},O.seq=function(){var a=arguments;return s(function(b){var c=this,d=b[b.length-1];"function"==typeof d?b.pop():d=e,O.reduce(a,b,function(a,b,d){b.apply(c,a.concat([s(function(a,b){d(a,b)})]))},function(a,b){d.apply(c,[a].concat(b))})})},O.compose=function(){return O.seq.apply(null,Array.prototype.reverse.call(arguments))},O.applyEach=L(O.eachOf),O.applyEachSeries=L(O.eachOfSeries),O.forever=function(a,b){function c(a){if(a)return d(a);f(c)}var d=i(b||e),f=M(a);c()},O.ensureAsync=M,O.constant=s(function(a){var b=[null].concat(a);return function(a){return a.apply(this,b)}}),O.wrapSync=O.asyncify=function(a){return s(function(b){var c,d=b.pop();try{c=a.apply(this,b)}catch(e){return d(e)}S(c)&&"function"==typeof c.then?c.then(function(a){d(null,a)}).catch(function(a){d(a.message?a:new Error(a))}):d(null,c)})},"object"===(void 0===c?"undefined":(0,y.default)(c))&&c.exports?c.exports=O:"function"==typeof a&&a.amd?a([],function(){return O}):P.async=O}()}).call(this,b("_process"),void 0!==d?d:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:3}],2:[function(a,b,c){(function(a){function b(a,b){for(var c=0,d=a.length-1;d>=0;d--){var e=a[d];"."===e?a.splice(d,1):".."===e?(a.splice(d,1),c++):c&&(a.splice(d,1),c--)}if(b)for(;c--;c)a.unshift("..");return a}function d(a,b){if(a.filter)return a.filter(b);for(var c=[],d=0;d<a.length;d++)b(a[d],d,a)&&c.push(a[d]);return c}var e=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,f=function(a){return e.exec(a).slice(1)};c.resolve=function(){for(var c="",e=!1,f=arguments.length-1;f>=-1&&!e;f--){var g=f>=0?arguments[f]:a.cwd();if("string"!=typeof g)throw new TypeError("Arguments to path.resolve must be strings");g&&(c=g+"/"+c,e="/"===g.charAt(0))}return c=b(d(c.split("/"),function(a){return!!a}),!e).join("/"),(e?"/":"")+c||"."},c.normalize=function(a){var e=c.isAbsolute(a),f="/"===g(a,-1);return a=b(d(a.split("/"),function(a){return!!a}),!e).join("/"),a||e||(a="."),a&&f&&(a+="/"),(e?"/":"")+a},c.isAbsolute=function(a){return"/"===a.charAt(0)},c.join=function(){var a=Array.prototype.slice.call(arguments,0);return c.normalize(d(a,function(a,b){if("string"!=typeof a)throw new TypeError("Arguments to path.join must be strings");return a}).join("/"))},c.relative=function(a,b){function d(a){for(var b=0;b<a.length&&""===a[b];b++);for(var c=a.length-1;c>=0&&""===a[c];c--);return b>c?[]:a.slice(b,c-b+1)}a=c.resolve(a).substr(1),b=c.resolve(b).substr(1);for(var e=d(a.split("/")),f=d(b.split("/")),g=Math.min(e.length,f.length),h=g,i=0;i<g;i++)if(e[i]!==f[i]){h=i;break}for(var j=[],i=h;i<e.length;i++)j.push("..");return j=j.concat(f.slice(h)),j.join("/")},c.sep="/",c.delimiter=":",c.dirname=function(a){var b=f(a),c=b[0],d=b[1];return c||d?(d&&(d=d.substr(0,d.length-1)),c+d):"."},c.basename=function(a,b){var c=f(a)[2];return b&&c.substr(-1*b.length)===b&&(c=c.substr(0,c.length-b.length)),c},c.extname=function(a){return f(a)[3]};var g="b"==="ab".substr(-1)?function(a,b,c){return a.substr(b,c)}:function(a,b,c){return b<0&&(b=a.length+b),a.substr(b,c)}}).call(this,a("_process"))},{_process:3}],3:[function(a,b,c){function d(){k=!1,h.length?j=h.concat(j):l=-1,j.length&&e()}function e(){if(!k){var a=setTimeout(d);k=!0;for(var b=j.length;b;){for(h=j,j=[];++l<b;)h&&h[l].run();l=-1,b=j.length}h=null,k=!1,clearTimeout(a)}}function f(a,b){this.fun=a,this.array=b}function g(){}var h,i=b.exports={},j=[],k=!1,l=-1;i.nextTick=function(a){var b=new Array(arguments.length-1);if(arguments.length>1)for(var c=1;c<arguments.length;c++)b[c-1]=arguments[c];j.push(new f(a,b)),1!==j.length||k||setTimeout(e,0)},f.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.binding=function(a){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(a){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],4:[function(b,c,e){(function(b){!function(d){function f(a){throw new RangeError(J[a])}function g(a,b){for(var c=a.length,d=[];c--;)d[c]=b(a[c]);return d}function h(a,b){var c=a.split("@"),d="";return c.length>1&&(d=c[0]+"@",a=c[1]),a=a.replace(I,"."),d+g(a.split("."),b).join(".")}function i(a){for(var b,c,d=[],e=0,f=a.length;e<f;)b=a.charCodeAt(e++),b>=55296&&b<=56319&&e<f?(c=a.charCodeAt(e++),56320==(64512&c)?d.push(((1023&b)<<10)+(1023&c)+65536):(d.push(b),e--)):d.push(b);return d}function j(a){return g(a,function(a){var b="";return a>65535&&(a-=65536,b+=M(a>>>10&1023|55296),a=56320|1023&a),b+=M(a)}).join("")}function k(a){return a-48<10?a-22:a-65<26?a-65:a-97<26?a-97:x}function l(a,b){return a+22+75*(a<26)-((0!=b)<<5)}function m(a,b,c){var d=0;for(a=c?L(a/C):a>>1,a+=L(a/b);a>K*A>>1;d+=x)a=L(a/K);return L(d+(K+1)*a/(a+B))}function n(a){var b,c,d,e,g,h,i,l,n,o,p=[],q=a.length,r=0,s=E,t=D;for(c=a.lastIndexOf(F),c<0&&(c=0),d=0;d<c;++d)a.charCodeAt(d)>=128&&f("not-basic"),p.push(a.charCodeAt(d));for(e=c>0?c+1:0;e<q;){for(g=r,h=1,i=x;e>=q&&f("invalid-input"),l=k(a.charCodeAt(e++)),(l>=x||l>L((w-r)/h))&&f("overflow"),r+=l*h,n=i<=t?z:i>=t+A?A:i-t,!(l<n);i+=x)o=x-n,h>L(w/o)&&f("overflow"),h*=o;b=p.length+1,t=m(r-g,b,0==g),L(r/b)>w-s&&f("overflow"),s+=L(r/b),r%=b,p.splice(r++,0,s)}return j(p)}function o(a){var b,c,d,e,g,h,j,k,n,o,p,q,r,s,t,u=[];for(a=i(a),q=a.length,b=E,c=0,g=D,h=0;h<q;++h)(p=a[h])<128&&u.push(M(p));for(d=e=u.length,e&&u.push(F);d<q;){for(j=w,h=0;h<q;++h)(p=a[h])>=b&&p<j&&(j=p);for(r=d+1,j-b>L((w-c)/r)&&f("overflow"),c+=(j-b)*r,b=j,h=0;h<q;++h)if(p=a[h],p<b&&++c>w&&f("overflow"),p==b){for(k=c,n=x;o=n<=g?z:n>=g+A?A:n-g,!(k<o);n+=x)t=k-o,s=x-o,u.push(M(l(o+t%s,0))),k=L(t/s);u.push(M(l(k,0))),g=m(c,r,d==e),c=0,++d}++c,++b}return u.join("")}function p(a){return h(a,function(a){return G.test(a)?n(a.slice(4).toLowerCase()):a})}function q(a){return h(a,function(a){return H.test(a)?"xn--"+o(a):a})}var r="object"==(void 0===e?"undefined":(0,y.default)(e))&&e&&!e.nodeType&&e,s="object"==(void 0===c?"undefined":(0,y.default)(c))&&c&&!c.nodeType&&c,t="object"==(void 0===b?"undefined":(0,y.default)(b))&&b;t.global!==t&&t.window!==t&&t.self!==t||(d=t);var u,v,w=2147483647,x=36,z=1,A=26,B=38,C=700,D=72,E=128,F="-",G=/^xn--/,H=/[^\x20-\x7E]/,I=/[\x2E\u3002\uFF0E\uFF61]/g,J={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},K=x-z,L=Math.floor,M=String.fromCharCode;if(u={version:"1.3.2",ucs2:{decode:i,encode:j},decode:n,encode:o,toASCII:q,toUnicode:p},"function"==typeof a&&"object"==(0,y.default)(a.amd)&&a.amd)a("punycode",function(){return u});else if(r&&s)if(c.exports==r)s.exports=u;else for(v in u)u.hasOwnProperty(v)&&(r[v]=u[v]);else d.punycode=u;
}(this)}).call(this,void 0!==d?d:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],5:[function(a,b,c){function d(a,b){return Object.prototype.hasOwnProperty.call(a,b)}b.exports=function(a,b,c,f){b=b||"&",c=c||"=";var g={};if("string"!=typeof a||0===a.length)return g;var h=/\+/g;a=a.split(b);var i=1e3;f&&"number"==typeof f.maxKeys&&(i=f.maxKeys);var j=a.length;i>0&&j>i&&(j=i);for(var k=0;k<j;++k){var l,m,n,o,p=a[k].replace(h,"%20"),q=p.indexOf(c);q>=0?(l=p.substr(0,q),m=p.substr(q+1)):(l=p,m=""),n=decodeURIComponent(l),o=decodeURIComponent(m),d(g,n)?e(g[n])?g[n].push(o):g[n]=[g[n],o]:g[n]=o}return g};var e=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)}},{}],6:[function(a,b,c){function d(a,b){if(a.map)return a.map(b);for(var c=[],d=0;d<a.length;d++)c.push(b(a[d],d));return c}var e=function(a){switch(void 0===a?"undefined":(0,y.default)(a)){case"string":return a;case"boolean":return a?"true":"false";case"number":return isFinite(a)?a:"";default:return""}};b.exports=function(a,b,c,h){return b=b||"&",c=c||"=",null===a&&(a=void 0),"object"===(void 0===a?"undefined":(0,y.default)(a))?d(g(a),function(g){var h=encodeURIComponent(e(g))+c;return f(a[g])?d(a[g],function(a){return h+encodeURIComponent(e(a))}).join(b):h+encodeURIComponent(e(a[g]))}).join(b):h?encodeURIComponent(e(h))+c+encodeURIComponent(e(a)):""};var f=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},g=w.default||function(a){var b=[];for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&b.push(c);return b}},{}],7:[function(a,b,c){c.decode=c.parse=a("./decode"),c.encode=c.stringify=a("./encode")},{"./decode":5,"./encode":6}],8:[function(a,b,c){function d(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function e(a,b,c){if(a&&j(a)&&a instanceof d)return a;var e=new d;return e.parse(a,b,c),e}function f(a){return i(a)&&(a=e(a)),a instanceof d?a.format():d.prototype.format.call(a)}function g(a,b){return e(a,!1,!0).resolve(b)}function h(a,b){return a?e(a,!1,!0).resolveObject(b):b}function i(a){return"string"==typeof a}function j(a){return"object"===(void 0===a?"undefined":(0,y.default)(a))&&null!==a}function k(a){return null===a}function l(a){return null==a}var m=a("punycode");c.parse=e,c.resolve=g,c.resolveObject=h,c.format=f,c.Url=d;var n=/^([a-z0-9.+-]+:)/i,o=/:[0-9]*$/,p=["<",">",'"',"`"," ","\r","\n","	"],q=["{","}","|","\\","^","`"].concat(p),r=["'"].concat(q),s=["%","/","?",";","#"].concat(r),t=["/","?","#"],u=/^[a-z0-9A-Z_-]{0,63}$/,v=/^([a-z0-9A-Z_-]{0,63})(.*)$/,x={javascript:!0,"javascript:":!0},z={javascript:!0,"javascript:":!0},A={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},B=a("querystring");d.prototype.parse=function(a,b,c){if(!i(a))throw new TypeError("Parameter 'url' must be a string, not "+(void 0===a?"undefined":(0,y.default)(a)));var d=a;d=d.trim();var e=n.exec(d);if(e){e=e[0];var f=e.toLowerCase();this.protocol=f,d=d.substr(e.length)}if(c||e||d.match(/^\/\/[^@\/]+@[^@\/]+/)){var g="//"===d.substr(0,2);!g||e&&z[e]||(d=d.substr(2),this.slashes=!0)}if(!z[e]&&(g||e&&!A[e])){for(var h=-1,j=0;j<t.length;j++){var k=d.indexOf(t[j]);-1!==k&&(-1===h||k<h)&&(h=k)}var l,o;o=-1===h?d.lastIndexOf("@"):d.lastIndexOf("@",h),-1!==o&&(l=d.slice(0,o),d=d.slice(o+1),this.auth=decodeURIComponent(l)),h=-1;for(var j=0;j<s.length;j++){var k=d.indexOf(s[j]);-1!==k&&(-1===h||k<h)&&(h=k)}-1===h&&(h=d.length),this.host=d.slice(0,h),d=d.slice(h),this.parseHost(),this.hostname=this.hostname||"";var p="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!p)for(var q=this.hostname.split(/\./),j=0,w=q.length;j<w;j++){var C=q[j];if(C&&!C.match(u)){for(var D="",E=0,F=C.length;E<F;E++)C.charCodeAt(E)>127?D+="x":D+=C[E];if(!D.match(u)){var G=q.slice(0,j),H=q.slice(j+1),I=C.match(v);I&&(G.push(I[1]),H.unshift(I[2])),H.length&&(d="/"+H.join(".")+d),this.hostname=G.join(".");break}}}if(this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),!p){for(var J=this.hostname.split("."),K=[],j=0;j<J.length;++j){var L=J[j];K.push(L.match(/[^A-Za-z0-9_-]/)?"xn--"+m.encode(L):L)}this.hostname=K.join(".")}var M=this.port?":"+this.port:"",N=this.hostname||"";this.host=N+M,this.href+=this.host,p&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==d[0]&&(d="/"+d))}if(!x[f])for(var j=0,w=r.length;j<w;j++){var O=r[j],P=encodeURIComponent(O);P===O&&(P=escape(O)),d=d.split(O).join(P)}var Q=d.indexOf("#");-1!==Q&&(this.hash=d.substr(Q),d=d.slice(0,Q));var R=d.indexOf("?");if(-1!==R?(this.search=d.substr(R),this.query=d.substr(R+1),b&&(this.query=B.parse(this.query)),d=d.slice(0,R)):b&&(this.search="",this.query={}),d&&(this.pathname=d),A[f]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var M=this.pathname||"",L=this.search||"";this.path=M+L}return this.href=this.format(),this},d.prototype.format=function(){var a=this.auth||"";a&&(a=encodeURIComponent(a),a=a.replace(/%3A/i,":"),a+="@");var b=this.protocol||"",c=this.pathname||"",d=this.hash||"",e=!1,f="";this.host?e=a+this.host:this.hostname&&(e=a+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(e+=":"+this.port)),this.query&&j(this.query)&&(0,w.default)(this.query).length&&(f=B.stringify(this.query));var g=this.search||f&&"?"+f||"";return b&&":"!==b.substr(-1)&&(b+=":"),this.slashes||(!b||A[b])&&!1!==e?(e="//"+(e||""),c&&"/"!==c.charAt(0)&&(c="/"+c)):e||(e=""),d&&"#"!==d.charAt(0)&&(d="#"+d),g&&"?"!==g.charAt(0)&&(g="?"+g),c=c.replace(/[?#]/g,function(a){return encodeURIComponent(a)}),g=g.replace("#","%23"),b+e+c+g+d},d.prototype.resolve=function(a){return this.resolveObject(e(a,!1,!0)).format()},d.prototype.resolveObject=function(a){if(i(a)){var b=new d;b.parse(a,!1,!0),a=b}var c=new d;if((0,w.default)(this).forEach(function(a){c[a]=this[a]},this),c.hash=a.hash,""===a.href)return c.href=c.format(),c;if(a.slashes&&!a.protocol)return(0,w.default)(a).forEach(function(b){"protocol"!==b&&(c[b]=a[b])}),A[c.protocol]&&c.hostname&&!c.pathname&&(c.path=c.pathname="/"),c.href=c.format(),c;if(a.protocol&&a.protocol!==c.protocol){if(!A[a.protocol])return(0,w.default)(a).forEach(function(b){c[b]=a[b]}),c.href=c.format(),c;if(c.protocol=a.protocol,a.host||z[a.protocol])c.pathname=a.pathname;else{for(var e=(a.pathname||"").split("/");e.length&&!(a.host=e.shift()););a.host||(a.host=""),a.hostname||(a.hostname=""),""!==e[0]&&e.unshift(""),e.length<2&&e.unshift(""),c.pathname=e.join("/")}if(c.search=a.search,c.query=a.query,c.host=a.host||"",c.auth=a.auth,c.hostname=a.hostname||a.host,c.port=a.port,c.pathname||c.search){var f=c.pathname||"",g=c.search||"";c.path=f+g}return c.slashes=c.slashes||a.slashes,c.href=c.format(),c}var h=c.pathname&&"/"===c.pathname.charAt(0),j=a.host||a.pathname&&"/"===a.pathname.charAt(0),m=j||h||c.host&&a.pathname,n=m,o=c.pathname&&c.pathname.split("/")||[],e=a.pathname&&a.pathname.split("/")||[],p=c.protocol&&!A[c.protocol];if(p&&(c.hostname="",c.port=null,c.host&&(""===o[0]?o[0]=c.host:o.unshift(c.host)),c.host="",a.protocol&&(a.hostname=null,a.port=null,a.host&&(""===e[0]?e[0]=a.host:e.unshift(a.host)),a.host=null),m=m&&(""===e[0]||""===o[0])),j)c.host=a.host||""===a.host?a.host:c.host,c.hostname=a.hostname||""===a.hostname?a.hostname:c.hostname,c.search=a.search,c.query=a.query,o=e;else if(e.length)o||(o=[]),o.pop(),o=o.concat(e),c.search=a.search,c.query=a.query;else if(!l(a.search)){if(p){c.hostname=c.host=o.shift();var q=!!(c.host&&c.host.indexOf("@")>0)&&c.host.split("@");q&&(c.auth=q.shift(),c.host=c.hostname=q.shift())}return c.search=a.search,c.query=a.query,k(c.pathname)&&k(c.search)||(c.path=(c.pathname?c.pathname:"")+(c.search?c.search:"")),c.href=c.format(),c}if(!o.length)return c.pathname=null,c.search?c.path="/"+c.search:c.path=null,c.href=c.format(),c;for(var r=o.slice(-1)[0],s=(c.host||a.host)&&("."===r||".."===r)||""===r,t=0,u=o.length;u>=0;u--)r=o[u],"."==r?o.splice(u,1):".."===r?(o.splice(u,1),t++):t&&(o.splice(u,1),t--);if(!m&&!n)for(;t--;t)o.unshift("..");!m||""===o[0]||o[0]&&"/"===o[0].charAt(0)||o.unshift(""),s&&"/"!==o.join("/").substr(-1)&&o.push("");var v=""===o[0]||o[0]&&"/"===o[0].charAt(0);if(p){c.hostname=c.host=v?"":o.length?o.shift():"";var q=!!(c.host&&c.host.indexOf("@")>0)&&c.host.split("@");q&&(c.auth=q.shift(),c.host=c.hostname=q.shift())}return m=m||c.host&&o.length,m&&!v&&o.unshift(""),o.length?c.pathname=o.join("/"):(c.pathname=null,c.path=null),k(c.pathname)&&k(c.search)||(c.path=(c.pathname?c.pathname:"")+(c.search?c.search:"")),c.auth=a.auth||c.auth,c.slashes=c.slashes||a.slashes,c.href=c.format(),c},d.prototype.parseHost=function(){var a=this.host,b=o.exec(a);b&&(b=b[0],":"!==b&&(this.port=b.substr(1)),a=a.substr(0,a.length-b.length)),a&&(this.hostname=a)}},{punycode:4,querystring:7}],9:[function(a,b,c){function d(a,b,c){c=c||2;var d=b&&b.length,f=d?b[0]*c:a.length,h=e(a,0,f,c,!0),i=[];if(!h)return i;var j,k,m,n,o,p,q;if(d&&(h=l(a,b,h,c)),a.length>80*c){j=m=a[0],k=n=a[1];for(var r=c;r<f;r+=c)o=a[r],p=a[r+1],o<j&&(j=o),p<k&&(k=p),o>m&&(m=o),p>n&&(n=p);q=Math.max(m-j,n-k)}return g(h,i,c,j,k,q),i}function e(a,b,c,d,e){var f,g,h,i=0;for(f=b,g=c-d;f<c;f+=d)i+=(a[g]-a[f])*(a[f+1]+a[g+1]),g=f;if(e===i>0)for(f=b;f<c;f+=d)h=C(f,a[f],a[f+1],h);else for(f=c-d;f>=b;f-=d)h=C(f,a[f],a[f+1],h);return h}function f(a,b){if(!a)return a;b||(b=a);var c,d=a;do{if(c=!1,d.steiner||!w(d,d.next)&&0!==v(d.prev,d,d.next))d=d.next;else{if(D(d),(d=b=d.prev)===d.next)return null;c=!0}}while(c||d!==b);return b}function g(a,b,c,d,e,l,m){if(a){!m&&l&&p(a,d,e,l);for(var n,o,q=a;a.prev!==a.next;)if(n=a.prev,o=a.next,l?i(a,d,e,l):h(a))b.push(n.i/c),b.push(a.i/c),b.push(o.i/c),D(a),a=o.next,q=o.next;else if((a=o)===q){m?1===m?(a=j(a,b,c),g(a,b,c,d,e,l,2)):2===m&&k(a,b,c,d,e,l):g(f(a),b,c,d,e,l,1);break}}}function h(a){var b=a.prev,c=a,d=a.next;if(v(b,c,d)>=0)return!1;for(var e=a.next.next;e!==a.prev;){if(t(b.x,b.y,c.x,c.y,d.x,d.y,e.x,e.y)&&v(e.prev,e,e.next)>=0)return!1;e=e.next}return!0}function i(a,b,c,d){var e=a.prev,f=a,g=a.next;if(v(e,f,g)>=0)return!1;for(var h=e.x<f.x?e.x<g.x?e.x:g.x:f.x<g.x?f.x:g.x,i=e.y<f.y?e.y<g.y?e.y:g.y:f.y<g.y?f.y:g.y,j=e.x>f.x?e.x>g.x?e.x:g.x:f.x>g.x?f.x:g.x,k=e.y>f.y?e.y>g.y?e.y:g.y:f.y>g.y?f.y:g.y,l=r(h,i,b,c,d),m=r(j,k,b,c,d),n=a.nextZ;n&&n.z<=m;){if(n!==a.prev&&n!==a.next&&t(e.x,e.y,f.x,f.y,g.x,g.y,n.x,n.y)&&v(n.prev,n,n.next)>=0)return!1;n=n.nextZ}for(n=a.prevZ;n&&n.z>=l;){if(n!==a.prev&&n!==a.next&&t(e.x,e.y,f.x,f.y,g.x,g.y,n.x,n.y)&&v(n.prev,n,n.next)>=0)return!1;n=n.prevZ}return!0}function j(a,b,c){var d=a;do{var e=d.prev,f=d.next.next;x(e,d,d.next,f)&&z(e,f)&&z(f,e)&&(b.push(e.i/c),b.push(d.i/c),b.push(f.i/c),D(d),D(d.next),d=a=f),d=d.next}while(d!==a);return d}function k(a,b,c,d,e,h){var i=a;do{for(var j=i.next.next;j!==i.prev;){if(i.i!==j.i&&u(i,j)){var k=B(i,j);return i=f(i,i.next),k=f(k,k.next),g(i,b,c,d,e,h),void g(k,b,c,d,e,h)}j=j.next}i=i.next}while(i!==a)}function l(a,b,c,d){var g,h,i,j,k,l=[];for(g=0,h=b.length;g<h;g++)i=b[g]*d,j=g<h-1?b[g+1]*d:a.length,k=e(a,i,j,d,!1),k===k.next&&(k.steiner=!0),l.push(s(k));for(l.sort(m),g=0;g<l.length;g++)n(l[g],c),c=f(c,c.next);return c}function m(a,b){return a.x-b.x}function n(a,b){if(b=o(a,b)){var c=B(b,a);f(c,c.next)}}function o(a,b){var c,d=b,e=a.x,f=a.y,g=-1/0;do{if(f<=d.y&&f>=d.next.y){var h=d.x+(f-d.y)*(d.next.x-d.x)/(d.next.y-d.y);h<=e&&h>g&&(g=h,c=d.x<d.next.x?d:d.next)}d=d.next}while(d!==b);if(!c)return null;if(a.x===c.x)return c.prev;var i,j=c,k=1/0;for(d=c.next;d!==j;)e>=d.x&&d.x>=c.x&&t(f<c.y?e:g,f,c.x,c.y,f<c.y?g:e,f,d.x,d.y)&&((i=Math.abs(f-d.y)/(e-d.x))<k||i===k&&d.x>c.x)&&z(d,a)&&(c=d,k=i),d=d.next;return c}function p(a,b,c,d){var e=a;do{null===e.z&&(e.z=r(e.x,e.y,b,c,d)),e.prevZ=e.prev,e.nextZ=e.next,e=e.next}while(e!==a);e.prevZ.nextZ=null,e.prevZ=null,q(e)}function q(a){var b,c,d,e,f,g,h,i,j=1;do{for(c=a,a=null,f=null,g=0;c;){for(g++,d=c,h=0,b=0;b<j&&(h++,d=d.nextZ);b++);for(i=j;h>0||i>0&&d;)0===h?(e=d,d=d.nextZ,i--):0!==i&&d?c.z<=d.z?(e=c,c=c.nextZ,h--):(e=d,d=d.nextZ,i--):(e=c,c=c.nextZ,h--),f?f.nextZ=e:a=e,e.prevZ=f,f=e;c=d}f.nextZ=null,j*=2}while(g>1);return a}function r(a,b,c,d,e){return a=32767*(a-c)/e,b=32767*(b-d)/e,a=16711935&(a|a<<8),a=252645135&(a|a<<4),a=858993459&(a|a<<2),a=1431655765&(a|a<<1),b=16711935&(b|b<<8),b=252645135&(b|b<<4),b=858993459&(b|b<<2),b=1431655765&(b|b<<1),a|b<<1}function s(a){var b=a,c=a;do{b.x<c.x&&(c=b),b=b.next}while(b!==a);return c}function t(a,b,c,d,e,f,g,h){return(e-g)*(b-h)-(a-g)*(f-h)>=0&&(a-g)*(d-h)-(c-g)*(b-h)>=0&&(c-g)*(f-h)-(e-g)*(d-h)>=0}function u(a,b){return w(a,b)||a.next.i!==b.i&&a.prev.i!==b.i&&!y(a,b)&&z(a,b)&&z(b,a)&&A(a,b)}function v(a,b,c){return(b.y-a.y)*(c.x-b.x)-(b.x-a.x)*(c.y-b.y)}function w(a,b){return a.x===b.x&&a.y===b.y}function x(a,b,c,d){return v(a,b,c)>0!=v(a,b,d)>0&&v(c,d,a)>0!=v(c,d,b)>0}function y(a,b){var c=a;do{if(c.i!==a.i&&c.next.i!==a.i&&c.i!==b.i&&c.next.i!==b.i&&x(c,c.next,a,b))return!0;c=c.next}while(c!==a);return!1}function z(a,b){return v(a.prev,a,a.next)<0?v(a,b,a.next)>=0&&v(a,a.prev,b)>=0:v(a,b,a.prev)<0||v(a,a.next,b)<0}function A(a,b){var c=a,d=!1,e=(a.x+b.x)/2,f=(a.y+b.y)/2;do{c.y>f!=c.next.y>f&&e<(c.next.x-c.x)*(f-c.y)/(c.next.y-c.y)+c.x&&(d=!d),c=c.next}while(c!==a);return d}function B(a,b){var c=new E(a.i,a.x,a.y),d=new E(b.i,b.x,b.y),e=a.next,f=b.prev;return a.next=b,b.prev=a,c.next=e,e.prev=c,d.next=c,c.prev=d,f.next=d,d.prev=f,d}function C(a,b,c,d){var e=new E(a,b,c);return d?(e.next=d.next,e.prev=d,d.next.prev=e,d.next=e):(e.prev=e,e.next=e),e}function D(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function E(a,b,c){this.i=a,this.x=b,this.y=c,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}b.exports=d},{}],10:[function(a,b,c){function d(a,b,c){this.fn=a,this.context=b,this.once=c||!1}function e(){}var f="function"!=typeof s.default&&"~";e.prototype._events=void 0,e.prototype.listeners=function(a,b){var c=f?f+a:a,d=this._events&&this._events[c];if(b)return!!d;if(!d)return[];if(d.fn)return[d.fn];for(var e=0,g=d.length,h=new Array(g);e<g;e++)h[e]=d[e].fn;return h},e.prototype.emit=function(a,b,c,d,e,g){var h=f?f+a:a;if(!this._events||!this._events[h])return!1;var i,j,k=this._events[h],l=arguments.length;if("function"==typeof k.fn){switch(k.once&&this.removeListener(a,k.fn,void 0,!0),l){case 1:return k.fn.call(k.context),!0;case 2:return k.fn.call(k.context,b),!0;case 3:return k.fn.call(k.context,b,c),!0;case 4:return k.fn.call(k.context,b,c,d),!0;case 5:return k.fn.call(k.context,b,c,d,e),!0;case 6:return k.fn.call(k.context,b,c,d,e,g),!0}for(j=1,i=new Array(l-1);j<l;j++)i[j-1]=arguments[j];k.fn.apply(k.context,i)}else{var m,n=k.length;for(j=0;j<n;j++)switch(k[j].once&&this.removeListener(a,k[j].fn,void 0,!0),l){case 1:k[j].fn.call(k[j].context);break;case 2:k[j].fn.call(k[j].context,b);break;case 3:k[j].fn.call(k[j].context,b,c);break;default:if(!i)for(m=1,i=new Array(l-1);m<l;m++)i[m-1]=arguments[m];k[j].fn.apply(k[j].context,i)}}return!0},e.prototype.on=function(a,b,c){var e=new d(b,c||this),g=f?f+a:a;return this._events||(this._events=f?{}:(0,s.default)(null)),this._events[g]?this._events[g].fn?this._events[g]=[this._events[g],e]:this._events[g].push(e):this._events[g]=e,this},e.prototype.once=function(a,b,c){var e=new d(b,c||this,!0),g=f?f+a:a;return this._events||(this._events=f?{}:(0,s.default)(null)),this._events[g]?this._events[g].fn?this._events[g]=[this._events[g],e]:this._events[g].push(e):this._events[g]=e,this},e.prototype.removeListener=function(a,b,c,d){var e=f?f+a:a;if(!this._events||!this._events[e])return this;var g=this._events[e],h=[];if(b)if(g.fn)(g.fn!==b||d&&!g.once||c&&g.context!==c)&&h.push(g);else for(var i=0,j=g.length;i<j;i++)(g[i].fn!==b||d&&!g[i].once||c&&g[i].context!==c)&&h.push(g[i]);return h.length?this._events[e]=1===h.length?h[0]:h:delete this._events[e],this},e.prototype.removeAllListeners=function(a){return this._events?(a?delete this._events[f?f+a:a]:this._events=f?{}:(0,s.default)(null),this):this},e.prototype.off=e.prototype.removeListener,e.prototype.addListener=e.prototype.on,e.prototype.setMaxListeners=function(){return this},e.prefixed=f,void 0!==b&&(b.exports=e)},{}],11:[function(a,b,c){function d(a){if(null===a||void 0===a)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(a)}var e=Object.prototype.hasOwnProperty,f=Object.prototype.propertyIsEnumerable;b.exports=q.default||function(a,b){for(var c,g,h=d(a),i=1;i<arguments.length;i++){c=Object(arguments[i]);for(var j in c)e.call(c,j)&&(h[j]=c[j]);if(o.default){g=(0,o.default)(c);for(var k=0;k<g.length;k++)f.call(c,g[k])&&(h[g[k]]=c[g[k]])}}return h}},{}],12:[function(b,c,d){(function(b){!function(){function d(a){var b=!1;return function(){if(b)throw new Error("Callback was already called.");b=!0,a.apply(e,arguments)}}var e,f,g={};e=this,null!=e&&(f=e.async),g.noConflict=function(){return e.async=f,g};var h=Object.prototype.toString,i=Array.isArray||function(a){return"[object Array]"===h.call(a)},j=function(a,b){for(var c=0;c<a.length;c+=1)b(a[c],c,a)},k=function(a,b){if(a.map)return a.map(b);var c=[];return j(a,function(a,d,e){c.push(b(a,d,e))}),c},l=function(a,b,c){return a.reduce?a.reduce(b,c):(j(a,function(a,d,e){c=b(c,a,d,e)}),c)},m=function(a){if(w.default)return(0,w.default)(a);var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b};void 0!==b&&b.nextTick?(g.nextTick=b.nextTick,void 0!==u.default?g.setImmediate=function(a){(0,u.default)(a)}:g.setImmediate=g.nextTick):"function"==typeof u.default?(g.nextTick=function(a){(0,u.default)(a)},g.setImmediate=g.nextTick):(g.nextTick=function(a){setTimeout(a,0)},g.setImmediate=g.nextTick),g.each=function(a,b,c){function e(b){b?(c(b),c=function(){}):(f+=1)>=a.length&&c()}if(c=c||function(){},!a.length)return c();var f=0;j(a,function(a){b(a,d(e))})},g.forEach=g.each,g.eachSeries=function(a,b,c){if(c=c||function(){},!a.length)return c();var d=0;!function e(){b(a[d],function(b){b?(c(b),c=function(){}):(d+=1,d>=a.length?c():e())})}()},g.forEachSeries=g.eachSeries,g.eachLimit=function(a,b,c,d){n(b).apply(null,[a,c,d])},g.forEachLimit=g.eachLimit;var n=function(a){return function(b,c,d){if(d=d||function(){},!b.length||a<=0)return d();var e=0,f=0,g=0;!function h(){if(e>=b.length)return d();for(;g<a&&f<b.length;)f+=1,g+=1,c(b[f-1],function(a){a?(d(a),d=function(){}):(e+=1,g-=1,e>=b.length?d():h())})}()}},o=function(a){return function(){var b=Array.prototype.slice.call(arguments);return a.apply(null,[g.each].concat(b))}},p=function(a,b){return function(){var c=Array.prototype.slice.call(arguments);return b.apply(null,[n(a)].concat(c))}},q=function(a){return function(){var b=Array.prototype.slice.call(arguments);return a.apply(null,[g.eachSeries].concat(b))}},r=function(a,b,c,d){if(b=k(b,function(a,b){return{index:b,value:a}}),d){var e=[];a(b,function(a,b){c(a.value,function(c,d){e[a.index]=d,b(c)})},function(a){d(a,e)})}else a(b,function(a,b){c(a.value,function(a){b(a)})})};g.map=o(r),g.mapSeries=q(r),g.mapLimit=function(a,b,c,d){return s(b)(a,c,d)};var s=function(a){return p(a,r)};g.reduce=function(a,b,c,d){g.eachSeries(a,function(a,d){c(b,a,function(a,c){b=c,d(a)})},function(a){d(a,b)})},g.inject=g.reduce,g.foldl=g.reduce,g.reduceRight=function(a,b,c,d){var e=k(a,function(a){return a}).reverse();g.reduce(e,b,c,d)},g.foldr=g.reduceRight;var t=function(a,b,c,d){var e=[];b=k(b,function(a,b){return{index:b,value:a}}),a(b,function(a,b){c(a.value,function(c){c&&e.push(a),b()})},function(a){d(k(e.sort(function(a,b){return a.index-b.index}),function(a){return a.value}))})};g.filter=o(t),g.filterSeries=q(t),g.select=g.filter,g.selectSeries=g.filterSeries;var v=function(a,b,c,d){var e=[];b=k(b,function(a,b){return{index:b,value:a}}),a(b,function(a,b){c(a.value,function(c){c||e.push(a),b()})},function(a){d(k(e.sort(function(a,b){return a.index-b.index}),function(a){return a.value}))})};g.reject=o(v),g.rejectSeries=q(v);var x=function(a,b,c,d){a(b,function(a,b){c(a,function(c){c?(d(a),d=function(){}):b()})},function(a){d()})};g.detect=o(x),g.detectSeries=q(x),g.some=function(a,b,c){g.each(a,function(a,d){b(a,function(a){a&&(c(!0),c=function(){}),d()})},function(a){c(!1)})},g.any=g.some,g.every=function(a,b,c){g.each(a,function(a,d){b(a,function(a){a||(c(!1),c=function(){}),d()})},function(a){c(!0)})},g.all=g.every,g.sortBy=function(a,b,c){g.map(a,function(a,c){b(a,function(b,d){b?c(b):c(null,{value:a,criteria:d})})},function(a,b){if(a)return c(a);var d=function(a,b){var c=a.criteria,d=b.criteria;return c<d?-1:c>d?1:0};c(null,k(b.sort(d),function(a){return a.value}))})},g.auto=function(a,b){b=b||function(){};var c=m(a),d=c.length;if(!d)return b();var e={},f=[],h=function(a){f.unshift(a)},k=function(a){for(var b=0;b<f.length;b+=1)if(f[b]===a)return void f.splice(b,1)},n=function(){d--,j(f.slice(0),function(a){a()})};h(function(){if(!d){var a=b;b=function(){},a(null,e)}}),j(c,function(c){var d=i(a[c])?a[c]:[a[c]],f=function(a){var d=Array.prototype.slice.call(arguments,1);if(d.length<=1&&(d=d[0]),a){var f={};j(m(e),function(a){f[a]=e[a]}),f[c]=d,b(a,f),b=function(){}}else e[c]=d,g.setImmediate(n)},o=d.slice(0,Math.abs(d.length-1))||[],p=function(){return l(o,function(a,b){return a&&e.hasOwnProperty(b)},!0)&&!e.hasOwnProperty(c)};if(p())d[d.length-1](f,e);else{h(function q(){p()&&(k(q),d[d.length-1](f,e))})}})},g.retry=function(a,b,c){var d=[];"function"==typeof a&&(c=b,b=a,a=5),a=parseInt(a,10)||5;var e=function(e,f){for(;a;)d.push(function(a,b){return function(c){a(function(a,d){c(!a||b,{err:a,result:d})},f)}}(b,!(a-=1)));g.series(d,function(a,b){b=b[b.length-1],(e||c)(b.err,b.result)})};return c?e():e},g.waterfall=function(a,b){if(b=b||function(){},!i(a)){var c=new Error("First argument to waterfall must be an array of functions");return b(c)}if(!a.length)return b();!function d(a){return function(c){if(c)b.apply(null,arguments),b=function(){};else{var e=Array.prototype.slice.call(arguments,1),f=a.next();f?e.push(d(f)):e.push(b),g.setImmediate(function(){a.apply(null,e)})}}}(g.iterator(a))()};var y=function(a,b,c){if(c=c||function(){},i(b))a.map(b,function(a,b){a&&a(function(a){var c=Array.prototype.slice.call(arguments,1);c.length<=1&&(c=c[0]),b.call(null,a,c)})},c);else{var d={};a.each(m(b),function(a,c){b[a](function(b){var e=Array.prototype.slice.call(arguments,1);e.length<=1&&(e=e[0]),d[a]=e,c(b)})},function(a){c(a,d)})}};g.parallel=function(a,b){y({map:g.map,each:g.each},a,b)},g.parallelLimit=function(a,b,c){y({map:s(b),each:n(b)},a,c)},g.series=function(a,b){if(b=b||function(){},i(a))g.mapSeries(a,function(a,b){a&&a(function(a){var c=Array.prototype.slice.call(arguments,1);c.length<=1&&(c=c[0]),b.call(null,a,c)})},b);else{var c={};g.eachSeries(m(a),function(b,d){a[b](function(a){var e=Array.prototype.slice.call(arguments,1);e.length<=1&&(e=e[0]),c[b]=e,d(a)})},function(a){b(a,c)})}},g.iterator=function(a){return function b(c){var d=function e(){return a.length&&a[c].apply(null,arguments),e.next()};return d.next=function(){return c<a.length-1?b(c+1):null},d}(0)},g.apply=function(a){var b=Array.prototype.slice.call(arguments,1);return function(){return a.apply(null,b.concat(Array.prototype.slice.call(arguments)))}};var z=function(a,b,c,d){var e=[];a(b,function(a,b){c(a,function(a,c){e=e.concat(c||[]),b(a)})},function(a){d(a,e)})};g.concat=o(z),g.concatSeries=q(z),g.whilst=function(a,b,c){a()?b(function(d){if(d)return c(d);g.whilst(a,b,c)}):c()},g.doWhilst=function(a,b,c){a(function(d){if(d)return c(d);var e=Array.prototype.slice.call(arguments,1);b.apply(null,e)?g.doWhilst(a,b,c):c()})},g.until=function(a,b,c){a()?c():b(function(d){if(d)return c(d);g.until(a,b,c)})},g.doUntil=function(a,b,c){a(function(d){if(d)return c(d);var e=Array.prototype.slice.call(arguments,1);b.apply(null,e)?c():g.doUntil(a,b,c)})},g.queue=function(a,b){function c(a,b,c,d){if(a.started||(a.started=!0),i(b)||(b=[b]),0==b.length)return g.setImmediate(function(){a.drain&&a.drain()});j(b,function(b){var e={data:b,callback:"function"==typeof d?d:null};c?a.tasks.unshift(e):a.tasks.push(e),a.saturated&&a.tasks.length===a.concurrency&&a.saturated(),g.setImmediate(a.process)})}void 0===b&&(b=1);var e=0,f={tasks:[],concurrency:b,saturated:null,empty:null,drain:null,started:!1,paused:!1,push:function(a,b){c(f,a,!1,b)},kill:function(){f.drain=null,f.tasks=[]},unshift:function(a,b){c(f,a,!0,b)},process:function(){if(!f.paused&&e<f.concurrency&&f.tasks.length){var b=f.tasks.shift();f.empty&&0===f.tasks.length&&f.empty(),e+=1;var c=function(){e-=1,b.callback&&b.callback.apply(b,arguments),f.drain&&f.tasks.length+e===0&&f.drain(),f.process()},g=d(c);a(b.data,g)}},length:function(){return f.tasks.length},running:function(){return e},idle:function(){return f.tasks.length+e===0},pause:function(){!0!==f.paused&&(f.paused=!0)},resume:function(){if(!1!==f.paused){f.paused=!1;for(var a=1;a<=f.concurrency;a++)g.setImmediate(f.process)}}};return f},g.priorityQueue=function(a,b){function c(a,b){return a.priority-b.priority}function d(a,b,c){for(var d=-1,e=a.length-1;d<e;){var f=d+(e-d+1>>>1);c(b,a[f])>=0?d=f:e=f-1}return d}function e(a,b,e,f){if(a.started||(a.started=!0),i(b)||(b=[b]),0==b.length)return g.setImmediate(function(){a.drain&&a.drain()});j(b,function(b){var h={data:b,priority:e,callback:"function"==typeof f?f:null};a.tasks.splice(d(a.tasks,h,c)+1,0,h),a.saturated&&a.tasks.length===a.concurrency&&a.saturated(),g.setImmediate(a.process)})}var f=g.queue(a,b);return f.push=function(a,b,c){e(f,a,b,c)},delete f.unshift,f},g.cargo=function(a,b){var c=!1,d=[],e={tasks:d,payload:b,saturated:null,empty:null,drain:null,drained:!0,push:function(a,c){i(a)||(a=[a]),j(a,function(a){d.push({data:a,callback:"function"==typeof c?c:null}),e.drained=!1,e.saturated&&d.length===b&&e.saturated()}),g.setImmediate(e.process)},process:function f(){if(!c){if(0===d.length)return e.drain&&!e.drained&&e.drain(),void(e.drained=!0);var g="number"==typeof b?d.splice(0,b):d.splice(0,d.length),h=k(g,function(a){return a.data});e.empty&&e.empty(),c=!0,a(h,function(){c=!1;var a=arguments;j(g,function(b){b.callback&&b.callback.apply(null,a)}),f()})}},length:function(){return d.length},running:function(){return c}};return e};var A=function(a){return function(b){var c=Array.prototype.slice.call(arguments,1);b.apply(null,c.concat([function(b){var c=Array.prototype.slice.call(arguments,1);"undefined"!=typeof console&&(b?console.error&&void 0:console[a]&&j(c,function(a){void 0}))}]))}};g.log=A("log"),g.dir=A("dir"),g.memoize=function(a,b){var c={},d={};b=b||function(a){return a};var e=function(){var e=Array.prototype.slice.call(arguments),f=e.pop(),h=b.apply(null,e);h in c?g.nextTick(function(){f.apply(null,c[h])}):h in d?d[h].push(f):(d[h]=[f],a.apply(null,e.concat([function(){c[h]=arguments;var a=d[h];delete d[h];for(var b=0,e=a.length;b<e;b++)a[b].apply(null,arguments)}])))};return e.memo=c,e.unmemoized=a,e},g.unmemoize=function(a){return function(){return(a.unmemoized||a).apply(null,arguments)}},g.times=function(a,b,c){for(var d=[],e=0;e<a;e++)d.push(e);return g.map(d,b,c)},g.timesSeries=function(a,b,c){for(var d=[],e=0;e<a;e++)d.push(e);return g.mapSeries(d,b,c)},g.seq=function(){var a=arguments;return function(){var b=this,c=Array.prototype.slice.call(arguments),d=c.pop();g.reduce(a,c,function(a,c,d){c.apply(b,a.concat([function(){var a=arguments[0],b=Array.prototype.slice.call(arguments,1);d(a,b)}]))},function(a,c){d.apply(b,[a].concat(c))})}},g.compose=function(){return g.seq.apply(null,Array.prototype.reverse.call(arguments))};var B=function(a,b){var c=function(){var c=this,d=Array.prototype.slice.call(arguments),e=d.pop();return a(b,function(a,b){a.apply(c,d.concat([b]))},e)};if(arguments.length>2){return c.apply(this,Array.prototype.slice.call(arguments,2))}return c};g.applyEach=o(B),g.applyEachSeries=q(B),g.forever=function(a,b){function c(d){if(d){if(b)return b(d);throw d}a(c)}c()},void 0!==c&&c.exports?c.exports=g:void 0!==a&&a.amd?a([],function(){return g}):e.async=g}()}).call(this,b("_process"))},{_process:3}],13:[function(a,b,c){function d(a,b){h.call(this),b=b||10,this.baseUrl=a||"",this.progress=0,this.loading=!1,this._progressChunk=0,this._beforeMiddleware=[],this._afterMiddleware=[],this._boundLoadResource=this._loadResource.bind(this),this._boundOnLoad=this._onLoad.bind(this),this._buffer=[],this._numToLoad=0,this._queue=e.queue(this._boundLoadResource,b),this.resources={}}var e=a("async"),f=a("url"),g=a("./Resource"),h=a("eventemitter3");d.prototype=(0,s.default)(h.prototype),d.prototype.constructor=d,b.exports=d,d.prototype.add=d.prototype.enqueue=function(a,b,c,d){if(Array.isArray(a)){for(var e=0;e<a.length;++e)this.add(a[e]);return this}if("object"===(void 0===a?"undefined":(0,y.default)(a))&&(d=b||a.callback||a.onComplete,c=a,b=a.url,a=a.name||a.key||a.url),"string"!=typeof b&&(d=c,c=b,b=a),"string"!=typeof b)throw new Error("No url passed to add resource to loader.");if("function"==typeof c&&(d=c,c=null),this.resources[a])throw new Error('Resource with name "'+a+'" already exists.');return b=this._handleBaseUrl(b),this.resources[a]=new g(a,b,c),"function"==typeof d&&this.resources[a].once("afterMiddleware",d),this._numToLoad++,this._queue.started?(this._queue.push(this.resources[a]),this._progressChunk=(100-this.progress)/(this._queue.length()+this._queue.running())):(this._buffer.push(this.resources[a]),this._progressChunk=100/this._buffer.length),this},d.prototype._handleBaseUrl=function(a){var b=f.parse(a);return b.protocol||0===b.pathname.indexOf("//")?a:this.baseUrl.length&&this.baseUrl.lastIndexOf("/")!==this.baseUrl.length-1&&"/"!==a.charAt(0)?this.baseUrl+"/"+a:this.baseUrl+a},d.prototype.before=d.prototype.pre=function(a){return this._beforeMiddleware.push(a),this},d.prototype.after=d.prototype.use=function(a){return this._afterMiddleware.push(a),this},d.prototype.reset=function(){this.progress=0,this.loading=!1,this._progressChunk=0,this._buffer.length=0,this._numToLoad=0,this._queue.kill(),this._queue.started=!1,this.resources={}},d.prototype.load=function(a){if("function"==typeof a&&this.once("complete",a),this._queue.started)return this;this.emit("start",this);for(var b=0;b<this._buffer.length;++b)this._queue.push(this._buffer[b]);return this._buffer.length=0,this},d.prototype._loadResource=function(a,b){var c=this;a._dequeue=b,this._runMiddleware(a,this._beforeMiddleware,function(){a.load(c._boundOnLoad)})},d.prototype._onComplete=function(){this.emit("complete",this,this.resources)},d.prototype._onLoad=function(a){this.progress+=this._progressChunk,this.emit("progress",this,a),this._runMiddleware(a,this._afterMiddleware,function(){a.emit("afterMiddleware",a),this._numToLoad--,0===this._numToLoad&&(this.progress=100,this._onComplete()),a.error?this.emit("error",a.error,this,a):this.emit("load",this,a)}),a._dequeue()},d.prototype._runMiddleware=function(a,b,c){var d=this;e.eachSeries(b,function(b,c){b.call(d,a,c)},c.bind(this,a))},d.LOAD_TYPE=g.LOAD_TYPE,d.XHR_READY_STATE=g.XHR_READY_STATE,d.XHR_RESPONSE_TYPE=g.XHR_RESPONSE_TYPE},{"./Resource":14,async:12,eventemitter3:10,url:8}],14:[function(a,b,c){function d(a,b,c){if(g.call(this),c=c||{},"string"!=typeof a||"string"!=typeof b)throw new Error("Both name and url are required for constructing a resource.");this.name=a,this.url=b,this.isDataUrl=0===this.url.indexOf("data:"),this.data=null,this.crossOrigin=!0===c.crossOrigin?"anonymous":c.crossOrigin,this.loadType=c.loadType||this._determineLoadType(),this.xhrType=c.xhrType,this.metadata=c.metadata||{},this.error=null,this.xhr=null,this.isJson=!1,this.isXml=!1,this.isImage=!1,this.isAudio=!1,this.isVideo=!1,this._dequeue=null,this._boundComplete=this.complete.bind(this),this._boundOnError=this._onError.bind(this),this._boundOnProgress=this._onProgress.bind(this),
this._boundXhrOnError=this._xhrOnError.bind(this),this._boundXhrOnAbort=this._xhrOnAbort.bind(this),this._boundXhrOnLoad=this._xhrOnLoad.bind(this),this._boundXdrOnTimeout=this._xdrOnTimeout.bind(this)}function e(a){return a.toString().replace("object ","")}function f(a,b,c){b&&0===b.indexOf(".")&&(b=b.substring(1)),b&&(a[b]=c)}var g=a("eventemitter3"),h=a("url"),i=!(!window.XDomainRequest||"withCredentials"in new XMLHttpRequest),j=null;d.prototype=(0,s.default)(g.prototype),d.prototype.constructor=d,b.exports=d,d.prototype.complete=function(){this.data&&this.data.removeEventListener&&(this.data.removeEventListener("error",this._boundOnError),this.data.removeEventListener("load",this._boundComplete),this.data.removeEventListener("progress",this._boundOnProgress),this.data.removeEventListener("canplaythrough",this._boundComplete)),this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener("error",this._boundXhrOnError),this.xhr.removeEventListener("abort",this._boundXhrOnAbort),this.xhr.removeEventListener("progress",this._boundOnProgress),this.xhr.removeEventListener("load",this._boundXhrOnLoad)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null)),this.emit("complete",this)},d.prototype.load=function(a){switch(this.emit("start",this),a&&this.once("complete",a),!1!==this.crossOrigin&&"string"==typeof this.crossOrigin||(this.crossOrigin=this._determineCrossOrigin(this.url)),this.loadType){case d.LOAD_TYPE.IMAGE:this._loadImage();break;case d.LOAD_TYPE.AUDIO:this._loadElement("audio");break;case d.LOAD_TYPE.VIDEO:this._loadElement("video");break;case d.LOAD_TYPE.XHR:default:i&&this.crossOrigin?this._loadXdr():this._loadXhr()}},d.prototype._loadImage=function(){this.data=new Image,this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),this.data.src=this.url,this.isImage=!0,this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1)},d.prototype._loadElement=function(a){if("audio"===a&&"undefined"!=typeof Audio?this.data=new Audio:this.data=document.createElement(a),null===this.data)return this.error=new Error("Unsupported element "+a),void this.complete();if(navigator.isCocoonJS)this.data.src=Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url))for(var b=0;b<this.url.length;++b)this.data.appendChild(this._createSource(a,this.url[b]));else this.data.appendChild(this._createSource(a,this.url));this["is"+a[0].toUpperCase()+a.substring(1)]=!0,this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.data.addEventListener("canplaythrough",this._boundComplete,!1),this.data.load()},d.prototype._loadXhr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var a=this.xhr=new XMLHttpRequest;a.open("GET",this.url,!0),this.xhrType===d.XHR_RESPONSE_TYPE.JSON||this.xhrType===d.XHR_RESPONSE_TYPE.DOCUMENT?a.responseType=d.XHR_RESPONSE_TYPE.TEXT:a.responseType=this.xhrType,a.addEventListener("error",this._boundXhrOnError,!1),a.addEventListener("abort",this._boundXhrOnAbort,!1),a.addEventListener("progress",this._boundOnProgress,!1),a.addEventListener("load",this._boundXhrOnLoad,!1),a.send()},d.prototype._loadXdr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var a=this.xhr=new XDomainRequest;a.timeout=5e3,a.onerror=this._boundXhrOnError,a.ontimeout=this._boundXdrOnTimeout,a.onprogress=this._boundOnProgress,a.onload=this._boundXhrOnLoad,a.open("GET",this.url,!0),setTimeout(function(){a.send()},0)},d.prototype._createSource=function(a,b,c){c||(c=a+"/"+b.substr(b.lastIndexOf(".")+1));var d=document.createElement("source");return d.src=b,d.type=c,d},d.prototype._onError=function(a){this.error=new Error("Failed to load element using "+a.target.nodeName),this.complete()},d.prototype._onProgress=function(a){a&&a.lengthComputable&&this.emit("progress",this,a.loaded/a.total)},d.prototype._xhrOnError=function(){this.error=new Error(e(this.xhr)+" Request failed. Status: "+this.xhr.status+', text: "'+this.xhr.statusText+'"'),this.complete()},d.prototype._xhrOnAbort=function(){this.error=new Error(e(this.xhr)+" Request was aborted by the user."),this.complete()},d.prototype._xdrOnTimeout=function(){this.error=new Error(e(this.xhr)+" Request timed out."),this.complete()},d.prototype._xhrOnLoad=function(){var a=this.xhr,b=void 0!==a.status?a.status:200;if(200===b||204===b||0===b&&a.responseText.length>0)if(this.xhrType===d.XHR_RESPONSE_TYPE.TEXT)this.data=a.responseText;else if(this.xhrType===d.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(a.responseText),this.isJson=!0}catch(c){this.error=new Error("Error trying to parse loaded json:",c)}else if(this.xhrType===d.XHR_RESPONSE_TYPE.DOCUMENT)try{if(window.DOMParser){var e=new DOMParser;this.data=e.parseFromString(a.responseText,"text/xml")}else{var f=document.createElement("div");f.innerHTML=a.responseText,this.data=f}this.isXml=!0}catch(c){this.error=new Error("Error trying to parse loaded xml:",c)}else this.data=a.response||a.responseText;else this.error=new Error("["+a.status+"]"+a.statusText+":"+a.responseURL);this.complete()},d.prototype._determineCrossOrigin=function(a,b){if(0===a.indexOf("data:"))return"";b=b||window.location,j||(j=document.createElement("a")),j.href=a,a=h.parse(j.href);var c=!a.port&&""===b.port||a.port===b.port;return a.hostname===b.hostname&&c&&a.protocol===b.protocol?"":"anonymous"},d.prototype._determineXhrType=function(){return d._xhrTypeMap[this._getExtension()]||d.XHR_RESPONSE_TYPE.TEXT},d.prototype._determineLoadType=function(){return d._loadTypeMap[this._getExtension()]||d.LOAD_TYPE.XHR},d.prototype._getExtension=function(){var a,b=this.url;if(this.isDataUrl){var c=b.indexOf("/");a=b.substring(c+1,b.indexOf(";",c))}else{var d=b.indexOf("?");-1!==d&&(b=b.substring(0,d)),a=b.substring(b.lastIndexOf(".")+1)}return a},d.prototype._getMimeFromXhrType=function(a){switch(a){case d.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case d.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case d.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case d.XHR_RESPONSE_TYPE.JSON:return"application/json";case d.XHR_RESPONSE_TYPE.DEFAULT:case d.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain"}},d.LOAD_TYPE={XHR:1,IMAGE:2,AUDIO:3,VIDEO:4},d.XHR_READY_STATE={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},d.XHR_RESPONSE_TYPE={DEFAULT:"text",BUFFER:"arraybuffer",BLOB:"blob",DOCUMENT:"document",JSON:"json",TEXT:"text"},d._loadTypeMap={gif:d.LOAD_TYPE.IMAGE,png:d.LOAD_TYPE.IMAGE,bmp:d.LOAD_TYPE.IMAGE,jpg:d.LOAD_TYPE.IMAGE,jpeg:d.LOAD_TYPE.IMAGE,tif:d.LOAD_TYPE.IMAGE,tiff:d.LOAD_TYPE.IMAGE,webp:d.LOAD_TYPE.IMAGE,tga:d.LOAD_TYPE.IMAGE},d._xhrTypeMap={xhtml:d.XHR_RESPONSE_TYPE.DOCUMENT,html:d.XHR_RESPONSE_TYPE.DOCUMENT,htm:d.XHR_RESPONSE_TYPE.DOCUMENT,xml:d.XHR_RESPONSE_TYPE.DOCUMENT,tmx:d.XHR_RESPONSE_TYPE.DOCUMENT,tsx:d.XHR_RESPONSE_TYPE.DOCUMENT,svg:d.XHR_RESPONSE_TYPE.DOCUMENT,gif:d.XHR_RESPONSE_TYPE.BLOB,png:d.XHR_RESPONSE_TYPE.BLOB,bmp:d.XHR_RESPONSE_TYPE.BLOB,jpg:d.XHR_RESPONSE_TYPE.BLOB,jpeg:d.XHR_RESPONSE_TYPE.BLOB,tif:d.XHR_RESPONSE_TYPE.BLOB,tiff:d.XHR_RESPONSE_TYPE.BLOB,webp:d.XHR_RESPONSE_TYPE.BLOB,tga:d.XHR_RESPONSE_TYPE.BLOB,json:d.XHR_RESPONSE_TYPE.JSON,text:d.XHR_RESPONSE_TYPE.TEXT,txt:d.XHR_RESPONSE_TYPE.TEXT},d.setExtensionLoadType=function(a,b){f(d._loadTypeMap,a,b)},d.setExtensionXhrType=function(a,b){f(d._xhrTypeMap,a,b)}},{eventemitter3:10,url:8}],15:[function(a,b,c){b.exports={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encodeBinary:function(a){for(var b,c="",d=new Array(4),e=0,f=0;e<a.length;){for(b=new Array(3),f=0;f<b.length;f++)e<a.length?b[f]=255&a.charCodeAt(e++):b[f]=0;switch(d[0]=b[0]>>2,d[1]=(3&b[0])<<4|b[1]>>4,d[2]=(15&b[1])<<2|b[2]>>6,d[3]=63&b[2],e-(a.length-1)){case 2:d[3]=64,d[2]=64;break;case 1:d[3]=64}for(f=0;f<d.length;f++)c+=this._keyStr.charAt(d[f])}return c}}},{}],16:[function(a,b,c){b.exports=a("./Loader"),b.exports.Resource=a("./Resource"),b.exports.middleware={caching:{memory:a("./middlewares/caching/memory")},parsing:{blob:a("./middlewares/parsing/blob")}}},{"./Loader":13,"./Resource":14,"./middlewares/caching/memory":17,"./middlewares/parsing/blob":18}],17:[function(a,b,c){var d={};b.exports=function(){return function(a,b){d[a.url]?(a.data=d[a.url],a.complete()):a.once("complete",function(){d[this.url]=this.data}),b()}}},{}],18:[function(a,b,c){var d=a("../../Resource"),e=a("../../b64");window.URL=window.URL||window.webkitURL,b.exports=function(){return function(a,b){if(!a.data)return b();if(a.xhr&&a.xhrType===d.XHR_RESPONSE_TYPE.BLOB)if(window.Blob&&"string"!=typeof a.data){if(0===a.data.type.indexOf("image")){var c=URL.createObjectURL(a.data);a.blob=a.data,a.data=new Image,a.data.src=c,a.isImage=!0,a.data.onload=function(){URL.revokeObjectURL(c),a.data.onload=null,b()}}}else{var f=a.xhr.getResponseHeader("content-type");f&&0===f.indexOf("image")&&(a.data=new Image,a.data.src="data:"+f+";base64,"+e.encodeBinary(a.xhr.responseText),a.isImage=!0,a.data.onload=function(){a.data.onload=null,b()})}else b()}}},{"../../Resource":14,"../../b64":15}],19:[function(a,b,c){function d(a){var b=document.createElement("div");b.style.width="100px",b.style.height="100px",b.style.position="absolute",b.style.top=0,b.style.left=0,b.style.zIndex=2,this.div=b,this.pool=[],this.renderId=0,this.debug=!1,this.renderer=a,this.children=[],this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this.isActive=!1,window.addEventListener("keydown",this._onKeyDown,!1)}var e=a("../core");(0,q.default)(e.DisplayObject.prototype,a("./accessibleTarget")),d.prototype.constructor=d,b.exports=d,d.prototype.activate=function(){this.isActive||(this.isActive=!0,window.document.addEventListener("mousemove",this._onMouseMove,!0),window.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),this.renderer.view.parentNode.appendChild(this.div))},d.prototype.deactivate=function(){this.isActive&&(this.isActive=!1,window.document.removeEventListener("mousemove",this._onMouseMove),window.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),this.div.parentNode.removeChild(this.div))},d.prototype.updateAccessibleObjects=function(a){if(a.visible&&(a.accessible&&a.interactive&&(a._accessibleActive||this.addChild(a),a.renderId=this.renderId),a.interactiveChildren))for(var b=a.children,c=b.length-1;c>=0;c--)this.updateAccessibleObjects(b[c])},d.prototype.update=function(){this.updateAccessibleObjects(this.renderer._lastObjectRendered);var a=this.renderer.view.getBoundingClientRect(),b=a.width/this.renderer.width,c=a.height/this.renderer.height,d=this.div;d.style.left=a.left+"px",d.style.top=a.top+"px",d.style.width=this.renderer.width+"px",d.style.height=this.renderer.height+"px";for(var f=0;f<this.children.length;f++){var g=this.children[f];if(g.renderId!==this.renderId)g._accessibleActive=!1,e.utils.removeItems(this.children,f,1),this.div.removeChild(g._accessibleDiv),this.pool.push(g._accessibleDiv),g._accessibleDiv=null,f--,0===this.children.length&&this.deactivate();else{d=g._accessibleDiv;var h=g.hitArea,i=g.worldTransform;g.hitArea?(d.style.left=(i.tx+h.x*i.a)*b+"px",d.style.top=(i.ty+h.y*i.d)*c+"px",d.style.width=h.width*i.a*b+"px",d.style.height=h.height*i.d*c+"px"):(h=g.getBounds(),this.capHitArea(h),d.style.left=h.x*b+"px",d.style.top=h.y*c+"px",d.style.width=h.width*b+"px",d.style.height=h.height*c+"px")}}this.renderId++},d.prototype.capHitArea=function(a){a.x<0&&(a.width+=a.x,a.x=0),a.y<0&&(a.height+=a.y,a.y=0),a.x+a.width>this.renderer.width&&(a.width=this.renderer.width-a.x),a.y+a.height>this.renderer.height&&(a.height=this.renderer.height-a.y)},d.prototype.addChild=function(a){var b=this.pool.pop();b||(b=document.createElement("button"),b.style.width="100px",b.style.height="100px",b.style.backgroundColor=this.debug?"rgba(255,0,0,0.5)":"transparent",b.style.position="absolute",b.style.zIndex=2,b.style.borderStyle="none",b.addEventListener("click",this._onClick.bind(this)),b.addEventListener("focus",this._onFocus.bind(this)),b.addEventListener("focusout",this._onFocusOut.bind(this))),b.title=a.accessibleTitle||"displayObject "+this.tabIndex,a._accessibleActive=!0,a._accessibleDiv=b,b.displayObject=a,this.children.push(a),this.div.appendChild(a._accessibleDiv),a._accessibleDiv.tabIndex=a.tabIndex},d.prototype._onClick=function(a){var b=this.renderer.plugins.interaction;b.dispatchEvent(a.target.displayObject,"click",b.eventData)},d.prototype._onFocus=function(a){var b=this.renderer.plugins.interaction;b.dispatchEvent(a.target.displayObject,"mouseover",b.eventData)},d.prototype._onFocusOut=function(a){var b=this.renderer.plugins.interaction;b.dispatchEvent(a.target.displayObject,"mouseout",b.eventData)},d.prototype._onKeyDown=function(a){9===a.keyCode&&this.activate()},d.prototype._onMouseMove=function(){this.deactivate()},d.prototype.destroy=function(){this.div=null;for(var a=0;a<this.children.length;a++)this.children[a].div=null;window.document.removeEventListener("mousemove",this._onMouseMove),window.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null},e.WebGLRenderer.registerPlugin("accessibility",d),e.CanvasRenderer.registerPlugin("accessibility",d)},{"../core":29,"./accessibleTarget":20}],20:[function(a,b,c){var d={accessible:!1,accessibleTitle:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:!1};b.exports=d},{}],21:[function(a,b,c){b.exports={accessibleTarget:a("./accessibleTarget"),AccessibilityManager:a("./AccessibilityManager")}},{"./AccessibilityManager":19,"./accessibleTarget":20}],22:[function(a,b,c){var d={VERSION:"3.0.10",PI_2:2*Math.PI,RAD_TO_DEG:180/Math.PI,DEG_TO_RAD:Math.PI/180,TARGET_FPMS:.06,RENDERER_TYPE:{UNKNOWN:0,WEBGL:1,CANVAS:2},BLEND_MODES:{NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16},DRAW_MODES:{POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},SCALE_MODES:{DEFAULT:0,LINEAR:0,NEAREST:1},RETINA_PREFIX:/@(.+)x/,RESOLUTION:1,FILTER_RESOLUTION:1,DEFAULT_RENDER_OPTIONS:{view:null,resolution:1,antialias:!1,forceFXAA:!1,autoResize:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,roundPixels:!1},SHAPES:{POLY:0,RECT:1,CIRC:2,ELIP:3,RREC:4},SPRITE_BATCH_SIZE:2e3};b.exports=d},{}],23:[function(a,b,c){function d(){g.call(this),this.children=[]}var e=a("../math"),f=a("../utils"),g=a("./DisplayObject"),h=a("../textures/RenderTexture"),i=new e.Matrix;d.prototype=(0,s.default)(g.prototype),d.prototype.constructor=d,b.exports=d,(0,m.default)(d.prototype,{width:{get:function(){return this.scale.x*this.getLocalBounds().width},set:function(a){var b=this.getLocalBounds().width;this.scale.x=0!==b?a/b:1,this._width=a}},height:{get:function(){return this.scale.y*this.getLocalBounds().height},set:function(a){var b=this.getLocalBounds().height;this.scale.y=0!==b?a/b:1,this._height=a}}}),d.prototype.onChildrenChange=function(){},d.prototype.addChild=function(a){var b=arguments.length;if(b>1)for(var c=0;c<b;c++)this.addChild(arguments[c]);else a.parent&&a.parent.removeChild(a),a.parent=this,this.children.push(a),this.onChildrenChange(this.children.length-1),a.emit("added",this);return a},d.prototype.addChildAt=function(a,b){if(b>=0&&b<=this.children.length)return a.parent&&a.parent.removeChild(a),a.parent=this,this.children.splice(b,0,a),this.onChildrenChange(b),a.emit("added",this),a;throw new Error(a+"addChildAt: The index "+b+" supplied is out of bounds "+this.children.length)},d.prototype.swapChildren=function(a,b){if(a!==b){var c=this.getChildIndex(a),d=this.getChildIndex(b);if(c<0||d<0)throw new Error("swapChildren: Both the supplied DisplayObjects must be children of the caller.");this.children[c]=b,this.children[d]=a,this.onChildrenChange(c<d?c:d)}},d.prototype.getChildIndex=function(a){var b=this.children.indexOf(a);if(-1===b)throw new Error("The supplied DisplayObject must be a child of the caller");return b},d.prototype.setChildIndex=function(a,b){if(b<0||b>=this.children.length)throw new Error("The supplied index is out of bounds");var c=this.getChildIndex(a);f.removeItems(this.children,c,1),this.children.splice(b,0,a),this.onChildrenChange(b)},d.prototype.getChildAt=function(a){if(a<0||a>=this.children.length)throw new Error("getChildAt: Supplied index "+a+" does not exist in the child list, or the supplied DisplayObject is not a child of the caller");return this.children[a]},d.prototype.removeChild=function(a){var b=arguments.length;if(b>1)for(var c=0;c<b;c++)this.removeChild(arguments[c]);else{var d=this.children.indexOf(a);if(-1===d)return;a.parent=null,f.removeItems(this.children,d,1),this.onChildrenChange(d),a.emit("removed",this)}return a},d.prototype.removeChildAt=function(a){var b=this.getChildAt(a);return b.parent=null,f.removeItems(this.children,a,1),this.onChildrenChange(a),b.emit("removed",this),b},d.prototype.removeChildren=function(a,b){var c,d,e=a||0,f="number"==typeof b?b:this.children.length,g=f-e;if(g>0&&g<=f){for(c=this.children.splice(e,g),d=0;d<c.length;++d)c[d].parent=null;for(this.onChildrenChange(a),d=0;d<c.length;++d)c[d].emit("removed",this);return c}if(0===g&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},d.prototype.generateTexture=function(a,b,c){var d=this.getLocalBounds(),e=new h(a,0|d.width,0|d.height,c,b);return i.tx=-d.x,i.ty=-d.y,e.render(this,i),e},d.prototype.updateTransform=function(){if(this.visible){this.displayObjectUpdateTransform();for(var a=0,b=this.children.length;a<b;++a)this.children[a].updateTransform()}},d.prototype.containerUpdateTransform=d.prototype.updateTransform,d.prototype.getBounds=function(){if(!this._currentBounds){if(0===this.children.length)return e.Rectangle.EMPTY;for(var a,b,c,d=1/0,f=1/0,g=-1/0,h=-1/0,i=!1,j=0,k=this.children.length;j<k;++j){this.children[j].visible&&(i=!0,a=this.children[j].getBounds(),d=d<a.x?d:a.x,f=f<a.y?f:a.y,b=a.width+a.x,c=a.height+a.y,g=g>b?g:b,h=h>c?h:c)}if(!i)return e.Rectangle.EMPTY;var l=this._bounds;l.x=d,l.y=f,l.width=g-d,l.height=h-f,this._currentBounds=l}return this._currentBounds},d.prototype.containerGetBounds=d.prototype.getBounds,d.prototype.getLocalBounds=function(){var a=this.worldTransform;this.worldTransform=e.Matrix.IDENTITY;for(var b=0,c=this.children.length;b<c;++b)this.children[b].updateTransform();return this.worldTransform=a,this._currentBounds=null,this.getBounds(e.Matrix.IDENTITY)},d.prototype.renderWebGL=function(a){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable){var b,c;if(this._mask||this._filters){for(a.currentRenderer.flush(),this._filters&&this._filters.length&&a.filterManager.pushFilter(this,this._filters),this._mask&&a.maskManager.pushMask(this,this._mask),a.currentRenderer.start(),this._renderWebGL(a),b=0,c=this.children.length;b<c;b++)this.children[b].renderWebGL(a);a.currentRenderer.flush(),this._mask&&a.maskManager.popMask(this,this._mask),this._filters&&a.filterManager.popFilter(),a.currentRenderer.start()}else for(this._renderWebGL(a),b=0,c=this.children.length;b<c;++b)this.children[b].renderWebGL(a)}},d.prototype._renderWebGL=function(a){},d.prototype._renderCanvas=function(a){},d.prototype.renderCanvas=function(a){if(this.visible&&!(this.alpha<=0)&&this.renderable){this._mask&&a.maskManager.pushMask(this._mask,a),this._renderCanvas(a);for(var b=0,c=this.children.length;b<c;++b)this.children[b].renderCanvas(a);this._mask&&a.maskManager.popMask(a)}},d.prototype.destroy=function(a){if(g.prototype.destroy.call(this),a)for(var b=0,c=this.children.length;b<c;++b)this.children[b].destroy(a);this.removeChildren(),this.children=null}},{"../math":33,"../textures/RenderTexture":71,"../utils":77,"./DisplayObject":24}],24:[function(a,b,c){function d(){g.call(this),this.position=new e.Point,this.scale=new e.Point(1,1),this.pivot=new e.Point(0,0),this.skew=new e.Point(0,0),this.rotation=0,this.alpha=1,this.visible=!0,this.renderable=!0,this.parent=null,this.worldAlpha=1,this.worldTransform=new e.Matrix,this.filterArea=null,this._sr=0,this._cr=1,this._bounds=new e.Rectangle(0,0,1,1),this._currentBounds=null,this._mask=null}var e=a("../math"),f=a("../textures/RenderTexture"),g=a("eventemitter3"),h=a("../const"),i=new e.Matrix,j={worldTransform:new e.Matrix,worldAlpha:1,children:[]};d.prototype=(0,s.default)(g.prototype),d.prototype.constructor=d,b.exports=d,(0,m.default)(d.prototype,{x:{get:function(){return this.position.x},set:function(a){this.position.x=a}},y:{get:function(){return this.position.y},set:function(a){this.position.y=a}},worldVisible:{get:function(){var a=this;do{if(!a.visible)return!1;a=a.parent}while(a);return!0}},mask:{get:function(){return this._mask},set:function(a){this._mask&&(this._mask.renderable=!0),this._mask=a,this._mask&&(this._mask.renderable=!1)}},filters:{get:function(){return this._filters&&this._filters.slice()},set:function(a){this._filters=a&&a.slice()}}}),d.prototype.updateTransform=function(){var a,b,c,d,e,f,g=this.parent.worldTransform,j=this.worldTransform;this.skew.x||this.skew.y?(i.setTransform(this.position.x,this.position.y,this.pivot.x,this.pivot.y,this.scale.x,this.scale.y,this.rotation,this.skew.x,this.skew.y),j.a=i.a*g.a+i.b*g.c,j.b=i.a*g.b+i.b*g.d,j.c=i.c*g.a+i.d*g.c,j.d=i.c*g.b+i.d*g.d,j.tx=i.tx*g.a+i.ty*g.c+g.tx,j.ty=i.tx*g.b+i.ty*g.d+g.ty):this.rotation%h.PI_2?(this.rotation!==this.rotationCache&&(this.rotationCache=this.rotation,this._sr=Math.sin(this.rotation),this._cr=Math.cos(this.rotation)),a=this._cr*this.scale.x,b=this._sr*this.scale.x,c=-this._sr*this.scale.y,d=this._cr*this.scale.y,e=this.position.x,f=this.position.y,(this.pivot.x||this.pivot.y)&&(e-=this.pivot.x*a+this.pivot.y*c,f-=this.pivot.x*b+this.pivot.y*d),j.a=a*g.a+b*g.c,j.b=a*g.b+b*g.d,j.c=c*g.a+d*g.c,j.d=c*g.b+d*g.d,j.tx=e*g.a+f*g.c+g.tx,j.ty=e*g.b+f*g.d+g.ty):(a=this.scale.x,d=this.scale.y,e=this.position.x-this.pivot.x*a,f=this.position.y-this.pivot.y*d,j.a=a*g.a,j.b=a*g.b,j.c=d*g.c,j.d=d*g.d,j.tx=e*g.a+f*g.c+g.tx,j.ty=e*g.b+f*g.d+g.ty),this.worldAlpha=this.alpha*this.parent.worldAlpha,this._currentBounds=null},d.prototype.displayObjectUpdateTransform=d.prototype.updateTransform,d.prototype.getBounds=function(a){return e.Rectangle.EMPTY},d.prototype.getLocalBounds=function(){return this.getBounds(e.Matrix.IDENTITY)},d.prototype.toGlobal=function(a){return this.parent?this.displayObjectUpdateTransform():(this.parent=j,this.displayObjectUpdateTransform(),this.parent=null),this.worldTransform.apply(a)},d.prototype.toLocal=function(a,b,c){return b&&(a=b.toGlobal(a)),this.parent?this.displayObjectUpdateTransform():(this.parent=j,this.displayObjectUpdateTransform(),this.parent=null),this.worldTransform.applyInverse(a,c)},d.prototype.renderWebGL=function(a){},d.prototype.renderCanvas=function(a){},d.prototype.generateTexture=function(a,b,c){var d=this.getLocalBounds(),e=new f(a,0|d.width,0|d.height,b,c);return i.tx=-d.x,i.ty=-d.y,e.render(this,i),e},d.prototype.setParent=function(a){if(!a||!a.addChild)throw new Error("setParent: Argument must be a Container");return a.addChild(this),a},d.prototype.setTransform=function(a,b,c,d,e,f,g,h,i){return this.position.x=a||0,this.position.y=b||0,this.scale.x=c||1,this.scale.y=d||1,this.rotation=e||0,this.skew.x=f||0,this.skew.y=g||0,this.pivot.x=h||0,this.pivot.y=i||0,this},d.prototype.destroy=function(){this.position=null,this.scale=null,this.pivot=null,this.skew=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.worldTransform=null,this.filterArea=null}},{"../const":22,"../math":33,"../textures/RenderTexture":71,eventemitter3:10}],25:[function(a,b,c){function d(){e.call(this),this.fillAlpha=1,this.lineWidth=0,this.lineColor=0,this.graphicsData=[],this.tint=16777215,this._prevTint=16777215,this.blendMode=k.BLEND_MODES.NORMAL,this.currentPath=null,this._webGL={},this.isMask=!1,this.boundsPadding=0,this._localBounds=new j.Rectangle(0,0,1,1),this.dirty=!0,this.glDirty=!1,this.boundsDirty=!0,this.cachedSpriteDirty=!1}var e=a("../display/Container"),f=a("../textures/Texture"),g=a("../renderers/canvas/utils/CanvasBuffer"),h=a("../renderers/canvas/utils/CanvasGraphics"),i=a("./GraphicsData"),j=a("../math"),k=a("../const"),l=new j.Point;d.prototype=(0,s.default)(e.prototype),d.prototype.constructor=d,b.exports=d,d.prototype.clone=function(){var a=new d;a.renderable=this.renderable,a.fillAlpha=this.fillAlpha,a.lineWidth=this.lineWidth,a.lineColor=this.lineColor,a.tint=this.tint,a.blendMode=this.blendMode,a.isMask=this.isMask,a.boundsPadding=this.boundsPadding,a.dirty=!0,a.glDirty=!0,a.cachedSpriteDirty=this.cachedSpriteDirty;for(var b=0;b<this.graphicsData.length;++b)a.graphicsData.push(this.graphicsData[b].clone());return a.currentPath=a.graphicsData[a.graphicsData.length-1],a.updateLocalBounds(),a},d.prototype.lineStyle=function(a,b,c){if(this.lineWidth=a||0,this.lineColor=b||0,this.lineAlpha=void 0===c?1:c,this.currentPath)if(this.currentPath.shape.points.length){var d=new j.Polygon(this.currentPath.shape.points.slice(-2));d.closed=!1,this.drawShape(d)}else this.currentPath.lineWidth=this.lineWidth,this.currentPath.lineColor=this.lineColor,this.currentPath.lineAlpha=this.lineAlpha;return this},d.prototype.updateLineStyleAt=function(a,b,c,d){d=d||0;var e=(this.graphicsData||[])[d];e&&(e.lineWidth=a,e.lineColor=b,e._lineTint=b,e.lineAlpha=c)},d.prototype.moveTo=function(a,b){var c=new j.Polygon([a,b]);return c.closed=!1,this.drawShape(c),this},d.prototype.lineTo=function(a,b){return this.currentPath.shape.points.push(a,b),this.dirty=!0,this},d.prototype.quadraticCurveTo=function(a,b,c,d){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);var e,f,g=this.currentPath.shape.points;0===g.length&&this.moveTo(0,0);for(var h=g[g.length-2],i=g[g.length-1],j=0,k=1;k<=20;++k)j=k/20,e=h+(a-h)*j,f=i+(b-i)*j,g.push(e+(a+(c-a)*j-e)*j,f+(b+(d-b)*j-f)*j);return this.dirty=this.boundsDirty=!0,this},d.prototype.bezierCurveTo=function(a,b,c,d,e,f){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);for(var g,h,i,j,k,l=this.currentPath.shape.points,m=l[l.length-2],n=l[l.length-1],o=0,p=1;p<=20;++p)o=p/20,g=1-o,h=g*g,i=h*g,j=o*o,k=j*o,l.push(i*m+3*h*o*a+3*g*j*c+k*e,i*n+3*h*o*b+3*g*j*d+k*f);return this.dirty=this.boundsDirty=!0,this},d.prototype.arcTo=function(a,b,c,d,e){this.currentPath?0===this.currentPath.shape.points.length&&this.currentPath.shape.points.push(a,b):this.moveTo(a,b);var f=this.currentPath.shape.points,g=f[f.length-2],h=f[f.length-1],i=h-b,j=g-a,k=d-b,l=c-a,m=Math.abs(i*l-j*k);if(m<1e-8||0===e)f[f.length-2]===a&&f[f.length-1]===b||f.push(a,b);else{var n=i*i+j*j,o=k*k+l*l,p=i*k+j*l,q=e*Math.sqrt(n)/m,r=e*Math.sqrt(o)/m,s=q*p/n,t=r*p/o,u=q*l+r*j,v=q*k+r*i,w=j*(r+s),x=i*(r+s),y=l*(q+t),z=k*(q+t),A=Math.atan2(x-v,w-u),B=Math.atan2(z-v,y-u);this.arc(u+a,v+b,e,A,B,j*k>l*i)}return this.dirty=this.boundsDirty=!0,this},d.prototype.arc=function(a,b,c,d,e,f){if(f=f||!1,d===e)return this;!f&&e<=d?e+=2*Math.PI:f&&d<=e&&(d+=2*Math.PI);var g=f?-1*(d-e):e-d,h=40*Math.ceil(Math.abs(g)/(2*Math.PI));if(0===g)return this;var i=a+Math.cos(d)*c,j=b+Math.sin(d)*c;this.currentPath?this.currentPath.shape.points.push(i,j):this.moveTo(i,j);for(var k=this.currentPath.shape.points,l=g/(2*h),m=2*l,n=Math.cos(l),o=Math.sin(l),p=h-1,q=p%1/p,r=0;r<=p;r++){var s=r+q*r,t=l+d+m*s,u=Math.cos(t),v=-Math.sin(t);k.push((n*u+o*v)*c+a,(n*-v+o*u)*c+b)}return this.dirty=this.boundsDirty=!0,this},d.prototype.beginFill=function(a,b){return this.filling=!0,this.fillColor=a||0,this.fillAlpha=void 0===b?1:b,this.currentPath&&this.currentPath.shape.points.length<=2&&(this.currentPath.fill=this.filling,this.currentPath.fillColor=this.fillColor,this.currentPath.fillAlpha=this.fillAlpha),this},d.prototype.endFill=function(){return this.filling=!1,this.fillColor=null,this.fillAlpha=1,this},d.prototype.drawRect=function(a,b,c,d){return this.drawShape(new j.Rectangle(a,b,c,d)),this},d.prototype.drawRoundedRect=function(a,b,c,d,e){return this.drawShape(new j.RoundedRectangle(a,b,c,d,e)),this},d.prototype.drawCircle=function(a,b,c){return this.drawShape(new j.Circle(a,b,c)),this},d.prototype.drawEllipse=function(a,b,c,d){return this.drawShape(new j.Ellipse(a,b,c,d)),this},d.prototype.drawPolygon=function(a){var b=a,c=!0;if(b instanceof j.Polygon&&(c=b.closed,b=b.points),!Array.isArray(b)){b=new Array(arguments.length);for(var d=0;d<b.length;++d)b[d]=arguments[d]}var e=new j.Polygon(b);return e.closed=c,this.drawShape(e),this},d.prototype.clear=function(){return this.lineWidth=0,this.filling=!1,this.dirty=!0,this.clearDirty=!0,this.graphicsData=[],this},d.prototype.closePath=function(){this.currentPath&&this.currentPath.shape&&this.currentPath.shape.close()},d.prototype.generateTexture=function(a,b,c){b=b||1;var d=this.getLocalBounds(),e=new g(d.width*b,d.height*b),i=f.fromCanvas(e.canvas,c);return i.baseTexture.resolution=b,e.context.scale(b,b),e.context.translate(-d.x,-d.y),h.renderGraphics(this,e.context),i},d.prototype._renderWebGL=function(a){this.glDirty&&(this.dirty=!0,this.glDirty=!1),a.setObjectRenderer(a.plugins.graphics),a.plugins.graphics.render(this)},d.prototype._renderCanvas=function(a){if(!0!==this.isMask){this._prevTint!==this.tint&&(this.dirty=!0);var b=a.context,c=this.worldTransform,d=a.blendModes[this.blendMode];d!==b.globalCompositeOperation&&(b.globalCompositeOperation=d);var e=a.resolution;b.setTransform(c.a*e,c.b*e,c.c*e,c.d*e,c.tx*e,c.ty*e),h.renderGraphics(this,b)}},d.prototype.getBounds=function(a){if(!this._currentBounds){if(!this.renderable)return j.Rectangle.EMPTY;this.boundsDirty&&(this.updateLocalBounds(),this.glDirty=!0,this.cachedSpriteDirty=!0,this.boundsDirty=!1);var b=this._localBounds,c=b.x,d=b.width+b.x,e=b.y,f=b.height+b.y,g=a||this.worldTransform,h=g.a,i=g.b,k=g.c,l=g.d,m=g.tx,n=g.ty,o=h*d+k*f+m,p=l*f+i*d+n,q=h*c+k*f+m,r=l*f+i*c+n,s=h*c+k*e+m,t=l*e+i*c+n,u=h*d+k*e+m,v=l*e+i*d+n,w=o,x=p,y=o,z=p;y=q<y?q:y,y=s<y?s:y,y=u<y?u:y,z=r<z?r:z,z=t<z?t:z,z=v<z?v:z,w=q>w?q:w,w=s>w?s:w,w=u>w?u:w,x=r>x?r:x,x=t>x?t:x,x=v>x?v:x,this._bounds.x=y,this._bounds.width=w-y,this._bounds.y=z,this._bounds.height=x-z,this._currentBounds=this._bounds}return this._currentBounds},d.prototype.containsPoint=function(a){this.worldTransform.applyInverse(a,l);for(var b=this.graphicsData,c=0;c<b.length;c++){var d=b[c];if(d.fill&&(d.shape&&d.shape.contains(l.x,l.y)))return!0}return!1},d.prototype.updateLocalBounds=function(){var a=1/0,b=-1/0,c=1/0,d=-1/0;if(this.graphicsData.length)for(var e,f,g,h,i,j,l=0;l<this.graphicsData.length;l++){var m=this.graphicsData[l],n=m.type,o=m.lineWidth;if(e=m.shape,n===k.SHAPES.RECT||n===k.SHAPES.RREC)g=e.x-o/2,h=e.y-o/2,i=e.width+o,j=e.height+o,a=g<a?g:a,b=g+i>b?g+i:b,c=h<c?h:c,d=h+j>d?h+j:d;else if(n===k.SHAPES.CIRC)g=e.x,h=e.y,i=e.radius+o/2,j=e.radius+o/2,a=g-i<a?g-i:a,b=g+i>b?g+i:b,c=h-j<c?h-j:c,d=h+j>d?h+j:d;else if(n===k.SHAPES.ELIP)g=e.x,h=e.y,i=e.width+o/2,j=e.height+o/2,a=g-i<a?g-i:a,b=g+i>b?g+i:b,c=h-j<c?h-j:c,d=h+j>d?h+j:d;else{f=e.points;for(var p=0;p<f.length;p+=2)g=f[p],h=f[p+1],a=g-o<a?g-o:a,b=g+o>b?g+o:b,c=h-o<c?h-o:c,d=h+o>d?h+o:d}}else a=0,b=0,c=0,d=0;var q=this.boundsPadding;this._localBounds.x=a-q,this._localBounds.width=b-a+2*q,this._localBounds.y=c-q,this._localBounds.height=d-c+2*q},d.prototype.drawShape=function(a){this.currentPath&&this.currentPath.shape.points.length<=2&&this.graphicsData.pop(),this.currentPath=null;var b=new i(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.filling,a);return this.graphicsData.push(b),
b.type===k.SHAPES.POLY&&(b.shape.closed=b.shape.closed||this.filling,this.currentPath=b),this.dirty=this.boundsDirty=!0,b},d.prototype.destroy=function(){e.prototype.destroy.apply(this,arguments);for(var a=0;a<this.graphicsData.length;++a)this.graphicsData[a].destroy();for(var b in this._webgl)for(var c=0;c<this._webgl[b].data.length;++c)this._webgl[b].data[c].destroy();this.graphicsData=null,this.currentPath=null,this._webgl=null,this._localBounds=null}},{"../const":22,"../display/Container":23,"../math":33,"../renderers/canvas/utils/CanvasBuffer":45,"../renderers/canvas/utils/CanvasGraphics":46,"../textures/Texture":72,"./GraphicsData":26}],26:[function(a,b,c){function d(a,b,c,d,e,f,g){this.lineWidth=a,this.lineColor=b,this.lineAlpha=c,this._lineTint=b,this.fillColor=d,this.fillAlpha=e,this._fillTint=d,this.fill=f,this.shape=g,this.type=g.type}d.prototype.constructor=d,b.exports=d,d.prototype.clone=function(){return new d(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)},d.prototype.destroy=function(){this.shape=null}},{}],27:[function(a,b,c){function d(a){h.call(this,a),this.graphicsDataPool=[],this.primitiveShader=null,this.complexPrimitiveShader=null,this.maximumSimplePolySize=200}var e=a("../../utils"),f=a("../../math"),g=a("../../const"),h=a("../../renderers/webgl/utils/ObjectRenderer"),i=a("../../renderers/webgl/WebGLRenderer"),j=a("./WebGLGraphicsData"),k=a("earcut");d.prototype=(0,s.default)(h.prototype),d.prototype.constructor=d,b.exports=d,i.registerPlugin("graphics",d),d.prototype.onContextChange=function(){},d.prototype.destroy=function(){h.prototype.destroy.call(this);for(var a=0;a<this.graphicsDataPool.length;++a)this.graphicsDataPool[a].destroy();this.graphicsDataPool=null},d.prototype.render=function(a){var b,c=this.renderer,d=c.gl,f=c.shaderManager.plugins.primitiveShader;!a.dirty&&a._webGL[d.id]||this.updateGraphics(a);var g=a._webGL[d.id];c.blendModeManager.setBlendMode(a.blendMode);for(var h=0,i=g.data.length;h<i;h++)b=g.data[h],1===g.data[h].mode?(c.stencilManager.pushStencil(a,b),d.uniform1f(c.shaderManager.complexPrimitiveShader.uniforms.alpha._location,a.worldAlpha*b.alpha),d.drawElements(d.TRIANGLE_FAN,4,d.UNSIGNED_SHORT,2*(b.indices.length-4)),c.stencilManager.popStencil(a,b)):(f=c.shaderManager.primitiveShader,c.shaderManager.setShader(f),d.uniformMatrix3fv(f.uniforms.translationMatrix._location,!1,a.worldTransform.toArray(!0)),d.uniformMatrix3fv(f.uniforms.projectionMatrix._location,!1,c.currentRenderTarget.projectionMatrix.toArray(!0)),d.uniform3fv(f.uniforms.tint._location,e.hex2rgb(a.tint)),d.uniform1f(f.uniforms.alpha._location,a.worldAlpha),d.bindBuffer(d.ARRAY_BUFFER,b.buffer),d.vertexAttribPointer(f.attributes.aVertexPosition,2,d.FLOAT,!1,24,0),d.vertexAttribPointer(f.attributes.aColor,4,d.FLOAT,!1,24,8),d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,b.indexBuffer),d.drawElements(d.TRIANGLE_STRIP,b.indices.length,d.UNSIGNED_SHORT,0)),c.drawCount++},d.prototype.updateGraphics=function(a){var b=this.renderer.gl,c=a._webGL[b.id];c||(c=a._webGL[b.id]={lastIndex:0,data:[],gl:b}),a.dirty=!1;var d;if(a.clearDirty){for(a.clearDirty=!1,d=0;d<c.data.length;d++){var e=c.data[d];e.reset(),this.graphicsDataPool.push(e)}c.data=[],c.lastIndex=0}var f;for(d=c.lastIndex;d<a.graphicsData.length;d++){var h=a.graphicsData[d];if(h.type===g.SHAPES.POLY){if(h.points=h.shape.points.slice(),h.shape.closed&&(h.points[0]===h.points[h.points.length-2]&&h.points[1]===h.points[h.points.length-1]||h.points.push(h.points[0],h.points[1])),h.fill&&h.points.length>=6)if(h.points.length<2*this.maximumSimplePolySize){f=this.switchMode(c,0);var i=this.buildPoly(h,f);i||(f=this.switchMode(c,1),this.buildComplexPoly(h,f))}else f=this.switchMode(c,1),this.buildComplexPoly(h,f);h.lineWidth>0&&(f=this.switchMode(c,0),this.buildLine(h,f))}else f=this.switchMode(c,0),h.type===g.SHAPES.RECT?this.buildRectangle(h,f):h.type===g.SHAPES.CIRC||h.type===g.SHAPES.ELIP?this.buildCircle(h,f):h.type===g.SHAPES.RREC&&this.buildRoundedRectangle(h,f);c.lastIndex++}for(d=0;d<c.data.length;d++)f=c.data[d],f.dirty&&f.save()},d.prototype.switchMode=function(a,b){var c;return a.data.length?(c=a.data[a.data.length-1],(c.points.length>32e4||c.mode!==b||1===b)&&(c=this.graphicsDataPool.pop()||new j(a.gl),c.mode=b,a.data.push(c))):(c=this.graphicsDataPool.pop()||new j(a.gl),c.mode=b,a.data.push(c)),c.dirty=!0,c},d.prototype.buildRectangle=function(a,b){var c=a.shape,d=c.x,f=c.y,g=c.width,h=c.height;if(a.fill){var i=e.hex2rgb(a.fillColor),j=a.fillAlpha,k=i[0]*j,l=i[1]*j,m=i[2]*j,n=b.points,o=b.indices,p=n.length/6;n.push(d,f),n.push(k,l,m,j),n.push(d+g,f),n.push(k,l,m,j),n.push(d,f+h),n.push(k,l,m,j),n.push(d+g,f+h),n.push(k,l,m,j),o.push(p,p,p+1,p+2,p+3,p+3)}if(a.lineWidth){var q=a.points;a.points=[d,f,d+g,f,d+g,f+h,d,f+h,d,f],this.buildLine(a,b),a.points=q}},d.prototype.buildRoundedRectangle=function(a,b){var c=a.shape,d=c.x,f=c.y,g=c.width,h=c.height,i=c.radius,j=[];if(j.push(d,f+i),this.quadraticBezierCurve(d,f+h-i,d,f+h,d+i,f+h,j),this.quadraticBezierCurve(d+g-i,f+h,d+g,f+h,d+g,f+h-i,j),this.quadraticBezierCurve(d+g,f+i,d+g,f,d+g-i,f,j),this.quadraticBezierCurve(d+i,f,d,f,d,f+i+1e-10,j),a.fill){var l=e.hex2rgb(a.fillColor),m=a.fillAlpha,n=l[0]*m,o=l[1]*m,p=l[2]*m,q=b.points,r=b.indices,s=q.length/6,t=k(j,null,2),u=0;for(u=0;u<t.length;u+=3)r.push(t[u]+s),r.push(t[u]+s),r.push(t[u+1]+s),r.push(t[u+2]+s),r.push(t[u+2]+s);for(u=0;u<j.length;u++)q.push(j[u],j[++u],n,o,p,m)}if(a.lineWidth){var v=a.points;a.points=j,this.buildLine(a,b),a.points=v}},d.prototype.quadraticBezierCurve=function(a,b,c,d,e,f,g){function h(a,b,c){return a+(b-a)*c}for(var i,j,k,l,m,n,o=g||[],p=0,q=0;q<=20;q++)p=q/20,i=h(a,c,p),j=h(b,d,p),k=h(c,e,p),l=h(d,f,p),m=h(i,k,p),n=h(j,l,p),o.push(m,n);return o},d.prototype.buildCircle=function(a,b){var c,d,f=a.shape,h=f.x,i=f.y;a.type===g.SHAPES.CIRC?(c=f.radius,d=f.radius):(c=f.width,d=f.height);var j=Math.floor(30*Math.sqrt(f.radius))||Math.floor(15*Math.sqrt(f.width+f.height)),k=2*Math.PI/j,l=0;if(a.fill){var m=e.hex2rgb(a.fillColor),n=a.fillAlpha,o=m[0]*n,p=m[1]*n,q=m[2]*n,r=b.points,s=b.indices,t=r.length/6;for(s.push(t),l=0;l<j+1;l++)r.push(h,i,o,p,q,n),r.push(h+Math.sin(k*l)*c,i+Math.cos(k*l)*d,o,p,q,n),s.push(t++,t++);s.push(t-1)}if(a.lineWidth){var u=a.points;for(a.points=[],l=0;l<j+1;l++)a.points.push(h+Math.sin(k*l)*c,i+Math.cos(k*l)*d);this.buildLine(a,b),a.points=u}},d.prototype.buildLine=function(a,b){var c=0,d=a.points;if(0!==d.length){var g=new f.Point(d[0],d[1]),h=new f.Point(d[d.length-2],d[d.length-1]);if(g.x===h.x&&g.y===h.y){d=d.slice(),d.pop(),d.pop(),h=new f.Point(d[d.length-2],d[d.length-1]);var i=h.x+.5*(g.x-h.x),j=h.y+.5*(g.y-h.y);d.unshift(i,j),d.push(i,j)}var k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H=b.points,I=b.indices,J=d.length/2,K=d.length,L=H.length/6,M=a.lineWidth/2,N=e.hex2rgb(a.lineColor),O=a.lineAlpha,P=N[0]*O,Q=N[1]*O,R=N[2]*O;for(m=d[0],n=d[1],o=d[2],p=d[3],s=-(n-p),t=m-o,G=Math.sqrt(s*s+t*t),s/=G,t/=G,s*=M,t*=M,H.push(m-s,n-t,P,Q,R,O),H.push(m+s,n+t,P,Q,R,O),c=1;c<J-1;c++)m=d[2*(c-1)],n=d[2*(c-1)+1],o=d[2*c],p=d[2*c+1],q=d[2*(c+1)],r=d[2*(c+1)+1],s=-(n-p),t=m-o,G=Math.sqrt(s*s+t*t),s/=G,t/=G,s*=M,t*=M,u=-(p-r),v=o-q,G=Math.sqrt(u*u+v*v),u/=G,v/=G,u*=M,v*=M,y=-t+n-(-t+p),z=-s+o-(-s+m),A=(-s+m)*(-t+p)-(-s+o)*(-t+n),B=-v+r-(-v+p),C=-u+o-(-u+q),D=(-u+q)*(-v+p)-(-u+o)*(-v+r),E=y*C-B*z,Math.abs(E)<.1?(E+=10.1,H.push(o-s,p-t,P,Q,R,O),H.push(o+s,p+t,P,Q,R,O)):(k=(z*D-C*A)/E,l=(B*A-y*D)/E,F=(k-o)*(k-o)+(l-p)*(l-p),F>19600?(w=s-u,x=t-v,G=Math.sqrt(w*w+x*x),w/=G,x/=G,w*=M,x*=M,H.push(o-w,p-x),H.push(P,Q,R,O),H.push(o+w,p+x),H.push(P,Q,R,O),H.push(o-w,p-x),H.push(P,Q,R,O),K++):(H.push(k,l),H.push(P,Q,R,O),H.push(o-(k-o),p-(l-p)),H.push(P,Q,R,O)));for(m=d[2*(J-2)],n=d[2*(J-2)+1],o=d[2*(J-1)],p=d[2*(J-1)+1],s=-(n-p),t=m-o,G=Math.sqrt(s*s+t*t),s/=G,t/=G,s*=M,t*=M,H.push(o-s,p-t),H.push(P,Q,R,O),H.push(o+s,p+t),H.push(P,Q,R,O),I.push(L),c=0;c<K;c++)I.push(L++);I.push(L-1)}},d.prototype.buildComplexPoly=function(a,b){var c=a.points.slice();if(!(c.length<6)){var d=b.indices;b.points=c,b.alpha=a.fillAlpha,b.color=e.hex2rgb(a.fillColor);for(var f,g,h=1/0,i=-1/0,j=1/0,k=-1/0,l=0;l<c.length;l+=2)f=c[l],g=c[l+1],h=f<h?f:h,i=f>i?f:i,j=g<j?g:j,k=g>k?g:k;c.push(h,j,i,j,i,k,h,k);var m=c.length/2;for(l=0;l<m;l++)d.push(l)}},d.prototype.buildPoly=function(a,b){var c=a.points;if(!(c.length<6)){var d=b.points,f=b.indices,g=c.length/2,h=e.hex2rgb(a.fillColor),i=a.fillAlpha,j=h[0]*i,l=h[1]*i,m=h[2]*i,n=k(c,null,2);if(!n)return!1;var o=d.length/6,p=0;for(p=0;p<n.length;p+=3)f.push(n[p]+o),f.push(n[p]+o),f.push(n[p+1]+o),f.push(n[p+2]+o),f.push(n[p+2]+o);for(p=0;p<g;p++)d.push(c[2*p],c[2*p+1],j,l,m,i);return!0}}},{"../../const":22,"../../math":33,"../../renderers/webgl/WebGLRenderer":49,"../../renderers/webgl/utils/ObjectRenderer":63,"../../utils":77,"./WebGLGraphicsData":28,earcut:9}],28:[function(a,b,c){function d(a){this.gl=a,this.color=[0,0,0],this.points=[],this.indices=[],this.buffer=a.createBuffer(),this.indexBuffer=a.createBuffer(),this.mode=1,this.alpha=1,this.dirty=!0,this.glPoints=null,this.glIndices=null}d.prototype.constructor=d,b.exports=d,d.prototype.reset=function(){this.points.length=0,this.indices.length=0},d.prototype.save=function(){var a=this.gl;this.glPoints=new Float32Array(this.points),a.bindBuffer(a.ARRAY_BUFFER,this.buffer),a.bufferData(a.ARRAY_BUFFER,this.glPoints,a.STATIC_DRAW),this.glIndices=new Uint16Array(this.indices),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.indexBuffer),a.bufferData(a.ELEMENT_ARRAY_BUFFER,this.glIndices,a.STATIC_DRAW),this.dirty=!1},d.prototype.destroy=function(){this.color=null,this.points=null,this.indices=null,this.gl.deleteBuffer(this.buffer),this.gl.deleteBuffer(this.indexBuffer),this.gl=null,this.buffer=null,this.indexBuffer=null,this.glPoints=null,this.glIndices=null}},{}],29:[function(a,b,c){var d=b.exports=(0,q.default)(a("./const"),a("./math"),{utils:a("./utils"),ticker:a("./ticker"),DisplayObject:a("./display/DisplayObject"),Container:a("./display/Container"),Sprite:a("./sprites/Sprite"),ParticleContainer:a("./particles/ParticleContainer"),SpriteRenderer:a("./sprites/webgl/SpriteRenderer"),ParticleRenderer:a("./particles/webgl/ParticleRenderer"),Text:a("./text/Text"),Graphics:a("./graphics/Graphics"),GraphicsData:a("./graphics/GraphicsData"),GraphicsRenderer:a("./graphics/webgl/GraphicsRenderer"),Texture:a("./textures/Texture"),BaseTexture:a("./textures/BaseTexture"),RenderTexture:a("./textures/RenderTexture"),VideoBaseTexture:a("./textures/VideoBaseTexture"),TextureUvs:a("./textures/TextureUvs"),CanvasRenderer:a("./renderers/canvas/CanvasRenderer"),CanvasGraphics:a("./renderers/canvas/utils/CanvasGraphics"),CanvasBuffer:a("./renderers/canvas/utils/CanvasBuffer"),WebGLRenderer:a("./renderers/webgl/WebGLRenderer"),WebGLManager:a("./renderers/webgl/managers/WebGLManager"),ShaderManager:a("./renderers/webgl/managers/ShaderManager"),Shader:a("./renderers/webgl/shaders/Shader"),TextureShader:a("./renderers/webgl/shaders/TextureShader"),PrimitiveShader:a("./renderers/webgl/shaders/PrimitiveShader"),ComplexPrimitiveShader:a("./renderers/webgl/shaders/ComplexPrimitiveShader"),ObjectRenderer:a("./renderers/webgl/utils/ObjectRenderer"),RenderTarget:a("./renderers/webgl/utils/RenderTarget"),AbstractFilter:a("./renderers/webgl/filters/AbstractFilter"),FXAAFilter:a("./renderers/webgl/filters/FXAAFilter"),SpriteMaskFilter:a("./renderers/webgl/filters/SpriteMaskFilter"),autoDetectRenderer:function(a,b,c,e){return a=a||800,b=b||600,!e&&d.utils.isWebGLSupported()?new d.WebGLRenderer(a,b,c):new d.CanvasRenderer(a,b,c)}})},{"./const":22,"./display/Container":23,"./display/DisplayObject":24,"./graphics/Graphics":25,"./graphics/GraphicsData":26,"./graphics/webgl/GraphicsRenderer":27,"./math":33,"./particles/ParticleContainer":39,"./particles/webgl/ParticleRenderer":41,"./renderers/canvas/CanvasRenderer":44,"./renderers/canvas/utils/CanvasBuffer":45,"./renderers/canvas/utils/CanvasGraphics":46,"./renderers/webgl/WebGLRenderer":49,"./renderers/webgl/filters/AbstractFilter":50,"./renderers/webgl/filters/FXAAFilter":51,"./renderers/webgl/filters/SpriteMaskFilter":52,"./renderers/webgl/managers/ShaderManager":56,"./renderers/webgl/managers/WebGLManager":58,"./renderers/webgl/shaders/ComplexPrimitiveShader":59,"./renderers/webgl/shaders/PrimitiveShader":60,"./renderers/webgl/shaders/Shader":61,"./renderers/webgl/shaders/TextureShader":62,"./renderers/webgl/utils/ObjectRenderer":63,"./renderers/webgl/utils/RenderTarget":65,"./sprites/Sprite":67,"./sprites/webgl/SpriteRenderer":68,"./text/Text":69,"./textures/BaseTexture":70,"./textures/RenderTexture":71,"./textures/Texture":72,"./textures/TextureUvs":73,"./textures/VideoBaseTexture":74,"./ticker":76,"./utils":77}],30:[function(a,b,c){function d(a){return a<0?-1:a>0?1:0}var e=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],f=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],g=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],h=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],i=[],j=a("./Matrix"),k=[];!function(){for(var a=0;a<16;a++){var b=[];k.push(b);for(var c=0;c<16;c++)for(var l=d(e[a]*e[c]+g[a]*f[c]),m=d(f[a]*e[c]+h[a]*f[c]),n=d(e[a]*g[c]+g[a]*h[c]),o=d(f[a]*g[c]+h[a]*h[c]),p=0;p<16;p++)if(e[p]===l&&f[p]===m&&g[p]===n&&h[p]===o){b.push(p);break}}for(a=0;a<16;a++){var q=new j;q.set(e[a],f[a],g[a],h[a],0,0),i.push(q)}}();var l={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MIRROR_HORIZONTAL:12,uX:function(a){return e[a]},uY:function(a){return f[a]},vX:function(a){return g[a]},vY:function(a){return h[a]},inv:function(a){return 8&a?15&a:7&-a},add:function(a,b){return k[a][b]},sub:function(a,b){return k[a][l.inv(b)]},rotate180:function(a){return 4^a},isSwapWidthHeight:function(a){return 2==(3&a)},byDirection:function(a,b){return 2*Math.abs(a)<=Math.abs(b)?b>=0?l.S:l.N:2*Math.abs(b)<=Math.abs(a)?a>0?l.E:l.W:b>0?a>0?l.SE:l.SW:a>0?l.NE:l.NW},matrixAppendRotationInv:function(a,b,c,d){var e=i[l.inv(b)];c=c||0,d=d||0,e.tx=c,e.ty=d,a.append(e)}};b.exports=l},{"./Matrix":31}],31:[function(a,b,c){function d(){this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0}var e=a("./Point");d.prototype.constructor=d,b.exports=d,d.prototype.fromArray=function(a){this.a=a[0],this.b=a[1],this.c=a[3],this.d=a[4],this.tx=a[2],this.ty=a[5]},d.prototype.set=function(a,b,c,d,e,f){return this.a=a,this.b=b,this.c=c,this.d=d,this.tx=e,this.ty=f,this},d.prototype.toArray=function(a,b){this.array||(this.array=new Float32Array(9));var c=b||this.array;return a?(c[0]=this.a,c[1]=this.b,c[2]=0,c[3]=this.c,c[4]=this.d,c[5]=0,c[6]=this.tx,c[7]=this.ty,c[8]=1):(c[0]=this.a,c[1]=this.c,c[2]=this.tx,c[3]=this.b,c[4]=this.d,c[5]=this.ty,c[6]=0,c[7]=0,c[8]=1),c},d.prototype.apply=function(a,b){b=b||new e;var c=a.x,d=a.y;return b.x=this.a*c+this.c*d+this.tx,b.y=this.b*c+this.d*d+this.ty,b},d.prototype.applyInverse=function(a,b){b=b||new e;var c=1/(this.a*this.d+this.c*-this.b),d=a.x,f=a.y;return b.x=this.d*c*d+-this.c*c*f+(this.ty*this.c-this.tx*this.d)*c,b.y=this.a*c*f+-this.b*c*d+(-this.ty*this.a+this.tx*this.b)*c,b},d.prototype.translate=function(a,b){return this.tx+=a,this.ty+=b,this},d.prototype.scale=function(a,b){return this.a*=a,this.d*=b,this.c*=a,this.b*=b,this.tx*=a,this.ty*=b,this},d.prototype.rotate=function(a){var b=Math.cos(a),c=Math.sin(a),d=this.a,e=this.c,f=this.tx;return this.a=d*b-this.b*c,this.b=d*c+this.b*b,this.c=e*b-this.d*c,this.d=e*c+this.d*b,this.tx=f*b-this.ty*c,this.ty=f*c+this.ty*b,this},d.prototype.append=function(a){var b=this.a,c=this.b,d=this.c,e=this.d;return this.a=a.a*b+a.b*d,this.b=a.a*c+a.b*e,this.c=a.c*b+a.d*d,this.d=a.c*c+a.d*e,this.tx=a.tx*b+a.ty*d+this.tx,this.ty=a.tx*c+a.ty*e+this.ty,this},d.prototype.setTransform=function(a,b,c,d,e,f,g,h,i){var j,k,l,m,n,o,p,q,r,s;return n=Math.sin(g),o=Math.cos(g),p=Math.cos(i),q=Math.sin(i),r=-Math.sin(h),s=Math.cos(h),j=o*e,k=n*e,l=-n*f,m=o*f,this.a=p*j+q*l,this.b=p*k+q*m,this.c=r*j+s*l,this.d=r*k+s*m,this.tx=a+(c*j+d*l),this.ty=b+(c*k+d*m),this},d.prototype.prepend=function(a){var b=this.tx;if(1!==a.a||0!==a.b||0!==a.c||1!==a.d){var c=this.a,d=this.c;this.a=c*a.a+this.b*a.c,this.b=c*a.b+this.b*a.d,this.c=d*a.a+this.d*a.c,this.d=d*a.b+this.d*a.d}return this.tx=b*a.a+this.ty*a.c+a.tx,this.ty=b*a.b+this.ty*a.d+a.ty,this},d.prototype.invert=function(){var a=this.a,b=this.b,c=this.c,d=this.d,e=this.tx,f=a*d-b*c;return this.a=d/f,this.b=-b/f,this.c=-c/f,this.d=a/f,this.tx=(c*this.ty-d*e)/f,this.ty=-(a*this.ty-b*e)/f,this},d.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},d.prototype.clone=function(){var a=new d;return a.a=this.a,a.b=this.b,a.c=this.c,a.d=this.d,a.tx=this.tx,a.ty=this.ty,a},d.prototype.copy=function(a){return a.a=this.a,a.b=this.b,a.c=this.c,a.d=this.d,a.tx=this.tx,a.ty=this.ty,a},d.IDENTITY=new d,d.TEMP_MATRIX=new d},{"./Point":32}],32:[function(a,b,c){function d(a,b){this.x=a||0,this.y=b||0}d.prototype.constructor=d,b.exports=d,d.prototype.clone=function(){return new d(this.x,this.y)},d.prototype.copy=function(a){this.set(a.x,a.y)},d.prototype.equals=function(a){return a.x===this.x&&a.y===this.y},d.prototype.set=function(a,b){this.x=a||0,this.y=b||(0!==b?this.x:0)}},{}],33:[function(a,b,c){b.exports={Point:a("./Point"),Matrix:a("./Matrix"),GroupD8:a("./GroupD8"),Circle:a("./shapes/Circle"),Ellipse:a("./shapes/Ellipse"),Polygon:a("./shapes/Polygon"),Rectangle:a("./shapes/Rectangle"),RoundedRectangle:a("./shapes/RoundedRectangle")}},{"./GroupD8":30,"./Matrix":31,"./Point":32,"./shapes/Circle":34,"./shapes/Ellipse":35,"./shapes/Polygon":36,"./shapes/Rectangle":37,"./shapes/RoundedRectangle":38}],34:[function(a,b,c){function d(a,b,c){this.x=a||0,this.y=b||0,this.radius=c||0,this.type=f.SHAPES.CIRC}var e=a("./Rectangle"),f=a("../../const");d.prototype.constructor=d,b.exports=d,d.prototype.clone=function(){return new d(this.x,this.y,this.radius)},d.prototype.contains=function(a,b){if(this.radius<=0)return!1;var c=this.x-a,d=this.y-b,e=this.radius*this.radius;return c*=c,d*=d,c+d<=e},d.prototype.getBounds=function(){return new e(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)}},{"../../const":22,"./Rectangle":37}],35:[function(a,b,c){function d(a,b,c,d){this.x=a||0,this.y=b||0,this.width=c||0,this.height=d||0,this.type=f.SHAPES.ELIP}var e=a("./Rectangle"),f=a("../../const");d.prototype.constructor=d,b.exports=d,d.prototype.clone=function(){return new d(this.x,this.y,this.width,this.height)},d.prototype.contains=function(a,b){if(this.width<=0||this.height<=0)return!1;var c=(a-this.x)/this.width,d=(b-this.y)/this.height;return c*=c,d*=d,c+d<=1},d.prototype.getBounds=function(){return new e(this.x-this.width,this.y-this.height,this.width,this.height)}},{"../../const":22,"./Rectangle":37}],36:[function(a,b,c){function d(a){var b=a;if(!Array.isArray(b)){b=new Array(arguments.length);for(var c=0;c<b.length;++c)b[c]=arguments[c]}if(b[0]instanceof e){for(var d=[],g=0,h=b.length;g<h;g++)d.push(b[g].x,b[g].y);b=d}this.closed=!0,this.points=b,this.type=f.SHAPES.POLY}var e=a("../Point"),f=a("../../const");d.prototype.constructor=d,b.exports=d,d.prototype.clone=function(){return new d(this.points.slice())},d.prototype.close=function(){var a=this.points;a[0]===a[a.length-2]&&a[1]===a[a.length-1]||a.push(a[0],a[1])},d.prototype.contains=function(a,b){for(var c=!1,d=this.points.length/2,e=0,f=d-1;e<d;f=e++){var g=this.points[2*e],h=this.points[2*e+1],i=this.points[2*f],j=this.points[2*f+1];h>b!=j>b&&a<(i-g)*(b-h)/(j-h)+g&&(c=!c)}return c}},{"../../const":22,"../Point":32}],37:[function(a,b,c){function d(a,b,c,d){this.x=a||0,this.y=b||0,this.width=c||0,this.height=d||0,this.type=e.SHAPES.RECT}var e=a("../../const");d.prototype.constructor=d,b.exports=d,d.EMPTY=new d(0,0,0,0),d.prototype.clone=function(){return new d(this.x,this.y,this.width,this.height)},d.prototype.contains=function(a,b){return!(this.width<=0||this.height<=0)&&(a>=this.x&&a<this.x+this.width&&b>=this.y&&b<this.y+this.height)}},{"../../const":22}],38:[function(a,b,c){function d(a,b,c,d,f){this.x=a||0,this.y=b||0,this.width=c||0,this.height=d||0,this.radius=f||20,this.type=e.SHAPES.RREC}var e=a("../../const");d.prototype.constructor=d,b.exports=d,d.prototype.clone=function(){return new d(this.x,this.y,this.width,this.height,this.radius)},d.prototype.contains=function(a,b){return!(this.width<=0||this.height<=0)&&(a>=this.x&&a<=this.x+this.width&&b>=this.y&&b<=this.y+this.height)}},{"../../const":22}],39:[function(a,b,c){function d(a,b,c){e.call(this),c=c||15e3,a=a||15e3;c>16384&&(c=16384),c>a&&(c=a),this._properties=[!1,!0,!1,!1,!1],this._maxSize=a,this._batchSize=c,this._buffers=null,this._bufferToUpdate=0,this.interactiveChildren=!1,this.blendMode=f.BLEND_MODES.NORMAL,this.roundPixels=!0,this.setProperties(b)}var e=a("../display/Container"),f=a("../const");d.prototype=(0,s.default)(e.prototype),d.prototype.constructor=d,b.exports=d,d.prototype.setProperties=function(a){a&&(this._properties[0]="scale"in a?!!a.scale:this._properties[0],this._properties[1]="position"in a?!!a.position:this._properties[1],this._properties[2]="rotation"in a?!!a.rotation:this._properties[2],this._properties[3]="uvs"in a?!!a.uvs:this._properties[3],this._properties[4]="alpha"in a?!!a.alpha:this._properties[4])},d.prototype.updateTransform=function(){this.displayObjectUpdateTransform()},d.prototype.renderWebGL=function(a){this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable&&(a.setObjectRenderer(a.plugins.particle),a.plugins.particle.render(this))},d.prototype.onChildrenChange=function(a){var b=Math.floor(a/this._batchSize);b<this._bufferToUpdate&&(this._bufferToUpdate=b)},d.prototype.renderCanvas=function(a){if(this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable){var b=a.context,c=this.worldTransform,d=!0,e=0,f=0,g=0,h=0,i=a.blendModes[this.blendMode];i!==b.globalCompositeOperation&&(b.globalCompositeOperation=i),b.globalAlpha=this.worldAlpha,this.displayObjectUpdateTransform();for(var j=0;j<this.children.length;++j){var k=this.children[j];if(k.visible){var l=k.texture.frame;if(b.globalAlpha=this.worldAlpha*k.alpha,k.rotation%(2*Math.PI)==0)d&&(b.setTransform(c.a,c.b,c.c,c.d,c.tx,c.ty),d=!1),e=k.anchor.x*(-l.width*k.scale.x)+k.position.x+.5,f=k.anchor.y*(-l.height*k.scale.y)+k.position.y+.5,g=l.width*k.scale.x,h=l.height*k.scale.y;else{d||(d=!0),k.displayObjectUpdateTransform();var m=k.worldTransform;a.roundPixels?b.setTransform(m.a,m.b,m.c,m.d,0|m.tx,0|m.ty):b.setTransform(m.a,m.b,m.c,m.d,m.tx,m.ty),e=k.anchor.x*-l.width+.5,f=k.anchor.y*-l.height+.5,g=l.width,h=l.height}b.drawImage(k.texture.baseTexture.source,l.x,l.y,l.width,l.height,e,f,g,h)}}}},d.prototype.destroy=function(){if(e.prototype.destroy.apply(this,arguments),this._buffers)for(var a=0;a<this._buffers.length;++a)this._buffers[a].destroy();this._properties=null,this._buffers=null}},{"../const":22,"../display/Container":23}],40:[function(a,b,c){function d(a,b,c,d){this.gl=a,this.vertSize=2,this.vertByteSize=4*this.vertSize,this.size=d,this.dynamicProperties=[],this.staticProperties=[];for(var e=0;e<b.length;e++){var f=b[e];c[e]?this.dynamicProperties.push(f):this.staticProperties.push(f)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.initBuffers()}d.prototype.constructor=d,b.exports=d,d.prototype.initBuffers=function(){var a,b,c=this.gl,d=0;for(this.dynamicStride=0,a=0;a<this.dynamicProperties.length;a++)b=this.dynamicProperties[a],b.offset=d,d+=b.size,this.dynamicStride+=b.size;this.dynamicData=new Float32Array(this.size*this.dynamicStride*4),this.dynamicBuffer=c.createBuffer(),c.bindBuffer(c.ARRAY_BUFFER,this.dynamicBuffer),c.bufferData(c.ARRAY_BUFFER,this.dynamicData,c.DYNAMIC_DRAW);var e=0;for(this.staticStride=0,a=0;a<this.staticProperties.length;a++)b=this.staticProperties[a],b.offset=e,e+=b.size,this.staticStride+=b.size;this.staticData=new Float32Array(this.size*this.staticStride*4),this.staticBuffer=c.createBuffer(),c.bindBuffer(c.ARRAY_BUFFER,this.staticBuffer),c.bufferData(c.ARRAY_BUFFER,this.staticData,c.DYNAMIC_DRAW)},d.prototype.uploadDynamic=function(a,b,c){for(var d=this.gl,e=0;e<this.dynamicProperties.length;e++){var f=this.dynamicProperties[e];f.uploadFunction(a,b,c,this.dynamicData,this.dynamicStride,f.offset)}d.bindBuffer(d.ARRAY_BUFFER,this.dynamicBuffer),d.bufferSubData(d.ARRAY_BUFFER,0,this.dynamicData)},d.prototype.uploadStatic=function(a,b,c){for(var d=this.gl,e=0;e<this.staticProperties.length;e++){var f=this.staticProperties[e];f.uploadFunction(a,b,c,this.staticData,this.staticStride,f.offset)}d.bindBuffer(d.ARRAY_BUFFER,this.staticBuffer),d.bufferSubData(d.ARRAY_BUFFER,0,this.staticData)},d.prototype.bind=function(){var a,b,c=this.gl;for(c.bindBuffer(c.ARRAY_BUFFER,this.dynamicBuffer),a=0;a<this.dynamicProperties.length;a++)b=this.dynamicProperties[a],c.vertexAttribPointer(b.attribute,b.size,c.FLOAT,!1,4*this.dynamicStride,4*b.offset);for(c.bindBuffer(c.ARRAY_BUFFER,this.staticBuffer),a=0;a<this.staticProperties.length;a++)b=this.staticProperties[a],c.vertexAttribPointer(b.attribute,b.size,c.FLOAT,!1,4*this.staticStride,4*b.offset)},d.prototype.destroy=function(){this.dynamicProperties=null,this.dynamicData=null,this.gl.deleteBuffer(this.dynamicBuffer),this.staticProperties=null,this.staticData=null,this.gl.deleteBuffer(this.staticBuffer)}},{}],41:[function(a,b,c){function d(a){e.call(this,a);this.indices=new Uint16Array(98304);for(var b=0,c=0;b<98304;b+=6,c+=4)this.indices[b+0]=c+0,this.indices[b+1]=c+1,this.indices[b+2]=c+2,this.indices[b+3]=c+0,this.indices[b+4]=c+2,this.indices[b+5]=c+3;this.shader=null,this.indexBuffer=null,this.properties=null,this.tempMatrix=new i.Matrix}var e=a("../../renderers/webgl/utils/ObjectRenderer"),f=a("../../renderers/webgl/WebGLRenderer"),g=a("./ParticleShader"),h=a("./ParticleBuffer"),i=a("../../math");d.prototype=(0,s.default)(e.prototype),d.prototype.constructor=d,b.exports=d,f.registerPlugin("particle",d),d.prototype.onContextChange=function(){var a=this.renderer.gl;this.shader=new g(this.renderer.shaderManager),this.indexBuffer=a.createBuffer(),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.indexBuffer),a.bufferData(a.ELEMENT_ARRAY_BUFFER,this.indices,a.STATIC_DRAW),this.properties=[{attribute:this.shader.attributes.aVertexPosition,size:2,uploadFunction:this.uploadVertices,offset:0},{attribute:this.shader.attributes.aPositionCoord,size:2,uploadFunction:this.uploadPosition,offset:0},{attribute:this.shader.attributes.aRotation,size:1,uploadFunction:this.uploadRotation,offset:0},{attribute:this.shader.attributes.aTextureCoord,size:2,uploadFunction:this.uploadUvs,offset:0},{attribute:this.shader.attributes.aColor,size:1,uploadFunction:this.uploadAlpha,offset:0}]},d.prototype.start=function(){var a=this.renderer.gl;a.activeTexture(a.TEXTURE0),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.indexBuffer);var b=this.shader;this.renderer.shaderManager.setShader(b)},d.prototype.render=function(a){var b=a.children,c=b.length,d=a._maxSize,e=a._batchSize;if(0!==c){c>d&&(c=d),a._buffers||(a._buffers=this.generateBuffers(a)),this.renderer.blendModeManager.setBlendMode(a.blendMode);var f=this.renderer.gl,g=a.worldTransform.copy(this.tempMatrix);g.prepend(this.renderer.currentRenderTarget.projectionMatrix),f.uniformMatrix3fv(this.shader.uniforms.projectionMatrix._location,!1,g.toArray(!0)),f.uniform1f(this.shader.uniforms.uAlpha._location,a.worldAlpha);var h=b[0]._texture.baseTexture;if(h._glTextures[f.id])f.bindTexture(f.TEXTURE_2D,h._glTextures[f.id]);else{if(!this.renderer.updateTexture(h))return;a._properties[0]&&a._properties[3]||(a._bufferToUpdate=0)}for(var i=0,j=0;i<c;i+=e,j+=1){var k=c-i;k>e&&(k=e);var l=a._buffers[j];l.uploadDynamic(b,i,k),a._bufferToUpdate===j&&(l.uploadStatic(b,i,k),a._bufferToUpdate=j+1),l.bind(this.shader),f.drawElements(f.TRIANGLES,6*k,f.UNSIGNED_SHORT,0),this.renderer.drawCount++}}},d.prototype.generateBuffers=function(a){var b,c=this.renderer.gl,d=[],e=a._maxSize,f=a._batchSize,g=a._properties;for(b=0;b<e;b+=f)d.push(new h(c,this.properties,g,f));return d},d.prototype.uploadVertices=function(a,b,c,d,e,f){for(var g,h,i,j,k,l,m,n,o,p=0;p<c;p++)g=a[b+p],h=g._texture,j=g.scale.x,k=g.scale.y,h.trim?(i=h.trim,m=i.x-g.anchor.x*i.width,l=m+h.crop.width,o=i.y-g.anchor.y*i.height,n=o+h.crop.height):(l=h._frame.width*(1-g.anchor.x),m=h._frame.width*-g.anchor.x,n=h._frame.height*(1-g.anchor.y),o=h._frame.height*-g.anchor.y),d[f]=m*j,d[f+1]=o*k,d[f+e]=l*j,d[f+e+1]=o*k,d[f+2*e]=l*j,d[f+2*e+1]=n*k,d[f+3*e]=m*j,d[f+3*e+1]=n*k,f+=4*e},d.prototype.uploadPosition=function(a,b,c,d,e,f){for(var g=0;g<c;g++){var h=a[b+g].position;d[f]=h.x,d[f+1]=h.y,d[f+e]=h.x,d[f+e+1]=h.y,d[f+2*e]=h.x,d[f+2*e+1]=h.y,d[f+3*e]=h.x,d[f+3*e+1]=h.y,f+=4*e}},d.prototype.uploadRotation=function(a,b,c,d,e,f){for(var g=0;g<c;g++){var h=a[b+g].rotation;d[f]=h,d[f+e]=h,d[f+2*e]=h,d[f+3*e]=h,f+=4*e}},d.prototype.uploadUvs=function(a,b,c,d,e,f){for(var g=0;g<c;g++){var h=a[b+g]._texture._uvs;h?(d[f]=h.x0,d[f+1]=h.y0,d[f+e]=h.x1,d[f+e+1]=h.y1,d[f+2*e]=h.x2,d[f+2*e+1]=h.y2,d[f+3*e]=h.x3,d[f+3*e+1]=h.y3,f+=4*e):(d[f]=0,d[f+1]=0,d[f+e]=0,d[f+e+1]=0,d[f+2*e]=0,d[f+2*e+1]=0,d[f+3*e]=0,d[f+3*e+1]=0,f+=4*e)}},d.prototype.uploadAlpha=function(a,b,c,d,e,f){for(var g=0;g<c;g++){var h=a[b+g].alpha;d[f]=h,d[f+e]=h,d[f+2*e]=h,d[f+3*e]=h,f+=4*e}},d.prototype.destroy=function(){this.renderer.gl&&this.renderer.gl.deleteBuffer(this.indexBuffer),e.prototype.destroy.apply(this,arguments),this.shader.destroy(),this.indices=null,this.tempMatrix=null}},{"../../math":33,"../../renderers/webgl/WebGLRenderer":49,"../../renderers/webgl/utils/ObjectRenderer":63,"./ParticleBuffer":40,"./ParticleShader":42}],42:[function(a,b,c){function d(a){e.call(this,a,["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute float aColor;","attribute vec2 aPositionCoord;","attribute vec2 aScale;","attribute float aRotation;","uniform mat3 projectionMatrix;","varying vec2 vTextureCoord;","varying float vColor;","void main(void){","   vec2 v = aVertexPosition;","   v.x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);","   v.y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);","   v = v + aPositionCoord;","   gl_Position = vec4((projectionMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = aColor;","}"].join("\n"),["precision lowp float;","varying vec2 vTextureCoord;","varying float vColor;","uniform sampler2D uSampler;","uniform float uAlpha;","void main(void){","  vec4 color = texture2D(uSampler, vTextureCoord) * vColor * uAlpha;","  if (color.a == 0.0) discard;","  gl_FragColor = color;","}"].join("\n"),{uAlpha:{type:"1f",value:1}},{aPositionCoord:0,aRotation:0})}var e=a("../../renderers/webgl/shaders/TextureShader");d.prototype=(0,s.default)(e.prototype),d.prototype.constructor=d,b.exports=d},{"../../renderers/webgl/shaders/TextureShader":62}],43:[function(a,b,c){function d(a,b,c,d){if(h.call(this),e.sayHello(a),d)for(var i in g.DEFAULT_RENDER_OPTIONS)void 0===d[i]&&(d[i]=g.DEFAULT_RENDER_OPTIONS[i]);else d=g.DEFAULT_RENDER_OPTIONS;this.type=g.RENDERER_TYPE.UNKNOWN,this.width=b||800,this.height=c||600,this.view=d.view||document.createElement("canvas"),this.resolution=d.resolution,this.transparent=d.transparent,this.autoResize=d.autoResize||!1,this.blendModes=null,this.preserveDrawingBuffer=d.preserveDrawingBuffer,this.clearBeforeRender=d.clearBeforeRender,this.roundPixels=d.roundPixels,this._backgroundColor=0,this._backgroundColorRgb=[0,0,0],this._backgroundColorString="#000000",this.backgroundColor=d.backgroundColor||this._backgroundColor,this._tempDisplayObjectParent={worldTransform:new f.Matrix,worldAlpha:1,children:[]},this._lastObjectRendered=this._tempDisplayObjectParent}var e=a("../utils"),f=a("../math"),g=a("../const"),h=a("eventemitter3");d.prototype=(0,s.default)(h.prototype),d.prototype.constructor=d,b.exports=d,(0,m.default)(d.prototype,{backgroundColor:{get:function(){
return this._backgroundColor},set:function(a){this._backgroundColor=a,this._backgroundColorString=e.hex2string(a),e.hex2rgb(a,this._backgroundColorRgb)}}}),d.prototype.resize=function(a,b){this.width=a*this.resolution,this.height=b*this.resolution,this.view.width=this.width,this.view.height=this.height,this.autoResize&&(this.view.style.width=this.width/this.resolution+"px",this.view.style.height=this.height/this.resolution+"px")},d.prototype.destroy=function(a){a&&this.view.parentNode&&this.view.parentNode.removeChild(this.view),this.type=g.RENDERER_TYPE.UNKNOWN,this.width=0,this.height=0,this.view=null,this.resolution=0,this.transparent=!1,this.autoResize=!1,this.blendModes=null,this.preserveDrawingBuffer=!1,this.clearBeforeRender=!1,this.roundPixels=!1,this._backgroundColor=0,this._backgroundColorRgb=null,this._backgroundColorString=null}},{"../const":22,"../math":33,"../utils":77,eventemitter3:10}],44:[function(a,b,c){function d(a,b,c){c=c||{},e.call(this,"Canvas",a,b,c),this.type=i.RENDERER_TYPE.CANVAS,this.context=this.view.getContext("2d",{alpha:this.transparent}),this.refresh=!0,this.maskManager=new f,this.smoothProperty="imageSmoothingEnabled",this.context.imageSmoothingEnabled||(this.context.webkitImageSmoothingEnabled?this.smoothProperty="webkitImageSmoothingEnabled":this.context.mozImageSmoothingEnabled?this.smoothProperty="mozImageSmoothingEnabled":this.context.oImageSmoothingEnabled?this.smoothProperty="oImageSmoothingEnabled":this.context.msImageSmoothingEnabled&&(this.smoothProperty="msImageSmoothingEnabled")),this.initPlugins(),this._mapBlendModes(),this._tempDisplayObjectParent={worldTransform:new h.Matrix,worldAlpha:1},this.resize(a,b)}var e=a("../SystemRenderer"),f=a("./utils/CanvasMaskManager"),g=a("../../utils"),h=a("../../math"),i=a("../../const");d.prototype=(0,s.default)(e.prototype),d.prototype.constructor=d,b.exports=d,g.pluginTarget.mixin(d),d.prototype.render=function(a){this.emit("prerender");var b=a.parent;this._lastObjectRendered=a,a.parent=this._tempDisplayObjectParent,a.updateTransform(),a.parent=b,this.context.setTransform(1,0,0,1,0,0),this.context.globalAlpha=1,this.context.globalCompositeOperation=this.blendModes[i.BLEND_MODES.NORMAL],navigator.isCocoonJS&&this.view.screencanvas&&(this.context.fillStyle="black",this.context.clear()),this.clearBeforeRender&&(this.transparent?this.context.clearRect(0,0,this.width,this.height):(this.context.fillStyle=this._backgroundColorString,this.context.fillRect(0,0,this.width,this.height))),this.renderDisplayObject(a,this.context),this.emit("postrender")},d.prototype.destroy=function(a){this.destroyPlugins(),e.prototype.destroy.call(this,a),this.context=null,this.refresh=!0,this.maskManager.destroy(),this.maskManager=null,this.smoothProperty=null},d.prototype.renderDisplayObject=function(a,b){var c=this.context;this.context=b,a.renderCanvas(this),this.context=c},d.prototype.resize=function(a,b){e.prototype.resize.call(this,a,b),this.smoothProperty&&(this.context[this.smoothProperty]=i.SCALE_MODES.DEFAULT===i.SCALE_MODES.LINEAR)},d.prototype._mapBlendModes=function(){this.blendModes||(this.blendModes={},g.canUseNewCanvasBlendModes()?(this.blendModes[i.BLEND_MODES.NORMAL]="source-over",this.blendModes[i.BLEND_MODES.ADD]="lighter",this.blendModes[i.BLEND_MODES.MULTIPLY]="multiply",this.blendModes[i.BLEND_MODES.SCREEN]="screen",this.blendModes[i.BLEND_MODES.OVERLAY]="overlay",this.blendModes[i.BLEND_MODES.DARKEN]="darken",this.blendModes[i.BLEND_MODES.LIGHTEN]="lighten",this.blendModes[i.BLEND_MODES.COLOR_DODGE]="color-dodge",this.blendModes[i.BLEND_MODES.COLOR_BURN]="color-burn",this.blendModes[i.BLEND_MODES.HARD_LIGHT]="hard-light",this.blendModes[i.BLEND_MODES.SOFT_LIGHT]="soft-light",this.blendModes[i.BLEND_MODES.DIFFERENCE]="difference",this.blendModes[i.BLEND_MODES.EXCLUSION]="exclusion",this.blendModes[i.BLEND_MODES.HUE]="hue",this.blendModes[i.BLEND_MODES.SATURATION]="saturate",this.blendModes[i.BLEND_MODES.COLOR]="color",this.blendModes[i.BLEND_MODES.LUMINOSITY]="luminosity"):(this.blendModes[i.BLEND_MODES.NORMAL]="source-over",this.blendModes[i.BLEND_MODES.ADD]="lighter",this.blendModes[i.BLEND_MODES.MULTIPLY]="source-over",this.blendModes[i.BLEND_MODES.SCREEN]="source-over",this.blendModes[i.BLEND_MODES.OVERLAY]="source-over",this.blendModes[i.BLEND_MODES.DARKEN]="source-over",this.blendModes[i.BLEND_MODES.LIGHTEN]="source-over",this.blendModes[i.BLEND_MODES.COLOR_DODGE]="source-over",this.blendModes[i.BLEND_MODES.COLOR_BURN]="source-over",this.blendModes[i.BLEND_MODES.HARD_LIGHT]="source-over",this.blendModes[i.BLEND_MODES.SOFT_LIGHT]="source-over",this.blendModes[i.BLEND_MODES.DIFFERENCE]="source-over",this.blendModes[i.BLEND_MODES.EXCLUSION]="source-over",this.blendModes[i.BLEND_MODES.HUE]="source-over",this.blendModes[i.BLEND_MODES.SATURATION]="source-over",this.blendModes[i.BLEND_MODES.COLOR]="source-over",this.blendModes[i.BLEND_MODES.LUMINOSITY]="source-over"))}},{"../../const":22,"../../math":33,"../../utils":77,"../SystemRenderer":43,"./utils/CanvasMaskManager":47}],45:[function(a,b,c){function d(a,b){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.canvas.width=a,this.canvas.height=b}d.prototype.constructor=d,b.exports=d,(0,m.default)(d.prototype,{width:{get:function(){return this.canvas.width},set:function(a){this.canvas.width=a}},height:{get:function(){return this.canvas.height},set:function(a){this.canvas.height=a}}}),d.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},d.prototype.resize=function(a,b){this.canvas.width=a,this.canvas.height=b},d.prototype.destroy=function(){this.context=null,this.canvas=null}},{}],46:[function(a,b,c){var d=a("../../../const"),e={};b.exports=e,e.renderGraphics=function(a,b){var c=a.worldAlpha;a.dirty&&(this.updateGraphicsTint(a),a.dirty=!1);for(var e=0;e<a.graphicsData.length;e++){var f=a.graphicsData[e],g=f.shape,h=f._fillTint,i=f._lineTint;if(b.lineWidth=f.lineWidth,f.type===d.SHAPES.POLY){b.beginPath();var j=g.points;b.moveTo(j[0],j[1]);for(var k=1;k<j.length/2;k++)b.lineTo(j[2*k],j[2*k+1]);g.closed&&b.lineTo(j[0],j[1]),j[0]===j[j.length-2]&&j[1]===j[j.length-1]&&b.closePath(),f.fill&&(b.globalAlpha=f.fillAlpha*c,b.fillStyle="#"+("00000"+(0|h).toString(16)).substr(-6),b.fill()),f.lineWidth&&(b.globalAlpha=f.lineAlpha*c,b.strokeStyle="#"+("00000"+(0|i).toString(16)).substr(-6),b.stroke())}else if(f.type===d.SHAPES.RECT)(f.fillColor||0===f.fillColor)&&(b.globalAlpha=f.fillAlpha*c,b.fillStyle="#"+("00000"+(0|h).toString(16)).substr(-6),b.fillRect(g.x,g.y,g.width,g.height)),f.lineWidth&&(b.globalAlpha=f.lineAlpha*c,b.strokeStyle="#"+("00000"+(0|i).toString(16)).substr(-6),b.strokeRect(g.x,g.y,g.width,g.height));else if(f.type===d.SHAPES.CIRC)b.beginPath(),b.arc(g.x,g.y,g.radius,0,2*Math.PI),b.closePath(),f.fill&&(b.globalAlpha=f.fillAlpha*c,b.fillStyle="#"+("00000"+(0|h).toString(16)).substr(-6),b.fill()),f.lineWidth&&(b.globalAlpha=f.lineAlpha*c,b.strokeStyle="#"+("00000"+(0|i).toString(16)).substr(-6),b.stroke());else if(f.type===d.SHAPES.ELIP){var l=2*g.width,m=2*g.height,n=g.x-l/2,o=g.y-m/2;b.beginPath();var p=l/2*.5522848,q=m/2*.5522848,r=n+l,s=o+m,t=n+l/2,u=o+m/2;b.moveTo(n,u),b.bezierCurveTo(n,u-q,t-p,o,t,o),b.bezierCurveTo(t+p,o,r,u-q,r,u),b.bezierCurveTo(r,u+q,t+p,s,t,s),b.bezierCurveTo(t-p,s,n,u+q,n,u),b.closePath(),f.fill&&(b.globalAlpha=f.fillAlpha*c,b.fillStyle="#"+("00000"+(0|h).toString(16)).substr(-6),b.fill()),f.lineWidth&&(b.globalAlpha=f.lineAlpha*c,b.strokeStyle="#"+("00000"+(0|i).toString(16)).substr(-6),b.stroke())}else if(f.type===d.SHAPES.RREC){var v=g.x,w=g.y,x=g.width,y=g.height,z=g.radius,A=Math.min(x,y)/2|0;z=z>A?A:z,b.beginPath(),b.moveTo(v,w+z),b.lineTo(v,w+y-z),b.quadraticCurveTo(v,w+y,v+z,w+y),b.lineTo(v+x-z,w+y),b.quadraticCurveTo(v+x,w+y,v+x,w+y-z),b.lineTo(v+x,w+z),b.quadraticCurveTo(v+x,w,v+x-z,w),b.lineTo(v+z,w),b.quadraticCurveTo(v,w,v,w+z),b.closePath(),(f.fillColor||0===f.fillColor)&&(b.globalAlpha=f.fillAlpha*c,b.fillStyle="#"+("00000"+(0|h).toString(16)).substr(-6),b.fill()),f.lineWidth&&(b.globalAlpha=f.lineAlpha*c,b.strokeStyle="#"+("00000"+(0|i).toString(16)).substr(-6),b.stroke())}}},e.renderGraphicsMask=function(a,b){var c=a.graphicsData.length;if(0!==c){b.beginPath();for(var e=0;e<c;e++){var f=a.graphicsData[e],g=f.shape;if(f.type===d.SHAPES.POLY){var h=g.points;b.moveTo(h[0],h[1]);for(var i=1;i<h.length/2;i++)b.lineTo(h[2*i],h[2*i+1]);h[0]===h[h.length-2]&&h[1]===h[h.length-1]&&b.closePath()}else if(f.type===d.SHAPES.RECT)b.rect(g.x,g.y,g.width,g.height),b.closePath();else if(f.type===d.SHAPES.CIRC)b.arc(g.x,g.y,g.radius,0,2*Math.PI),b.closePath();else if(f.type===d.SHAPES.ELIP){var j=2*g.width,k=2*g.height,l=g.x-j/2,m=g.y-k/2,n=j/2*.5522848,o=k/2*.5522848,p=l+j,q=m+k,r=l+j/2,s=m+k/2;b.moveTo(l,s),b.bezierCurveTo(l,s-o,r-n,m,r,m),b.bezierCurveTo(r+n,m,p,s-o,p,s),b.bezierCurveTo(p,s+o,r+n,q,r,q),b.bezierCurveTo(r-n,q,l,s+o,l,s),b.closePath()}else if(f.type===d.SHAPES.RREC){var t=g.x,u=g.y,v=g.width,w=g.height,x=g.radius,y=Math.min(v,w)/2|0;x=x>y?y:x,b.moveTo(t,u+x),b.lineTo(t,u+w-x),b.quadraticCurveTo(t,u+w,t+x,u+w),b.lineTo(t+v-x,u+w),b.quadraticCurveTo(t+v,u+w,t+v,u+w-x),b.lineTo(t+v,u+x),b.quadraticCurveTo(t+v,u,t+v-x,u),b.lineTo(t+x,u),b.quadraticCurveTo(t,u,t,u+x),b.closePath()}}}},e.updateGraphicsTint=function(a){if(16777215!==a.tint||a._prevTint!==a.tint){a._prevTint=a.tint;for(var b=(a.tint>>16&255)/255,c=(a.tint>>8&255)/255,d=(255&a.tint)/255,e=0;e<a.graphicsData.length;e++){var f=a.graphicsData[e],g=0|f.fillColor,h=0|f.lineColor;f._fillTint=((g>>16&255)/255*b*255<<16)+((g>>8&255)/255*c*255<<8)+(255&g)/255*d*255,f._lineTint=((h>>16&255)/255*b*255<<16)+((h>>8&255)/255*c*255<<8)+(255&h)/255*d*255}}}},{"../../../const":22}],47:[function(a,b,c){function d(){}var e=a("./CanvasGraphics");d.prototype.constructor=d,b.exports=d,d.prototype.pushMask=function(a,b){b.context.save();var c=a.alpha,d=a.worldTransform,f=b.resolution;b.context.setTransform(d.a*f,d.b*f,d.c*f,d.d*f,d.tx*f,d.ty*f),a.texture||(e.renderGraphicsMask(a,b.context),b.context.clip()),a.worldAlpha=c},d.prototype.popMask=function(a){a.context.restore()},d.prototype.destroy=function(){}},{"./CanvasGraphics":46}],48:[function(a,b,c){var d=a("../../../utils"),e={};b.exports=e,e.getTintedTexture=function(a,b){var c=a.texture;b=e.roundColor(b);var d="#"+("00000"+(0|b).toString(16)).substr(-6);if(c.tintCache=c.tintCache||{},c.tintCache[d])return c.tintCache[d];var f=e.canvas||document.createElement("canvas");if(e.tintMethod(c,b,f),e.convertTintToImage){var g=new Image;g.src=f.toDataURL(),c.tintCache[d]=g}else c.tintCache[d]=f,e.canvas=null;return f},e.tintWithMultiply=function(a,b,c){var d=c.getContext("2d"),e=a.baseTexture.resolution,f=a.crop.clone();f.x*=e,f.y*=e,f.width*=e,f.height*=e,c.width=f.width,c.height=f.height,d.fillStyle="#"+("00000"+(0|b).toString(16)).substr(-6),d.fillRect(0,0,f.width,f.height),d.globalCompositeOperation="multiply",d.drawImage(a.baseTexture.source,f.x,f.y,f.width,f.height,0,0,f.width,f.height),d.globalCompositeOperation="destination-atop",d.drawImage(a.baseTexture.source,f.x,f.y,f.width,f.height,0,0,f.width,f.height)},e.tintWithOverlay=function(a,b,c){var d=c.getContext("2d"),e=a.baseTexture.resolution,f=a.crop.clone();f.x*=e,f.y*=e,f.width*=e,f.height*=e,c.width=f.width,c.height=f.height,d.globalCompositeOperation="copy",d.fillStyle="#"+("00000"+(0|b).toString(16)).substr(-6),d.fillRect(0,0,f.width,f.height),d.globalCompositeOperation="destination-atop",d.drawImage(a.baseTexture.source,f.x,f.y,f.width,f.height,0,0,f.width,f.height)},e.tintWithPerPixel=function(a,b,c){var e=c.getContext("2d"),f=a.baseTexture.resolution,g=a.crop.clone();g.x*=f,g.y*=f,g.width*=f,g.height*=f,c.width=g.width,c.height=g.height,e.globalCompositeOperation="copy",e.drawImage(a.baseTexture.source,g.x,g.y,g.width,g.height,0,0,g.width,g.height);for(var h=d.hex2rgb(b),i=h[0],j=h[1],k=h[2],l=e.getImageData(0,0,g.width,g.height),m=l.data,n=0;n<m.length;n+=4)m[n+0]*=i,m[n+1]*=j,m[n+2]*=k;e.putImageData(l,0,0)},e.roundColor=function(a){var b=e.cacheStepsPerColorChannel,c=d.hex2rgb(a);return c[0]=Math.min(255,c[0]/b*b),c[1]=Math.min(255,c[1]/b*b),c[2]=Math.min(255,c[2]/b*b),d.rgb2hex(c)},e.cacheStepsPerColorChannel=8,e.convertTintToImage=!1,e.canUseMultiply=d.canUseNewCanvasBlendModes(),e.tintMethod=e.canUseMultiply?e.tintWithMultiply:e.tintWithPerPixel},{"../../../utils":77}],49:[function(a,b,c){function d(a,b,c){c=c||{},e.call(this,"WebGL",a,b,c),this.type=o.RENDERER_TYPE.WEBGL,this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),this.view.addEventListener("webglcontextlost",this.handleContextLost,!1),this.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1),this._useFXAA=!!c.forceFXAA&&c.antialias,this._FXAAFilter=null,this._contextOptions={alpha:this.transparent,antialias:c.antialias,premultipliedAlpha:this.transparent&&"notMultiplied"!==this.transparent,stencil:!0,preserveDrawingBuffer:c.preserveDrawingBuffer},this.drawCount=0,this.shaderManager=new f(this),this.maskManager=new g(this),this.stencilManager=new h(this),this.filterManager=new i(this),this.blendModeManager=new j(this),this.currentRenderTarget=null,this.currentRenderer=new l(this),this.initPlugins(),this._createContext(),this._initContext(),this._mapGlModes(),this._managedTextures=[],this._renderTargetStack=[]}var e=a("../SystemRenderer"),f=a("./managers/ShaderManager"),g=a("./managers/MaskManager"),h=a("./managers/StencilManager"),i=a("./managers/FilterManager"),j=a("./managers/BlendModeManager"),k=a("./utils/RenderTarget"),l=a("./utils/ObjectRenderer"),m=a("./filters/FXAAFilter"),n=a("../../utils"),o=a("../../const");d.prototype=(0,s.default)(e.prototype),d.prototype.constructor=d,b.exports=d,n.pluginTarget.mixin(d),d.glContextId=0,d.prototype._createContext=function(){var a=this.view.getContext("webgl",this._contextOptions)||this.view.getContext("experimental-webgl",this._contextOptions);if(this.gl=a,!a)throw new Error("This browser does not support webGL. Try using the canvas renderer");this.glContextId=d.glContextId++,a.id=this.glContextId,a.renderer=this},d.prototype._initContext=function(){var a=this.gl;a.disable(a.DEPTH_TEST),a.disable(a.CULL_FACE),a.enable(a.BLEND),this.renderTarget=new k(a,this.width,this.height,null,this.resolution,!0),this.setRenderTarget(this.renderTarget),this.emit("context",a),this.resize(this.width,this.height),this._useFXAA||(this._useFXAA=this._contextOptions.antialias&&!a.getContextAttributes().antialias),this._useFXAA&&(void 0,this._FXAAFilter=[new m])},d.prototype.render=function(a){if(this.emit("prerender"),!this.gl.isContextLost()){this.drawCount=0,this._lastObjectRendered=a,this._useFXAA&&(this._FXAAFilter[0].uniforms.resolution.value.x=this.width,this._FXAAFilter[0].uniforms.resolution.value.y=this.height,a.filterArea=this.renderTarget.size,a.filters=this._FXAAFilter);var b=a.parent;a.parent=this._tempDisplayObjectParent,a.updateTransform(),a.parent=b;var c=this.gl;this.setRenderTarget(this.renderTarget),this.clearBeforeRender&&(this.transparent?c.clearColor(0,0,0,0):c.clearColor(this._backgroundColorRgb[0],this._backgroundColorRgb[1],this._backgroundColorRgb[2],1),c.clear(c.COLOR_BUFFER_BIT)),this.renderDisplayObject(a,this.renderTarget),this.emit("postrender")}},d.prototype.renderDisplayObject=function(a,b,c){this.setRenderTarget(b),c&&b.clear(),this.filterManager.setFilterStack(b.filterStack),a.renderWebGL(this),this.currentRenderer.flush()},d.prototype.setObjectRenderer=function(a){this.currentRenderer!==a&&(this.currentRenderer.stop(),this.currentRenderer=a,this.currentRenderer.start())},d.prototype.setRenderTarget=function(a){this.currentRenderTarget!==a&&(this.currentRenderTarget=a,this.currentRenderTarget.activate(),this.stencilManager.setMaskStack(a.stencilMaskStack))},d.prototype.resize=function(a,b){e.prototype.resize.call(this,a,b),this.filterManager.resize(a,b),this.renderTarget.resize(a,b),this.currentRenderTarget===this.renderTarget&&(this.renderTarget.activate(),this.gl.viewport(0,0,this.width,this.height))},d.prototype.updateTexture=function(a){if(a=a.baseTexture||a,a.hasLoaded){var b=this.gl;return a._glTextures[b.id]||(a._glTextures[b.id]=b.createTexture(),a.on("update",this.updateTexture,this),a.on("dispose",this.destroyTexture,this),this._managedTextures.push(a)),b.bindTexture(b.TEXTURE_2D,a._glTextures[b.id]),b.pixelStorei(b.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a.premultipliedAlpha),b.texImage2D(b.TEXTURE_2D,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,a.source),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,a.scaleMode===o.SCALE_MODES.LINEAR?b.LINEAR:b.NEAREST),a.mipmap&&a.isPowerOfTwo?(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,a.scaleMode===o.SCALE_MODES.LINEAR?b.LINEAR_MIPMAP_LINEAR:b.NEAREST_MIPMAP_NEAREST),b.generateMipmap(b.TEXTURE_2D)):b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,a.scaleMode===o.SCALE_MODES.LINEAR?b.LINEAR:b.NEAREST),a.isPowerOfTwo?(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.REPEAT),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.REPEAT)):(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE)),a._glTextures[b.id]}},d.prototype.destroyTexture=function(a,b){if(a=a.baseTexture||a,a.hasLoaded&&a._glTextures[this.gl.id]&&(this.gl.deleteTexture(a._glTextures[this.gl.id]),delete a._glTextures[this.gl.id],!b)){var c=this._managedTextures.indexOf(a);-1!==c&&n.removeItems(this._managedTextures,c,1)}},d.prototype.handleContextLost=function(a){a.preventDefault()},d.prototype.handleContextRestored=function(){this._initContext();for(var a=0;a<this._managedTextures.length;++a){var b=this._managedTextures[a];b._glTextures[this.gl.id]&&delete b._glTextures[this.gl.id]}},d.prototype.destroy=function(a){this.destroyPlugins(),this.view.removeEventListener("webglcontextlost",this.handleContextLost),this.view.removeEventListener("webglcontextrestored",this.handleContextRestored);for(var b=0;b<this._managedTextures.length;++b){var c=this._managedTextures[b];this.destroyTexture(c,!0),c.off("update",this.updateTexture,this),c.off("dispose",this.destroyTexture,this)}e.prototype.destroy.call(this,a),this.uid=0,this.shaderManager.destroy(),this.maskManager.destroy(),this.stencilManager.destroy(),this.filterManager.destroy(),this.blendModeManager.destroy(),this.shaderManager=null,this.maskManager=null,this.filterManager=null,this.blendModeManager=null,this.currentRenderer=null,this.handleContextLost=null,this.handleContextRestored=null,this._contextOptions=null,this._managedTextures=null,this.drawCount=0,this.gl.useProgram(null),this.gl=null},d.prototype._mapGlModes=function(){var a=this.gl;this.blendModes||(this.blendModes={},this.blendModes[o.BLEND_MODES.NORMAL]=[a.ONE,a.ONE_MINUS_SRC_ALPHA],this.blendModes[o.BLEND_MODES.ADD]=[a.ONE,a.DST_ALPHA],this.blendModes[o.BLEND_MODES.MULTIPLY]=[a.DST_COLOR,a.ONE_MINUS_SRC_ALPHA],this.blendModes[o.BLEND_MODES.SCREEN]=[a.ONE,a.ONE_MINUS_SRC_COLOR],this.blendModes[o.BLEND_MODES.OVERLAY]=[a.ONE,a.ONE_MINUS_SRC_ALPHA],this.blendModes[o.BLEND_MODES.DARKEN]=[a.ONE,a.ONE_MINUS_SRC_ALPHA],this.blendModes[o.BLEND_MODES.LIGHTEN]=[a.ONE,a.ONE_MINUS_SRC_ALPHA],this.blendModes[o.BLEND_MODES.COLOR_DODGE]=[a.ONE,a.ONE_MINUS_SRC_ALPHA],this.blendModes[o.BLEND_MODES.COLOR_BURN]=[a.ONE,a.ONE_MINUS_SRC_ALPHA],this.blendModes[o.BLEND_MODES.HARD_LIGHT]=[a.ONE,a.ONE_MINUS_SRC_ALPHA],this.blendModes[o.BLEND_MODES.SOFT_LIGHT]=[a.ONE,a.ONE_MINUS_SRC_ALPHA],this.blendModes[o.BLEND_MODES.DIFFERENCE]=[a.ONE,a.ONE_MINUS_SRC_ALPHA],this.blendModes[o.BLEND_MODES.EXCLUSION]=[a.ONE,a.ONE_MINUS_SRC_ALPHA],this.blendModes[o.BLEND_MODES.HUE]=[a.ONE,a.ONE_MINUS_SRC_ALPHA],this.blendModes[o.BLEND_MODES.SATURATION]=[a.ONE,a.ONE_MINUS_SRC_ALPHA],this.blendModes[o.BLEND_MODES.COLOR]=[a.ONE,a.ONE_MINUS_SRC_ALPHA],this.blendModes[o.BLEND_MODES.LUMINOSITY]=[a.ONE,a.ONE_MINUS_SRC_ALPHA]),this.drawModes||(this.drawModes={},this.drawModes[o.DRAW_MODES.POINTS]=a.POINTS,this.drawModes[o.DRAW_MODES.LINES]=a.LINES,this.drawModes[o.DRAW_MODES.LINE_LOOP]=a.LINE_LOOP,this.drawModes[o.DRAW_MODES.LINE_STRIP]=a.LINE_STRIP,this.drawModes[o.DRAW_MODES.TRIANGLES]=a.TRIANGLES,this.drawModes[o.DRAW_MODES.TRIANGLE_STRIP]=a.TRIANGLE_STRIP,this.drawModes[o.DRAW_MODES.TRIANGLE_FAN]=a.TRIANGLE_FAN)}},{"../../const":22,"../../utils":77,"../SystemRenderer":43,"./filters/FXAAFilter":51,"./managers/BlendModeManager":53,"./managers/FilterManager":54,"./managers/MaskManager":55,"./managers/ShaderManager":56,"./managers/StencilManager":57,"./utils/ObjectRenderer":63,"./utils/RenderTarget":65}],50:[function(a,b,c){function d(a,b,c){this.shaders=[],this.paddingX=0,this.uniforms=c||{},this.vertexSrc=a||e.defaultVertexSrc,this.fragmentSrc=b||e.defaultFragmentSrc}var e=a("../shaders/TextureShader");d.prototype.constructor=d,b.exports=d,d.prototype.getShader=function(a){var b=a.gl,c=this.shaders[b.id];return c||(c=new e(a.shaderManager,this.vertexSrc,this.fragmentSrc,this.uniforms,this.attributes),this.shaders[b.id]=c),c},d.prototype.applyFilter=function(a,b,c,d){var e=this.getShader(a);a.filterManager.applyFilter(e,b,c,d)},d.prototype.syncUniform=function(a){for(var b=0,c=this.shaders.length;b<c;++b)this.shaders[b].syncUniform(a)}},{"../shaders/TextureShader":62}],51:[function(a,b,c){function d(){e.call(this,"\nprecision mediump float;\n\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nuniform mat3 projectionMatrix;\nuniform vec2 resolution;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvarying vec2 vResolution;\n\n//texcoords computed in vertex step\n//to avoid dependent texture reads\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\n\nvoid texcoords(vec2 fragCoord, vec2 resolution,\n            out vec2 v_rgbNW, out vec2 v_rgbNE,\n            out vec2 v_rgbSW, out vec2 v_rgbSE,\n            out vec2 v_rgbM) {\n    vec2 inverseVP = 1.0 / resolution.xy;\n    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n    v_rgbM = vec2(fragCoord * inverseVP);\n}\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n   vColor = vec4(aColor.rgb * aColor.a, aColor.a);\n   vResolution = resolution;\n\n   //compute the texture coords and send them to varyings\n   texcoords(aTextureCoord * resolution, resolution, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}\n",'precision lowp float;\n\n\n/**\nBasic FXAA implementation based on the code on geeks3d.com with the\nmodification that the texture2DLod stuff was removed since it\'s\nunsupported by WebGL.\n\n--\n\nFrom:\nhttps://github.com/mitsuhiko/webgl-meincraft\n\nCopyright (c) 2011 by Armin Ronacher.\n\nSome rights reserved.\n\nRedistribution and use in source and binary forms, with or without\nmodification, are permitted provided that the following conditions are\nmet:\n\n    * Redistributions of source code must retain the above copyright\n      notice, this list of conditions and the following disclaimer.\n\n    * Redistributions in binary form must reproduce the above\n      copyright notice, this list of conditions and the following\n      disclaimer in the documentation and/or other materials provided\n      with the distribution.\n\n    * The names of the contributors may not be used to endorse or\n      promote products derived from this software without specific\n      prior written permission.\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n"AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\nLIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\nA PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\nOWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\nSPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\nLIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\nDATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\nTHEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\nOF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n#ifndef FXAA_REDUCE_MIN\n    #define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n    #define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n    #define FXAA_SPAN_MAX     8.0\n#endif\n\n//optimized version for mobile, where dependent\n//texture reads can be a bottleneck\nvec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 resolution,\n            vec2 v_rgbNW, vec2 v_rgbNE,\n            vec2 v_rgbSW, vec2 v_rgbSE,\n            vec2 v_rgbM) {\n    vec4 color;\n    mediump vec2 inverseVP = vec2(1.0 / resolution.x, 1.0 / resolution.y);\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n    vec4 texColor = texture2D(tex, v_rgbM);\n    vec3 rgbM  = texColor.xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n\n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n\n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n\n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n              dir * rcpDirMin)) * inverseVP;\n\n    vec3 rgbA = 0.5 * (\n        texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\n        texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n        texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\n        texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\n\n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, texColor.a);\n    else\n        color = vec4(rgbB, texColor.a);\n    return color;\n}\n\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying vec2 vResolution;\n\n//texcoords computed in vertex step\n//to avoid dependent texture reads\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nuniform sampler2D uSampler;\n\n\nvoid main(void){\n\n    gl_FragColor = fxaa(uSampler, vTextureCoord * vResolution, vResolution, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n\n}\n',{resolution:{type:"v2",value:{x:1,y:1}}})}var e=a("./AbstractFilter");d.prototype=(0,s.default)(e.prototype),d.prototype.constructor=d,b.exports=d,d.prototype.applyFilter=function(a,b,c){var d=a.filterManager,e=this.getShader(a);d.applyFilter(e,b,c)}},{"./AbstractFilter":50}],52:[function(a,b,c){function d(a){var b=new f.Matrix;e.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n    vColor = vec4(aColor.rgb * aColor.a, aColor.a);\n}\n","precision lowp float;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\nuniform float alpha;\nuniform sampler2D mask;\n\nvoid main(void)\n{\n    // check clip! this will stop the mask bleeding out from the edges\n    vec2 text = abs( vMaskCoord - 0.5 );\n    text = step(0.5, text);\n    float clip = 1.0 - max(text.y, text.x);\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    original *= (masky.r * masky.a * alpha * clip);\n    gl_FragColor = original;\n}\n",{mask:{type:"sampler2D",value:a._texture},alpha:{type:"f",value:1},otherMatrix:{type:"mat3",value:b.toArray(!0)}}),this.maskSprite=a,this.maskMatrix=b}var e=a("./AbstractFilter"),f=a("../../../math");d.prototype=(0,s.default)(e.prototype),d.prototype.constructor=d,b.exports=d,d.prototype.applyFilter=function(a,b,c){var d=a.filterManager;this.uniforms.mask.value=this.maskSprite._texture,d.calculateMappedMatrix(b.frame,this.maskSprite,this.maskMatrix),this.uniforms.otherMatrix.value=this.maskMatrix.toArray(!0),this.uniforms.alpha.value=this.maskSprite.worldAlpha;var e=this.getShader(a);d.applyFilter(e,b,c)},(0,m.default)(d.prototype,{map:{get:function(){return this.uniforms.mask.value},set:function(a){this.uniforms.mask.value=a}},offset:{get:function(){return this.uniforms.offset.value},set:function(a){this.uniforms.offset.value=a}}})},{"../../../math":33,"./AbstractFilter":50}],53:[function(a,b,c){function d(a){e.call(this,a),this.currentBlendMode=99999}var e=a("./WebGLManager");d.prototype=(0,s.default)(e.prototype),d.prototype.constructor=d,b.exports=d,d.prototype.setBlendMode=function(a){if(this.currentBlendMode===a)return!1;this.currentBlendMode=a;var b=this.renderer.blendModes[this.currentBlendMode];return this.renderer.gl.blendFunc(b[0],b[1]),!0}},{"./WebGLManager":58}],54:[function(a,b,c){function d(a){e.call(this,a),this.filterStack=[],this.filterStack.push({renderTarget:a.currentRenderTarget,filter:[],bounds:null}),this.texturePool=[],this.textureSize=new i.Rectangle(0,0,a.width,a.height),this.currentFrame=null}var e=a("./WebGLManager"),f=a("../utils/RenderTarget"),g=a("../../../const"),h=a("../utils/Quad"),i=a("../../../math");d.prototype=(0,s.default)(e.prototype),d.prototype.constructor=d,b.exports=d,d.prototype.onContextChange=function(){this.texturePool.length=0;var a=this.renderer.gl;this.quad=new h(a)},d.prototype.setFilterStack=function(a){this.filterStack=a},d.prototype.pushFilter=function(a,b){var c=a.filterArea?a.filterArea.clone():a.getBounds();c.x=0|c.x,c.y=0|c.y,c.width=0|c.width,c.height=0|c.height;var d=0|b[0].paddingX;if(c.x-=d,c.y-=d,c.width+=2*d,c.height+=2*d,this.renderer.currentRenderTarget.transform){var e=this.renderer.currentRenderTarget.transform;c.x+=e.tx,c.y+=e.ty,this.capFilterArea(c),c.x-=e.tx,c.y-=e.ty}else this.capFilterArea(c);if(c.width>0&&c.height>0){this.currentFrame=c;var f=this.getRenderTarget();this.renderer.setRenderTarget(f),f.clear(),this.filterStack.push({renderTarget:f,filter:b})}else this.filterStack.push({renderTarget:null,filter:b})},d.prototype.popFilter=function(){var a=this.filterStack.pop(),b=this.filterStack[this.filterStack.length-1],c=a.renderTarget;if(a.renderTarget){var d=b.renderTarget,e=this.renderer.gl;this.currentFrame=c.frame,this.quad.map(this.textureSize,c.frame),e.bindBuffer(e.ARRAY_BUFFER,this.quad.vertexBuffer),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.quad.indexBuffer);var f=a.filter;if(e.vertexAttribPointer(this.renderer.shaderManager.defaultShader.attributes.aVertexPosition,2,e.FLOAT,!1,0,0),e.vertexAttribPointer(this.renderer.shaderManager.defaultShader.attributes.aTextureCoord,2,e.FLOAT,!1,0,32),e.vertexAttribPointer(this.renderer.shaderManager.defaultShader.attributes.aColor,4,e.FLOAT,!1,0,64),this.renderer.blendModeManager.setBlendMode(g.BLEND_MODES.NORMAL),
1===f.length)f[0].uniforms.dimensions&&(f[0].uniforms.dimensions.value[0]=this.renderer.width,f[0].uniforms.dimensions.value[1]=this.renderer.height,f[0].uniforms.dimensions.value[2]=this.quad.vertices[0],f[0].uniforms.dimensions.value[3]=this.quad.vertices[5]),f[0].applyFilter(this.renderer,c,d),this.returnRenderTarget(c);else{for(var h=c,i=this.getRenderTarget(!0),j=0;j<f.length-1;j++){var k=f[j];k.uniforms.dimensions&&(k.uniforms.dimensions.value[0]=this.renderer.width,k.uniforms.dimensions.value[1]=this.renderer.height,k.uniforms.dimensions.value[2]=this.quad.vertices[0],k.uniforms.dimensions.value[3]=this.quad.vertices[5]),k.applyFilter(this.renderer,h,i);var l=h;h=i,i=l}f[f.length-1].applyFilter(this.renderer,h,d),this.returnRenderTarget(h),this.returnRenderTarget(i)}return a.filter}},d.prototype.getRenderTarget=function(a){var b=this.texturePool.pop()||new f(this.renderer.gl,this.textureSize.width,this.textureSize.height,g.SCALE_MODES.LINEAR,this.renderer.resolution*g.FILTER_RESOLUTION);return b.frame=this.currentFrame,a&&b.clear(!0),b},d.prototype.returnRenderTarget=function(a){this.texturePool.push(a)},d.prototype.applyFilter=function(a,b,c,d){var e=this.renderer.gl;this.renderer.setRenderTarget(c),d&&c.clear(),this.renderer.shaderManager.setShader(a),a.uniforms.projectionMatrix.value=this.renderer.currentRenderTarget.projectionMatrix.toArray(!0),a.syncUniforms(),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,b.texture),e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0),this.renderer.drawCount++},d.prototype.calculateMappedMatrix=function(a,b,c){var d=b.worldTransform.copy(i.Matrix.TEMP_MATRIX),e=b._texture.baseTexture,f=c.identity(),g=this.textureSize.height/this.textureSize.width;f.translate(a.x/this.textureSize.width,a.y/this.textureSize.height),f.scale(1,g);var h=this.textureSize.width/e.width,j=this.textureSize.height/e.height;return d.tx/=e.width*h,d.ty/=e.width*h,d.invert(),f.prepend(d),f.scale(1,1/g),f.scale(h,j),f.translate(b.anchor.x,b.anchor.y),f},d.prototype.capFilterArea=function(a){a.x<0&&(a.width+=a.x,a.x=0),a.y<0&&(a.height+=a.y,a.y=0),a.x+a.width>this.textureSize.width&&(a.width=this.textureSize.width-a.x),a.y+a.height>this.textureSize.height&&(a.height=this.textureSize.height-a.y)},d.prototype.resize=function(a,b){this.textureSize.width=a,this.textureSize.height=b;for(var c=0;c<this.texturePool.length;c++)this.texturePool[c].resize(a,b)},d.prototype.destroy=function(){this.quad.destroy(),e.prototype.destroy.call(this),this.filterStack=null,this.offsetY=0;for(var a=0;a<this.texturePool.length;a++)this.texturePool[a].destroy();this.texturePool=null}},{"../../../const":22,"../../../math":33,"../utils/Quad":64,"../utils/RenderTarget":65,"./WebGLManager":58}],55:[function(a,b,c){function d(a){e.call(this,a),this.stencilStack=[],this.reverse=!0,this.count=0,this.alphaMaskPool=[]}var e=a("./WebGLManager"),f=a("../filters/SpriteMaskFilter");d.prototype=(0,s.default)(e.prototype),d.prototype.constructor=d,b.exports=d,d.prototype.pushMask=function(a,b){b.texture?this.pushSpriteMask(a,b):this.pushStencilMask(a,b)},d.prototype.popMask=function(a,b){b.texture?this.popSpriteMask(a,b):this.popStencilMask(a,b)},d.prototype.pushSpriteMask=function(a,b){var c=this.alphaMaskPool.pop();c||(c=[new f(b)]),c[0].maskSprite=b,this.renderer.filterManager.pushFilter(a,c)},d.prototype.popSpriteMask=function(){var a=this.renderer.filterManager.popFilter();this.alphaMaskPool.push(a)},d.prototype.pushStencilMask=function(a,b){this.renderer.stencilManager.pushMask(b)},d.prototype.popStencilMask=function(a,b){this.renderer.stencilManager.popMask(b)}},{"../filters/SpriteMaskFilter":52,"./WebGLManager":58}],56:[function(a,b,c){function d(a){e.call(this,a),this.maxAttibs=10,this.attribState=[],this.tempAttribState=[];for(var b=0;b<this.maxAttibs;b++)this.attribState[b]=!1;this.stack=[],this._currentId=-1,this.currentShader=null}var e=a("./WebGLManager"),f=a("../shaders/TextureShader"),g=a("../shaders/ComplexPrimitiveShader"),h=a("../shaders/PrimitiveShader"),i=a("../../../utils");d.prototype=(0,s.default)(e.prototype),d.prototype.constructor=d,i.pluginTarget.mixin(d),b.exports=d,d.prototype.onContextChange=function(){this.initPlugins();var a=this.renderer.gl;this.maxAttibs=a.getParameter(a.MAX_VERTEX_ATTRIBS),this.attribState=[];for(var b=0;b<this.maxAttibs;b++)this.attribState[b]=!1;this.defaultShader=new f(this),this.primitiveShader=new h(this),this.complexPrimitiveShader=new g(this)},d.prototype.setAttribs=function(a){var b;for(b=0;b<this.tempAttribState.length;b++)this.tempAttribState[b]=!1;for(var c in a)this.tempAttribState[a[c]]=!0;var d=this.renderer.gl;for(b=0;b<this.attribState.length;b++)this.attribState[b]!==this.tempAttribState[b]&&(this.attribState[b]=this.tempAttribState[b],this.attribState[b]?d.enableVertexAttribArray(b):d.disableVertexAttribArray(b))},d.prototype.setShader=function(a){return this._currentId!==a.uid&&(this._currentId=a.uid,this.currentShader=a,this.renderer.gl.useProgram(a.program),this.setAttribs(a.attributes),!0)},d.prototype.destroy=function(){this.primitiveShader.destroy(),this.complexPrimitiveShader.destroy(),e.prototype.destroy.call(this),this.destroyPlugins(),this.attribState=null,this.tempAttribState=null}},{"../../../utils":77,"../shaders/ComplexPrimitiveShader":59,"../shaders/PrimitiveShader":60,"../shaders/TextureShader":62,"./WebGLManager":58}],57:[function(a,b,c){function d(a){e.call(this,a),this.stencilMaskStack=null}var e=a("./WebGLManager"),f=a("../../../utils");d.prototype=(0,s.default)(e.prototype),d.prototype.constructor=d,b.exports=d,d.prototype.setMaskStack=function(a){this.stencilMaskStack=a;var b=this.renderer.gl;0===a.stencilStack.length?b.disable(b.STENCIL_TEST):b.enable(b.STENCIL_TEST)},d.prototype.pushStencil=function(a,b){this.renderer.currentRenderTarget.attachStencilBuffer();var c=this.renderer.gl,d=this.stencilMaskStack;this.bindGraphics(a,b),0===d.stencilStack.length&&(c.enable(c.STENCIL_TEST),c.clear(c.STENCIL_BUFFER_BIT),d.reverse=!0,d.count=0),d.stencilStack.push(b);var e=d.count;c.colorMask(!1,!1,!1,!1),c.stencilFunc(c.ALWAYS,0,255),c.stencilOp(c.KEEP,c.KEEP,c.INVERT),1===b.mode?(c.drawElements(c.TRIANGLE_FAN,b.indices.length-4,c.UNSIGNED_SHORT,0),d.reverse?(c.stencilFunc(c.EQUAL,255-e,255),c.stencilOp(c.KEEP,c.KEEP,c.DECR)):(c.stencilFunc(c.EQUAL,e,255),c.stencilOp(c.KEEP,c.KEEP,c.INCR)),c.drawElements(c.TRIANGLE_FAN,4,c.UNSIGNED_SHORT,2*(b.indices.length-4)),d.reverse?c.stencilFunc(c.EQUAL,255-(e+1),255):c.stencilFunc(c.EQUAL,e+1,255),d.reverse=!d.reverse):(d.reverse?(c.stencilFunc(c.EQUAL,e,255),c.stencilOp(c.KEEP,c.KEEP,c.INCR)):(c.stencilFunc(c.EQUAL,255-e,255),c.stencilOp(c.KEEP,c.KEEP,c.DECR)),c.drawElements(c.TRIANGLE_STRIP,b.indices.length,c.UNSIGNED_SHORT,0),d.reverse?c.stencilFunc(c.EQUAL,e+1,255):c.stencilFunc(c.EQUAL,255-(e+1),255)),c.colorMask(!0,!0,!0,!0),c.stencilOp(c.KEEP,c.KEEP,c.KEEP),d.count++},d.prototype.bindGraphics=function(a,b){var c,d=this.renderer.gl;1===b.mode?(c=this.renderer.shaderManager.complexPrimitiveShader,this.renderer.shaderManager.setShader(c),d.uniformMatrix3fv(c.uniforms.translationMatrix._location,!1,a.worldTransform.toArray(!0)),d.uniformMatrix3fv(c.uniforms.projectionMatrix._location,!1,this.renderer.currentRenderTarget.projectionMatrix.toArray(!0)),d.uniform3fv(c.uniforms.tint._location,f.hex2rgb(a.tint)),d.uniform3fv(c.uniforms.color._location,b.color),d.uniform1f(c.uniforms.alpha._location,a.worldAlpha),d.bindBuffer(d.ARRAY_BUFFER,b.buffer),d.vertexAttribPointer(c.attributes.aVertexPosition,2,d.FLOAT,!1,8,0),d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,b.indexBuffer)):(c=this.renderer.shaderManager.primitiveShader,this.renderer.shaderManager.setShader(c),d.uniformMatrix3fv(c.uniforms.translationMatrix._location,!1,a.worldTransform.toArray(!0)),d.uniformMatrix3fv(c.uniforms.projectionMatrix._location,!1,this.renderer.currentRenderTarget.projectionMatrix.toArray(!0)),d.uniform3fv(c.uniforms.tint._location,f.hex2rgb(a.tint)),d.uniform1f(c.uniforms.alpha._location,a.worldAlpha),d.bindBuffer(d.ARRAY_BUFFER,b.buffer),d.vertexAttribPointer(c.attributes.aVertexPosition,2,d.FLOAT,!1,24,0),d.vertexAttribPointer(c.attributes.aColor,4,d.FLOAT,!1,24,8),d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,b.indexBuffer))},d.prototype.popStencil=function(a,b){var c=this.renderer.gl,d=this.stencilMaskStack;if(d.stencilStack.pop(),d.count--,0===d.stencilStack.length)c.disable(c.STENCIL_TEST);else{var e=d.count;this.bindGraphics(a,b),c.colorMask(!1,!1,!1,!1),1===b.mode?(d.reverse=!d.reverse,d.reverse?(c.stencilFunc(c.EQUAL,255-(e+1),255),c.stencilOp(c.KEEP,c.KEEP,c.INCR)):(c.stencilFunc(c.EQUAL,e+1,255),c.stencilOp(c.KEEP,c.KEEP,c.DECR)),c.drawElements(c.TRIANGLE_FAN,4,c.UNSIGNED_SHORT,2*(b.indices.length-4)),c.stencilFunc(c.ALWAYS,0,255),c.stencilOp(c.KEEP,c.KEEP,c.INVERT),c.drawElements(c.TRIANGLE_FAN,b.indices.length-4,c.UNSIGNED_SHORT,0),this.renderer.drawCount+=2,d.reverse?c.stencilFunc(c.EQUAL,e,255):c.stencilFunc(c.EQUAL,255-e,255)):(d.reverse?(c.stencilFunc(c.EQUAL,e+1,255),c.stencilOp(c.KEEP,c.KEEP,c.DECR)):(c.stencilFunc(c.EQUAL,255-(e+1),255),c.stencilOp(c.KEEP,c.KEEP,c.INCR)),c.drawElements(c.TRIANGLE_STRIP,b.indices.length,c.UNSIGNED_SHORT,0),this.renderer.drawCount++,d.reverse?c.stencilFunc(c.EQUAL,e,255):c.stencilFunc(c.EQUAL,255-e,255)),c.colorMask(!0,!0,!0,!0),c.stencilOp(c.KEEP,c.KEEP,c.KEEP)}},d.prototype.destroy=function(){e.prototype.destroy.call(this),this.stencilMaskStack.stencilStack=null},d.prototype.pushMask=function(a){this.renderer.setObjectRenderer(this.renderer.plugins.graphics),a.dirty&&this.renderer.plugins.graphics.updateGraphics(a,this.renderer.gl),a._webGL[this.renderer.gl.id].data.length&&this.pushStencil(a,a._webGL[this.renderer.gl.id].data[0])},d.prototype.popMask=function(a){this.renderer.setObjectRenderer(this.renderer.plugins.graphics),this.popStencil(a,a._webGL[this.renderer.gl.id].data[0])}},{"../../../utils":77,"./WebGLManager":58}],58:[function(a,b,c){function d(a){this.renderer=a,this.renderer.on("context",this.onContextChange,this)}d.prototype.constructor=d,b.exports=d,d.prototype.onContextChange=function(){},d.prototype.destroy=function(){this.renderer.off("context",this.onContextChange,this),this.renderer=null}},{}],59:[function(a,b,c){function d(a){e.call(this,a,["attribute vec2 aVertexPosition;","uniform mat3 translationMatrix;","uniform mat3 projectionMatrix;","uniform vec3 tint;","uniform float alpha;","uniform vec3 color;","varying vec4 vColor;","void main(void){","   gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vColor = vec4(color * alpha * tint, alpha);","}"].join("\n"),["precision mediump float;","varying vec4 vColor;","void main(void){","   gl_FragColor = vColor;","}"].join("\n"),{tint:{type:"3f",value:[0,0,0]},alpha:{type:"1f",value:0},color:{type:"3f",value:[0,0,0]},translationMatrix:{type:"mat3",value:new Float32Array(9)},projectionMatrix:{type:"mat3",value:new Float32Array(9)}},{aVertexPosition:0})}var e=a("./Shader");d.prototype=(0,s.default)(e.prototype),d.prototype.constructor=d,b.exports=d},{"./Shader":61}],60:[function(a,b,c){function d(a){e.call(this,a,["attribute vec2 aVertexPosition;","attribute vec4 aColor;","uniform mat3 translationMatrix;","uniform mat3 projectionMatrix;","uniform float alpha;","uniform float flipY;","uniform vec3 tint;","varying vec4 vColor;","void main(void){","   gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vColor = aColor * vec4(tint * alpha, alpha);","}"].join("\n"),["precision mediump float;","varying vec4 vColor;","void main(void){","   gl_FragColor = vColor;","}"].join("\n"),{tint:{type:"3f",value:[0,0,0]},alpha:{type:"1f",value:0},translationMatrix:{type:"mat3",value:new Float32Array(9)},projectionMatrix:{type:"mat3",value:new Float32Array(9)}},{aVertexPosition:0,aColor:0})}var e=a("./Shader");d.prototype=(0,s.default)(e.prototype),d.prototype.constructor=d,b.exports=d},{"./Shader":61}],61:[function(a,b,c){function d(a,b,c,d,f){if(!b||!c)throw new Error("Pixi.js Error. Shader requires vertexSrc and fragmentSrc");this.uid=e.uid(),this.gl=a.renderer.gl,this.shaderManager=a,this.program=null,this.uniforms=d||{},this.attributes=f||{},this.textureCount=1,this.vertexSrc=b,this.fragmentSrc=c,this.init()}var e=a("../../../utils");d.prototype.constructor=d,b.exports=d,d.prototype.init=function(){this.compile(),this.gl.useProgram(this.program),this.cacheUniformLocations((0,w.default)(this.uniforms)),this.cacheAttributeLocations((0,w.default)(this.attributes))},d.prototype.cacheUniformLocations=function(a){for(var b=0;b<a.length;++b)this.uniforms[a[b]]._location=this.gl.getUniformLocation(this.program,a[b])},d.prototype.cacheAttributeLocations=function(a){for(var b=0;b<a.length;++b)this.attributes[a[b]]=this.gl.getAttribLocation(this.program,a[b])},d.prototype.compile=function(){var a=this.gl,b=this._glCompile(a.VERTEX_SHADER,this.vertexSrc),c=this._glCompile(a.FRAGMENT_SHADER,this.fragmentSrc),d=a.createProgram();return a.attachShader(d,b),a.attachShader(d,c),a.linkProgram(d),a.getProgramParameter(d,a.LINK_STATUS)||(void 0,void 0,void 0,""!==a.getProgramInfoLog(d)&&void 0,a.deleteProgram(d),d=null),a.deleteShader(b),a.deleteShader(c),this.program=d},d.prototype.syncUniform=function(a){var b,c,d=a._location,f=a.value,g=this.gl;switch(a.type){case"b":case"bool":case"boolean":g.uniform1i(d,f?1:0);break;case"i":case"1i":g.uniform1i(d,f);break;case"f":case"1f":g.uniform1f(d,f);break;case"2f":g.uniform2f(d,f[0],f[1]);break;case"3f":g.uniform3f(d,f[0],f[1],f[2]);break;case"4f":g.uniform4f(d,f[0],f[1],f[2],f[3]);break;case"v2":g.uniform2f(d,f.x,f.y);break;case"v3":g.uniform3f(d,f.x,f.y,f.z);break;case"v4":g.uniform4f(d,f.x,f.y,f.z,f.w);break;case"1iv":g.uniform1iv(d,f);break;case"2iv":g.uniform2iv(d,f);break;case"3iv":g.uniform3iv(d,f);break;case"4iv":g.uniform4iv(d,f);break;case"1fv":g.uniform1fv(d,f);break;case"2fv":g.uniform2fv(d,f);break;case"3fv":g.uniform3fv(d,f);break;case"4fv":g.uniform4fv(d,f);break;case"m2":case"mat2":case"Matrix2fv":g.uniformMatrix2fv(d,a.transpose,f);break;case"m3":case"mat3":case"Matrix3fv":g.uniformMatrix3fv(d,a.transpose,f);break;case"m4":case"mat4":case"Matrix4fv":g.uniformMatrix4fv(d,a.transpose,f);break;case"c":"number"==typeof f&&(f=e.hex2rgb(f)),g.uniform3f(d,f[0],f[1],f[2]);break;case"iv1":g.uniform1iv(d,f);break;case"iv":g.uniform3iv(d,f);break;case"fv1":g.uniform1fv(d,f);break;case"fv":g.uniform3fv(d,f);break;case"v2v":for(a._array||(a._array=new Float32Array(2*f.length)),b=0,c=f.length;b<c;++b)a._array[2*b]=f[b].x,a._array[2*b+1]=f[b].y;g.uniform2fv(d,a._array);break;case"v3v":for(a._array||(a._array=new Float32Array(3*f.length)),b=0,c=f.length;b<c;++b)a._array[3*b]=f[b].x,a._array[3*b+1]=f[b].y,a._array[3*b+2]=f[b].z;g.uniform3fv(d,a._array);break;case"v4v":for(a._array||(a._array=new Float32Array(4*f.length)),b=0,c=f.length;b<c;++b)a._array[4*b]=f[b].x,a._array[4*b+1]=f[b].y,a._array[4*b+2]=f[b].z,a._array[4*b+3]=f[b].w;g.uniform4fv(d,a._array);break;case"t":case"sampler2D":if(!a.value||!a.value.baseTexture.hasLoaded)break;g.activeTexture(g["TEXTURE"+this.textureCount]);var h=a.value.baseTexture._glTextures[g.id];h||(this.initSampler2D(a),h=a.value.baseTexture._glTextures[g.id]),g.bindTexture(g.TEXTURE_2D,h),g.uniform1i(a._location,this.textureCount),this.textureCount++;break;default:void 0}},d.prototype.syncUniforms=function(){this.textureCount=1;for(var a in this.uniforms)this.syncUniform(this.uniforms[a])},d.prototype.initSampler2D=function(a){var b=this.gl,c=a.value.baseTexture;if(c.hasLoaded)if(a.textureData){var d=a.textureData;c._glTextures[b.id]=b.createTexture(),b.bindTexture(b.TEXTURE_2D,c._glTextures[b.id]),b.pixelStorei(b.UNPACK_PREMULTIPLY_ALPHA_WEBGL,c.premultipliedAlpha),b.texImage2D(b.TEXTURE_2D,0,d.luminance?b.LUMINANCE:b.RGBA,b.RGBA,b.UNSIGNED_BYTE,c.source),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,d.magFilter?d.magFilter:b.LINEAR),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,d.wrapS?d.wrapS:b.CLAMP_TO_EDGE),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,d.wrapS?d.wrapS:b.CLAMP_TO_EDGE),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,d.wrapT?d.wrapT:b.CLAMP_TO_EDGE)}else this.shaderManager.renderer.updateTexture(c)},d.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.gl=null,this.uniforms=null,this.attributes=null,this.vertexSrc=null,this.fragmentSrc=null},d.prototype._glCompile=function(a,b){var c=this.gl.createShader(a);return this.gl.shaderSource(c,b),this.gl.compileShader(c),this.gl.getShaderParameter(c,this.gl.COMPILE_STATUS)?c:null}},{"../../../utils":77}],62:[function(a,b,c){function d(a,b,c,f,g){var h={uSampler:{type:"sampler2D",value:0},projectionMatrix:{type:"mat3",value:new Float32Array([1,0,0,0,1,0,0,0,1])}};if(f)for(var i in f)h[i]=f[i];var j={aVertexPosition:0,aTextureCoord:0,aColor:0};if(g)for(var k in g)j[k]=g[k];b=b||d.defaultVertexSrc,c=c||d.defaultFragmentSrc,e.call(this,a,b,c,h,j)}var e=a("./Shader");d.prototype=(0,s.default)(e.prototype),d.prototype.constructor=d,b.exports=d,d.defaultVertexSrc=["precision lowp float;","attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute vec4 aColor;","uniform mat3 projectionMatrix;","varying vec2 vTextureCoord;","varying vec4 vColor;","void main(void){","   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = vec4(aColor.rgb * aColor.a, aColor.a);","}"].join("\n"),d.defaultFragmentSrc=["precision lowp float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","void main(void){","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"].join("\n")},{"./Shader":61}],63:[function(a,b,c){function d(a){e.call(this,a)}var e=a("../managers/WebGLManager");d.prototype=(0,s.default)(e.prototype),d.prototype.constructor=d,b.exports=d,d.prototype.start=function(){},d.prototype.stop=function(){this.flush()},d.prototype.flush=function(){},d.prototype.render=function(a){}},{"../managers/WebGLManager":58}],64:[function(a,b,c){function d(a){this.gl=a,this.vertices=new Float32Array([0,0,200,0,200,200,0,200]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.colors=new Float32Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]),this.indices=new Uint16Array([0,1,2,0,3,2]),this.vertexBuffer=a.createBuffer(),this.indexBuffer=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,this.vertexBuffer),a.bufferData(a.ARRAY_BUFFER,128,a.DYNAMIC_DRAW),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.indexBuffer),a.bufferData(a.ELEMENT_ARRAY_BUFFER,this.indices,a.STATIC_DRAW),this.upload()}d.prototype.constructor=d,d.prototype.map=function(a,b){var c=0,d=0;this.uvs[0]=c,this.uvs[1]=d,this.uvs[2]=c+b.width/a.width,this.uvs[3]=d,this.uvs[4]=c+b.width/a.width,this.uvs[5]=d+b.height/a.height,this.uvs[6]=c,this.uvs[7]=d+b.height/a.height,c=b.x,d=b.y,this.vertices[0]=c,this.vertices[1]=d,this.vertices[2]=c+b.width,this.vertices[3]=d,this.vertices[4]=c+b.width,this.vertices[5]=d+b.height,this.vertices[6]=c,this.vertices[7]=d+b.height,this.upload()},d.prototype.save=function(){var a=this.gl;a.bindBuffer(a.ARRAY_BUFFER,this.vertexBuffer),a.bufferSubData(a.ARRAY_BUFFER,0,this.vertices),a.bufferSubData(a.ARRAY_BUFFER,32,this.uvs),a.bufferSubData(a.ARRAY_BUFFER,64,this.colors)},d.prototype.destroy=function(){var a=this.gl;a.deleteBuffer(this.vertexBuffer),a.deleteBuffer(this.indexBuffer)},b.exports=d},{}],65:[function(a,b,c){var d=a("../../../math"),e=a("../../../utils"),f=a("../../../const"),g=a("./StencilMaskStack"),h=function(a,b,c,h,i,j){if(this.gl=a,this.frameBuffer=null,this.texture=null,this.size=new d.Rectangle(0,0,1,1),this.resolution=i||f.RESOLUTION,this.projectionMatrix=new d.Matrix,this.transform=null,this.frame=null,this.stencilBuffer=null,this.stencilMaskStack=new g,this.filterStack=[{renderTarget:this,filter:[],bounds:this.size}],this.scaleMode=h||f.SCALE_MODES.DEFAULT,this.root=j,!this.root){this.frameBuffer=a.createFramebuffer(),this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,h===f.SCALE_MODES.LINEAR?a.LINEAR:a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,h===f.SCALE_MODES.LINEAR?a.LINEAR:a.NEAREST);e.isPowerOfTwo(b,c)?(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.REPEAT)):(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE)),a.bindFramebuffer(a.FRAMEBUFFER,this.frameBuffer),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,this.texture,0)}this.resize(b,c)};h.prototype.constructor=h,b.exports=h,h.prototype.clear=function(a){var b=this.gl;a&&b.bindFramebuffer(b.FRAMEBUFFER,this.frameBuffer),b.clearColor(0,0,0,0),b.clear(b.COLOR_BUFFER_BIT)},h.prototype.attachStencilBuffer=function(){if(!this.stencilBuffer&&!this.root){var a=this.gl;this.stencilBuffer=a.createRenderbuffer(),a.bindRenderbuffer(a.RENDERBUFFER,this.stencilBuffer),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,this.stencilBuffer),a.renderbufferStorage(a.RENDERBUFFER,a.DEPTH_STENCIL,this.size.width*this.resolution,this.size.height*this.resolution)}},h.prototype.activate=function(){var a=this.gl;a.bindFramebuffer(a.FRAMEBUFFER,this.frameBuffer);var b=this.frame||this.size;this.calculateProjection(b),this.transform&&this.projectionMatrix.append(this.transform),a.viewport(0,0,b.width*this.resolution,b.height*this.resolution)},h.prototype.calculateProjection=function(a){var b=this.projectionMatrix;b.identity(),this.root?(b.a=1/a.width*2,b.d=-1/a.height*2,b.tx=-1-a.x*b.a,b.ty=1-a.y*b.d):(b.a=1/a.width*2,b.d=1/a.height*2,b.tx=-1-a.x*b.a,b.ty=-1-a.y*b.d)},h.prototype.resize=function(a,b){if(a|=0,b|=0,this.size.width!==a||this.size.height!==b){if(this.size.width=a,this.size.height=b,!this.root){var c=this.gl;c.bindTexture(c.TEXTURE_2D,this.texture),c.texImage2D(c.TEXTURE_2D,0,c.RGBA,a*this.resolution,b*this.resolution,0,c.RGBA,c.UNSIGNED_BYTE,null),this.stencilBuffer&&(c.bindRenderbuffer(c.RENDERBUFFER,this.stencilBuffer),c.renderbufferStorage(c.RENDERBUFFER,c.DEPTH_STENCIL,a*this.resolution,b*this.resolution))}var d=this.frame||this.size;this.calculateProjection(d)}},h.prototype.destroy=function(){var a=this.gl;a.deleteRenderbuffer(this.stencilBuffer),a.deleteFramebuffer(this.frameBuffer),a.deleteTexture(this.texture),this.frameBuffer=null,this.texture=null}},{"../../../const":22,"../../../math":33,"../../../utils":77,"./StencilMaskStack":66}],66:[function(a,b,c){function d(){this.stencilStack=[],this.reverse=!0,this.count=0}d.prototype.constructor=d,b.exports=d},{}],67:[function(a,b,c){function d(a){g.call(this),this.anchor=new e.Point,this._texture=null,this._width=0,this._height=0,this.tint=16777215,this.blendMode=j.BLEND_MODES.NORMAL,this.shader=null,this.cachedTint=16777215,this.texture=a||f.EMPTY}var e=a("../math"),f=a("../textures/Texture"),g=a("../display/Container"),h=a("../renderers/canvas/utils/CanvasTinter"),i=a("../utils"),j=a("../const"),k=new e.Point,l=e.GroupD8,n=new e.Matrix;d.prototype=(0,s.default)(g.prototype),d.prototype.constructor=d,b.exports=d,(0,m.default)(d.prototype,{width:{get:function(){return Math.abs(this.scale.x)*this.texture._frame.width},set:function(a){var b=i.sign(this.scale.x)||1;this.scale.x=b*a/this.texture._frame.width,this._width=a}},height:{get:function(){return Math.abs(this.scale.y)*this.texture._frame.height},set:function(a){var b=i.sign(this.scale.y)||1;this.scale.y=b*a/this.texture._frame.height,this._height=a}},texture:{get:function(){return this._texture},set:function(a){this._texture!==a&&(this._texture=a,this.cachedTint=16777215,a&&(a.baseTexture.hasLoaded?this._onTextureUpdate():a.once("update",this._onTextureUpdate,this)))}}}),d.prototype._onTextureUpdate=function(){this._width&&(this.scale.x=i.sign(this.scale.x)*this._width/this.texture.frame.width),this._height&&(this.scale.y=i.sign(this.scale.y)*this._height/this.texture.frame.height)},d.prototype._renderWebGL=function(a){a.setObjectRenderer(a.plugins.sprite),a.plugins.sprite.render(this)},d.prototype.getBounds=function(a){if(!this._currentBounds){var b,c,d,e,f=this._texture._frame.width,g=this._texture._frame.height,h=f*(1-this.anchor.x),i=f*-this.anchor.x,j=g*(1-this.anchor.y),k=g*-this.anchor.y,l=a||this.worldTransform,m=l.a,n=l.b,o=l.c,p=l.d,q=l.tx,r=l.ty,s=m*i+o*k+q,t=p*k+n*i+r,u=m*h+o*k+q,v=p*k+n*h+r,w=m*h+o*j+q,x=p*j+n*h+r,y=m*i+o*j+q,z=p*j+n*i+r;if(b=s,b=u<b?u:b,b=w<b?w:b,b=y<b?y:b,d=t,d=v<d?v:d,d=x<d?x:d,d=z<d?z:d,c=s,c=u>c?u:c,c=w>c?w:c,c=y>c?y:c,e=t,e=v>e?v:e,e=x>e?x:e,e=z>e?z:e,this.children.length){var A=this.containerGetBounds();h=A.x,i=A.x+A.width,j=A.y,k=A.y+A.height,b=b<h?b:h,d=d<j?d:j,c=c>i?c:i,e=e>k?e:k}var B=this._bounds;B.x=b,B.width=c-b,B.y=d,B.height=e-d,this._currentBounds=B}return this._currentBounds},d.prototype.getLocalBounds=function(){return this._bounds.x=-this._texture._frame.width*this.anchor.x,this._bounds.y=-this._texture._frame.height*this.anchor.y,this._bounds.width=this._texture._frame.width,this._bounds.height=this._texture._frame.height,this._bounds},d.prototype.containsPoint=function(a){this.worldTransform.applyInverse(a,k);var b,c=this._texture._frame.width,d=this._texture._frame.height,e=-c*this.anchor.x;return k.x>e&&k.x<e+c&&(b=-d*this.anchor.y,k.y>b&&k.y<b+d)},d.prototype._renderCanvas=function(a){if(!(this.texture.crop.width<=0||this.texture.crop.height<=0)){var b=a.blendModes[this.blendMode];if(b!==a.context.globalCompositeOperation&&(a.context.globalCompositeOperation=b),this.texture.valid){var c,d,e=this._texture,f=this.worldTransform,g=e.crop.width,i=e.crop.height;a.context.globalAlpha=this.worldAlpha;var k=e.baseTexture.scaleMode===j.SCALE_MODES.LINEAR;a.smoothProperty&&a.context[a.smoothProperty]!==k&&(a.context[a.smoothProperty]=k),2==(3&e.rotate)&&(g=e.crop.height,i=e.crop.width),e.trim?(c=e.crop.width/2+e.trim.x-this.anchor.x*e.trim.width,d=e.crop.height/2+e.trim.y-this.anchor.y*e.trim.height):(c=(.5-this.anchor.x)*e._frame.width,d=(.5-this.anchor.y)*e._frame.height),e.rotate&&(f.copy(n),f=n,l.matrixAppendRotationInv(f,e.rotate,c,d),c=0,d=0),c-=g/2,d-=i/2,a.roundPixels?(a.context.setTransform(f.a,f.b,f.c,f.d,f.tx*a.resolution|0,f.ty*a.resolution|0),c|=0,d|=0):a.context.setTransform(f.a,f.b,f.c,f.d,f.tx*a.resolution,f.ty*a.resolution);var m=e.baseTexture.resolution;if(16777215!==this.tint)this.cachedTint!==this.tint&&(this.cachedTint=this.tint,this.tintedTexture=h.getTintedTexture(this,this.tint)),a.context.drawImage(this.tintedTexture,0,0,g*m,i*m,c*a.resolution,d*a.resolution,g*a.resolution,i*a.resolution);else{var o=e.baseTexture.source,p=o.width,q=o.height,r=g*m,s=i*m;a.context.drawImage(o,e.crop.x*m,e.crop.y*m,r>p?p:r,s>q?q:s,c*a.resolution,d*a.resolution,g*a.resolution,i*a.resolution)}}}},d.prototype.destroy=function(a,b){g.prototype.destroy.call(this),this.anchor=null,a&&this._texture.destroy(b),this._texture=null,this.shader=null},d.fromFrame=function(a){var b=i.TextureCache[a];if(!b)throw new Error('The frameId "'+a+'" does not exist in the texture cache');return new d(b)},d.fromImage=function(a,b,c){return new d(f.fromImage(a,b,c))}},{"../const":22,"../display/Container":23,"../math":33,"../renderers/canvas/utils/CanvasTinter":48,"../textures/Texture":72,"../utils":77}],68:[function(a,b,c){function d(a){e.call(this,a),this.vertSize=5,this.vertByteSize=4*this.vertSize,this.size=g.SPRITE_BATCH_SIZE;var b=4*this.size*this.vertByteSize,c=6*this.size;this.vertices=new ArrayBuffer(b),this.positions=new Float32Array(this.vertices),this.colors=new Uint32Array(this.vertices),this.indices=new Uint16Array(c);for(var d=0,f=0;d<c;d+=6,f+=4)this.indices[d+0]=f+0,this.indices[d+1]=f+1,this.indices[d+2]=f+2,this.indices[d+3]=f+0,this.indices[d+4]=f+2,this.indices[d+5]=f+3;this.currentBatchSize=0,this.sprites=[],this.shader=null}var e=a("../../renderers/webgl/utils/ObjectRenderer"),f=a("../../renderers/webgl/WebGLRenderer"),g=a("../../const");d.prototype=(0,s.default)(e.prototype),d.prototype.constructor=d,b.exports=d,f.registerPlugin("sprite",d),d.prototype.onContextChange=function(){var a=this.renderer.gl;this.shader=this.renderer.shaderManager.defaultShader,this.vertexBuffer=a.createBuffer(),this.indexBuffer=a.createBuffer(),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.indexBuffer),a.bufferData(a.ELEMENT_ARRAY_BUFFER,this.indices,a.STATIC_DRAW),a.bindBuffer(a.ARRAY_BUFFER,this.vertexBuffer),a.bufferData(a.ARRAY_BUFFER,this.vertices,a.DYNAMIC_DRAW),this.currentBlendMode=99999},d.prototype.render=function(a){var b=a._texture;this.currentBatchSize>=this.size&&this.flush();var c=b._uvs;if(c){var d,e,f,g,h=a.anchor.x,i=a.anchor.y;if(b.trim&&void 0===a.tileScale){var j=b.trim;e=j.x-h*j.width,d=e+b.crop.width,g=j.y-i*j.height,f=g+b.crop.height}else d=b._frame.width*(1-h),e=b._frame.width*-h,f=b._frame.height*(1-i),g=b._frame.height*-i;var k=this.currentBatchSize*this.vertByteSize,l=a.worldTransform,m=l.a,n=l.b,o=l.c,p=l.d,q=l.tx,r=l.ty,s=this.colors,t=this.positions;if(this.renderer.roundPixels){var u=this.renderer.resolution;t[k]=((m*e+o*g+q)*u|0)/u,t[k+1]=((p*g+n*e+r)*u|0)/u,t[k+5]=((m*d+o*g+q)*u|0)/u,t[k+6]=((p*g+n*d+r)*u|0)/u,t[k+10]=((m*d+o*f+q)*u|0)/u,t[k+11]=((p*f+n*d+r)*u|0)/u,t[k+15]=((m*e+o*f+q)*u|0)/u,t[k+16]=((p*f+n*e+r)*u|0)/u}else t[k]=m*e+o*g+q,t[k+1]=p*g+n*e+r,t[k+5]=m*d+o*g+q,t[k+6]=p*g+n*d+r,t[k+10]=m*d+o*f+q,t[k+11]=p*f+n*d+r,t[k+15]=m*e+o*f+q,t[k+16]=p*f+n*e+r;t[k+2]=c.x0,t[k+3]=c.y0,t[k+7]=c.x1,t[k+8]=c.y1,t[k+12]=c.x2,t[k+13]=c.y2,t[k+17]=c.x3,t[k+18]=c.y3;var v=a.tint;s[k+4]=s[k+9]=s[k+14]=s[k+19]=(v>>16)+(65280&v)+((255&v)<<16)+(255*a.worldAlpha<<24),this.sprites[this.currentBatchSize++]=a}},d.prototype.flush=function(){if(0!==this.currentBatchSize){var a,b=this.renderer.gl;if(this.currentBatchSize>.5*this.size)b.bufferSubData(b.ARRAY_BUFFER,0,this.vertices);else{var c=this.positions.subarray(0,this.currentBatchSize*this.vertByteSize);b.bufferSubData(b.ARRAY_BUFFER,0,c)}for(var d,e,f,g,h=0,i=0,j=null,k=this.renderer.blendModeManager.currentBlendMode,l=null,m=!1,n=!1,o=0,p=this.currentBatchSize;o<p;o++)g=this.sprites[o],d=g._texture.baseTexture,e=g.blendMode,f=g.shader||this.shader,m=k!==e,n=l!==f,(j!==d||m||n)&&(this.renderBatch(j,h,i),i=o,h=0,j=d,m&&(k=e,this.renderer.blendModeManager.setBlendMode(k)),n&&(l=f,a=l.shaders?l.shaders[b.id]:l,a||(a=l.getShader(this.renderer)),this.renderer.shaderManager.setShader(a),a.uniforms.projectionMatrix.value=this.renderer.currentRenderTarget.projectionMatrix.toArray(!0),a.syncUniforms(),b.activeTexture(b.TEXTURE0))),h++;this.renderBatch(j,h,i),this.currentBatchSize=0}},d.prototype.renderBatch=function(a,b,c){if(0!==b){var d=this.renderer.gl;a._glTextures[d.id]?d.bindTexture(d.TEXTURE_2D,a._glTextures[d.id]):this.renderer.updateTexture(a),d.drawElements(d.TRIANGLES,6*b,d.UNSIGNED_SHORT,6*c*2),this.renderer.drawCount++}},d.prototype.start=function(){var a=this.renderer.gl;a.bindBuffer(a.ARRAY_BUFFER,this.vertexBuffer),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.indexBuffer);var b=this.vertByteSize;a.vertexAttribPointer(this.shader.attributes.aVertexPosition,2,a.FLOAT,!1,b,0),a.vertexAttribPointer(this.shader.attributes.aTextureCoord,2,a.FLOAT,!1,b,8),a.vertexAttribPointer(this.shader.attributes.aColor,4,a.UNSIGNED_BYTE,!0,b,16)},d.prototype.destroy=function(){this.renderer.gl.deleteBuffer(this.vertexBuffer),this.renderer.gl.deleteBuffer(this.indexBuffer),e.prototype.destroy.call(this),this.shader.destroy(),this.renderer=null,this.vertices=null,this.positions=null,this.colors=null,this.indices=null,this.vertexBuffer=null,this.indexBuffer=null,this.sprites=null,this.shader=null}},{"../../const":22,"../../renderers/webgl/WebGLRenderer":49,"../../renderers/webgl/utils/ObjectRenderer":63}],69:[function(a,b,c){function d(a,b,c){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=c||i.RESOLUTION,this._text=null,
this._style=null;var d=f.fromCanvas(this.canvas);d.trim=new g.Rectangle,e.call(this,d),this.text=a,this.style=b}var e=a("../sprites/Sprite"),f=a("../textures/Texture"),g=a("../math"),h=a("../utils"),i=a("../const");d.prototype=(0,s.default)(e.prototype),d.prototype.constructor=d,b.exports=d,d.fontPropertiesCache={},d.fontPropertiesCanvas=document.createElement("canvas"),d.fontPropertiesContext=d.fontPropertiesCanvas.getContext("2d"),(0,m.default)(d.prototype,{width:{get:function(){return this.dirty&&this.updateText(),this.scale.x*this._texture._frame.width},set:function(a){this.scale.x=a/this._texture._frame.width,this._width=a}},height:{get:function(){return this.dirty&&this.updateText(),this.scale.y*this._texture._frame.height},set:function(a){this.scale.y=a/this._texture._frame.height,this._height=a}},style:{get:function(){return this._style},set:function(a){a=a||{},"number"==typeof a.fill&&(a.fill=h.hex2string(a.fill)),"number"==typeof a.stroke&&(a.stroke=h.hex2string(a.stroke)),"number"==typeof a.dropShadowColor&&(a.dropShadowColor=h.hex2string(a.dropShadowColor)),a.font=a.font||"bold 20pt Arial",a.fill=a.fill||"black",a.align=a.align||"left",a.stroke=a.stroke||"black",a.strokeThickness=a.strokeThickness||0,a.wordWrap=a.wordWrap||!1,a.wordWrapWidth=a.wordWrapWidth||100,a.dropShadow=a.dropShadow||!1,a.dropShadowColor=a.dropShadowColor||"#000000",a.dropShadowAngle=void 0!==a.dropShadowAngle?a.dropShadowAngle:Math.PI/6,a.dropShadowDistance=void 0!==a.dropShadowDistance?a.dropShadowDistance:5,a.dropShadowBlur=void 0!==a.dropShadowBlur?a.dropShadowBlur:0,a.paddingX=a.paddingX||0,a.textBaseline=a.textBaseline||"alphabetic",a.lineJoin=a.lineJoin||"miter",a.miterLimit=a.miterLimit||10,this._style=a,this.dirty=!0}},text:{get:function(){return this._text},set:function(a){a=a.toString()||" ",this._text!==a&&(this._text=a,this.dirty=!0)}}}),d.prototype.updateText=function(){var a=this._style;this.context.font=a.font;for(var b=a.wordWrap?this.wordWrap(this._text):this._text,c=b.split(/(?:\r\n|\r|\n)/),d=new Array(c.length),e=0,f=this.determineFontProperties(a.font),g=0;g<c.length;g++){var h=this.context.measureText(c[g]).width;d[g]=h,e=Math.max(e,h)}var i=e+a.strokeThickness;a.dropShadow&&(i+=a.dropShadowDistance),this.canvas.width=(i+this.context.lineWidth)*this.resolution;var j=this.style.lineHeight||f.fontSize+a.strokeThickness,k=j*c.length;a.dropShadow&&(k+=a.dropShadowDistance),this.canvas.height=(k+2*this._style.paddingX)*this.resolution,this.context.scale(this.resolution,this.resolution),navigator.isCocoonJS&&this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.font=a.font,this.context.strokeStyle=a.stroke,this.context.lineWidth=a.strokeThickness,this.context.textBaseline=a.textBaseline,this.context.lineJoin=a.lineJoin,this.context.miterLimit=a.miterLimit;var l,m;if(a.dropShadow){a.dropShadowBlur>0?(this.context.shadowColor=a.dropShadowColor,this.context.shadowBlur=a.dropShadowBlur):this.context.fillStyle=a.dropShadowColor;var n=Math.cos(a.dropShadowAngle)*a.dropShadowDistance,o=Math.sin(a.dropShadowAngle)*a.dropShadowDistance;for(g=0;g<c.length;g++)l=a.strokeThickness/2,m=a.strokeThickness/2+g*j+f.ascent,"right"===a.align?l+=e-d[g]:"center"===a.align&&(l+=(e-d[g])/2),a.fill&&this.context.fillText(c[g],l+n,m+o+this._style.paddingX)}for(this.context.fillStyle=a.fill,g=0;g<c.length;g++)l=a.strokeThickness/2,m=a.strokeThickness/2+g*j+f.ascent,"right"===a.align?l+=e-d[g]:"center"===a.align&&(l+=(e-d[g])/2),a.stroke&&a.strokeThickness&&this.context.strokeText(c[g],l,m+this._style.paddingX),a.fill&&this.context.fillText(c[g],l,m+this._style.paddingX);this.updateTexture()},d.prototype.updateTexture=function(){var a=this._texture;a.baseTexture.hasLoaded=!0,a.baseTexture.resolution=this.resolution,a.baseTexture.width=this.canvas.width/this.resolution,a.baseTexture.height=this.canvas.height/this.resolution,a.crop.width=a._frame.width=this.canvas.width/this.resolution,a.crop.height=a._frame.height=this.canvas.height/this.resolution,a.trim.x=0,a.trim.y=-this._style.paddingX,a.trim.width=a._frame.width,a.trim.height=a._frame.height-2*this._style.paddingX,this._width=this.canvas.width/this.resolution,this._height=this.canvas.height/this.resolution,a.baseTexture.emit("update",a.baseTexture),this.dirty=!1},d.prototype.renderWebGL=function(a){this.dirty&&this.updateText(),e.prototype.renderWebGL.call(this,a)},d.prototype._renderCanvas=function(a){this.dirty&&this.updateText(),e.prototype._renderCanvas.call(this,a)},d.prototype.determineFontProperties=function(a){var b=d.fontPropertiesCache[a];if(!b){b={};var c=d.fontPropertiesCanvas,e=d.fontPropertiesContext;e.font=a;var f=Math.ceil(e.measureText("|MÉq").width),g=Math.ceil(e.measureText("M").width),h=2*g;g=1.4*g|0,c.width=f,c.height=h,e.fillStyle="#f00",e.fillRect(0,0,f,h),e.font=a,e.textBaseline="alphabetic",e.fillStyle="#000",e.fillText("|MÉq",0,g);var i,j,k=e.getImageData(0,0,f,h).data,l=k.length,m=4*f,n=0,o=!1;for(i=0;i<g;i++){for(j=0;j<m;j+=4)if(255!==k[n+j]){o=!0;break}if(o)break;n+=m}for(b.ascent=g-i,n=l-m,o=!1,i=h;i>g;i--){for(j=0;j<m;j+=4)if(255!==k[n+j]){o=!0;break}if(o)break;n-=m}b.descent=i-g,b.fontSize=b.ascent+b.descent,d.fontPropertiesCache[a]=b}return b},d.prototype.wordWrap=function(a){for(var b="",c=a.split("\n"),d=this._style.wordWrapWidth,e=0;e<c.length;e++){for(var f=d,g=c[e].split(" "),h=0;h<g.length;h++){var i=this.context.measureText(g[h]).width,j=i+this.context.measureText(" ").width;0===h||j>f?(h>0&&(b+="\n"),b+=g[h],f=d-i):(f-=j,b+=" "+g[h])}e<c.length-1&&(b+="\n")}return b},d.prototype.getBounds=function(a){return this.dirty&&this.updateText(),e.prototype.getBounds.call(this,a)},d.prototype.destroy=function(a){this.context=null,this.canvas=null,this._style=null,this._texture.destroy(void 0===a||a)}},{"../const":22,"../math":33,"../sprites/Sprite":67,"../textures/Texture":72,"../utils":77}],70:[function(a,b,c){function d(a,b,c){g.call(this),this.uid=e.uid(),this.resolution=c||1,this.width=100,this.height=100,this.realWidth=100,this.realHeight=100,this.scaleMode=b||f.SCALE_MODES.DEFAULT,this.hasLoaded=!1,this.isLoading=!1,this.source=null,this.premultipliedAlpha=!0,this.imageUrl=null,this.isPowerOfTwo=!1,this.mipmap=!1,this._glTextures={},a&&this.loadSource(a)}var e=a("../utils"),f=a("../const"),g=a("eventemitter3");d.prototype=(0,s.default)(g.prototype),d.prototype.constructor=d,b.exports=d,d.prototype.update=function(){this.realWidth=this.source.naturalWidth||this.source.width,this.realHeight=this.source.naturalHeight||this.source.height,this.width=this.realWidth/this.resolution,this.height=this.realHeight/this.resolution,this.isPowerOfTwo=e.isPowerOfTwo(this.realWidth,this.realHeight),this.emit("update",this)},d.prototype.loadSource=function(a){var b=this.isLoading;if(this.hasLoaded=!1,this.isLoading=!1,b&&this.source&&(this.source.onload=null,this.source.onerror=null),this.source=a,(this.source.complete||this.source.getContext)&&this.source.width&&this.source.height)this._sourceLoaded();else if(!a.getContext){this.isLoading=!0;var c=this;a.onload=function(){a.onload=null,a.onerror=null,c.isLoading&&(c.isLoading=!1,c._sourceLoaded(),c.emit("loaded",c))},a.onerror=function(){a.onload=null,a.onerror=null,c.isLoading&&(c.isLoading=!1,c.emit("error",c))},a.complete&&a.src&&(this.isLoading=!1,a.onload=null,a.onerror=null,a.width&&a.height?(this._sourceLoaded(),b&&this.emit("loaded",this)):b&&this.emit("error",this))}},d.prototype._sourceLoaded=function(){this.hasLoaded=!0,this.update()},d.prototype.destroy=function(){this.imageUrl?(delete e.BaseTextureCache[this.imageUrl],delete e.TextureCache[this.imageUrl],this.imageUrl=null,navigator.isCocoonJS||(this.source.src="")):this.source&&this.source._pixiId&&delete e.BaseTextureCache[this.source._pixiId],this.source=null,this.dispose()},d.prototype.dispose=function(){this.emit("dispose",this)},d.prototype.updateSourceImage=function(a){this.source.src=a,this.loadSource(this.source)},d.fromImage=function(a,b,c){var f=e.BaseTextureCache[a];if(void 0===b&&0!==a.indexOf("data:")&&(b=!0),!f){var g=new Image;b&&(g.crossOrigin=""),f=new d(g,c),f.imageUrl=a,g.src=a,e.BaseTextureCache[a]=f,f.resolution=e.getResolutionOfUrl(a)}return f},d.fromCanvas=function(a,b){a._pixiId||(a._pixiId="canvas_"+e.uid());var c=e.BaseTextureCache[a._pixiId];return c||(c=new d(a,b),e.BaseTextureCache[a._pixiId]=c),c}},{"../const":22,"../utils":77,eventemitter3:10}],71:[function(a,b,c){function d(a,b,c,d,l){if(!a)throw new Error("Unable to create RenderTexture, you must pass a renderer into the constructor.");b=b||100,c=c||100,l=l||k.RESOLUTION;var m=new e;if(m.width=b,m.height=c,m.resolution=l,m.scaleMode=d||k.SCALE_MODES.DEFAULT,m.hasLoaded=!0,f.call(this,m,new j.Rectangle(0,0,b,c)),this.width=b,this.height=c,this.resolution=l,this.render=null,this.renderer=a,this.renderer.type===k.RENDERER_TYPE.WEBGL){var n=this.renderer.gl;this.textureBuffer=new g(n,this.width,this.height,m.scaleMode,this.resolution),this.baseTexture._glTextures[n.id]=this.textureBuffer.texture,this.filterManager=new h(this.renderer),this.filterManager.onContextChange(),this.filterManager.resize(b,c),this.render=this.renderWebGL,this.renderer.currentRenderer.start(),this.renderer.currentRenderTarget.activate()}else this.render=this.renderCanvas,this.textureBuffer=new i(this.width*this.resolution,this.height*this.resolution),this.baseTexture.source=this.textureBuffer.canvas;this.valid=!0,this._updateUvs()}var e=a("./BaseTexture"),f=a("./Texture"),g=a("../renderers/webgl/utils/RenderTarget"),h=a("../renderers/webgl/managers/FilterManager"),i=a("../renderers/canvas/utils/CanvasBuffer"),j=a("../math"),k=a("../const"),l=new j.Matrix;d.prototype=(0,s.default)(f.prototype),d.prototype.constructor=d,b.exports=d,d.prototype.resize=function(a,b,c){a===this.width&&b===this.height||(this.valid=a>0&&b>0,this.width=this._frame.width=this.crop.width=a,this.height=this._frame.height=this.crop.height=b,c&&(this.baseTexture.width=this.width,this.baseTexture.height=this.height),this.valid&&(this.textureBuffer.resize(this.width,this.height),this.filterManager&&this.filterManager.resize(this.width,this.height)))},d.prototype.clear=function(){this.valid&&(this.renderer.type===k.RENDERER_TYPE.WEBGL&&this.renderer.gl.bindFramebuffer(this.renderer.gl.FRAMEBUFFER,this.textureBuffer.frameBuffer),this.textureBuffer.clear())},d.prototype.renderWebGL=function(a,b,c,d){if(this.valid){if(d=void 0===d||d,this.textureBuffer.transform=b,this.textureBuffer.activate(),a.worldAlpha=1,d){a.worldTransform.identity(),a.currentBounds=null;var e,f,g=a.children;for(e=0,f=g.length;e<f;++e)g[e].updateTransform()}var h=this.renderer.filterManager;this.renderer.filterManager=this.filterManager,this.renderer.renderDisplayObject(a,this.textureBuffer,c),this.renderer.filterManager=h}},d.prototype.renderCanvas=function(a,b,c,d){if(this.valid){d=!!d;var e=l;e.identity(),b&&e.append(b);var f=a.worldTransform;a.worldTransform=e,a.worldAlpha=1;var g,h,i=a.children;for(g=0,h=i.length;g<h;++g)i[g].updateTransform();c&&this.textureBuffer.clear();var j=this.textureBuffer.context,k=this.renderer.resolution;this.renderer.resolution=this.resolution,this.renderer.renderDisplayObject(a,j),this.renderer.resolution=k,a.worldTransform===e&&(a.worldTransform=f)}},d.prototype.destroy=function(){f.prototype.destroy.call(this,!0),this.textureBuffer.destroy(),this.filterManager&&this.filterManager.destroy(),this.renderer=null},d.prototype.getImage=function(){var a=new Image;return a.src=this.getBase64(),a},d.prototype.getBase64=function(){return this.getCanvas().toDataURL()},d.prototype.getCanvas=function(){if(this.renderer.type===k.RENDERER_TYPE.WEBGL){var a=this.renderer.gl,b=this.textureBuffer.size.width,c=this.textureBuffer.size.height,d=new Uint8Array(4*b*c);a.bindFramebuffer(a.FRAMEBUFFER,this.textureBuffer.frameBuffer),a.readPixels(0,0,b,c,a.RGBA,a.UNSIGNED_BYTE,d),a.bindFramebuffer(a.FRAMEBUFFER,null);var e=new i(b,c),f=e.context.getImageData(0,0,b,c);return f.data.set(d),e.context.putImageData(f,0,0),e.canvas}return this.textureBuffer.canvas},d.prototype.getPixels=function(){var a,b;if(this.renderer.type===k.RENDERER_TYPE.WEBGL){var c=this.renderer.gl;a=this.textureBuffer.size.width,b=this.textureBuffer.size.height;var d=new Uint8Array(4*a*b);return c.bindFramebuffer(c.FRAMEBUFFER,this.textureBuffer.frameBuffer),c.readPixels(0,0,a,b,c.RGBA,c.UNSIGNED_BYTE,d),c.bindFramebuffer(c.FRAMEBUFFER,null),d}return a=this.textureBuffer.canvas.width,b=this.textureBuffer.canvas.height,this.textureBuffer.canvas.getContext("2d").getImageData(0,0,a,b).data},d.prototype.getPixel=function(a,b){if(this.renderer.type===k.RENDERER_TYPE.WEBGL){var c=this.renderer.gl,d=new Uint8Array(4);return c.bindFramebuffer(c.FRAMEBUFFER,this.textureBuffer.frameBuffer),c.readPixels(a,b,1,1,c.RGBA,c.UNSIGNED_BYTE,d),c.bindFramebuffer(c.FRAMEBUFFER,null),d}return this.textureBuffer.canvas.getContext("2d").getImageData(a,b,1,1).data}},{"../const":22,"../math":33,"../renderers/canvas/utils/CanvasBuffer":45,"../renderers/webgl/managers/FilterManager":54,"../renderers/webgl/utils/RenderTarget":65,"./BaseTexture":70,"./Texture":72}],72:[function(a,b,c){function d(a,b,c,e,f){if(h.call(this),this.noFrame=!1,b||(this.noFrame=!0,b=new i.Rectangle(0,0,1,1)),a instanceof d&&(a=a.baseTexture),this.baseTexture=a,this._frame=b,this.trim=e,this.valid=!1,this.requiresUpdate=!1,this._uvs=null,this.width=0,this.height=0,this.crop=c||b,this._rotate=+(f||0),!0===f)this._rotate=2;else if(this._rotate%2!=0)throw"attempt to use diamond-shaped UVs. If you are sure, set rotation manually";a.hasLoaded?(this.noFrame&&(b=new i.Rectangle(0,0,a.width,a.height),a.on("update",this.onBaseTextureUpdated,this)),this.frame=b):a.once("loaded",this.onBaseTextureLoaded,this)}var e=a("./BaseTexture"),f=a("./VideoBaseTexture"),g=a("./TextureUvs"),h=a("eventemitter3"),i=a("../math"),j=a("../utils");d.prototype=(0,s.default)(h.prototype),d.prototype.constructor=d,b.exports=d,(0,m.default)(d.prototype,{frame:{get:function(){return this._frame},set:function(a){if(this._frame=a,this.noFrame=!1,this.width=a.width,this.height=a.height,!this.trim&&!this.rotate&&(a.x+a.width>this.baseTexture.width||a.y+a.height>this.baseTexture.height))throw new Error("Texture Error: frame does not fit inside the base Texture dimensions "+this);this.valid=a&&a.width&&a.height&&this.baseTexture.hasLoaded,this.trim?(this.width=this.trim.width,this.height=this.trim.height,this._frame.width=this.trim.width,this._frame.height=this.trim.height):this.crop=a,this.valid&&this._updateUvs()}},rotate:{get:function(){return this._rotate},set:function(a){this._rotate=a,this.valid&&this._updateUvs()}}}),d.prototype.update=function(){this.baseTexture.update()},d.prototype.onBaseTextureLoaded=function(a){this.noFrame?this.frame=new i.Rectangle(0,0,a.width,a.height):this.frame=this._frame,this.emit("update",this)},d.prototype.onBaseTextureUpdated=function(a){this._frame.width=a.width,this._frame.height=a.height,this.emit("update",this)},d.prototype.destroy=function(a){this!=d.EMPTY&&(this.baseTexture&&(a&&this.baseTexture.destroy(),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture.off("loaded",this.onBaseTextureLoaded,this),this.baseTexture=null),this._frame=null,this._uvs=null,this.trim=null,this.crop=null,this.valid=!1,this.off("dispose",this.dispose,this),this.off("update",this.update,this))},d.prototype.clone=function(){return new d(this.baseTexture,this.frame,this.crop,this.trim,this.rotate)},d.prototype._updateUvs=function(){this._uvs||(this._uvs=new g),this._uvs.set(this.crop,this.baseTexture,this.rotate)},d.fromImage=function(a,b,c){var f=j.TextureCache[a];return f||(f=new d(e.fromImage(a,b,c)),j.TextureCache[a]=f),f},d.fromFrame=function(a){var b=j.TextureCache[a];if(!b)throw new Error('The frameId "'+a+'" does not exist in the texture cache');return b},d.fromCanvas=function(a,b){return new d(e.fromCanvas(a,b))},d.fromVideo=function(a,b){return"string"==typeof a?d.fromVideoUrl(a,b):new d(f.fromVideo(a,b))},d.fromVideoUrl=function(a,b){return new d(f.fromUrl(a,b))},d.addTextureToCache=function(a,b){j.TextureCache[b]=a},d.removeTextureFromCache=function(a){var b=j.TextureCache[a];return delete j.TextureCache[a],delete j.BaseTextureCache[a],b},d.EMPTY=new d(new e)},{"../math":33,"../utils":77,"./BaseTexture":70,"./TextureUvs":73,"./VideoBaseTexture":74,eventemitter3:10}],73:[function(a,b,c){function d(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1}b.exports=d;var e=a("../math/GroupD8");d.prototype.set=function(a,b,c){var d=b.width,f=b.height;if(c){var g=e.isSwapWidthHeight(c),h=(g?a.height:a.width)/2/d,i=(g?a.width:a.height)/2/f,j=a.x/d+h,k=a.y/f+i;c=e.add(c,e.NW),this.x0=j+h*e.uX(c),this.y0=k+i*e.uY(c),c=e.add(c,2),this.x1=j+h*e.uX(c),this.y1=k+i*e.uY(c),c=e.add(c,2),this.x2=j+h*e.uX(c),this.y2=k+i*e.uY(c),c=e.add(c,2),this.x3=j+h*e.uX(c),this.y3=k+i*e.uY(c)}else this.x0=a.x/d,this.y0=a.y/f,this.x1=(a.x+a.width)/d,this.y1=a.y/f,this.x2=(a.x+a.width)/d,this.y2=(a.y+a.height)/f,this.x3=a.x/d,this.y3=(a.y+a.height)/f}},{"../math/GroupD8":30}],74:[function(a,b,c){function d(a,b){if(!a)throw new Error("No video source element specified.");(a.readyState===a.HAVE_ENOUGH_DATA||a.readyState===a.HAVE_FUTURE_DATA)&&a.width&&a.height&&(a.complete=!0),f.call(this,a,b),this.autoUpdate=!1,this._onUpdate=this._onUpdate.bind(this),this._onCanPlay=this._onCanPlay.bind(this),a.complete||(a.addEventListener("canplay",this._onCanPlay),a.addEventListener("canplaythrough",this._onCanPlay),a.addEventListener("play",this._onPlayStart.bind(this)),a.addEventListener("pause",this._onPlayStop.bind(this))),this.__loaded=!1}function e(a,b){b||(b="video/"+a.substr(a.lastIndexOf(".")+1));var c=document.createElement("source");return c.src=a,c.type=b,c}var f=a("./BaseTexture"),g=a("../utils");d.prototype=(0,s.default)(f.prototype),d.prototype.constructor=d,b.exports=d,d.prototype._onUpdate=function(){this.autoUpdate&&(window.requestAnimationFrame(this._onUpdate),this.update())},d.prototype._onPlayStart=function(){this.autoUpdate||(window.requestAnimationFrame(this._onUpdate),this.autoUpdate=!0)},d.prototype._onPlayStop=function(){this.autoUpdate=!1},d.prototype._onCanPlay=function(){this.hasLoaded=!0,this.source&&(this.source.removeEventListener("canplay",this._onCanPlay),this.source.removeEventListener("canplaythrough",this._onCanPlay),this.width=this.source.videoWidth,this.height=this.source.videoHeight,this.source.play(),this.__loaded||(this.__loaded=!0,this.emit("loaded",this)))},d.prototype.destroy=function(){this.source&&this.source._pixiId&&(delete g.BaseTextureCache[this.source._pixiId],delete this.source._pixiId),f.prototype.destroy.call(this)},d.fromVideo=function(a,b){a._pixiId||(a._pixiId="video_"+g.uid());var c=g.BaseTextureCache[a._pixiId];return c||(c=new d(a,b),g.BaseTextureCache[a._pixiId]=c),c},d.fromUrl=function(a,b){var c=document.createElement("video");if(Array.isArray(a))for(var f=0;f<a.length;++f)c.appendChild(e(a[f].src||a[f],a[f].mime));else c.appendChild(e(a.src||a,a.mime));return c.load(),c.play(),d.fromVideo(c,b)},d.fromUrls=d.fromUrl},{"../utils":77,"./BaseTexture":70}],75:[function(a,b,c){function d(){var a=this;this._tick=function(b){a._requestId=null,a.started&&(a.update(b),a.started&&null===a._requestId&&a._emitter.listeners(g,!0)&&(a._requestId=requestAnimationFrame(a._tick)))},this._emitter=new f,this._requestId=null,this._maxElapsedMS=100,this.autoStart=!1,this.deltaTime=1,this.elapsedMS=1/e.TARGET_FPMS,this.lastTime=0,this.speed=1,this.started=!1}var e=a("../const"),f=a("eventemitter3"),g="tick";(0,m.default)(d.prototype,{FPS:{get:function(){return 1e3/this.elapsedMS}},minFPS:{get:function(){return 1e3/this._maxElapsedMS},set:function(a){var b=Math.min(Math.max(0,a)/1e3,e.TARGET_FPMS);this._maxElapsedMS=1/b}}}),d.prototype._requestIfNeeded=function(){null===this._requestId&&this._emitter.listeners(g,!0)&&(this.lastTime=performance.now(),this._requestId=requestAnimationFrame(this._tick))},d.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},d.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},d.prototype.add=function(a,b){return this._emitter.on(g,a,b),this._startIfPossible(),this},d.prototype.addOnce=function(a,b){return this._emitter.once(g,a,b),this._startIfPossible(),this},d.prototype.remove=function(a,b){return this._emitter.off(g,a,b),this._emitter.listeners(g,!0)||this._cancelIfNeeded(),this},d.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},d.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},d.prototype.update=function(a){var b;a=a||performance.now(),b=this.elapsedMS=a-this.lastTime,b>this._maxElapsedMS&&(b=this._maxElapsedMS),this.deltaTime=b*e.TARGET_FPMS*this.speed,this._emitter.emit(g,this.deltaTime),this.lastTime=a},b.exports=d},{"../const":22,eventemitter3:10}],76:[function(a,b,c){var d=a("./Ticker"),e=new d;e.autoStart=!0,b.exports={shared:e,Ticker:d}},{"./Ticker":75}],77:[function(a,b,c){var d=a("../const"),e=b.exports={_uid:0,_saidHello:!1,EventEmitter:a("eventemitter3"),pluginTarget:a("./pluginTarget"),async:a("async"),uid:function(){return++e._uid},hex2rgb:function(a,b){return b=b||[],b[0]=(a>>16&255)/255,b[1]=(a>>8&255)/255,b[2]=(255&a)/255,b},hex2string:function(a){return a=a.toString(16),"#"+(a="000000".substr(0,6-a.length)+a)},rgb2hex:function(a){return(255*a[0]<<16)+(255*a[1]<<8)+255*a[2]},canUseNewCanvasBlendModes:function(){if("undefined"==typeof document)return!1;var a="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAABAQMAAADD8p2OAAAAA1BMVEX/",b="AAAACklEQVQI12NgAAAAAgAB4iG8MwAAAABJRU5ErkJggg==",c=new Image;c.src=a+"AP804Oa6"+b;var d=new Image;d.src=a+"/wCKxvRF"+b;var e=document.createElement("canvas");e.width=6,e.height=1;var f=e.getContext("2d");f.globalCompositeOperation="multiply",f.drawImage(c,0,0),f.drawImage(d,2,0);var g=f.getImageData(2,0,1,1).data;return 255===g[0]&&0===g[1]&&0===g[2]},getNextPowerOfTwo:function(a){if(a>0&&0==(a&a-1))return a;for(var b=1;b<a;)b<<=1;return b},isPowerOfTwo:function(a,b){return a>0&&0==(a&a-1)&&b>0&&0==(b&b-1)},getResolutionOfUrl:function(a){var b=d.RETINA_PREFIX.exec(a);return b?parseFloat(b[1]):1},sayHello:function(a){if(!e._saidHello){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){d.VERSION}else window.console;e._saidHello=!0}},isWebGLSupported:function(){var a={stencil:!0};try{if(!window.WebGLRenderingContext)return!1;var b=document.createElement("canvas"),c=b.getContext("webgl",a)||b.getContext("experimental-webgl",a);return!(!c||!c.getContextAttributes().stencil)}catch(d){return!1}},sign:function(a){return a?a<0?-1:1:0},removeItems:function(a,b,c){var d=a.length;if(!(b>=d||0===c)){c=b+c>d?d-b:c;for(var e=b,f=d-c;e<f;++e)a[e]=a[e+c];a.length=f}},TextureCache:{},BaseTextureCache:{}}},{"../const":22,"./pluginTarget":78,async:1,eventemitter3:10}],78:[function(a,b,c){function d(a){a.__plugins={},a.registerPlugin=function(b,c){a.__plugins[b]=c},a.prototype.initPlugins=function(){this.plugins=this.plugins||{};for(var b in a.__plugins)this.plugins[b]=new a.__plugins[b](this)},a.prototype.destroyPlugins=function(){for(var a in this.plugins)this.plugins[a].destroy(),this.plugins[a]=null;this.plugins=null}}b.exports={mixin:function(a){d(a)}}},{}],79:[function(a,b,c){var d=a("./core"),e=a("./mesh"),f=a("./extras"),g=a("./filters");d.SpriteBatch=function(){throw new ReferenceError("SpriteBatch does not exist any more, please use the new ParticleContainer instead.")},d.AssetLoader=function(){throw new ReferenceError("The loader system was overhauled in pixi v3, please see the new PIXI.loaders.Loader class.")},(0,m.default)(d,{Stage:{get:function(){return void 0,d.Container}},DisplayObjectContainer:{get:function(){return void 0,d.Container}},Strip:{get:function(){return void 0,e.Mesh}},Rope:{get:function(){return void 0,e.Rope}},MovieClip:{get:function(){return void 0,f.MovieClip}},TilingSprite:{get:function(){return void 0,f.TilingSprite}},BitmapText:{get:function(){return void 0,f.BitmapText}},blendModes:{get:function(){return void 0,d.BLEND_MODES}},scaleModes:{get:function(){return void 0,d.SCALE_MODES}},BaseTextureCache:{get:function(){return void 0,d.utils.BaseTextureCache}},TextureCache:{get:function(){return void 0,d.utils.TextureCache}},math:{get:function(){return void 0,d}}}),d.Sprite.prototype.setTexture=function(a){this.texture=a,void 0},f.BitmapText.prototype.setText=function(a){this.text=a,void 0},d.Text.prototype.setText=function(a){this.text=a,void 0},d.Text.prototype.setStyle=function(a){this.style=a,void 0},d.Texture.prototype.setFrame=function(a){this.frame=a,void 0},(0,m.default)(g,{AbstractFilter:{get:function(){return void 0,d.AbstractFilter}},FXAAFilter:{get:function(){return void 0,d.FXAAFilter}},SpriteMaskFilter:{get:function(){return void 0,d.SpriteMaskFilter}}}),d.utils.uuid=function(){return void 0,d.utils.uid()}},{"./core":29,"./extras":86,"./filters":103,"./mesh":128}],80:[function(a,b,c){function d(a,b){e.Container.call(this),b=b||{},this.textWidth=0,this.textHeight=0,this._glyphs=[],this._font={tint:void 0!==b.tint?b.tint:16777215,align:b.align||"left",name:null,size:0},this.font=b.font,this._text=a,this.maxWidth=0,this.maxLineHeight=0,this.dirty=!1,this.updateText()}var e=a("../core");d.prototype=(0,s.default)(e.Container.prototype),d.prototype.constructor=d,b.exports=d,(0,m.default)(d.prototype,{tint:{get:function(){return this._font.tint},set:function(a){this._font.tint="number"==typeof a&&a>=0?a:16777215,this.dirty=!0}},align:{get:function(){return this._font.align},set:function(a){this._font.align=a||"left",this.dirty=!0}},font:{get:function(){return this._font},set:function(a){a&&("string"==typeof a?(a=a.split(" "),this._font.name=1===a.length?a[0]:a.slice(1).join(" "),this._font.size=a.length>=2?parseInt(a[0],10):d.fonts[this._font.name].size):(this._font.name=a.name,this._font.size="number"==typeof a.size?a.size:parseInt(a.size,10)),this.dirty=!0)}},text:{get:function(){return this._text},set:function(a){a=a.toString()||" ",this._text!==a&&(this._text=a,this.dirty=!0)}}}),d.prototype.updateText=function(){for(var a=d.fonts[this._font.name],b=new e.Point,c=null,f=[],g=0,h=0,i=[],j=0,k=this._font.size/a.size,l=-1,m=0,n=0;n<this.text.length;n++){var o=this.text.charCodeAt(n);if(l=/(\s)/.test(this.text.charAt(n))?n:l,/(?:\r\n|\r|\n)/.test(this.text.charAt(n)))i.push(g),h=Math.max(h,g),j++,b.x=0,b.y+=a.lineHeight,c=null;else if(-1!==l&&this.maxWidth>0&&b.x*k>this.maxWidth)e.utils.removeItems(f,l,n-l),n=l,l=-1,i.push(g),h=Math.max(h,g),j++,b.x=0,b.y+=a.lineHeight,c=null;else{var p=a.chars[o];p&&(c&&p.kerning[c]&&(b.x+=p.kerning[c]),f.push({texture:p.texture,line:j,charCode:o,position:new e.Point(b.x+p.xOffset,b.y+p.yOffset)}),g=b.x+(p.texture.width+p.xOffset),b.x+=p.xAdvance,m=Math.max(m,p.yOffset+p.texture.height),c=o)}}i.push(g),h=Math.max(h,g);var q=[];for(n=0;n<=j;n++){var r=0;"right"===this._font.align?r=h-i[n]:"center"===this._font.align&&(r=(h-i[n])/2),q.push(r)}var s=f.length,t=this.tint;for(n=0;n<s;n++){var u=this._glyphs[n];u?u.texture=f[n].texture:(u=new e.Sprite(f[n].texture),this._glyphs.push(u)),u.position.x=(f[n].position.x+q[f[n].line])*k,u.position.y=f[n].position.y*k,u.scale.x=u.scale.y=k,u.tint=t,u.parent||this.addChild(u)}for(n=s;n<this._glyphs.length;++n)this.removeChild(this._glyphs[n]);this.textWidth=h*k,this.textHeight=(b.y+a.lineHeight)*k,this.maxLineHeight=m*k},d.prototype.updateTransform=function(){this.validate(),this.containerUpdateTransform()},d.prototype.getLocalBounds=function(){return this.validate(),e.Container.prototype.getLocalBounds.call(this)},d.prototype.validate=function(){this.dirty&&(this.updateText(),this.dirty=!1)},d.fonts={}},{"../core":29}],81:[function(a,b,c){function d(a){e.Sprite.call(this,a[0]instanceof e.Texture?a[0]:a[0].texture),this._textures=null,this._durations=null,this.textures=a,this.animationSpeed=1,this.loop=!0,this.onComplete=null,this._currentTime=0,this.playing=!1}var e=a("../core");d.prototype=(0,s.default)(e.Sprite.prototype),d.prototype.constructor=d,b.exports=d,(0,m.default)(d.prototype,{totalFrames:{get:function(){return this._textures.length}},textures:{get:function(){return this._textures},set:function(a){if(a[0]instanceof e.Texture)this._textures=a,this._durations=null;else{this._textures=[],this._durations=[];for(var b=0;b<a.length;b++)this._textures.push(a[b].texture),this._durations.push(a[b].time)}}},currentFrame:{get:function(){var a=Math.floor(this._currentTime)%this._textures.length;return a<0&&(a+=this._textures.length),a}}}),d.prototype.stop=function(){this.playing&&(this.playing=!1,e.ticker.shared.remove(this.update,this))},d.prototype.play=function(){this.playing||(this.playing=!0,e.ticker.shared.add(this.update,this))},d.prototype.gotoAndStop=function(a){this.stop(),this._currentTime=a,this._texture=this._textures[this.currentFrame]},d.prototype.gotoAndPlay=function(a){this._currentTime=a,this.play()},d.prototype.update=function(a){var b=this.animationSpeed*a;if(null!==this._durations){var c=this._currentTime%1*this._durations[this.currentFrame];for(c+=b/60*1e3;c<0;)this._currentTime--,c+=this._durations[this.currentFrame];var d=(0,k.default)(this.animationSpeed*a);for(this._currentTime=Math.floor(this._currentTime);c>=this._durations[this.currentFrame];)c-=this._durations[this.currentFrame]*d,this._currentTime+=d;this._currentTime+=c/this._durations[this.currentFrame]}else this._currentTime+=b;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):this._texture=this._textures[this.currentFrame]},d.prototype.destroy=function(){this.stop(),e.Sprite.prototype.destroy.call(this)},d.fromFrames=function(a){for(var b=[],c=0;c<a.length;++c)b.push(new e.Texture.fromFrame(a[c]));return new d(b)},d.fromImages=function(a){for(var b=[],c=0;c<a.length;++c)b.push(new e.Texture.fromImage(a[c]));return new d(b)}},{"../core":29}],82:[function(a,b,c){function d(a,b,c){e.Sprite.call(this,a),this.tileScale=new e.Point(1,1),this.tilePosition=new e.Point(0,0),this._width=b||100,this._height=c||100,this._uvs=new e.TextureUvs,this._canvasPattern=null,this.shader=new e.AbstractFilter(["precision lowp float;","attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute vec4 aColor;","uniform mat3 projectionMatrix;","uniform vec4 uFrame;","uniform vec4 uTransform;","varying vec2 vTextureCoord;","varying vec4 vColor;","void main(void){","   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vec2 coord = aTextureCoord;","   coord -= uTransform.xy;","   coord /= uTransform.zw;","   vTextureCoord = coord;","   vColor = vec4(aColor.rgb * aColor.a, aColor.a);","}"].join("\n"),["precision lowp float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","uniform vec4 uFrame;","uniform vec2 uPixelSize;","void main(void){","   vec2 coord = mod(vTextureCoord, uFrame.zw);","   coord = clamp(coord, uPixelSize, uFrame.zw - uPixelSize);","   coord += uFrame.xy;","   gl_FragColor =  texture2D(uSampler, coord) * vColor ;","}"].join("\n"),{uFrame:{type:"4fv",value:[0,0,1,1]},uTransform:{type:"4fv",value:[0,0,1,1]},uPixelSize:{type:"2fv",value:[1,1]}})}var e=a("../core"),f=new e.Point,g=a("../core/renderers/canvas/utils/CanvasTinter");d.prototype=(0,s.default)(e.Sprite.prototype),d.prototype.constructor=d,b.exports=d,(0,m.default)(d.prototype,{width:{get:function(){return this._width},set:function(a){this._width=a}},height:{get:function(){return this._height},set:function(a){this._height=a}}}),d.prototype._onTextureUpdate=function(){},d.prototype._renderWebGL=function(a){var b=this._texture;if(b&&b._uvs){var c=b._uvs,d=b._frame.width,e=b._frame.height,f=b.baseTexture.width,g=b.baseTexture.height;
b._uvs=this._uvs,b._frame.width=this.width,b._frame.height=this.height,this.shader.uniforms.uPixelSize.value[0]=1/f,this.shader.uniforms.uPixelSize.value[1]=1/g,this.shader.uniforms.uFrame.value[0]=c.x0,this.shader.uniforms.uFrame.value[1]=c.y0,this.shader.uniforms.uFrame.value[2]=c.x1-c.x0,this.shader.uniforms.uFrame.value[3]=c.y2-c.y0,this.shader.uniforms.uTransform.value[0]=this.tilePosition.x%(d*this.tileScale.x)/this._width,this.shader.uniforms.uTransform.value[1]=this.tilePosition.y%(e*this.tileScale.y)/this._height,this.shader.uniforms.uTransform.value[2]=f/this._width*this.tileScale.x,this.shader.uniforms.uTransform.value[3]=g/this._height*this.tileScale.y,a.setObjectRenderer(a.plugins.sprite),a.plugins.sprite.render(this),b._uvs=c,b._frame.width=d,b._frame.height=e}},d.prototype._renderCanvas=function(a){var b=this._texture;if(b.baseTexture.hasLoaded){var c=a.context,d=this.worldTransform,f=a.resolution,h=b.baseTexture,i=this.tilePosition.x/this.tileScale.x%b._frame.width,j=this.tilePosition.y/this.tileScale.y%b._frame.height;if(!this._canvasPattern){var k=new e.CanvasBuffer(b._frame.width,b._frame.height);16777215!==this.tint?(this.cachedTint!==this.tint&&(this.cachedTint=this.tint,this.tintedTexture=g.getTintedTexture(this,this.tint)),k.context.drawImage(this.tintedTexture,0,0)):k.context.drawImage(h.source,-b._frame.x,-b._frame.y),this._canvasPattern=k.context.createPattern(k.canvas,"repeat")}c.globalAlpha=this.worldAlpha,c.setTransform(d.a*f,d.b*f,d.c*f,d.d*f,d.tx*f,d.ty*f),c.scale(this.tileScale.x,this.tileScale.y),c.translate(i+this.anchor.x*-this._width,j+this.anchor.y*-this._height);var l=a.blendModes[this.blendMode];l!==a.context.globalCompositeOperation&&(c.globalCompositeOperation=l),c.fillStyle=this._canvasPattern,c.fillRect(-i,-j,this._width/this.tileScale.x,this._height/this.tileScale.y)}},d.prototype.getBounds=function(){var a,b,c,d,e=this._width,f=this._height,g=e*(1-this.anchor.x),h=e*-this.anchor.x,i=f*(1-this.anchor.y),j=f*-this.anchor.y,k=this.worldTransform,l=k.a,m=k.b,n=k.c,o=k.d,p=k.tx,q=k.ty,r=l*h+n*j+p,s=o*j+m*h+q,t=l*g+n*j+p,u=o*j+m*g+q,v=l*g+n*i+p,w=o*i+m*g+q,x=l*h+n*i+p,y=o*i+m*h+q;a=r,a=t<a?t:a,a=v<a?v:a,a=x<a?x:a,c=s,c=u<c?u:c,c=w<c?w:c,c=y<c?y:c,b=r,b=t>b?t:b,b=v>b?v:b,b=x>b?x:b,d=s,d=u>d?u:d,d=w>d?w:d,d=y>d?y:d;var z=this._bounds;return z.x=a,z.width=b-a,z.y=c,z.height=d-c,this._currentBounds=z,z},d.prototype.containsPoint=function(a){this.worldTransform.applyInverse(a,f);var b,c=this._width,d=this._height,e=-c*this.anchor.x;return f.x>e&&f.x<e+c&&(b=-d*this.anchor.y,f.y>b&&f.y<b+d)},d.prototype.destroy=function(){e.Sprite.prototype.destroy.call(this),this.tileScale=null,this._tileScaleOffset=null,this.tilePosition=null,this._uvs=null},d.fromFrame=function(a,b,c){var f=e.utils.TextureCache[a];if(!f)throw new Error('The frameId "'+a+'" does not exist in the texture cache '+this);return new d(f,b,c)},d.fromImage=function(a,b,c,f,g){return new d(e.Texture.fromImage(a,f,g),b,c)}},{"../core":29,"../core/renderers/canvas/utils/CanvasTinter":48}],83:[function(a,b,c){var d=a("../core"),e=d.DisplayObject,f=new d.Matrix;e.prototype._cacheAsBitmap=!1,e.prototype._originalRenderWebGL=null,e.prototype._originalRenderCanvas=null,e.prototype._originalUpdateTransform=null,e.prototype._originalHitTest=null,e.prototype._originalDestroy=null,e.prototype._cachedSprite=null,(0,m.default)(e.prototype,{cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(a){this._cacheAsBitmap!==a&&(this._cacheAsBitmap=a,a?(this._originalRenderWebGL=this.renderWebGL,this._originalRenderCanvas=this.renderCanvas,this._originalUpdateTransform=this.updateTransform,this._originalGetBounds=this.getBounds,this._originalDestroy=this.destroy,this._originalContainsPoint=this.containsPoint,this.renderWebGL=this._renderCachedWebGL,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(this._cachedSprite&&this._destroyCachedDisplayObject(),this.renderWebGL=this._originalRenderWebGL,this.renderCanvas=this._originalRenderCanvas,this.getBounds=this._originalGetBounds,this.destroy=this._originalDestroy,this.updateTransform=this._originalUpdateTransform,this.containsPoint=this._originalContainsPoint))}}}),e.prototype._renderCachedWebGL=function(a){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(a),this._cachedSprite.worldAlpha=this.worldAlpha,a.setObjectRenderer(a.plugins.sprite),a.plugins.sprite.render(this._cachedSprite))},e.prototype._initCachedDisplayObject=function(a){if(!this._cachedSprite){a.currentRenderer.flush();var b=this.getLocalBounds().clone();if(this._filters){var c=this._filters[0].paddingX;b.x-=c,b.y-=c,b.width+=2*c,b.height+=2*c}var e=a.currentRenderTarget,g=a.filterManager.filterStack,h=new d.RenderTexture(a,0|b.width,0|b.height),i=f;i.tx=-b.x,i.ty=-b.y,this.renderWebGL=this._originalRenderWebGL,h.render(this,i,!0,!0),a.setRenderTarget(e),a.filterManager.filterStack=g,this.renderWebGL=this._renderCachedWebGL,this.updateTransform=this.displayObjectUpdateTransform,this.getBounds=this._getCachedBounds,this._cachedSprite=new d.Sprite(h),this._cachedSprite.worldTransform=this.worldTransform,this._cachedSprite.anchor.x=-b.x/b.width,this._cachedSprite.anchor.y=-b.y/b.height,this.updateTransform(),this.containsPoint=this._cachedSprite.containsPoint.bind(this._cachedSprite)}},e.prototype._renderCachedCanvas=function(a){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(a),this._cachedSprite.worldAlpha=this.worldAlpha,this._cachedSprite.renderCanvas(a))},e.prototype._initCachedDisplayObjectCanvas=function(a){if(!this._cachedSprite){var b=this.getLocalBounds(),c=a.context,e=new d.RenderTexture(a,0|b.width,0|b.height),g=f;g.tx=-b.x,g.ty=-b.y,this.renderCanvas=this._originalRenderCanvas,e.render(this,g,!0),a.context=c,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.getBounds=this._getCachedBounds,this._cachedSprite=new d.Sprite(e),this._cachedSprite.worldTransform=this.worldTransform,this._cachedSprite.anchor.x=-b.x/b.width,this._cachedSprite.anchor.y=-b.y/b.height,this.updateTransform(),this.containsPoint=this._cachedSprite.containsPoint.bind(this._cachedSprite)}},e.prototype._getCachedBounds=function(){return this._cachedSprite._currentBounds=null,this._cachedSprite.getBounds()},e.prototype._destroyCachedDisplayObject=function(){this._cachedSprite._texture.destroy(),this._cachedSprite=null},e.prototype._cacheAsBitmapDestroy=function(){this.cacheAsBitmap=!1,this._originalDestroy()}},{"../core":29}],84:[function(a,b,c){var d=a("../core");d.DisplayObject.prototype.name=null,d.Container.prototype.getChildByName=function(a){for(var b=0;b<this.children.length;b++)if(this.children[b].name===a)return this.children[b];return null}},{"../core":29}],85:[function(a,b,c){var d=a("../core");d.DisplayObject.prototype.getGlobalPosition=function(a){return a=a||new d.Point,this.parent?(this.displayObjectUpdateTransform(),a.x=this.worldTransform.tx,a.y=this.worldTransform.ty):(a.x=this.position.x,a.y=this.position.y),a}},{"../core":29}],86:[function(a,b,c){a("./cacheAsBitmap"),a("./getChildByName"),a("./getGlobalPosition"),b.exports={MovieClip:a("./MovieClip"),TilingSprite:a("./TilingSprite"),BitmapText:a("./BitmapText")}},{"./BitmapText":80,"./MovieClip":81,"./TilingSprite":82,"./cacheAsBitmap":83,"./getChildByName":84,"./getGlobalPosition":85}],87:[function(a,b,c){function d(){e.AbstractFilter.call(this,null,"precision mediump float;\n\nuniform vec4 dimensions;\nuniform float pixelSize;\nuniform sampler2D uSampler;\n\nfloat character(float n, vec2 p)\n{\n    p = floor(p*vec2(4.0, -4.0) + 2.5);\n    if (clamp(p.x, 0.0, 4.0) == p.x && clamp(p.y, 0.0, 4.0) == p.y)\n    {\n        if (int(mod(n/exp2(p.x + 5.0*p.y), 2.0)) == 1) return 1.0;\n    }\n    return 0.0;\n}\n\nvoid main()\n{\n    vec2 uv = gl_FragCoord.xy;\n\n    vec3 col = texture2D(uSampler, floor( uv / pixelSize ) * pixelSize / dimensions.xy).rgb;\n\n    float gray = (col.r + col.g + col.b) / 3.0;\n\n    float n =  65536.0;             // .\n    if (gray > 0.2) n = 65600.0;    // :\n    if (gray > 0.3) n = 332772.0;   // *\n    if (gray > 0.4) n = 15255086.0; // o\n    if (gray > 0.5) n = 23385164.0; // &\n    if (gray > 0.6) n = 15252014.0; // 8\n    if (gray > 0.7) n = 13199452.0; // @\n    if (gray > 0.8) n = 11512810.0; // #\n\n    vec2 p = mod( uv / ( pixelSize * 0.5 ), 2.0) - vec2(1.0);\n    col = col * character(n, p);\n\n    gl_FragColor = vec4(col, 1.0);\n}\n",{dimensions:{type:"4fv",value:new Float32Array([0,0,0,0])},pixelSize:{type:"1f",value:8}})}var e=a("../../core");d.prototype=(0,s.default)(e.AbstractFilter.prototype),d.prototype.constructor=d,b.exports=d,(0,m.default)(d.prototype,{size:{get:function(){return this.uniforms.pixelSize.value},set:function(a){this.uniforms.pixelSize.value=a}}})},{"../../core":29}],88:[function(a,b,c){function d(){e.AbstractFilter.call(this),this.blurXFilter=new f,this.blurYFilter=new g,this.defaultFilter=new e.AbstractFilter}var e=a("../../core"),f=a("../blur/BlurXFilter"),g=a("../blur/BlurYFilter");d.prototype=(0,s.default)(e.AbstractFilter.prototype),d.prototype.constructor=d,b.exports=d,d.prototype.applyFilter=function(a,b,c){var d=a.filterManager.getRenderTarget(!0);this.defaultFilter.applyFilter(a,b,c),this.blurXFilter.applyFilter(a,b,d),a.blendModeManager.setBlendMode(e.BLEND_MODES.SCREEN),this.blurYFilter.applyFilter(a,d,c),a.blendModeManager.setBlendMode(e.BLEND_MODES.NORMAL),a.filterManager.returnRenderTarget(d)},(0,m.default)(d.prototype,{blur:{get:function(){return this.blurXFilter.blur},set:function(a){this.blurXFilter.blur=this.blurYFilter.blur=a}},blurX:{get:function(){return this.blurXFilter.blur},set:function(a){this.blurXFilter.blur=a}},blurY:{get:function(){return this.blurYFilter.blur},set:function(a){this.blurYFilter.blur=a}}})},{"../../core":29,"../blur/BlurXFilter":91,"../blur/BlurYFilter":92}],89:[function(a,b,c){function d(a,b){e.AbstractFilter.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nuniform float strength;\nuniform float dirX;\nuniform float dirY;\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying vec2 vBlurTexCoords[3];\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3((aVertexPosition), 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n\n    vBlurTexCoords[0] = aTextureCoord + vec2( (0.004 * strength) * dirX, (0.004 * strength) * dirY );\n    vBlurTexCoords[1] = aTextureCoord + vec2( (0.008 * strength) * dirX, (0.008 * strength) * dirY );\n    vBlurTexCoords[2] = aTextureCoord + vec2( (0.012 * strength) * dirX, (0.012 * strength) * dirY );\n\n    vColor = vec4(aColor.rgb * aColor.a, aColor.a);\n}\n","precision lowp float;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vBlurTexCoords[3];\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = vec4(0.0);\n\n    gl_FragColor += texture2D(uSampler, vTextureCoord     ) * 0.3989422804014327;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 0]) * 0.2419707245191454;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 1]) * 0.05399096651318985;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 2]) * 0.004431848411938341;\n}\n",{strength:{type:"1f",value:1},dirX:{type:"1f",value:a||0},dirY:{type:"1f",value:b||0}}),this.defaultFilter=new e.AbstractFilter,this.passes=1,this.dirX=a||0,this.dirY=b||0,this.strength=4}var e=a("../../core");d.prototype=(0,s.default)(e.AbstractFilter.prototype),d.prototype.constructor=d,b.exports=d,d.prototype.applyFilter=function(a,b,c,d){var e=this.getShader(a);if(this.uniforms.strength.value=this.strength/4/this.passes*(b.frame.width/b.size.width),1===this.passes)a.filterManager.applyFilter(e,b,c,d);else{var f=a.filterManager.getRenderTarget(!0);a.filterManager.applyFilter(e,b,f,d);for(var g=0;g<this.passes-2;g++)a.filterManager.applyFilter(e,f,f,d);a.filterManager.applyFilter(e,f,c,d),a.filterManager.returnRenderTarget(f)}},(0,m.default)(d.prototype,{blur:{get:function(){return this.strength},set:function(a){this.paddingX=.5*a,this.strength=a}},dirX:{get:function(){return this.dirX},set:function(a){this.uniforms.dirX.value=a}},dirY:{get:function(){return this.dirY},set:function(a){this.uniforms.dirY.value=a}}})},{"../../core":29}],90:[function(a,b,c){function d(){e.AbstractFilter.call(this),this.blurXFilter=new f,this.blurYFilter=new g}var e=a("../../core"),f=a("./BlurXFilter"),g=a("./BlurYFilter");d.prototype=(0,s.default)(e.AbstractFilter.prototype),d.prototype.constructor=d,b.exports=d,d.prototype.applyFilter=function(a,b,c){var d=a.filterManager.getRenderTarget(!0);this.blurXFilter.applyFilter(a,b,d),this.blurYFilter.applyFilter(a,d,c),a.filterManager.returnRenderTarget(d)},(0,m.default)(d.prototype,{blur:{get:function(){return this.blurXFilter.blur},set:function(a){this.paddingX=.5*Math.abs(a),this.blurXFilter.blur=this.blurYFilter.blur=a}},passes:{get:function(){return this.blurXFilter.passes},set:function(a){this.blurXFilter.passes=this.blurYFilter.passes=a}},blurX:{get:function(){return this.blurXFilter.blur},set:function(a){this.blurXFilter.blur=a}},blurY:{get:function(){return this.blurYFilter.blur},set:function(a){this.blurYFilter.blur=a}}})},{"../../core":29,"./BlurXFilter":91,"./BlurYFilter":92}],91:[function(a,b,c){function d(){e.AbstractFilter.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nuniform float strength;\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying vec2 vBlurTexCoords[6];\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3((aVertexPosition), 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n\n    vBlurTexCoords[ 0] = aTextureCoord + vec2(-0.012 * strength, 0.0);\n    vBlurTexCoords[ 1] = aTextureCoord + vec2(-0.008 * strength, 0.0);\n    vBlurTexCoords[ 2] = aTextureCoord + vec2(-0.004 * strength, 0.0);\n    vBlurTexCoords[ 3] = aTextureCoord + vec2( 0.004 * strength, 0.0);\n    vBlurTexCoords[ 4] = aTextureCoord + vec2( 0.008 * strength, 0.0);\n    vBlurTexCoords[ 5] = aTextureCoord + vec2( 0.012 * strength, 0.0);\n\n    vColor = vec4(aColor.rgb * aColor.a, aColor.a);\n}\n","precision lowp float;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vBlurTexCoords[6];\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = vec4(0.0);\n\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 0])*0.004431848411938341;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 1])*0.05399096651318985;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 2])*0.2419707245191454;\n    gl_FragColor += texture2D(uSampler, vTextureCoord     )*0.3989422804014327;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 3])*0.2419707245191454;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 4])*0.05399096651318985;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 5])*0.004431848411938341;\n}\n",{strength:{type:"1f",value:1}}),this.passes=1,this.strength=4}var e=a("../../core");d.prototype=(0,s.default)(e.AbstractFilter.prototype),d.prototype.constructor=d,b.exports=d,d.prototype.applyFilter=function(a,b,c,d){var e=this.getShader(a);if(this.uniforms.strength.value=this.strength/4/this.passes*(b.frame.width/b.size.width),1===this.passes)a.filterManager.applyFilter(e,b,c,d);else{for(var f=a.filterManager.getRenderTarget(!0),g=b,h=f,i=0;i<this.passes-1;i++){a.filterManager.applyFilter(e,g,h,!0);var j=h;h=g,g=j}a.filterManager.applyFilter(e,g,c,d),a.filterManager.returnRenderTarget(f)}},(0,m.default)(d.prototype,{blur:{get:function(){return this.strength},set:function(a){this.paddingX=.5*Math.abs(a),this.strength=a}}})},{"../../core":29}],92:[function(a,b,c){function d(){e.AbstractFilter.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nuniform float strength;\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying vec2 vBlurTexCoords[6];\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3((aVertexPosition), 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n\n    vBlurTexCoords[ 0] = aTextureCoord + vec2(0.0, -0.012 * strength);\n    vBlurTexCoords[ 1] = aTextureCoord + vec2(0.0, -0.008 * strength);\n    vBlurTexCoords[ 2] = aTextureCoord + vec2(0.0, -0.004 * strength);\n    vBlurTexCoords[ 3] = aTextureCoord + vec2(0.0,  0.004 * strength);\n    vBlurTexCoords[ 4] = aTextureCoord + vec2(0.0,  0.008 * strength);\n    vBlurTexCoords[ 5] = aTextureCoord + vec2(0.0,  0.012 * strength);\n\n   vColor = vec4(aColor.rgb * aColor.a, aColor.a);\n}\n","precision lowp float;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vBlurTexCoords[6];\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = vec4(0.0);\n\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 0])*0.004431848411938341;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 1])*0.05399096651318985;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 2])*0.2419707245191454;\n    gl_FragColor += texture2D(uSampler, vTextureCoord     )*0.3989422804014327;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 3])*0.2419707245191454;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 4])*0.05399096651318985;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 5])*0.004431848411938341;\n}\n",{strength:{type:"1f",value:1}}),this.passes=1,this.strength=4}var e=a("../../core");d.prototype=(0,s.default)(e.AbstractFilter.prototype),d.prototype.constructor=d,b.exports=d,d.prototype.applyFilter=function(a,b,c,d){var e=this.getShader(a);if(this.uniforms.strength.value=Math.abs(this.strength)/4/this.passes*(b.frame.height/b.size.height),1===this.passes)a.filterManager.applyFilter(e,b,c,d);else{for(var f=a.filterManager.getRenderTarget(!0),g=b,h=f,i=0;i<this.passes-1;i++){a.filterManager.applyFilter(e,g,h,!0);var j=h;h=g,g=j}a.filterManager.applyFilter(e,g,c,d),a.filterManager.returnRenderTarget(f)}},(0,m.default)(d.prototype,{blur:{get:function(){return this.strength},set:function(a){this.paddingX=.5*Math.abs(a),this.strength=a}}})},{"../../core":29}],93:[function(a,b,c){function d(){e.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec2 delta;\n\nfloat random(vec3 scale, float seed)\n{\n    return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);\n}\n\nvoid main(void)\n{\n    vec4 color = vec4(0.0);\n    float total = 0.0;\n\n    float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\n\n    for (float t = -30.0; t <= 30.0; t++)\n    {\n        float percent = (t + offset - 0.5) / 30.0;\n        float weight = 1.0 - abs(percent);\n        vec4 sample = texture2D(uSampler, vTextureCoord + delta * percent);\n        sample.rgb *= sample.a;\n        color += sample * weight;\n        total += weight;\n    }\n\n    gl_FragColor = color / total;\n    gl_FragColor.rgb /= gl_FragColor.a + 0.00001;\n}\n",{delta:{type:"v2",value:{x:.1,y:0}}})}var e=a("../../core");d.prototype=(0,s.default)(e.AbstractFilter.prototype),d.prototype.constructor=d,b.exports=d},{"../../core":29}],94:[function(a,b,c){function d(){e.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float m[25];\n\nvoid main(void)\n{\n\n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n    gl_FragColor.r = (m[0] * c.r);\n        gl_FragColor.r += (m[1] * c.g);\n        gl_FragColor.r += (m[2] * c.b);\n        gl_FragColor.r += (m[3] * c.a);\n        gl_FragColor.r += m[4];\n\n    gl_FragColor.g = (m[5] * c.r);\n        gl_FragColor.g += (m[6] * c.g);\n        gl_FragColor.g += (m[7] * c.b);\n        gl_FragColor.g += (m[8] * c.a);\n        gl_FragColor.g += m[9];\n\n     gl_FragColor.b = (m[10] * c.r);\n        gl_FragColor.b += (m[11] * c.g);\n        gl_FragColor.b += (m[12] * c.b);\n        gl_FragColor.b += (m[13] * c.a);\n        gl_FragColor.b += m[14];\n\n     gl_FragColor.a = (m[15] * c.r);\n        gl_FragColor.a += (m[16] * c.g);\n        gl_FragColor.a += (m[17] * c.b);\n        gl_FragColor.a += (m[18] * c.a);\n        gl_FragColor.a += m[19];\n\n}\n",{dimmedTop:{type:"1fv",value:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]}})}var e=a("../../core");d.prototype=(0,s.default)(e.AbstractFilter.prototype),d.prototype.constructor=d,b.exports=d,d.prototype._loadMatrix=function(a,b){b=!!b;var c=a;b&&(this._multiply(c,this.uniforms.dimmedTop.value,a),c=this._colorMatrix(c)),this.uniforms.dimmedTop.value=c},d.prototype._multiply=function(a,b,c){return a[0]=b[0]*c[0]+b[1]*c[5]+b[2]*c[10]+b[3]*c[15],a[1]=b[0]*c[1]+b[1]*c[6]+b[2]*c[11]+b[3]*c[16],a[2]=b[0]*c[2]+b[1]*c[7]+b[2]*c[12]+b[3]*c[17],a[3]=b[0]*c[3]+b[1]*c[8]+b[2]*c[13]+b[3]*c[18],a[4]=b[0]*c[4]+b[1]*c[9]+b[2]*c[14]+b[3]*c[19],a[5]=b[5]*c[0]+b[6]*c[5]+b[7]*c[10]+b[8]*c[15],a[6]=b[5]*c[1]+b[6]*c[6]+b[7]*c[11]+b[8]*c[16],a[7]=b[5]*c[2]+b[6]*c[7]+b[7]*c[12]+b[8]*c[17],a[8]=b[5]*c[3]+b[6]*c[8]+b[7]*c[13]+b[8]*c[18],a[9]=b[5]*c[4]+b[6]*c[9]+b[7]*c[14]+b[8]*c[19],a[10]=b[10]*c[0]+b[11]*c[5]+b[12]*c[10]+b[13]*c[15],a[11]=b[10]*c[1]+b[11]*c[6]+b[12]*c[11]+b[13]*c[16],a[12]=b[10]*c[2]+b[11]*c[7]+b[12]*c[12]+b[13]*c[17],a[13]=b[10]*c[3]+b[11]*c[8]+b[12]*c[13]+b[13]*c[18],a[14]=b[10]*c[4]+b[11]*c[9]+b[12]*c[14]+b[13]*c[19],a[15]=b[15]*c[0]+b[16]*c[5]+b[17]*c[10]+b[18]*c[15],a[16]=b[15]*c[1]+b[16]*c[6]+b[17]*c[11]+b[18]*c[16],a[17]=b[15]*c[2]+b[16]*c[7]+b[17]*c[12]+b[18]*c[17],a[18]=b[15]*c[3]+b[16]*c[8]+b[17]*c[13]+b[18]*c[18],a[19]=b[15]*c[4]+b[16]*c[9]+b[17]*c[14]+b[18]*c[19],a},d.prototype._colorMatrix=function(a){var b=new Float32Array(a);return b[4]/=255,b[9]/=255,b[14]/=255,b[19]/=255,b},d.prototype.brightness=function(a,b){var c=[a,0,0,0,0,0,a,0,0,0,0,0,a,0,0,0,0,0,1,0];this._loadMatrix(c,b)},d.prototype.greyscale=function(a,b){var c=[a,a,a,0,0,a,a,a,0,0,a,a,a,0,0,0,0,0,1,0];this._loadMatrix(c,b)},d.prototype.grayscale=d.prototype.greyscale,d.prototype.blackAndWhite=function(a){var b=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(b,a)},d.prototype.hue=function(a,b){a=(a||0)/180*Math.PI;var c=Math.cos(a),d=Math.sin(a),e=[.213+.787*c+-.213*d,.715+-.715*c+-.715*d,.072+-.072*c+.928*d,0,0,.213+-.213*c+.143*d,.715+c*(1-.715)+.14*d,.072+-.072*c+-.283*d,0,0,.213+-.213*c+-.787*d,.715+-.715*c+.715*d,.072+.928*c+.072*d,0,0,0,0,0,1,0];this._loadMatrix(e,b)},d.prototype.contrast=function(a,b){var c=(a||0)+1,d=-128*(c-1),e=[c,0,0,0,d,0,c,0,0,d,0,0,c,0,d,0,0,0,1,0];this._loadMatrix(e,b)},d.prototype.saturate=function(a,b){var c=2*(a||0)/3+1,d=-.5*(c-1),e=[c,d,d,0,0,d,c,d,0,0,d,d,c,0,0,0,0,0,1,0];this._loadMatrix(e,b)},d.prototype.desaturate=function(a){this.saturate(-1)},d.prototype.negative=function(a){var b=[0,1,1,0,0,1,0,1,0,0,1,1,0,0,0,0,0,0,1,0];this._loadMatrix(b,a)},d.prototype.sepia=function(a){var b=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(b,a)},d.prototype.technicolor=function(a){var b=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(b,a)},d.prototype.polaroid=function(a){var b=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(b,a)},d.prototype.toBGR=function(a){var b=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(b,a)},d.prototype.kodachrome=function(a){var b=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(b,a)},d.prototype.browni=function(a){var b=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(b,a)},d.prototype.vintage=function(a){var b=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(b,a)},d.prototype.colorTone=function(a,b,c,d,e){a=a||.2,b=b||.15,c=c||16770432,d=d||3375104;var f=(c>>16&255)/255,g=(c>>8&255)/255,h=(255&c)/255,i=(d>>16&255)/255,j=(d>>8&255)/255,k=(255&d)/255,l=[.3,.59,.11,0,0,f,g,h,a,0,i,j,k,b,0,f-i,g-j,h-k,0,0];this._loadMatrix(l,e)},d.prototype.night=function(a,b){a=a||.1;var c=[-2*a,-a,0,0,0,-a,0,a,0,0,0,a,2*a,0,0,0,0,0,1,0];this._loadMatrix(c,b)},d.prototype.predator=function(a,b){var c=[11.224130630493164*a,-4.794486999511719*a,-2.8746118545532227*a,0*a,.40342438220977783*a,-3.6330697536468506*a,9.193157196044922*a,-2.951810836791992*a,0*a,-1.316135048866272*a,-3.2184197902679443*a,-4.2375030517578125*a,7.476448059082031*a,0*a,.8044459223747253*a,0,0,0,1,0];this._loadMatrix(c,b)},d.prototype.lsd=function(a){var b=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(b,a)},d.prototype.reset=function(){var a=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(a,!1)},(0,m.default)(d.prototype,{matrix:{get:function(){return this.uniforms.dimmedTop.value},set:function(a){this.uniforms.dimmedTop.value=a}}})},{"../../core":29}],95:[function(a,b,c){function d(){e.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float step;\n\nvoid main(void)\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n\n    color = floor(color * step) / step;\n\n    gl_FragColor = color;\n}\n",{step:{type:"1f",value:5}})}var e=a("../../core");d.prototype=(0,s.default)(e.AbstractFilter.prototype),d.prototype.constructor=d,b.exports=d,(0,m.default)(d.prototype,{step:{get:function(){return this.uniforms.step.value},set:function(a){this.uniforms.step.value=a}}})},{"../../core":29}],96:[function(a,b,c){function d(a,b,c){e.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying mediump vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec2 texelSize;\nuniform float matrix[9];\n\nvoid main(void)\n{\n   vec4 c11 = texture2D(uSampler, vTextureCoord - texelSize); // top left\n   vec4 c12 = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - texelSize.y)); // top center\n   vec4 c13 = texture2D(uSampler, vec2(vTextureCoord.x + texelSize.x, vTextureCoord.y - texelSize.y)); // top right\n\n   vec4 c21 = texture2D(uSampler, vec2(vTextureCoord.x - texelSize.x, vTextureCoord.y)); // mid left\n   vec4 c22 = texture2D(uSampler, vTextureCoord); // mid center\n   vec4 c23 = texture2D(uSampler, vec2(vTextureCoord.x + texelSize.x, vTextureCoord.y)); // mid right\n\n   vec4 c31 = texture2D(uSampler, vec2(vTextureCoord.x - texelSize.x, vTextureCoord.y + texelSize.y)); // bottom left\n   vec4 c32 = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + texelSize.y)); // bottom center\n   vec4 c33 = texture2D(uSampler, vTextureCoord + texelSize); // bottom right\n\n   gl_FragColor =\n       c11 * matrix[0] + c12 * matrix[1] + c13 * matrix[2] +\n       c21 * matrix[3] + c22 * matrix[4] + c23 * matrix[5] +\n       c31 * matrix[6] + c32 * matrix[7] + c33 * matrix[8];\n\n   gl_FragColor.a = c22.a;\n}\n",{matrix:{type:"1fv",value:new Float32Array(a)},texelSize:{type:"v2",value:{x:1/b,y:1/c}}})}var e=a("../../core");d.prototype=(0,s.default)(e.AbstractFilter.prototype),d.prototype.constructor=d,b.exports=d,(0,m.default)(d.prototype,{matrix:{get:function(){return this.uniforms.matrix.value},set:function(a){this.uniforms.matrix.value=new Float32Array(a)}},width:{get:function(){return 1/this.uniforms.texelSize.value.x},set:function(a){this.uniforms.texelSize.value.x=1/a}},height:{get:function(){return 1/this.uniforms.texelSize.value.y},set:function(a){this.uniforms.texelSize.value.y=1/a}}})},{"../../core":29}],97:[function(a,b,c){function d(){e.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    float lum = length(texture2D(uSampler, vTextureCoord.xy).rgb);\n\n    gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);\n\n    if (lum < 1.00)\n    {\n        if (mod(gl_FragCoord.x + gl_FragCoord.y, 10.0) == 0.0)\n        {\n            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n        }\n    }\n\n    if (lum < 0.75)\n    {\n        if (mod(gl_FragCoord.x - gl_FragCoord.y, 10.0) == 0.0)\n        {\n            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n        }\n    }\n\n    if (lum < 0.50)\n    {\n        if (mod(gl_FragCoord.x + gl_FragCoord.y - 5.0, 10.0) == 0.0)\n        {\n            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n        }\n    }\n\n    if (lum < 0.3)\n    {\n        if (mod(gl_FragCoord.x - gl_FragCoord.y - 5.0, 10.0) == 0.0)\n        {\n            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n        }\n    }\n}\n")}var e=a("../../core");d.prototype=(0,s.default)(e.AbstractFilter.prototype),d.prototype.constructor=d,b.exports=d},{"../../core":29}],98:[function(a,b,c){function d(a,b){var c=new e.Matrix;a.renderable=!1,e.AbstractFilter.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMapCoord;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvoid main(void)\n{\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n   vMapCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n   vColor = vec4(aColor.rgb * aColor.a, aColor.a);\n}\n","precision mediump float;\n\nvarying vec2 vMapCoord;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform vec2 scale;\n\nuniform sampler2D uSampler;\nuniform sampler2D mapSampler;\n\nvoid main(void)\n{\n   vec4 map =  texture2D(mapSampler, vMapCoord);\n\n   map -= 0.5;\n   map.xy *= scale;\n\n   gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y));\n}\n",{mapSampler:{type:"sampler2D",value:a.texture},otherMatrix:{type:"mat3",value:c.toArray(!0)},scale:{type:"v2",value:{x:1,y:1}}}),this.maskSprite=a,this.maskMatrix=c,null!==b&&void 0!==b||(b=20),this.scale=new e.Point(b,b)}var e=a("../../core");d.prototype=(0,s.default)(e.AbstractFilter.prototype),d.prototype.constructor=d,b.exports=d,d.prototype.applyFilter=function(a,b,c){var d=a.filterManager;d.calculateMappedMatrix(b.frame,this.maskSprite,this.maskMatrix),this.uniforms.otherMatrix.value=this.maskMatrix.toArray(!0),this.uniforms.scale.value.x=this.scale.x*(1/b.frame.width),this.uniforms.scale.value.y=this.scale.y*(1/b.frame.height);var e=this.getShader(a);d.applyFilter(e,b,c)},(0,m.default)(d.prototype,{map:{get:function(){return this.uniforms.mapSampler.value},set:function(a){this.uniforms.mapSampler.value=a}}})},{"../../core":29}],99:[function(a,b,c){function d(){e.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform vec4 dimensions;\nuniform sampler2D uSampler;\n\nuniform float angle;\nuniform float scale;\n\nfloat pattern()\n{\n   float s = sin(angle), c = cos(angle);\n   vec2 tex = vTextureCoord * dimensions.xy;\n   vec2 point = vec2(\n       c * tex.x - s * tex.y,\n       s * tex.x + c * tex.y\n   ) * scale;\n   return (sin(point.x) * sin(point.y)) * 4.0;\n}\n\nvoid main()\n{\n   vec4 color = texture2D(uSampler, vTextureCoord);\n   float average = (color.r + color.g + color.b) / 3.0;\n   gl_FragColor = vec4(vec3(average * 10.0 - 5.0 + pattern()), color.a);\n}\n",{
scale:{type:"1f",value:1},angle:{type:"1f",value:5},dimensions:{type:"4fv",value:[0,0,0,0]}})}var e=a("../../core");d.prototype=(0,s.default)(e.AbstractFilter.prototype),d.prototype.constructor=d,b.exports=d,(0,m.default)(d.prototype,{scale:{get:function(){return this.uniforms.scale.value},set:function(a){this.uniforms.scale.value=a}},angle:{get:function(){return this.uniforms.angle.value},set:function(a){this.uniforms.angle.value=a}}})},{"../../core":29}],100:[function(a,b,c){function d(){e.AbstractFilter.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nuniform float strength;\nuniform vec2 offset;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying vec2 vBlurTexCoords[6];\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3((aVertexPosition+offset), 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n\n    vBlurTexCoords[ 0] = aTextureCoord + vec2(0.0, -0.012 * strength);\n    vBlurTexCoords[ 1] = aTextureCoord + vec2(0.0, -0.008 * strength);\n    vBlurTexCoords[ 2] = aTextureCoord + vec2(0.0, -0.004 * strength);\n    vBlurTexCoords[ 3] = aTextureCoord + vec2(0.0,  0.004 * strength);\n    vBlurTexCoords[ 4] = aTextureCoord + vec2(0.0,  0.008 * strength);\n    vBlurTexCoords[ 5] = aTextureCoord + vec2(0.0,  0.012 * strength);\n\n   vColor = vec4(aColor.rgb * aColor.a, aColor.a);\n}\n","precision lowp float;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vBlurTexCoords[6];\nvarying vec4 vColor;\n\nuniform vec3 color;\nuniform float alpha;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    vec4 sum = vec4(0.0);\n\n    sum += texture2D(uSampler, vBlurTexCoords[ 0])*0.004431848411938341;\n    sum += texture2D(uSampler, vBlurTexCoords[ 1])*0.05399096651318985;\n    sum += texture2D(uSampler, vBlurTexCoords[ 2])*0.2419707245191454;\n    sum += texture2D(uSampler, vTextureCoord     )*0.3989422804014327;\n    sum += texture2D(uSampler, vBlurTexCoords[ 3])*0.2419707245191454;\n    sum += texture2D(uSampler, vBlurTexCoords[ 4])*0.05399096651318985;\n    sum += texture2D(uSampler, vBlurTexCoords[ 5])*0.004431848411938341;\n\n    gl_FragColor = vec4( color.rgb * sum.a * alpha, sum.a * alpha );\n}\n",{blur:{type:"1f",value:1/512},color:{type:"c",value:[0,0,0]},alpha:{type:"1f",value:.7},offset:{type:"2f",value:[5,5]},strength:{type:"1f",value:1}}),this.passes=1,this.strength=4}var e=a("../../core");d.prototype=(0,s.default)(e.AbstractFilter.prototype),d.prototype.constructor=d,b.exports=d,d.prototype.applyFilter=function(a,b,c,d){var e=this.getShader(a);if(this.uniforms.strength.value=this.strength/4/this.passes*(b.frame.height/b.size.height),1===this.passes)a.filterManager.applyFilter(e,b,c,d);else{for(var f=a.filterManager.getRenderTarget(!0),g=b,h=f,i=0;i<this.passes-1;i++){a.filterManager.applyFilter(e,g,h,d);var j=h;h=g,g=j}a.filterManager.applyFilter(e,g,c,d),a.filterManager.returnRenderTarget(f)}},(0,m.default)(d.prototype,{blur:{get:function(){return this.strength},set:function(a){this.paddingX=.5*a,this.strength=a}}})},{"../../core":29}],101:[function(a,b,c){function d(){e.AbstractFilter.call(this),this.blurXFilter=new f,this.blurYTintFilter=new g,this.defaultFilter=new e.AbstractFilter,this.paddingX=30,this._dirtyPosition=!0,this._angle=45*Math.PI/180,this._distance=10,this.alpha=.75,this.hideObject=!1,this.blendMode=e.BLEND_MODES.MULTIPLY}var e=a("../../core"),f=a("../blur/BlurXFilter"),g=a("./BlurYTintFilter");d.prototype=(0,s.default)(e.AbstractFilter.prototype),d.prototype.constructor=d,b.exports=d,d.prototype.applyFilter=function(a,b,c){var d=a.filterManager.getRenderTarget(!0);this._dirtyPosition&&(this._dirtyPosition=!1,this.blurYTintFilter.uniforms.offset.value[0]=Math.sin(this._angle)*this._distance,this.blurYTintFilter.uniforms.offset.value[1]=Math.cos(this._angle)*this._distance),this.blurXFilter.applyFilter(a,b,d),a.blendModeManager.setBlendMode(this.blendMode),this.blurYTintFilter.applyFilter(a,d,c),a.blendModeManager.setBlendMode(e.BLEND_MODES.NORMAL),this.hideObject||this.defaultFilter.applyFilter(a,b,c),a.filterManager.returnRenderTarget(d)},(0,m.default)(d.prototype,{blur:{get:function(){return this.blurXFilter.blur},set:function(a){this.blurXFilter.blur=this.blurYTintFilter.blur=a}},blurX:{get:function(){return this.blurXFilter.blur},set:function(a){this.blurXFilter.blur=a}},blurY:{get:function(){return this.blurYTintFilter.blur},set:function(a){this.blurYTintFilter.blur=a}},color:{get:function(){return e.utils.rgb2hex(this.blurYTintFilter.uniforms.color.value)},set:function(a){this.blurYTintFilter.uniforms.color.value=e.utils.hex2rgb(a)}},alpha:{get:function(){return this.blurYTintFilter.uniforms.alpha.value},set:function(a){this.blurYTintFilter.uniforms.alpha.value=a}},distance:{get:function(){return this._distance},set:function(a){this._dirtyPosition=!0,this._distance=a}},angle:{get:function(){return this._angle},set:function(a){this._dirtyPosition=!0,this._angle=a}}})},{"../../core":29,"../blur/BlurXFilter":91,"./BlurYTintFilter":100}],102:[function(a,b,c){function d(){e.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\nuniform float gray;\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n   gl_FragColor.rgb = mix(gl_FragColor.rgb, vec3(0.2126*gl_FragColor.r + 0.7152*gl_FragColor.g + 0.0722*gl_FragColor.b), gray);\n}\n",{gray:{type:"1f",value:1}})}var e=a("../../core");d.prototype=(0,s.default)(e.AbstractFilter.prototype),d.prototype.constructor=d,b.exports=d,(0,m.default)(d.prototype,{gray:{get:function(){return this.uniforms.gray.value},set:function(a){this.uniforms.gray.value=a}}})},{"../../core":29}],103:[function(a,b,c){b.exports={AsciiFilter:a("./ascii/AsciiFilter"),BloomFilter:a("./bloom/BloomFilter"),BlurFilter:a("./blur/BlurFilter"),BlurXFilter:a("./blur/BlurXFilter"),BlurYFilter:a("./blur/BlurYFilter"),BlurDirFilter:a("./blur/BlurDirFilter"),ColorMatrixFilter:a("./color/ColorMatrixFilter"),ColorStepFilter:a("./color/ColorStepFilter"),ConvolutionFilter:a("./convolution/ConvolutionFilter"),CrossHatchFilter:a("./crosshatch/CrossHatchFilter"),DisplacementFilter:a("./displacement/DisplacementFilter"),DotScreenFilter:a("./dot/DotScreenFilter"),GrayFilter:a("./gray/GrayFilter"),DropShadowFilter:a("./dropshadow/DropShadowFilter"),InvertFilter:a("./invert/InvertFilter"),NoiseFilter:a("./noise/NoiseFilter"),PixelateFilter:a("./pixelate/PixelateFilter"),RGBSplitFilter:a("./rgb/RGBSplitFilter"),ShockwaveFilter:a("./shockwave/ShockwaveFilter"),SepiaFilter:a("./sepia/SepiaFilter"),SmartBlurFilter:a("./blur/SmartBlurFilter"),TiltShiftFilter:a("./tiltshift/TiltShiftFilter"),TiltShiftXFilter:a("./tiltshift/TiltShiftXFilter"),TiltShiftYFilter:a("./tiltshift/TiltShiftYFilter"),TwistFilter:a("./twist/TwistFilter")}},{"./ascii/AsciiFilter":87,"./bloom/BloomFilter":88,"./blur/BlurDirFilter":89,"./blur/BlurFilter":90,"./blur/BlurXFilter":91,"./blur/BlurYFilter":92,"./blur/SmartBlurFilter":93,"./color/ColorMatrixFilter":94,"./color/ColorStepFilter":95,"./convolution/ConvolutionFilter":96,"./crosshatch/CrossHatchFilter":97,"./displacement/DisplacementFilter":98,"./dot/DotScreenFilter":99,"./dropshadow/DropShadowFilter":101,"./gray/GrayFilter":102,"./invert/InvertFilter":104,"./noise/NoiseFilter":105,"./pixelate/PixelateFilter":106,"./rgb/RGBSplitFilter":107,"./sepia/SepiaFilter":108,"./shockwave/ShockwaveFilter":109,"./tiltshift/TiltShiftFilter":111,"./tiltshift/TiltShiftXFilter":112,"./tiltshift/TiltShiftYFilter":113,"./twist/TwistFilter":114}],104:[function(a,b,c){function d(){e.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform float invert;\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord);\n\n    gl_FragColor.rgb = mix( (vec3(1)-gl_FragColor.rgb) * gl_FragColor.a, gl_FragColor.rgb, 1.0 - invert);\n}\n",{invert:{type:"1f",value:1}})}var e=a("../../core");d.prototype=(0,s.default)(e.AbstractFilter.prototype),d.prototype.constructor=d,b.exports=d,(0,m.default)(d.prototype,{invert:{get:function(){return this.uniforms.invert.value},set:function(a){this.uniforms.invert.value=a}}})},{"../../core":29}],105:[function(a,b,c){function d(){e.AbstractFilter.call(this,null,"precision highp float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform float noise;\nuniform sampler2D uSampler;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main()\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n\n    float diff = (rand(vTextureCoord) - 0.5) * noise;\n\n    color.r += diff;\n    color.g += diff;\n    color.b += diff;\n\n    gl_FragColor = color;\n}\n",{noise:{type:"1f",value:.5}})}var e=a("../../core");d.prototype=(0,s.default)(e.AbstractFilter.prototype),d.prototype.constructor=d,b.exports=d,(0,m.default)(d.prototype,{noise:{get:function(){return this.uniforms.noise.value},set:function(a){this.uniforms.noise.value=a}}})},{"../../core":29}],106:[function(a,b,c){function d(){e.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 dimensions;\nuniform vec2 pixelSize;\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord;\n\n    vec2 size = dimensions.xy / pixelSize;\n\n    vec2 color = floor( ( vTextureCoord * size ) ) / size + pixelSize/dimensions.xy * 0.5;\n\n    gl_FragColor = texture2D(uSampler, color);\n}\n",{dimensions:{type:"4fv",value:new Float32Array([0,0,0,0])},pixelSize:{type:"v2",value:{x:10,y:10}}})}var e=a("../../core");d.prototype=(0,s.default)(e.AbstractFilter.prototype),d.prototype.constructor=d,b.exports=d,(0,m.default)(d.prototype,{size:{get:function(){return this.uniforms.pixelSize.value},set:function(a){this.uniforms.pixelSize.value=a}}})},{"../../core":29}],107:[function(a,b,c){function d(){e.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 dimensions;\nuniform vec2 red;\nuniform vec2 green;\nuniform vec2 blue;\n\nvoid main(void)\n{\n   gl_FragColor.r = texture2D(uSampler, vTextureCoord + red/dimensions.xy).r;\n   gl_FragColor.g = texture2D(uSampler, vTextureCoord + green/dimensions.xy).g;\n   gl_FragColor.b = texture2D(uSampler, vTextureCoord + blue/dimensions.xy).b;\n   gl_FragColor.a = texture2D(uSampler, vTextureCoord).a;\n}\n",{red:{type:"v2",value:{x:20,y:20}},green:{type:"v2",value:{x:-20,y:20}},blue:{type:"v2",value:{x:20,y:-20}},dimensions:{type:"4fv",value:[0,0,0,0]}})}var e=a("../../core");d.prototype=(0,s.default)(e.AbstractFilter.prototype),d.prototype.constructor=d,b.exports=d,(0,m.default)(d.prototype,{red:{get:function(){return this.uniforms.red.value},set:function(a){this.uniforms.red.value=a}},green:{get:function(){return this.uniforms.green.value},set:function(a){this.uniforms.green.value=a}},blue:{get:function(){return this.uniforms.blue.value},set:function(a){this.uniforms.blue.value=a}}})},{"../../core":29}],108:[function(a,b,c){function d(){e.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float sepia;\n\nconst mat3 sepiaMatrix = mat3(0.3588, 0.7044, 0.1368, 0.2990, 0.5870, 0.1140, 0.2392, 0.4696, 0.0912);\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n   gl_FragColor.rgb = mix( gl_FragColor.rgb, gl_FragColor.rgb * sepiaMatrix, sepia);\n}\n",{sepia:{type:"1f",value:1}})}var e=a("../../core");d.prototype=(0,s.default)(e.AbstractFilter.prototype),d.prototype.constructor=d,b.exports=d,(0,m.default)(d.prototype,{sepia:{get:function(){return this.uniforms.sepia.value},set:function(a){this.uniforms.sepia.value=a}}})},{"../../core":29}],109:[function(a,b,c){function d(){e.AbstractFilter.call(this,null,"precision lowp float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nuniform vec2 center;\nuniform vec3 params; // 10.0, 0.8, 0.1\nuniform float time;\n\nvoid main()\n{\n    vec2 uv = vTextureCoord;\n    vec2 texCoord = uv;\n\n    float dist = distance(uv, center);\n\n    if ( (dist <= (time + params.z)) && (dist >= (time - params.z)) )\n    {\n        float diff = (dist - time);\n        float powDiff = 1.0 - pow(abs(diff*params.x), params.y);\n\n        float diffTime = diff  * powDiff;\n        vec2 diffUV = normalize(uv - center);\n        texCoord = uv + (diffUV * diffTime);\n    }\n\n    gl_FragColor = texture2D(uSampler, texCoord);\n}\n",{center:{type:"v2",value:{x:.5,y:.5}},params:{type:"v3",value:{x:10,y:.8,z:.1}},time:{type:"1f",value:0}})}var e=a("../../core");d.prototype=(0,s.default)(e.AbstractFilter.prototype),d.prototype.constructor=d,b.exports=d,(0,m.default)(d.prototype,{center:{get:function(){return this.uniforms.center.value},set:function(a){this.uniforms.center.value=a}},params:{get:function(){return this.uniforms.params.value},set:function(a){this.uniforms.params.value=a}},time:{get:function(){return this.uniforms.time.value},set:function(a){this.uniforms.time.value=a}}})},{"../../core":29}],110:[function(a,b,c){function d(){e.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float blur;\nuniform float gradientBlur;\nuniform vec2 start;\nuniform vec2 end;\nuniform vec2 delta;\nuniform vec2 texSize;\n\nfloat random(vec3 scale, float seed)\n{\n    return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);\n}\n\nvoid main(void)\n{\n    vec4 color = vec4(0.0);\n    float total = 0.0;\n\n    float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\n    vec2 normal = normalize(vec2(start.y - end.y, end.x - start.x));\n    float radius = smoothstep(0.0, 1.0, abs(dot(vTextureCoord * texSize - start, normal)) / gradientBlur) * blur;\n\n    for (float t = -30.0; t <= 30.0; t++)\n    {\n        float percent = (t + offset - 0.5) / 30.0;\n        float weight = 1.0 - abs(percent);\n        vec4 sample = texture2D(uSampler, vTextureCoord + delta / texSize * percent * radius);\n        sample.rgb *= sample.a;\n        color += sample * weight;\n        total += weight;\n    }\n\n    gl_FragColor = color / total;\n    gl_FragColor.rgb /= gl_FragColor.a + 0.00001;\n}\n",{blur:{type:"1f",value:100},gradientBlur:{type:"1f",value:600},start:{type:"v2",value:{x:0,y:window.innerHeight/2}},end:{type:"v2",value:{x:600,y:window.innerHeight/2}},delta:{type:"v2",value:{x:30,y:30}},texSize:{type:"v2",value:{x:window.innerWidth,y:window.innerHeight}}}),this.updateDelta()}var e=a("../../core");d.prototype=(0,s.default)(e.AbstractFilter.prototype),d.prototype.constructor=d,b.exports=d,d.prototype.updateDelta=function(){this.uniforms.delta.value.x=0,this.uniforms.delta.value.y=0},(0,m.default)(d.prototype,{blur:{get:function(){return this.uniforms.blur.value},set:function(a){this.uniforms.blur.value=a}},gradientBlur:{get:function(){return this.uniforms.gradientBlur.value},set:function(a){this.uniforms.gradientBlur.value=a}},start:{get:function(){return this.uniforms.start.value},set:function(a){this.uniforms.start.value=a,this.updateDelta()}},end:{get:function(){return this.uniforms.end.value},set:function(a){this.uniforms.end.value=a,this.updateDelta()}}})},{"../../core":29}],111:[function(a,b,c){function d(){e.AbstractFilter.call(this),this.tiltShiftXFilter=new f,this.tiltShiftYFilter=new g}var e=a("../../core"),f=a("./TiltShiftXFilter"),g=a("./TiltShiftYFilter");d.prototype=(0,s.default)(e.AbstractFilter.prototype),d.prototype.constructor=d,b.exports=d,d.prototype.applyFilter=function(a,b,c){var d=a.filterManager.getRenderTarget(!0);this.tiltShiftXFilter.applyFilter(a,b,d),this.tiltShiftYFilter.applyFilter(a,d,c),a.filterManager.returnRenderTarget(d)},(0,m.default)(d.prototype,{blur:{get:function(){return this.tiltShiftXFilter.blur},set:function(a){this.tiltShiftXFilter.blur=this.tiltShiftYFilter.blur=a}},gradientBlur:{get:function(){return this.tiltShiftXFilter.gradientBlur},set:function(a){this.tiltShiftXFilter.gradientBlur=this.tiltShiftYFilter.gradientBlur=a}},start:{get:function(){return this.tiltShiftXFilter.start},set:function(a){this.tiltShiftXFilter.start=this.tiltShiftYFilter.start=a}},end:{get:function(){return this.tiltShiftXFilter.end},set:function(a){this.tiltShiftXFilter.end=this.tiltShiftYFilter.end=a}}})},{"../../core":29,"./TiltShiftXFilter":112,"./TiltShiftYFilter":113}],112:[function(a,b,c){function d(){e.call(this)}var e=a("./TiltShiftAxisFilter");d.prototype=(0,s.default)(e.prototype),d.prototype.constructor=d,b.exports=d,d.prototype.updateDelta=function(){var a=this.uniforms.end.value.x-this.uniforms.start.value.x,b=this.uniforms.end.value.y-this.uniforms.start.value.y,c=Math.sqrt(a*a+b*b);this.uniforms.delta.value.x=a/c,this.uniforms.delta.value.y=b/c}},{"./TiltShiftAxisFilter":110}],113:[function(a,b,c){function d(){e.call(this)}var e=a("./TiltShiftAxisFilter");d.prototype=(0,s.default)(e.prototype),d.prototype.constructor=d,b.exports=d,d.prototype.updateDelta=function(){var a=this.uniforms.end.value.x-this.uniforms.start.value.x,b=this.uniforms.end.value.y-this.uniforms.start.value.y,c=Math.sqrt(a*a+b*b);this.uniforms.delta.value.x=-b/c,this.uniforms.delta.value.y=a/c}},{"./TiltShiftAxisFilter":110}],114:[function(a,b,c){function d(){e.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float radius;\nuniform float angle;\nuniform vec2 offset;\n\nvoid main(void)\n{\n   vec2 coord = vTextureCoord - offset;\n   float dist = length(coord);\n\n   if (dist < radius)\n   {\n       float ratio = (radius - dist) / radius;\n       float angleMod = ratio * ratio * angle;\n       float s = sin(angleMod);\n       float c = cos(angleMod);\n       coord = vec2(coord.x * c - coord.y * s, coord.x * s + coord.y * c);\n   }\n\n   gl_FragColor = texture2D(uSampler, coord+offset);\n}\n",{radius:{type:"1f",value:.5},angle:{type:"1f",value:5},offset:{type:"v2",value:{x:.5,y:.5}}})}var e=a("../../core");d.prototype=(0,s.default)(e.AbstractFilter.prototype),d.prototype.constructor=d,b.exports=d,(0,m.default)(d.prototype,{offset:{get:function(){return this.uniforms.offset.value},set:function(a){this.uniforms.offset.value=a}},radius:{get:function(){return this.uniforms.radius.value},set:function(a){this.uniforms.radius.value=a}},angle:{get:function(){return this.uniforms.angle.value},set:function(a){this.uniforms.angle.value=a}}})},{"../../core":29}],115:[function(a,b,c){(function(c){a("./polyfill");var d=b.exports=a("./core");d.extras=a("./extras"),d.filters=a("./filters"),d.interaction=a("./interaction"),d.loaders=a("./loaders"),d.mesh=a("./mesh"),d.accessibility=a("./accessibility"),d.loader=new d.loaders.Loader,(0,q.default)(d,a("./deprecation")),c.PIXI=d}).call(this,void 0!==d?d:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./accessibility":21,"./core":29,"./deprecation":79,"./extras":86,"./filters":103,"./interaction":118,"./loaders":121,"./mesh":128,"./polyfill":133}],116:[function(a,b,c){function d(){this.global=new e.Point,this.target=null,this.originalEvent=null}var e=a("../core");d.prototype.constructor=d,b.exports=d,d.prototype.getLocalPosition=function(a,b,c){return a.worldTransform.applyInverse(c||this.global,b)}},{"../core":29}],117:[function(a,b,c){function d(a,b){b=b||{},this.renderer=a,this.autoPreventDefault=void 0===b.autoPreventDefault||b.autoPreventDefault,this.interactionFrequency=b.interactionFrequency||10,this.mouse=new f,this.eventData={stopped:!1,target:null,type:null,data:this.mouse,stopPropagation:function(){this.stopped=!0}},this.interactiveDataPool=[],this.interactionDOMElement=null,this.moveWhenInside=!1,this.eventsAdded=!1,this.onMouseUp=this.onMouseUp.bind(this),this.processMouseUp=this.processMouseUp.bind(this),this.onMouseDown=this.onMouseDown.bind(this),this.processMouseDown=this.processMouseDown.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.processMouseMove=this.processMouseMove.bind(this),this.onMouseOut=this.onMouseOut.bind(this),this.processMouseOverOut=this.processMouseOverOut.bind(this),this.onTouchStart=this.onTouchStart.bind(this),this.processTouchStart=this.processTouchStart.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.processTouchEnd=this.processTouchEnd.bind(this),this.onTouchMove=this.onTouchMove.bind(this),this.processTouchMove=this.processTouchMove.bind(this),this.last=0,this.currentCursorStyle="inherit",this._tempPoint=new e.Point,this.resolution=1,this.setTargetElement(this.renderer.view,this.renderer.resolution)}var e=a("../core"),f=a("./InteractionData");(0,q.default)(e.DisplayObject.prototype,a("./interactiveTarget")),d.prototype.constructor=d,b.exports=d,d.prototype.setTargetElement=function(a,b){this.removeEvents(),this.interactionDOMElement=a,this.resolution=b||1,this.addEvents()},d.prototype.addEvents=function(){this.interactionDOMElement&&(e.ticker.shared.add(this.update,this),window.navigator.msPointerEnabled&&(this.interactionDOMElement.style["-ms-content-zooming"]="none",this.interactionDOMElement.style["-ms-touch-action"]="none"),window.document.addEventListener("mousemove",this.onMouseMove,!0),this.interactionDOMElement.addEventListener("mousedown",this.onMouseDown,!0),this.interactionDOMElement.addEventListener("mouseout",this.onMouseOut,!0),this.interactionDOMElement.addEventListener("touchstart",this.onTouchStart,!0),this.interactionDOMElement.addEventListener("touchend",this.onTouchEnd,!0),this.interactionDOMElement.addEventListener("touchmove",this.onTouchMove,!0),window.addEventListener("mouseup",this.onMouseUp,!0),this.eventsAdded=!0)},d.prototype.removeEvents=function(){this.interactionDOMElement&&(e.ticker.shared.remove(this.update),window.navigator.msPointerEnabled&&(this.interactionDOMElement.style["-ms-content-zooming"]="",this.interactionDOMElement.style["-ms-touch-action"]=""),window.document.removeEventListener("mousemove",this.onMouseMove,!0),this.interactionDOMElement.removeEventListener("mousedown",this.onMouseDown,!0),this.interactionDOMElement.removeEventListener("mouseout",this.onMouseOut,!0),this.interactionDOMElement.removeEventListener("touchstart",this.onTouchStart,!0),this.interactionDOMElement.removeEventListener("touchend",this.onTouchEnd,!0),this.interactionDOMElement.removeEventListener("touchmove",this.onTouchMove,!0),this.interactionDOMElement=null,window.removeEventListener("mouseup",this.onMouseUp,!0),this.eventsAdded=!1)},d.prototype.update=function(a){if(this._deltaTime+=a,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.interactionDOMElement)){if(this.didMove)return void(this.didMove=!1);this.cursor="inherit",this.processInteractive(this.mouse.global,this.renderer._lastObjectRendered,this.processMouseOverOut,!0),this.currentCursorStyle!==this.cursor&&(this.currentCursorStyle=this.cursor,this.interactionDOMElement.style.cursor=this.cursor)}},d.prototype.dispatchEvent=function(a,b,c){c.stopped||(c.target=a,c.type=b,a.emit(b,c),a[b]&&a[b](c))},d.prototype.mapPositionToPoint=function(a,b,c){var d=this.interactionDOMElement.getBoundingClientRect();a.x=(b-d.left)*(this.interactionDOMElement.width/d.width)/this.resolution,a.y=(c-d.top)*(this.interactionDOMElement.height/d.height)/this.resolution},d.prototype.processInteractive=function(a,b,c,d,e){if(!b||!b.visible)return!1;var f=!1,g=e=b.interactive||e;if(b.hitArea&&(g=!1),b.interactiveChildren)for(var h=b.children,i=h.length-1;i>=0;i--){var j=h[i];if(this.processInteractive(a,j,c,d,g)){if(!j.parent)continue;f=!0,g=!1,j.interactive&&(d=!1)}}return e&&(d&&!f&&(b.hitArea?(b.worldTransform.applyInverse(a,this._tempPoint),f=b.hitArea.contains(this._tempPoint.x,this._tempPoint.y)):b.containsPoint&&(f=b.containsPoint(a))),b.interactive&&c(b,f)),f},d.prototype.onMouseDown=function(a){this.mouse.originalEvent=a,this.eventData.data=this.mouse,this.eventData.stopped=!1,this.mapPositionToPoint(this.mouse.global,a.clientX,a.clientY),this.autoPreventDefault&&this.mouse.originalEvent.preventDefault(),this.processInteractive(this.mouse.global,this.renderer._lastObjectRendered,this.processMouseDown,!0)},d.prototype.processMouseDown=function(a,b){var c=this.mouse.originalEvent,d=2===c.button||3===c.which;b&&(a[d?"_isRightDown":"_isLeftDown"]=!0,this.dispatchEvent(a,d?"rightdown":"mousedown",this.eventData))},d.prototype.onMouseUp=function(a){this.mouse.originalEvent=a,this.eventData.data=this.mouse,this.eventData.stopped=!1,this.mapPositionToPoint(this.mouse.global,a.clientX,a.clientY),this.processInteractive(this.mouse.global,this.renderer._lastObjectRendered,this.processMouseUp,!0)},d.prototype.processMouseUp=function(a,b){var c=this.mouse.originalEvent,d=2===c.button||3===c.which,e=d?"_isRightDown":"_isLeftDown";b?(this.dispatchEvent(a,d?"rightup":"mouseup",this.eventData),a[e]&&(a[e]=!1,this.dispatchEvent(a,d?"rightclick":"click",this.eventData))):a[e]&&(a[e]=!1,this.dispatchEvent(a,d?"rightupoutside":"mouseupoutside",this.eventData))},d.prototype.onMouseMove=function(a){this.mouse.originalEvent=a,this.eventData.data=this.mouse,this.eventData.stopped=!1,this.mapPositionToPoint(this.mouse.global,a.clientX,a.clientY),this.didMove=!0,this.cursor="inherit",this.processInteractive(this.mouse.global,this.renderer._lastObjectRendered,this.processMouseMove,!0),this.currentCursorStyle!==this.cursor&&(this.currentCursorStyle=this.cursor,this.interactionDOMElement.style.cursor=this.cursor)},d.prototype.processMouseMove=function(a,b){this.processMouseOverOut(a,b),this.moveWhenInside&&!b||this.dispatchEvent(a,"mousemove",this.eventData)},d.prototype.onMouseOut=function(a){this.mouse.originalEvent=a,this.eventData.stopped=!1,this.mapPositionToPoint(this.mouse.global,a.clientX,a.clientY),this.interactionDOMElement.style.cursor="inherit",this.mapPositionToPoint(this.mouse.global,a.clientX,a.clientY),this.processInteractive(this.mouse.global,this.renderer._lastObjectRendered,this.processMouseOverOut,!1)},d.prototype.processMouseOverOut=function(a,b){b?(a._over||(a._over=!0,this.dispatchEvent(a,"mouseover",this.eventData)),a.buttonMode&&(this.cursor=a.defaultCursor)):a._over&&(a._over=!1,this.dispatchEvent(a,"mouseout",this.eventData))},d.prototype.onTouchStart=function(a){this.autoPreventDefault&&a.preventDefault();for(var b=a.changedTouches,c=b.length,d=0;d<c;d++){var e=b[d],f=this.getTouchData(e);f.originalEvent=a,this.eventData.data=f,this.eventData.stopped=!1,this.processInteractive(f.global,this.renderer._lastObjectRendered,this.processTouchStart,!0),this.returnTouchData(f)}},d.prototype.processTouchStart=function(a,b){b&&(a._touchDown=!0,this.dispatchEvent(a,"touchstart",this.eventData))},d.prototype.onTouchEnd=function(a){this.autoPreventDefault&&a.preventDefault();for(var b=a.changedTouches,c=b.length,d=0;d<c;d++){var e=b[d],f=this.getTouchData(e);f.originalEvent=a,this.eventData.data=f,this.eventData.stopped=!1,this.processInteractive(f.global,this.renderer._lastObjectRendered,this.processTouchEnd,!0),this.returnTouchData(f)}},d.prototype.processTouchEnd=function(a,b){b?(this.dispatchEvent(a,"touchend",this.eventData),a._touchDown&&(a._touchDown=!1,this.dispatchEvent(a,"tap",this.eventData))):a._touchDown&&(a._touchDown=!1,this.dispatchEvent(a,"touchendoutside",this.eventData))},d.prototype.onTouchMove=function(a){this.autoPreventDefault&&a.preventDefault();for(var b=a.changedTouches,c=b.length,d=0;d<c;d++){var e=b[d],f=this.getTouchData(e);f.originalEvent=a,this.eventData.data=f,this.eventData.stopped=!1,this.processInteractive(f.global,this.renderer._lastObjectRendered,this.processTouchMove,this.moveWhenInside),this.returnTouchData(f)}},d.prototype.processTouchMove=function(a,b){this.moveWhenInside&&!b||this.dispatchEvent(a,"touchmove",this.eventData)},d.prototype.getTouchData=function(a){var b=this.interactiveDataPool.pop();return b||(b=new f),b.identifier=a.identifier,this.mapPositionToPoint(b.global,a.clientX,a.clientY),navigator.isCocoonJS&&(b.global.x=b.global.x/this.resolution,b.global.y=b.global.y/this.resolution),a.globalX=b.global.x,a.globalY=b.global.y,b},d.prototype.returnTouchData=function(a){this.interactiveDataPool.push(a)},d.prototype.destroy=function(){this.removeEvents(),this.renderer=null,this.mouse=null,this.eventData=null,this.interactiveDataPool=null,this.interactionDOMElement=null,this.onMouseUp=null,this.processMouseUp=null,this.onMouseDown=null,this.processMouseDown=null,this.onMouseMove=null,this.processMouseMove=null,this.onMouseOut=null,this.processMouseOverOut=null,this.onTouchStart=null,this.processTouchStart=null,this.onTouchEnd=null,this.processTouchEnd=null,this.onTouchMove=null,this.processTouchMove=null,this._tempPoint=null},e.WebGLRenderer.registerPlugin("interaction",d),e.CanvasRenderer.registerPlugin("interaction",d)},{"../core":29,"./InteractionData":116,"./interactiveTarget":119}],118:[function(a,b,c){b.exports={InteractionData:a("./InteractionData"),InteractionManager:a("./InteractionManager"),interactiveTarget:a("./interactiveTarget")}},{"./InteractionData":116,"./InteractionManager":117,"./interactiveTarget":119}],119:[function(a,b,c){var d={interactive:!1,buttonMode:!1,interactiveChildren:!0,defaultCursor:"pointer",_over:!1,_touchDown:!1};b.exports=d},{}],120:[function(a,b,c){function d(a,b){var c={},d=a.data.getElementsByTagName("info")[0],e=a.data.getElementsByTagName("common")[0];c.font=d.getAttribute("face"),c.size=parseInt(d.getAttribute("size"),10),c.lineHeight=parseInt(e.getAttribute("lineHeight"),10),c.chars={};for(var h=a.data.getElementsByTagName("char"),i=0;i<h.length;i++){var j=parseInt(h[i].getAttribute("id"),10),k=new f.Rectangle(parseInt(h[i].getAttribute("x"),10)+b.frame.x,parseInt(h[i].getAttribute("y"),10)+b.frame.y,parseInt(h[i].getAttribute("width"),10),parseInt(h[i].getAttribute("height"),10));c.chars[j]={xOffset:parseInt(h[i].getAttribute("xoffset"),10),yOffset:parseInt(h[i].getAttribute("yoffset"),10),xAdvance:parseInt(h[i].getAttribute("xadvance"),10),kerning:{},texture:new f.Texture(b.baseTexture,k)}}var l=a.data.getElementsByTagName("kerning");for(i=0;i<l.length;i++){var m=parseInt(l[i].getAttribute("first"),10),n=parseInt(l[i].getAttribute("second"),10),o=parseInt(l[i].getAttribute("amount"),10);c.chars[n]&&(c.chars[n].kerning[m]=o)}a.bitmapFont=c,g.BitmapText.fonts[c.font]=c}var e=a("resource-loader").Resource,f=a("../core"),g=a("../extras"),h=a("path");b.exports=function(){return function(a,b){if(!a.data||!a.isXml)return b();if(0===a.data.getElementsByTagName("page").length||0===a.data.getElementsByTagName("info").length||null===a.data.getElementsByTagName("info")[0].getAttribute("face"))return b();var c=h.dirname(a.url);"."===c&&(c=""),this.baseUrl&&c&&("/"===this.baseUrl.charAt(this.baseUrl.length-1)&&(c+="/"),c=c.replace(this.baseUrl,"")),c&&"/"!==c.charAt(c.length-1)&&(c+="/");var g=c+a.data.getElementsByTagName("page")[0].getAttribute("file");if(f.utils.TextureCache[g])d(a,f.utils.TextureCache[g]),b();else{var i={crossOrigin:a.crossOrigin,loadType:e.LOAD_TYPE.IMAGE,metadata:a.metadata.imageMetadata};this.add(a.name+"_image",g,i,function(c){d(a,c.texture),b()})}}}},{"../core":29,"../extras":86,path:2,"resource-loader":16}],121:[function(a,b,c){b.exports={Loader:a("./loader"),bitmapFontParser:a("./bitmapFontParser"),spritesheetParser:a("./spritesheetParser"),textureParser:a("./textureParser"),Resource:a("resource-loader").Resource}},{"./bitmapFontParser":120,"./loader":122,"./spritesheetParser":123,"./textureParser":124,"resource-loader":16}],122:[function(a,b,c){function d(a,b){e.call(this,a,b);for(var c=0;c<d._pixiMiddleware.length;++c)this.use(d._pixiMiddleware[c]())}var e=a("resource-loader"),f=a("./textureParser"),g=a("./spritesheetParser"),h=a("./bitmapFontParser");d.prototype=(0,s.default)(e.prototype),d.prototype.constructor=d,b.exports=d,d._pixiMiddleware=[e.middleware.parsing.blob,f,g,h],d.addPixiMiddleware=function(a){
d._pixiMiddleware.push(a)};var i=e.Resource;i.setExtensionXhrType("fnt",i.XHR_RESPONSE_TYPE.DOCUMENT)},{"./bitmapFontParser":120,"./spritesheetParser":123,"./textureParser":124,"resource-loader":16}],123:[function(a,b,c){var d=a("resource-loader").Resource,e=a("path"),f=a("../core");b.exports=function(){return function(a,b){if(!a.data||!a.isJson||!a.data.frames)return b();var c={crossOrigin:a.crossOrigin,loadType:d.LOAD_TYPE.IMAGE,metadata:a.metadata.imageMetadata},g=e.dirname(a.url.replace(this.baseUrl,"")),h=f.utils.getResolutionOfUrl(a.url);this.add(a.name+"_image",g+"/"+a.data.meta.imageElement,c,function(c){a.textures={};var d=a.data.frames;for(var e in d){var g=d[e].frame;if(g){var i=null,j=null;if(i=d[e].rotated?new f.Rectangle(g.x,g.y,g.h,g.w):new f.Rectangle(g.x,g.y,g.w,g.h),d[e].trimmed&&(j=new f.Rectangle(d[e].spriteSourceSize.x/h,d[e].spriteSourceSize.y/h,d[e].sourceSize.w/h,d[e].sourceSize.h/h)),d[e].rotated){var k=i.width;i.width=i.height,i.height=k}i.x/=h,i.y/=h,i.width/=h,i.height/=h,a.textures[e]=new f.Texture(c.texture.baseTexture,i,i.clone(),j,d[e].rotated?2:0),f.utils.TextureCache[e]=a.textures[e]}}b()})}}},{"../core":29,path:2,"resource-loader":16}],124:[function(a,b,c){var d=a("../core");b.exports=function(){return function(a,b){if(a.data&&a.isImage){var c=new d.BaseTexture(a.data,null,d.utils.getResolutionOfUrl(a.url));c.imageUrl=a.url,a.texture=new d.Texture(c),d.utils.BaseTextureCache[a.url]=c,d.utils.TextureCache[a.url]=a.texture}b()}}},{"../core":29}],125:[function(a,b,c){function d(a,b,c,f,g){e.Container.call(this),this._texture=null,this.uvs=c||new Float32Array([0,0,1,0,1,1,0,1]),this.vertices=b||new Float32Array([0,0,100,0,100,100,0,100]),this.indices=f||new Uint16Array([0,1,3,2]),this.dirty=!0,this.blendMode=e.BLEND_MODES.NORMAL,this.canvasPadding=0,this.drawMode=g||d.DRAW_MODES.TRIANGLE_MESH,this.texture=a,this.shader=null}var e=a("../core"),f=new e.Point,g=new e.Polygon;d.prototype=(0,s.default)(e.Container.prototype),d.prototype.constructor=d,b.exports=d,(0,m.default)(d.prototype,{texture:{get:function(){return this._texture},set:function(a){this._texture!==a&&(this._texture=a,a&&(a.baseTexture.hasLoaded?this._onTextureUpdate():a.once("update",this._onTextureUpdate,this)))}}}),d.prototype._renderWebGL=function(a){a.setObjectRenderer(a.plugins.mesh),a.plugins.mesh.render(this)},d.prototype._renderCanvas=function(a){var b=a.context,c=this.worldTransform;a.roundPixels?b.setTransform(c.a,c.b,c.c,c.d,0|c.tx,0|c.ty):b.setTransform(c.a,c.b,c.c,c.d,c.tx,c.ty),this.drawMode===d.DRAW_MODES.TRIANGLE_MESH?this._renderCanvasTriangleMesh(b):this._renderCanvasTriangles(b)},d.prototype._renderCanvasTriangleMesh=function(a){for(var b=this.vertices,c=this.uvs,d=b.length/2,e=0;e<d-2;e++){var f=2*e;this._renderCanvasDrawTriangle(a,b,c,f,f+2,f+4)}},d.prototype._renderCanvasTriangles=function(a){for(var b=this.vertices,c=this.uvs,d=this.indices,e=d.length,f=0;f<e;f+=3){var g=2*d[f],h=2*d[f+1],i=2*d[f+2];this._renderCanvasDrawTriangle(a,b,c,g,h,i)}},d.prototype._renderCanvasDrawTriangle=function(a,b,c,d,e,f){var g=this._texture.baseTexture.source,h=this._texture.baseTexture.width,i=this._texture.baseTexture.height,j=b[d],k=b[e],l=b[f],m=b[d+1],n=b[e+1],o=b[f+1],p=c[d]*h,q=c[e]*h,r=c[f]*h,s=c[d+1]*i,t=c[e+1]*i,u=c[f+1]*i;if(this.canvasPadding>0){var v=this.canvasPadding/this.worldTransform.a,w=this.canvasPadding/this.worldTransform.d,x=(j+k+l)/3,y=(m+n+o)/3,z=j-x,A=m-y,B=Math.sqrt(z*z+A*A);j=x+z/B*(B+v),m=y+A/B*(B+w),z=k-x,A=n-y,B=Math.sqrt(z*z+A*A),k=x+z/B*(B+v),n=y+A/B*(B+w),z=l-x,A=o-y,B=Math.sqrt(z*z+A*A),l=x+z/B*(B+v),o=y+A/B*(B+w)}a.save(),a.beginPath(),a.moveTo(j,m),a.lineTo(k,n),a.lineTo(l,o),a.closePath(),a.clip();var C=p*t+s*r+q*u-t*r-s*q-p*u,D=j*t+s*l+k*u-t*l-s*k-j*u,E=p*k+j*r+q*l-k*r-j*q-p*l,F=p*t*l+s*k*r+j*q*u-j*t*r-s*q*l-p*k*u,G=m*t+s*o+n*u-t*o-s*n-m*u,H=p*n+m*r+q*o-n*r-m*q-p*o,I=p*t*o+s*n*r+m*q*u-m*t*r-s*q*o-p*n*u;a.transform(D/C,G/C,E/C,H/C,F/C,I/C),a.drawImage(g,0,0),a.restore()},d.prototype.renderMeshFlat=function(a){var b=this.context,c=a.vertices,d=c.length/2;b.beginPath();for(var e=1;e<d-2;e++){var f=2*e,g=c[f],h=c[f+2],i=c[f+4],j=c[f+1],k=c[f+3],l=c[f+5];b.moveTo(g,j),b.lineTo(h,k),b.lineTo(i,l)}b.fillStyle="#FF0000",b.fill(),b.closePath()},d.prototype._onTextureUpdate=function(){this.updateFrame=!0},d.prototype.getBounds=function(a){if(!this._currentBounds){for(var b=a||this.worldTransform,c=b.a,d=b.b,f=b.c,g=b.d,h=b.tx,i=b.ty,j=-1/0,k=-1/0,l=1/0,m=1/0,n=this.vertices,o=0,p=n.length;o<p;o+=2){var q=n[o],r=n[o+1],s=c*q+f*r+h,t=g*r+d*q+i;l=s<l?s:l,m=t<m?t:m,j=s>j?s:j,k=t>k?t:k}if(l===-1/0||k===1/0)return e.Rectangle.EMPTY;var u=this._bounds;u.x=l,u.width=j-l,u.y=m,u.height=k-m,this._currentBounds=u}return this._currentBounds},d.prototype.containsPoint=function(a){if(!this.getBounds().contains(a.x,a.y))return!1;this.worldTransform.applyInverse(a,f);var b,c,e=this.vertices,h=g.points;if(this.drawMode===d.DRAW_MODES.TRIANGLES){var i=this.indices;for(c=this.indices.length,b=0;b<c;b+=3){var j=2*i[b],k=2*i[b+1],l=2*i[b+2];if(h[0]=e[j],h[1]=e[j+1],h[2]=e[k],h[3]=e[k+1],h[4]=e[l],h[5]=e[l+1],g.contains(f.x,f.y))return!0}}else for(c=e.length,b=0;b<c;b+=6)if(h[0]=e[b],h[1]=e[b+1],h[2]=e[b+2],h[3]=e[b+3],h[4]=e[b+4],h[5]=e[b+5],g.contains(f.x,f.y))return!0;return!1},d.DRAW_MODES={TRIANGLE_MESH:0,TRIANGLES:1}},{"../core":29}],126:[function(a,b,c){function d(a,b,c){e.call(this,a),this._ready=!0,this.segmentsX=b||10,this.segmentsY=c||10,this.drawMode=e.DRAW_MODES.TRIANGLES,this.refresh()}var e=a("./Mesh");d.prototype=(0,s.default)(e.prototype),d.prototype.constructor=d,b.exports=d,d.prototype.refresh=function(){var a=this.segmentsX*this.segmentsY,b=[],c=[],d=[],e=[],f=this.texture,g=this.segmentsX-1,h=this.segmentsY-1,i=0,j=f.width/g,k=f.height/h;for(i=0;i<a;i++){var l=i%this.segmentsX,m=i/this.segmentsX|0;b.push(l*j,m*k),d.push(f._uvs.x0+(f._uvs.x1-f._uvs.x0)*(l/(this.segmentsX-1)),f._uvs.y0+(f._uvs.y3-f._uvs.y0)*(m/(this.segmentsY-1)))}var n=g*h;for(i=0;i<n;i++){var o=i%g,p=i/g|0,q=p*this.segmentsX+o,r=p*this.segmentsX+o+1,s=(p+1)*this.segmentsX+o,t=(p+1)*this.segmentsX+o+1;e.push(q,r,s),e.push(r,t,s)}this.vertices=new Float32Array(b),this.uvs=new Float32Array(d),this.colors=new Float32Array(c),this.indices=new Uint16Array(e)},d.prototype._onTextureUpdate=function(){e.prototype._onTextureUpdate.call(this),this._ready&&this.refresh()}},{"./Mesh":125}],127:[function(a,b,c){function d(a,b){e.call(this,a),this.points=b,this.vertices=new Float32Array(4*b.length),this.uvs=new Float32Array(4*b.length),this.colors=new Float32Array(2*b.length),this.indices=new Uint16Array(2*b.length),this._ready=!0,this.refresh()}var e=a("./Mesh"),f=a("../core");d.prototype=(0,s.default)(e.prototype),d.prototype.constructor=d,b.exports=d,d.prototype.refresh=function(){var a=this.points;if(!(a.length<1)&&this._texture._uvs){var b=this.uvs,c=this.indices,d=this.colors,e=this._texture._uvs,g=new f.Point(e.x0,e.y0),h=new f.Point(e.x2-e.x0,e.y2-e.y0);b[0]=0+g.x,b[1]=0+g.y,b[2]=0+g.x,b[3]=1*h.y+g.y,d[0]=1,d[1]=1,c[0]=0,c[1]=1;for(var i,j,k=a.length,l=1;l<k;l++)a[l],i=4*l,j=l/(k-1),b[i]=j*h.x+g.x,b[i+1]=0+g.y,b[i+2]=j*h.x+g.x,b[i+3]=1*h.y+g.y,i=2*l,d[i]=1,d[i+1]=1,i=2*l,c[i]=i,c[i+1]=i+1;this.dirty=!0}},d.prototype._onTextureUpdate=function(){e.prototype._onTextureUpdate.call(this),this._ready&&this.refresh()},d.prototype.updateTransform=function(){var a=this.points;if(!(a.length<1)){for(var b,c,d,e,f,g,h=a[0],i=0,j=0,k=this.vertices,l=a.length,m=0;m<l;m++)c=a[m],d=4*m,b=m<a.length-1?a[m+1]:c,j=-(b.x-h.x),i=b.y-h.y,e=10*(1-m/(l-1)),e>1&&(e=1),f=Math.sqrt(i*i+j*j),g=this._texture.height/2,i/=f,j/=f,i*=g,j*=g,k[d]=c.x+i,k[d+1]=c.y+j,k[d+2]=c.x-i,k[d+3]=c.y-j,h=c;this.containerUpdateTransform()}}},{"../core":29,"./Mesh":125}],128:[function(a,b,c){b.exports={Mesh:a("./Mesh"),Plane:a("./Plane"),Rope:a("./Rope"),MeshRenderer:a("./webgl/MeshRenderer"),MeshShader:a("./webgl/MeshShader")}},{"./Mesh":125,"./Plane":126,"./Rope":127,"./webgl/MeshRenderer":129,"./webgl/MeshShader":130}],129:[function(a,b,c){function d(a){e.ObjectRenderer.call(this,a),this.indices=new Uint16Array(15e3);for(var b=0,c=0;b<15e3;b+=6,c+=4)this.indices[b+0]=c+0,this.indices[b+1]=c+1,this.indices[b+2]=c+2,this.indices[b+3]=c+0,this.indices[b+4]=c+2,this.indices[b+5]=c+3;this.currentShader=null}var e=a("../../core"),f=a("../Mesh");d.prototype=(0,s.default)(e.ObjectRenderer.prototype),d.prototype.constructor=d,b.exports=d,e.WebGLRenderer.registerPlugin("mesh",d),d.prototype.onContextChange=function(){},d.prototype.render=function(a){a._vertexBuffer||this._initWebGL(a);var b=this.renderer,c=b.gl,d=a._texture.baseTexture,e=a.shader,g=a.drawMode===f.DRAW_MODES.TRIANGLE_MESH?c.TRIANGLE_STRIP:c.TRIANGLES;b.blendModeManager.setBlendMode(a.blendMode),e=e?e.shaders[c.id]||e.getShader(b):b.shaderManager.plugins.meshShader,this.renderer.shaderManager.setShader(e),e.uniforms.translationMatrix.value=a.worldTransform.toArray(!0),e.uniforms.projectionMatrix.value=b.currentRenderTarget.projectionMatrix.toArray(!0),e.uniforms.alpha.value=a.worldAlpha,e.syncUniforms(),a.dirty?(a.dirty=!1,c.bindBuffer(c.ARRAY_BUFFER,a._vertexBuffer),c.bufferData(c.ARRAY_BUFFER,a.vertices,c.STATIC_DRAW),c.vertexAttribPointer(e.attributes.aVertexPosition,2,c.FLOAT,!1,0,0),c.bindBuffer(c.ARRAY_BUFFER,a._uvBuffer),c.bufferData(c.ARRAY_BUFFER,a.uvs,c.STATIC_DRAW),c.vertexAttribPointer(e.attributes.aTextureCoord,2,c.FLOAT,!1,0,0),c.activeTexture(c.TEXTURE0),d._glTextures[c.id]?c.bindTexture(c.TEXTURE_2D,d._glTextures[c.id]):this.renderer.updateTexture(d),c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,a._indexBuffer),c.bufferData(c.ELEMENT_ARRAY_BUFFER,a.indices,c.STATIC_DRAW)):(c.bindBuffer(c.ARRAY_BUFFER,a._vertexBuffer),c.bufferSubData(c.ARRAY_BUFFER,0,a.vertices),c.vertexAttribPointer(e.attributes.aVertexPosition,2,c.FLOAT,!1,0,0),c.bindBuffer(c.ARRAY_BUFFER,a._uvBuffer),c.vertexAttribPointer(e.attributes.aTextureCoord,2,c.FLOAT,!1,0,0),c.activeTexture(c.TEXTURE0),d._glTextures[c.id]?c.bindTexture(c.TEXTURE_2D,d._glTextures[c.id]):this.renderer.updateTexture(d),c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,a._indexBuffer),c.bufferSubData(c.ELEMENT_ARRAY_BUFFER,0,a.indices)),c.drawElements(g,a.indices.length,c.UNSIGNED_SHORT,0)},d.prototype._initWebGL=function(a){var b=this.renderer.gl;a._vertexBuffer=b.createBuffer(),a._indexBuffer=b.createBuffer(),a._uvBuffer=b.createBuffer(),b.bindBuffer(b.ARRAY_BUFFER,a._vertexBuffer),b.bufferData(b.ARRAY_BUFFER,a.vertices,b.DYNAMIC_DRAW),b.bindBuffer(b.ARRAY_BUFFER,a._uvBuffer),b.bufferData(b.ARRAY_BUFFER,a.uvs,b.STATIC_DRAW),a.colors&&(a._colorBuffer=b.createBuffer(),b.bindBuffer(b.ARRAY_BUFFER,a._colorBuffer),b.bufferData(b.ARRAY_BUFFER,a.colors,b.STATIC_DRAW)),b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,a._indexBuffer),b.bufferData(b.ELEMENT_ARRAY_BUFFER,a.indices,b.STATIC_DRAW)},d.prototype.flush=function(){},d.prototype.start=function(){this.currentShader=null},d.prototype.destroy=function(){e.ObjectRenderer.prototype.destroy.call(this)}},{"../../core":29,"../Mesh":125}],130:[function(a,b,c){function d(a){e.Shader.call(this,a,["precision lowp float;","attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","uniform mat3 translationMatrix;","uniform mat3 projectionMatrix;","varying vec2 vTextureCoord;","void main(void){","   gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vTextureCoord = aTextureCoord;","}"].join("\n"),["precision lowp float;","varying vec2 vTextureCoord;","uniform float alpha;","uniform sampler2D uSampler;","void main(void){","   gl_FragColor = texture2D(uSampler, vTextureCoord) * alpha ;","}"].join("\n"),{alpha:{type:"1f",value:0},translationMatrix:{type:"mat3",value:new Float32Array(9)},projectionMatrix:{type:"mat3",value:new Float32Array(9)}},{aVertexPosition:0,aTextureCoord:0})}var e=a("../../core");d.prototype=(0,s.default)(e.Shader.prototype),d.prototype.constructor=d,b.exports=d,e.ShaderManager.registerPlugin("meshShader",d)},{"../../core":29}],131:[function(a,b,c){k.default||(Math.sign=function(a){return a=+a,0===a||isNaN(a)?a:a>0?1:-1})},{}],132:[function(a,b,c){q.default||(Object.assign=a("object-assign"))},{"object-assign":11}],133:[function(a,b,c){a("./Object.assign"),a("./requestAnimationFrame"),a("./Math.sign")},{"./Math.sign":131,"./Object.assign":132,"./requestAnimationFrame":134}],134:[function(a,b,c){(function(a){if(Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),!a.performance||!a.performance.now){var b=Date.now();a.performance||(a.performance={}),a.performance.now=function(){return Date.now()-b}}for(var c=Date.now(),d=["ms","moz","webkit","o"],e=0;e<d.length&&!a.requestAnimationFrame;++e)a.requestAnimationFrame=a[d[e]+"RequestAnimationFrame"],a.cancelAnimationFrame=a[d[e]+"CancelAnimationFrame"]||a[d[e]+"CancelRequestAnimationFrame"];a.requestAnimationFrame||(a.requestAnimationFrame=function(a){if("function"!=typeof a)throw new TypeError(a+"is not a function");var b=Date.now(),d=16+c-b;return d<0&&(d=0),c=b,setTimeout(function(){c=Date.now(),a(performance.now())},d)}),a.cancelAnimationFrame||(a.cancelAnimationFrame=function(a){clearTimeout(a)})}).call(this,void 0!==d?d:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[115])(115)})}).call(b,c(91))},function(a,b,c){c(265),a.exports=c(9).Math.sign},function(a,b,c){var d=c(13);d(d.S,"Math",{sign:c(266)})},function(a,b){a.exports=Math.sign||function(a){return 0==(a=+a)||a!=a?a:a<0?-1:1}},function(a,b,c){c(268);var d=c(9).Object;a.exports=function(a,b){return d.defineProperties(a,b)}},function(a,b,c){var d=c(13);d(d.S+d.F*!c(27),"Object",{defineProperties:c(149)})},function(a,b,c){c(153),a.exports=c(9).Object.getOwnPropertySymbols},function(a,b,c){a.exports={"default":c(271),__esModule:!0}},function(a,b,c){c(272),a.exports=c(9).setImmediate},function(a,b,c){var d=c(13),e=c(120);d(d.G+d.B,{setImmediate:e.set,clearImmediate:e.clear})},function(a,b,c){c(274),a.exports=c(9).Object.keys},function(a,b,c){var d=c(86),e=c(68);c(172)("keys",function(){return function(a){return e(d(a))}})},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(2),h=d(g),i=c(3),j=d(i),k=c(5),l=d(k),m=c(92),n=d(m),o=function(a){function b(){var c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Anonymous";(0,f.default)(this,b);var d=(0,h.default)(this,a.call(this));return d.crossOrigin=c,d}return(0,j.default)(b,a),b.prototype.loadImage=function(a,b,c,d){function e(b){j.off("load"),j.off("error"),c.apply(null,[a].concat(h))}function f(a){j.off("load"),j.off("error"),d&&d(a)}for(var g=arguments.length,h=Array(g>4?g-4:0),i=4;i<g;i++)h[i-4]=arguments[i];a=a||document.createElement("img"),this.crossOrigin&&(a.crossOrigin=this.crossOrigin);var j=(0,l.default)(a);return j.one("load",e).one("error",f),a.src=b,a},b.prototype.loadColorTables=function(a,b,c){function d(c){if(c&&f.push(c),g>=a.length)return void b(f);h.loadImage(null,a[g++],d,e)}function e(a){c(a),d()}var f=[],g=0,h=this;d()},b}(n.default);b.default=o},function(a,b,c){c(277),a.exports=9007199254740991},function(a,b,c){var d=c(13);d(d.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(1),h=d(g),i=c(2),j=d(i),k=c(3),l=d(k),m=c(23),n=d(m),o=c(31),p=d(o),q=c(279),r=d(q),s=c(303),t=d(s),u=c(305),v=d(u),w=c(124),x=c(180),y=c(130).AutoAdjustment,z=function(a){function b(c,d){(0,f.default)(this,b);var e=(0,j.default)(this,a.call(this,c,d));return e._init(),e}return(0,l.default)(b,a),b.prototype.start=function(){a.prototype.start.call(this)},b.prototype.suspend=function(){return a.prototype.suspend.call(this)},b.prototype.snapshot=function(){var a=this._adjust;return{brightness:a.brightness,contrast:a.contrast,saturation:a.saturation,hue:a.hue,kelvin:a.kelvin,sharpen:this._sharpen.sharpen,autolevel:this._autolevel.enabled}},b.prototype.reset=function(b){var c=arguments.length>1&&void 0!==arguments[1]&&arguments[1];b=b||{};var d=this._adjust;d.brightness=b.brightness||0,d.contrast=b.contrast||1,d.saturation=void 0===b.saturation?1:b.saturation,d.hue=b.hue||0,d.kelvin=b.kelvin||0,this._sharpen.sharpen=this._sharpenPreview.sharpen=b.sharpen||0,this._autolevel.enabled=b.autolevel||!1,a.prototype.reset.call(this,c)},b.prototype._init=function(){this._blurRadiusFactor=1,this._sharpenRadiusFactor=1,this._blurType="",this.stage.glAvailable?(this._adjust=new r.default,this._sharpen=new t.default,this._sharpenPreview=new t.default,this._autolevel=new v.default):(this._adjust=new w,this._sharpen=new x,this._sharpenPreview=new x,this._autolevel=new y),this._filters=[this._adjust,this._sharpen,this._autolevel],this.stage.on(p.default.UPDATE_SHARPEN_FACTOR,this.onUpdateSharpenFactor,this)},b.prototype.onUpdateSharpenFactor=function(a,b){this._sharpenRadiusFactor=a,this._blurRadiusFactor=b},(0,h.default)(b,[{key:"modified",get:function(){if(!this.stage.ready)return!1;var a=this._adjust;return 0!=a.brightness||1!=a.contrast||1!=a.saturation||0!=a.hue||0!=a.kelvin||0!=this._sharpen.sharpen||this._autolevel.enabled}},{key:"brightness",get:function(){return this._adjust.brightness},set:function(a){this.brightness!=a&&(this._adjust.brightness=a,this.invalidate(this._adjust))}},{key:"contrast",get:function(){return this._adjust.contrast},set:function(a){this.contrast!=a&&(this._adjust.contrast=a,this.invalidate(this._adjust))}},{key:"saturation",get:function(){return this._adjust.saturation},set:function(a){this.saturation!=a&&(this._adjust.saturation=a,this.invalidate(this._adjust))}},{key:"hue",get:function(){return this._adjust.hue},set:function(a){this.hue!=a&&(this._adjust.hue=a,this.invalidate(this._adjust))}},{key:"sharpen",get:function(){return this._sharpen.sharpen},set:function(a){this.sharpen!=a&&(this._sharpen.sharpen=a,this._sharpenPreview.sharpen=a<0?a*this._blurRadiusFactor:a*this._sharpenRadiusFactor,this.invalidate(this._sharpen))}},{key:"kelvin",get:function(){return this._adjust.kelvin},set:function(a){this.kelvin!=a&&(this._adjust.kelvin=a,this.invalidate(this._adjust))}},{key:"blurType",get:function(){return this._blurType},set:function(a){this._blurType!=a&&(this._blurType=a,this._sharpen.setBlurType(a),this._sharpenPreview.setBlurType(a))}},{key:"autolevel",get:function(){return this._autolevel.enabled},set:function(a){this.autolevel!=a&&(this._autolevel.enabled=a,this.invalidate(this._autolevel),this.pushHistory())}},{key:"blurScale",get:function(){return this._sharpen.blurFilter.scale},set:function(a){this._sharpen.blurFilter.scale=a,this._sharpenPreview.blurFilter.scale=a}}]),b}(n.default);b.default=z},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(1),h=d(g),i=c(2),j=d(i),k=c(3),l=d(k),m=c(124),n=d(m),o=c(44),p=d(o),q=function(a){function b(c){(0,f.default)(this,b);var d=(0,j.default)(this,a.call(this,c));return d._colorTransform=new n.default,d}return(0,l.default)(b,a),b.prototype.draw=function(){this.program.setUniformMat4("colorMat4",this.colorTransform.colorMat4),a.prototype.draw.call(this)},(0,h.default)(b,[{key:"changed",get:function(){return this.colorTransform.changed}},{key:"brightness",get:function(){return this.colorTransform.brightness},set:function(a){this.colorTransform.brightness=a}},{key:"contrast",get:function(){return this.colorTransform.contrast},set:function(a){this.colorTransform.contrast=a}},{key:"saturation",get:function(){return this.colorTransform.saturation},set:function(a){this.colorTransform.saturation=a}},{key:"hue",get:function(){return this.colorTransform.hue},set:function(a){this.colorTransform.hue=a}},{key:"kelvin",get:function(){return this.colorTransform.kelvin},set:function(a){this.colorTransform.kelvin=a}},{key:"colorTransform",get:function(){return this._colorTransform}},{key:"fragmentSource",get:function(){return"\n	precision highp float;\n\n	uniform mat4 colorMat4;\n	uniform sampler2D texture;\n\n	varying vec2 vTexCoord;\n\n	void main() {\n		vec4 pixel = texture2D(texture, vTexCoord);\n\n		gl_FragColor = colorMat4 * pixel;\n	}\n"}},{key:"name",get:function(){return"ColorTransformFilter"}}]),b}(p.default);b.default=q},function(a,b,c){"use strict";(function(a){function b(a){return a&&a.__esModule?a:{"default":a}}var d=c(4),e=b(d),f=c(38),g=b(f);!function(){function b(a){this._colorMatrix=a||new f}var d=c(39).loop,f=c(125);if(b.prototype={constructor:b,applyFilter:function(a,b,c,d,e,f){if(!this.colorMatrix.dirty)return!1;c=c||0,d=d||0,e=e||a.width,f=f||a.height;for(var g,h,i,j=0|Math.max(0,Math.min(a.width,c+e)),k=0|Math.max(0,Math.min(a.height,d+f)),l=this.colorMatrix.raw,m=l[0],n=l[3],o=l[6],p=l[9],q=l[1],r=l[4],s=l[7],t=l[10],u=l[2],v=l[5],w=l[8],x=l[11],y=a.data,z=b.data,A=a.width,B=0,C=0,D=0|c;D<k;D++){B=4*D*A|0;for(var E=d;E<j;E++)C=B+4*E|0,g=y[C]/255,h=y[C+1]/255,i=y[C+2]/255,z[C]=255*(g*m+h*n+i*o+p),z[C+1]=255*(g*q+h*r+i*s+t),z[C+2]=255*(g*u+h*v+i*w+x),z[C+3]=y[C+3]}return!0},applyFilterAsync:function(a,b,c,e,f,g,h,i){if(!this.colorMatrix.dirty)return!1;c=c||0,e=e||0,f=f||a.width,g=g||a.height;var j=0|Math.max(0,Math.min(a.width,c+f)),k=0|Math.max(0,Math.min(a.height,e+g)),l=this.colorMatrix.raw,m=l[0],n=l[3],o=l[6],p=l[9],q=l[1],r=l[4],s=l[7],t=l[10],u=l[2],v=l[5],w=l[8],x=l[11],y=a.data,z=b.data,A=a.width;return d(c,k,this.onFilterLoop,[y,z,A,j,m,n,o,p,q,r,s,t,u,v,w,x,l,e],this,h,i),!0},onFilterLoop:function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){var u,v,w,x,y,z=c,A=d,B=a+1e3;for(B>b&&(B=b);a<B;a++){u=4*a*e|0;for(var C=t;C<f;C++)v=u+4*C|0,w=z[v]/255,x=z[v+1]/255,y=z[v+2]/255,A[v]=255*(w*g+x*h+y*i+j),A[v+1]=255*(w*k+x*l+y*m+n),A[v+2]=255*(w*o+x*p+y*q+r),A[v+3]=z[v+3]}return a}},(0,g.default)(b.prototype,{colorMatrix:{get:function(){return this._colorMatrix}},name:{get:function(){return"ColorMatrixFilter"}},changed:{get:function(){return this.colorMatrix.dirty}}}),void 0!==(0,e.default)(a)&&void 0!==(0,e.default)(a.exports))a.exports=b;else{usenamespace("editor.filter").ColorMatrixFilter=b}}()}).call(b,c(6)(a))},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(45),f=d(e),g=c(126),h=d(g),i=c(0),j=d(i),k=c(1),l=d(k),m=c(2),n=d(m),o=c(3),p=d(o),q=c(298),r=d(q),s=c(24),t=c(40),u=d(t),v=function(a){function b(c,d,e){var f=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},g=f.model,h=void 0===g?"model":g,i=f.world,k=void 0===i?"world":i,l=f.vertex,m=void 0===l?"vertex":l,o=f.texCoord,p=void 0===o?"texCoord":o,q=f.texture,s=void 0===q?"texture":q,t=f.color,u=void 0===t?"color":t;(0,j.default)(this,b);var v=(0,n.default)(this,a.call(this,c));return(0,r.default)(v.gl),v._model=h,v._world=k,v._vertex=m,v._texCoord=p,v._texture=s,v._color=u,v._init(),v._initProgram(d,e),v}return(0,p.default)(b,a),b.prototype._init=function(){this._map=new h.default},b.prototype._initProgram=function(a,b){this._program=(0,s.createProgram)(this.gl,a,b)},b.prototype.dispose=function(){this.clearProgram()},b.prototype.clearProgram=function(){this.program&&(this.gl.deleteProgram(this.program),this._map.clear())},b.prototype.use=function(){this.gl.useProgram(this.program)},b.prototype.getAttrib=function(a){if(!this._map.has(a)){var b=this.gl.getAttribLocation(this.program,a);this._map.set(a,b),this.gl.enableVertexAttribArray(b)}return this._map.get(a)},b.prototype.getUniform=function(a){if(!this._map.has(a)){var b=this.gl.getUniformLocation(this.program,a);this._map.set(a,b)}return this._map.get(a)},b.prototype.setDrawingBuffer=function(a){var b=a.dataMap,c=this.gl,d=a.bytesPerData;c.bindBuffer(a.bufferType,a.vertexBuffer),c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,a.indexBuffer);for(var e=b,g=Array.isArray(e),h=0,e=g?e:(0,f.default)(e);;){var i;if(g){if(h>=e.length)break;i=e[h++]}else{if(h=e.next(),h.done)break;i=h.value}var j=i,k=j[0],l=j[1];c.vertexAttribPointer(this.getAttrib(k),l.size,a.dataType,!1,d*a.numDataPerVertex,d*l.offset)}},b.prototype.setTransform=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,e=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,f=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;this.setTransformMat3(new Float32Array([a,b,0,c,d,0,e,f,1]))},b.prototype.setTransformMat3=function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"model";this.setUniformMat3(b,a)},b.prototype.draw=function(a){var b=this.gl;this.setDrawingBuffer(a),b.drawElements(b.TRIANGLES,6,b.UNSIGNED_SHORT,0)},b.prototype.clearColorBuffer=function(){this.gl.clear(this.gl.COLOR_BUFFER_BIT)},b.prototype.setAttributef=function(a){for(var b,c=arguments.length,d=Array(c>1?c-1:0),e=1;e<c;e++)d[e-1]=arguments[e];(b=this.gl)["vertexAttrib"+d.length+"f"].apply(b,[this.getAttrib(a)].concat(d))},b.prototype.setAttributefv=function(a,b){this.gl["vertexAttrib"+b.length+"fv"](this.getAttrib(a),b)},b.prototype.setUniformf=function(a){for(var b,c=arguments.length,d=Array(c>1?c-1:0),e=1;e<c;e++)d[e-1]=arguments[e];(b=this.gl)["uniform"+d.length+"f"].apply(b,[this.getUniform(a)].concat(d))},b.prototype.setUniformi=function(a){for(var b,c=arguments.length,d=Array(c>1?c-1:0),e=1;e<c;e++)d[e-1]=arguments[e];(b=this.gl)["uniform"+d.length+"i"].apply(b,[this.getUniform(a)].concat(d))},b.prototype.setUniformfv=function(a,b){this.gl["uniform"+b.length+"fv"](this.getUniform(a),b)},b.prototype.setUniformiv=function(a,b){this.gl["uniform"+b.length+"iv"](this.getUniform(a),b)},b.prototype.setUniformMatrix=function(a,b){var c=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.gl["uniformMatrix"+(0|Math.sqrt(b.length))+"fv"](this.getUniform(a),c,b)},b.prototype.setUniformMat2=function(a,b){var c=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.gl.uniformMatrix2fv(this.getUniform(a),c,b)},b.prototype.setUniformMat3=function(a,b){var c=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.gl.uniformMatrix3fv(this.getUniform(a),c,b)},b.prototype.setUniformMat4=function(a,b){var c=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.gl.uniformMatrix4fv(this.getUniform(a),c,b)},b.prototype.delete=function(a){this._map.delete(a)},(0,l.default)(b,[{key:"using",get:function(){var a=this.gl;return a.getParameter(a.CURRENT_PROGRAM)===this.program}},{key:"model",get:function(){return this._model}},{key:"wolrd",get:function(){return this._world}},{key:"texture",get:function(){return this._texture}},{key:"vertex",get:function(){return this._vertex}},{key:"texCoord",get:function(){return this._texCoord}},{key:"color",get:function(){return this._color}},{key:"program",get:function(){return this._program}}]),b}(u.default);b.default=v},function(a,b,c){c(87),c(82),a.exports=c(283)},function(a,b,c){var d=c(29),e=c(158);a.exports=c(9).getIterator=function(a){var b=e(a);if("function"!=typeof b)throw TypeError(a+" is not iterable!");return d(b.call(a))}},function(a,b,c){c(117),c(82),c(87),c(285),c(291),c(294),c(296),a.exports=c(9).Map},function(a,b,c){"use strict";var d=c(286),e=c(175);a.exports=c(287)("Map",function(a){return function(){return a(this,arguments.length>0?arguments[0]:void 0)}},{get:function(a){var b=d.getEntry(e(this,"Map"),a);return b&&b.v},set:function(a,b){return d.def(e(this,"Map"),0===a?0:a,b)}},d,!0)},function(a,b,c){"use strict";var d=c(28).f,e=c(84),f=c(122),g=c(42),h=c(119),i=c(72),j=c(107),k=c(152),l=c(162),m=c(27),n=c(114).fastKey,o=c(175),p=m?"_s":"size",q=function(a,b){var c,d=n(b);if("F"!==d)return a._i[d];for(c=a._f;c;c=c.n)if(c.k==b)return c};a.exports={getConstructor:function(a,b,c,j){var k=a(function(a,d){h(a,k,b,"_i"),a._t=b,a._i=e(null),a._f=void 0,a._l=void 0,a[p]=0,void 0!=d&&i(d,c,a[j],a)});return f(k.prototype,{clear:function(){for(var a=o(this,b),c=a._i,d=a._f;d;d=d.n)d.r=!0,d.p&&(d.p=d.p.n=void 0),delete c[d.i];a._f=a._l=void 0,a[p]=0},"delete":function(a){var c=o(this,b),d=q(c,a);if(d){var e=d.n,f=d.p;delete c._i[d.i],d.r=!0,f&&(f.n=e),e&&(e.p=f),c._f==d&&(c._f=e),c._l==d&&(c._l=f),c[p]--}return!!d},forEach:function(a){o(this,b);for(var c,d=g(a,arguments.length>1?arguments[1]:void 0,3);c=c?c.n:this._f;)for(d(c.v,c.k,this);c&&c.r;)c=c.p},has:function(a){return!!q(o(this,b),a)}}),m&&d(k.prototype,"size",{get:function(){return o(this,b)[p]}}),k},def:function(a,b,c){var d,e,f=q(a,b);return f?f.v=c:(a._l=f={i:e=n(b,!0),k:b,v:c,p:d=a._l,n:void 0,r:!1},a._f||(a._f=f),d&&(d.n=f),a[p]++,"F"!==e&&(a._i[e]=f)),a},getEntry:q,setStrong:function(a,b,c){j(a,b,function(a,c){this._t=o(a,b),this._k=c,this._l=void 0},function(){for(var a=this,b=a._k,c=a._l;c&&c.r;)c=c.p;return a._t&&(a._l=c=c?c.n:a._t._f)?"keys"==b?k(0,c.k):"values"==b?k(0,c.v):k(0,[c.k,c.v]):(a._t=void 0,k(1))},c?"entries":"values",!c,!0),l(b)}}},function(a,b,c){"use strict";var d=c(18),e=c(13),f=c(114),g=c(50),h=c(43),i=c(122),j=c(72),k=c(119),l=c(26),m=c(70),n=c(28).f,o=c(288)(0),p=c(27);a.exports=function(a,b,c,q,r,s){var t=d[a],u=t,v=r?"set":"add",w=u&&u.prototype,x={};return p&&"function"==typeof u&&(s||w.forEach&&!g(function(){(new u).entries().next()}))?(u=b(function(b,c){k(b,u,a,"_c"),b._c=new t,void 0!=c&&j(c,r,b[v],b)}),o("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),function(a){var b="add"==a||"set"==a;a in w&&(!s||"clear"!=a)&&h(u.prototype,a,function(c,d){if(k(this,u,a),!b&&s&&!l(c))return"get"==a&&void 0;var e=this._c[a](0===c?0:c,d);return b?this:e})}),s||n(u.prototype,"size",{get:function(){return this._c.size}})):(u=q.getConstructor(b,a,r,v),i(u.prototype,c),f.NEED=!0),m(u,a),x[a]=u,e(e.G+e.W+e.F,x),s||q.setStrong(u,a,r),u}},function(a,b,c){var d=c(42),e=c(108),f=c(86),g=c(109),h=c(289);a.exports=function(a,b){var c=1==a,i=2==a,j=3==a,k=4==a,l=6==a,m=5==a||l,n=b||h;return function(b,h,o){for(var p,q,r=f(b),s=e(r),t=d(h,o,3),u=g(s.length),v=0,w=c?n(b,u):i?n(b,0):void 0;u>v;v++)if((m||v in s)&&(p=s[v],q=t(p,v,r),a))if(c)w[v]=q;else if(q)switch(a){case 3:return!0;case 5:return p;case 6:return v;case 2:w.push(p)}else if(k)return!1;return l?-1:j||k?k:w}}},function(a,b,c){var d=c(290);a.exports=function(a,b){return new(d(a))(b)}},function(a,b,c){var d=c(26),e=c(154),f=c(19)("species");a.exports=function(a){var b;return e(a)&&(b=a.constructor,"function"!=typeof b||b!==Array&&!e(b.prototype)||(b=void 0),d(b)&&null===(b=b[f])&&(b=void 0)),void 0===b?Array:b}},function(a,b,c){var d=c(13);d(d.P+d.R,"Map",{toJSON:c(292)("Map")})},function(a,b,c){var d=c(118),e=c(293);a.exports=function(a){return function(){if(d(this)!=a)throw TypeError(a+"#toJSON isn't generic");return e(this)}}},function(a,b,c){var d=c(72);a.exports=function(a,b){var c=[];return d(a,!1,c.push,c,b),c}},function(a,b,c){c(295)("Map")},function(a,b,c){"use strict";var d=c(13);a.exports=function(a){d(d.S,a,{of:function(){for(var a=arguments.length,b=new Array(a);a--;)b[a]=arguments[a];return new this(b)}})}},function(a,b,c){c(297)("Map")},function(a,b,c){"use strict";var d=c(13),e=c(65),f=c(42),g=c(72);a.exports=function(a){d(d.S,a,{from:function(a){var b,c,d,h,i=arguments[1];return e(this),b=void 0!==i,b&&e(i),void 0==a?new this:(c=[],b?(d=0,h=f(i,arguments[2],2),g(a,!1,function(a){c.push(h(a,d++))})):g(a,!1,c.push,c),new this(c))}})}},function(a,b,c){"use strict";(function(b){function d(a,b){if(a===b)return 0;for(var c=a.length,d=b.length,e=0,f=Math.min(c,d);e<f;++e)if(a[e]!==b[e]){c=a[e],d=b[e];break}return c<d?-1:d<c?1:0}function e(a){return b.Buffer&&"function"==typeof b.Buffer.isBuffer?b.Buffer.isBuffer(a):!(null==a||!a._isBuffer)}function f(a){return Object.prototype.toString.call(a)}function g(a){return!e(a)&&("function"==typeof b.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(a):!!a&&(a instanceof DataView||!!(a.buffer&&a.buffer instanceof ArrayBuffer))))}function h(a){if(u.isFunction(a)){if(x)return a.name;var b=a.toString(),c=b.match(z);return c&&c[1]}}function i(a,b){
return"string"==typeof a?a.length<b?a:a.slice(0,b):a}function j(a){if(x||!u.isFunction(a))return u.inspect(a);var b=h(a);return"[Function"+(b?": "+b:"")+"]"}function k(a){return i(j(a.actual),128)+" "+a.operator+" "+i(j(a.expected),128)}function l(a,b,c,d,e){throw new y.AssertionError({message:c,actual:a,expected:b,operator:d,stackStartFunction:e})}function m(a,b){a||l(a,!0,b,"==",y.ok)}function n(a,b,c,h){if(a===b)return!0;if(e(a)&&e(b))return 0===d(a,b);if(u.isDate(a)&&u.isDate(b))return a.getTime()===b.getTime();if(u.isRegExp(a)&&u.isRegExp(b))return a.source===b.source&&a.global===b.global&&a.multiline===b.multiline&&a.lastIndex===b.lastIndex&&a.ignoreCase===b.ignoreCase;if(null!==a&&"object"==typeof a||null!==b&&"object"==typeof b){if(g(a)&&g(b)&&f(a)===f(b)&&!(a instanceof Float32Array||a instanceof Float64Array))return 0===d(new Uint8Array(a.buffer),new Uint8Array(b.buffer));if(e(a)!==e(b))return!1;h=h||{actual:[],expected:[]};var i=h.actual.indexOf(a);return-1!==i&&i===h.expected.indexOf(b)||(h.actual.push(a),h.expected.push(b),p(a,b,c,h))}return c?a===b:a==b}function o(a){return"[object Arguments]"==Object.prototype.toString.call(a)}function p(a,b,c,d){if(null===a||void 0===a||null===b||void 0===b)return!1;if(u.isPrimitive(a)||u.isPrimitive(b))return a===b;if(c&&Object.getPrototypeOf(a)!==Object.getPrototypeOf(b))return!1;var e=o(a),f=o(b);if(e&&!f||!e&&f)return!1;if(e)return a=w.call(a),b=w.call(b),n(a,b,c);var g,h,i=A(a),j=A(b);if(i.length!==j.length)return!1;for(i.sort(),j.sort(),h=i.length-1;h>=0;h--)if(i[h]!==j[h])return!1;for(h=i.length-1;h>=0;h--)if(g=i[h],!n(a[g],b[g],c,d))return!1;return!0}function q(a,b,c){n(a,b,!0)&&l(a,b,c,"notDeepStrictEqual",q)}function r(a,b){if(!a||!b)return!1;if("[object RegExp]"==Object.prototype.toString.call(b))return b.test(a);try{if(a instanceof b)return!0}catch(c){}return!Error.isPrototypeOf(b)&&!0===b.call({},a)}function s(a){var b;try{a()}catch(c){b=c}return b}function t(a,b,c,d){var e;if("function"!=typeof b)throw new TypeError('"block" argument must be a function');"string"==typeof c&&(d=c,c=null),e=s(b),d=(c&&c.name?" ("+c.name+").":".")+(d?" "+d:"."),a&&!e&&l(e,c,"Missing expected exception"+d);var f="string"==typeof d,g=!a&&u.isError(e),h=!a&&e&&!c;if((g&&f&&r(e,c)||h)&&l(e,c,"Got unwanted exception"+d),a&&e&&c&&!r(e,c)||!a&&e)throw e}var u=c(299),v=Object.prototype.hasOwnProperty,w=Array.prototype.slice,x=function(){return"foo"===function(){}.name}(),y=a.exports=m,z=/\s*function\s+([^\(\s]*)\s*/;y.AssertionError=function(a){this.name="AssertionError",this.actual=a.actual,this.expected=a.expected,this.operator=a.operator,a.message?(this.message=a.message,this.generatedMessage=!1):(this.message=k(this),this.generatedMessage=!0);var b=a.stackStartFunction||l;if(Error.captureStackTrace)Error.captureStackTrace(this,b);else{var c=new Error;if(c.stack){var d=c.stack,e=h(b),f=d.indexOf("\n"+e);if(f>=0){var g=d.indexOf("\n",f+1);d=d.substring(g+1)}this.stack=d}}},u.inherits(y.AssertionError,Error),y.fail=l,y.ok=m,y.equal=function(a,b,c){a!=b&&l(a,b,c,"==",y.equal)},y.notEqual=function(a,b,c){a==b&&l(a,b,c,"!=",y.notEqual)},y.deepEqual=function(a,b,c){n(a,b,!1)||l(a,b,c,"deepEqual",y.deepEqual)},y.deepStrictEqual=function(a,b,c){n(a,b,!0)||l(a,b,c,"deepStrictEqual",y.deepStrictEqual)},y.notDeepEqual=function(a,b,c){n(a,b,!1)&&l(a,b,c,"notDeepEqual",y.notDeepEqual)},y.notDeepStrictEqual=q,y.strictEqual=function(a,b,c){a!==b&&l(a,b,c,"===",y.strictEqual)},y.notStrictEqual=function(a,b,c){a===b&&l(a,b,c,"!==",y.notStrictEqual)},y.throws=function(a,b,c){t(!0,a,b,c)},y.doesNotThrow=function(a,b,c){t(!1,a,b,c)},y.ifError=function(a){if(a)throw a};var A=Object.keys||function(a){var b=[];for(var c in a)v.call(a,c)&&b.push(c);return b}}).call(b,c(91))},function(a,b,c){(function(a,d){function e(a,c){var d={seen:[],stylize:g};return arguments.length>=3&&(d.depth=arguments[2]),arguments.length>=4&&(d.colors=arguments[3]),p(c)?d.showHidden=c:c&&b._extend(d,c),v(d.showHidden)&&(d.showHidden=!1),v(d.depth)&&(d.depth=2),v(d.colors)&&(d.colors=!1),v(d.customInspect)&&(d.customInspect=!0),d.colors&&(d.stylize=f),i(d,a,d.depth)}function f(a,b){var c=e.styles[b];return c?"["+e.colors[c][0]+"m"+a+"["+e.colors[c][1]+"m":a}function g(a,b){return a}function h(a){var b={};return a.forEach(function(a,c){b[a]=!0}),b}function i(a,c,d){if(a.customInspect&&c&&A(c.inspect)&&c.inspect!==b.inspect&&(!c.constructor||c.constructor.prototype!==c)){var e=c.inspect(d,a);return t(e)||(e=i(a,e,d)),e}var f=j(a,c);if(f)return f;var g=Object.keys(c),p=h(g);if(a.showHidden&&(g=Object.getOwnPropertyNames(c)),z(c)&&(g.indexOf("message")>=0||g.indexOf("description")>=0))return k(c);if(0===g.length){if(A(c)){var q=c.name?": "+c.name:"";return a.stylize("[Function"+q+"]","special")}if(w(c))return a.stylize(RegExp.prototype.toString.call(c),"regexp");if(y(c))return a.stylize(Date.prototype.toString.call(c),"date");if(z(c))return k(c)}var r="",s=!1,u=["{","}"];if(o(c)&&(s=!0,u=["[","]"]),A(c)){r=" [Function"+(c.name?": "+c.name:"")+"]"}if(w(c)&&(r=" "+RegExp.prototype.toString.call(c)),y(c)&&(r=" "+Date.prototype.toUTCString.call(c)),z(c)&&(r=" "+k(c)),0===g.length&&(!s||0==c.length))return u[0]+r+u[1];if(d<0)return w(c)?a.stylize(RegExp.prototype.toString.call(c),"regexp"):a.stylize("[Object]","special");a.seen.push(c);var v;return v=s?l(a,c,d,p,g):g.map(function(b){return m(a,c,d,p,b,s)}),a.seen.pop(),n(v,r,u)}function j(a,b){if(v(b))return a.stylize("undefined","undefined");if(t(b)){var c="'"+JSON.stringify(b).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return a.stylize(c,"string")}return s(b)?a.stylize(""+b,"number"):p(b)?a.stylize(""+b,"boolean"):q(b)?a.stylize("null","null"):void 0}function k(a){return"["+Error.prototype.toString.call(a)+"]"}function l(a,b,c,d,e){for(var f=[],g=0,h=b.length;g<h;++g)F(b,String(g))?f.push(m(a,b,c,d,String(g),!0)):f.push("");return e.forEach(function(e){e.match(/^\d+$/)||f.push(m(a,b,c,d,e,!0))}),f}function m(a,b,c,d,e,f){var g,h,j;if(j=Object.getOwnPropertyDescriptor(b,e)||{value:b[e]},j.get?h=j.set?a.stylize("[Getter/Setter]","special"):a.stylize("[Getter]","special"):j.set&&(h=a.stylize("[Setter]","special")),F(d,e)||(g="["+e+"]"),h||(a.seen.indexOf(j.value)<0?(h=q(c)?i(a,j.value,null):i(a,j.value,c-1),h.indexOf("\n")>-1&&(h=f?h.split("\n").map(function(a){return"  "+a}).join("\n").substr(2):"\n"+h.split("\n").map(function(a){return"   "+a}).join("\n"))):h=a.stylize("[Circular]","special")),v(g)){if(f&&e.match(/^\d+$/))return h;g=JSON.stringify(""+e),g.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(g=g.substr(1,g.length-2),g=a.stylize(g,"name")):(g=g.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),g=a.stylize(g,"string"))}return g+": "+h}function n(a,b,c){var d=0;return a.reduce(function(a,b){return d++,b.indexOf("\n")>=0&&d++,a+b.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?c[0]+(""===b?"":b+"\n ")+" "+a.join(",\n  ")+" "+c[1]:c[0]+b+" "+a.join(", ")+" "+c[1]}function o(a){return Array.isArray(a)}function p(a){return"boolean"==typeof a}function q(a){return null===a}function r(a){return null==a}function s(a){return"number"==typeof a}function t(a){return"string"==typeof a}function u(a){return"symbol"==typeof a}function v(a){return void 0===a}function w(a){return x(a)&&"[object RegExp]"===C(a)}function x(a){return"object"==typeof a&&null!==a}function y(a){return x(a)&&"[object Date]"===C(a)}function z(a){return x(a)&&("[object Error]"===C(a)||a instanceof Error)}function A(a){return"function"==typeof a}function B(a){return null===a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||"symbol"==typeof a||void 0===a}function C(a){return Object.prototype.toString.call(a)}function D(a){return a<10?"0"+a.toString(10):a.toString(10)}function E(){var a=new Date,b=[D(a.getHours()),D(a.getMinutes()),D(a.getSeconds())].join(":");return[a.getDate(),J[a.getMonth()],b].join(" ")}function F(a,b){return Object.prototype.hasOwnProperty.call(a,b)}var G=/%[sdj%]/g;b.format=function(a){if(!t(a)){for(var b=[],c=0;c<arguments.length;c++)b.push(e(arguments[c]));return b.join(" ")}for(var c=1,d=arguments,f=d.length,g=String(a).replace(G,function(a){if("%%"===a)return"%";if(c>=f)return a;switch(a){case"%s":return String(d[c++]);case"%d":return Number(d[c++]);case"%j":try{return JSON.stringify(d[c++])}catch(b){return"[Circular]"}default:return a}}),h=d[c];c<f;h=d[++c])q(h)||!x(h)?g+=" "+h:g+=" "+e(h);return g},b.deprecate=function(c,e){function f(){if(!g){if(d.throwDeprecation)throw new Error(e);d.traceDeprecation?void 0:void 0,g=!0}return c.apply(this,arguments)}if(v(a.process))return function(){return b.deprecate(c,e).apply(this,arguments)};if(!0===d.noDeprecation)return c;var g=!1;return f};var H,I={};b.debuglog=function(a){if(v(H)&&(H=d.env.NODE_DEBUG||""),a=a.toUpperCase(),!I[a])if(new RegExp("\\b"+a+"\\b","i").test(H)){var c=d.pid;I[a]=function(){var a=b.format.apply(b,arguments);void 0}}else I[a]=function(){};return I[a]},b.inspect=e,e.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},e.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},b.isArray=o,b.isBoolean=p,b.isNull=q,b.isNullOrUndefined=r,b.isNumber=s,b.isString=t,b.isSymbol=u,b.isUndefined=v,b.isRegExp=w,b.isObject=x,b.isDate=y,b.isError=z,b.isFunction=A,b.isPrimitive=B,b.isBuffer=c(300);var J=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];b.log=function(){void 0},b.inherits=c(301),b._extend=function(a,b){if(!b||!x(b))return a;for(var c=Object.keys(b),d=c.length;d--;)a[c[d]]=b[c[d]];return a}}).call(b,c(91),c(176))},function(a,b){a.exports=function(a){return a&&"object"==typeof a&&"function"==typeof a.copy&&"function"==typeof a.fill&&"function"==typeof a.readUInt8}},function(a,b){"function"==typeof Object.create?a.exports=function(a,b){a.super_=b,a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}})}:a.exports=function(a,b){a.super_=b;var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a}},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(126),f=d(e),g=c(0),h=d(g),i=c(1),j=d(i),k=c(2),l=d(k),m=c(3),n=d(m),o=c(177),p=c(24),q=c(40),r=d(q),s=function(a){function b(c,d,e){var g=arguments.length>3&&void 0!==arguments[3]?arguments[3]:c.ARRAY_BUFFER;(0,h.default)(this,b);var i=(0,l.default)(this,a.call(this,c));return i._numVertices=d,i._dataType=e,i._bytePerData=(0,p.sizeof)(c,e),i._map=new f.default,i._data=[],i._bufferType=g,i}return(0,n.default)(b,a),b.quadGeometry=function(a,c,d){var e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,f=arguments.length>4&&void 0!==arguments[4]?arguments[4]:16777215,g=new b(a,4,a.FLOAT);if(g.pushVertexData("position",[0,0,c,0,c,d,0,d],0),e)g.pushVertexData("texCoord",e,2);else{var h=f>>16&255,i=f>>8&255,j=255&f,k=[h,i,j].map(function(a){return a/255}),l=[].concat(k,k,k,k);g.pushVertexData("color",l,2)}return g.done(),g.createIndexBuffer([0,1,2,0,2,3]),g},b.prototype.dispose=function(){this.dataMap.clear(),this.vertexBuffer&&this.gl.deleteBuffer(this.vertexBuffer),this.indexBuffer&&this.gl.deleteBuffer(this.indexBuffer)},b.prototype.pushVertexData=function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,d=b.length/this.numVertices;this._map.set(a,{size:d,offset:c});for(var e=this.numDataPerVertex,f=this.numVertices,g=0;g<f;++g){var h;(h=this._data).splice.apply(h,[g*e+c,0].concat(b.slice(g*d,(g+1)*d)))}return this},b.prototype.done=function(){var a=this._getTypedArray(this.dataType);return this._vertexBuffer=(0,p.createBuffer)(this.gl,new a(this._data)),this},b.prototype.createVertexBuffer=function(a,b){return this._map=b,this._data=a,this.done()},b.prototype.bindVertexBuffer=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(this.vertexBuffer){var b=this.gl;b.bindBuffer(b.ARRAY_BUFFER,this.vertexBuffer),"function"==typeof a&&a(b)}},b.prototype.updateVertexBuffer=function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,d=this.gl;this.bindVertexBuffer(),d.bufferSubData(d.ARRAY_BUFFER,c*a,b)},b.prototype.createIndexBuffer=function(a){this._indexBuffer=(0,p.createIndexBuffer)(this.gl,new Uint16Array(a))},b.prototype._getTypedArray=function(a){switch(a){case this.gl.UNSIGNED_BYTE:return Uint8Array;case this.gl.BYTE:return Int8Array;case this.gl.UNSIGNED_SHORT:return Uint16Array;case this.gl.SHORT:return Int16Array;case this.gl.FLOAT:return Float32Array}throw new Error("type을 알 수 없습니다.")},(0,j.default)(b,[{key:"dataMap",get:function(){return this._map}},{key:"vertexBuffer",get:function(){return this._vertexBuffer}},{key:"vertexBufferSize",get:function(){if(!this.vertexBuffer)return 0;var a=this.gl;return a.bindBuffer(this.bufferType,this.vertexBuffer),a.getBufferParameter(this.bufferType,a.BUFFER_SIZE)/(0,p.sizeof)(a,this.dataType)}},{key:"indexBuffer",get:function(){return this._indexBuffer}},{key:"indexBufferSize",get:function(){if(!this.indexBuffer)return 0;var a=this.gl;return a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.indexBuffer),a.getBufferParameter(a.ELEMENT_ARRAY_BUFFER,a.BUFFER_SIZE)/(0,p.sizeof)(a,a.UNSIGNED_SHORT)}},{key:"numDataPerVertex",get:function(){return(0,o.reducei)(this._map,function(a,b){return a+b[1].size},0)}},{key:"numVertices",get:function(){return this._numVertices}},{key:"dataType",get:function(){return this._dataType}},{key:"bytesPerData",get:function(){return this._bytePerData}},{key:"bufferType",get:function(){return this._bufferType}}]),b}(r.default);b.default=s},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(21),f=d(e),g=c(0),h=d(g),i=c(1),j=d(i),k=c(40),l=(d(k),c(178)),m=d(l),n=c(304),o=d(n),p=(c(93),c(44)),q=d(p),r=function(){function a(b){(0,h.default)(this,a),this._gl=b,this._sharpen=0,this._initFilters(this.gl)}return a.prototype._initFilters=function(){this._sharpenFilter=new m.default,this._blurFilter=new o.default},a.prototype.initWithSize=function(a,b){this.sharpenFilter.initWithSize(a,b),this.blurFilter.initWithSize(a,b)},a.prototype.applyFilter=function(a,b){if(!this.changed)return a;var c=this.sharpen,d=c>0,e=d?this.sharpenFilter:this.blurFilter;return e.value=40*Math.abs(c)*(d?1/6:.7),e.applyFilter(a,b)},a.prototype.applyFilterAsync=function(a,b){var c=this;return new f.default(function(d){d(c.applyFilter(a,b))})},(0,j.default)(a,[{key:"sharpen",get:function(){return this._sharpen},set:function(a){this._sharpen=a}},{key:"sharpenFilter",get:function(){return this._sharpenFilter}},{key:"blurFilter",get:function(){return this._blurFilter}},{key:"changed",get:function(){return 0!=this.sharpen}},{key:"name",get:function(){return"SharpenAdjustment"}},{key:"gl",get:function(){return this._gl||q.default.shared}}]),a}();b.default=r},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(1),h=d(g),i=c(2),j=d(i),k=c(3),l=d(k),m=c(178),n=d(m),o=c(24),p=c(46),q=d(p),r=function(a){function b(c){(0,f.default)(this,b);var d=(0,j.default)(this,a.call(this,c));return d._blur=0,d._calRadius=0,d._tempTexture=q.default.createTextureForSingleImage(d.gl),d}return(0,l.default)(b,a),b.prototype._initProgram=function(){this._program=(0,o.createProgram)(this.gl,"\n	attribute vec4 a_position;\n	attribute vec4 aTextureCoord;\n\n	varying vec2 textureCoordinate;\n	void main()\n	{\n	    gl_Position = a_position;\n	    textureCoordinate = aTextureCoord.xy;\n	}\n","\n	precision highp float;\n\n	uniform sampler2D texture;\n	uniform highp float texelWidthOffset;\n	uniform highp float texelHeightOffset;\n	uniform int radius;\n	uniform float weight;\n	uniform int sigma;\n\n	const float pi = 3.14159265359;\n	varying vec2 textureCoordinate;\n\n	vec4 getColor(vec4 texel){\n	    float sumWeight = weight;\n	    int trueOffsets = radius / 2 + (radius - radius / 2 * 2);\n	    int numOffsets = trueOffsets > 7 ? 7 : trueOffsets;\n	    int radiusPlus = radius + 1; \n	    float sigmaPow = pow(float(sigma), 2.0);\n	    float firstCal = 1.0 / sqrt(2.0 * pi * sigmaPow);\n	    float secCal = 2.0 * sigmaPow;\n	    float tm = 0.0;\n	    float tma, tmb, c, d, av, bv, optW, optOffset;\n\n	    vec2 singleStepOffset = vec2(texelWidthOffset, texelHeightOffset);\n	    \n	    lowp vec4 sum = vec4(0.0);\n	    \n	    sum += texel * ((firstCal * exp(-pow(0.0, 2.0) / secCal)) / sumWeight);\n	    \n	    for (int i = 0; i < 90; i++){\n	        if (i >= trueOffsets){\n	            break;\n	        }\n	        \n	        int a = int(i * 2 + 1);\n	        int b = int(i * 2 + 2);\n	        \n	        tma = float(a);\n	        tmb = float(b);\n	        \n	        c = pow(tma, 2.0);\n	        d = pow(tmb, 2.0);\n	        \n	        av = (firstCal * exp(-c / secCal)) / sumWeight;\n	        bv = (firstCal * exp(-d / secCal)) / sumWeight;\n	        \n	        optW = av + bv;\n\n	        optOffset = (av * tma + bv * tmb) / optW;\n	        \n	        sum += texture2D(texture, textureCoordinate.xy + singleStepOffset * optOffset) * optW;\n	        sum += texture2D(texture, textureCoordinate.xy - singleStepOffset * optOffset) * optW;        \n	    }\n	    \n	    return sum;\n	}\n\n	void main()\n	{\n		vec4 texel = texture2D(texture, textureCoordinate.xy);\n\n		// gl_FragColor = getColor(texel);\n\n		if(texel.a == 0.0) {\n			gl_FragColor = texel;\n		}\n		else {\n			gl_FragColor = getColor(texel);\n		}\n	}\n\n")},b.prototype.applyFilter=function(a,b){var c=this;if(!this.changed)return a;var d=this.gl,e=this.program,f=this._tempTexture.texture,g=this.getSumWeight(this.blur,this._calRadius),h={radius:this._calRadius,weight:g,sigma:this._blur};return this._tempTexture.initWithPixels(d.canvas.width,d.canvas.height),this.frameBuffer.activeFrameBuffer(function(g){d.useProgram(e),c.setAttributes(e,d),c.drawMotionBlur(a,b,0,0,1/d.canvas.height,h),c.drawMotionBlur(b,f,1,1/d.canvas.width,0,h),c.drawMotionBlur(f,b,0,0,1/d.canvas.height,h)}),b},b.prototype.drawMotionBlur=function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,d=arguments[3],e=arguments[4],f=arguments[5],g=f.radius,h=f.weight,i=f.sigma,j=arguments.length>6&&void 0!==arguments[6]?arguments[6]:this.program;arguments.length>7&&void 0!==arguments[7]?arguments[7]:this.gl;this.bindTextureAt(a,c),this.frameBuffer.bindColorAttachment(b),this.setUniformsf(j,{texelWidthOffset:[d],texelHeightOffset:[e],weight:[h]}),this.setUniformsi(j,{texture:[c],radius:[g],sigma:[i]}),this.draw(),this.bindTextureAt(null,c)},b.prototype.getSumWeight=function(a,b){var c=[],d=0,e=void 0;for(e=0;e<b+1;e++)c[e]=1/Math.sqrt(2*Math.PI*Math.pow(a,2))*Math.exp(-Math.pow(e,2)/(2*Math.pow(a,2))),d+=0==e?c[e]:2*c[e];return d},b.prototype.setSigma=function(a){var b=Math.round(a);if(b!=this.blur&&(this._blur=b,a>=0)){var c=0;if(this.blur>=1){c=Math.floor(Math.sqrt(-2*Math.pow(this.blur,2)*Math.log(1/256*Math.sqrt(2*Math.PI*Math.pow(this.blur,2))))),c+=c%2}this._calRadius=c}},(0,h.default)(b,[{key:"blur",get:function(){return this._blur},set:function(a){this.setSigma(a)}},{key:"value",get:function(){return this.blur},set:function(a){this.blur=a}},{key:"changed",get:function(){return 0!=this.blur}},{key:"program",get:function(){return this._program}},{key:"name",get:function(){return"BlurFilter"}}]),b}(n.default);b.default=r},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(){}b.__esModule=!0;var f=c(21),g=d(f),h=c(0),i=d(h),j=c(1),k=d(j),l=c(2),m=d(l),n=c(3),o=d(n),p=c(40),q=d(p),r=(c(10),c(46)),s=(d(r),c(130)),t=c(306),u=(d(t),c(24),c(44)),v=d(u),w=function(a){function b(c){(0,i.default)(this,b);var d=(0,m.default)(this,a.call(this,c));return d._autoadjust=new s.AutoAdjustment,d}return(0,o.default)(b,a),b.prototype.initWithSize=function(a,b){return this},b.prototype.applyFilter=function(a,b,c){if(!1===this.changed)return a;var d=c.transformedImageData,e=this.getDestImageData(d.width,d.height);return this._autoadjust.applyFilter(d,e),this.drawToTexture(e,b)},b.prototype.applyFilterAsync=function(a,b,c,d){var f=this;return new g.default(function(c,g){if(!f.changed)return c(a);var h=d.width,i=d.height,j=f.getDestImageData(h,i);f._autoadjust.applyFilterAsync(d,j,0,0,h,i,e,function(){return c(f.drawToTexture(j,b))})})},b.prototype.drawToTexture=function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.gl;return c.bindTexture(c.TEXTURE_2D,b),c.texImage2D(c.TEXTURE_2D,0,c.RGBA,a.width,a.height,0,c.RGBA,c.UNSIGNED_BYTE,a.data),b},b.prototype.getDestImageData=function(a,b){return this.diffSize(a,b)&&(this.destImagedata=this.createDestImageData(a,b)),this.destImagedata},b.prototype.diffSize=function(a,b){return!this.destImagedata||!(this.destImagedata.width==a&&this.destImagedata.height==b)},b.prototype.createDestImageData=function(a,b){var c={width:a,height:b};return c.data=new Uint8Array(4*a*b),c},(0,k.default)(b,[{key:"changed",get:function(){return this.enabled}},{key:"name",get:function(){return"AutoAdjustment"}},{key:"enabled",get:function(){return this._autoadjust.enabled},set:function(a){this._autoadjust.enabled=a}},{key:"gl",get:function(){return this._gl||v.default.shared}}]),b}(q.default);b.default=w},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(1),h=d(g),i=c(2),j=d(i),k=c(3),l=d(k),m=c(179),n=d(m),o=(c(131),c(60)),p=d(o),q=c(46),r=d(q),s=function(a){function b(){(0,f.default)(this,b);var c=(0,j.default)(this,a.call(this));return c._tex2D=null,c}return(0,l.default)(b,a),b.prototype.applyTransform=function(b,c){var d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,e=a.prototype.applyTransform.call(this,b,c,d);return this.setTextureImage(this.imageData),e},b.prototype.setTextureImage=function(a){if(this.sourceTexture2D){var b=this.sourceTexture2D,c=new Uint8Array(a.data);b.initWithPixels(a.width,a.height,c)}},(0,h.default)(b,[{key:"sourceTexture2D",get:function(){return this._tex2D},set:function(a){(0,p.default)(a instanceof r.default,"sourceTexture2D는 GLUTexture2D 객체만 가능합니다."),this._tex2D=a}}]),b}(n.default);b.default=s},function(a,b,c){"use strict";(function(a){function b(a){return a&&a.__esModule?a:{"default":a}}var d=c(4),e=b(d),f=c(38),g=b(f);!function(){function b(){this._radius=1,this._scale=1}function d(a,b,c){var d=a.width,e=a.height,f=document.createElement("canvas"),g=f.getContext("2d");f.width=d,f.height=e,g.putImageData(a,0,0);var h=document.createElement("canvas"),i=h.getContext("2d");return h.width=b,h.height=c,i.drawImage(f,0,0,d,e,0,0,b,c),i.getImageData(0,0,b,c)}function f(a,b){b.data.set(a.data)}function h(a,b,c,d,e,f,g,h){function i(b,c,h){for(var j,l,m,o,r,t,D,F,G,H,I,J,K,L,M,N,O=a.data,P=1e3/q,Q=C/a.width<<0,R=0,S=new Date,T=0;b<e;b++,T++,R++){if(R==Q){if(P<new Date-S)return E+=T,g(E),void setTimeout(function(){i(b,c,h)},k.CONVOLUTION_DELAY);R=0}for(H=I=J=D=F=G=0,o=u*(K=O[c]),r=u*(L=O[c+1]),t=u*(M=O[c+2]),D+=v*K,F+=v*L,G+=v*M,x=w,l=0;l<u;l++)x.r=K,x.g=L,x.b=M,x=x.next;for(l=1;l<u;l++)m=c+((s<l?s:l)<<2),D+=(x.r=K=O[m])*(N=u-l),F+=(x.g=L=O[m+1])*N,G+=(x.b=M=O[m+2])*N,H+=K,I+=L,J+=M,x=x.next;for(y=w,z=p,j=0;j<d;j++)O[c]=D*A>>B,O[c+1]=F*A>>B,O[c+2]=G*A>>B,D-=o,F-=r,G-=t,o-=y.r,r-=y.g,t-=y.b,m=h+((m=j+f+1)<s?m:s)<<2,H+=y.r=O[m],I+=y.g=O[m+1],J+=y.b=O[m+2],D+=H,F+=I,G+=J,y=y.next,o+=K=z.r,r+=L=z.g,t+=M=z.b,H-=K,I-=L,J-=M,z=z.next,c+=4;h+=d}g(E+=T),setTimeout(function(){n(0)},k.CONVOLUTION_DELAY)}function n(b){for(var c,h,i,j,l,m,r,s,C,F,G,H,I,J,K,L,M,N,O=a.data,P=1e3/q,Q=D/a.height<<0,R=0,S=new Date,T=0;b<d;b++,T++,R++){if(R==Q){if(P<new Date-S)return E+=T,g(E),void setTimeout(function(){n(b)},k.CONVOLUTION_DELAY);R=0}for(I=J=H=F=G=C=0,j=b<<2,m=u*(K=O[j]),r=u*(L=O[j+1]),s=u*(M=O[j+2]),C+=v*K,F+=v*L,G+=v*M,x=w,c=0;c<u;c++)x.r=K,x.g=L,x.b=M,x=x.next;for(l=d,c=1;c<=f;c++)j=l+b<<2,C+=(x.r=K=O[j])*(N=u-c),F+=(x.g=L=O[j+1])*N,G+=(x.b=M=O[j+2])*N,H+=K,I+=L,J+=M,x=x.next,c<t&&(l+=d);for(j=b,y=w,z=p,i=0;i<e;i++)h=j<<2,O[h]=C*A>>B,O[h+1]=F*A>>B,O[h+2]=G*A>>B,C-=m,F-=r,G-=s,m-=y.r,r-=y.g,s-=y.b,h=b+((h=i+u)<t?h:t)*d<<2,C+=H+=y.r=O[h],F+=I+=y.g=O[h+1],G+=J+=y.b=O[h+2],y=y.next,m+=K=z.r,r+=L=z.g,s+=M=z.b,H-=K,I-=L,J-=M,z=z.next,j+=d}g(E+T),o()}function o(){var a;for(x=w;;){if(!(a=x.next))break;x.next=null,x=a}h&&h()}if(!(isNaN(f)||f<1)){f=f||0;var p,q=6e7/k.MAXIMUM_PROCESS,r=f+f+1,s=d-1,t=e-1,u=f+1,v=u*(u+1)/2,w=new j,x=w;!function(){for(var a=1;a<r;a++)x=x.next=new j,a==u&&(p=x)}(),x.next=w;var y=null,z=null,A=l[f],B=m[f],C=13e4,D=1e5,E=0;i(0,0,0)}}function i(a,b,c,d,e,f){if(!(isNaN(f)||f<1)){f|=0;var g,h,i,k,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D=a.data,E=f+f+1,F=d-1,G=e-1,H=f+1,I=H*(H+1)/2,J=new j,K=J;for(i=1;i<E;i++)if(K=K.next=new j,i==H)var L=K;K.next=J;var M=null,N=null;p=o=0;var O=l[f],P=m[f];for(h=0;h<e;h++){for(w=x=y=q=r=s=0,t=H*(z=D[o]),u=H*(A=D[o+1]),v=H*(B=D[o+2]),q+=I*z,r+=I*A,s+=I*B,K=J,i=0;i<H;i++)K.r=z,K.g=A,K.b=B,K=K.next;for(i=1;i<H;i++)k=o+((F<i?F:i)<<2),q+=(K.r=z=D[k])*(C=H-i),r+=(K.g=A=D[k+1])*C,s+=(K.b=B=D[k+2])*C,w+=z,x+=A,y+=B,K=K.next;for(M=J,N=L,g=0;g<d;g++)D[o]=q*O>>P,D[o+1]=r*O>>P,D[o+2]=s*O>>P,q-=t,r-=u,s-=v,t-=M.r,u-=M.g,v-=M.b,k=p+((k=g+f+1)<F?k:F)<<2,w+=M.r=D[k],x+=M.g=D[k+1],y+=M.b=D[k+2],q+=w,r+=x,s+=y,M=M.next,t+=z=N.r,u+=A=N.g,v+=B=N.b,w-=z,x-=A,y-=B,N=N.next,o+=4;p+=d}for(g=0;g<d;g++){for(x=y=w=r=s=q=0,o=g<<2,t=H*(z=D[o]),u=H*(A=D[o+1]),v=H*(B=D[o+2]),q+=I*z,r+=I*A,s+=I*B,K=J,i=0;i<H;i++)K.r=z,K.g=A,K.b=B,K=K.next;for(n=d,i=1;i<=f;i++)o=n+g<<2,q+=(K.r=z=D[o])*(C=H-i),r+=(K.g=A=D[o+1])*C,s+=(K.b=B=D[o+2])*C,w+=z,x+=A,y+=B,K=K.next,i<G&&(n+=d);for(o=g,M=J,N=L,h=0;h<e;h++)k=o<<2,D[k]=q*O>>P,D[k+1]=r*O>>P,D[k+2]=s*O>>P,q-=t,r-=u,s-=v,t-=M.r,u-=M.g,v-=M.b,k=g+((k=h+H)<G?k:G)*d<<2,q+=w+=M.r=D[k],r+=x+=M.g=D[k+1],s+=y+=M.b=D[k+2],M=M.next,t+=z=N.r,u+=A=N.g,v+=B=N.b,w-=z,x-=A,y-=B,N=N.next,o+=d}var Q;for(K=J;;){if(!(Q=K.next))break;K.next=null,K=Q}}}function j(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}var k=c(39);b.prototype={constructor:b,applyFilterAsync:function(a,b,c,e,g,i,j,k){function l(a){j(a,m)}var m,n=this._getScaledRadius();if(1!=this.scale){var o,p=function(){o=d(o,a.width,a.height),setTimeout(function(){f(o,b),l(m),k()},1)},q=Math.ceil(a.width*this.scale),r=Math.ceil(a.height*this.scale);m=q+r+1,setTimeout(function(){l(0),o=d(a,q,r),h(o,0,0,o.width,o.height,n,l,p)},1)}else{var s=function(){l(m),setTimeout(k,1)};m=a.width+a.height+1,setTimeout(function(){l(0),a!=b&&f(a,b),setTimeout(function(){h(b,0,0,b.width,b.height,n,l,s)},1)},1)}},applyFilter:function(a,b,c,e,g,h){var j=this._getScaledRadius(),k=i;if(1!=this.scale){var l=Math.ceil(a.width*this.scale),m=Math.ceil(a.height*this.scale),n=d(a,l,m);k(n,0,0,n.width,n.height,j),n=d(n,a.width,a.height),f(n,b)}else a!=b&&f(a,b),k(b,0,0,b.width,b.height,j)},_getScaledRadius:function(){return this.radius*this.scale<<0}},(0,g.default)(b.prototype,{radius:{get:function(){return this._radius},set:function(a){this._radius=parseInt(a),this._radius<1&&(this._radius=1)}},scale:{get:function(){return this._scale},set:function(a){this._scale=parseFloat(a),this._scale=Math.max(.1,this._scale),this._scale=Math.min(1,this._scale)}}});var l=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],m=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];if(void 0!==(0,e.default)(a)&&void 0!==(0,e.default)(a.exports))a.exports=b;else{usenamespace("editor.filter").StackBlur=b}}()}).call(b,c(6)(a))},function(a,b,c){"use strict";(function(a){var b=c(4),d=function(a){return a&&a.__esModule?a:{"default":a}}(b);!function(){function b(a){this.radius=a||10}if(b.prototype={constructor:b,applyFilter:function(a,b,c,d,e,f){function g(a){a=null;return a?a.subarray(0,a.length):new Uint8Array(k)}for(var h=b.data,i=a.data,j=i.length,k=j/4,l=g(),m=g(),n=g(),o=g(),p=0,q=0;q<j;)l[p]=i[q++],m[p]=i[q++],n[p]=i[q++],o[p]=i[q++],p++;var r=g(l),s=g(m),t=g(n),u=g(o),v=a.width,w=a.height,x=this._boxesForGauss(this.radius,3);this._exp_gaussBlur_4(l,r,x,v,w,this.radius),this._exp_gaussBlur_4(m,s,x,v,w,this.radius),this._exp_gaussBlur_4(n,t,x,v,w,this.radius),this._exp_gaussBlur_4(o,u,x,v,w,this.radius);var y;for(j=l.length,q=0;q<j;q++)y=4*q<<0,h[y]=r[q],h[y+1]=s[q],h[y+2]=t[q],h[y+3]=u[q]},_exp_gaussBlur_4:function(a,b,c,d,e,f){this._exp_boxBlur_4(a,b,d,e,(c[0]-1)/2),this._exp_boxBlur_4(b,a,d,e,(c[1]-1)/2),this._exp_boxBlur_4(a,b,d,e,(c[2]-1)/2)},_exp_boxBlur_4:function(a,b,c,d,e){for(var f=a.length,g=0;g<f;g++)b[g]=a[g];this._exp_boxBlurH_4(b,a,c,d,e),this._exp_boxBlurT_4(a,b,c,d,e)},_exp_boxBlurH_4:function(a,b,c,d,e){for(var f,g,h,i,j,k,l,m=1/(e+e+1),n=0;n<d;n++){for(g=n*c<<0,h=g<<0,i=g+e<<0,j=a[g],k=a[g+c-1],l=(e+1)*j,f=0;f<e;f++)l+=a[g+f];for(f=0;f<=e;f++)l+=a[i++]-j,b[g++]=l*m+.5<<0;for(f=e+1;f<c-e;f++)l+=a[i++]-a[h++],b[g++]=l*m+.5<<0;for(f=c-e;f<c;f++)l+=k-a[h++],b[g++]=l*m+.5<<0}},_exp_boxBlurT_4:function(a,b,c,d,e){for(var f,g,h,i,j,k,l,m=1/(e+e+1),n=0;n<c;n++){for(g=n<<0,h=g<<0,i=g+e*c<<0,j=a[g],k=a[g+c*(d-1)],l=(e+1)*j,f=0;f<e;f++)l+=a[g+f*c];for(f=0;f<=e;f++)l+=a[i]-j,b[g]=l*m+.5<<0,i+=c<<0,g+=c<<0;for(f=e+1;f<d-e;f++)l+=a[i]-a[h],b[g]=l*m+.5<<0,h+=c<<0,i+=c<<0,g+=c<<0;for(f=d-e;f<d;f++)l+=k-a[h],b[g]=l*m+.5<<0,h+=c<<0,g+=c<<0}},_boxesForGauss:function(a,b){var c=Math.sqrt(12*a*a/b+1),d=Math.floor(c);d%2==0&&d--;for(var e=d+2,f=(12*a*a-b*d*d-4*b*d-3*b)/(-4*d-4),g=Math.round(f),h=[],i=0;i<b;i++)h.push(i<g?d:e);return h}},void 0!==(0,d.default)(a)&&void 0!==(0,d.default)(a.exports))a.exports=b;else{usenamespace("editor.filter").GaussBlurFilter=b}}()}).call(b,c(6)(a))},function(a,b,c){"use strict";(function(a){var b=c(4),d=function(a){return a&&a.__esModule?a:{"default":a}}(b);!function(){function b(){this._matrix=[0,0,0,0,1,0,0,0,0]}var e=c(39);if(b.prototype={constructor:b,setFactor:function(a){var b=Math.round(255*a),c=(b+10)/10,d=-(c-1)/8;return this._matrix=[d,d,d,d,c,d,d,d,d],this},applyFilter:function(a,b,c,d,e,f){this._applyNotCalcAlpha.apply(this,arguments)},applyFilterAsync:function(a,b,c,d,f,g,h,i){function j(){for(var c,d,f=1e3/v,g=0,i=p,l=q,m=n,o=a.data,w=b.data,x=0,y=0,z=0,A=0,B=new Date;l<i;l+=4,A++,g++){if(3e5==g){if(new Date-B>f)return r+=4*A,h(r,s),q=l,void setTimeout(j,e.CONVOLUTION_DELAY);g=0;
}x=y=z=0,d=l-m<<0,c=d-4<<0,x+=o[c]*t,y+=o[c+1]*t,z+=o[c+2]*t,x+=o[d]*t,y+=o[d+1]*t,z+=o[d+2]*t,c=d+4<<0,x+=o[c]*t,y+=o[c+1]*t,z+=o[c+2]*t,c=l-4<<0,x+=o[c]*t,y+=o[c+1]*t,z+=o[c+2]*t,x+=o[l]*u,y+=o[l+1]*u,z+=o[l+2]*u,c=l+4<<0,x+=o[c]*t,y+=o[c+1]*t,z+=o[c+2]*t,d=l+m<<0,c=d-4<<0,x+=o[c]*t,y+=o[c+1]*t,z+=o[c+2]*t,x+=o[d]*t,y+=o[d+1]*t,z+=o[d+2]*t,c=d+4<<0,x+=o[c]*t,y+=o[c+1]*t,z+=o[c+2]*t,w[l]=x,w[l+1]=y,w[l+2]=z,w[l+3]=o[l+3]}k()}function k(){var c=a.data,d=n,e=b.data;e.set(c.subarray(0,d),0),e.set(c.subarray(o-d,o),o-d);var f,g,j=a.height-1,k=d-4;for(f=1;f<j;f++)g=f*d,e[g]=c[g],e[g+1]=c[g+1],e[g+2]=c[g+2],g+=k,e[g]=c[g],e[g+1]=c[g+1],e[g+2]=c[g+2];h(s,s),i()}var l=this._matrix,m=Math.round(Math.sqrt(l.length));if(Math.pow(m,2)!=l.length)throw new Error("필터의 matrix 는 정사각형 매트릭스여야 함.");var n=4*a.width,o=a.data.length,p=o-n-4,q=n+4<<0,r=0,s=p+1,t=l[0],u=l[4],v=6e7/e.MAXIMUM_PROCESS;h(0,s),j()},_applyNotCalcAlpha:function(a,b){var c=this._matrix,d=Math.round(Math.sqrt(c.length));if(Math.pow(d,2)!=c.length)throw new Error("필터의 matrix 는 정사각형 매트릭스여야 함.");for(var e,f,g=a.data,h=a.width,i=b.data,j=0,k=0,l=0,m=c[0],n=c[4],o=g.length,p=4*h,q=o-p-4,r=p+4<<0;r<q;r+=4)j=k=l=0,f=r-p<<0,e=f-4<<0,j+=g[e]*m,k+=g[e+1]*m,l+=g[e+2]*m,j+=g[f]*m,k+=g[f+1]*m,l+=g[f+2]*m,e=f+4<<0,j+=g[e]*m,k+=g[e+1]*m,l+=g[e+2]*m,e=r-4<<0,j+=g[e]*m,k+=g[e+1]*m,l+=g[e+2]*m,j+=g[r]*n,k+=g[r+1]*n,l+=g[r+2]*n,e=r+4<<0,j+=g[e]*m,k+=g[e+1]*m,l+=g[e+2]*m,f=r+p<<0,e=f-4<<0,j+=g[e]*m,k+=g[e+1]*m,l+=g[e+2]*m,j+=g[f]*m,k+=g[f+1]*m,l+=g[f+2]*m,e=f+4<<0,j+=g[e]*m,k+=g[e+1]*m,l+=g[e+2]*m,i[r]=j,i[r+1]=k,i[r+2]=l,i[r+3]=g[r+3];i.set(g.subarray(0,p),0),i.set(g.subarray(o-p,o),o-p);var s,t,u=a.height-1,v=p-4;for(s=1;s<u;s++)t=s*p,i[t]=g[t],i[t+1]=g[t+1],i[t+2]=g[t+2],t+=v,i[t]=g[t],i[t+1]=g[t+1],i[t+2]=g[t+2]},_applyOrg:function(a,b){var c=this._matrix,d=Math.round(Math.sqrt(c.length));if(Math.pow(d,2)!=c.length)throw new Error("필터의 matrix 는 정사각형 매트릭스여야 함.");var e,f,g,h,i,j,k,l,m,n,o,p=Math.floor(d/2),q=a.data,r=a.width,s=a.height,t=r-1,u=s-1,v=b.data,w=0,x=0,y=0,z=0,A=r*s,B=0,C=0;e=C-p;for(var D=0;D<A;D++){for(m=4*(C*r+B),w=0,x=0,y=0,z=0,f=B-p,h=0;h<d;h++)for(i=e+h,i<0?i=0:i>u&&(i=u),n=i*r,o=h*d,g=0;g<d;g++)j=f+g,j<0?j=0:j>t&&(j=t),k=4*(n+j),l=c[o+g],w+=q[k]*l,x+=q[k+1]*l,y+=q[k+2]*l,z+=q[k+3]*l;v[m]=w,v[m+1]=x,v[m+2]=y,v[m+3]=z,B==r&&(B=0,C++,e=C-p),B++}}},void 0!==(0,d.default)(a)&&void 0!==(0,d.default)(a.exports))a.exports=b;else{usenamespace("editor.filter").SharpenConvolutionFilter=b}}()}).call(b,c(6)(a))},function(a,b,c){a.exports={"default":c(311),__esModule:!0}},function(a,b,c){c(312);var d=c(9).Object;a.exports=function(a){return d.getOwnPropertyNames(a)}},function(a,b,c){c(172)("getOwnPropertyNames",function(){return c(155).f})},function(a,b,c){"use strict";(function(a){var b=c(4),d=function(a){return a&&a.__esModule?a:{"default":a}}(b);!function(){function b(){}function e(a,b){var c,d;return c=g(j.jsfeat,a),h(j.jsfeat,c),d=i(c,1,Math.PI/180,100),f(d,b)}function f(a,b){for(var c,d=0,e=a.length,f=180/Math.PI,g=90/f,h=0,i=Math.abs(b/f),j=0;j<e;j+=1)c=a[j][1],(c-=g)<i&&c>-i&&(h+=c,d++);return h/d*-1||0}function g(a,b){var c=b.width,d=b.height,e=new a.matrix_t(c,d,a.U8_t|a.C1_t);return a.imgproc.grayscale(b.data,c,d,e),e}function h(a,b){a.imgproc.gaussian_blur(b,b,6,0),a.imgproc.canny(b,b,40,100)}function i(a,b,c,d){for(var e=a.data,f=a.cols,g=a.rows,h=f,i=Math.PI,j=Math.round((i-0)/c),k=Math.round((2*(f+g)+1)/b),l=1/b,m=new Int32Array((j+2)*(k+2)),n=new Float32Array(j),o=new Float32Array(j),p=0,q=0;p<j;p++)n[p]=Math.sin(q)*l,o[p]=Math.cos(q)*l,q+=c;var r,s,t;for(s=0;s<g;s++)for(t=0;t<f;t++)if(0!=e[s*h+t])for(p=0;p<j;p++)r=t*o[p]+s*n[p],r=r<0?r-.5<<0:r+.5<<0,r+=(k-1)/2,m[(p+1)*(k+2)+r+1]+=1;var u,v=[];for(r=0;r<k;r++)for(p=0;p<j;p++)u=(p+1)*(k+2)+r+1,m[u]>d&&m[u]>m[u-1]&&m[u]>=m[u+1]&&m[u]>m[u-k-2]&&m[u]>=m[u+k+2]&&v.push(u);v.sort(function(a,b){return m[a]>m[b]||m[a]==m[b]&&a<b});var w,x,y,z=Math.min(j*k,v.length),A=1/(k+2),B=[];for(s=0;s<z;s++)w=v[s],p=Math.floor(w*A)-1,r=w-(p+1)*(k+2)-1,x=(r-.5*(k-1))*b,y=p*c,B.push([x,y]);return B}var j=(c(125),c(314));b.prototype={constructor:b,process:e},void 0!==(0,d.default)(a)&&void 0!==(0,d.default)(a.exports)?a.exports=b:usenamespace("editor.filter").AutoRotate=b}()}).call(b,c(6)(a))},function(a,b,c){"use strict";!function(){var b={};b.jsfeat=b.jsfeat||{REVISION:"ALPHA"},function(a){var b=a,c=256,d=512,e=1024,f=new Int32Array([-1,1,4,-1,4,-1,-1,-1,8,-1,-1,-1,-1,-1,-1,-1,8]),g=function(){return function(a){return 65280&a}}(),h=function(){return function(a){return 255&a}}(),i=function(){return function(a){return f[(65280&a)>>8]}}(),j=function(){function a(a,b){this.size=-8&(a+7|0),void 0===b?this.buffer=new ArrayBuffer(this.size):(this.buffer=b,this.size=b.length),this.u8=new Uint8Array(this.buffer),this.i32=new Int32Array(this.buffer),this.f32=new Float32Array(this.buffer),this.f64=new Float64Array(this.buffer)}return a}(),k=function(){function a(a,b,f,i){this.type=0|g(f),this.channel=0|h(f),this.cols=0|a,this.rows=0|b,void 0===i?this.allocate():(this.buffer=i,this.data=this.type&c?this.buffer.u8:this.type&d?this.buffer.i32:this.type&e?this.buffer.f32:this.buffer.f64)}return a.prototype.allocate=function(){delete this.data,delete this.buffer,this.buffer=new j(this.cols*i(this.type)*this.channel*this.rows),this.data=this.type&c?this.buffer.u8:this.type&d?this.buffer.i32:this.type&e?this.buffer.f32:this.buffer.f64},a.prototype.resize=function(a,b,c){void 0===c&&(c=this.channel),a*i(this.type)*c*b>this.buffer.size?(this.cols=a,this.rows=b,this.channel=c,this.allocate()):(this.cols=a,this.rows=b,this.channel=c)},a}(),l=function(){function a(a){this.levels=0|a,this.data=new Array(a),this.pyrdown=b.imgproc.pyrdown}return a.prototype.allocate=function(a,b,c){for(var d=this.levels;--d>=0;)this.data[d]=new k(a>>d,b>>d,c)},a.prototype.build=function(a,b){void 0===b&&(b=!0);var c=2,d=a,e=this.data[0];if(!b)for(var f=a.cols*a.rows;--f>=0;)e.data[f]=a.data[f];for(e=this.data[1],this.pyrdown(d,e);c<this.levels;++c)d=e,e=this.data[c],this.pyrdown(d,e)},a}(),m=function(){function a(a,b,c,d,e){void 0===a&&(a=0),void 0===b&&(b=0),void 0===c&&(c=0),void 0===d&&(d=0),void 0===e&&(e=-1),this.x=a,this.y=b,this.level=d,this.angle=e}return a}();a.U8_t=c,a.S32_t=d,a.F32_t=e,a.S64_t=2048,a.F64_t=4096,a.C1_t=1,a.C2_t=2,a.C3_t=3,a.C4_t=4,a.U8C1_t=1|c,a.U8C3_t=3|c,a.U8C4_t=4|c,a.F32C1_t=1|e,a.F32C2_t=2|e,a.S32C1_t=1|d,a.S32C2_t=2|d,a.EPSILON=1.192092896e-7,a.FLT_MIN=1e-37,a.COLOR_RGBA2GRAY=0,a.COLOR_RGB2GRAY=1,a.COLOR_BGRA2GRAY=2,a.COLOR_BGR2GRAY=3,a.BOX_BLUR_NOSCALE=1,a.SVD_U_T=1,a.SVD_V_T=2,a.get_data_type=g,a.get_channel=h,a.get_data_type_size=i,a.data_t=j,a.matrix_t=k,a.pyramid_t=l,a.keypoint_t=m}(b.jsfeat),function(a){var b=a,c=function(){var a,c,d=function(){function a(a){this.next=null,this.data=new b.data_t(a),this.size=this.data.size,this.buffer=this.data.buffer,this.u8=this.data.u8,this.i32=this.data.i32,this.f32=this.data.f32,this.f64=this.data.f64}return a.prototype.resize=function(a){delete this.data,this.data=new b.data_t(a),this.size=this.data.size,this.buffer=this.data.buffer,this.u8=this.data.u8,this.i32=this.data.i32,this.f32=this.data.f32,this.f64=this.data.f64},a}(),e=0;return{allocate:function(b,f){a=c=new d(f);for(var g=0;g<b;++g){var h=new d(f);c=c.next=h,e++}},get_buffer:function(b){var c=a;return a=a.next,e--,b>c.size&&c.resize(b),c},put_buffer:function(a){c=c.next=a,e++}}}();a.cache=c,c.allocate(30,2560)}(b.jsfeat),function(a){var b=a,c=function(){return{get_gaussian_kernel:function(a,c,d,e){var f=0,g=0,h=0,i=0,j=0,k=0,l=b.cache.get_buffer(a<<2),m=l.f32;if(1==(1&a)&&a<=7&&c<=0)switch(a>>1){case 0:m[0]=1,k=1;break;case 1:m[0]=.25,m[1]=.5,m[2]=.25,k=1;break;case 2:m[0]=.0625,m[1]=.25,m[2]=.375,m[3]=.25,m[4]=.0625,k=1;break;case 3:m[0]=.03125,m[1]=.109375,m[2]=.21875,m[3]=.28125,m[4]=.21875,m[5]=.109375,m[6]=.03125,k=1}else for(i=c>0?c:.3*(.5*(a-1)-1)+.8,j=-.5/(i*i);f<a;++f)g=f-.5*(a-1),h=Math.exp(j*g*g),m[f]=h,k+=h;if(e&b.U8_t)for(k=256/k,f=0;f<a;++f)d[f]=m[f]*k+.5|0;else for(k=1/k,f=0;f<a;++f)d[f]=m[f]*k;b.cache.put_buffer(l)}}}();a.math=c}(b.jsfeat),function(a){var b=function(){return{identity:function(a,b){void 0===b&&(b=1);for(var c=a.data,d=a.rows,e=a.cols,f=e+1|0,g=d*e,h=g;--g>=0;)c[g]=0;for(g=h,h=0;h<g;)c[h]=b,h+=f},transpose:function(a,b){for(var c=0,d=0,e=b.rows,f=b.cols,g=0,h=0,i=0,j=b.data,k=a.data;c<e;h+=1,g+=f,c++)for(i=h,d=0;d<f;i+=e,d++)k[i]=j[g+d]},multiply:function(a,b,c){for(var d=0,e=0,f=0,g=0,h=0,i=0,j=0,k=0,l=b.cols,m=b.rows,n=c.cols,o=b.data,p=c.data,q=a.data,r=0;d<m;g+=l,d++)for(j=0,e=0;e<n;k++,j++,e++){for(i=j,h=g,r=0,f=0;f<l;h++,i+=n,f++)r+=o[h]*p[i];q[k]=r}},multiply_AtB:function(a,b,c){for(var d=0,e=0,f=0,g=0,h=0,i=0,j=0,k=0,l=b.cols,m=b.rows,n=c.cols,o=b.data,p=c.data,q=a.data,r=0;d<l;g++,d++)for(j=0,e=0;e<n;k++,j++,e++){for(i=j,h=g,r=0,f=0;f<m;h+=l,i+=n,f++)r+=o[h]*p[i];q[k]=r}},multiply_AtA:function(a,b){for(var c=0,d=0,e=0,f=0,g=0,h=0,i=0,j=0,k=0,l=b.cols,m=b.rows,n=b.data,o=a.data,p=0;c<l;i+=l,c++)for(f=c,k=i+c,j=k,d=c;d<l;j++,k+=l,d++){for(g=f,h=d,p=0,e=0;e<m;g+=l,h+=l,e++)p+=n[g]*n[h];o[j]=p,o[k]=p}},invert_3x3:function(a,b){var c=a.data,d=b.data,e=c[4],f=c[8],g=c[5],h=c[7],i=c[0],j=i*e,k=i*g,l=c[3],m=c[1],n=l*m,o=c[2],p=l*o,q=c[6],r=q*m,s=q*o,t=1/(j*f-k*h-n*f+p*h+r*g-s*e);d[0]=(e*f-g*h)*t,d[1]=-(m*f-o*h)*t,d[2]=-(-m*g+o*e)*t,d[3]=-(l*f-g*q)*t,d[4]=(i*f-s)*t,d[5]=-(k-p)*t,d[6]=-(-l*h+e*q)*t,d[7]=-(i*h-r)*t,d[8]=(j-n)*t},multiply_3x3:function(a,b,c){var d=a.data,e=b.data,f=c.data,g=e[0],h=e[1],i=e[2],j=e[3],k=e[4],l=e[5],m=e[6],n=e[7],o=e[8],p=f[0],q=f[1],r=f[2],s=f[3],t=f[4],u=f[5],v=f[6],w=f[7],x=f[8];d[0]=g*p+h*s+i*v,d[1]=g*q+h*t+i*w,d[2]=g*r+h*u+i*x,d[3]=j*p+k*s+l*v,d[4]=j*q+k*t+l*w,d[5]=j*r+k*u+l*x,d[6]=m*p+n*s+o*v,d[7]=m*q+n*t+o*w,d[8]=m*r+n*u+o*x}}}();a.matmath=b}(b.jsfeat),function(a){var b=a,c=function(){var a=function(a,b,c,d){d=a[b],a[b]=a[c],a[c]=d};return{lu_solve:function(c,d){var e,f,g,h,i=0,j=0,k=0,l=1,m=c.cols,n=c.data,o=d.data;for(i=0;i<m;i++){for(k=i,j=i+1;j<m;j++)Math.abs(n[j*m+i])>Math.abs(n[k*m+i])&&(k=j);if(Math.abs(n[k*m+i])<b.EPSILON)return 0;if(k!=i){for(j=i;j<m;j++)a(n,i*m+j,k*m+j,e);a(o,i,k,e),l=-l}for(g=-1/n[i*m+i],j=i+1;j<m;j++){for(f=n[j*m+i]*g,k=i+1;k<m;k++)n[j*m+k]+=f*n[i*m+k];o[j]+=f*o[i]}n[i*m+i]=-g}for(i=m-1;i>=0;i--){for(h=o[i],k=i+1;k<m;k++)h-=n[i*m+k]*o[k];o[i]=h*n[i*m+i]}return 1}}}();a.linalg=c}(b.jsfeat),function(a){var b=a,c=function(){var a=function(a){return a*a},c=function(a,b,c,d,e){for(var f=0,g=0,h=0,i=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0;f<e;++f)g+=a[f].x,h+=a[f].y,k+=b[f].x,l+=b[f].y;for(g/=e,h/=e,k/=e,l/=e,f=0;f<e;++f)o=a[f].x-g,p=a[f].y-h,i+=Math.sqrt(o*o+p*p),o=b[f].x-k,p=b[f].y-l,m+=Math.sqrt(o*o+p*p);i/=e,m/=e,j=Math.SQRT2/i,n=Math.SQRT2/m,c[0]=c[4]=j,c[2]=-g*j,c[5]=-h*j,c[1]=c[3]=c[6]=c[7]=0,c[8]=1,d[0]=d[4]=n,d[2]=-k*n,d[5]=-l*n,d[1]=d[3]=d[6]=d[7]=0,d[8]=1},d=new b.matrix_t(3,3,b.F32_t|b.C1_t),e=new b.matrix_t(3,3,b.F32_t|b.C1_t),f=new b.matrix_t(6,6,b.F32_t|b.C1_t),g=new b.matrix_t(6,1,b.F32_t|b.C1_t);return{affine2d:function(){function h(){}return h.prototype.run=function(a,h,i,j){var k,l,m=0,n=0,o=i.type|b.C1_t,p=i.data,q=d.data,r=e.data,s=0,t=0;c(a,h,q,r,j);for(var u=b.cache.get_buffer(2*j*6<<3),v=b.cache.get_buffer(2*j<<3),w=new b.matrix_t(6,2*j,o,u.data),x=new b.matrix_t(1,2*j,o,v.data),y=w.data,z=x.data;m<j;++m)k=a[m],l=h[m],s=q[0]*k.x+q[1]*k.y+q[2],t=q[3]*k.x+q[4]*k.y+q[5],n=2*m*6,y[n]=s,y[n+1]=t,y[n+2]=1,y[n+3]=0,y[n+4]=0,y[n+5]=0,n+=6,y[n]=0,y[n+1]=0,y[n+2]=0,y[n+3]=s,y[n+4]=t,y[n+5]=1,z[m<<1]=r[0]*l.x+r[1]*l.y+r[2],z[1+(m<<1)]=r[3]*l.x+r[4]*l.y+r[5];return b.matmath.multiply_AtA(f,w),b.matmath.multiply_AtB(g,w,x),b.linalg.lu_solve(f,g),p[0]=g.data[0],p[1]=g.data[1],p[2]=g.data[2],p[3]=g.data[3],p[4]=g.data[4],p[5]=g.data[5],p[6]=0,p[7]=0,p[8]=1,b.matmath.invert_3x3(e,e),b.matmath.multiply_3x3(i,e,i),b.matmath.multiply_3x3(i,i,d),b.cache.put_buffer(u),b.cache.put_buffer(v),1},h.prototype.error=function(b,c,d,e,f){for(var g,h,i=0,j=d.data;i<f;++i)g=b[i],h=c[i],e[i]=a(h.x-j[0]*g.x-j[1]*g.y-j[2])+a(h.y-j[3]*g.x-j[4]*g.y-j[5])},h}()}}(),d=function(){function a(a,b,c,d){void 0===a&&(a=0),this.size=a}return a}();a.ransac_params_t=d,a.motion_model=c}(b.jsfeat),function(a){var b=a,c=function(){var a=function(a,b,c,d,e,f,g,h){for(var i=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=0,r=f[0],s=0,t=d<<1,u=3*d,v=d<<2;i<e;++i){for(n=b[l],j=0;j<h;++j)a[j]=n;for(j=0;j<=d-2;j+=2)a[j+h]=b[l+j],a[j+h+1]=b[l+j+1];for(;j<d;++j)a[j+h]=b[l+j];for(n=b[l+d-1],j=d;j<h+d;++j)a[j+h]=n;for(j=0;j<=d-4;j+=4){for(n=a[j]*r,o=a[j+1]*r,p=a[j+2]*r,q=a[j+3]*r,k=1;k<g;++k)s=f[k],n+=a[k+j]*s,o+=a[k+j+1]*s,p+=a[k+j+2]*s,q+=a[k+j+3]*s;c[m+j]=Math.min(n>>8,255),c[m+j+1]=Math.min(o>>8,255),c[m+j+2]=Math.min(p>>8,255),c[m+j+3]=Math.min(q>>8,255)}for(;j<d;++j){for(n=a[j]*r,k=1;k<g;++k)n+=a[k+j]*f[k];c[m+j]=Math.min(n>>8,255)}l+=d,m+=d}for(i=0;i<d;++i){for(n=c[i],j=0;j<h;++j)a[j]=n;for(k=i,j=0;j<=e-2;j+=2,k+=t)a[j+h]=c[k],a[j+h+1]=c[k+d];for(;j<e;++j,k+=d)a[j+h]=c[k];for(n=c[(e-1)*d+i],j=e;j<h+e;++j)a[j+h]=n;for(m=i,j=0;j<=e-4;j+=4,m+=v){for(n=a[j]*r,o=a[j+1]*r,p=a[j+2]*r,q=a[j+3]*r,k=1;k<g;++k)s=f[k],n+=a[k+j]*s,o+=a[k+j+1]*s,p+=a[k+j+2]*s,q+=a[k+j+3]*s;c[m]=Math.min(n>>8,255),c[m+d]=Math.min(o>>8,255),c[m+t]=Math.min(p>>8,255),c[m+u]=Math.min(q>>8,255)}for(;j<e;++j,m+=d){for(n=a[j]*r,k=1;k<g;++k)n+=a[k+j]*f[k];c[m]=Math.min(n>>8,255)}}},c=function(a,b,c,d,e,f,g,h){for(var i=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=0,r=f[0],s=0,t=d<<1,u=3*d,v=d<<2;i<e;++i){for(n=b[l],j=0;j<h;++j)a[j]=n;for(j=0;j<=d-2;j+=2)a[j+h]=b[l+j],a[j+h+1]=b[l+j+1];for(;j<d;++j)a[j+h]=b[l+j];for(n=b[l+d-1],j=d;j<h+d;++j)a[j+h]=n;for(j=0;j<=d-4;j+=4){for(n=a[j]*r,o=a[j+1]*r,p=a[j+2]*r,q=a[j+3]*r,k=1;k<g;++k)s=f[k],n+=a[k+j]*s,o+=a[k+j+1]*s,p+=a[k+j+2]*s,q+=a[k+j+3]*s;c[m+j]=n,c[m+j+1]=o,c[m+j+2]=p,c[m+j+3]=q}for(;j<d;++j){for(n=a[j]*r,k=1;k<g;++k)n+=a[k+j]*f[k];c[m+j]=n}l+=d,m+=d}for(i=0;i<d;++i){for(n=c[i],j=0;j<h;++j)a[j]=n;for(k=i,j=0;j<=e-2;j+=2,k+=t)a[j+h]=c[k],a[j+h+1]=c[k+d];for(;j<e;++j,k+=d)a[j+h]=c[k];for(n=c[(e-1)*d+i],j=e;j<h+e;++j)a[j+h]=n;for(m=i,j=0;j<=e-4;j+=4,m+=v){for(n=a[j]*r,o=a[j+1]*r,p=a[j+2]*r,q=a[j+3]*r,k=1;k<g;++k)s=f[k],n+=a[k+j]*s,o+=a[k+j+1]*s,p+=a[k+j+2]*s,q+=a[k+j+3]*s;c[m]=n,c[m+d]=o,c[m+t]=p,c[m+u]=q}for(;j<e;++j,m+=d){for(n=a[j]*r,k=1;k<g;++k)n+=a[k+j]*f[k];c[m]=n}}};return{grayscale:function(a,c,d,e,f){void 0===f&&(f=b.COLOR_RGBA2GRAY);var g=0,h=0,i=0,j=0,k=0,l=0,m=4899,n=1868,o=4;f!=b.COLOR_BGRA2GRAY&&f!=b.COLOR_BGR2GRAY||(m=1868,n=4899),f!=b.COLOR_RGB2GRAY&&f!=b.COLOR_BGR2GRAY||(o=3);var p=o<<1,q=3*o|0;e.resize(c,d,1);var r=e.data;for(h=0;h<d;++h,j+=c,i+=c*o){for(g=0,k=i,l=j;g<=c-4;g+=4,k+=o<<2,l+=4)r[l]=a[k]*m+9617*a[k+1]+a[k+2]*n+8192>>14,r[l+1]=a[k+o]*m+9617*a[k+o+1]+a[k+o+2]*n+8192>>14,r[l+2]=a[k+p]*m+9617*a[k+p+1]+a[k+p+2]*n+8192>>14,r[l+3]=a[k+q]*m+9617*a[k+q+1]+a[k+q+2]*n+8192>>14;for(;g<c;++g,++l,k+=o)r[l]=a[k]*m+9617*a[k+1]+a[k+2]*n+8192>>14}},gaussian_blur:function(d,e,f,g){void 0===g&&(g=0),void 0===f&&(f=0),f=0==f?2*Math.max(1,4*g+1-1e-8)+1|0:f;var h=f>>1,i=d.cols,j=d.rows,k=d.type,l=k&b.U8_t;e.resize(i,j,d.channel);var m,n,o=d.data,p=e.data,q=f+Math.max(j,i)|0,r=b.cache.get_buffer(q<<2),s=b.cache.get_buffer(f<<2);l?(m=r.i32,n=s.i32):k&b.S32_t?(m=r.i32,n=s.f32):(m=r.f32,n=s.f32),b.math.get_gaussian_kernel(f,g,n,k),l?a(m,o,p,i,j,n,f,h):c(m,o,p,i,j,n,f,h),b.cache.put_buffer(r),b.cache.put_buffer(s)},pyrdown:function(a,b,c,d){void 0===c&&(c=0),void 0===d&&(d=0);var e=a.cols,f=a.rows,g=e>>1,h=f>>1,i=g-(c<<1),j=h-(d<<1),k=0,l=0,m=c+d*e,n=0,o=0,p=0;b.resize(g,h,a.channel);var q=a.data,r=b.data;for(l=0;l<j;++l){for(n=m,p=o,k=0;k<=i-2;k+=2,p+=2,n+=4)r[p]=q[n]+q[n+1]+q[n+e]+q[n+e+1]+2>>2,r[p+1]=q[n+2]+q[n+3]+q[n+e+2]+q[n+e+3]+2>>2;for(;k<i;++k,++p,n+=2)r[p]=q[n]+q[n+1]+q[n+e]+q[n+e+1]+2>>2;m+=e<<1,o+=g}},scharr_derivatives:function(a,c){var d,e,f,g,h,i,j,k,l=a.cols,m=a.rows,n=l<<1,o=0,p=0,q=0,r=0,s=0,t=0,u=0;c.resize(l,m,2);var v=a.data,w=c.data,x=b.cache.get_buffer(l+2<<2),y=b.cache.get_buffer(l+2<<2);for(a.type&b.U8_t||a.type&b.S32_t?(j=x.i32,k=y.i32):(j=x.f32,k=y.f32);p<m;++p,s+=l){for(r=(p>0?p-1:1)*l|0,t=(p<m-1?p+1:m-2)*l|0,u=p*n|0,o=0,q=1;o<=l-2;o+=2,q+=2)d=v[r+o],e=v[t+o],j[q]=3*(d+e)+10*v[s+o],k[q]=e-d,d=v[r+o+1],e=v[t+o+1],j[q+1]=3*(d+e)+10*v[s+o+1],k[q+1]=e-d;for(;o<l;++o,++q)d=v[r+o],e=v[t+o],j[q]=3*(d+e)+10*v[s+o],k[q]=e-d;for(o=l+1|0,j[0]=j[1],j[o]=j[l],k[0]=k[1],k[o]=k[l],o=0;o<=l-4;o+=4)d=k[o+2],e=k[o+1],f=k[o+3],g=k[o+4],h=j[o+2],i=j[o+3],w[u++]=h-j[o],w[u++]=3*(d+k[o])+10*e,w[u++]=i-j[o+1],w[u++]=3*(f+e)+10*d,w[u++]=j[o+4]-h,w[u++]=3*(g+d)+10*f,w[u++]=j[o+5]-i,w[u++]=3*(k[o+5]+f)+10*g;for(;o<l;++o)w[u++]=j[o+2]-j[o],w[u++]=3*(k[o+2]+k[o])+10*k[o+1]}b.cache.put_buffer(x),b.cache.put_buffer(y)},sobel_derivatives:function(a,c){var d,e,f,g,h,i,j,k,l=a.cols,m=a.rows,n=l<<1,o=0,p=0,q=0,r=0,s=0,t=0,u=0;c.resize(l,m,2);var v=a.data,w=c.data,x=b.cache.get_buffer(l+2<<2),y=b.cache.get_buffer(l+2<<2);for(a.type&b.U8_t||a.type&b.S32_t?(j=x.i32,k=y.i32):(j=x.f32,k=y.f32);p<m;++p,s+=l){for(r=(p>0?p-1:1)*l|0,t=(p<m-1?p+1:m-2)*l|0,u=p*n|0,o=0,q=1;o<=l-2;o+=2,q+=2)d=v[r+o],e=v[t+o],j[q]=d+e+2*v[s+o],k[q]=e-d,d=v[r+o+1],e=v[t+o+1],j[q+1]=d+e+2*v[s+o+1],k[q+1]=e-d;for(;o<l;++o,++q)d=v[r+o],e=v[t+o],j[q]=d+e+2*v[s+o],k[q]=e-d;for(o=l+1|0,j[0]=j[1],j[o]=j[l],k[0]=k[1],k[o]=k[l],o=0;o<=l-4;o+=4)d=k[o+2],e=k[o+1],f=k[o+3],g=k[o+4],h=j[o+2],i=j[o+3],w[u++]=h-j[o],w[u++]=d+k[o]+2*e,w[u++]=i-j[o+1],w[u++]=f+e+2*d,w[u++]=j[o+4]-h,w[u++]=g+d+2*f,w[u++]=j[o+5]-i,w[u++]=k[o+5]+f+2*g;for(;o<l;++o)w[u++]=j[o+2]-j[o],w[u++]=k[o+2]+k[o]+2*k[o+1]}b.cache.put_buffer(x),b.cache.put_buffer(y)},canny:function(a,c,d,e){var f=a.cols,g=a.rows;a.data;c.resize(f,g,a.channel);var h=c.data,i=0,j=0,k=0,l=f<<1,m=0,n=0,o=0,p=0,q=0,r=0,s=0,t=0,u=b.cache.get_buffer(g*l<<2),v=b.cache.get_buffer(3*(f+2)<<2),w=b.cache.get_buffer((g+2)*(f+2)<<2),x=b.cache.get_buffer(g*f<<2),y=v.i32,z=w.i32,A=x.i32,B=u.i32,C=new b.matrix_t(f,g,b.S32C2_t,u.data),D=1,E=f+2+1|0,F=2*(f+2)+1|0,G=f+2|0,H=G+1|0,I=0;for(this.sobel_derivatives(a,C),d>e&&(i=d,d=e,e=i),i=3*(f+2)|0;--i>=0;)y[i]=0;for(i=(g+2)*(f+2)|0;--i>=0;)z[i]=0;for(;j<f;++j,k+=2)p=B[k],q=B[k+1],y[E+j]=(p^p>>31)-(p>>31)+((q^q>>31)-(q>>31));for(i=1;i<=g;++i,k+=l){if(i==g)for(j=F+f;--j>=F;)y[j]=0;else for(j=0;j<f;j++)p=B[k+(j<<1)],q=B[k+(j<<1)+1],y[F+j]=(p^p>>31)-(p>>31)+((q^q>>31)-(q>>31));for(m=k-l|0,z[H-1]=0,n=0,j=0;j<f;++j,m+=2){if((o=y[E+j])>d)if(p=B[m],q=B[m+1],r=p^q,p=(p^p>>31)-(p>>31)|0,q=(q^q>>31)-(q>>31)|0,s=13573*p,t=s+(p+p<<15),(q<<=15)<s){if(o>y[E+j-1]&&o>=y[E+j+1]){o>e&&!n&&2!=z[H+j-G]?(z[H+j]=2,n=1,A[I++]=H+j):z[H+j]=1;continue}}else if(q>t){if(o>y[D+j]&&o>=y[F+j]){o>e&&!n&&2!=z[H+j-G]?(z[H+j]=2,n=1,A[I++]=H+j):z[H+j]=1;continue}}else if(r=r<0?-1:1,o>y[D+j-r]&&o>y[F+j+r]){o>e&&!n&&2!=z[H+j-G]?(z[H+j]=2,n=1,A[I++]=H+j):z[H+j]=1;continue}z[H+j]=0,n=0}z[H+f]=0,H+=G,j=D,D=E,E=F,F=j}for(j=H-G-1,i=0;i<G;++i,++j)z[j]=0;for(;I>0;)H=A[--I],H-=G+1,1==z[H]&&(z[H]=2,A[I++]=H),H+=1,1==z[H]&&(z[H]=2,A[I++]=H),H+=1,1==z[H]&&(z[H]=2,A[I++]=H),H+=G,1==z[H]&&(z[H]=2,A[I++]=H),H-=2,1==z[H]&&(z[H]=2,A[I++]=H),H+=G,1==z[H]&&(z[H]=2,A[I++]=H),H+=1,1==z[H]&&(z[H]=2,A[I++]=H),H+=1,1==z[H]&&(z[H]=2,A[I++]=H);for(H=G+1,D=0,i=0;i<g;++i,H+=G)for(j=0;j<f;++j)h[D++]=255*(2==z[H+j]);b.cache.put_buffer(u),b.cache.put_buffer(v),b.cache.put_buffer(w),b.cache.put_buffer(x)},warp_affine:function(a,b,c,d){void 0===d&&(d=0);for(var e=a.cols,f=a.rows,g=b.cols,h=b.rows,i=a.data,j=b.data,k=0,l=0,m=0,n=0,o=0,p=0,q=0,r=0,s=0,t=0,u=0,v=c.data,w=v[0],x=v[1],y=v[2],z=v[3],A=v[4],B=v[5],C=0;l<h;++l)for(p=x*l+y,q=A*l+B,k=0;k<g;++k,++C,p+=w,q+=z)n=0|p,o=0|q,n>=0&&o>=0&&n<e-1&&o<f-1?(r=p-n,s=q-o,m=e*o+n,t=i[m]+r*(i[m+1]-i[m]),u=i[m+e]+r*(i[m+e+1]-i[m+e]),j[C]=t+s*(u-t)):j[C]=d}}}();a.imgproc=c}(b.jsfeat),function(a){var b=a,c=function(){var a=new Int32Array([0,3,1,3,2,2,3,1,3,0,3,-1,2,-2,1,-3,0,-3,-1,-3,-2,-2,-3,-1,-3,0,-3,1,-2,2,-1,3]),c=new Uint8Array(512),d=new Int32Array(25),e=new Int32Array(25),f=function(b,c,d){for(var e=0,f=a;e<d;++e)b[e]=f[e<<1]+f[1+(e<<1)]*c;for(;e<25;++e)b[e]=b[e-d]},g=function(a,b,c,d,e){for(var f=0,g=a[b],h=e,i=0,j=0,k=0;f<25;++f)d[f]=g-a[b+c[f]];for(f=0;f<16;f+=2)i=Math.min(d[f+1],d[f+2]),(i=Math.min(i,d[f+3]))<=h||(i=Math.min(i,d[f+4]),i=Math.min(i,d[f+5]),i=Math.min(i,d[f+6]),i=Math.min(i,d[f+7]),i=Math.min(i,d[f+8]),h=Math.max(h,Math.min(i,d[f])),h=Math.max(h,Math.min(i,d[f+9])));for(j=-h,f=0;f<16;f+=2)k=Math.max(d[f+1],d[f+2]),k=Math.max(k,d[f+3]),k=Math.max(k,d[f+4]),(k=Math.max(k,d[f+5]))>=j||(k=Math.max(k,d[f+6]),k=Math.max(k,d[f+7]),k=Math.max(k,d[f+8]),j=Math.min(j,Math.max(k,d[f])),j=Math.min(j,Math.max(k,d[f+9])));return-j-1},h=20;return{set_threshold:function(a){h=Math.min(Math.max(a,0),255);for(var b=-255;b<=255;++b)c[b+255]=b<-h?1:b>h?2:0;return h},detect:function(a,i,j){void 0===j&&(j=3);var k,l=a.data,m=a.cols,n=a.rows,o=0,p=0,q=0,r=0,s=0,t=b.cache.get_buffer(3*m),u=b.cache.get_buffer(3*(m+1)<<2),v=t.u8,w=u.i32,x=d,y=e,z=Math.max(3,j),A=Math.min(n-2,n-j),B=Math.max(3,j),C=Math.min(m-3,m-j),D=0,E=0,F=g,G=c,H=h,I=0,J=0,K=0,L=0,M=0,N=0,O=0,P=0,Q=0,R=0,S=0,T=0;f(x,m,16);var U=x[0],V=x[1],W=x[2],X=x[3],Y=x[4],Z=x[5],$=x[6],_=x[7],aa=x[8],ba=x[9],ca=x[10],da=x[11],ea=x[12],fa=x[13],ga=x[14],ha=x[15];for(o=0;o<3*m;++o)v[o]=0;for(o=z;o<A;++o){for(O=o*m+B|0,s=(o-3)%3,N=s*m|0,M=s*(m+1)|0,p=0;p<m;++p)v[N+p]=0;if(L=0,o<A-1)for(p=B;p<C;++p,++O)if(I=l[O],J=255-I,0!=(K=G[J+l[O+U]]|G[J+l[O+aa]])&&(K&=G[J+l[O+W]]|G[J+l[O+ca]],K&=G[J+l[O+Y]]|G[J+l[O+ea]],0!=(K&=G[J+l[O+$]]|G[J+l[O+ga]]))){if(K&=G[J+l[O+V]]|G[J+l[O+ba]],K&=G[J+l[O+X]]|G[J+l[O+da]],K&=G[J+l[O+Z]]|G[J+l[O+fa]],1&(K&=G[J+l[O+_]]|G[J+l[O+ha]]))for(r=I-H,D=0,q=0;q<25;++q)if(l[O+x[q]]<r){if(++D>8){++L,w[M+L]=p,v[N+p]=F(l,O,x,y,H);break}}else D=0;if(2&K)for(r=I+H,D=0,q=0;q<25;++q)if(l[O+x[q]]>r){if(++D>8){++L,w[M+L]=p,v[N+p]=F(l,O,x,y,H);break}}else D=0}if(w[M+m]=L,o!=z)for(s=(o-4+3)%3,P=s*m|0,M=s*(m+1)|0,s=(o-5+3)%3,Q=s*m|0,L=w[M+m],q=0;q<L;++q)p=w[M+q],R=p+1|0,S=p-1|0,(T=v[P+p])>v[P+R]&&T>v[P+S]&&T>v[Q+S]&&T>v[Q+p]&&T>v[Q+R]&&T>v[N+S]&&T>v[N+p]&&T>v[N+R]&&(k=i[E],k.x=p,k.y=o-1,k.score=T,E++)}return b.cache.put_buffer(t),b.cache.put_buffer(u),E}}}();a.fast_corners=c,c.set_threshold(20)}(b.jsfeat),function(a){var b=a,c=function(){var a=function(a,b,c,d,e,f,g,h,i,j){var k=0,l=0,m=h*c+g|0,n=m;for(k=h;k<j;++k,m+=c,n=m)for(l=g;l<i;++l,++n)b[n]=-4*a[n]+a[n+e]+a[n-e]+a[n+f]+a[n-f]},c=function(a,b,c,d,e,f,g){var h=-2*a[b]+a[b+d]+a[b-d],i=-2*a[b]+a[b+e]+a[b-e],j=a[b+f]+a[b-f]-a[b+g]-a[b-g],k=0|Math.sqrt((h-i)*(h-i)+4*j*j);return Math.min(Math.abs(c-k),Math.abs(-(c+k)))};return{laplacian_threshold:30,min_eigen_value_threshold:25,detect:function(d,e,f){void 0===f&&(f=5);var g,h=d.cols,i=d.rows,j=d.data,k=5*h|0,l=3+3*h|0,m=3-3*h|0,n=b.cache.get_buffer(h*i<<2),o=n.i32,p=0,q=0,r=0,s=0,t=this.laplacian_threshold,u=this.min_eigen_value_threshold,v=0|Math.max(5,f),w=0|Math.max(3,f),z=0|Math.min(h-5,h-f),A=0|Math.min(i-3,i-f);for(x=h*i;--x>=0;)o[x]=0;for(a(j,o,h,0,5,k,v,w,z,A),row=w*h+v|0,y=w;y<A;++y,row+=h)for(x=v,q=row;x<z;++x,++q)((p=o[q])<-t&&p<o[q-1]&&p<o[q+1]&&p<o[q-h]&&p<o[q+h]&&p<o[q-h-1]&&p<o[q+h-1]&&p<o[q-h+1]&&p<o[q+h+1]||p>t&&p>o[q-1]&&p>o[q+1]&&p>o[q-h]&&p>o[q+h]&&p>o[q-h-1]&&p>o[q+h-1]&&p>o[q-h+1]&&p>o[q+h+1])&&(r=c(j,q,p,5,k,l,m))>u&&(g=e[s],g.x=x,g.y=y,g.score=r,++s,++x,++q);return b.cache.put_buffer(n),s}}}();a.yape06=c}(b.jsfeat),function(a){var b=function(){var a=function(a,b,c){var d,e,f=0;for(d=c,e=0;e<d;e++,f++)d=Math.sqrt(c*c-e*e)+.5|0,b[f]=d+a*e;for(d--;d<e&&d>=0;d--,f++)e=Math.sqrt(c*c-d*d)+.5|0,b[f]=d+a*e;for(;-d<e;d--,f++)e=Math.sqrt(c*c-d*d)+.5|0,b[f]=d+a*e;for(e--;e>=0;e--,f++)d=-Math.sqrt(c*c-e*e)-.5|0,b[f]=d+a*e;for(;e>d;e--,f++)d=-Math.sqrt(c*c-e*e)-.5|0,b[f]=d+a*e;for(d++;d<=0;d++,f++)e=-Math.sqrt(c*c-d*d)-.5|0,b[f]=d+a*e;for(;d<-e;d++,f++)e=-Math.sqrt(c*c-d*d)-.5|0,b[f]=d+a*e;for(e++;e<0;e++,f++)d=Math.sqrt(c*c-e*e)+.5|0,b[f]=d+a*e;return b[f]=b[0],b[f+1]=b[1],f},b=function(a,b,c){var d=0;return 0!=a[b+1]&&d++,0!=a[b-1]&&d++,0!=a[b+c]&&d++,0!=a[b+c+1]&&d++,0!=a[b+c-1]&&d++,0!=a[b-c]&&d++,0!=a[b-c+1]&&d++,0!=a[b-c-1]&&d++,d},c=function(a,b,c,d,e){var f,g;if(c>0)for(b-=d*e,g=-e;g<=e;++g){for(f=-e;f<=e;++f)if(a[b+f]>c)return!1;b+=d}else for(b-=d*e,g=-e;g<=e;++g){for(f=-e;f<=e;++f)if(a[b+f]<c)return!1;b+=d}return!0},d=function(a,b,c,d,e,f,g,h){var i=0,j=0,k=g-1|0,l=0,m=0,n=0,o=0,p=0;if((l=a[b+f[j]])<=e)if(l>=d)if((m=a[b+f[k]])<=e){if(m>=d)return void(c[b]=0);if(k++,(n=a[b+f[k]])>e)if(k++,(o=a[b+f[k]])>e)p=3;else{if(!(o<d))return void(c[b]=0);p=6}else if(k++,(o=a[b+f[k]])>e)p=7;else{if(!(o<d))return void(c[b]=0);p=2}}else if(k++,(n=a[b+f[k]])>e)if(k++,(o=a[b+f[k]])>e)p=3;else{if(!(o<d))return void(c[b]=0);p=6}else{if(!(n<d))return void(c[b]=0);if(k++,(o=a[b+f[k]])>e)p=7;else{if(!(o<d))return void(c[b]=0);p=2}}else{if((m=a[b+f[k]])>e)return void(c[b]=0);if(k++,(n=a[b+f[k]])>e)return void(c[b]=0);if(k++,(o=a[b+f[k]])>e)return void(c[b]=0);p=1}else{if((m=a[b+f[k]])<d)return void(c[b]=0);if(k++,(n=a[b+f[k]])<d)return void(c[b]=0);if(k++,(o=a[b+f[k]])<d)return void(c[b]=0);p=0}for(j=1;j<=g;j++)switch(l=a[b+f[j]],p){case 0:if(l>e){if(n=o,k++,(o=a[b+f[k]])<d)return void(c[b]=0);i-=l+n,p=0;break}if(l<d){if(n>e)return void(c[b]=0);if(o>e)return void(c[b]=0);if(n=o,k++,(o=a[b+f[k]])>e)return void(c[b]=0);i-=l+n,p=8;break}if(n<=e)return void(c[b]=0);if(o<=e)return void(c[b]=0);if(n=o,k++,(o=a[b+f[k]])>e){i-=l+n,p=3;break}if(o<d){i-=l+n,p=6;break}return void(c[b]=0);case 1:if(l<d){if(n=o,k++,(o=a[b+f[k]])>e)return void(c[b]=0);i-=l+n,p=1;break}if(l>e){if(n<d)return void(c[b]=0);if(o<d)return void(c[b]=0);if(n=o,k++,(o=a[b+f[k]])<d)return void(c[b]=0);i-=l+n,p=9;break}if(n>=d)return void(c[b]=0);if(o>=d)return void(c[b]=0);if(n=o,k++,(o=a[b+f[k]])<d){i-=l+n,p=2;break}if(o>e){i-=l+n,p=7;break}return void(c[b]=0);case 2:if(l>e)return void(c[b]=0);if(n=o,k++,o=a[b+f[k]],l<d){if(o>e)return void(c[b]=0);i-=l+n,p=4;break}if(o>e){i-=l+n,p=7;break}if(o<d){i-=l+n,p=2;break}return void(c[b]=0);case 3:if(l<d)return void(c[b]=0);if(n=o,k++,o=a[b+f[k]],l>e){if(o<d)return void(c[b]=0);i-=l+n,p=5;break}if(o>e){i-=l+n,p=3;break}if(o<d){i-=l+n,p=6;break}return void(c[b]=0);case 4:if(l>e)return void(c[b]=0);if(l<d){if(n=o,k++,(o=a[b+f[k]])>e)return void(c[b]=0);i-=l+n,p=1;break}if(o>=d)return void(c[b]=0);if(n=o,k++,(o=a[b+f[k]])<d){i-=l+n,p=2;break}if(o>e){i-=l+n,p=7;break}return void(c[b]=0);case 5:if(l<d)return void(c[b]=0);if(l>e){if(n=o,k++,(o=a[b+f[k]])<d)return void(c[b]=0);i-=l+n,p=0;break}if(o<=e)return void(c[b]=0);if(n=o,k++,(o=a[b+f[k]])>e){i-=l+n,p=3;break}if(o<d){i-=l+n,p=6;break}return void(c[b]=0);case 7:if(l>e)return void(c[b]=0);if(l<d)return void(c[b]=0);if(n=o,k++,(o=a[b+f[k]])>e){i-=l+n,p=3;break}if(o<d){i-=l+n,p=6;break}return void(c[b]=0);case 6:if(l>e)return void(c[b]=0);if(l<d)return void(c[b]=0);if(n=o,k++,(o=a[b+f[k]])<d){i-=l+n,p=2;break}if(o>e){i-=l+n,p=7;break}return void(c[b]=0);case 8:if(l>e){if(o<d)return void(c[b]=0);if(n=o,k++,(o=a[b+f[k]])<d)return void(c[b]=0);i-=l+n,p=9;break}if(l<d){if(n=o,k++,(o=a[b+f[k]])>e)return void(c[b]=0);i-=l+n,p=1;break}return void(c[b]=0);case 9:if(l<d){if(o>e)return void(c[b]=0);if(n=o,k++,(o=a[b+f[k]])>e)return void(c[b]=0);i-=l+n,p=8;break}if(l>e){if(n=o,k++,(o=a[b+f[k]])<d)return void(c[b]=0);i-=l+n,p=0;break}return void(c[b]=0)}c[b]=i+h*a[b]},e=function(){function b(b,c,d){this.dirs=new Int32Array(1024),this.dirs_count=0|a(b,this.dirs,d),this.scores=new Int32Array(b*c),this.radius=0|d}return b}();return{level_tables:[],tau:7,init:function(a,b,c,d){void 0===d&&(d=1);var f;for(c=Math.min(c,7),c=Math.max(c,3),f=0;f<d;++f)this.level_tables[f]=new e(a>>f,b>>f,c)},detect:function(a,e,f){void 0===f&&(f=4);var g,h=this.level_tables[0],i=0|h.radius,j=i-1|0,k=h.dirs,l=0|h.dirs_count,m=l>>1,n=a.data,o=0|a.cols,p=0|a.rows,q=o>>1,r=h.scores,s=0,t=0,u=0,v=0,w=0,x=0,y=0,z=0,A=0|this.tau,B=0,C=0|Math.max(i+1,f),D=0|Math.max(i+1,f),E=0|Math.min(o-i-2,o-f),F=0|Math.min(p-i-2,p-f);for(u=D*o+C|0,t=D;t<F;++t,u+=o)for(s=C,v=u;s<E;++s,++v)w=n[v]+A,x=n[v]-A,x<n[v+i]&&n[v+i]<w&&x<n[v-i]&&n[v-i]<w?r[v]=0:d(n,v,r,x,w,k,m,l);for(u=D*o+C|0,t=D;t<F;++t,u+=o)for(s=C,v=u;s<E;++s,++v)z=r[v],y=Math.abs(z),y<5?(++s,++v):b(r,v,o)>=3&&c(r,v,z,q,i)&&(g=e[B],g.x=s,g.y=t,g.score=y,++B,s+=j,v+=j);return B}}}();a.yape=b}(b.jsfeat),function(a){var b=a,c=function(){var a=new Int32Array([8,-3,9,5,4,2,7,-12,-11,9,-8,2,7,-12,12,-13,2,-13,2,12,1,-7,1,6,-2,-10,-2,-4,-13,-13,-11,-8,-13,-3,-12,-9,10,4,11,9,-13,-8,-8,-9,-11,7,-9,12,7,7,12,6,-4,-5,-3,0,-13,2,-12,-3,-9,0,-7,5,12,-6,12,-1,-3,6,-2,12,-6,-13,-4,-8,11,-13,12,-8,4,7,5,1,5,-3,10,-3,3,-7,6,12,-8,-7,-6,-2,-2,11,-1,-10,-13,12,-8,10,-7,3,-5,-3,-4,2,-3,7,-10,-12,-6,11,5,-12,6,-7,5,-6,7,-1,1,0,4,-5,9,11,11,-13,4,7,4,12,2,-1,4,4,-4,-12,-2,7,-8,-5,-7,-10,4,11,9,12,0,-8,1,-13,-13,-2,-8,2,-3,-2,-2,3,-6,9,-4,-9,8,12,10,7,0,9,1,3,7,-5,11,-10,-13,-6,-11,0,10,7,12,1,-6,-3,-6,12,10,-9,12,-4,-13,8,-8,-12,-13,0,-8,-4,3,3,7,8,5,7,10,-7,-1,7,1,-12,3,-10,5,6,2,-4,3,-10,-13,0,-13,5,-13,-7,-12,12,-13,3,-11,8,-7,12,-4,7,6,-10,12,8,-9,-1,-7,-6,-2,-5,0,12,-12,5,-7,5,3,-10,8,-13,-7,-7,-4,5,-3,-2,-1,-7,2,9,5,-11,-11,-13,-5,-13,-1,6,0,-1,5,-3,5,2,-4,-13,-4,12,-9,-6,-9,6,-12,-10,-8,-4,10,2,12,-3,7,12,12,12,-7,-13,-6,5,-4,9,-3,4,7,-1,12,2,-7,6,-5,1,-13,11,-12,5,-3,7,-2,-6,7,-8,12,-7,-13,-7,-11,-12,1,-3,12,12,2,-6,3,0,-4,3,-2,-13,-1,-13,1,9,7,1,8,-6,1,-1,3,12,9,1,12,6,-1,-9,-1,3,-13,-13,-10,5,7,7,10,12,12,-5,12,9,6,3,7,11,5,-13,6,10,2,-12,2,3,3,8,4,-6,2,6,12,-13,9,-12,10,3,-8,4,-7,9,-11,12,-4,-6,1,12,2,-8,6,-9,7,-4,2,3,3,-2,6,3,11,0,3,-3,8,-8,7,8,9,3,-11,-5,-6,-4,-10,11,-5,10,-5,-8,-3,12,-10,5,-9,0,8,-1,12,-6,4,-6,6,-11,-10,12,-8,7,4,-2,6,7,-2,0,-2,12,-5,-8,-5,2,7,-6,10,12,-9,-13,-8,-8,-5,-13,-5,-2,8,-8,9,-13,-9,-11,-9,0,1,-8,1,-2,7,-4,9,1,-2,1,-1,-4,11,-6,12,-11,-12,-9,-6,4,3,7,7,12,5,5,10,8,0,-4,2,8,-9,12,-5,-13,0,7,2,12,-1,2,1,7,5,11,7,-9,3,5,6,-8,-13,-4,-8,9,-5,9,-3,-3,-4,-7,-3,-12,6,5,8,0,-7,6,-6,12,-13,6,-5,-2,1,-10,3,10,4,1,8,-4,-2,-2,2,-13,2,-12,12,12,-2,-13,0,-6,4,1,9,3,-6,-10,-3,-5,-3,-13,-1,1,7,5,12,-11,4,-2,5,-7,-13,9,-9,-5,7,1,8,6,7,-8,7,6,-7,-4,-7,1,-8,11,-7,-8,-13,6,-12,-8,2,4,3,9,10,-5,12,3,-6,-5,-6,7,8,-3,9,-8,2,-12,2,8,-11,-2,-10,3,-12,-13,-7,-9,-11,0,-10,-5,5,-3,11,8,-2,-13,-1,12,-1,-8,0,9,-13,-11,-12,-5,-10,-2,-10,11,-3,9,-2,-13,2,-3,3,2,-9,-13,-4,0,-4,6,-3,-10,-4,12,-2,-7,-6,-11,-4,9,6,-3,6,11,-13,11,-5,5,11,11,12,6,7,-5,12,-2,-1,12,0,7,-4,-8,-3,-2,-7,1,-6,7,-13,-12,-8,-13,-7,-2,-6,-8,-8,5,-6,-9,-5,-1,-4,5,-13,7,-8,10,1,5,5,-13,1,0,10,-13,9,12,10,-1,5,-8,10,-9,-1,11,1,-13,-9,-3,-6,2,-1,-10,1,12,-13,1,-8,-10,8,-11,10,-6,2,-13,3,-6,7,-13,12,-9,-10,-10,-5,-7,-10,-8,-8,-13,4,-6,8,5,3,12,8,-13,-4,2,-3,-3,5,-13,10,-12,4,-13,5,-1,-9,9,-4,3,0,3,3,-9,-12,1,-6,1,3,2,4,-8,-10,-10,-10,9,8,-13,12,12,-8,-12,-6,-5,2,2,3,7,10,6,11,-8,6,8,8,-12,-7,10,-6,5,-3,-9,-3,9,-1,-13,-1,5,-3,-7,-3,4,-8,-2,-8,3,4,2,12,12,2,-5,3,11,6,-9,11,-13,3,-1,7,12,11,-1,12,4,-3,0,-3,6,4,-11,4,12,2,-4,2,1,-10,-6,-8,1,-13,7,-11,1,-13,12,-11,-13,6,0,11,-13,0,-1,1,4,-13,3,-9,-2,-9,8,-6,-3,-13,-6,-8,-2,5,-9,8,10,2,7,3,-9,-1,-6,-1,-1,9,5,11,-2,11,-3,12,-8,3,0,3,5,-1,4,0,10,3,-6,4,5,-13,0,-10,5,5,8,12,11,8,9,9,-6,7,-4,8,-12,-10,4,-10,9,7,3,12,4,9,-7,10,-2,7,0,12,-2,-1,-6,0,-11]),c=new b.matrix_t(3,3,b.F32_t|b.C1_t),d=new b.matrix_t(32,32,b.U8_t|b.C1_t),e=function(a,d,e,f,g,h){var i=Math.cos(e),j=Math.sin(e);c.data[0]=i,c.data[1]=-j,c.data[2]=(-i+j)*h*.5+f,c.data[3]=j,c.data[4]=i,c.data[5]=(-j-i)*h*.5+g,b.imgproc.warp_affine(a,d,c,128)};return{describe:function(c,f,g,h){var j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=d.data,r=0;h.type&b.U8_t?h.resize(32,g,1):(h.type=b.U8_t,h.cols=32,h.rows=g,h.channel=1,h.allocate());var s=h.data,t=0;for(i=0;i<g;++i){for(k=f[i].x,l=f[i].y,m=f[i].angle,e(c,d,m,k,l,32),r=0,j=0;j<32;++j)n=q[528+32*a[r+1]+a[r]],r+=2,o=q[528+32*a[r+1]+a[r]],r+=2,p=n<o|0,n=q[528+32*a[r+1]+a[r]],r+=2,o=q[528+32*a[r+1]+a[r]],r+=2,p|=(n<o)<<1,n=q[528+32*a[r+1]+a[r]],r+=2,o=q[528+32*a[r+1]+a[r]],r+=2,p|=(n<o)<<2,n=q[528+32*a[r+1]+a[r]],r+=2,o=q[528+32*a[r+1]+a[r]],r+=2,p|=(n<o)<<3,n=q[528+32*a[r+1]+a[r]],r+=2,o=q[528+32*a[r+1]+a[r]],r+=2,p|=(n<o)<<4,n=q[528+32*a[r+1]+a[r]],r+=2,o=q[528+32*a[r+1]+a[r]],r+=2,p|=(n<o)<<5,
n=q[528+32*a[r+1]+a[r]],r+=2,o=q[528+32*a[r+1]+a[r]],r+=2,p|=(n<o)<<6,n=q[528+32*a[r+1]+a[r]],r+=2,o=q[528+32*a[r+1]+a[r]],r+=2,p|=(n<o)<<7,s[t+j]=p;t+=32}}}}();a.orb=c}(b.jsfeat),function(a){var b=a,c=function(){var a=b.imgproc.scharr_derivatives;return{track:function(c,d,e,f,g,h,i,j,k,l){void 0===i&&(i=30),void 0===j&&(j=new Uint8Array(g)),void 0===k&&(k=.01),void 0===l&&(l=1e-4);var m=.5*(h-1),n=h*h|0,o=n<<1,p=c.data,q=d.data,r=p[0].data,s=q[0].data,t=p[0].cols,u=p[0].rows,v=0,w=0,x=b.cache.get_buffer(n<<2),y=b.cache.get_buffer(o<<2),z=b.cache.get_buffer(u*(t<<1)<<2),A=new b.matrix_t(t,u,b.S32C2_t,z.data),B=x.i32,C=y.i32,D=z.i32,E=0,F=0,G=0,H=0,I=0,J=0,K=0,L=0,M=0,N=0,O=0,P=0,Q=0,R=0,S=0,T=0,U=0,V=0,W=0,X=0,Y=0,Z=0,$=0,_=0,aa=0,ba=0,ca=0,da=0,ea=0,fa=0,ga=0,ha=0,ia=0,ja=0,ka=0,la=0,ma=0,na=0,oa=0,pa=0,qa=0,ra=0,sa=0;for(k*=k;X<g;++X)j[X]=1;var ta=c.levels-1|0;for(_=ta;_>=0;--_)for(K=1/(1<<_),v=t>>_,w=u>>_,E=v<<1,r=p[_].data,s=q[_].data,ca=v-h|0,da=w-h|0,a(p[_],A),aa=0;aa<g;++aa)if(X=aa<<1,Y=X+1,L=e[X]*K,M=e[Y]*K,_==ta?(N=L,O=M):(N=2*f[X],O=2*f[Y]),f[X]=N,f[Y]=O,L-=m,M-=m,T=0|L,U=0|M,0==(Z=T<=0|T>=ca|U<=0|U>=da)){for(ea=L-T,fa=M-U,ia=(1-ea)*(1-fa)*16384+.5|0,ja=ea*(1-fa)*16384+.5|0,ka=(1-ea)*fa*16384+.5|0,la=16384-ia-ja-ka,pa=0,qa=0,ra=0,$=0;$<h;++$)for(F=($+U)*v+T|0,G=F<<1,H=$*h|0,I=H<<1,Z=0;Z<h;++Z,++F,++H,G+=2)ma=r[F]*ia+r[F+1]*ja+r[F+v]*ka+r[F+v+1]*la,ma=ma+256>>9,na=D[G]*ia+D[G+2]*ja+D[G+E]*ka+D[G+E+2]*la,na=na+8192>>14,oa=D[G+1]*ia+D[G+3]*ja+D[G+E+1]*ka+D[G+E+3]*la,oa=oa+8192>>14,B[H]=ma,C[I++]=na,C[I++]=oa,pa+=na*na,qa+=na*oa,ra+=oa*oa;if(pa*=1/(1<<20),qa*=1/(1<<20),ra*=1/(1<<20),sa=pa*ra-qa*qa,(ra+pa-Math.sqrt((pa-ra)*(pa-ra)+4*qa*qa))/o<l||sa<1.1920929e-7)0==_&&(j[aa]=0);else for(sa=1/sa,N-=m,O-=m,P=0,Q=0,ba=0;ba<i;++ba){if(V=0|N,W=0|O,0!=(Z=V<=0|V>=ca|W<=0|W>=da)){0==_&&(j[aa]=0);break}for(ea=N-V,fa=O-W,ia=(1-ea)*(1-fa)*16384+.5|0,ja=ea*(1-fa)*16384+.5|0,ka=(1-ea)*fa*16384+.5|0,la=16384-ia-ja-ka,ga=0,ha=0,$=0;$<h;++$)for(J=($+W)*v+V|0,H=$*h|0,I=H<<1,Z=0;Z<h;++Z,++J,++H)ma=s[J]*ia+s[J+1]*ja+s[J+v]*ka+s[J+v+1]*la,ma=ma+256>>9,ma-=B[H],ga+=ma*C[I++],ha+=ma*C[I++];if(ga*=1/(1<<20),ha*=1/(1<<20),R=(qa*ha-ra*ga)*sa,S=(qa*ga-pa*ha)*sa,N+=R,O+=S,f[X]=N+m,f[Y]=O+m,R*R+S*S<=k)break;if(ba>0&&Math.abs(R+P)<.01&&Math.abs(S+Q)<.01){f[X]-=.5*R,f[Y]-=.5*S;break}P=R,Q=S}}else 0==_&&(j[aa]=0);b.cache.put_buffer(x),b.cache.put_buffer(y),b.cache.put_buffer(z)}}}();a.optical_flow_lk=c}(b.jsfeat),function(a){var b=function(){var a=function(a,b){var c=.25*a.width+.5|0;return b.x<=a.x+c&&b.x>=a.x-c&&b.y<=a.y+c&&b.y>=a.y-c&&b.width<=1.5*a.width+.5|0&&1.5*b.width+.5|0>=a.width};return{edges_density:.07,group_rectangles:function(b,c){void 0===c&&(c=1);var d,e,f=b.length,g=[];for(d=0;d<f;++d)g[d]={parent:-1,element:b[d],rank:0};for(d=0;d<f;++d)if(g[d].element){for(var h=d;-1!=g[h].parent;)h=g[h].parent;for(e=0;e<f;++e)if(d!=e&&g[e].element&&a(g[d].element,g[e].element)){for(var i=e;-1!=g[i].parent;)i=g[i].parent;if(i!=h){g[h].rank>g[i].rank?g[i].parent=h:(g[h].parent=i,g[h].rank==g[i].rank&&g[i].rank++,h=i);for(var j,k=e;-1!=g[k].parent;)j=k,k=g[k].parent,g[j].parent=h;for(k=d;-1!=g[k].parent;)j=k,k=g[k].parent,g[j].parent=h}}}var l=[],m=0;for(d=0;d<f;d++){e=-1;var n=d;if(g[n].element){for(;-1!=g[n].parent;)n=g[n].parent;g[n].rank>=0&&(g[n].rank=~m++),e=~g[n].rank}l[d]=e}var o=[];for(d=0;d<m+1;++d)o[d]={neighbors:0,x:0,y:0,width:0,height:0,confidence:0};for(d=0;d<f;++d){var p=b[d],q=l[d];0==o[q].neighbors&&(o[q].confidence=p.confidence),++o[q].neighbors,o[q].x+=p.x,o[q].y+=p.y,o[q].width+=p.width,o[q].height+=p.height,o[q].confidence=Math.max(o[q].confidence,p.confidence)}var r=[];for(d=0;d<m;++d)(f=o[d].neighbors)>=c&&r.push({x:(2*o[d].x+f)/(2*f),y:(2*o[d].y+f)/(2*f),width:(2*o[d].width+f)/(2*f),height:(2*o[d].height+f)/(2*f),neighbors:o[d].neighbors,confidence:o[d].confidence});var s=[];for(f=r.length,d=0;d<f;++d){var p=r[d],t=!0;for(e=0;e<f;++e){var u=r[e],v=.25*u.width+.5|0;if(d!=e&&p.x>=u.x-v&&p.y>=u.y-v&&p.x+p.width<=u.x+u.width+v&&p.y+p.height<=u.y+u.height+v&&(u.neighbors>Math.max(3,p.neighbors)||p.neighbors<3)){t=!1;break}}t&&s.push(p)}return s}}}();a.haar=b}(b.jsfeat),function(a){var b=a,c=function(){var a=function(a,b){var c=.25*a.width+.5|0;return b.x<=a.x+c&&b.x>=a.x-c&&b.y<=a.y+c&&b.y>=a.y-c&&b.width<=1.5*a.width+.5|0&&1.5*b.width+.5|0>=a.width};new b.pyramid_t(1);return{interval:4,scale:1.1486,next:5,scale_to:1,detect:function(a,b){var c,d,e,f,g,h=this.scale,i=this.next,j=this.scale_to,k=0,l=0,m=0,n=0,o=0,p=0,q=0,r=0,s=0,t=0,u=0,v=0,w=0,x=0,y=0,z=0,A=0,B=0,C=!0,D=!0,E=1,F=1,G=[0,1,0,1],H=[0,0,1,1],I=[],J=a.data,K=[],L=[0,0,0],M=[0,0,0],N=[0,0,0];for(k=0;k<j;k++){for(y=k<<2,z=J[y+(i<<3)].cols-(b.width>>2),A=J[y+(i<<3)].rows-(b.height>>2),M[0]=1*J[y].cols,M[1]=1*J[y+(i<<2)].cols,M[2]=1*J[y+(i<<3)].cols,N[0]=4*J[y].cols-4*z,N[1]=2*J[y+(i<<2)].cols-2*z,N[2]=1*J[y+(i<<3)].cols-1*z,r=b.stage_classifier.length,l=0;l<r;l++)for(e=b.stage_classifier[l].feature,d=b.stage_classifier[l]._feature,s=b.stage_classifier[l].count,m=0;m<s;m++)for(f=d[m],g=e[m],t=0|g.size,q=0;q<t;q++)f.px[q]=1*g.px[q]+g.py[q]*M[g.pz[q]],f.pz[q]=g.pz[q],f.nx[q]=1*g.nx[q]+g.ny[q]*M[g.nz[q]],f.nz[q]=g.nz[q];for(K[0]=J[y].data,K[1]=J[y+(i<<2)].data,q=0;q<4;q++)for(K[2]=J[y+(i<<3)+q].data,L[0]=2*G[q]+H[q]*(2*J[y].cols),L[1]=1*G[q]+H[q]*(1*J[y+(i<<2)].cols),L[2]=0,p=0;p<A;p++){for(o=0;o<z;o++){for(B=0,C=!0,r=b.stage_classifier.length,l=0;l<r;l++){for(B=0,c=b.stage_classifier[l].alpha,d=b.stage_classifier[l]._feature,s=b.stage_classifier[l].count,m=0;m<s;m++)if(f=d[m],v=K[f.pz[0]][L[f.pz[0]]+f.px[0]],w=K[f.nz[0]][L[f.nz[0]]+f.nx[0]],v<=w)B+=c[m<<1];else{for(D=!0,t=f.size,x=1;x<t;x++){if(f.pz[x]>=0&&(u=K[f.pz[x]][L[f.pz[x]]+f.px[x]])<v){if(u<=w){D=!1;break}v=u}if(f.nz[x]>=0&&(n=K[f.nz[x]][L[f.nz[x]]+f.nx[x]])>w){if(v<=n){D=!1;break}w=n}}B+=D?c[1+(m<<1)]:c[m<<1]}if(B<b.stage_classifier[l].threshold){C=!1;break}}C&&(I.push({x:(4*o+2*G[q])*E,y:(4*p+2*H[q])*F,width:b.width*E,height:b.height*F,neighbor:1,confidence:B}),++o,L[0]+=4,L[1]+=2,L[2]+=1),L[0]+=4,L[1]+=2,L[2]+=1}L[0]+=N[0],L[1]+=N[1],L[2]+=N[2]}E*=h,F*=h}return I},group_rectangles:function(b,c){void 0===c&&(c=1);var d,e,f=b.length,g=[];for(d=0;d<f;++d)g[d]={parent:-1,element:b[d],rank:0};for(d=0;d<f;++d)if(g[d].element){for(var h=d;-1!=g[h].parent;)h=g[h].parent;for(e=0;e<f;++e)if(d!=e&&g[e].element&&a(g[d].element,g[e].element)){for(var i=e;-1!=g[i].parent;)i=g[i].parent;if(i!=h){g[h].rank>g[i].rank?g[i].parent=h:(g[h].parent=i,g[h].rank==g[i].rank&&g[i].rank++,h=i);for(var j,k=e;-1!=g[k].parent;)j=k,k=g[k].parent,g[j].parent=h;for(k=d;-1!=g[k].parent;)j=k,k=g[k].parent,g[j].parent=h}}}var l=[],m=0;for(d=0;d<f;d++){e=-1;var n=d;if(g[n].element){for(;-1!=g[n].parent;)n=g[n].parent;g[n].rank>=0&&(g[n].rank=~m++),e=~g[n].rank}l[d]=e}var o=[];for(d=0;d<m+1;++d)o[d]={neighbors:0,x:0,y:0,width:0,height:0,confidence:0};for(d=0;d<f;++d){var p=b[d],q=l[d];0==o[q].neighbors&&(o[q].confidence=p.confidence),++o[q].neighbors,o[q].x+=p.x,o[q].y+=p.y,o[q].width+=p.width,o[q].height+=p.height,o[q].confidence=Math.max(o[q].confidence,p.confidence)}var r=[];for(d=0;d<m;++d)(f=o[d].neighbors)>=c&&r.push({x:(2*o[d].x+f)/(2*f),y:(2*o[d].y+f)/(2*f),width:(2*o[d].width+f)/(2*f),height:(2*o[d].height+f)/(2*f),neighbors:o[d].neighbors,confidence:o[d].confidence});var s=[];for(f=r.length,d=0;d<f;++d){var p=r[d],t=!0;for(e=0;e<f;++e){var u=r[e],v=.25*u.width+.5|0;if(d!=e&&p.x>=u.x-v&&p.y>=u.y-v&&p.x+p.width<=u.x+u.width+v&&p.y+p.height<=u.y+u.height+v&&(u.neighbors>Math.max(3,p.neighbors)||p.neighbors<3)){t=!1;break}}t&&s.push(p)}return s}}}();a.bbf=c}(b.jsfeat),function(b){if(void 0===a||void 0===a.exports){usenamespace("editor.utils").jsfeat=b}else a.exports.jsfeat=b}(b.jsfeat)}()},function(a,b,c){"use strict";(function(a){function b(a){return a&&a.__esModule?a:{"default":a}}var d=c(4),e=b(d),f=c(22),g=b(f);!function(){function b(a,b){Object.defineProperty(this,"centerX",{get:this.getCenterX}),Object.defineProperty(this,"centerY",{get:this.getCenterY}),Object.defineProperty(this,"dimension",{get:this.getDimension}),Object.defineProperty(this,"uiRotation",{get:this.getUIRotation}),Object.defineProperty(this,"screenBounds",{get:this.getScreenBounds}),Object.defineProperty(this,"isHorizontal",{get:this.getIsHorizontal}),Object.defineProperty(this,"isReverseRatio",{get:this.getIsReverseRatio}),Object.defineProperty(this,"isNearInitImageSize",{get:this.getIsNearInitImageSize}),Object.defineProperty(this,"isNearInitImageWidth",{get:this.getIsNearInitImageWidth}),Object.defineProperty(this,"isNearInitImageHeight",{get:this.getIsNearInitImageHeight}),Object.defineProperty(this,"offsetX",{get:this.getOffsetX,set:this.setOffsetX}),Object.defineProperty(this,"offsetY",{get:this.getOffsetY,set:this.setOffsetY}),Object.defineProperty(this,"isMinimum",{get:function(){return this._isMinimum}}),Object.defineProperty(this,"isEditable",{get:function(){return this._isEditable}}),Object.defineProperty(this,"viewport",{get:this.getViewport,set:this.setViewport}),Object.defineProperty(this,"isChanged",{get:this.getIsChanged,set:this.setIsChanged}),Object.defineProperty(this,"isNewChanged",{get:this.getIsNewChanged,set:this.setIsNewChanged}),Object.defineProperty(this,"isChangeUIRotation",{get:this.getIsChangeUIRotation}),Object.defineProperty(this,"imageRotation",{get:this.getImageRotation,set:this.setImageRotation}),Object.defineProperty(this,"snapImageRotation",{get:this.getSnapImageRotation}),Object.defineProperty(this,"stageRotation",{get:this.getStageRotation,set:this.setStageRotation}),PIXI.Container.call(this),this.canvas=a,this.options=k.Func.getDefaultParameters(b,{offsetX:0,offsetY:0,paddingX:0,paddingY:0,viewport:{x:0,y:0,width:this.canvas.width,height:this.canvas.height}}),this.initialize(b)}var d=c(316),f=c(318),h=c(319),i=c(321),j=c(182),k=(c(25).default,{});k.Func=c(34),k.Calc=c(61),k.Painter=c(133),k.Mouse=c(75);var l={};l.KeyCode=c(183),l.HitSide=c(96);var m=c(62).cancelAnimFrame,n=c(62).animationLoop;b.UI_CHANGE="uiChange",b.UI_MOVE_START="uiMoveStart",b.UI_MOVE="uiMove",b.UI_MOVE_END="uiMoveEnd",b.ROTATE_START="rotateStart",b.ROTATE="rotate",b.ROTATE_END="rotateEnd",b.MOVE_START="moveStart",b.MOVE="move",b.MOVE_END="moveEnd",b.CHANGE_CURSOR="changeCursor",b.CHANGE_ASPECT_RATIO="changeAspectRatio",b.ASPECT_RATIO_MOTION_START="aspectRatioMotionStart",b.RESET="reset",b.RESET_COMPLETE="resetComplete";var o=b.prototype=(0,g.default)(PIXI.Container.prototype);o.initialize=function(a){this.isChanged=!1,this._stageRotation=0,this._imageRotation=0,this.imageRotateSpace=.1,this.uiExpandSpace=6,this.magnifyLimitSpace=10,this._useMagnifyLimit=!1,this.errorRange=4,this.editableSize=60,this.minimumSize=200,this._isEditable=!0,this._isMinimum=!1,this._isResetAnimation=!1,this._hasEventListener=!1,this._isMagnifyAnimation=!1,this.viewport=a.viewport,this.aspectRatioAllowableSize=30,this.offsetX=k.Func.getDefaultParameters(a.offsetX,0),this.offsetY=k.Func.getDefaultParameters(a.offsetY,0),this.paddingX=k.Func.getDefaultParameters(this.options.paddingX,0),this.paddingY=k.Func.getDefaultParameters(this.options.paddingY,0),this.aspectRatioType=k.Func.getDefaultParameters(a.aspectRatioType,null),a.cursorDefaultColor=k.Func.getDefaultParameters(a.cursorDefaultColor,16777215),a.cursorAspectRatioColor=k.Func.getDefaultParameters(a.cursorAspectRatioColor,51004),this.cursorDefaultColor=a.cursorDefaultColor,this.cursorAspectRatioColor=a.cursorAspectRatioColor},o.addDebug=function(){this.gTest||(this.gTest=new PIXI.Graphics,this.gImage=new PIXI.Graphics,this.gBounds=new PIXI.Graphics,this.addChild(this.gTest),this.addChild(this.gImage),this.addChild(this.gBounds))},o.start=function(a,b,c,e,g){if(this.canvas=a,this.aspectRatio=0,this.aspectRatioWidth=0,this.aspectRatioHeight=0,this.isNewChanged=!1,this._useMagnifyLimit=!1,this._resize=g,this.bitmapdata=b,this.limitRotation=k.Calc.RADIAN_45,this.maxRotation=this.limitRotation,this.minRotation=-this.limitRotation,this.image?(this.image.reset(b),this.moveUI.reset(this.options),this.ui.reset(this.image,this.options),this.rotateUI.reset(this.canvas,this.viewport,this.image,this.options)):(this.image=new d(b),this.moveUI=new f(this.options),this.ui=new h(this.image,this.options),this.rotateUI=new i(this.canvas,this.viewport,this.image,this.options),this.addChild(this.image),this.addChild(this.rotateUI),this.addChild(this.moveUI),this.addChild(this.ui),this.addEvent()),this.resetImage(),this._isMinimum=this.isMinimunSize(this.minimumSize),this._isEditable=this.isEditableSize(this.editableSize),this.isEditable?(this.addEvent(),this.enableCursor(),this.disableCurrentCursor()):(this.removeEvent(),this.disableCursor(),this.enableCurrentCursor("default")),this.emit("uiChange",{}),null!==c)this.restore(c);else if(null!==this.aspectRatioType){var j=this.parseAspectRatioType(this.aspectRatioType);this.changeAspectRatio(j[0],j[1],!1),this.isChanged=!0,this.isNewChanged=!0}this.applyExternalRotate(e)},o.parseAspectRatioType=function(a){return a=a.toLowerCase(),a=0===a.length?"free":a,a.indexOf(":")>-1?a.split(":"):"free"===a?[0,0]:"original"===a?[this.originalImageWidth,this.originalImageHeight]:[0,0]},o.suspend=function(){},o.setMask=function(a){this.image.setMask(a)},o.removeMask=function(){return this.image.removeMask()},o.addContainer=function(a){this.image.image.addChild(a)},o.addEvent=function(){!0!==this._hasEventListener&&(this._hasEventListener=!0,this._imageMoveStartListener=this.imageMoveStart.bind(this),this._imageMoveListener=this.imageMove.bind(this),this._imageMoveEndListener=this.imageMoveEnd.bind(this),this._imageRotateStartListener=this.imageRotateStart.bind(this),this._imageRotateListener=this.imageRotate.bind(this),this._imageRotateEndListener=this.imageRotateEnd.bind(this),this._uiChangeListener=this.uiChange.bind(this),this._cornerMoveStartListener=this.cornerMoveStart.bind(this),this._cornerMoveListener=this.cornerMove.bind(this),this._cornerMoveEndListener=this.cornerMoveEnd.bind(this),this._controlMoveStartListener=this.controlMoveStart.bind(this),this._controlMoveListener=this.controlMove.bind(this),this._controlMoveEndListener=this.controlMoveEnd.bind(this),this._changeCursorListener=this.changeCursor.bind(this),this.moveUI.on(f.MOVE_START,this._imageMoveStartListener),this.moveUI.on(f.MOVE,this._imageMoveListener),this.moveUI.on(f.MOVE_END,this._imageMoveEndListener),this.rotateUI.on(i.ROTATE_START,this._imageRotateStartListener),this.rotateUI.on(i.ROTATE,this._imageRotateListener),this.rotateUI.on(i.ROTATE_END,this._imageRotateEndListener),this.ui.on(h.UI_CHANGE,this._uiChangeListener),this.ui.on(h.CORNER_MOVE_START,this._cornerMoveStartListener),this.ui.on(h.CORNER_MOVE,this._cornerMoveListener),this.ui.on(h.CORNER_MOVE_END,this._cornerMoveEndListener),this.ui.on(h.CONTROL_MOVE_START,this._controlMoveStartListener),this.ui.on(h.CONTROL_MOVE,this._controlMoveListener),this.ui.on(h.CONTROL_MOVE_END,this._controlMoveEndListener),this.ui.on(h.CHANGE_CURSOR,this._changeCursorListener))},o.removeEvent=function(){!1!==this._hasEventListener&&(this._hasEventListener=!1,this.moveUI.off(f.MOVE_START,this._imageMoveStartListener),this.moveUI.off(f.MOVE,this._imageMoveListener),this.moveUI.off(f.MOVE_END,this._imageMoveEndListener),this.rotateUI.off(i.ROTATE_START,this._imageRotateStartListener),this.rotateUI.off(i.ROTATE,this._imageRotateListener),this.rotateUI.off(i.ROTATE_END,this._imageRotateEndListener),this.ui.off(h.UI_CHANGE,this._uiChangeListener),this.ui.off(h.CORNER_MOVE_START,this._cornerMoveStartListener),this.ui.off(h.CORNER_MOVE,this._cornerMoveListener),this.ui.off(h.CORNER_MOVE_END,this._cornerMoveEndListener),this.ui.off(h.CONTROL_MOVE_START,this._controlMoveStartListener),this.ui.off(h.CONTROL_MOVE,this._controlMoveListener),this.ui.off(h.CONTROL_MOVE_END,this._controlMoveEndListener),this.ui.off(h.CHANGE_CURSOR,this._changeCursorListener),this._imageMoveStartListener=null,this._imageMoveListener=null,this._imageMoveEndListener=null,this._imageRotateStartListener=null,this._imageRotateListener=null,this._imageRotateEndListener=null,this._uiChangeListener=null,this._cornerMoveStartListener=null,this._cornerMoveListener=null,this._cornerMoveEndListener=null,this._controlMoveStartListener=null,this._controlMoveListener=null,this._controlMoveEndListener=null,this._changeCursorListener=null)},o.resize=function(){this.image&&(this.setInitImageSize(),this.magnifyImage(),this.moveUI.setSize(this.ui.bounds),this.rotateUI.resize(),this.updateDimed())},o.setImagePivot=function(a){a=k.Func.getDefaultParameters(a,{x:this.centerX,y:this.centerY}),this.image.setPivotByGlobalPoint(a)},o.crop=function(a,b){var c={};this.setImagePivot();var d=this.ui.getActualPixelWidth(),e=this.ui.getActualPixelHeight();if(this.stageRotation===-k.Calc.RADIAN_90){var f=this.image.getLocal(this.ui.lb);c.x=0,c.y=e,c.offsetX=f.x,c.offsetY=f.y}else if(this.stageRotation===-k.Calc.RADIAN_180){var g=this.image.getLocal(this.ui.rb);c.x=d,c.y=e,c.offsetX=g.x,c.offsetY=g.y}else{var h=this.image.getLocal(this.ui.lt);c.x=0,c.y=0,c.offsetX=h.x,c.offsetY=h.y}c.canvasWidth=d,c.canvasHeight=e,c.scaleX=1,c.scaleY=1,c.rotation=k.Calc.toDegrees(this.imageRotation),c.stageRotation=k.Calc.toDegrees(this.stageRotation);for(var i in c)b[i]=c[i];return{uiRestoreVO:this.ui.bounds,imageRestoreVO:this.image.getRestoreData(),rotation:this.imageRotation,stageRotation:this.stageRotation}},o.cropByMatrix=function(a){var b=this.getImageSizeByBitmapData(a),c={};return c.canvasWidth=b.width,c.canvasHeight=b.height,c.scaleX=this.image.image.scale.x,c.scaleY=this.image.image.scale.y,c.offsetX=b.offsetX,c.offsetY=b.offsetY,c.radian=this.snapImageRotation,c};var p=new PIXI.Matrix;o.getImageSizeByBitmapData=function(a){this.updateTransform();var b=this.ui.points,c=this.image.image.worldTransform.clone();p.a=a,p.d=a,c.append(p);var d=k.Calc.toLocalPoints(c,b),e=k.Calc.getSizeByPoints(d),f=e.width,g=e.height,h=Math.round(d.lt.x),i=Math.round(d.lt.y);if(h=h<0?0:h,i=i<0?0:i,0==this.isChangeUIRotation&&0!=this.aspectRatio){var j=this.getRealOffset(h,i,f,g);f>this.originalImageWidth-j.x-this.errorRange&&(f=this.originalImageWidth-j.x,g=f/this.aspectRatio),g>this.originalImageHeight-j.y-this.errorRange&&(g=this.originalImageHeight-j.y,f=g*this.aspectRatio)}else f>this.originalImageWidth-this.errorRange&&(f=this.originalImageWidth,0!=this.aspectRatio&&(g=f/this.aspectRatio)),g>this.originalImageHeight-this.errorRange&&(g=this.originalImageHeight,0!=this.aspectRatio&&(f=g*this.aspectRatio));return{width:f+.5|0,height:g+.5|0,offsetX:h,offsetY:i}},o.getIsChangeUIRotation=function(){return 0!=k.Calc.getModulusDegreesByRadians(this.snapImageRotation,90)},o.getRealOffset=function(a,b,c,d){var e=a,f=b,g=this.originalImageWidth,h=this.originalImageHeight;switch(k.Calc.getModulusDegreesByRadians(this.stageRotation,360)){case 0:default:this.image.isFlipX&&(e=g-e),this.image.isFlipY&&(f=h-f);break;case 90:case-270:e=g-b,f=a,this.image.isFlipY&&(e=g-e),this.image.isFlipX&&(f=h-f);break;case 180:case-180:e=g-a,f=h-b,this.image.isFlipX&&(e=g-e),this.image.isFlipY&&(f=h-f);break;case-90:case 270:e=b,f=h-a,this.image.isFlipY&&(e=g-e),this.image.isFlipX&&(f=h-f)}return{x:e,y:f}},o.getCropVO=function(){return this.ui?{uiRestoreVO:this.ui.bounds,imageRestoreVO:this.image.getRestoreData(),rotation:this.snapImageRotation,stageRotation:this.stageRotation,aspectRatioVO:{aspectRatio:this.aspectRatio,aspectRatioWidth:this.aspectRatioWidth,aspectRatioHeight:this.aspectRatioHeight},originalImageWidth:this.originalImageWidth,originalImageHeight:this.originalImageHeight}:null},o.restore=function(a){if(a){this.resetWithoutMotion(),this._isChanged=!0;var c=a.stageRotation,d=a.uiRestoreVO,e=a.imageRestoreVO,f=a.aspectRatioVO;this.aspectRatio=f.aspectRatio,this.aspectRatioWidth=f.aspectRatioWidth,this.aspectRatioHeight=f.aspectRatioHeight,this.changeCornerColor(this.aspectRatioWidth,this.aspectRatioHeight),this.originalImageWidth=a.originalImageWidth,this.originalImageHeight=a.originalImageHeight,this.imageAspectRatio=k.Calc.getAspectRatio(this.originalImageWidth,this.originalImageHeight),this.ui.setSize(d),this.image.setRestoreData(e),this.imageRotation=e.rotation,this.image.resetLt();for(var g=c>0,h=k.Calc.getRotateCountByRadians(c),i=0;i<h;i++)this.image.rotatePoints(g),this.image.rotateLt(g);this.image.restoreFlip(e),this.image.updatePrevLtPointForPivot(),this.setImagePivot(),this.stageRotation=c,this.maxRotation=this.stageRotation+this.limitRotation,this.minRotation=this.stageRotation-this.limitRotation,this.magnifyImage();var j=this.ui.bounds;this.moveUI.setSize(j),this.setImagePivot(),this.image.showDimed(),this.emit(b.ROTATE,{rotation:k.Calc.toDegrees(this.uiRotation)})}},o.reset=function(){!1!==this.isChanged&&(this.aspectRatio=0,this.aspectRatioWidth=0,this.aspectRatioHeight=0,0!==this.stageRotation?this.resetImage():this.resetImageWithMotion(),this.ui.changeCornerColor(this.cursorDefaultColor))},o.resetWithoutMotion=function(){!1!==this.isChanged&&(this.aspectRatio=0,this.aspectRatioWidth=0,this.aspectRatioHeight=0,this.resetImage(),this.ui.changeCornerColor(this.cursorDefaultColor))},o.resetImage=function(){this.isChanged=!1,this.setInitImageSize(),this.maxZoom=k.Calc.getScale({width:this.ui.minSize*this.image.scale.x,height:this.ui.minSize*this.image.scale.y},this.screenBounds).min,this.maxSize={width:this.image.width*this.maxZoom,height:this.image.height*this.maxZoom},this.imageRotation=0,this.image.resetFlip(),this.image.resetLt(),this.image.pivot={x:0,y:0},this.image.x=this.centerX,this.image.y=this.centerY,this.image.width=this.initSize.width,this.image.height=this.initSize.height,this.image.updatePrevLtPointForPivot(),this.ui.setSize(this.image.bounds),this.moveUI.setSize(this.ui.bounds),this.rotateUI.resize(),this.stageRotation=0,this.maxRotation=this.stageRotation+this.limitRotation,this.minRotation=this.stageRotation-this.limitRotation,this.updateDimed(),this.hideGridAndDimed(!0),this.originalImageWidth=this.bitmapdata.sourceWidth,this.originalImageHeight=this.bitmapdata.sourceHeight,this.imageAspectRatio=k.Calc.getAspectRatio(this.originalImageWidth,this.originalImageHeight),this.emit(b.RESET_COMPLETE),this.emit(b.ROTATE,{rotation:k.Calc.toDegrees(this.uiRotation)})},o.resetImageWithMotion=function(){!0!==this._isResetAnimation&&(this._isResetAnimation=!0,m(this.resetAnimationId),this.setInitImageSize(),this._tFrom=this.ui.bounds,this._tFrom.imageX=this.image.pivot.x,this._tFrom.imageY=this.image.pivot.y,this._tFrom.imageWidth=this.image.width,this._tFrom.imageHeight=this.image.height,this._tFrom.imageRotation=this.imageRotation,this._tTo={imageX:0,imageY:0,imageRotation:0,imageWidth:this.initSize.width,imageHeight:this.initSize.height,x:this.centerX-this.initSize.width/2,y:this.centerY-this.initSize.height/2,width:this.initSize.width,height:this.initSize.height},this._tCurt=k.Calc.copyObject(this._tFrom),this.resetAnimationId=n(this.resetAnimation.bind(this),18,"easeOutQuad",function(){},function(){this.resetImage(),this._isResetAnimation=!1,this.emit(b.ROTATE,{rotation:k.Calc.toDegrees(this.uiRotation)})},this))},o.resetAnimation=function(a,c,d){for(var e in this._tCurt)this._tCurt[e]=k.Calc.getTweenValueByObject(e,this._tFrom,this._tTo,a);this.ui.setSize(this._tCurt),this.image.pivot.x=this._tCurt.imageX,this.image.pivot.y=this._tCurt.imageY,this.image.width=this._tCurt.imageWidth,this.image.height=this._tCurt.imageHeight,this.imageRotation=this._tCurt.imageRotation,this.image.updatePrevLtPointForPivot(),this.updateDimed(),this.emit(b.RESET),this.emit(b.ROTATE,{rotation:k.Calc.toDegrees(this.uiRotation)})},o.applyExternalRotate=function(a){if(0!==a)for(var b=a>0,c=k.Calc.getRotateCountByDegrees(a),d=0;d<c;d++)this.rotate(b)},o.rotate=function(a){a=k.Func.getDefaultParameters(a,!1),this.isChanged=!0,this.setImagePivot();var c=this.aspectRatioWidth,d=this.aspectRatioHeight;this.aspectRatioWidth=d,this.aspectRatioHeight=c,this.aspectRatio=k.Calc.getAspectRatio(this.aspectRatioWidth,this.aspectRatioHeight),this.emit(b.CHANGE_ASPECT_RATIO,{width:this.aspectRatioWidth,height:this.aspectRatioHeight});var e=this.originalImageWidth,f=this.originalImageHeight;this.originalImageWidth=f,this.originalImageHeight=e,this.imageAspectRatio=k.Calc.getAspectRatio(this.originalImageWidth,this.originalImageHeight);var g,h,i,j;a?(g=this.image.getLocal(this.ui.lb),h=this.image.getLocal(this.ui.lt),i=this.image.getLocal(this.ui.rt),j=this.image.getLocal(this.ui.rb)):(g=this.image.getLocal(this.ui.rt),h=this.image.getLocal(this.ui.rb),i=this.image.getLocal(this.ui.lb),j=this.image.getLocal(this.ui.lt));var l=a?k.Calc.RADIAN_90:-k.Calc.RADIAN_90,m=this.snapImageRotation+l;this.imageRotation=k.Calc.toRoundRadiansByRadians(m),this.image.rotatePoints(a),this.image.rotateLt(a);var n={lt:this.image.getGlobal(g),rt:this.image.getGlobal(h),rb:this.image.getGlobal(i),lb:this.image.getGlobal(j)},o=this.ui.pointsToBounds(n),p=k.Calc.getScale(o,this.screenBounds).min;this.image.width=this.image.width*p,this.image.height=this.image.height*p,this.image.updatePrevLtPointForPivot(),this.setImagePivot();var q=k.Calc.getSizeFitInBounds(o,this.screenBounds);q.x=this.centerX-q.width/2,q.y=this.centerY-q.height/2,q=this.ui.fixBounds(q),this.ui.setSize(q),this.moveUI.setSize(this.ui.bounds),this.uiPoints=this.ui.points,this.updateDimed(),this.stageRotation+=l,this.maxRotation=this.stageRotation+this.limitRotation,this.minRotation=this.stageRotation-this.limitRotation,this.emit(b.UI_CHANGE,{bounds:q,dimension:this.dimension})},o.autoRotate=function(a){!1===this.isEditable||this.isMinimum||0===this.imageRotation&&(this.isChanged=!0,this.rotateWithMotion(a))},o.rotateWithMotion=function(a){m(this.rotateAnimationId),this.imageRotateStart(),this._rotationFrom=this.imageRotation,this._rotationTo=a,this._rotationCurt=this._rotationFrom,this.rotateAnimationId=n(this.rotateAnimation.bind(this),8,"easeOutQuad",function(){},function(){this.imageRotation=this._rotationTo,this.imageRotateEnd()},this)},o.rotateAnimation=function(a,b,c){this._rotationCurt=k.Calc.getTweenValue(this._rotationFrom,this._rotationTo,a),this.imageRotateByRadian(this._rotationCurt)},o.uiFix=function(){0!==this.image.getHitPoints(this.ui.points).length&&this.ui.fix()},o.magnifyImage=function(a,b){a=k.Func.getDefaultParameters(a,this.ui.bounds),b=k.Func.getDefaultParameters(b,this.screenBounds);var c=k.Calc.getScale(a,b).min,d=this.image.lt.x-a.x,e=this.image.lt.y-a.y,f=k.Calc.getSizeFitInBounds(a,b);f.x=this.centerX-f.width/2,f.y=this.centerY-f.height/2,this.ui.setSize(f),this.image.width=this.image.width*c,this.image.height=this.image.height*c;var g=d*c,h=e*c,i=this.image.x-this.image.lt.x,j=this.image.y-this.image.lt.y;this.image.x=f.x+g+i,this.image.y=f.y+h+j,this.image.updatePrevLtPointForPivot(),this.uiFix(),this.setCornerLimit()},o.magnifyImageWithMotion=function(a,b,c){if(!0!==this._isMagnifyAnimation){this._isMagnifyAnimation=!0,m(this.magnifyAnimationId),b=k.Func.getDefaultParameters(b,this.ui.bounds),c=k.Func.getDefaultParameters(c,this.screenBounds);var d=k.Calc.getScale(b,c).min,e=k.Calc.getSizeFitInBounds(b,c);switch(e.x=this.centerX-e.width/2,e.y=this.centerY-e.height/2,this._tFrom=this.ui.bounds,this._tFrom.imageWidth=this.image.width,this._tFrom.imageHeight=this.image.height,this._tTo={x:e.x,y:e.y,width:e.width,height:e.height,imageWidth:this.image.width*d,imageHeight:this.image.height*d},a){case this.ui.lt:this.standardTarget=this.ui.rb,this.setImagePivot({x:this.standardTarget.x,y:this.standardTarget.y});break;case this.ui.rt:this.standardTarget=this.ui.lb,this.setImagePivot({x:this.standardTarget.x,y:this.standardTarget.y});break;case this.ui.rb:this.standardTarget=this.ui.lt,this.setImagePivot({x:this.standardTarget.x,y:this.standardTarget.y});break;case this.ui.lb:this.standardTarget=this.ui.rt,this.setImagePivot({x:this.standardTarget.x,y:this.standardTarget.y});break;case this.ui.left:case this.ui.top:this.standardTarget=this.ui.rb,this.setImagePivot({x:this.standardTarget.x,y:this.standardTarget.y});break;case this.ui.right:this.standardTarget=this.ui.lb,this.setImagePivot({x:this.standardTarget.x,y:this.standardTarget.y});break;case this.ui.bottom:this.standardTarget=this.ui.rt,this.setImagePivot({x:this.standardTarget.x,y:this.standardTarget.y})}this._tCurt=k.Calc.copyObject(this._tFrom),this.magnifyAnimationId=n(this.magnifyAnimation.bind(this),8,"easeOutSine",function(){},function(){this.ui.setSize(this._tTo,!1),this.image.width=this._tTo.imageWidth,this.image.height=this._tTo.imageHeight;var a=this.image.toGlobal(this.image.pivot);this.image.x+=this.standardTarget.x-a.x,this.image.y+=this.standardTarget.y-a.y,this.image.updatePrevLtPointForPivot(),this._isMagnifyAnimation=!1,this.uiMoveEnd(!1)},this),this.uiFix(),this.setCornerLimit()}},o.magnifyAnimation=function(a,b,c){for(var d in this._tCurt)this._tCurt[d]=k.Calc.getTweenValueByObject(d,this._tFrom,this._tTo,a);this.ui.setSize(this._tCurt,!1),this.image.width=this._tCurt.imageWidth,this.image.height=this._tCurt.imageHeight;var e=this.image.toGlobal(this.image.pivot);this.image.x+=this.standardTarget.x-e.x,this.image.y+=this.standardTarget.y-e.y,this.updateDimed(),this.setCornerLimit()},o.showGridAndDimed=function(){this.ui.showGrid(),this.image.showDimed(),this.updateGridAndDimed()},o.updateDimed=function(a){this.image.drawDimed(this.ui.imageBasedLocalPoints,a)},o.updateGridAndDimed=function(a){a=k.Func.getDefaultParameters(a,3),this.ui.drawGrid(a),this.image.drawDimed(this.ui.imageBasedLocalPoints)},o.hideGridAndDimed=function(a){this.ui.hideGrid(a),this.image.hideDimed(),this.image.drawDimed(this.ui.imageBasedLocalPoints)},o.changeAspectRatio=function(a,c,d){if(!1!==this.isEditable){var e=k.Calc.getAspectRatio(a,c),d=k.Func.getDefaultParameters(d,!0);if(this.aspectRatio!==e){this.isChanged=!0,this.setImagePivot(),this.aspectRatioWidth=a,this.aspectRatioHeight=c,this.aspectRatio=e;var f=this.ui.bounds;if(e===k.Calc.getAspectRatio(f.width,f.height))return void(0===a&&0===c||(this.updateDimed(),this.changeCornerColor(a,c)));if(0!==a||0!==c){f.width=k.Calc.getWidthByAspectRatio(this.aspectRatio,f.height);var g=k.Calc.getPointsByBounds(f),h={x:this.image.x,y:this.image.y},i=k.Calc.getRotationPoints(h,g,k.Calc.toDegrees(this.imageRotation)),j=k.Calc.getBoundsByRotationPoints(i),l=k.Calc.getScale(this.image,j),o=this.image.width,p=this.image.height,q=o*l.max,r=p*l.max;o<=q&&p<=r&&(this.image.height=r+this.imageRotateSpace,this.image.scale.x=this.image.scale.y),!1===this.image.isFitBounds(this.ui)&&this.fixRotate(),this.image.fixMove(this.ui,this.uiRotation),this.image.updatePrevLtPointForPivot(),m(this.changeAspectRatioAnimationId);var s=this.ui.fixSpace;this._tFrom=this.ui.bounds;var t,u,v=f.width+s,w=f.height+s,x=v/this.image.scale.x,y=w/this.image.scale.y,z=this.image.textureCanvasWidth-x,A=this.image.textureCanvasHeight-y;this.imageAspectRatio===e&&z<this.aspectRatioAllowableSize&&A<this.aspectRatioAllowableSize?(this._isNeedResetImageSize=!0,v=this.initSize.width,w=this.initSize.height,t=this.centerX-v/2,u=this.centerY-w/2):(this._isNeedResetImageSize=!1,t=this.centerX-f.width/2-s,u=this.centerY-f.height/2-s),this._tCurt=k.Calc.copyObject(this._tFrom),this._tTo={x:t,y:u,width:v,height:w},!0===d?(this.changeAspectRatioAnimationId=n(this.changeAspectRatioAnimation.bind(this),12,"easeOutSine",function(){},function(){!0===this._isNeedResetImageSize&&this.ui.setSize(this.image.bounds),this.uiMoveEnd()},this),this.emit(b.ASPECT_RATIO_MOTION_START)):(this.ui.setSize(this._tTo,!0),!1===this.image.isFitBounds(this.ui)&&this.fixRotate(),this.image.fixMove(this.ui,this.uiRotation),this.updateDimed(),!0===this._isNeedResetImageSize&&this.ui.setSize(this.image.bounds),this.uiMoveEnd())}this.updateDimed(),this.changeCornerColor(a,c)}}},o.changeCornerColor=function(a,b){0!==a||0!==b?this.ui.changeCornerColor(this.cursorAspectRatioColor):this.ui.changeCornerColor(this.cursorDefaultColor)},o.changeAspectRatioAnimation=function(a,b,c){for(var d in this._tCurt)this._tCurt[d]=k.Calc.getTweenValueByObject(d,this._tFrom,this._tTo,a);
this.ui.setSize(this._tCurt,!0),!1===this.image.isFitBounds(this.ui)&&this.fixRotate(),this.image.fixMove(this.ui,this.uiRotation),this.updateDimed()},o.setCornerLimit=function(){var a=this.ui.points;this.cornerLimit={lt:this.image.getLtIntersection(a),rt:this.image.getRtIntersection(a),rb:this.image.getRbIntersection(a),lb:this.image.getLbIntersection(a)};var b,c,d,e,f=this.cornerLimit.lt,g=this.cornerLimit.rt,h=this.cornerLimit.rb,i=this.cornerLimit.lb;b=null!==f&&null!==f.x?f.x.x:k.Calc.LIMIT_LEFT,c=null!==i&&null!==i.x?i.x.x:k.Calc.LIMIT_LEFT,this.cornerLimit.limitLeft=Math.max(b,c),d=null!==f&&null!==f.y?f.y.y:k.Calc.LIMIT_TOP,e=null!==g&&null!==g.y?g.y.y:k.Calc.LIMIT_TOP,this.cornerLimit.limitTop=Math.max(d,e),b=null!==g&&null!==g.x?g.x.x:k.Calc.LIMIT_RIGHT,c=null!==h&&null!==h.x?h.x.x:k.Calc.LIMIT_RIGHT,this.cornerLimit.limitRight=Math.min(b,c),d=null!==i&&null!==i.y?i.y.y:k.Calc.LIMIT_BOTTOM,e=null!==h&&null!==h.y?h.y.y:k.Calc.LIMIT_BOTTOM,this.cornerLimit.limitBottom=Math.min(d,e)},o.setStartUIBounds=function(){this.startUIBounds=this.ui.bounds,this.acturalPixelWidth=this.ui.getActualPixelWidth(),this.acturalPixelHeight=this.ui.getActualPixelHeight()},o.detectedMagnifyLimit=function(a,b,c,d){if(0===this.aspectRatio)this._useMagnifyLimit=!1;else{var e=Math.abs(this.cornerLimit.limitLeft-b),f=Math.abs(this.cornerLimit.limitTop-c),g=Math.abs(this.cornerLimit.limitRight-b),h=Math.abs(this.cornerLimit.limitBottom-c);e<this.magnifyLimitSpace||f<this.magnifyLimitSpace||g<this.magnifyLimitSpace||h<this.magnifyLimitSpace?this._useMagnifyLimit=!0:this._useMagnifyLimit=!1}},o.clearGraphics=function(){this.gTest&&(this.gTest.clear(),this.gImage.clear(),this.gBounds.clear())},o.getUISize=function(a){var b;if(null===a)b=k.Calc.getSizeFitInBounds({width:this.originalImageWidth,height:this.originalImageHeight},this.screenBounds);else{var c=a.uiRestoreVO;b=k.Calc.getSizeFitInBounds(c,this.screenBounds)}return b.x=this.centerX-b.width/2,b.y=this.centerY-b.height/2,b},o.flipX=function(){k.Calc.toRoundDegreesByRadians(this.stageRotation)%180==0?this.doFlipX():this.doFlipY()},o.flipY=function(){k.Calc.toRoundDegreesByRadians(this.stageRotation)%180==0?this.doFlipY():this.doFlipX()},o.doFlipX=function(){this.isChanged=!0,this.setImagePivot();var a={x:this.centerX,y:this.centerY},b=this.image.flipX(a),c=this.toGlobal(b),d=a.x-c.x,e=a.y-c.y;this.image.x+=d,this.image.y+=e,this.image.updatePrevLtPointForPivot(),this.setImagePivot(),this.updateDimed()},o.doFlipY=function(){this.isChanged=!0,this.setImagePivot();var a={x:this.centerX,y:this.centerY},b=this.image.flipY(a),c=this.toGlobal(b),d=a.x-c.x,e=a.y-c.y;this.image.x+=d,this.image.y+=e,this.image.updatePrevLtPointForPivot(),this.setImagePivot(),this.updateDimed()},o.imageMoveStart=function(){this.isHit=!1,this.prevImageX=this.image.x,this.prevImageY=this.image.y,this.image.updatePrevLtPointForPivot(),this.showGridAndDimed(),this.emit(b.MOVE_START,{bounds:this.ui.bounds,dimension:this.dimension})},o.imageMove=function(a){this.isChanged=!0,this.image.x+=a.change.x,this.image.y+=a.change.y,!1===this.image.isFitBounds(this.ui)&&this.image.fixMove(this.ui,this.uiRotation),this.image.updatePrevLtPointForPivot(),this.updateGridAndDimed(),this.emit(b.MOVE,{bounds:this.ui.bounds,dimension:this.dimension})},o.imageMoveEnd=function(){this.setImagePivot(),this.hideGridAndDimed(),this.emit(b.MOVE_END,{bounds:this.ui.bounds,dimension:this.dimension})},o.imageRotateStart=function(){if(!this.isMinimum){this.disableCursor(),this.enableCurrentCursor(),this.setImagePivot(),this.showGridAndDimed(),this.uiPoints=this.ui.points;var a=this.uiRotation;a=Math.abs(a)<k.Calc.RADIAN_1?0:a,this.emit(b.ROTATE_START,{rotation:k.Calc.toDegrees(a)})}},o.imageRotate=function(a){this.isMinimum||(this.isChanged=!0,this.imageRotateByRadian(this.imageRotation+=a.change))},o.imageRotateByRadian=function(a){if(!this.isMinimum){a<this.minRotation?a=this.minRotation:a>this.maxRotation&&(a=this.maxRotation),this.imageRotation=a;var c=this.uiRotation;if(!1===this.image.isFitBounds(this.ui)){var d={x:this.image.x,y:this.image.y},e=k.Calc.getRotationPoints(d,this.uiPoints,k.Calc.toDegrees(this.imageRotation)),f=k.Calc.getBoundsByRotationPoints(e),g=k.Calc.getScale(this.image,f),h=this.image.width,i=this.image.height,j=h*g.max,l=i*g.max;h<=j&&i<=l&&(this.image.height=l+this.imageRotateSpace,this.image.scale.x=this.image.scale.y),!1===this.image.isFitBounds(this.ui)&&this.fixRotate(),this.image.fixMove(this.ui,c)}this.image.updatePrevLtPointForPivot(),this.updateGridAndDimed(9),c=Math.abs(c)<k.Calc.RADIAN_1?0:c,this.image.updateTransform(),this.emit(b.ROTATE,{rotation:k.Calc.toDegrees(c)})}},o.fixRotate=function(){var a,b,c,d=this.ui.points,e=0,f=0,g=this.image.getHitPoints(d);for(var h in g){var i=g[h],j=i.line,m=i.point,n=i.hitSide;switch(a=k.Calc.getShortestDistancePoint(m,j.s,j.e),b=k.Calc.getReturnPoint(m,a),n){case l.HitSide.LEFT:case l.HitSide.RIGHT:c=Math.abs(b.x),e+=c,this.image.width+=c;break;case l.HitSide.TOP:case l.HitSide.BOTTOM:c=Math.abs(b.y),f+=c,this.image.height+=c}}e>f?this.image.scale.y=this.image.scale.x:this.image.scale.x=this.image.scale.y},o.imageRotateEnd=function(){this.isMinimum||(this.enableCursor(),this.disableCurrentCursor(),this.setImagePivot(),this.hideGridAndDimed(),this.emit(b.ROTATE_END,{rotation:k.Calc.toDegrees(this.uiRotation)}))},o.uiChange=function(a){this.updateDimed(),this.emit(b.UI_CHANGE,{bounds:this.ui.bounds,dimension:this.dimension})},o.cornerMoveStart=function(a){this.uiMoveStart(a)},o.cornerMove=function(a){this.uiMove(a)},o.uiUpdate=function(a){var b=a.target,c=b.x+a.dx,d=b.y+a.dy,e=this.startUIBounds.x,f=this.startUIBounds.y,g=this.startUIBounds.x+this.startUIBounds.width,h=this.startUIBounds.y+this.startUIBounds.height;switch(b){case this.ui.lt:c=c>g?g:c,d=d>h?h:d,c=c<this.cornerLimit.limitLeft?this.cornerLimit.limitLeft:c,d=d<this.cornerLimit.limitTop?this.cornerLimit.limitTop:d;break;case this.ui.rt:c=c<e?e:c,d=d>h?h:d,c=c>this.cornerLimit.limitRight?this.cornerLimit.limitRight:c,d=d<this.cornerLimit.limitTop?this.cornerLimit.limitTop:d;break;case this.ui.rb:c=c<e?e:c,d=d<f?f:d,c=c>this.cornerLimit.limitRight?this.cornerLimit.limitRight:c,d=d>this.cornerLimit.limitBottom?this.cornerLimit.limitBottom:d;break;case this.ui.lb:c=c>g?g:c,d=d<f?f:d,c=c<this.cornerLimit.limitLeft?this.cornerLimit.limitLeft:c,d=d>this.cornerLimit.limitBottom?this.cornerLimit.limitBottom:d;break;case this.ui.left:a.dy=0,d=b.y,c>this.ui.right.x&&(c=this.ui.right.x),c=c<this.cornerLimit.limitLeft?this.cornerLimit.limitLeft:c;break;case this.ui.top:a.dx=0,c=b.x,d>this.ui.bottom.y&&(d=this.ui.bottom.y),d=d<this.cornerLimit.limitTop?this.cornerLimit.limitTop:d;break;case this.ui.right:a.dy=0,d=b.y,c<this.ui.left.x&&(c=this.ui.left.x),c=c>this.cornerLimit.limitRight?this.cornerLimit.limitRight:c;break;case this.ui.bottom:a.dx=0,c=b.x,d<this.ui.top.y&&(d=this.ui.top.y),d=d>this.cornerLimit.limitBottom?this.cornerLimit.limitBottom:d}this.isNeedToMagnify(c,d,this.ui.getActualPixelWidth(),this.ui.getActualPixelHeight())&&(c+=3*a.dx,d+=3*a.dy),this.uiFix(),b instanceof j?this.ui.moveCorner(b,c,d,this.aspectRatio,this.cornerLimit):this.ui.moveControl(b,c,d,this.aspectRatio,this.cornerLimit),this.detectedMagnifyLimit(b,c,d,this.cornerLimit),this.isNeedToMagnify(c,d,this.ui.getActualPixelWidth(),this.ui.getActualPixelHeight())&&this.magnifyImage()},o.cornerMoveEnd=function(a){this.magnifyImageWithMotion(a.target),this.hideGridAndDimed(!0)},o.cornerMoveEndNoMotion=function(a){this.uiMoveEnd()},o.controlMoveStart=function(a){this.uiMoveStart()},o.controlMove=function(a){this.uiMove(a)},o.controlMoveEnd=function(a){this.magnifyImageWithMotion(a.target),this.hideGridAndDimed(!0)},o.controlMoveEndNoMotion=function(){this.uiMoveEnd()},o.changeCursor=function(a){this.emit(b.CHANGE_CURSOR,a)},o.uiMoveStart=function(a){this.disableCursor(),this.enableCurrentCursor(),this.uiFix(),this.setCornerLimit(),this.setStartUIBounds(),this.image.updatePrevLtPointForPivot(),this.showGridAndDimed(),this.emit(b.UI_MOVE_START,{bounds:this.ui.bounds,dimension:this.dimension})},o.uiMove=function(a){this.isChanged=!0,this.uiUpdate(a);var c=this.ui.bounds;this.moveUI.setSize(c),this.image.updatePrevLtPointForPivot(),this.updateGridAndDimed(),this.emit(b.UI_MOVE,{bounds:c,dimension:this.dimension})},o.uiMoveEnd=function(a){a=k.Func.getDefaultParameters(a,!0),this.enableCursor(),this.disableCurrentCursor(),!0===a&&this.magnifyImage(),this.uiFix();var c=this.ui.bounds;this.moveUI.setSize(c),this.setImagePivot(),this.hideGridAndDimed(),this._useMagnifyLimit=!1,this.emit(b.UI_MOVE_END,{bounds:c,dimension:this.dimension})},o.getOffsetX=function(){return this._offsetX},o.setOffsetX=function(a){this._offsetX=a,this.ui&&(this.ui.offsetX=a,this.moveUI.offsetX=a,this.rotateUI.offsetX=a)},o.getOffsetY=function(){return this._offsetY},o.setOffsetY=function(a){this._offsetY=a,this.ui&&(this.ui.offsetY=a,this.moveUI.offsetY=a,this.rotateUI.offsetY=a)},o.getImageRotation=function(){return this._imageRotation},o.setImageRotation=function(a){this._imageRotation=a,Math.abs(this.uiRotation)<k.Calc.RADIAN_1?this.image.rotation=this._stageRotation:this.image.rotation=this._imageRotation},o.getSnapImageRotation=function(){return Math.abs(this.uiRotation)<k.Calc.RADIAN_1?this._stageRotation:this._imageRotation},o.getStageRotation=function(){return this._stageRotation},o.setStageRotation=function(a){this._stageRotation=k.Calc.toRoundRadiansByRadians(a)},o.getUIRotation=function(){return this.imageRotation-this.stageRotation},o.getScreenBounds=function(){return{x:this.viewport.x,y:this.viewport.y,width:this.viewport.width-this.paddingX,height:this.viewport.height-this.paddingY}},o.getDimension=function(){return this.getImageSizeByBitmapData(this._resize.maxScale)},o.getIsChanged=function(){return this._isChanged},o.setIsChanged=function(a){this._isChanged=a,this.isNewChanged=a},o.getIsNewChanged=function(){return this._isNewChanged},o.setIsNewChanged=function(a){this._isNewChanged=a},o.getCenterX=function(){return this.viewport.x+this._halfOfViewportWidth},o.getCenterY=function(){return this.viewport.y+this._halfOfViewportHeight},o.getViewport=function(){return this._viewport},o.setViewport=function(a){a&&(this._viewport=a,this._halfOfViewportWidth=this._viewport.width/2,this._halfOfViewportHeight=this._viewport.height/2,this.rotateUI&&(this.rotateUI.viewport=a))},o.getIsReverseRatio=function(){var a=k.Calc.toDegrees(this.stageRotation%k.Calc.RADIAN_180);return 90==(a=parseInt(Math.round(a),10))||-90==a},o.getIsHorizontal=function(){return!!(this.image.isHorizontal&&!1===this.isReverseRatio||!1===this.image.isHorizontal&&this.isReverseRatio)},o.isNeedToMagnify=function(a,b,c,d){return!0!==this._useMagnifyLimit&&!(c<=this.acturalPixelWidth+this.uiExpandSpace&&d<=this.acturalPixelHeight+this.uiExpandSpace&&a>=this.startUIBounds.x-this.uiExpandSpace&&a<=this.startUIBounds.x+this.startUIBounds.width+this.uiExpandSpace&&b>=this.startUIBounds.y-this.uiExpandSpace&&b<=this.startUIBounds.y+this.startUIBounds.height+this.uiExpandSpace)},o.isExpand=function(a,b,c,d){if(!0===this._useMagnifyLimit)return!1;return!(c<=this.prevActualPixelWidth+1&&d<=this.prevActualPixelHeight+1&&a>=this.prevUIBounds.x-1&&a<=this.prevUIBounds.x+this.prevUIBounds.width+1&&b>=this.prevUIBounds.y-1&&b<=this.prevUIBounds.y+this.prevUIBounds.height+1)},o.isBiggerThanScreenBounds=function(a){a=k.Func.getDefaultParameters(a,this.ui.bounds);var b=this.screenBounds;return a.width>b.width||a.height>b.height},o.isEditableSize=function(a){return!(this.originalImageWidth<a||this.originalImageHeight<a)},o.isMinimunSize=function(a){return this.originalImageWidth<a||this.originalImageHeight<a},o.enableCurrentCursor=function(a){!0!==this.interactive&&(a=k.Func.getDefaultParameters(a,k.Mouse.currentCursorStyle),this.interactive=!0,this.buttonMode=!0,this.defaultCursor=a,this.emit(b.CHANGE_CURSOR,{currentCursorStyle:a}))},o.disableCurrentCursor=function(){!1!==this.interactive&&(this.interactive=!1,this.buttonMode=!1,this.defaultCursor="default")},o.enableCursor=function(){!0!==this.ui.buttonMode&&(this.ui.buttonMode=!0,this.ui.interactive=!0,this.ui.defaultCursor="default",this.moveUI.buttonMode=!0,this.moveUI.interactive=!0,this.moveUI.defaultCursor="default",this.rotateUI.buttonMode=!0,this.rotateUI.interactive=!0,this.rotateUI.defaultCursor="default")},o.disableCursor=function(){!1!==this.ui.buttonMode&&(this.ui.buttonMode=!1,this.ui.interactive=!1,this.ui.defaultCursor="inherit",this.moveUI.buttonMode=!1,this.moveUI.interactive=!1,this.moveUI.defaultCursor="inherit",this.rotateUI.buttonMode=!1,this.rotateUI.interactive=!1,this.rotateUI.defaultCursor="inherit")},o.getIsNearInitImageSize=function(a){var b=this.image.bounds,c=this.getInitImageSize(this.isReverseRatio);return a=k.Func.getDefaultParameters(a,4),b.width-a<c.width&&b.height-a<c.height},o.getIsNearInitImageWidth=function(a){var b=this.image.bounds,c=this.getInitImageSize(this.isReverseRatio);return a=k.Func.getDefaultParameters(a,4),b.width-a<c.width},o.getIsNearInitImageHeight=function(a){var b=this.image.bounds,c=this.getInitImageSize(this.isReverseRatio);return a=k.Func.getDefaultParameters(a,4),b.height-a<c.height},o.setInitImageSize=function(a){a=k.Func.getDefaultParameters(a,!1),this.initSize=this.getInitImageSize(a)},o.getInitImageSize=function(a){a=k.Func.getDefaultParameters(a,!1);var b;b=0==a?this.image.textureCanvasSize:{width:this.image.textureCanvasHeight,height:this.image.textureCanvasWidth};var c=k.Calc.getSizeFitInBounds(b,this.screenBounds);return c.x=this.centerX-c.width/2,c.y=this.centerY-c.height/2,c},o.getRotateImageSize=function(){var a=this.image.bounds;return{width:a.height,height:a.width}},o.restoreByTransform=function(a){this.isChanged=!0;var b,c,d,e,f,g,h,i;a.x,a.y,b=a.offsetX,c=a.offsetY,d=a.canvasWidth,e=a.canvasHeight,a.scaleX,a.scaleY,g=a.rotation,f=0,this.stageRotation=0,this.imageRotation=0,this.image.resetPivot(),this.image.resetLt(),this.image.width=this.image.textureCanvasWidth,this.image.height=this.image.textureCanvasHeight;for(var j=parseInt(Math.abs(f)/k.Calc.RADIAN_90),l=0;l<j;l++)this.image.rotatePoints(),this.image.rotateLt(),this.image.updatePrevLtPointForPivot(),this.setImagePivot();var m=this.image.toGlobal(this.image.getRealLt());this.image.traceRealPoints(),f===-k.Calc.RADIAN_90?(h={x:m.x+b+e,y:m.y+c,width:d,height:e},i={x:h.x,y:h.y}):f===-k.Calc.RADIAN_180?(h={x:m.x+b+d,y:m.y+c+e,width:d,height:e},i={x:h.x,y:h.y}):(h={x:m.x+b,y:m.y+c,width:d,height:e},i={x:h.x,y:h.y}),this.ui.setSize(h),this.image.updatePrevLtPointForPivot(),this.setImagePivot(i),this.imageRotation=k.Calc.toRadians(g),this.magnifyImage()},o.displayStartUIBounds=function(){if(this.gTest){if(this.removeChild(this.gTest),this.startUIBounds){var a={x:this.startUIBounds.x-this.uiExpandSpace,y:this.startUIBounds.y-this.uiExpandSpace,width:this.startUIBounds.width+2*this.uiExpandSpace,height:this.startUIBounds.height+2*this.uiExpandSpace};k.Painter.drawBounds(this.gTest,a,!0,4,2003199,.7)}this.addChild(this.gTest)}},o.displayImageRotationBounds=function(){var a=k.Calc.getSizeFitInBounds(this.image,this.screenBounds),b={lt:{x:0,y:0},rt:{x:a.width,y:0},rb:{x:a.width,y:a.height},lb:{x:0,y:a.height}},c={x:a.width/2,y:a.height/2},d=k.Calc.getRotationPoints(c,b,k.Calc.toDegrees(this.imageRotation)),e=k.Calc.getBoundsByRotationPoints(d);e.x=this.centerX-e.width/2,e.y=this.centerY-e.height/2,this.gImage&&k.Painter.drawBounds(this.gImage,e,!0,2,64767,.4)},o.displayBounds=function(){this.gBounds&&(this.removeChild(this.gBounds),this.isDisplayBounds?(this.gBounds.clear(),this.isDisplayBounds=!1):(this.isDisplayBounds=!0,k.Painter.drawBounds(this.gBounds,this.screenBounds,!0,1,16711935,.7)),this.addChild(this.gBounds))},void 0!==(0,e.default)(a)&&void 0!==(0,e.default)(a.exports)?a.exports=b:usenamespace("editor.es5.crop").Cropper=b}()}).call(b,c(6)(a))},function(a,b,c){"use strict";(function(a){function b(a){return a&&a.__esModule?a:{"default":a}}var d=c(4),e=b(d),f=c(22),g=b(f);!function(){function b(a){Object.defineProperty(this,"lt",{get:function(){return this.toGlobal(this.ltp.position)}}),Object.defineProperty(this,"rt",{get:function(){return this.toGlobal(this.rtp.position)}}),Object.defineProperty(this,"rb",{get:function(){return this.toGlobal(this.rbp.position)}}),Object.defineProperty(this,"lb",{get:function(){return this.toGlobal(this.lbp.position)}}),Object.defineProperty(this,"leftLine",{get:function(){return{s:this.lb,e:this.lt}}}),Object.defineProperty(this,"topLine",{get:function(){return{s:this.lt,e:this.rt}}}),Object.defineProperty(this,"rightLine",{get:function(){return{s:this.rt,e:this.rb}}}),Object.defineProperty(this,"bottomLine",{get:function(){return{s:this.lb,e:this.rb}}}),Object.defineProperty(this,"left",{get:function(){return Math.min(this.lt.x,this.lb.x)}}),Object.defineProperty(this,"right",{get:function(){return Math.max(this.rt.x,this.rb.x)}}),Object.defineProperty(this,"top",{get:function(){return Math.min(this.lt.y,this.rt.y)}}),Object.defineProperty(this,"bottom",{get:function(){return Math.max(this.lb.y,this.rb.y)}}),Object.defineProperty(this,"size",{get:function(){return{width:this.rt.x-this.lt.x,height:this.lb.y-this.lt.y}}}),Object.defineProperty(this,"bounds",{get:function(){return{x:this.lt.x,y:this.lt.y,width:this.rt.x-this.lt.x,height:this.rb.y-this.rt.y}}}),Object.defineProperty(this,"points",{get:function(){return{lt:this.lt,rt:this.rt,rb:this.rb,lb:this.lb}}}),Object.defineProperty(this,"isFlipX",{get:function(){return this.getIsFlipX()}}),Object.defineProperty(this,"isFlipY",{get:function(){return this.getIsFlipY()}}),Object.defineProperty(this,"isHorizontal",{get:function(){return this._isHorizontal}}),Object.defineProperty(this,"textureCanvasWidth",{get:function(){return this._textureCanvasWidth}}),Object.defineProperty(this,"textureCanvasHeight",{get:function(){return this._textureCanvasHeight}}),Object.defineProperty(this,"textureCanvasSize",{get:function(){return{width:this._textureCanvasWidth,height:this._textureCanvasHeight}}}),PIXI.Container.call(this),this.initialize(a)}var d={};d.DimedUI=c(317);var f={};f.Func=c(34),f.Calc=c(61),f.Painter=c(133);var h={};h.HitSide=c(96);var i=b.prototype=(0,g.default)(PIXI.Container.prototype);i.initialize=function(a){this.fixSpace=.1,this.intersectionSpace=10,this.bitmapdata=a,this.textureCanvas=a.canvas,this._textureCanvasWidth=this.textureCanvas.width,this._textureCanvasHeight=this.textureCanvas.height,this._isHorizontal=this._textureCanvasWidth>this._textureCanvasHeight,this.image=new PIXI.Sprite(new PIXI.Texture(new PIXI.BaseTexture(this.textureCanvas))),this.image.x=-this.image.width/2,this.image.y=-this.image.height/2,this.addChild(this.image),this.dimed=new d.DimedUI(this.image.width,this.image.height),this.image.addChild(this.dimed),this.maskGraphic=new PIXI.Graphics,this.maskGraphic.beginFill(16711680,.2),this.maskGraphic.drawRect(0,0,this.image.width,this.image.height),this.maskGraphic.endFill(),this.image.addChild(this.maskGraphic),this.image.mask=this.maskGraphic,this.ltp||(this.ltp=new PIXI.Sprite,this.rtp=new PIXI.Sprite,this.rbp=new PIXI.Sprite,this.lbp=new PIXI.Sprite,this.addChild(this.ltp),this.addChild(this.rtp),this.addChild(this.rbp),this.addChild(this.lbp)),this.ltp.x=this.image.x,this.ltp.y=this.image.y,this.rtp.x=this.image.x+this.image.width,this.rtp.y=this.image.y,this.rbp.x=this.image.x+this.image.width,this.rbp.y=this.image.y+this.image.height,this.lbp.x=this.image.x,this.lbp.y=this.image.y+this.image.height,this.ltp.isLt=!0,this.lbp.isLt=!1,this.rbp.isLt=!1,this.rtp.isLt=!1,this.ltp.name="ltp",this.lbp.name="lbp",this.rbp.name="rbp",this.rtp.name="rtp",this.realPoints=[this.ltp,this.lbp,this.rbp,this.rtp]},i.setMask=function(a){this._graphics=a,this.maskGraphic.visible=!1,this.image.mask=a,this.image.addChild(a)},i.removeMask=function(){if(this._graphics)return this.maskGraphic.visible=!0,this.image.mask=this.maskGraphic,this._graphics.parent==this.image&&this.image.removeChild(this._graphics),this._graphics},i.reset=function(a){this.removeImage(),this.initialize(a),this.updateDebugPivotGraphic()},i.addDebugPoint=function(){var a=20,b=a/2;this.gDebugPivot=new PIXI.Graphics,this.gDebugPivot.beginFill(16724736,1),this.gDebugPivot.drawRect(-b,-b,a,a),this.gDebugPivot.endFill(),this.addChild(this.gDebugPivot);var a=8,b=a/2,c=f.Painter.getRect(a,16379392,1),d=f.Painter.getRect(a,14326784,1),e=f.Painter.getRect(a,40151,1),g=f.Painter.getRect(a,1597873,1);c.x=b,c.y=b,d.x=-b,d.y=b,e.x=-b,e.y=-b,g.x=b,g.y=-b,this.ltp.addChild(c),this.rtp.addChild(d),this.rbp.addChild(e),this.lbp.addChild(g)},i.showDimed=function(){this.dimed.show()},i.drawDimed=function(a,b){this.dimed.draw(a,b,this.image.scale)},i.hideDimed=function(){this.dimed.hide()},i.rotatePoints=function(a){var b,c,d,e;a=f.Func.getDefaultParameters(a,!1),a?(b={x:this.lbp.x,y:this.lbp.y},c={x:this.ltp.x,y:this.ltp.y},d={x:this.rtp.x,y:this.rtp.y},e={x:this.rbp.x,y:this.rbp.y}):(b={x:this.rtp.x,y:this.rtp.y},c={x:this.rbp.x,y:this.rbp.y},d={x:this.lbp.x,y:this.lbp.y},e={x:this.ltp.x,y:this.ltp.y}),this.ltp.x=b.x,this.ltp.y=b.y,this.rtp.x=c.x,this.rtp.y=c.y,this.rbp.x=d.x,this.rbp.y=d.y,this.lbp.x=e.x,this.lbp.y=e.y},i.rotateLt=function(a){if(a=f.Func.getDefaultParameters(a,!1))for(var b=0;b<this.realPoints.length;b++){var c=this.realPoints[b];if(c.isLt){c===this.ltp?this.setRealLt(this.rtp):c===this.rtp?this.setRealLt(this.rbp):c===this.rbp?this.setRealLt(this.lbp):this.setRealLt(this.ltp);break}}else for(var b=0;b<this.realPoints.length;b++){var c=this.realPoints[b];if(c.isLt){c===this.ltp?this.setRealLt(this.lbp):c===this.lbp?this.setRealLt(this.rbp):c===this.rbp?this.setRealLt(this.rtp):this.setRealLt(this.ltp);break}}},i.getRealLt=function(){for(var a=0;a<this.realPoints.length;a++)if(this.realPoints[a].isLt)return this.realPoints[a]},i.setRealLt=function(a){for(var b=0;b<this.realPoints.length;b++){var c=this.realPoints[b];c.isLt=!1,c===a&&(c.isLt=!0)}},i.flipX=function(a){var b=this.image.toLocal(a),c=new PIXI.Point(this.image.width-b.x,b.y);return c=this.image.toGlobal(c),this.image.scale.x*=-1,this.image.scale.x<0?this.image.x=this.image.width/2:this.image.x=-this.image.width/2,c},i.flipY=function(a){var b=this.image.toLocal(a),c=new PIXI.Point(b.x,this.image.height-b.y);return c=this.image.toGlobal(c),this.image.scale.y*=-1,this.image.scale.y<0?this.image.y=this.image.height/2:this.image.y=-this.image.height/2,c},i.getOffsetPoint=function(a){for(var b=0;b<this.realPoints.length;b++){var c=this.realPoints[b];if(c.isLt)return c===this.ltp?a.lt:c===this.lbp?a.lb:c===this.rbp?a.rb:a.rt}},i.isLeftOut=function(a,b){return!(!this.isLtLeftOut(a,b)&&!this.isLbLeftOut(a,b))},i.isLtLeftOut=function(a,b){return!1!==this.isPassedLeftLine(b.lt)||!a.isLtInsideBounds(this,b)},i.isLbLeftOut=function(a,b){return!1!==this.isPassedLeftLine(b.lb)||!a.isLbInsideBounds(this,b)},i.isLeftTopBottomOut=function(a,b){return!(!this.isLtTopOut(a,b)&&!this.isLbBottomOut(a,b))},i.isLtTopOut=function(a,b){return!1!==this.isPassedTopLine(b.lt)||!a.isLtInsideBounds(this,b)},i.isLbBottomOut=function(a,b){return!1!==this.isPassedBottomLine(b.lb)||!a.isLbInsideBounds(this,b)},i.isRightOut=function(a,b){return!(!this.isRtRightOut(a,b)&&!this.isRbRightOut(a,b))},i.isRtRightOut=function(a,b){return!1!==this.isPassedRightLine(b.rt)||!a.isRtInsideBounds(this,b)},i.isRbRightOut=function(a,b){return!1!==this.isPassedRightLine(b.rb)||!a.isRbInsideBounds(this,b)},i.isRightTopBottomOut=function(a,b){return!(!this.isRtTopOut(a,b)&&!this.isRbBottomOut(a,b))},i.isRtTopOut=function(a,b){return!1!==this.isPassedTopLine(b.rt)||!a.isRtInsideBounds(this,b)},i.isRbBottomOut=function(a,b){return!1!==this.isPassedBottomLine(b.rb)||!a.isLbInsideBounds(this,b)},i.fixMove=function(a,b){b>0?(this.isPassedLeftLine(a.lt)&&!1===a.isLtInsideBounds(this)&&f.Calc.goByCollision(this,a.lt,this.leftLine,-this.fixSpace,-this.fixSpace),this.isPassedBottomLine(a.lb)&&!1===a.isLbInsideBounds(this)&&f.Calc.goByCollision(this,a.lb,this.bottomLine,-this.fixSpace,this.fixSpace),this.isPassedTopLine(a.rt)&&!1===a.isRtInsideBounds(this)&&f.Calc.goByCollision(this,a.rt,this.topLine,this.fixSpace,-this.fixSpace),this.isPassedRightLine(a.rb)&&!1===a.isRbInsideBounds(this)&&f.Calc.goByCollision(this,a.rb,this.rightLine,this.fixSpace,this.fixSpace)):(this.isPassedTopLine(a.lt)&&!1===a.isLtInsideBounds(this)&&f.Calc.goByCollision(this,a.lt,this.topLine,-this.fixSpace,-this.fixSpace),this.isPassedLeftLine(a.lb)&&!1===a.isLbInsideBounds(this)&&f.Calc.goByCollision(this,a.lb,this.leftLine,-this.fixSpace,this.fixSpace),this.isPassedRightLine(a.rt)&&!1===a.isRtInsideBounds(this)&&f.Calc.goByCollision(this,a.rt,this.rightLine,this.fixSpace,-this.fixSpace),this.isPassedBottomLine(a.rb)&&!1===a.isRbInsideBounds(this)&&f.Calc.goByCollision(this,a.rb,this.bottomLine,this.fixSpace,this.fixSpace))},i.fixMoveByPoints=function(a,b,c){return c>0?(f.Calc.isPassedLeftLine(a,b.lt)&&!1===f.Calc.isInsideSquare(b.lt,a.lt,a.rt,a.rb,a.lb)&&(a=f.Calc.pointsUpdateByCollision(a,b.lt,a.leftLine)),f.Calc.isPassedBottomLine(a,b.lb)&&!1===f.Calc.isInsideSquare(b.lb,a.lt,a.rt,a.rb,a.lb)&&(a=f.Calc.pointsUpdateByCollision(a,b.lb,a.bottomLine)),f.Calc.isPassedTopLine(a,b.rt)&&!1===f.Calc.isInsideSquare(b.rt,a.lt,a.rt,a.rb,a.lb)&&(a=f.Calc.pointsUpdateByCollision(a,b.rt,a.topLine)),f.Calc.isPassedRightLine(a,b.rb)&&!1===f.Calc.isInsideSquare(b.rb,a.lt,a.rt,a.rb,a.lb)&&(a=f.Calc.pointsUpdateByCollision(a,b.rb,a.rightLine))):(f.Calc.isPassedTopLine(a,b.lt)&&!1===f.Calc.isInsideSquare(b.lt,a.lt,a.rt,a.rb,a.lb)&&(a=f.Calc.pointsUpdateByCollision(a,b.lt,a.topLine)),f.Calc.isPassedLeftLine(a,b.lb)&&!1===f.Calc.isInsideSquare(b.lb,a.lt,a.rt,a.rb,a.lb)&&(a=f.Calc.pointsUpdateByCollision(a,b.lb,a.leftLine)),f.Calc.isPassedRightLine(a,b.rt)&&!1===f.Calc.isInsideSquare(b.rt,a.lt,a.rt,a.rb,a.lb)&&(a=f.Calc.pointsUpdateByCollision(a,b.rt,a.rightLine)),f.Calc.isPassedBottomLine(a,b.rb)&&!1===f.Calc.isInsideSquare(b.rb,a.lt,a.rt,a.rb,a.lb)&&(a=f.Calc.pointsUpdateByCollision(a,b.rb,a.bottomLine))),a},i.updatePrevLtPointForPivot=function(){this.prevLtX=this.lt.x,this.prevLtY=this.lt.y},i.setPivotByGlobalPoint=function(a){var b=this.toLocal(a);this.pivot=b;var c=this.lt.x-this.prevLtX,d=this.lt.y-this.prevLtY;this.x=this.x-c,this.y=this.y-d,this.updatePrevLtPointForPivot(),this.updateDebugPivotGraphic()},i.setPivotByLocalPoint=function(a){a.x=this.ltp.x+this.pivot.x,a.y=this.ltp.y+this.pivot.y,this.pivot=a;var b=this.lt.x-this.prevLtX,c=this.lt.y-this.prevLtY;this.x=this.x-b,this.y=this.y-c,this.updatePrevLtPointForPivot(),this.updateDebugPivotGraphic()},i.getGlobalPivot=function(){return{x:this.pivot.x-this.ltp.x,y:this.pivot.y-this.ltp.y}},i.getLocal=function(a){var b=this.getRealLt(),c=this.toLocal(a);return{x:c.x-b.x,y:c.y-b.y}},i.getGlobal=function(a){var b=this.getRealLt(),c={x:a.x+b.x,y:a.y+b.y};return this.toGlobal(c)},i.updateDebugPivotGraphic=function(){this.gDebugPivot&&(this.removeChild(this.gDebugPivot),this.gDebugPivot.x=this.pivot.x,this.gDebugPivot.y=this.pivot.y,this.addChild(this.gDebugPivot))},i.isPassedLeftLine=function(a){return f.Calc.triangleArea(a,this.lb,this.lt)>0},i.isPassedTopLine=function(a){return f.Calc.triangleArea(a,this.lt,this.rt)>0},i.isPassedRightLine=function(a){return f.Calc.triangleArea(a,this.rt,this.rb)>0},i.isPassedBottomLine=function(a){return f.Calc.triangleArea(a,this.rb,this.lb)>0},i.getLeftIntersectionPoint=function(a){return f.Calc.getShortestDistancePoint(a,this.lb,this.lt)},i.getTopIntersectionPoint=function(a){return f.Calc.getShortestDistancePoint(a,this.lt,this.rt)},i.getRightIntersectionPoint=function(a){return f.Calc.getShortestDistancePoint(a,this.rt,this.rb)},i.getBottomIntersectionPoint=function(a){return f.Calc.getShortestDistancePoint(a,this.rb,this.lb)},i.getRotationBounds=function(a){var b=this.pivot,c=[f.Calc.getRotationPoint(b,this.ltp,a),f.Calc.getRotationPoint(b,this.rtp,a),f.Calc.getRotationPoint(b,this.rbp,a),f.Calc.getRotationPoint(b,this.lbp,a)];return{left:f.Calc.getLeftPoint(c).x,right:f.Calc.getRightPoint(c).x,top:f.Calc.getTopPoint(c).y,bottom:f.Calc.getBottomPoint(c).y}},i.getFixPoint=function(a){var b=this.getLocal(a);return b=this.getValidationPoint(b),this.getGlobal(b)},i.getFixPoints=function(a){for(var b in a){var c=this.getLocal(a[b]);c=this.getValidationPoint(c),a[b]=this.getGlobal(c)}return a},i.getValidationPoint=function(a){var b=a.x,c=a.y;b<=0&&(b=this.fixSpace),b>=this.image.width&&(b=this.image.width-this.fixSpace),c<=0&&(c=this.fixSpace),c>=this.image.height&&(c=this.image.height-this.fixSpace),a.x=b,a.y=c;var d=this.getGlobal(a);return a.x=d.x,a.y=d.y,a},i.getValidationPoints=function(a){for(var b in a){var c=a[b],d=c.x,e=c.y;d<=0&&(d=this.fixSpace),d>=this.image.width&&(d=this.image.width-this.fixSpace),e<=0&&(e=this.fixSpace),e>=this.image.height&&(e=this.image.height-this.fixSpace),c.x=d,c.y=e;var f=this.getGlobal(c);a[b].x=f.x,a[b].y=f.y}return a},i.isFitBounds=function(a){for(var b=[a.lt,a.rt,a.rb,a.lb],c=0;c<b.length;c++)if(!1===f.Calc.isInsideSquare(b[c],this.lt,this.rt,this.rb,this.lb))return!1;return!0},i.getHitSide=function(a){var b=this.lt,c=this.rt,d=this.rb,e=this.lb,g=h.HitSide.NONE;return(f.Calc.triangleArea(a.lt,e,b)>0||f.Calc.triangleArea(a.lb,e,b)>0)&&(g=h.HitSide.LEFT),(f.Calc.triangleArea(a.rt,c,d)>0||f.Calc.triangleArea(a.rb,c,d)>0)&&(g=h.HitSide.RIGHT),(f.Calc.triangleArea(a.lt,b,c)>0||f.Calc.triangleArea(a.rt,b,c)>0)&&(g=g===h.HitSide.NONE?h.HitSide.TOP:g+="-"+h.HitSide.TOP),(f.Calc.triangleArea(a.rb,d,e)>0||f.Calc.triangleArea(a.lb,d,e)>0)&&(g=g===h.HitSide.NONE?h.HitSide.BOTTOM:g+="-"+h.HitSide.BOTTOM),g},i.getHitPoints=function(a){var b=this.lt,c=this.rt,d=this.rb,e=this.lb,g=[];return f.Calc.triangleArea(a.lt,e,b)>0&&g.push({point:a.lt,line:{s:e,e:b},name:"lt",hitSide:h.HitSide.LEFT}),f.Calc.triangleArea(a.lb,e,b)>0&&g.push({point:a.lb,line:{s:e,e:b},name:"lb",hitSide:h.HitSide.LEFT}),f.Calc.triangleArea(a.rt,c,d)>0&&g.push({point:a.rt,line:{s:c,e:d},name:"rt",hitSide:h.HitSide.RIGHT}),f.Calc.triangleArea(a.rb,c,d)>0&&g.push({point:a.rb,line:{s:c,e:d},name:"rb",hitSide:h.HitSide.RIGHT}),f.Calc.triangleArea(a.lt,b,c)>0&&g.push({point:a.lt,line:{s:b,e:c},name:"lt",hitSide:h.HitSide.TOP}),f.Calc.triangleArea(a.rt,b,c)>0&&g.push({point:a.rt,line:{s:b,e:c},name:"rt",hitSide:h.HitSide.TOP}),f.Calc.triangleArea(a.rb,d,e)>0&&g.push({point:a.rb,line:{s:d,e:e},name:"rb",hitSide:h.HitSide.BOTTOM}),f.Calc.triangleArea(a.lb,d,e)>0&&g.push({point:a.lb,line:{s:d,e:e},name:"lb",hitSide:h.HitSide.BOTTOM}),g},i.getIntersection=function(a,b){var c;switch(a){case b.lt:c=this.getLbIntersection(b);break;case b.rt:c=this.getRbIntersection(b);break;case b.rb:c=this.getRtIntersection(b);break;case b.lb:c=this.getLtIntersection(b);break;case b.left:var d=this.getLtIntersection(b),e=this.getLbIntersection(b);c=d.distanceX<e.distanceX?d:e;break;case b.top:var d=this.getLtIntersection(b),f=this.getRtIntersection(b);c=d.distanceY<f.distanceY?d:f;break;case b.right:var f=this.getRtIntersection(b),g=this.getRbIntersection(b);c=f.distanceX<g.distanceX?f:g;break;case b.bottom:var g=this.getRbIntersection(b),e=this.getLbIntersection(b);c=g.distanceY<e.distanceY?g:e}return c},i.getLtIntersection=function(a){var b,c,d=[],e=[],g=a.lt,h={x:a.rt.x-this.intersectionSpace,y:a.rt.y},i={x:a.lb.x,y:a.lb.y-this.intersectionSpace},j={x:0,y:g.y},k={x:g.x,y:0},l=this.topLine,m=this.leftLine,n=this.bottomLine,o=f.Calc.intersection(m.s,m.e,h,j),p=f.Calc.intersection(l.s,l.e,h,j),q=f.Calc.intersection(n.s,n.e,h,j);null!==o&&d.push(o),null!==p&&d.push(p),null!==q&&d.push(q);var r=f.Calc.intersection(m.s,m.e,i,k),s=f.Calc.intersection(l.s,l.e,i,k);null!==r&&e.push(r),null!==s&&e.push(s);var t,u;return t=1===d.length?d[0]:f.Calc.getNearPoint(g,"x",d),u=1===e.length?e[0]:f.Calc.getNearPoint(g,"y",e),null!==t&&(b=g.x-t.x),null!==u&&(c=g.y-u.x),{x:t,y:u,distanceX:b,distanceY:c}},i.getRtIntersection=function(a){var b,c,d=[],e=[],g=a.rt,h={
x:a.lt.x+this.intersectionSpace,y:a.lt.y},i={x:a.rb.x,y:a.rb.y-this.intersectionSpace},j={x:window.innerWidth,y:g.y},k={x:g.x,y:0},l=this.topLine,m=this.rightLine,n=this.bottomLine,o=f.Calc.intersection(m.s,m.e,h,j),p=f.Calc.intersection(l.s,l.e,h,j),q=f.Calc.intersection(n.s,n.e,h,j);null!==o&&d.push(o),null!==p&&d.push(p),null!==q&&d.push(q);var r=f.Calc.intersection(m.s,m.e,i,k),s=f.Calc.intersection(l.s,l.e,i,k);null!==r&&e.push(r),null!==s&&e.push(s);var t,u;return t=1===d.length?d[0]:f.Calc.getNearPoint(g,"x",d),u=1===e.length?e[0]:f.Calc.getNearPoint(g,"y",e),null!==t&&(b=t.x-g.x),null!==u&&(c=g.y-u.y),{x:t,y:u,distanceX:b,distanceY:c}},i.getRbIntersection=function(a){var b,c,d=[],e=[],g=a.rb,h={x:a.lb.x+this.intersectionSpace,y:a.lb.y},i={x:a.rt.x,y:a.rt.y+this.intersectionSpace},j={x:window.innerWidth,y:g.y},k={x:g.x,y:window.innerHeight},l=this.topLine,m=this.rightLine,n=this.bottomLine,o=f.Calc.intersection(m.s,m.e,h,j),p=f.Calc.intersection(l.s,l.e,h,j),q=f.Calc.intersection(n.s,n.e,h,j);null!==o&&d.push(o),null!==p&&d.push(p),null!==q&&d.push(q);var r=f.Calc.intersection(m.s,m.e,i,k),s=f.Calc.intersection(n.s,n.e,i,k);null!==r&&e.push(r),null!==s&&e.push(s);var t,u;return t=1===d.length?d[0]:f.Calc.getNearPoint(g,"x",d),u=1===e.length?e[0]:f.Calc.getNearPoint(g,"y",e),null!==t&&(b=t.x-g.x),null!==u&&(c=u.y-g.y),{x:t,y:u,distanceX:b,distanceY:c}},i.getLbIntersection=function(a){var b,c,d=[],e=[],g=a.lb,h={x:a.rb.x-this.intersectionSpace,y:a.rb.y},i={x:a.lt.x,y:a.lt.y+this.intersectionSpace},j={x:0,y:g.y},k={x:g.x,y:window.innerHeight},l=this.topLine,m=this.leftLine,n=this.bottomLine,o=f.Calc.intersection(m.s,m.e,h,j),p=f.Calc.intersection(l.s,l.e,h,j),q=f.Calc.intersection(n.s,n.e,h,j);null!==o&&d.push(o),null!==p&&d.push(p),null!==q&&d.push(q);var r=f.Calc.intersection(m.s,m.e,i,k),s=f.Calc.intersection(n.s,n.e,i,k);null!==r&&e.push(r),null!==s&&e.push(s);var t,u;return t=1===d.length?d[0]:f.Calc.getNearPoint(g,"x",d),u=1===e.length?e[0]:f.Calc.getNearPoint(g,"y",e),null!==t&&(b=g.x-t.x),null!==u&&(c=u.y-g.y),{x:t,y:u,distanceX:b,distanceY:c}},i.sortX=function(a,b){return a.x===b.x?0:a.x<b.x?-1:1},i.sortY=function(a,b){return a.y===b.y?0:a.y<b.y?-1:1},i.toString=function(){var a=this.toGlobal(this.pivot);return"LT["+f.Calc.leadingZero(parseInt(this.lt.x))+", "+f.Calc.leadingZero(parseInt(this.lt.y))+"] RT["+f.Calc.leadingZero(parseInt(this.rt.x))+", "+f.Calc.leadingZero(parseInt(this.rt.y))+"] RB["+f.Calc.leadingZero(parseInt(this.rb.x))+", "+f.Calc.leadingZero(parseInt(this.rb.y))+"] LB["+f.Calc.leadingZero(parseInt(this.lb.x))+", "+f.Calc.leadingZero(parseInt(this.lb.y))+"] XY["+f.Calc.leadingZero(parseInt(this.x))+", "+f.Calc.leadingZero(parseInt(this.y))+"] WH["+f.Calc.leadingZero(parseInt(this.width))+", "+f.Calc.leadingZero(parseInt(this.height))+"] Scale["+this.scale.x+", "+this.scale.y+"] Pivot Local["+this.pivot.x+", "+this.pivot.y+"] Pivot Global["+a.x+", "+a.y+"] Rotation["+f.Calc.digit(f.Calc.toDegrees(this.rotation))+"]"},i.traceRealPoints=function(){for(var a=0;a<this.realPoints.length;a++){var b=this.realPoints[a];void 0}},i.getRestoreData=function(){return{x:this.x,y:this.y,width:this.width,height:this.height,pivotX:this.pivot.x,pivotY:this.pivot.y,rotation:this.rotation,flipX:this.image.scale.x,flipY:this.image.scale.y}},i.setRestoreData=function(a){this.pivot.x=a.pivotX,this.pivot.y=a.pivotY,this.x=a.x,this.y=a.y,this.width=a.width,this.height=a.height},i.restoreFlip=function(a){this.image.scale.x=a.flipX,this.image.scale.y=a.flipY,this.image.scale.x<0?this.image.x=this.image.width/2:this.image.x=-this.image.width/2,this.image.scale.y<0?this.image.y=this.image.height/2:this.image.y=-this.image.height/2},i.removeImage=function(){this.image.destroy(!0,!0),this.removeChild(this.image),this.image=null},i.traceHitPoints=function(a){var b=this.getHitPoints(a);void 0;for(var c in b){var d=b[c],e=d.name,f=d.hitSide;void 0}return b},i.getIsFlipX=function(){return this.image.scale.x<0},i.getIsFlipY=function(){return this.image.scale.y<0},i.resetPivot=function(){this.pivot={x:0,y:0},this.updatePrevLtPointForPivot(),this.updateDebugPivotGraphic()},i.resetLt=function(){this.ltp.x=this.image.x,this.ltp.y=this.image.y,this.rtp.x=this.image.x+this.image.width,this.rtp.y=this.image.y,this.rbp.x=this.image.x+this.image.width,this.rbp.y=this.image.y+this.image.height,this.lbp.x=this.image.x,this.lbp.y=this.image.y+this.image.height;for(var a=0;a<this.realPoints.length;a++)this.realPoints[a].isLt=!1;this.ltp.isLt=!0},i.resetFlip=function(){this.image.scale.x<0&&(this.image.scale.x*=-1,this.image.x=-this.image.width/2),this.image.scale.y<0&&(this.image.scale.y*=-1,this.image.y=-this.image.height/2)},void 0!==(0,e.default)(a)&&void 0!==(0,e.default)(a.exports)?a.exports=b:usenamespace("editor.es5.ui").Image=b}()}).call(b,c(6)(a))},function(a,b,c){"use strict";(function(a){function b(a){return a&&a.__esModule?a:{"default":a}}var d=c(4),e=b(d),f=c(22),g=b(f);!function(){function b(a,b){PIXI.Sprite.call(this),this.initialize(a,b)}var d={};d.Func=c(34),d.Calc=c(61);var f=c(62).cancelAnimFrame,h=c(62).animationLoop,i=b.prototype=(0,g.default)(PIXI.Sprite.prototype);i.initialize=function(a,b){this.w=a,this.h=b,this.bgSpace=.5,this.drawSpace=.1,this.easingDuration=6,this.dimedShowAlpha=.4,this.dimedHideAlpha=.82,this.graphics||(this.graphics=new PIXI.Graphics,this.graphics.alpha=this.dimedShowAlpha,this.addChild(this.graphics))},i.show=function(){f(this.displayAnimationId),this._tFrom=this.graphics.alpha,this._tTo=this.dimedShowAlpha,this._tCurt=this._tFrom,this.displayAnimationId=h(this.changeGridAlpha.bind(this),this.easingDuration,"easeOutQuad",function(){},function(){this.graphics.alpha=this._tTo},this)},i.changeGridAlpha=function(a,b,c){this._tCurt=d.Calc.getTweenValue(this._tFrom,this._tTo,a),this.graphics.alpha=this._tCurt},i.draw=function(a,b,c){b=d.Func.getDefaultParameters(b,this.graphics.alpha),this._tFrom=b,this._tCurt=b,this.graphics.alpha=b,this.clear(),this.validationCheck(a),this.drawDimed(a,c)},i.validationCheck=function(a){for(var b in a){var c=a[b],d=c.x,e=c.y;d<0&&(d=0),d>this.w&&(d=this.w),e<0&&(e=0),e>this.h&&(e=this.h),a[b].x=d,a[b].y=e}},i.drawDimed=function(a,b){var c=this.w,e=this.h,f=a;if(b.x<0){for(var g in f)f[g]=d.Calc.flipX(this.w,f[g]);var h={x:f.rt.x,y:f.rt.y},i={x:f.lt.x,y:f.lt.y},j={x:f.lb.x,y:f.lb.y},k={x:f.rb.x,y:f.rb.y};f.lt=h,f.rt=i,f.rb=j,f.lb=k}if(b.y<0){for(var g in f)f[g]=d.Calc.flipY(this.h,f[g]);var h={x:f.lb.x,y:f.lb.y},i={x:f.rb.x,y:f.rb.y},j={x:f.rt.x,y:f.rt.y},k={x:f.lt.x,y:f.lt.y};f.lt=h,f.rt=i,f.rb=j,f.lb=k}this.graphics.lineStyle(0,16724736,0),this.graphics.beginFill(0),this.graphics.moveTo(-this.bgSpace,-this.bgSpace),this.graphics.lineTo(c+this.bgSpace,-this.bgSpace),this.graphics.lineTo(c+this.bgSpace,e+this.bgSpace),this.graphics.lineTo(-this.bgSpace,e+this.bgSpace),this.graphics.lineTo(-this.bgSpace,-this.bgSpace),this.graphics.lineTo(f.lt.x,f.lt.y),this.graphics.lineTo(f.lb.x,f.lb.y),this.graphics.lineTo(f.rb.x,f.rb.y),this.graphics.lineTo(f.rt.x,f.rt.y),this.graphics.lineTo(f.lt.x,f.lt.y),this.graphics.endFill()},i.hide=function(){f(this.displayAnimationId),this._tFrom=this.graphics.alpha,this._tTo=this.dimedHideAlpha,this._tCurt=this._tFrom,this.displayAnimationId=h(this.changeGridAlpha.bind(this),this.easingDuration,"easeOutQuad",function(){},function(){this.graphics.alpha=this._tTo},this)},i.clear=function(){this.graphics.clear()},void 0!==(0,e.default)(a)&&void 0!==(0,e.default)(a.exports)?a.exports=b:usenamespace("editor.es5.ui").DimedUI=b}()}).call(b,c(6)(a))},function(a,b,c){"use strict";(function(a){function b(a){return a&&a.__esModule?a:{"default":a}}var d=c(4),e=b(d),f=c(22),g=b(f);!function(){function b(a){PIXI.Sprite.call(this),this.initialize(a),this.render(),this.addCursorEvent(),this.addMouseDownEvent()}var d={};d.Mouse=c(75),d.Func=c(34),b.MOVE_START="moveStart",b.MOVE="move",b.MOVE_END="moveEnd";var f=b.prototype=(0,g.default)(PIXI.Sprite.prototype);f.initialize=function(a){this.interactive=!0,this.buttonMode=!0,this.defaultCursor="pointer",this.graphics||(this.graphics=new PIXI.Graphics,this.addChild(this.graphics))},f.reset=function(a){this.initialize(a)},f.render=function(){this.graphics.clear(),this.graphics.beginFill(4359668,0),this.graphics.drawRect(0,0,1,1),this.graphics.endFill()},f.setSize=function(a){this.graphics.x=a.x,this.graphics.y=a.y,this.graphics.width=a.width,this.graphics.height=a.height},f.changeCursor=function(a){this.defaultCursor=a},f.addCursorEvent=function(){this.mouseover=this.changeCursor.bind(this,"pointer")},f.removeCursorEvent=function(){this.mouseover=null},f.addMouseDownEvent=function(){this._mouseDownListener=this.onMouseDown.bind(this),this.on("mousedown",this._mouseDownListener)},f.removeMouseDownEvent=function(){this.off("mousedown",this._mouseDownListener)},f.addMouseMoveEvent=function(){this._mouseMoveListener=this.onMouseMove.bind(this),this._mouseUpListener=this.onMouseUp.bind(this),window.document.addEventListener("mousemove",this._mouseMoveListener),window.document.addEventListener("mouseup",this._mouseUpListener)},f.removeMouseMoveEvent=function(){window.document.removeEventListener("mousemove",this._mouseMoveListener),window.document.removeEventListener("mouseup",this._mouseUpListener)},f.onMouseDown=function(a){this.prevMousePoint={x:d.Mouse.globalX,y:d.Mouse.globalY},this.emit(b.MOVE_START),a.stopPropagation(),this.changeCursor("move"),this.addMouseMoveEvent(),this.removeMouseDownEvent()},f.onMouseMove=function(a){this.currentMousePoint={x:d.Mouse.globalX,y:d.Mouse.globalY},this.change={x:this.currentMousePoint.x-this.prevMousePoint.x,y:this.currentMousePoint.y-this.prevMousePoint.y},this.emit(b.MOVE,{prevMousePoint:this.prevMousePoint,currentMousePoint:this.currentMousePoint,change:this.change}),this.prevMousePoint=this.currentMousePoint},f.onMouseUp=function(){this.changeCursor("pointer"),this.emit(b.MOVE_END),this.addMouseDownEvent(),this.removeMouseMoveEvent()},void 0!==(0,e.default)(a)&&void 0!==(0,e.default)(a.exports)?a.exports=b:usenamespace("editor.es5.ui").MoveUI=b}()}).call(b,c(6)(a))},function(a,b,c){"use strict";(function(a){function b(a){return a&&a.__esModule?a:{"default":a}}var d=c(4),e=b(d),f=c(22),g=b(f);!function(){function b(a,b){Object.defineProperty(this,"dimension",{get:this.getDimension}),Object.defineProperty(this,"centerX",{get:function(){return this.lt.x+(this.rt.x-this.lt.x)/2}}),Object.defineProperty(this,"centerY",{get:function(){return this.lt.y+(this.lb.y-this.lt.y)/2}}),Object.defineProperty(this,"isMinWidth",{get:function(){var a=this.bounds,b=2*this.size+this.half;return a.width<b}}),Object.defineProperty(this,"isMinHeight",{get:function(){var a=this.bounds,b=2*this.size+this.half;return a.height<b}}),Object.defineProperty(this,"bounds",{get:function(){return{x:this.lt.x,y:this.lt.y,width:this.rt.x-this.lt.x,height:this.rb.y-this.rt.y}}}),Object.defineProperty(this,"points",{get:function(){return{lt:{x:this.lt.x,y:this.lt.y},rt:{x:this.rt.x,y:this.rt.y},rb:{x:this.rb.x,y:this.rb.y},lb:{x:this.lb.x,y:this.lb.y}}}}),Object.defineProperty(this,"imageBasedLocalPoints",{get:this.getImageBasedLocalPoints}),PIXI.Container.call(this),this.initialize(a,b),this.addCursorEvent(),this.addCornerDownEvent(),this.addControlDownEvent()}var d={};d.ControlArea=c(320),d.CornerShape=c(182);var f={};f.Mouse=c(75),f.Func=c(34),f.Calc=c(61);var h=c(62).cancelAnimFrame,i=c(62).animationLoop;b.UI_CHANGE="uiChange",b.CORNER_MOVE_START="cornerMoveStart",b.CORNER_MOVE="cornerMove",b.CORNER_MOVE_END="cornerMoveEnd",b.CONTROL_MOVE_START="controlMoveStart",b.CONTROL_MOVE="controlMove",b.CONTROL_MOVE_END="controlMoveEnd",b.CHANGE_CURSOR="changeCursor";var j=b.prototype=(0,g.default)(PIXI.Container.prototype);j.initialize=function(a,b){this.image=a,this.fixSpace=.1,this.lineThickness=1,this.easingDuration=4,this.interactive=!0,this.buttonMode=!0,this.defaultColor=b.cursorDefaultColor,this.defaultCursor="default",this.imageWidth=a.image.width,this.imageHeight=a.image.height,this.top||(this.gGrid=new PIXI.Graphics,this.gBounds=new PIXI.Graphics,this.left=new d.ControlArea(d.ControlArea.COL),this.top=new d.ControlArea(d.ControlArea.ROW),this.right=new d.ControlArea(d.ControlArea.COL),this.bottom=new d.ControlArea(d.ControlArea.ROW),this.lt=new d.CornerShape(d.CornerShape.LEFT_TOP,40,3,this.defaultColor),this.rt=new d.CornerShape(d.CornerShape.RIGHT_TOP,40,3,this.defaultColor),this.rb=new d.CornerShape(d.CornerShape.RIGHT_BOTTOM,40,3,this.defaultColor),this.lb=new d.CornerShape(d.CornerShape.LEFT_BOTTOM,40,3,this.defaultColor),this.addChild(this.gGrid),this.addChild(this.gBounds),this.addChild(this.top),this.addChild(this.bottom),this.addChild(this.left),this.addChild(this.right),this.addChild(this.lt),this.addChild(this.rt),this.addChild(this.rb),this.addChild(this.lb),this.minSize=this.lt.size),this.changeCornerColor(this.defaultColor)},j.showGrid=function(){h(this.displayAnimationId),this._tFrom=this.gGrid.alpha,this._tTo=1,this._tCurt=this._tFrom,this.displayAnimationId=i(this.changeGridAlpha.bind(this),this.easingDuration,"easeOutQuad",function(){},function(){this.gGrid.alpha=this._tTo},this)},j.changeGridAlpha=function(a,b,c){this._tCurt=f.Calc.getTweenValue(this._tFrom,this._tTo,a),this.gGrid.alpha=this._tCurt},j.drawGrid=function(a){a=f.Func.getDefaultParameters(a,3);var b=this.lt,c=this.rt,d=this.lb,e=(this.rb,c.x-b.x),g=d.y-b.y,h=e/a,i=g/a;this.gGrid.clear(),this.gGrid.lineStyle(1,16777215,.5);for(var j,k,l,m=0;m<a-1;m++)j=m+1,k=b.x+h*j,l=b.y+i*j,this.gGrid.moveTo(k,b.y),this.gGrid.lineTo(k,d.y),this.gGrid.moveTo(b.x,l),this.gGrid.lineTo(c.x,l)},j.hideGrid=function(a){a=f.Func.getDefaultParameters(a,!1),h(this.displayAnimationId),!1===a?(this._tFrom=this.gGrid.alpha,this._tTo=0,this._tCurt=this._tFrom,this.displayAnimationId=i(this.changeGridAlpha.bind(this),this.easingDuration,"easeOutQuad",function(){},function(){this.gGrid.alpha=this._tTo},this)):this.gGrid.alpha=0},j.changeCornerColor=function(a){this.lt.changeColor(a),this.rt.changeColor(a),this.rb.changeColor(a),this.lb.changeColor(a)},j.reset=function(a,b){this.initialize(a,b)},j.resizeCornerShape=function(a){this.lt.x=a.x,this.lt.y=a.y,this.rt.x=a.x+a.width,this.rt.y=a.y,this.rb.x=this.rt.x,this.rb.y=a.y+a.height,this.lb.x=this.lt.x,this.lb.y=this.rb.y},j.resizeControl=function(){this.top.x=this.lt.x,this.top.y=this.lt.y,this.top.width=this.rt.x-this.lt.x,this.bottom.x=this.lb.x,this.bottom.y=this.lb.y,this.bottom.width=this.top.width,this.left.x=this.lt.x,this.left.y=this.lt.y,this.left.height=this.rb.y-this.lt.y,this.right.x=this.rt.x,this.right.y=this.rt.y,this.right.height=this.left.height},j.drawBounds=function(){this.gBounds.clear(),this.gBounds.lineStyle(1,16777215,this.lineThickness),this.gBounds.moveTo(this.lt.x-this.lineThickness,this.lt.y-this.lineThickness),this.gBounds.lineTo(this.rt.x+this.lineThickness,this.rt.y-this.lineThickness),this.gBounds.lineTo(this.rb.x+this.lineThickness,this.rb.y+this.lineThickness),this.gBounds.lineTo(this.lb.x-this.lineThickness,this.lb.y+this.lineThickness),this.gBounds.lineTo(this.lt.x-this.lineThickness,this.lt.y-this.lineThickness),this.gBounds.endFill()},j.setSize=function(a,c){c=f.Func.getDefaultParameters(c,!0);var d=a.x,e=a.y;this.lt.x=d,this.lt.y=e,this.rt.x=d+a.width,this.rt.y=e,this.rb.x=this.rt.x,this.rb.y=e+a.height,this.lb.x=d,this.lb.y=this.rb.y,this.drawBounds(),this.resizeControl(),!0===c&&this.emit(b.UI_CHANGE)},j.setPoint=function(a,c){c=f.Func.getDefaultParameters(c,!0),this.lt.x=a.lt.x,this.lt.y=a.lt.y,this.rt.x=a.rt.x,this.rt.y=a.rt.y,this.rb.x=a.rb.x,this.rb.y=a.rb.y,this.lb.x=a.lb.x,this.lb.y=a.lb.y,this.drawBounds(),!0===c&&this.emit(b.UI_CHANGE)},j.moveCorner=function(a,b,c,d,e){var g,h,i,j,k=this.points,l=e.lt,m=e.rt,n=e.rb,o=e.lb;switch(a){case this.lt:k.lt.x=b,k.lt.y=c,k.rt.y=k.lt.y,k.lb.x=k.lt.x;break;case this.rt:k.rt.x=b,k.rt.y=c,k.lt.y=k.rt.y,k.rb.x=k.rt.x;break;case this.rb:k.rb.x=b,k.rb.y=c,k.rt.x=k.rb.x,k.lb.y=k.rb.y;break;case this.lb:k.lb.x=b,k.lb.y=c,k.lt.x=k.lb.x,k.rb.y=k.lb.y}switch(k=this.getImageBasedLocalPoints(k),k=this.image.getValidationPoints(k),g=Math.max(k.lt.x,k.lb.x),h=Math.max(k.lt.y,k.rt.y),i=Math.min(k.rt.x,k.rb.x),j=Math.min(k.rb.y,k.lb.y),g=Math.max(g,e.limitLeft),h=Math.max(h,e.limitTop),i=Math.min(i,e.limitRight),j=Math.min(j,e.limitBottom),a){case this.lt:null!==o&&null!==o.x&&(g=o.x.x>g?o.x.x:g),null!==m&&null!==m.y&&(h=m.y.y>h?m.y.y:h),k.lt.x=g,k.lt.y=h,k.rt.x=k.rb.x,k.rt.y=h,k.lb.x=g,k.lb.y=k.rb.y;break;case this.rt:null!==n&&null!==n.x&&(i=n.x.x<i?n.x.x:i),null!==l&&null!==l.y&&(h=l.y.y>h?l.y.y:h),k.lt.x=k.lb.x,k.lt.y=h,k.rt.x=i,k.rt.y=h,k.rb.x=i,k.rb.y=k.lb.y;break;case this.rb:null!==m&&null!==m.x&&(i=m.x.x<i?m.x.x:i),null!==o&&null!==o.y&&(j=o.y.y<j?o.y.y:j),k.rt.x=i,k.rt.y=k.lt.y,k.rb.x=i,k.rb.y=j,k.lb.x=k.lt.x,k.lb.y=j;break;case this.lb:null!==l&&null!==l.x&&(g=l.x.x>g?l.x.x:g),null!==n&&null!==n.y&&(j=n.y.y<j?n.y.y:j),k.lt.x=g,k.lt.y=k.rt.y,k.rb.x=k.rt.x,k.rb.y=j,k.lb.x=g,k.lb.y=j}var p=f.Calc.getBoundsByPoints(k),q=this.getActualPixelWidth(p),r=this.getActualPixelHeight(p);q<this.minSize||this.minSize;var s=this.minSize*this.image.scale.x,t=this.minSize*this.image.scale.y;if(p.width=p.width<s?s:p.width,p.height=p.height<t?t:p.height,0!==d)switch(p.width=f.Calc.getWidthByAspectRatio(d,p.height),a){case this.lt:p.x=this.rb.x-p.width,p.y=this.rb.y-p.height,k=f.Calc.getPointsByBounds(p),this.image.isLeftOut(this,k)&&(null!==o&&null!==o.x&&(g=o.x.x>g?o.x.x:g),k.lt.x=g,k.lb.x=g,p=f.Calc.getBoundsByPoints(k),p.height=f.Calc.getHeightByAspectRatio(d,p.width),p.x=this.rb.x-p.width,p.y=this.rb.y-p.height,k=f.Calc.getPointsByBounds(p));break;case this.rt:p.x=this.lb.x,p.y=this.lb.y-p.height,k=f.Calc.getPointsByBounds(p),this.image.isRightOut(this,k)&&(null!==n&&null!==n.x&&(i=n.x.x<i?n.x.x:i),k.rt.x=i,k.rb.x=i,p=f.Calc.getBoundsByPoints(k),p.height=f.Calc.getHeightByAspectRatio(d,p.width),p.x=this.lb.x,p.y=this.lb.y-p.height,k=f.Calc.getPointsByBounds(p));break;case this.rb:p.x=this.lt.x,p.y=this.lt.y,k=f.Calc.getPointsByBounds(p),this.image.isRightOut(this,k)&&(null!==m&&null!==m.x&&(i=m.x.x<i?m.x.x:i),k.rt.x=i,k.rb.x=i,p=f.Calc.getBoundsByPoints(k),p.height=f.Calc.getHeightByAspectRatio(d,p.width),p.x=this.lt.x,p.y=this.lt.y,k=f.Calc.getPointsByBounds(p));break;case this.lb:p.x=this.rt.x-p.width,p.y=this.rt.y,k=f.Calc.getPointsByBounds(p),this.image.isLeftOut(this,k)&&(null!==l&&null!==l.x&&(g=l.x.x>g?l.x.x:g),k.lt.x=g,k.lb.x=g,p=f.Calc.getBoundsByPoints(k),p.height=f.Calc.getHeightByAspectRatio(d,p.width),p.x=this.rt.x-p.width,p.y=this.rt.y,k=f.Calc.getPointsByBounds(p))}else{switch(a){case this.lt:p.x=this.rb.x-p.width,p.y=this.rb.y-p.height;break;case this.rt:p.x=this.lb.x,p.y=this.lb.y-p.height;break;case this.rb:p.x=this.lt.x,p.y=this.lt.y;break;case this.lb:p.x=this.rt.x-p.width,p.y=this.rt.y}k=f.Calc.getPointsByBounds(p)}return this.setPoint(k),f.Calc.getBoundsByPoints(k)},j.moveControl=function(a,b,c,d,e){var g,h,i,j,k,l,m,n,o,p,q=this.points,r=e.lt,s=e.rt,t=e.rb,u=e.lb;switch(a){case this.left:q.lt.x=b,q.lb.x=b;break;case this.top:q.lt.y=c,q.rt.y=c;break;case this.right:q.rt.x=b,q.rb.x=b;break;case this.bottom:q.lb.y=c,q.rb.y=c}switch(q=this.getImageBasedLocalPoints(q),q=this.image.getValidationPoints(q),g=Math.max(q.lt.x,q.lb.x),h=Math.max(q.lt.y,q.rt.y),i=Math.min(q.rt.x,q.rb.x),j=Math.min(q.rb.y,q.lb.y),g=Math.max(g,e.limitLeft),h=Math.max(h,e.limitTop),i=Math.min(i,e.limitRight),j=Math.min(j,e.limitBottom),a){case this.left:m=null!==r&&null!==r.x?r.x.x:f.Calc.LIMIT_LEFT,n=null!==u&&null!==u.x?u.x.x:f.Calc.LIMIT_LEFT,k=Math.max(m,n),k=k>g?k:g,b=b>k?b:k,q.lt.x=b,q.lt.y=q.rt.y,q.lb.x=b,q.lb.y=q.rb.y;break;case this.top:o=null!==r&&null!==r.y?r.y.y:f.Calc.LIMIT_TOP,p=null!==s&&null!==s.y?s.y.y:f.Calc.LIMIT_TOP,l=Math.max(o,p),l=l>h?l:h,c=c>l?c:l,q.lt.x=q.lb.x,q.lt.y=c,q.rt.x=q.rb.x,q.rt.y=c;break;case this.right:m=null!==s&&null!==s.x?s.x.x:f.Calc.LIMIT_RIGHT,n=null!==t&&null!==t.x?t.x.x:f.Calc.LIMIT_RIGHT,k=Math.min(m,n),k=k<i?k:i,b=b<k?b:k,q.rt.x=b,q.rt.y=q.lt.y,q.rb.x=b,q.rb.y=q.lb.y;break;case this.bottom:o=null!==u&&null!==u.y?u.y.y:f.Calc.LIMIT_BOTTOM,p=null!==t&&null!==t.y?t.y.y:f.Calc.LIMIT_BOTTOM,l=Math.min(o,p),l=l<j?l:j,c=c<l?c:l,q.lb.x=q.lt.x,q.lb.y=c,q.rb.x=q.rt.x,q.rb.y=c}var v={x:0,y:0},w=f.Calc.getBoundsByPoints(q),x=this.getActualPixelWidth(w),y=this.getActualPixelHeight(w);this.minSize,this.minSize;var z=this.minSize*this.image.scale.x,A=this.minSize*this.image.scale.y;w.width=w.width<z?z:w.width,w.height=w.height<A?A:w.height,0!==d&&(a===this.top||a===this.bottom?w.width=f.Calc.getWidthByAspectRatio(d,w.height):w.height=f.Calc.getHeightByAspectRatio(d,w.width)),q=f.Calc.getPointsByBounds(w);var B=q.lt.x+(q.rt.x-q.lt.x)/2,C=q.lt.y+(q.lb.y-q.lt.y)/2,D=w.width,E=w.height,F=D/2,G=E/2,H=f.Calc.getBoundsByPoints(this.points),I=H.width-w.width,J=H.height-w.height;switch(a){case this.left:v.x=this.rt.x,v.y=C+J/2,w.x=v.x-D,w.y=v.y-G;break;case this.right:v.x=q.lt.x,v.y=C+J/2,w.x=v.x,w.y=v.y-G;break;case this.top:v.x=B+I/2,v.y=this.lb.y,w.x=v.x-F,w.y=v.y-E;break;case this.bottom:v.x=B+I/2,v.y=q.lt.y,w.x=v.x-F,w.y=v.y}if(0!==d)switch(q=f.Calc.getPointsByBounds(w),a){case this.left:case this.right:(this.image.isLeftTopBottomOut(this,q)||this.image.isRightTopBottomOut(this,q))&&(o=null!==r&&null!==r.y?r.y.y:f.Calc.LIMIT_TOP,p=null!==s&&null!==s.y?s.y.y:f.Calc.LIMIT_TOP,l=Math.max(o,p),l=l>h?l:h,q.lt.x=q.lb.x,q.lt.y=l,q.rt.x=q.rb.x,q.rt.y=l,o=null!==u&&null!==u.y?u.y.y:f.Calc.LIMIT_BOTTOM,p=null!==t&&null!==t.y?t.y.y:f.Calc.LIMIT_BOTTOM,l=Math.min(o,p),l=l<j?l:j,q.lb.x=q.lt.x,q.lb.y=l,q.rb.x=q.rt.x,q.rb.y=l,w=f.Calc.getBoundsByPoints(q),w.width=f.Calc.getWidthByAspectRatio(d,w.height),B=q.lt.x+(q.rt.x-q.lt.x)/2,C=q.lt.y+(q.lb.y-q.lt.y)/2,D=w.width,E=w.height,F=D/2,G=E/2,I=H.width-w.width,J=H.height-w.height,a===this.left?(v.x=q.rt.x,v.y=C+J/2,w.x=v.x-D,w.y=v.y-G):(v.x=q.lt.x,v.y=C+J/2,w.x=v.x,w.y=v.y-G));break;case this.top:case this.bottom:(this.image.isLeftOut(this,q)||this.image.isRightOut(this,q))&&(m=null!==r&&null!==r.x?r.x.x:f.Calc.LIMIT_LEFT,n=null!==u&&null!==u.x?u.x.x:f.Calc.LIMIT_LEFT,k=Math.max(m,n),k=k>g?k:g,q.lt.x=k,q.lt.y=q.rt.y,q.lb.x=k,q.lb.y=q.rb.y,m=null!==s&&null!==s.x?s.x.x:f.Calc.LIMIT_RIGHT,n=null!==t&&null!==t.x?t.x.x:f.Calc.LIMIT_RIGHT,k=Math.min(m,n),k=k<i?k:i,q.rt.x=k,q.rt.y=q.lt.y,q.rb.x=k,q.rb.y=q.lb.y,w=f.Calc.getBoundsByPoints(q),w.height=f.Calc.getHeightByAspectRatio(d,w.width),B=q.lt.x+(q.rt.x-q.lt.x)/2,C=q.lt.y+(q.lb.y-q.lt.y)/2,D=w.width,E=w.height,F=D/2,G=E/2,I=H.width-w.width,J=H.height-w.height,a===this.top?(v.x=B+I/2,v.y=q.lb.y,w.x=v.x-F,w.y=v.y-E):(v.x=B+I/2,v.y=q.lt.y,w.x=v.x-F,w.y=v.y))}return q=f.Calc.getPointsByBounds(w),this.setPoint(q),f.Calc.getBoundsByPoints(q)},j.getImageBasedLocalPoints=function(a){return a=f.Func.getDefaultParameters(a,this.points),{lt:this.image.getLocal(a.lt),rt:this.image.getLocal(a.rt),rb:this.image.getLocal(a.rb),lb:this.image.getLocal(a.lb)}},j.fixBounds=function(a){var b=f.Calc.getPointsByBounds(a);b=this.getImageBasedLocalPoints(b),b=this.image.getValidationPoints(b);var c=Math.max(b.lt.x,b.lb.x),d=Math.max(b.lt.y,b.rt.y),e=Math.min(b.rt.x,b.rb.x),g=Math.min(b.rb.y,b.lb.y);return b.lt.x=c,b.lt.y=d,b.rt.x=e,b.rt.y=d,b.rb.x=e,b.rb.y=g,b.lb.x=c,b.lb.y=g,f.Calc.getBoundsByPoints(b)},j.fix=function(a){return a=f.Func.getDefaultParameters(a,this.points),a=this.getImageBasedLocalPoints(a),a=this.image.getValidationPoints(a),this.setPoint(a),a},j.getLeft=function(a,b){var c,d;return c=b.isPassedLeftLine(a.lt)?b.getLeftIntersectionPoint(a.lt).x:b.isPassedTopLine(a.lt)?b.getTopIntersectionPoint(a.lt).x:b.isPassedBottomLine(a.lt)?b.getBottomIntersectionPoint(a.lt).x:a.lt.x,d=b.isPassedLeftLine(a.lb)?b.getLeftIntersectionPoint(a.lb).x:b.isPassedTopLine(a.lb)?b.getTopIntersectionPoint(a.lb).x:b.isPassedBottomLine(a.lb)?b.getBottomIntersectionPoint(a.lb).x:a.lb.x,Math.max(c,d)},j.getTop=function(a,b){var c,d;return c=b.isPassedTopLine(a.lt)?b.getTopIntersectionPoint(a.lt).y:b.isPassedLeftLine(a.lt)?b.getLeftIntersectionPoint(a.lt).y:b.isPassedRightLine(a.lt)?b.getRightIntersectionPoint(a.lt).y:a.lt.y,d=b.isPassedTopLine(a.rt)?b.getTopIntersectionPoint(a.rt).y:b.isPassedLeftLine(a.rt)?b.getLeftIntersectionPoint(a.rt).y:b.isPassedRightLine(a.rt)?b.getRightIntersectionPoint(a.rt).y:a.rt.y,Math.max(c,d)},j.getRight=function(a,b){var c,d;return c=b.isPassedRightLine(a.rt)?b.getRightIntersectionPoint(a.rt).x:b.isPassedTopLine(a.rt)?b.getTopIntersectionPoint(a.rt).x:b.isPassedBottomLine(a.rt)?b.getBottomIntersectionPoint(a.rt).x:a.rt.x,d=b.isPassedRightLine(a.rb)?b.getRightIntersectionPoint(a.rb).x:b.isPassedTopLine(a.rb)?b.getTopIntersectionPoint(a.rb).x:b.isPassedBottomLine(a.rb)?b.getBottomIntersectionPoint(a.rb).x:a.rb.x,Math.min(c,d)},j.getBottom=function(a,b){var c,d;return c=b.isPassedBottomLine(a.rb)?b.getBottomIntersectionPoint(a.rb).y:b.isPassedLeftLine(a.rb)?b.getLeftIntersectionPoint(a.rb).y:b.isPassedRightLine(a.rb)?b.getRightIntersectionPoint(a.rb).y:a.rb.y,d=b.isPassedBottomLine(a.lb)?b.getBottomIntersectionPoint(a.lb).y:b.isPassedLeftLine(a.lb)?b.getLeftIntersectionPoint(a.lb).y:b.isPassedRightLine(a.lb)?b.getRightIntersectionPoint(a.lb).y:a.lb.y,Math.min(c,d)},j.pointsToBounds=function(a){return{x:a.lt.x,y:a.lt.y,width:a.rt.x-a.lt.x,height:a.rb.y-a.rt.y}},j.getActualPixelWidth=function(a){return a=f.Func.getDefaultParameters(a,this.bounds),Math.round(a.width/this.image.scale.x)},j.getActualPixelHeight=function(a){return a=f.Func.getDefaultParameters(a,this.bounds),Math.round(a.height/this.image.scale.y)},j.isLtInsideBounds=function(a,b){return b=f.Func.getDefaultParameters(b,this.points),f.Calc.isInsideSquare(b.lt,a.lt,a.rt,a.rb,a.lb)},j.isRtInsideBounds=function(a,b){return b=f.Func.getDefaultParameters(b,this.points),f.Calc.isInsideSquare(b.rt,a.lt,a.rt,a.rb,a.lb)},j.isRbInsideBounds=function(a,b){return b=f.Func.getDefaultParameters(b,this.points),f.Calc.isInsideSquare(b.rb,a.lt,a.rt,a.rb,a.lb)},j.isLbInsideBounds=function(a,b){return b=f.Func.getDefaultParameters(b,this.points),f.Calc.isInsideSquare(b.lb,a.lt,a.rt,a.rb,a.lb)},j.getDimension=function(){return{width:this.getActualPixelWidth(),height:this.getActualPixelHeight()}},j.changeCursor=function(a){switch(a){case this.lt:this.defaultCursor="nwse-resize";break;case this.rt:this.defaultCursor="nesw-resize";break;case this.rb:this.defaultCursor="nwse-resize";break;case this.lb:this.defaultCursor="nesw-resize";break;case this.left:this.defaultCursor="ew-resize";break;case this.top:this.defaultCursor="ns-resize";break;case this.right:this.defaultCursor="ew-resize";break;case this.bottom:this.defaultCursor="ns-resize"}this.emit(b.CHANGE_CURSOR,{currentCursorStyle:this.defaultCursor})},j.onCornerDown=function(a){a.stopPropagation(),this.selectedTarget=a.target,this.dragStartX=this.prevDragX=f.Mouse.globalX,this.dragStartY=this.prevDragY=f.Mouse.globalY,this.changeCursor(a.target),this.addCornerMoveEvent(),this.removeCornerDownEvent(),this.emit(b.CORNER_MOVE_START,{target:this.selectedTarget,dragStartX:this.dragStartX,dragStartY:this.dragStartY})},j.onCornerMove=function(a){this.currentDragX=f.Mouse.globalX,this.currentDragY=f.Mouse.globalY,this.dx=this.currentDragX-this.prevDragX,this.dy=this.currentDragY-this.prevDragY,this.emit(b.CORNER_MOVE,{dx:this.dx,dy:this.dy,prevX:this.prevDragX,prevY:this.prevDragY,target:this.selectedTarget,mouseX:f.Mouse.globalX,mouseY:f.Mouse.globalY}),this.prevDragX=this.currentDragX,this.prevDragY=this.currentDragY,this.resizeControl()},j.onCornerUp=function(a){this.addCornerDownEvent(),this.removeCornerMoveEvent(),this.emit(b.CORNER_MOVE_END,{target:this.selectedTarget}),this.selectedTarget=null},j.onControlDown=function(a){a.stopPropagation(),this.selectedTarget=a.target,this.dragStartX=this.prevDragX=f.Mouse.globalX,this.dragStartY=this.prevDragY=f.Mouse.globalY,this.changeCursor(a.target),this.addControlMoveEvent(),this.removeControlDownEvent(),this.emit(b.CONTROL_MOVE_START,{target:this.selectedTarget,dragStartX:this.dragStartX,dragStartY:this.dragStartY})},j.onControlMove=function(a){this.currentDragX=f.Mouse.globalX,this.currentDragY=f.Mouse.globalY,this.dx=this.currentDragX-this.prevDragX,this.dy=this.currentDragY-this.prevDragY,this.emit(b.CONTROL_MOVE,{dx:this.dx,dy:this.dy,prevX:this.prevDragX,prevY:this.prevDragY,target:this.selectedTarget,mouseX:f.Mouse.globalX,mouseY:f.Mouse.globalY}),this.prevDragX=this.currentDragX,this.prevDragY=this.currentDragY,this.resizeControl()},j.onControlUp=function(a){this.addControlDownEvent(),this.removeControlMoveEvent(),this.emit(b.CONTROL_MOVE_END,{target:this.selectedTarget}),this.selectedTarget=null},j.addCursorEvent=function(){this.lt.mouseover=this.changeCursor.bind(this,this.lt),this.rt.mouseover=this.changeCursor.bind(this,this.rt),this.rb.mouseover=this.changeCursor.bind(this,this.rb),this.lb.mouseover=this.changeCursor.bind(this,this.lb),this.left.mouseover=this.changeCursor.bind(this,this.left),this.top.mouseover=this.changeCursor.bind(this,this.top),this.right.mouseover=this.changeCursor.bind(this,this.right),this.bottom.mouseover=this.changeCursor.bind(this,this.bottom)},j.addCornerDownEvent=function(){this._cornerDownListener=this.onCornerDown.bind(this),this.lt.on("mousedown",this._cornerDownListener),this.rt.on("mousedown",this._cornerDownListener),this.rb.on("mousedown",this._cornerDownListener),this.lb.on("mousedown",this._cornerDownListener)},j.removeCornerDownEvent=function(){this.lt.off("mousedown",this._cornerDownListener),this.rt.off("mousedown",this._cornerDownListener),this.rb.off("mousedown",this._cornerDownListener),this.lb.off("mousedown",this._cornerDownListener)},j.addCornerMoveEvent=function(){this._cornerUpListener=this.onCornerUp.bind(this),this._cornerMoveListener=this.onCornerMove.bind(this),window.document.addEventListener("mouseup",this._cornerUpListener),window.document.addEventListener("mousemove",this._cornerMoveListener)},j.removeCornerMoveEvent=function(){window.document.removeEventListener("mouseup",this._cornerUpListener),window.document.removeEventListener("mousemove",this._cornerMoveListener)},j.addControlDownEvent=function(){this._controlDownListener=this.onControlDown.bind(this),this.left.on("mousedown",this._controlDownListener),this.top.on("mousedown",this._controlDownListener),this.right.on("mousedown",this._controlDownListener),this.bottom.on("mousedown",this._controlDownListener)},j.removeControlDownEvent=function(){this.left.off("mousedown",this._controlDownListener),this.top.off("mousedown",this._controlDownListener),this.right.off("mousedown",this._controlDownListener),this.bottom.off("mousedown",this._controlDownListener)},j.addControlMoveEvent=function(){this._controlUpListener=this.onControlUp.bind(this),this._controlMoveListener=this.onControlMove.bind(this),window.document.addEventListener("mouseup",this._controlUpListener),window.document.addEventListener("mousemove",this._controlMoveListener)},j.removeControlMoveEvent=function(){window.document.removeEventListener("mouseup",this._controlUpListener),window.document.removeEventListener("mousemove",this._controlMoveListener)},j.testSetPointWithAspectRatio=function(a,b,c){this.lt.x=a.lt.x,this.lt.y=a.lt.y,this.rt.x=a.rt.x,this.rt.y=a.rt.y,this.rb.x=a.rb.x,this.rb.y=a.rb.y,this.lb.x=a.lb.x,this.lb.y=a.lb.y,this.testSetAspectRatio(b,c)},j.testSetAspectRatio=function(a,b){b=f.Func.getDefaultParameters(b,0);var c=this.bounds;switch(c.width=f.Calc.getWidthByAspectRatio(b,c.height),a){case this.lt:c.x=this.rb.x-c.width,c.y=this.rb.y-c.height;break;case this.rt:c.x=this.lb.x,c.y=this.lb.y-c.height;break;case this.rb:c.x=this.lt.x,c.y=this.lt.y;break;case this.lb:c.x=this.rt.x-c.width,c.y=this.rt.y}this.setSize(c)},j.moveControlBackUp=function(a,b,c,d,e){var g,h,i,j,k,l,m,n,o,p,q,r,s,t,u=this.points,v=e.lt,w=e.rt,x=e.rb,y=e.lb;switch(a){case this.left:u.lt.x=b,u.lb.x=b;break;case this.top:u.lt.y=c,u.rt.y=c;break;case this.right:u.rt.x=b,u.rb.x=b;break;case this.bottom:u.lb.y=c,
u.rb.y=c}switch(u=this.getImageBasedLocalPoints(u),u=this.image.getValidationPoints(u),g=Math.max(u.lt.x,u.lb.x),h=Math.max(u.lt.y,u.rt.y),i=Math.min(u.rt.x,u.rb.x),j=Math.min(u.rb.y,u.lb.y),q=null!==v&&null!==v.x?v.x.x:f.Calc.LIMIT_LEFT,r=null!==y&&null!==y.x?y.x.x:f.Calc.LIMIT_LEFT,o=Math.max(q,r),k=o>g?o:g,s=null!==v&&null!==v.y?v.y.y:f.Calc.LIMIT_TOP,t=null!==w&&null!==w.y?w.y.y:f.Calc.LIMIT_TOP,p=Math.max(s,t),l=p>h?p:h,q=null!==w&&null!==w.x?w.x.x:f.Calc.LIMIT_RIGHT,r=null!==x&&null!==x.x?x.x.x:f.Calc.LIMIT_RIGHT,o=Math.min(q,r),m=o<i?o:i,s=null!==y&&null!==y.y?y.y.y:f.Calc.LIMIT_BOTTOM,t=null!==x&&null!==x.y?x.y.y:f.Calc.LIMIT_BOTTOM,p=Math.min(s,t),n=p<j?p:j,a){case this.left:b=b>k?b:k,u.lt.x=b,u.lt.y=u.rt.y,u.lb.x=b,u.lb.y=u.rb.y;break;case this.top:c=c>l?c:l,u.lt.x=u.lb.x,u.lt.y=c,u.rt.x=u.rb.x,u.rt.y=c;break;case this.right:b=b<m?b:m,u.rt.x=b,u.rt.y=u.lt.y,u.rb.x=b,u.rb.y=u.lb.y;break;case this.bottom:c=c<n?c:n,u.lb.x=u.lt.x,u.lb.y=c,u.rb.x=u.rt.x,u.rb.y=c}var z={x:0,y:0},A=!1,B=!1,C=f.Calc.getBoundsByPoints(u),D=this.getActualPixelWidth(C),E=this.getActualPixelHeight(C);D<this.minSize&&(A=!0),E<this.minSize&&(B=!0),C.width=D<this.minSize?this.minSize*this.image.scale.x:C.width,C.height=E<this.minSize?this.minSize*this.image.scale.y:C.height,0!==d&&(a===this.top||a===this.bottom?C.width=f.Calc.getWidthByAspectRatio(d,C.height):C.height=f.Calc.getHeightByAspectRatio(d,C.width)),u=f.Calc.getPointsByBounds(C);var F=u.lt.x+(u.rt.x-u.lt.x)/2,G=u.lt.y+(u.lb.y-u.lt.y)/2,H=C.width,I=C.height,J=H/2,K=I/2,L=f.Calc.getBoundsByPoints(this.points),M=L.width-C.width,N=L.height-C.height;switch(a){case this.left:z.x=u.rt.x,z.y=G+N/2,C.x=z.x-H,A&&(C.x=this.rt.x-C.width),C.y=z.y-K;break;case this.right:z.x=u.lt.x,z.y=G+N/2,C.x=z.x,C.y=z.y-K;break;case this.top:z.x=F+M/2,z.y=u.lb.y,C.x=z.x-J,C.y=z.y-I,B&&(C.y=this.rb.y-C.height);break;case this.bottom:z.x=F+M/2,z.y=u.lt.y,C.x=z.x-J,C.y=z.y}switch(u=f.Calc.getPointsByBounds(C),a){case this.left:case this.right:(this.image.isLeftTopBottomOut(this,u)||this.image.isRightTopBottomOut(this,u))&&(s=null!==v&&null!==v.y?v.y.y:f.Calc.LIMIT_TOP,t=null!==w&&null!==w.y?w.y.y:f.Calc.LIMIT_TOP,p=Math.max(s,t),p=p>h?p:h,u.lt.x=u.lb.x,u.lt.y=p,u.rt.x=u.rb.x,u.rt.y=p,s=null!==y&&null!==y.y?y.y.y:f.Calc.LIMIT_BOTTOM,t=null!==x&&null!==x.y?x.y.y:f.Calc.LIMIT_BOTTOM,p=Math.min(s,t),p=p<j?p:j,u.lb.x=u.lt.x,u.lb.y=p,u.rb.x=u.rt.x,u.rb.y=p,C=f.Calc.getBoundsByPoints(u),0!==d&&(C.width=f.Calc.getWidthByAspectRatio(d,C.height)),F=u.lt.x+(u.rt.x-u.lt.x)/2,G=u.lt.y+(u.lb.y-u.lt.y)/2,H=C.width,I=C.height,J=H/2,K=I/2,M=L.width-C.width,N=L.height-C.height,a===this.left?(z.x=u.rt.x,z.y=G+N/2,C.x=z.x-H,C.y=z.y-K):(z.x=u.lt.x,z.y=G+N/2,C.x=z.x,C.y=z.y-K));break;case this.top:case this.bottom:(this.image.isLeftOut(this,u)||this.image.isRightOut(this,u))&&(q=null!==v&&null!==v.x?v.x.x:f.Calc.LIMIT_LEFT,r=null!==y&&null!==y.x?y.x.x:f.Calc.LIMIT_LEFT,o=Math.max(q,r),o=o>g?o:g,u.lt.x=o,u.lt.y=u.rt.y,u.lb.x=o,u.lb.y=u.rb.y,q=null!==w&&null!==w.x?w.x.x:f.Calc.LIMIT_RIGHT,r=null!==x&&null!==x.x?x.x.x:f.Calc.LIMIT_RIGHT,o=Math.min(q,r),o=o<i?o:i,u.rt.x=o,u.rt.y=u.lt.y,u.rb.x=o,u.rb.y=u.lb.y,C=f.Calc.getBoundsByPoints(u),0!==d&&(C.height=f.Calc.getHeightByAspectRatio(d,C.width)),F=u.lt.x+(u.rt.x-u.lt.x)/2,G=u.lt.y+(u.lb.y-u.lt.y)/2,H=C.width,I=C.height,J=H/2,K=I/2,M=L.width-C.width,N=L.height-C.height,a===this.top?(z.x=F+M/2,z.y=u.lb.y,C.x=z.x-J,C.y=z.y-I):(z.x=F+M/2,z.y=u.lt.y,C.x=z.x-J,C.y=z.y))}u=f.Calc.getPointsByBounds(C),this.setPoint(u)},void 0!==(0,e.default)(a)&&void 0!==(0,e.default)(a.exports)?a.exports=b:usenamespace("editor.es5.ui").ResizeUI=b}()}).call(b,c(6)(a))},function(a,b,c){"use strict";(function(a){function b(a){return a&&a.__esModule?a:{"default":a}}var d=c(4),e=b(d),f=c(22),g=b(f);!function(){function b(a){PIXI.Sprite.call(this),this.initialize(a),this.draw(a)}b.ROW="row",b.COL="col",b.CORNER="corner";var c=b.prototype=(0,g.default)(PIXI.Sprite.prototype);c.initialize=function(a){this.type=a,this.size=32,this.half=this.size/2,this.globalAlpha=0,this.interactive=!0,this.buttonMode=!0,this.defaultCursor="default",this.graphics=new PIXI.Graphics,this.addChild(this.graphics)},c.draw=function(a){switch(this.graphics.clear(),a){case b.ROW:this.graphics.beginFill(16724736,this.globalAlpha),this.graphics.drawRect(0,-this.half,1,this.size);break;case b.COL:this.graphics.beginFill(16724736,this.globalAlpha),this.graphics.drawRect(-this.half,0,this.size,1);break;case b.CORNER:this.graphics.beginFill(4359668,this.globalAlpha),this.graphics.drawRect(-this.half,-this.half,this.size,this.size)}this.graphics.endFill()},void 0!==(0,e.default)(a)&&void 0!==(0,e.default)(a.exports)?a.exports=b:usenamespace("editor.es5.ui").ControlArea=b}()}).call(b,c(6)(a))},function(a,b,c){"use strict";(function(a){function b(a){return a&&a.__esModule?a:{"default":a}}var d=c(4),e=b(d),f=c(22),g=b(f);!function(){function b(a,b,c,d){Object.defineProperty(this,"viewport",{get:this.getViewport,set:this.setViewport}),PIXI.Sprite.call(this),this.initialize(a,b,c,d),this.render(),this.addMouseDownEvent()}var d={};d.Mouse=c(75),d.Func=c(34),d.Calc=c(61),b.ROTATE_START="rotateStart",b.ROTATE="rotate",b.ROTATE_END="rotateEnd";var f=b.prototype=(0,g.default)(PIXI.Sprite.prototype);f.initialize=function(a,b,c,e){this.image=c,this.canvas=a,this.interactive=!0,this.buttonMode=!0,this.defaultCursor="inherit",this.viewport=d.Func.getDefaultParameters(b,{x:0,y:0,width:a.width,height:a.height}),this.graphics||(this.graphics=new PIXI.Graphics,this.addChild(this.graphics))},f.reset=function(a,b,c,d){this.initialize(a,b,c,d)},f.render=function(){this.graphics.clear(),this.graphics.beginFill(16711935,0),this.graphics.drawRect(0,0,1,1),this.graphics.endFill()},f.resize=function(){this.graphics.width=this.canvas.width,this.graphics.height=this.canvas.height},f.changeCursor=function(){},f.addCursorEvent=function(){this.mouseover=this.changeCursor.bind(this)},f.addMouseDownEvent=function(){this._mouseDownListener=this.onMouseDown.bind(this),this.on("mousedown",this._mouseDownListener)},f.removeMouseDownEvent=function(){this.off("mousedown",this._mouseDownListener)},f.addMouseMoveEvent=function(){this._mouseMoveListener=this.onMouseMove.bind(this),this._mouseUpListener=this.onMouseUp.bind(this),window.document.addEventListener("mousemove",this._mouseMoveListener),window.document.addEventListener("mouseup",this._mouseUpListener)},f.removeMouseMoveEvent=function(){window.document.removeEventListener("mousemove",this._mouseMoveListener),window.document.removeEventListener("mouseup",this._mouseUpListener)},f.onMouseDown=function(a){this.prevRotation=d.Calc.getRotation({x:this.centerX,y:this.centerY},{x:d.Mouse.globalX,y:d.Mouse.globalY}),this.changeCursor(),this.emit(b.ROTATE_START,{prevRotation:this.prevRotation,currentRotation:this.prevRotation,currentRadian:d.Calc.toRadians(this.prevRotation)}),a.stopPropagation(),this.addMouseMoveEvent(),this.removeMouseDownEvent()},f.onMouseMove=function(a){this.currentRotation=d.Calc.getRotation({x:this.centerX,y:this.centerY},{x:d.Mouse.globalX,y:d.Mouse.globalY}),this.change=this.currentRotation-this.prevRotation,this.absChange=this.change<0?-1*this.change:this.change,this.absChange<100&&this.emit(b.ROTATE,{prevRotation:this.prevRotation,currentRotation:this.currentRotation,currentRadian:d.Calc.toRadians(this.currentRotation),change:d.Calc.toRadians(this.change)}),this.prevRotation=this.currentRotation},f.onMouseUp=function(a){this.emit(b.ROTATE_END),this.addMouseDownEvent(),this.removeMouseMoveEvent()},f.getViewport=function(){return this._viewport},f.setViewport=function(a){a&&(this._viewport=a,this.centerX=this.viewport.x+this.viewport.width/2,this.centerY=this.viewport.y+this.viewport.height/2)},void 0!==(0,e.default)(a)&&void 0!==(0,e.default)(a.exports)?a.exports=b:usenamespace("editor.es5.ui").RotateUI=b}()}).call(b,c(6)(a))},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(21),f=d(e),g=c(0),h=d(g),i=c(1),j=d(i),k=c(2),l=d(k),m=c(3),n=d(m),o=c(23),p=d(o),q=c(92),r=(d(q),c(10)),s=c(48),t=c(60),u=d(t),v=c(326),w=d(v),x=c(134),y=void 0,z=function(a){function b(c,d){(0,h.default)(this,b);var e=(0,l.default)(this,a.call(this,c,d));return y=(0,s.makeLoadImage)(e.options.crossOrigin),e._init(),e}return(0,n.default)(b,a),b.prototype.start=function(){a.prototype.start.call(this)},b.prototype.suspend=function(){return a.prototype.suspend.call(this)},b.prototype.snapshot=function(){return{index:this._index,values:this._values.map(function(a){return a})}},b.prototype.reset=function(b){var c=this,d=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(0,u.default)(this.complete,"ColorTable이 설정되지 않았습니다."),b?(this._index=b.index,this._values=b.values,this._filter.colorTable=this.colorTables[b.index],this._filter.value=this.value):(this._index=-1,this._values.forEach(function(a,b,d){d[b]=c.options.defaultValue}),this._filter.colorTable=null),a.prototype.reset.call(this,d)},b.prototype._init=function(){var a=this.stage.glAvailable;this._filter=a?new w.default:new x,this._filter.interpolate=this.options.interpolate,this._filters=[this._filter],this._values=null,this._colorTables=null,this._index=-1,this._pending=!1,this.onColorTableLoadComplete=this.onColorTableLoadComplete.bind(this),this.onFail=this.onFail.bind(this),this._initColorTables()},b.prototype._initColorTables=function(){if(!this._setColorTables(this.options.colorTables)){var a=this.options.colorTableURLs;if(a&&0!=a.length){var b=a.map(function(a){return y(a)});this._pending=!0,f.default.all(b).then(this.onColorTableLoadComplete).catch(this.onFail)}else this.emit("ready","ready")}},b.prototype._setColorTables=function(a){return!(!a||0==a.length)&&(this.onColorTableLoadComplete(a),!0)},b.prototype.onColorTableLoadComplete=function(a){var b=this;this._values=[],this._colorTables=a.map(function(a){return b._values.push(b.options.defaultValue),(0,r.toImageData)(a)}),this._pending=!1,this.emit("ready","ready")},b.prototype.onFail=function(a){return void 0,f.default.reject(a)},(0,j.default)(b,[{key:"modified",get:function(){return!!this.stage.ready&&!!this._filter.colorTable}},{key:"pending",get:function(){return this._pending}},{key:"index",get:function(){return this._index},set:function(a){(0,u.default)(this.complete,"ColorTable이 설정되지 않았습니다."),this._index!=a&&(this._index=a,this._filter.colorTable=this._colorTables[a],this._filter.value=this.value,this.invalidate(this._filter))}},{key:"value",get:function(){return-1==this.index?0:this._values[this.index]},set:function(a){(0,u.default)(this.complete,"ColorTable이 설정되지 않았습니다."),-1!=this.index&&(this._values[this.index]=a,this._filter.value=this.value,this.invalidate(this._filter))}},{key:"colorTables",get:function(){return this._colorTables}},{key:"foodieFilter",get:function(){return this._filter}},{key:"complete",get:function(){return!!this.colorTables&&0!=this.colorTables.length}},{key:"interpolate",get:function(){return this._filter.interpolate},set:function(a){this._filter.interpolate=a}}]),b}(p.default);b.default=z},function(a,b,c){(function(b){!function(c){function d(){}function e(a,b){return function(){a.apply(b,arguments)}}function f(a){if(!(this instanceof f))throw new TypeError("Promises must be constructed via new");if("function"!=typeof a)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],l(a,this)}function g(a,b){for(;3===a._state;)a=a._value;if(0===a._state)return void a._deferreds.push(b);a._handled=!0,f._immediateFn(function(){var c=1===a._state?b.onFulfilled:b.onRejected;if(null===c)return void(1===a._state?h:i)(b.promise,a._value);var d;try{d=c(a._value)}catch(e){return void i(b.promise,e)}h(b.promise,d)})}function h(a,b){try{if(b===a)throw new TypeError("A promise cannot be resolved with itself.");if(b&&("object"==typeof b||"function"==typeof b)){var c=b.then;if(b instanceof f)return a._state=3,a._value=b,void j(a);if("function"==typeof c)return void l(e(c,b),a)}a._state=1,a._value=b,j(a)}catch(d){i(a,d)}}function i(a,b){a._state=2,a._value=b,j(a)}function j(a){2===a._state&&0===a._deferreds.length&&f._immediateFn(function(){a._handled||f._unhandledRejectionFn(a._value)});for(var b=0,c=a._deferreds.length;b<c;b++)g(a,a._deferreds[b]);a._deferreds=null}function k(a,b,c){this.onFulfilled="function"==typeof a?a:null,this.onRejected="function"==typeof b?b:null,this.promise=c}function l(a,b){var c=!1;try{a(function(a){c||(c=!0,h(b,a))},function(a){c||(c=!0,i(b,a))})}catch(d){if(c)return;c=!0,i(b,d)}}var m=setTimeout;f.prototype.catch=function(a){return this.then(null,a)},f.prototype.then=function(a,b){var c=new this.constructor(d);return g(this,new k(a,b,c)),c},f.all=function(a){return new f(function(b,c){function d(a,g){try{if(g&&("object"==typeof g||"function"==typeof g)){var h=g.then;if("function"==typeof h)return void h.call(g,function(b){d(a,b)},c)}e[a]=g,0==--f&&b(e)}catch(i){c(i)}}if(!a||void 0===a.length)throw new TypeError("Promise.all accepts an array");var e=Array.prototype.slice.call(a);if(0===e.length)return b([]);for(var f=e.length,g=0;g<e.length;g++)d(g,e[g])})},f.resolve=function(a){return a&&"object"==typeof a&&a.constructor===f?a:new f(function(b){b(a)})},f.reject=function(a){return new f(function(b,c){c(a)})},f.race=function(a){return new f(function(b,c){for(var d=0,e=a.length;d<e;d++)a[d].then(b,c)})},f._immediateFn="function"==typeof b&&function(a){b(a)}||function(a){m(a,0)},f._unhandledRejectionFn=function(a){"undefined"!=typeof console&&console&&void 0},f._setImmediateFn=function(a){f._immediateFn=a},f._setUnhandledRejectionFn=function(a){f._unhandledRejectionFn=a},void 0!==a&&a.exports?a.exports=f:c.Promise||(c.Promise=f)}(this)}).call(b,c(324).setImmediate)},function(a,b,c){function d(a,b){this._id=a,this._clearFn=b}var e=Function.prototype.apply;b.setTimeout=function(){return new d(e.call(setTimeout,window,arguments),clearTimeout)},b.setInterval=function(){return new d(e.call(setInterval,window,arguments),clearInterval)},b.clearTimeout=b.clearInterval=function(a){a&&a.close()},d.prototype.unref=d.prototype.ref=function(){},d.prototype.close=function(){this._clearFn.call(window,this._id)},b.enroll=function(a,b){clearTimeout(a._idleTimeoutId),a._idleTimeout=b},b.unenroll=function(a){clearTimeout(a._idleTimeoutId),a._idleTimeout=-1},b._unrefActive=b.active=function(a){clearTimeout(a._idleTimeoutId);var b=a._idleTimeout;b>=0&&(a._idleTimeoutId=setTimeout(function(){a._onTimeout&&a._onTimeout()},b))},c(325),b.setImmediate=setImmediate,b.clearImmediate=clearImmediate},function(a,b,c){(function(a,b){!function(a,c){"use strict";function d(a){"function"!=typeof a&&(a=new Function(""+a));for(var b=new Array(arguments.length-1),c=0;c<b.length;c++)b[c]=arguments[c+1];var d={callback:a,args:b};return j[i]=d,h(i),i++}function e(a){delete j[a]}function f(a){var b=a.callback,d=a.args;switch(d.length){case 0:b();break;case 1:b(d[0]);break;case 2:b(d[0],d[1]);break;case 3:b(d[0],d[1],d[2]);break;default:b.apply(c,d)}}function g(a){if(k)setTimeout(g,0,a);else{var b=j[a];if(b){k=!0;try{f(b)}finally{e(a),k=!1}}}}if(!a.setImmediate){var h,i=1,j={},k=!1,l=a.document,m=Object.getPrototypeOf&&Object.getPrototypeOf(a);m=m&&m.setTimeout?m:a,"[object process]"==={}.toString.call(a.process)?function(){h=function(a){b.nextTick(function(){g(a)})}}():function(){if(a.postMessage&&!a.importScripts){var b=!0,c=a.onmessage;return a.onmessage=function(){b=!1},a.postMessage("","*"),a.onmessage=c,b}}()?function(){var b="setImmediate$"+Math.random()+"$",c=function(c){c.source===a&&"string"==typeof c.data&&0===c.data.indexOf(b)&&g(+c.data.slice(b.length))};a.addEventListener?a.addEventListener("message",c,!1):a.attachEvent("onmessage",c),h=function(c){a.postMessage(b+c,"*")}}():a.MessageChannel?function(){var a=new MessageChannel;a.port1.onmessage=function(a){g(a.data)},h=function(b){a.port2.postMessage(b)}}():l&&"onreadystatechange"in l.createElement("script")?function(){var a=l.documentElement;h=function(b){var c=l.createElement("script");c.onreadystatechange=function(){g(b),c.onreadystatechange=null,a.removeChild(c),c=null},a.appendChild(c)}}():function(){h=function(a){setTimeout(g,0,a)}}(),m.setImmediate=d,m.clearImmediate=e}}("undefined"==typeof self?void 0===a?this:a:self)}).call(b,c(91),c(176))},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(1),h=d(g),i=c(2),j=d(i),k=c(3),l=d(k),m=c(44),n=d(m),o=c(46),p=d(o),q=(c(24),function(a){function b(){var c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;(0,f.default)(this,b);var d=(0,j.default)(this,a.call(this,c));return d._colorTable=null,d._tex2d=p.default.createTextureForSingleImage(d.gl).initWithPixels(512,512),d._value=0,d}return(0,l.default)(b,a),b.prototype.bindSourceTexture=function(a){this.bindTexture(a,0),this.bindTexture(this.colorTableTexture,1,"colorTable")},b.prototype.draw=function(){var b=this.program;this.gl;b.setUniformf("intensity",this.value),a.prototype.draw.call(this)},(0,h.default)(b,[{key:"changed",get:function(){return 0!==this.value&&null!==this.colorTable}},{key:"value",get:function(){return this.colorTable?this._value:0},set:function(a){this._value=a}},{key:"colorTable",get:function(){return this._colorTable},set:function(a){if(this._colorTable!==a){this._colorTable=a;var b=this.colorTableTexture2d;if(a instanceof ImageData){var c=new Uint8Array(a.data.length);c.set(a.data),b.bind(function(a){return b.updateTexturePixels(0,0,512,512,c)})}else a&&b.bind(function(c){return b.updateTextureSource(0,0,a)})}}},{key:"colorTableTexture2d",get:function(){return this._tex2d}},{key:"colorTableTexture",get:function(){return this.colorTableTexture2d.texture}},{key:"fragmentSource",get:function(){return"\n	/**\n	 * 텍스쳐 좌표 \n	 */\n	varying highp vec2 vTexCoord;\n	\n	/**\n	 * 소스 텍스쳐\n	 */\n	uniform sampler2D texture;\n	/**\n	 * 컬러 테이블 텍스쳐 \n	 */\n	uniform sampler2D colorTable;\n	\n	/**\n	 * 필터 강도. \n	 */\n	uniform lowp float intensity;\n	\n	/**\n	 * 1. 소스 텍스쳐의 픽셀을 가져온다. \n	 * 2. blue channel을 통해 컬러 테이블의 작은 사각형 위치를 찾는다. \n	 * 2-1. 이때 floor와 ceil 연산으로 좌, 우 각각 하나씩 가져온다. \n	 * 3. red(x), green(y) channel을 통해 작은 사각형 내 픽셀을 가져온다. \n	 * 4. 가져온 픽셀을 보간한다. \n	 * 5. 소스 픽셀과 컬러 테이블 픽셀을 intensity에 따라 보간하여 반환한다. \n	 * @return {[type]} [description]\n	 */\n	void main() {\n		highp vec4 textureColor = texture2D(texture, vTexCoord);\n		highp float blueColor = textureColor.b * 63.0;\n		highp float alpha = textureColor.a;\n		\n		highp vec2 quad1;\n		quad1.y = floor(floor(blueColor) / 8.0);\n		quad1.x = floor(blueColor) - (quad1.y * 8.0);\n\n		highp vec2 quad2;\n		quad2.y = floor(ceil(blueColor) / 8.0);\n		quad2.x = ceil(blueColor) - (quad2.y * 8.0);\n\n		highp vec2 texPos1;\n		texPos1.x = (quad1.x * 0.125) + 0.0009765625 + (0.123046875 * textureColor.r);\n		texPos1.y = (quad1.y * 0.125) + 0.0009765625 + (0.123046875 * textureColor.g);\n\n		highp vec2 texPos2;\n		texPos2.x = (quad2.x * 0.125) + 0.0009765625 + (0.123046875 * textureColor.r);\n		texPos2.y = (quad2.y * 0.125) + 0.0009765625 + (0.123046875 * textureColor.g);\n\n		lowp vec4 newColor1 = texture2D(colorTable, texPos1);\n		lowp vec4 newColor2 = texture2D(colorTable, texPos2);\n\n		lowp vec4 newColor = mix(newColor1, newColor2, fract(blueColor));\n		gl_FragColor = vec4(mix(textureColor.rgb, newColor.rgb, intensity), alpha);\n	}\n"}},{key:"name",get:function(){return"FoodieFilter"}}]),b}(n.default));b.default=q},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(37),f=d(e),g=c(0),h=d(g),i=c(1),j=d(i),k=c(2),l=d(k),m=c(3),n=d(m),o=c(23),p=d(o),q=c(47),r=(d(q),c(31)),s=d(r),t=c(328),u=d(t),v=c(329),w=d(v),x=c(184),y={x:0,y:0},z=function(a){function b(c,d,e){(0,h.default)(this,b);var f=(0,l.default)(this,a.call(this,c,d));return f._previewBitmapdata=e,f._init(),f}return(0,n.default)(b,a),b.prototype.initWithTarget=function(a){this._target=a},b.prototype.square1=function(){this._setMode(this._modes[0])},b.prototype.square2=function(){this._setMode(this._modes[1])},b.prototype.square3=function(){this._setMode(this._modes[2])},b.prototype.square4=function(){this._setMode(this._modes[3])},b.prototype.square5=function(){this._setMode(this._modes[4])},b.prototype.circle1=function(){this._setMode(this._modes[5])},b.prototype.circle2=function(){this._setMode(this._modes[6])},b.prototype.circle3=function(){this._setMode(this._modes[7])},b.prototype.circle4=function(){this._setMode(this._modes[8])},b.prototype.circle5=function(){this._setMode(this._modes[9])},b.prototype.deselect=function(){this._setMode(null)},b.prototype.undo=function(){var a=this._mosaic.removeLastArea();return this.invalidate(this._mosaic),this._preview.removeLastArea(),this.invalidate(this._preview),a},b.prototype.getFilterCount=function(){return this._mosaic.filterCount},b.prototype.start=function(b){a.prototype.start.call(this),this._stage.update(),this._oldDragEnable=this._stage.magnify.dragEnable,this._target.on("mousedown",this._mdEvent),this._target.on("mousemove",this.onHitTest,this),window.document.addEventListener("mouseup",this._muEvent),window.document.addEventListener("keydown",this.onKeyboardDown),window.document.addEventListener("keyup",this.onKeyboardUp),this._dragging=!1,this._setMode(this._mode),this.stage.emit(s.default.MOUSE_CHILDREN_CHANGE,{type:s.default.MOUSE_CHILDREN_CHANGE,interactive:!1})},b.prototype.suspend=function(){return this.stage.emit(s.default.MOUSE_CHILDREN_CHANGE,{type:s.default.MOUSE_CHILDREN_CHANGE,interactive:!0}),this._target.off("mousedown",this._mdEvent),this._target.off("mousemove",this.onHitTest,this),window.document.removeEventListener("mouseup",this._muEvent),window.document.removeEventListener("keydown",this.onKeyboardDown),window.document.removeEventListener("keyup",this.onKeyboardUp),this._stage.magnify.dragEnable=!0,this._setCursor(!1),a.prototype.suspend.call(this)},b.prototype.snapshot=function(){return{previewAreas:this._deepCopyArr(this._preview.areas),areas:this._deepCopyArr(this._mosaic.areas)}},b.prototype.reset=function(b){var c=arguments.length>1&&void 0!==arguments[1]&&arguments[1];b?(b.previewAreas?this._preview.areas=this._deepCopyArr(b.previewAreas):this._preview.removeAll(),b.areas?this._mosaic.areas=this._deepCopyArr(b.areas):this._mosaic.removeAll()):(this._mosaic.removeAll(),this._preview.removeAll()),a.prototype.reset.call(this,c)},b.prototype.dispose=function(){this.suspend(),delete this._mosaic,delete this._preview,delete this._previewBitmapdata,a.prototype.dispose.call(this)},b.prototype.detectFace=function(){var a=this.stage.bitmapdata.source,b=this.stage.bitmapdata.canvas;void 0},b.prototype._init=function(){this.stage.glAvailable?(this.bmpd=new w.default,this.bmpd._debug=!0,this.bmpd.gl,this._mosaic=new u.default,this._preview=new u.default):(this._mosaic=new x(this._bitmapdata.worldTransform),this._preview=new x(this._previewBitmapdata.worldTransform));this._modes=this.options.modes,this._drawBox=new PIXI.Graphics,this._mvEvent=this._mouseMove.bind(this),this._mdEvent=this._mouseDown.bind(this),this._muEvent=this._mouseUp.bind(this),this.onKeyboardDown=this.onKeyboardDown.bind(this),this.onKeyboardUp=this.onKeyboardUp.bind(this),this._filters.push(this._mosaic),this._dragging=!1},b.prototype._deepCopyArr=function(a){for(var b=[],c=0;c<a.length;c++)b.push((0,f.default)({},a[c]));return b},b.prototype.onKeyboardDown=function(a){a.keyCode==this.options.keyCode&&(this.screenFitEnable||this._dragging||this._dragEnable||(this._prevMode=this._mode,this._setMode(null),this._dragEnable=!0))},b.prototype.onKeyboardUp=function(a){a.keyCode==this.options.keyCode&&(this._dragging||(this._dragEnable=!1,this.onDragComplete()))},b.prototype.onDragComplete=function(){this._prevMode&&(this._setMode(this._prevMode),this._prevMode=null)},b.prototype.onHitTest=function(a){if(!this._target||this.screenFitEnable||!this.stage.magnify.fitToScreenAvailable)return this.setOverStatus();var b=a.data.global.x,c=a.data.global.y,d=this.stage.viewport;return this.hitTestRect(b,c,d.x,d.y,d.width,d.height)?(y.x=b,y.y=c,this._target.toLocal(y,null,y),this.hitTestRect(y.x,y.y,0,0,this.stage.maskedWidth,this.stage.maskedHeight)?void(this._mouseOver||(this._mouseOver=!0,this._setCursor(!!this._mode))):this.setOverStatus()):this.setOverStatus()},b.prototype.setOverStatus=function(){this._mouseOver=!1},b.prototype.hitTestRect=function(a,b,c,d,e,f){return!(a<c||b<d||a>c+e||b>d+f)},b.prototype._mouseDown=function(a){var b=a.data.global;this._mode&&(this._dragging=!0,this._startPos={x:.5+(b.x>>0),y:.5+(b.y>>0)},this._target.on("mousemove",this._mvEvent),this._stage.addChild(this._drawBox))},b.prototype._mouseMove=function(a){this._drawArea(a.data.global,this._isSquare())},b.prototype._mouseUp=function(a){var b=this._getActiveObj();this._dragging&&b&&this._mode&&(b.width*b.height>1||b.radius>1)&&(this._doMosaic(),this.pushHistory()),this._target.off("mousemove",this._mvEvent),this._cleaBox(),this._dragging=!1},b.prototype._getActiveObj=function(){return this._square?(0,f.default)({},this._square):this._circle?(0,f.default)({},this._circle):null},b.prototype._doMosaic=function(){this._mosaic.addArea(this._getArea(this._stage._editingCanvas,this._bitmapdata)),this._preview.addArea(this._getArea(this._stage._previewingCanvas,this._previewBitmapdata)),this.invalidate(this._mosaic)},b.prototype._cleaBox=function(){this._drawBox.clear(),this._stage.removeChild(this._drawBox),this._square=this._circle=null},b.prototype._drawArea=function(a,b){if(this._drawBox.clear(),this._drawBox.lineStyle(1,this._mode.color,this._mode.alpha),this._drawBox.beginFill(16777215,.2),this._drawBox.moveTo(this._startPos.x,this._startPos.y),b)this._square={x:this._startPos.x,y:this._startPos.y,width:Math.floor(a.x-this._startPos.x),height:Math.floor(a.y-this._startPos.y)},this._correctRect(this._square),this._drawBox.drawRect(this._square.x,this._square.y,this._square.width,this._square.height);else{var c={w:(a.x-this._startPos.x)/2,h:(a.y-this._startPos.y)/2};this._circle={x:this._startPos.x+c.w,y:this._startPos.y+c.h,radius:Math.sqrt(c.w*c.w+c.h*c.h)},this._drawBox.drawCircle(this._circle.x,this._circle.y,this._circle.radius)}this._drawBox.endFill()},b.prototype._correctRect=function(a){a.width<0&&(a.x+=a.width,a.width*=-1),a.height<0&&(a.y+=a.height,a.height*=-1)},b.prototype._getArea=function(a,b){this.stage.updateTransform();var c,d,e,f,g,h,i,j,k,l,m,n,o=a.parent.parent;return(c=this._getActiveObj())?(j={x:c.x,y:c.y},e=this._target.worldTransform.applyInverse(j),c.x=e.x,c.y=e.y,h=b.sourceWidth,i=b.sourceHeight,d=b.worldTransform.clone(),k=h*d.scaleX*o.scale.x*a.scale.x,l=i*d.scaleY*o.scale.y*a.scale.y,f=k/o.scale.x,g=l/o.scale.y,m=d.scaleX<0?-1:1,n=d.scaleY<0?-1:1,c.x=c.x/f*h*m>>0,c.y=c.y/g*i*n>>0,this._square?(c.width=c.width/k*h*m,c.height=c.height/l*i*n):this._circle&&(c.radius=c.radius/k*h*m),d.scaleX*=m,d.scaleY*=n,c.transform=d,c.originRect={x:0,y:0,width:h,height:i},c.type=1==this._isSquare()?"rect":"circle",c.blockSize=this._mode.size,c):null},b.prototype._isSquare=function(){return-1!==this._mode.name.indexOf("square")},b.prototype._setCursor=function(a){this._target.buttonMode=a,this._target.defaultCursor=a?"crosshair":"default";var b=this.stage.renderer.view;a&&"crosshair"!=b.style.cursor&&(b.style.cursor="crosshair")},b.prototype._setMode=function(a){if(!this.running)return void(this._mode=a);var b=null!=a;if(b&&this._dragEnable)return void(this._prevMode=a);this._mode=a,this.stage.magnify.dragEnable=!b,this._setCursor(b)},(0,j.default)(b,[{key:"modified",get:function(){return!!this.stage.ready&&this._mosaic.filterCount>0}},{key:"editingFilter",get:function(){return this._mosaic}},{key:"previewingFilter",get:function(){return this._preview}},{key:"index",get:function(){return this._modes.indexOf(this._mode)},set:function(a){this._setMode(this._modes[a])}}]),b}(p.default);b.default=z},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(21),f=d(e),g=c(0),h=d(g),i=c(1),j=d(i),k=c(2),l=d(k),m=c(3),n=d(m),o=c(17),p=c(44),q=d(p),r=c(46),s=d(r),t=c(129),u=d(t),v=c(24),w="\n    attribute vec3 a_position;\n\n    attribute vec2 aTextureCoord;\n    \n    uniform mat3 mMT;\n    uniform int aaBool;\n    varying highp vec2 vTexCoord;\n    \n    void main(){\n        vec2 tm = a_position.xy;\n        if (aaBool == 1){\n            tm = (mMT * vec3(a_position.xy, 1)).xy;\n        }\n        \n        gl_Position = vec4(tm, 0.0, 1.0);\n        vTexCoord = aTextureCoord;\n    }\n",x="\n    attribute vec2 a_position;\n    \n    attribute vec2 aTextureCoord;\n    \n    varying highp vec2 vTexCoord;\n    \n    uniform highp mat3 mMT;\n    \n    void main() {\n        gl_Position = vec4((mMT * vec3(a_position.xy, 1)).xy, 0.0, 1.0);\n        vTexCoord = aTextureCoord;\n    }\n",y=[2,2],z=[-1,-1,1,-1,-1,1,1,1],A=[0,0,1,0,0,1,1,1],B=function(a){function b(c){(0,h.default)(this,b);var d=(0,l.default)(this,a.call(this,c));return c=d.gl,d._areas=[],d._changed=!1,d._frameBuffer=new u.default(c),d._tempFBuffer=new u.default(c),d._childTexture=s.default.createTextureForSingleImage(c),d._tempTexture=s.default.createTextureForSingleImage(c),d.m3={projection:function(a,b){return[2/a,0,0,0,2/b,0,-1,-1,1]},identity:function(){return[1,0,0,0,1,0,0,0,1]},translation:function(a,b){return[1,0,0,0,1,0,a,b,1]},rotation:function(a){var b=Math.cos(a),c=Math.sin(a);return[b,c,0,-c,b,0,0,0,1]},scaling:function(a,b){return[a,0,0,0,b,0,0,0,1]},inverse:function(a){var b=a[0],c=a[3],d=a[6],e=a[1],f=a[4],g=a[7],h=a[2],i=a[5],j=a[8],k=b*f*j-b*g*i-c*e*j+c*g*h+d*e*i-d*f*h;return[(f*j-g*i)/k,(g*h-e*j)/k,(e*i-f*h)/k,(d*i-c*j)/k,(b*j-d*h)/k,(c*h-b*i)/k,(c*g-d*f)/k,(d*e-b*g)/k,(b*f-c*e)/k]},multiply:function(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],g=a[4],h=a[5],i=a[6],j=a[7],k=a[8],l=b[0],m=b[1],n=b[2],o=b[3],p=b[4],q=b[5],r=b[6],s=b[7],t=b[8];return[l*c+m*f+n*i,l*d+m*g+n*j,l*e+m*h+n*k,o*c+p*f+q*i,o*d+p*g+q*j,o*e+p*h+q*k,r*c+s*f+t*i,r*d+s*g+t*j,r*e+s*h+t*k]},multiply2:function(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],g=a[4],h=a[5],i=a[6],j=a[7],k=a[8],l=b[0],m=b[1],n=b[2];return[l*c+m*f+n*i,l*d+m*g+n*j,l*e+m*h+n*k]},translate:function(a,b,c){return d.m3.multiply(a,d.m3.translation(b,c))},rotate:function(a,b){return d.m3.multiply(a,d.m3.rotation(b))},scale:function(a,b,c){return d.m3.multiply(a,d.m3.scaling(b,c))}},d.initGL(),d}return(0,n.default)(b,a),b.prototype.removeAll=function(){this._areas=[]},b.prototype.removeLastArea=function(){this._areas.pop()},b.prototype.removeArea=function(){},b.prototype.applyFilter=function(a,b,c){var d=this;if(!1===this.changed)return a;var e=this.gl.canvas.width,f=this.gl.canvas.height;this._currTransform=this.customM3x3(c.worldTransform.matrix.raw),this._tempTexture.initWithPixels(e,f),this.drawFrameBuffer(this._frameBuffer,function(b){d.drawBG(a,d._tempTexture.texture,b,d.gl.LINEAR)});for(var g=0;g<this._areas.length;g++)this.onFilterLoop(g,this._tempTexture.texture,this._frameBuffer,this._tempTexture.texture);return this.drawDest(b),this._changed=!0,this.texture},b.prototype.drawDest=function(a){var b=this;this.drawFrameBuffer(this._frameBuffer,function(c){b.drawBG(b._tempTexture.texture,a,c,b.gl.LINEAR)})},b.prototype.applyFilterAsync=function(a,b,c){var d=this;return new f.default(function(e){e(d.applyFilter(a,b,c))})},b.prototype.drawBG=function(a,b,c,d){this.gl.useProgram(this.bgprogram),this.setVertex(this.triangleData),this.setTexture(this.frameData,this.bgprogram),this.setUniformsi(this.bgprogram,{aaBool:[0],uSampler:[0]}),this.bindTextureAt(a,0,this.gl,null,d),this._frameBuffer.bindColorAttachment(b),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)},b.prototype.addArea=function(a){this._areas||(this._areas=[]),a.invMat3x3=this.m3.inverse(this.customM3x3(a.transform.matrix.raw)),this._areas.push(a),this._changed=!0},b.prototype.initGL=function(){this.bgprogram=(0,v.createProgram)(this.gl,w,"\n    precision highp float;\n    \n    uniform sampler2D uSampler;\n    varying vec2 vTexCoord;\n    \n    void main() {\n        vec4 color = texture2D(uSampler, vec2(vTexCoord.s, vTexCoord.t));\n        if (color.a < 0.5){\n            discard;\n        }\n        gl_FragColor = color;\n    \n    }\n"),
this.mosaicRProgram=(0,v.createProgram)(this.gl,x,"\n	precision highp float;\n\n    uniform sampler2D texture;\n    uniform highp float blockSize;\n    uniform lowp vec2 iResolution;\n    uniform mat3 mTexture;\n    uniform vec2 padding;\n    uniform vec2 viewRect;\n    varying vec2 vTexCoord;\n    \n    \n    vec4 getAvColor(mat3 div3){\n        // mat3 div3;\n        vec2 blockPos;\n        vec4 lt, rt, lb, rb, c;\n    \n        // div3 = mat3(\n        //     1.0/iResolution.x, 0, 0,\n        //     0, 1.0/iResolution.y, 0,\n        //     0, 0, 1\n        // );\n        \n        // 좌상, 우상, 좌하, 우하, 중 5가지 색상 정보의 평균 값을 해당 블럭의 대표값으로 지정\n        blockPos = vec2(floor((vTexCoord.x + padding.x) / blockSize) * blockSize, floor((vTexCoord.y + padding.y) / blockSize)  * blockSize);\n        blockPos = (div3 * mTexture * vec3(blockPos, 1.0)).xy;\n        lt = texture2D(texture, blockPos);\n    \n        blockPos = vec2(floor((vTexCoord.x + padding.x) / blockSize) * blockSize + blockSize, floor((vTexCoord.y + padding.y) / blockSize)  * blockSize);\n        blockPos = (div3 * mTexture * vec3(blockPos, 1.0)).xy;\n        rt = texture2D(texture, blockPos);\n    \n        blockPos = vec2(floor((vTexCoord.x + padding.x) / blockSize) * blockSize, floor((vTexCoord.y + padding.y) / blockSize)  * blockSize + blockSize);\n        blockPos = (div3 * mTexture * vec3(blockPos, 1.0)).xy;\n        lb = texture2D(texture, blockPos);\n    \n        blockPos = vec2(floor((vTexCoord.x + padding.x) / blockSize) * blockSize + blockSize, floor((vTexCoord.y + padding.y) / blockSize)  * blockSize + blockSize);\n        blockPos = (div3 * mTexture * vec3(blockPos, 1.0)).xy;\n        rb = texture2D(texture, blockPos);\n    \n        blockPos = vec2(floor((vTexCoord.x + padding.x) / blockSize) * blockSize + floor(blockSize / 2.0), floor((vTexCoord.y + padding.y) / blockSize)  * blockSize + floor(blockSize / 2.0));\n        blockPos = (div3 * mTexture * vec3(blockPos, 1.0)).xy;\n        c = texture2D(texture, blockPos);\n    \n        return (lt + rt + lb + rb + c) / 5.0;\n    }\n    \n    void main() {\n        mat3 div3 = mat3(\n            1.0/iResolution.x, 0, 0,\n            0, 1.0/iResolution.y, 0,\n            0, 0, 1\n        );\n    \n        if (vTexCoord.x >= padding.x && vTexCoord.y >= padding.y &&\n            vTexCoord.x <= padding.x + viewRect.x && vTexCoord.y <= padding.y + viewRect.y){\n            gl_FragColor = getAvColor(div3);\n        }else{\n            gl_FragColor = texture2D(texture, (div3 * mTexture * vec3(vTexCoord.xy, 1.0)).xy);\n        }\n        \n    }\n"),this.mosaicCProgram=(0,v.createProgram)(this.gl,x,"\n    precision highp float;\n\n    uniform sampler2D texture;\n    uniform highp float blockSize;\n    uniform lowp vec2 iResolution;\n    uniform mat3 mTexture;\n    uniform vec2 padding;\n    uniform vec2 viewRect;\n    uniform float powRadius;\n    \n    varying vec2 vTexCoord;\n    \n    \n    \n    vec4 getAvColor(mat3 div3){\n        // mat3 div3;\n        vec2 blockPos;\n        vec4 lt, rt, lb, rb, c;\n    \n        // div3 = mat3(\n        //     1.0/iResolution.x, 0, 0,\n        //     0, 1.0/iResolution.y, 0,\n        //     0, 0, 1\n        // );\n        \n        // 좌상, 우상, 좌하, 우하, 중 5가지 색상 정보의 평균 값을 해당 블럭의 대표값으로 지정\n        blockPos = vec2(floor((vTexCoord.x + padding.x) / blockSize) * blockSize, floor((vTexCoord.y + padding.y) / blockSize)  * blockSize);\n        blockPos = (div3 * mTexture * vec3(blockPos, 1.0)).xy;\n        lt = texture2D(texture, blockPos);\n    \n        blockPos = vec2(floor((vTexCoord.x + padding.x) / blockSize) * blockSize + blockSize, floor((vTexCoord.y + padding.y) / blockSize)  * blockSize);\n        blockPos = (div3 * mTexture * vec3(blockPos, 1.0)).xy;\n        rt = texture2D(texture, blockPos);\n    \n        blockPos = vec2(floor((vTexCoord.x + padding.x) / blockSize) * blockSize, floor((vTexCoord.y + padding.y) / blockSize)  * blockSize + blockSize);\n        blockPos = (div3 * mTexture * vec3(blockPos, 1.0)).xy;\n        lb = texture2D(texture, blockPos);\n    \n        blockPos = vec2(floor((vTexCoord.x + padding.x) / blockSize) * blockSize + blockSize, floor((vTexCoord.y + padding.y) / blockSize)  * blockSize + blockSize);\n        blockPos = (div3 * mTexture * vec3(blockPos, 1.0)).xy;\n        rb = texture2D(texture, blockPos);\n    \n        blockPos = vec2(floor((vTexCoord.x + padding.x) / blockSize) * blockSize + floor(blockSize / 2.0), floor((vTexCoord.y + padding.y) / blockSize)  * blockSize + floor(blockSize / 2.0));\n        blockPos = (div3 * mTexture * vec3(blockPos, 1.0)).xy;\n        c = texture2D(texture, blockPos);\n    \n        return (lt + rt + lb + rb + c) / 5.0;\n    }\n    \n    void main() {\n        mat3 div3 = mat3(\n            1.0/iResolution.x, 0, 0,\n            0, 1.0/iResolution.y, 0,\n            0, 0, 1\n        );\n    \n        // vec2 xy = vTexCoord * viewRect;\n        \n        vec2 target = vTexCoord - (viewRect / 2.0 + padding);\n        \n        float a = target.x * target.x + target.y * target.y;\n    \n        if (a < powRadius){\n            gl_FragColor = getAvColor(div3);\n        }else{\n            gl_FragColor = texture2D(texture, (div3 * mTexture * vec3(vTexCoord.xy, 1.0)).xy);\n        }\n        \n    }\n"),this.mosaicCCProgram=(0,v.createProgram)(this.gl,w,"\n    precision highp float;\n    \n    uniform sampler2D uSampler;\n    uniform vec2 iResolution;\n    uniform vec2 center;\n    uniform float powRadius;\n    varying vec2 vTexCoord;\n    \n    \n    \n    void main() {\n        vec4 color = texture2D(uSampler, vec2(vTexCoord.s, vTexCoord.t));\n        vec2 xy = vTexCoord * iResolution;\n        \n        vec2 target = xy - iResolution.xy / 2.0;\n        \n        float a = target.x * target.x + target.y * target.y;\n        \n        // if (xy.x < 100.0 && xy.y < 100.0){\n        //     color = vec4(0.0, 0.0, 0.0, 1.0);\n        // }\n        gl_FragColor = color;\n        \n        if (a > powRadius){\n            discard;\n        }\n        \n    \n    }\n"),this.triangleData=z,this.frameData=A,this.uvBuffer=this.gl.createBuffer(),this.triBuffer=this.gl.createBuffer()},b.prototype.setVertex=function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.bgprogram,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"a_position";this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.triBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(a),this.gl.STATIC_DRAW);var d=this.gl.getAttribLocation(b,c);this.gl.enableVertexAttribArray(d),this.gl.vertexAttribPointer(d,2,this.gl.FLOAT,!1,0,0)},b.prototype.setTexture=function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.bgprogram,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"aTextureCoord";this.gl.useProgram(b),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.uvBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(a),this.gl.STATIC_DRAW);var d=this.gl.getAttribLocation(b,c);this.gl.enableVertexAttribArray(d),this.gl.vertexAttribPointer(d,2,this.gl.FLOAT,!1,0,0)},b.prototype.ccRect=function(a,b,c){var d=a.x,e=a.y,f=a.radius;return[d*b-f,e*c-f,2*f,2*f]},b.prototype.getMat=function(a,b){var c=this.m3.identity(),d=a.transform.scaleX,e=a.transform.scaleY;return"circle"==a.type?(c=this.m3.translate(c,(a.x-y[0])*d,(a.y-y[1])*e),c=this.m3.translate(c,-a.radius,-a.radius)):c=this.m3.translate(c,b[0]-y[0],b[1]-y[1]),c=this.m3.multiply(a.invMat3x3,c),c=this.m3.multiply(this._currTransform,c)},b.prototype.applyMosaic=function(a,b,c,d,e){var f=this.gl.canvas.width,g=this.gl.canvas.height,h=b,i=[0,0,h[2]+2*y[0],h[3]+2*y[1]],j=this.m3.projection(i[2],i[3]);if(this.gl.useProgram(c),this.setVertex([i[0],i[1],i[2],i[1],i[0],i[3],i[2],i[3]],c),this.setTexture([i[0],i[1],i[2],i[1],i[0],i[3],i[2],i[3]],c),this._childTexture.initWithPixels(i[2],i[3]),this.gl.viewport(0,0,i[2],i[3]),this.gl.uniformMatrix3fv(this.gl.getUniformLocation(c,"mTexture"),!1,this.getMat(a,h)),this.gl.uniformMatrix3fv(this.gl.getUniformLocation(c,"mMT"),!1,j),this.gl.uniform2fv(this.gl.getUniformLocation(c,"iResolution"),[f,g]),this.gl.uniform2fv(this.gl.getUniformLocation(c,"viewRect"),[h[2],h[3]]),this.gl.uniform2fv(this.gl.getUniformLocation(c,"padding"),y),this.gl.uniform1f(this.gl.getUniformLocation(c,"blockSize"),a.blockSize*a.transform.scaleX),a.radius){var k=a.radius*a.transform.scaleX;this.gl.uniform1f(this.gl.getUniformLocation(c,"powRadius"),k*k)}this.bindTextureAt(d,2,this.gl,this.gl.getUniformLocation(c,"texture"),this.gl.LINEAR),e.bindColorAttachment(this._childTexture.texture),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)},b.prototype.getRectArr=function(a,b){var c=b.transform.scaleX,d=b.transform.scaleY;return"circle"==a?this.ccRect(b,c,d):[b.x*c,b.y*d,b.width*c,b.height*d]},b.prototype.drawFrameBuffer=function(a,b){this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,a.frame),b(a),this.gl.bindTexture(this.gl.TEXTURE_2D,null),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null)},b.prototype.onFilterLoop=function(a,b,c,d){var e=this,f=this.gl.canvas.width,g=this.gl.canvas.height,h=this.m3.projection(this.gl.canvas.width,this.gl.canvas.height),i=this._areas[a],j="rect"==i.type,k=this.getRectArr(i.type,i),l=[0,0,k[2]+2*y[0],k[3]+2*y[1]],m=void 0,n=this.m3.identity();if(i)return n=this.m3.translate(n,k[0]-y[0],k[1]-y[1]),m=this.m3.multiply(i.invMat3x3,n),m=this.m3.multiply(this._currTransform,m),m=this.m3.multiply(h,m),this.drawFrameBuffer(this._tempFBuffer,function(a){j?e.applyMosaic(i,k,e.mosaicRProgram,b,a):e.applyMosaic(i,k,e.mosaicCProgram,b,a)}),this.drawFrameBuffer(c,function(){e.gl.viewport(0,0,f,g),j?e.doRectMosaic(m,l,d):e.doCircleMosaic(m,l,d,i,k)}),a+1},b.prototype.doCircleMosaic=function(a,b,c,d,e){var f=d.radius*d.transform.scaleX;this.gl.useProgram(this.mosaicCCProgram),this.setVertex([b[0],b[1],b[2],b[1],b[0],b[3],b[2],b[3]]),this.setTexture(this.frameData,this.mosaicCCProgram),this.gl.uniformMatrix3fv(this.gl.getUniformLocation(this.mosaicCCProgram,"mMT"),!1,a),this.gl.uniform4fv(this.gl.getUniformLocation(this.mosaicCCProgram,"roundRect"),b),this.gl.uniform1i(this.gl.getUniformLocation(this.mosaicCCProgram,"aaBool"),1),this.gl.uniform2fv(this.gl.getUniformLocation(this.mosaicCCProgram,"iResolution"),[b[2],b[3]]),this.gl.uniform2fv(this.gl.getUniformLocation(this.mosaicCCProgram,"center"),[e[0]+e[2]/2,e[1]+e[3]/2]),this.gl.uniform1f(this.gl.getUniformLocation(this.mosaicCCProgram,"powRadius"),f*f),this.gl.uniform1i(this.gl.getUniformLocation(this.mosaicCCProgram,"uSampler"),3),this.bindTextureAt(this._childTexture.texture,3,this.gl,null,this.gl.LINEAR),this._frameBuffer.bindColorAttachment(c),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)},b.prototype.doRectMosaic=function(a,b,c){this.gl.useProgram(this.bgprogram),this.setVertex([b[0],b[1],b[2],b[1],b[0],b[3],b[2],b[3]]),this.setTexture(this.frameData,this.bgprogram),this.gl.uniformMatrix3fv(this.gl.getUniformLocation(this.bgprogram,"mMT"),!1,a),this.gl.uniform1i(this.gl.getUniformLocation(this.bgprogram,"aaBool"),1),this.gl.uniform1i(this.gl.getUniformLocation(this.bgprogram,"uSampler"),3),this.bindTextureAt(this._childTexture.texture,3,this.gl,null,this.gl.LINEAR),this._frameBuffer.bindColorAttachment(c),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)},b.prototype.draw=function(){var a=this.gl;a.drawArrays(a.TRIANGLE_STRIP,0,4)},b.prototype.bindTextureAt=function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.gl,d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,e=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.gl.NEAREST;d&&c.uniform1i(d,b),c.activeTexture(c.TEXTURE0+b),c.bindTexture(c.TEXTURE_2D,a),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,e),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,e)},b.prototype.setUniformsi=function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.gl;(0,o.each)(b,function(b,d){c["uniform"+b.length+"i"].apply(c,[c.getUniformLocation(a,d)].concat(b))})},b.prototype.createShader=function(a,b,c){var d=this.gl.createShader(b);if(this.gl.shaderSource(d,a),this.gl.compileShader(d),this.gl.attachShader(c,d),!this.gl.getShaderParameter(d,this.gl.COMPILE_STATUS))return null},b.prototype.customM3x3=function(a){return[a[0],a[1],0,a[2],a[3],0,a[4],a[5],1]},(0,j.default)(b,[{key:"changed",get:function(){return this._changed}},{key:"name",get:function(){return"MosaicFilter"}},{key:"areas",get:function(){return this._areas},set:function(a){this._areas=a}},{key:"filterCount",get:function(){return this.areas?this.areas.length:0}}]),b}(q.default);b.default=B},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(1),h=d(g),i=c(24),j=c(93),k=d(j),l=c(46),m=d(l),n=function(){function a(){(0,f.default)(this,a),this._init()}return a.prototype._init=function(){var a=this._gl=(0,i.getWebGLContext)();this._glimage=new k.default(a),this._sourceTex2D=m.default.createTextureForSingleImage(a),this._filters=[]},a.prototype.initWithSource=function(a){var b=this,c=this.gl;return this._source=a,this.sourceTexture2D.initWithSource(a),this.glImage.initWithSize(this.sourceWidth,this.sourceHeight),this.glImage.updateWorldTransform(this.sourceWidth,this.sourceHeight),this.filters.forEach(function(a){return a.initWithSize(b.sourceWidth,b.sourceHeight)}),c.canvas.width=this.sourceWidth,c.canvas.height=this.sourceHeight,c.viewport(0,0,this.sourceWidth,this.sourceHeight),this.update()},a.prototype.update=function(){var a=this.getSourceTexture(this.numFilters);return this.clear(),this.glImage.draw(a),this._debug&&void 0,this},a.prototype.applyFilter=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.filters.slice(Math.max(0,a)).reduce(function(a,b){return b.applyFilter(a)},this.getSourceTexture(a))},a.prototype.getSourceTexture=function(a){if(a<=0)return this.sourceTexture;var b=this.filters[a-1];return b.changed?b.texture:this.getSourceTexture(a-1)},a.prototype.clear=function(){this.glImage.program.clearColorBuffer()},a.prototype.dispose=function(){this.glImage.dispose(),this.sourceTexture2D.dispose(),this.filters.forEach(function(a){return a.dispose()})},a.prototype.describeFilters=function(){this.filters.forEach(function(a,b){return void 0})},a.prototype.getFilterName=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getSourceTexture(this.numFilters);return this.filters.map(function(b){return b.texture==a?b.constructor.name:null}).reduce(function(a,b){return a||b})},(0,h.default)(a,[{key:"filters",get:function(){return this._filters},set:function(a){this._filters=a}},{key:"numFilters",get:function(){return this.filters?this.filters.length:0}},{key:"glImage",get:function(){return this._glimage}},{key:"sourceTexture2D",get:function(){return this._sourceTex2D}},{key:"sourceTexture",get:function(){return this.sourceTexture2D.texture}},{key:"source",get:function(){return this._source}},{key:"sourceWidth",get:function(){return this.source.width||this.source.naturalWidth}},{key:"sourceHeight",get:function(){return this.source.height||this.source.naturalHeight}},{key:"gl",get:function(){return this._gl}},{key:"canvas",get:function(){return this.gl?this.gl.canvas:null}}]),a}();b.default=n},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(2),h=d(g),i=c(1),j=d(i),k=c(3),l=d(k),m=c(23),n=d(m),o=c(56),p=d(o),q=c(31),r=d(q),s=c(74),t=d(s),u=c(57),v=d(u),w=c(332),x=d(w),y=(c(10),c(32)),z=c(52),A=d(z),B=c(73),C=d(B),D=c(98),E=d(D),F=c(77),G=d(F),H=c(135),I=d(H),J=c(53),K=(c(333),function(a){function b(c,d,e){(0,f.default)(this,b);var g=(0,h.default)(this,a.call(this,c,d));return I.default.crossOrigin=g.options.crossOrigin,g._container=e,g._container.on(p.default.CHANGE_SIZE,g.onContainerChange,g),v.default.renderer=d.renderer,g.stickerMain=new x.default(d.renderer,d,e,c),g.stickerMain.on(x.default.DELETED,g.onDeleted,g),g.stickerMain.on(x.default.SELECTED,g.onSelected,g),g.stickerMain.on(x.default.DESELECTED,g.onDeselected,g),g.stickerMain.on(x.default.COMPLETE,g.onComplete,g),g.stickerMain.on(G.default.CONTROL_UP,g.onControlUp,g),g.stage.on(r.default.VIEWPORT_MOTION_UPDATE,g.onViewportChange,g),g.stage.on(r.default.VIEWPORT_MOTION_COMPLETE,g.onViewportChange,g),g.stage.on(r.default.MOUSE_CHILDREN_CHANGE,g.onMouseChildrenChange,g),g.stage.on(r.default.BITMAPDATA_UPDATE,g.onUpdateBitmapDataComplete,g),g.stage.on(t.default.CROP_COMPLETE,g.onCropComplete,g),g.stage.on(r.default.CLEAR_ALL,g.onClearAll,g),g}return(0,l.default)(b,a),(0,j.default)(b,null,[{key:"DELETED",get:function(){return"deleted"}},{key:"SELECTED",get:function(){return"selected"}},{key:"DESELECTED",get:function(){return"deselected"}}]),b.prototype.start=function(){a.prototype.start.call(this),this.stage.magnify.on(C.default.DRAG,this.onImageDrag,this),this.stage.motion.on(A.default.UPDATE,this.onMotionUpdate,this),this._container.on(G.default.CONTROL_UP,this.onControlUp,this)},b.prototype.suspend=function(){return this.stickerMain.releaseTarget(),this.stage.magnify.off(C.default.DRAG,this.onImageDrag,this),this.stage.motion.off(A.default.UPDATE,this.onMotionUpdate,this),this._container.off(G.default.CONTROL_UP,this.onControlUp,this),a.prototype.suspend.call(this)},b.prototype.reset=function(b){var c=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.stickerMain.releaseTarget(),this.stickerMain.clear(),this.stickerMain.restore(b),a.prototype.reset.call(this,c)},b.prototype.snapshot=function(){return this.stickerMain.snapshot},b.prototype.dispose=function(){this._container.off(p.default.CHANGE_SIZE,this.onContainerChange,this),this._container=null,this.stickerMain.off(x.default.DELETED,this.onDeleted,this),this.stickerMain.off(x.default.SELECTED,this.onSelected,this),this.stickerMain.off(x.default.DESELECTED,this.onDeselected,this),this.stickerMain.off(x.default.COMPLETE,this.onComplete,this),this.stickerMain.off(G.default.CONTROL_UP,this.onControlUp,this),this.stage.off(r.default.VIEWPORT_MOTION_UPDATE,this.onViewportChange,this),this.stage.off(r.default.VIEWPORT_MOTION_COMPLETE,this.onViewportChange,this),this.stage.off(r.default.MOUSE_CHILDREN_CHANGE,this.onMouseChildrenChange,this),this.stage.off(r.default.BITMAPDATA_UPDATE,this.onUpdateBitmapDataComplete,this),this.stage.off(t.default.CROP_COMPLETE,this.onCropComplete,this),this.stage.off(r.default.CLEAR_ALL,this.onClearAll,this),v.default.renderer=null},b.prototype.createSticker=function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,d=this.getLandingPoint();this.stickerMain.createSticker(a,d.x,d.y,b,c)},b.prototype.createPNGSticker=function(a){var b=this,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:150,e=this.getLandingPoint();d*=this.stage.croppedWidth/this.stage.resizedWidth,this.stickerMain.once(x.default.COMPLETE,function(a){return b.pushHistory()});var f=this.stickerMain.createPNGSticker(a,e.x,e.y,d,d),g=this.stage.viewportToLocal(this.stage.stickerContainer),h=(0,J.sign)(this.stage.stickerContainer.scale.x),i=(0,J.sign)(this.stage.stickerContainer.scale.y);f.stickerID=c,f.x=e.x,f.y=e.y,f.scale.x*=h,f.scale.y*=i,f.rotation=g.radian},b.prototype.getLandingPoint=function(){var a=this.stage.viewportToLocal(this._container),b=E.default.imageRect,c=0!=a.radian?(0,y.rotate)(a.width/2,a.height/2,a.radian):{x:a.width/2,y:a.height/2},d=0!=a.radian?(0,y.rotate)(this.options.horizontalGap,this.options.verticalGap,a.radian):{x:this.options.horizontalGap,y:this.options.verticalGap},e=a.origin.x+c.x,f=a.origin.y+c.y;return this.evalEmptyLocation(this.stickerMain.stickers,e,f,e,f,b,d)},b.prototype.evalEmptyLocation=function(a,b,c,d,e,f,g){var h=arguments.length>7&&void 0!==arguments[7]?arguments[7]:1;if(!(0,y.hitTestWithBoundary)(d,e,f))return{x:b,y:c};if(a.every(function(a){return Math.abs(d-a.x)>1||Math.abs(e-a.y)>1}))return{x:d,y:e};if(d+=g.x,e+=g.y,!(0,y.hitTestWithBoundary)(d,e,f)){var i=(0,y.rotate)(g.x,g.y,Math.PI/2);d=b+i.x*h,e=c+i.y*h++}return this.evalEmptyLocation(a,b,c,d,e,f,g,h)},b.prototype.delete=function(){this.stickerMain.deleteSticker(this.stickerMain.target)},b.prototype.screenFit=function(a){if(a)return void this.stage.magnify.autoScale(!0);return void(1!=this.stage.magnify.scale&&this.stage.magnify.autoScale(a))},b.prototype.update=function(){this.stickerMain.updateTransformTool(),this.stickerMain.transformTool.drawCenter(),this.stickerMain.transformTool.updatePrevTargetLt()},b.prototype.onControlUp=function(a){this.pushHistory()},b.prototype.onComplete=function(){this.emit(r.default.READY,{type:r.default.READY,target:this})},b.prototype.onDeleted=function(a){this.emit(b.DELETED,a)},b.prototype.onSelected=function(a){this.emit(b.SELECTED,a),this.running||this.stage.emit(r.default.PHASE_CHANGE,{type:r.default.PHASE_CHANGE,phase:"sticker"})},b.prototype.onDeselected=function(a){this.emit(b.DESELECTED,a)},b.prototype.onContainerChange=function(a){this.stickerMain.releaseTarget()},b.prototype.onViewportChange=function(a){this.update()},b.prototype.onImageDrag=function(){this.update()},b.prototype.onMotionUpdate=function(){this.update()},b.prototype.onMouseChildrenChange=function(a){this._container&&(this._container.mouseChildren=a.interactive)},b.prototype.onUpdateBitmapDataComplete=function(a){if(this._container){var b=E.default.mouseBoundary=this.stage.imageToLocal(this._container),c=E.default.imageRect,d={origin:b.tl,width:(0,y.getDistance)(b.tl.x,b.tl.y,b.tr.x,b.tr.y),height:(0,y.getDistance)(b.tl.x,b.tl.y,b.bl.x,b.bl.y),radian:(0,y.getRadian)(b.tl.x,b.tl.y,b.tr.x,b.tr.y)};this._container.scale.x<0?d=this._container.scale.y<0?{origin:b.br,width:(0,y.getDistance)(b.br.x,b.br.y,b.bl.x,b.bl.y),height:(0,y.getDistance)(b.br.x,b.br.y,b.tr.x,b.tr.y),radian:(0,y.getRadian)(b.br.x,b.br.y,b.bl.x,b.bl.y)}:{origin:b.tr,width:(0,y.getDistance)(b.tr.x,b.tr.y,b.tl.x,b.tl.y),height:(0,y.getDistance)(b.tr.x,b.tr.y,b.br.x,b.br.y),radian:(0,y.getRadian)(b.tr.x,b.tr.y,b.tl.x,b.tl.y)}:this._container.scale.y<0&&(d={origin:b.bl,width:(0,y.getDistance)(b.bl.x,b.bl.y,b.br.x,b.br.y),height:(0,y.getDistance)(b.bl.x,b.bl.y,b.tl.x,b.tl.y),radian:(0,y.getRadian)(b.bl.x,b.bl.y,b.br.x,b.br.y)}),c.origin.x=d.origin.x,c.origin.y=d.origin.y,c.width=d.width,c.height=d.height,c.radian=d.radian,E.default.imageRect=E.default.imageRect}},b.prototype.onCropComplete=function(a){this.stage.updateTransform(),this.onUpdateBitmapDataComplete()},b.prototype.onClearAll=function(a){this.reset()},(0,j.default)(b,[{key:"modified",get:function(){return this.stickerMain.modified}},{key:"lastSticker",get:function(){return this.stickerMain.lastSticker}},{key:"ready",get:function(){return this.stickerMain.complete}}]),b}(n.default));b.default=K},function(a,b,c){"use strict";var d=function(){var a=function(a,f,g){f||(f="rgba"),a=a.toLowerCase(),f=f.toLowerCase();var i,j,k,l,m,n,o,p,q,r,s,t,u,v=h(a),w=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(a){return[parseInt(a[1],10),parseInt(a[2],10),parseInt(a[3],10),1]}},{re:/^rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),\s*(\d+(?:\.\d+)?|\.\d+)\s*\)/,example:["rgba(123, 234, 45, 1)","rgba(255,234,245, 0.5)"],process:function(a){return[parseInt(a[1],10),parseInt(a[2],10),parseInt(a[3],10),parseFloat(a[4])]}},{re:/^hsl\((\d{1,3}),\s*(\d{1,3})%,\s*(\d{1,3})%\)$/,example:["hsl(120, 100%, 25%)","hsl(0, 100%, 50%)"],process:function(a){a[4]=1;var c=b(a);return[c.r,c.g,c.b,c.a]}},{re:/^hsla\((\d{1,3}),\s*(\d{1,3})%,\s*(\d{1,3})%,\s*(\d+(?:\.\d+)?|\.\d+)\s*\)/,example:["hsla(120, 100%, 25%, 1)","hsla(0, 100%, 50%, 0.5)"],process:function(a){var c=b(a);return[c.r,c.g,c.b,c.a]}},{re:/^hsv\((\d{1,3}),\s*(\d{1,3})%,\s*(\d{1,3})%\)$/,example:["hsv(120, 100%, 25%)","hsl(0, 100%, 50%)"],process:function(a){var b=d(a);return[b.r,b.g,b.b,1]}},{re:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,example:["#00ff00","336699"],process:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16),1]}},{re:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,example:["#fb0","f0f"],process:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16),1]}}];for(v?a=v:(a=a.replace(/^\s*#|\s*$/g,""),3===a.length&&(a=a.replace(/(.)/g,"$1$1"))),m=0;m<w.length;m+=1)n=w[m].re,o=w[m].process,(p=n.exec(a))&&(q=o(p),i=q[0],j=q[1],k=q[2],l=q[3]);switch(i=i<0||isNaN(i)?0:i>255?255:i,j=j<0||isNaN(j)?0:j>255?255:j,k=k<0||isNaN(k)?0:k>255?255:k,l=l<0||isNaN(l)?0:l>1?1:l,f){case"rgba":g&&(l=(255-(r=Math.min(i,j,k)))/255,i=((i-r)/l).toFixed(0),j=((j-r)/l).toFixed(0),k=((k-r)/l).toFixed(0),l=l.toFixed(4)),u="rgba("+i+","+j+","+k+","+l+")";break;case"rgb":u="rgb("+i+","+j+","+k+")";break;case"hex":u="#"+("0"+i.toString(16)).slice(-2)+("0"+j.toString(16)).slice(-2)+("0"+k.toString(16)).slice(-2);break;case"hsl":s=c({r:i,g:j,b:k}),u="hsl("+s.h+","+s.s+"%,"+s.l+"%)";break;case"hsla":s=c({r:i,g:j,b:k,a:l}),u="hsl("+s.h+","+s.s+"%,"+s.l+"%,"+s.a+")";break;case"hsv":t=e({r:i,g:j,b:k}),u="hsv("+t.h+","+t.s+"%,"+t.v+"%)";break;case"array":u=[i,j,k,l]}return u},b=function(a){var b,c,d,e={},h={h:g(parseInt(a[1],10)%360,360),s:g(parseInt(a[2],10)%101,100),l:g(parseInt(a[3],10)%101,100),a:parseFloat(a[4])};return 0===h.s?(b=parseInt(Math.round(255*h.l)),e={r:b,g:b,b:b,a:h.a}):(c=h.l<.5?h.l*(1+h.s):h.l+h.s-h.l*h.s,d=2*h.l-c,e.r=parseInt((256*f(d,c,h.h+1/3)).toFixed(0),10),e.g=parseInt((256*f(d,c,h.h)).toFixed(0),10),e.b=parseInt((256*f(d,c,h.h-1/3)).toFixed(0),10),e.a=h.a),e},c=function(a){a.r=g(parseInt(a.r,10)%256,256),a.g=g(parseInt(a.g,10)%256,256),a.b=g(parseInt(a.b,10)%256,256);var b,c=Math.max(a.r,a.g,a.b),d=Math.min(a.r,a.g,a.b),e=[];if(e.a=a.a,e.l=(c+d)/2,c===d)e.h=0,e.s=0;else{switch(b=c-d,e.s=e.l>.5?b/(2-c-d):b/(c+d),c){case a.r:e.h=(a.g-a.b)/b+(a.g<a.b?6:0);break;case a.g:e.h=(a.b-a.r)/b+2;break;case a.b:e.h=(a.r-a.g)/b+4}e.h/=6}return e.h=parseInt((360*e.h).toFixed(0),10),e.s=parseInt((100*e.s).toFixed(0),10),e.l=parseInt((100*e.l).toFixed(0),10),e},d=function(a){var b={},c={h:g(parseInt(a[1],10)%360,360),s:g(parseInt(a[2],10)%101,100),v:g(parseInt(a[3],10)%101,100)},d=Math.floor(6*c.h),e=6*c.h-d,f=c.v*(1-c.s),h=c.v*(1-e*c.s),i=c.v*(1-(1-e)*c.s);switch(d%6){case 0:b.r=c.v,b.g=i,b.b=f;break;case 1:b.r=h,b.g=c.v,b.b=f;break;case 2:b.r=f,b.g=c.v,b.b=i;break;case 3:b.r=f,b.g=h,b.b=c.v;break;case 4:b.r=i,b.g=f,b.b=c.v;break;case 5:b.r=c.v,b.g=f,b.b=h}return b.r=parseInt(256*b.r,10),b.g=parseInt(256*b.g,10),b.b=parseInt(256*b.b,10),{r:b.r,g:b.g,b:b.b}},e=function(a){a.r=g(parseInt(a.r,10)%256,256),a.g=g(parseInt(a.g,10)%256,256),a.b=g(parseInt(a.b,10)%256,256);var b=Math.max(a.r,a.g,a.b),c=Math.min(a.r,a.g,a.b),d=b-c,e={h:0,s:0===b?0:d/b,v:b};if(b!==c){switch(b){case a.r:e.h=(a.g-a.b)/d+(a.g<a.b?6:0);break;case a.g:e.h=(a.b-a.r)/d+2;break;case a.b:e.h=(a.r-a.g)/d+4}e.h/=6}return e.h=parseInt((360*e.h).toFixed(0),10),e.s=parseInt((100*e.s).toFixed(0),10),e.v=parseInt((100*e.v).toFixed(0),10),e},f=function(a,b,c){return c<0&&(c+=1),c>1&&(c-=1),c<1/6?a+6*(b-a)*c:c<.5?b:c<2/3?a+(b-a)*(2/3-c)*6:a},g=function(a,b){return a/b},h=function(a){var b,c=null,d={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};for(b in d)a===b&&(c=d[b]);return c};return a}();a.exports=d},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(2),h=d(g),i=c(1),j=d(i),k=c(3),l=d(k),m=c(15),n=(d(m),c(76)),o=d(n),p=c(135),q=d(p),r=c(77),s=d(r),t=(c(53),function(a){function b(c,d,e){var g=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{useSnap:!0,snapAngle:5};(0,f.default)(this,b);var i=(0,h.default)(this,a.call(this));return i.renderer=c,i.stageLayer=d,i.stickerLayer=e,i.options=g,i.initialize(),i}return(0,l.default)(b,a),(0,j.default)(b,null,[{key:"DELETED",get:function(){return"deleted"}},{key:"SELECTED",get:function(){return"selected"}},{key:"DESELECTED",get:function(){return"deselected"}},{key:"COMPLETE",get:function(){return"complete"}}]),b.prototype.initialize=function(){this.stickers=[],this.stickerLayer.updateTransform(),this.options.deleteButtonOffsetY=0,this.transformTool=new s.default(this.stageLayer,this.stickerLayer,this.options),this.transformTool.on(s.default.CONTROL_UP,this.onControlUp,this),this.onStickerMouseDown=this.onStickerMouseDown.bind(this),this.onStickerDelete=this.onStickerDelete.bind(this),this.onStickerSelect=this.onStickerSelect.bind(this),this.onStickerDeselect=this.onStickerDeselect.bind(this),this.onLoadComplete=this.onLoadComplete.bind(this)},b.prototype.createSticker=function(a,b,c,d,e){return this.initializeSticker(new o.default(this.stageLayer.options.canvasLimitSize),a,b,c,d,e)},b.prototype.createPNGSticker=function(a,b,c,d,e){return this.initializeSticker(new q.default(this.stageLayer.options.canvasLimitSize),a,b,c,d,e)},b.prototype.initializeSticker=function(a,b,c,d,e,f){return this.stickerLayer.addChild(a),this.stickers.push(a),a.pivot.x=e/2,a.pivot.y=f/2,a.on("mousedown",this.onStickerMouseDown),a.on(s.default.DELETE,this.onStickerDelete),a.on(s.default.SELECT,this.onStickerSelect),a.on(s.default.DESELECT,this.onStickerDeselect),
a.on(o.default.LOAD_COMPLETE,this.onLoadComplete),a.load(b,0,0,e,f),a},b.prototype.deleteSticker=function(a){if(null!==a){var b=this.transformTool.selectedControl;b&&b.isMouseDown&&b.onMouseUp(),a.off("mousedown",this.onStickerMouseDown),a.off(s.default.DELETE,this.onStickerDelete),a.off(s.default.SELECT,this.onStickerSelect),a.off(s.default.DESELECT,this.onStickerDeselect),a.off(o.default.LOAD_COMPLETE,this.onLoadComplete);for(var c=0;c<this.stickers.length;c++){var d=this.stickers[c];d===a&&(this.stickers.splice(c,1),this.stickerLayer.removeChild(d),this.transformTool.releaseTarget(),d.delete(),d=null)}}},b.prototype.restore=function(a){if(1==this._debugMode&&(this._debugSnapshot=a),this._numRestoredStickers=0,a){this.stickers=null,this.stickers=[],this._numRestoredStickers=a.length;for(var b=0;b<a.length;b++){var c=a[b],d=c.transform,e=c.pngSource?new q.default:new o.default;e._restored=!0,e.childScaleX=d.childScaleX,e.childScaleY=d.childScaleY,e.childIndex=c.childIndex,this.initializeSticker(e,c.url,d.x,d.y,c.width,c.height),e.x=d.x,e.y=d.y,e.scale.x=d.scaleX,e.scale.y=d.scaleY,e.rotation=d.rotation,e.pivot.x=d.pivotX,e.pivot.y=d.pivotY,e._restoreScaleSignX=d.scaleSignX,e._restoreScaleSignY=d.scaleSignY,e.stickerID=c.stickerID,1==this._debugMode&&(e._debugSnapshot=c)}}},b.prototype.updateTransformTool=function(){this.transformTool.updateGraphics()},b.prototype.releaseTarget=function(){this.transformTool.releaseTarget()},b.prototype.show=function(){for(var a=0;a<this.stickers.length;a++)this.stickers[a].visible=!0;this.transformTool.show()},b.prototype.hide=function(){for(var a=0;a<this.stickers.length;a++)this.stickers[a].visible=!1;this.transformTool.hide()},b.prototype.clear=function(){for(var a=this.stickers.slice(0),b=0;b<a.length;b++)this.deleteSticker(a[b])},b.prototype.update=function(){this.transformTool.update()},b.prototype.resize=function(){},b.prototype.onControlUp=function(a){this.emit(a.type,a)},b.prototype.onLoadComplete=function(a){var c=a.target;c._restored?(c.image.scale.x=c.childScaleX,c.image.scale.y=c.childScaleY):(this.stickerLayer.updateTransform(),this.transformTool.activeTarget(c)),c._restored=!1,this.complete&&this.stickers.length>=this._numRestoredStickers&&(this.emit(b.COMPLETE),this._numRestoredStickers=0)},b.prototype.onStickerClick=function(a){var b=a.target;1==this._debugMode&&this.traceSticker(b),this.stickerLayer.setChildIndex(b,this.stickerLayer.children.length-1),this.transformTool.setTarget(a)},b.prototype.onStickerMouseDown=function(a){a.target;a.stopPropagation(),this.onStickerClick(a)},b.prototype.onStickerDelete=function(a){this.deleteSticker(a),this.emit(b.DELETED,a)},b.prototype.onStickerSelect=function(a){this.emit(b.SELECTED,a)},b.prototype.onStickerDeselect=function(a){this.emit(b.DESELECTED,a)},b.prototype.onKeyUp=function(a){switch(a.keyCode){case 27:this.clear();break;case 32:this.debugRestoreSticker(this.target);break;case 49:this.traceSticker(this.target),this.traceSnapshot(this.target)}},b.prototype.addDebug=function(){this._debugMode=!0,window.document.addEventListener("keyup",this.onKeyUp.bind(this))},b.prototype.traceSticker=function(a){window._s=a,void 0},b.prototype.traceSnapshot=function(a){a._debugSnapshot&&(a=a._debugSnapshot),a.transform&&void 0},b.prototype.debugRestoreSticker=function(a){if(this._debugSnapshot)for(var b=0;b<this._debugSnapshot.length;b++){var c=this._debugSnapshot[b];a.url==c.url&&(this.traceSnapshot(c),this.traceSticker(a),a.scaleSignX=c.transform.scaleSignX,a.scaleSignY=c.transform.scaleSignY)}},(0,j.default)(b,[{key:"snapshot",get:function(){for(var a=[],b=0;b<this.stickers.length;b++){var c=this.stickers[b].snapshot;c.childIndex=this.stickerLayer.getChildIndex(this.stickers[b]),a[b]=c}return a.sort(function(a,b){return a.childIndex<b.childIndex?-1:a.childIndex>b.childIndex?1:0}),a}},{key:"modified",get:function(){return 0!==this.stickers.length}},{key:"lastSticker",get:function(){if(0===this.stickers.length)return null;for(var a=this.stickerLayer.children,b=a.length;b--;)if(-1!=this.stickers.indexOf(a[b]))return a[b];return null}},{key:"target",get:function(){return this.transformTool.target}},{key:"complete",get:function(){return this.stickers.every(function(a){return a.complete})}}]),b}(PIXI.utils.EventEmitter));b.default=t},function(a,b,c){"use strict";!function(b,d){void 0!==a&&a.exports&&(a.exports=d(c(334),c(335))),b.canvg=d(b.RGBColor,b.stackBlur)}("undefined"!=typeof window?window:void 0,function(a,b){function c(a){var b=[0,0,0],c=function(c,d){var e=a.match(c);null!=e&&(b[d]+=e.length,a=a.replace(c," "))};return a=a.replace(/:not\(([^\)]*)\)/g,"     $1 "),a=a.replace(/{[\s\S]*/gm," "),c(g,1),c(h,0),c(i,1),c(j,2),c(k,1),c(l,1),a=a.replace(/[\*\s\+>~]/g," "),a=a.replace(/[#\.]/g," "),c(m,2),b.join("")}function d(d){var f={opts:d};f.FRAMERATE=30,f.MAX_VIRTUAL_PIXELS=3e4,f.log=function(a){},1==f.opts.log&&"undefined"!=typeof console&&(f.log=function(a){void 0}),f.init=function(a){var b=0;f.UniqueId=function(){return"canvg"+ ++b},f.Definitions={},f.Styles={},f.StylesSpecificity={},f.Animations=[],f.Images=[],f.ctx=a,f.ViewPort=new function(){this.viewPorts=[],this.Clear=function(){this.viewPorts=[]},this.SetCurrent=function(a,b){this.viewPorts.push({width:a,height:b})},this.RemoveCurrent=function(){this.viewPorts.pop()},this.Current=function(){return this.viewPorts[this.viewPorts.length-1]},this.width=function(){return this.Current().width},this.height=function(){return this.Current().height},this.ComputeSize=function(a){return null!=a&&"number"==typeof a?a:"x"==a?this.width():"y"==a?this.height():Math.sqrt(Math.pow(this.width(),2)+Math.pow(this.height(),2))/Math.sqrt(2)}}},f.init(),f.ImagesLoaded=function(){for(var a=0;a<f.Images.length;a++)if(!f.Images[a].loaded)return!1;return!0},f.trim=function(a){return a.replace(/^\s+|\s+$/g,"")},f.compressSpaces=function(a){return a.replace(/[\s\r\t\n]+/gm," ")},f.ajax=function(a){var b;return b=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),b?(b.open("GET",a,!1),b.send(null),b.responseText):null},f.parseXml=function(a){if("undefined"!=typeof Windows&&void 0!==Windows.Data&&void 0!==Windows.Data.Xml){var b=new Windows.Data.Xml.Dom.XmlDocument,c=new Windows.Data.Xml.Dom.XmlLoadSettings;return c.prohibitDtd=!1,b.loadXml(a,c),b}if(window.DOMParser){return(new DOMParser).parseFromString(a,"text/xml")}a=a.replace(/<!DOCTYPE svg[^>]*>/,"");var b=new ActiveXObject("Microsoft.XMLDOM");return b.async="false",b.loadXML(a),b},f.Property=function(a,b){this.name=a,this.value=b},f.Property.prototype.getValue=function(){return this.value},f.Property.prototype.hasValue=function(){return null!=this.value&&""!==this.value},f.Property.prototype.numValue=function(){if(!this.hasValue())return 0;var a=parseFloat(this.value);return(this.value+"").match(/%$/)&&(a/=100),a},f.Property.prototype.valueOrDefault=function(a){return this.hasValue()?this.value:a},f.Property.prototype.numValueOrDefault=function(a){return this.hasValue()?this.numValue():a},f.Property.prototype.addOpacity=function(b){var c=this.value;if(null!=b.value&&""!=b.value&&"string"==typeof this.value){var d=new a(this.value);d.ok&&(c="rgba("+d.r+", "+d.g+", "+d.b+", "+b.numValue()+")")}return new f.Property(this.name,c)},f.Property.prototype.getDefinition=function(){var a=this.value.match(/#([^\)'"]+)/);return a&&(a=a[1]),a||(a=this.value),f.Definitions[a]},f.Property.prototype.isUrlDefinition=function(){return 0==this.value.indexOf("url(")},f.Property.prototype.getFillStyleDefinition=function(a,b){var c=this.getDefinition();if(null!=c&&c.createGradient)return c.createGradient(f.ctx,a,b);if(null!=c&&c.createPattern){if(c.getHrefAttribute().hasValue()){var d=c.attribute("patternTransform");c=c.getHrefAttribute().getDefinition(),d.hasValue()&&(c.attribute("patternTransform",!0).value=d.value)}return c.createPattern(f.ctx,a)}return null},f.Property.prototype.getDPI=function(a){return 96},f.Property.prototype.getEM=function(a){var b=12,c=new f.Property("fontSize",f.Font.Parse(f.ctx.font).fontSize);return c.hasValue()&&(b=c.toPixels(a)),b},f.Property.prototype.getUnits=function(){return(this.value+"").replace(/[0-9\.\-]/g,"")},f.Property.prototype.toPixels=function(a,b){if(!this.hasValue())return 0;var c=this.value+"";if(c.match(/em$/))return this.numValue()*this.getEM(a);if(c.match(/ex$/))return this.numValue()*this.getEM(a)/2;if(c.match(/px$/))return this.numValue();if(c.match(/pt$/))return this.numValue()*this.getDPI(a)*(1/72);if(c.match(/pc$/))return 15*this.numValue();if(c.match(/cm$/))return this.numValue()*this.getDPI(a)/2.54;if(c.match(/mm$/))return this.numValue()*this.getDPI(a)/25.4;if(c.match(/in$/))return this.numValue()*this.getDPI(a);if(c.match(/%$/))return this.numValue()*f.ViewPort.ComputeSize(a);var d=this.numValue();return b&&d<1?d*f.ViewPort.ComputeSize(a):d},f.Property.prototype.toMilliseconds=function(){if(!this.hasValue())return 0;var a=this.value+"";return a.match(/s$/)?1e3*this.numValue():(a.match(/ms$/),this.numValue())},f.Property.prototype.toRadians=function(){if(!this.hasValue())return 0;var a=this.value+"";return a.match(/deg$/)?this.numValue()*(Math.PI/180):a.match(/grad$/)?this.numValue()*(Math.PI/200):a.match(/rad$/)?this.numValue():this.numValue()*(Math.PI/180)};var g={baseline:"alphabetic","before-edge":"top","text-before-edge":"top",middle:"middle",central:"middle","after-edge":"bottom","text-after-edge":"bottom",ideographic:"ideographic",alphabetic:"alphabetic",hanging:"hanging",mathematical:"alphabetic"};return f.Property.prototype.toTextBaseline=function(){return this.hasValue()?g[this.value]:null},f.Font=new function(){this.Styles="normal|italic|oblique|inherit",this.Variants="normal|small-caps|inherit",this.Weights="normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit",this.CreateFont=function(a,b,c,d,e,g){var h=null!=g?this.Parse(g):this.CreateFont("","","","","",f.ctx.font);return{fontFamily:e||h.fontFamily,fontSize:d||h.fontSize,fontStyle:a||h.fontStyle,fontWeight:c||h.fontWeight,fontVariant:b||h.fontVariant,toString:function(){return[this.fontStyle,this.fontVariant,this.fontWeight,this.fontSize,this.fontFamily].join(" ")}}};var a=this;this.Parse=function(b){for(var c={},d=f.trim(f.compressSpaces(b||"")).split(" "),e={fontSize:!1,fontStyle:!1,fontWeight:!1,fontVariant:!1},g="",h=0;h<d.length;h++)e.fontStyle||-1==a.Styles.indexOf(d[h])?e.fontVariant||-1==a.Variants.indexOf(d[h])?e.fontWeight||-1==a.Weights.indexOf(d[h])?e.fontSize?"inherit"!=d[h]&&(g+=d[h]):("inherit"!=d[h]&&(c.fontSize=d[h].split("/")[0]),e.fontStyle=e.fontVariant=e.fontWeight=e.fontSize=!0):("inherit"!=d[h]&&(c.fontWeight=d[h]),e.fontStyle=e.fontVariant=e.fontWeight=!0):("inherit"!=d[h]&&(c.fontVariant=d[h]),e.fontStyle=e.fontVariant=!0):("inherit"!=d[h]&&(c.fontStyle=d[h]),e.fontStyle=!0);return""!=g&&(c.fontFamily=g),c}},f.ToNumberArray=function(a){for(var b=f.trim(f.compressSpaces((a||"").replace(/,/g," "))).split(" "),c=0;c<b.length;c++)b[c]=parseFloat(b[c]);return b},f.Point=function(a,b){this.x=a,this.y=b},f.Point.prototype.angleTo=function(a){return Math.atan2(a.y-this.y,a.x-this.x)},f.Point.prototype.applyTransform=function(a){var b=this.x*a[0]+this.y*a[2]+a[4],c=this.x*a[1]+this.y*a[3]+a[5];this.x=b,this.y=c},f.CreatePoint=function(a){var b=f.ToNumberArray(a);return new f.Point(b[0],b[1])},f.CreatePath=function(a){for(var b=f.ToNumberArray(a),c=[],d=0;d<b.length;d+=2)c.push(new f.Point(b[d],b[d+1]));return c},f.BoundingBox=function(a,b,c,d){this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN,this.x=function(){return this.x1},this.y=function(){return this.y1},this.width=function(){return this.x2-this.x1},this.height=function(){return this.y2-this.y1},this.addPoint=function(a,b){null!=a&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=a,this.x2=a),a<this.x1&&(this.x1=a),a>this.x2&&(this.x2=a)),null!=b&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=b,this.y2=b),b<this.y1&&(this.y1=b),b>this.y2&&(this.y2=b))},this.addX=function(a){this.addPoint(a,null)},this.addY=function(a){this.addPoint(null,a)},this.addBoundingBox=function(a){this.addPoint(a.x1,a.y1),this.addPoint(a.x2,a.y2)},this.addQuadraticCurve=function(a,b,c,d,e,f){var g=a+2/3*(c-a),h=b+2/3*(d-b),i=g+1/3*(e-a),j=h+1/3*(f-b);this.addBezierCurve(a,b,g,i,h,j,e,f)},this.addBezierCurve=function(a,b,c,d,e,f,g,h){var i=[a,b],j=[c,d],k=[e,f],l=[g,h];this.addPoint(i[0],i[1]),this.addPoint(l[0],l[1]);var m;for(m=0;m<=1;m++){var n=function(a){return Math.pow(1-a,3)*i[m]+3*Math.pow(1-a,2)*a*j[m]+3*(1-a)*Math.pow(a,2)*k[m]+Math.pow(a,3)*l[m]},o=6*i[m]-12*j[m]+6*k[m],p=-3*i[m]+9*j[m]-9*k[m]+3*l[m],q=3*j[m]-3*i[m];if(0!=p){var r=Math.pow(o,2)-4*q*p;if(!(r<0)){var s=(-o+Math.sqrt(r))/(2*p);0<s&&s<1&&(0==m&&this.addX(n(s)),1==m&&this.addY(n(s)));var t=(-o-Math.sqrt(r))/(2*p);0<t&&t<1&&(0==m&&this.addX(n(t)),1==m&&this.addY(n(t)))}}else{if(0==o)continue;var u=-q/o;0<u&&u<1&&(0==m&&this.addX(n(u)),1==m&&this.addY(n(u)))}}},this.isPointInBox=function(a,b){return this.x1<=a&&a<=this.x2&&this.y1<=b&&b<=this.y2},this.addPoint(a,b),this.addPoint(c,d)},f.Transform=function(a){var b=this;this.Type={},this.Type.translate=function(a){this.p=f.CreatePoint(a),this.apply=function(a){a.translate(this.p.x||0,this.p.y||0)},this.unapply=function(a){a.translate(-1*this.p.x||0,-1*this.p.y||0)},this.applyToPoint=function(a){a.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0])}},this.Type.rotate=function(a){var b=f.ToNumberArray(a);this.angle=new f.Property("angle",b[0]),this.cx=b[1]||0,this.cy=b[2]||0,this.apply=function(a){a.translate(this.cx,this.cy),a.rotate(this.angle.toRadians()),a.translate(-this.cx,-this.cy)},this.unapply=function(a){a.translate(this.cx,this.cy),a.rotate(-1*this.angle.toRadians()),a.translate(-this.cx,-this.cy)},this.applyToPoint=function(a){var b=this.angle.toRadians();a.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0]),a.applyTransform([Math.cos(b),Math.sin(b),-Math.sin(b),Math.cos(b),0,0]),a.applyTransform([1,0,0,1,-this.p.x||0,-this.p.y||0])}},this.Type.scale=function(a){this.p=f.CreatePoint(a),this.apply=function(a){a.scale(this.p.x||1,this.p.y||this.p.x||1)},this.unapply=function(a){a.scale(1/this.p.x||1,1/this.p.y||this.p.x||1)},this.applyToPoint=function(a){a.applyTransform([this.p.x||0,0,0,this.p.y||0,0,0])}},this.Type.matrix=function(a){this.m=f.ToNumberArray(a),this.apply=function(a){a.transform(this.m[0],this.m[1],this.m[2],this.m[3],this.m[4],this.m[5])},this.unapply=function(a){var b=this.m[0],c=this.m[2],d=this.m[4],e=this.m[1],f=this.m[3],g=this.m[5],h=1/(b*(1*f-0*g)-c*(1*e-0*g)+d*(0*e-0*f));a.transform(h*(1*f-0*g),h*(0*g-1*e),h*(0*d-1*c),h*(1*b-0*d),h*(c*g-d*f),h*(d*e-b*g))},this.applyToPoint=function(a){a.applyTransform(this.m)}},this.Type.SkewBase=function(a){this.base=b.Type.matrix,this.base(a),this.angle=new f.Property("angle",a)},this.Type.SkewBase.prototype=new this.Type.matrix,this.Type.skewX=function(a){this.base=b.Type.SkewBase,this.base(a),this.m=[1,0,Math.tan(this.angle.toRadians()),1,0,0]},this.Type.skewX.prototype=new this.Type.SkewBase,this.Type.skewY=function(a){this.base=b.Type.SkewBase,this.base(a),this.m=[1,Math.tan(this.angle.toRadians()),0,1,0,0]},this.Type.skewY.prototype=new this.Type.SkewBase,this.transforms=[],this.apply=function(a){for(var b=0;b<this.transforms.length;b++)this.transforms[b].apply(a)},this.unapply=function(a){for(var b=this.transforms.length-1;b>=0;b--)this.transforms[b].unapply(a)},this.applyToPoint=function(a){for(var b=0;b<this.transforms.length;b++)this.transforms[b].applyToPoint(a)};for(var c=f.trim(f.compressSpaces(a)).replace(/\)([a-zA-Z])/g,") $1").replace(/\)(\s?,\s?)/g,") ").split(/\s(?=[a-z])/),d=0;d<c.length;d++){var e=f.trim(c[d].split("(")[0]),g=c[d].split("(")[1].replace(")",""),h=this.Type[e];if(void 0!==h){var i=new h(g);i.type=e,this.transforms.push(i)}}},f.AspectRatio=function(a,b,c,d,e,g,h,i,j,k){b=f.compressSpaces(b),b=b.replace(/^defer\s/,"");var l=b.split(" ")[0]||"xMidYMid",m=b.split(" ")[1]||"meet",n=c/d,o=e/g,p=Math.min(n,o),q=Math.max(n,o);"meet"==m&&(d*=p,g*=p),"slice"==m&&(d*=q,g*=q),j=new f.Property("refX",j),k=new f.Property("refY",k),j.hasValue()&&k.hasValue()?a.translate(-p*j.toPixels("x"),-p*k.toPixels("y")):(l.match(/^xMid/)&&("meet"==m&&p==o||"slice"==m&&q==o)&&a.translate(c/2-d/2,0),l.match(/YMid$/)&&("meet"==m&&p==n||"slice"==m&&q==n)&&a.translate(0,e/2-g/2),l.match(/^xMax/)&&("meet"==m&&p==o||"slice"==m&&q==o)&&a.translate(c-d,0),l.match(/YMax$/)&&("meet"==m&&p==n||"slice"==m&&q==n)&&a.translate(0,e-g)),"none"==l?a.scale(n,o):"meet"==m?a.scale(p,p):"slice"==m&&a.scale(q,q),a.translate(null==h?0:-h,null==i?0:-i)},f.Element={},f.EmptyProperty=new f.Property("EMPTY",""),f.Element.ElementBase=function(a){this.attributes={},this.styles={},this.stylesSpecificity={},this.children=[],this.attribute=function(a,b){var c=this.attributes[a];return null!=c?c:(1==b&&(c=new f.Property(a,""),this.attributes[a]=c),c||f.EmptyProperty)},this.getHrefAttribute=function(){for(var a in this.attributes)if("href"==a||a.match(/:href$/))return this.attributes[a];return f.EmptyProperty},this.style=function(a,b,c){var d=this.styles[a];if(null!=d)return d;var e=this.attribute(a);if(null!=e&&e.hasValue())return this.styles[a]=e,e;if(1!=c){var g=this.parent;if(null!=g){var h=g.style(a);if(null!=h&&h.hasValue())return h}}return 1==b&&(d=new f.Property(a,""),this.styles[a]=d),d||f.EmptyProperty},this.render=function(a){if("none"!=this.style("display").value&&"hidden"!=this.style("visibility").value){if(a.save(),this.style("mask").hasValue()){var b=this.style("mask").getDefinition();null!=b&&b.apply(a,this)}else if(this.style("filter").hasValue()){var c=this.style("filter").getDefinition();null!=c&&c.apply(a,this)}else this.setContext(a),this.renderChildren(a),this.clearContext(a);a.restore()}},this.setContext=function(a){},this.clearContext=function(a){},this.renderChildren=function(a){for(var b=0;b<this.children.length;b++)this.children[b].render(a)},this.addChild=function(a,b){var c=a;b&&(c=f.CreateElement(a)),c.parent=this,"title"!=c.type&&this.children.push(c)},this.addStylesFromStyleDefinition=function(){for(var b in f.Styles)if("@"!=b[0]&&e(a,b)){var c=f.Styles[b],d=f.StylesSpecificity[b];if(null!=c)for(var g in c){var h=this.stylesSpecificity[g];void 0===h&&(h="000"),d>h&&(this.styles[g]=c[g],this.stylesSpecificity[g]=d)}}};var b=new RegExp("^[A-Z-]+$");if(null!=a&&1==a.nodeType){for(var c=0;c<a.attributes.length;c++){var d=a.attributes[c],g=function(a){return b.test(a)?a.toLowerCase():a}(d.nodeName);this.attributes[g]=new f.Property(g,d.value)}if(this.addStylesFromStyleDefinition(),this.attribute("style").hasValue())for(var h=this.attribute("style").value.split(";"),c=0;c<h.length;c++)if(""!=f.trim(h[c])){var i=h[c].split(":"),j=f.trim(i[0]),k=f.trim(i[1]);this.styles[j]=new f.Property(j,k)}this.attribute("id").hasValue()&&null==f.Definitions[this.attribute("id").value]&&(f.Definitions[this.attribute("id").value]=this);for(var c=0;c<a.childNodes.length;c++){var l=a.childNodes[c];if(1==l.nodeType&&this.addChild(l,!0),this.captureTextNodes&&(3==l.nodeType||4==l.nodeType)){var m=l.value||l.text||l.textContent||"";""!=f.compressSpaces(m)&&this.addChild(new f.Element.tspan(l),!1)}}}},f.Element.RenderedElementBase=function(a){this.base=f.Element.ElementBase,this.base(a),this.setContext=function(a){if(this.style("fill").isUrlDefinition()){var b=this.style("fill").getFillStyleDefinition(this,this.style("fill-opacity"));null!=b&&(a.fillStyle=b)}else if(this.style("fill").hasValue()){var c=this.style("fill");"currentColor"==c.value&&(c.value=this.style("color").value),"inherit"!=c.value&&(a.fillStyle="none"==c.value?"rgba(0,0,0,0)":c.value)}if(this.style("fill-opacity").hasValue()){var c=new f.Property("fill",a.fillStyle);c=c.addOpacity(this.style("fill-opacity")),a.fillStyle=c.value}if(this.style("stroke").isUrlDefinition()){var b=this.style("stroke").getFillStyleDefinition(this,this.style("stroke-opacity"));null!=b&&(a.strokeStyle=b)}else if(this.style("stroke").hasValue()){var d=this.style("stroke");"currentColor"==d.value&&(d.value=this.style("color").value),"inherit"!=d.value&&(a.strokeStyle="none"==d.value?"rgba(0,0,0,0)":d.value)}if(this.style("stroke-opacity").hasValue()){var d=new f.Property("stroke",a.strokeStyle);d=d.addOpacity(this.style("stroke-opacity")),a.strokeStyle=d.value}if(this.style("stroke-width").hasValue()){var e=this.style("stroke-width").toPixels();a.lineWidth=0==e?.001:e}if(this.style("stroke-linecap").hasValue()&&(a.lineCap=this.style("stroke-linecap").value),this.style("stroke-linejoin").hasValue()&&(a.lineJoin=this.style("stroke-linejoin").value),this.style("stroke-miterlimit").hasValue()&&(a.miterLimit=this.style("stroke-miterlimit").value),this.style("stroke-dasharray").hasValue()&&"none"!=this.style("stroke-dasharray").value){var g=f.ToNumberArray(this.style("stroke-dasharray").value);void 0!==a.setLineDash?a.setLineDash(g):void 0!==a.webkitLineDash?a.webkitLineDash=g:void 0===a.mozDash||1==g.length&&0==g[0]||(a.mozDash=g);var h=this.style("stroke-dashoffset").numValueOrDefault(1);void 0!==a.lineDashOffset?a.lineDashOffset=h:void 0!==a.webkitLineDashOffset?a.webkitLineDashOffset=h:void 0!==a.mozDashOffset&&(a.mozDashOffset=h)}if(void 0!==a.font&&(a.font=f.Font.CreateFont(this.style("font-style").value,this.style("font-variant").value,this.style("font-weight").value,this.style("font-size").hasValue()?this.style("font-size").toPixels()+"px":"",this.style("font-family").value).toString()),this.style("transform",!1,!0).hasValue()){new f.Transform(this.style("transform",!1,!0).value).apply(a)}if(this.style("clip-path",!1,!0).hasValue()){var i=this.style("clip-path",!1,!0).getDefinition();null!=i&&i.apply(a)}this.style("opacity").hasValue()&&(a.globalAlpha=this.style("opacity").numValue())}},f.Element.RenderedElementBase.prototype=new f.Element.ElementBase,f.Element.PathElementBase=function(a){this.base=f.Element.RenderedElementBase,this.base(a),this.path=function(a){return null!=a&&a.beginPath(),new f.BoundingBox},this.renderChildren=function(a){this.path(a),f.Mouse.checkPath(this,a),""!=a.fillStyle&&("inherit"!=this.style("fill-rule").valueOrDefault("inherit")?a.fill(this.style("fill-rule").value):a.fill()),""!=a.strokeStyle&&a.stroke();var b=this.getMarkers();if(null!=b){if(this.style("marker-start").isUrlDefinition()){var c=this.style("marker-start").getDefinition();c.render(a,b[0][0],b[0][1])}if(this.style("marker-mid").isUrlDefinition())for(var c=this.style("marker-mid").getDefinition(),d=1;d<b.length-1;d++)c.render(a,b[d][0],b[d][1]);if(this.style("marker-end").isUrlDefinition()){var c=this.style("marker-end").getDefinition();c.render(a,b[b.length-1][0],b[b.length-1][1])}}},this.getBoundingBox=function(){return this.path()},this.getMarkers=function(){return null}},f.Element.PathElementBase.prototype=new f.Element.RenderedElementBase,f.Element.svg=function(a){this.base=f.Element.RenderedElementBase,this.base(a),this.baseClearContext=this.clearContext,this.clearContext=function(a){this.baseClearContext(a),f.ViewPort.RemoveCurrent()},this.baseSetContext=this.setContext,this.setContext=function(a){a.strokeStyle="rgba(0,0,0,0)",a.lineCap="butt",a.lineJoin="miter",a.miterLimit=4,void 0!==a.font&&void 0!==window.getComputedStyle&&(a.font=window.getComputedStyle(a.canvas).getPropertyValue("font")),this.baseSetContext(a),this.attribute("x").hasValue()||(this.attribute("x",!0).value=0),this.attribute("y").hasValue()||(this.attribute("y",!0).value=0),a.translate(this.attribute("x").toPixels("x"),this.attribute("y").toPixels("y"));var b=f.ViewPort.width(),c=f.ViewPort.height();if(this.attribute("width").hasValue()||(this.attribute("width",!0).value="100%"),this.attribute("height").hasValue()||(this.attribute("height",!0).value="100%"),void 0===this.root){b=this.attribute("width").toPixels("x"),c=this.attribute("height").toPixels("y");var d=0,e=0;this.attribute("refX").hasValue()&&this.attribute("refY").hasValue()&&(d=-this.attribute("refX").toPixels("x"),e=-this.attribute("refY").toPixels("y")),"visible"!=this.attribute("overflow").valueOrDefault("hidden")&&(a.beginPath(),a.moveTo(d,e),a.lineTo(b,e),a.lineTo(b,c),a.lineTo(d,c),a.closePath(),a.clip())}if(f.ViewPort.SetCurrent(b,c),this.attribute("viewBox").hasValue()){var g=f.ToNumberArray(this.attribute("viewBox").value),h=g[0],i=g[1];b=g[2],c=g[3],f.AspectRatio(a,this.attribute("preserveAspectRatio").value,f.ViewPort.width(),b,f.ViewPort.height(),c,h,i,this.attribute("refX").value,this.attribute("refY").value),f.ViewPort.RemoveCurrent(),f.ViewPort.SetCurrent(g[2],g[3])}}},f.Element.svg.prototype=new f.Element.RenderedElementBase,f.Element.rect=function(a){this.base=f.Element.PathElementBase,this.base(a),this.path=function(a){var b=this.attribute("x").toPixels("x"),c=this.attribute("y").toPixels("y"),d=this.attribute("width").toPixels("x"),e=this.attribute("height").toPixels("y"),g=this.attribute("rx").toPixels("x"),h=this.attribute("ry").toPixels("y");return this.attribute("rx").hasValue()&&!this.attribute("ry").hasValue()&&(h=g),this.attribute("ry").hasValue()&&!this.attribute("rx").hasValue()&&(g=h),g=Math.min(g,d/2),h=Math.min(h,e/2),null!=a&&(a.beginPath(),a.moveTo(b+g,c),a.lineTo(b+d-g,c),a.quadraticCurveTo(b+d,c,b+d,c+h),a.lineTo(b+d,c+e-h),a.quadraticCurveTo(b+d,c+e,b+d-g,c+e),a.lineTo(b+g,c+e),a.quadraticCurveTo(b,c+e,b,c+e-h),a.lineTo(b,c+h),a.quadraticCurveTo(b,c,b+g,c),a.closePath()),new f.BoundingBox(b,c,b+d,c+e)}},f.Element.rect.prototype=new f.Element.PathElementBase,f.Element.circle=function(a){this.base=f.Element.PathElementBase,this.base(a),this.path=function(a){var b=this.attribute("cx").toPixels("x"),c=this.attribute("cy").toPixels("y"),d=this.attribute("r").toPixels();return null!=a&&(a.beginPath(),a.arc(b,c,d,0,2*Math.PI,!0),a.closePath()),new f.BoundingBox(b-d,c-d,b+d,c+d)}},f.Element.circle.prototype=new f.Element.PathElementBase,f.Element.ellipse=function(a){this.base=f.Element.PathElementBase,this.base(a),this.path=function(a){var b=(Math.sqrt(2)-1)/3*4,c=this.attribute("rx").toPixels("x"),d=this.attribute("ry").toPixels("y"),e=this.attribute("cx").toPixels("x"),g=this.attribute("cy").toPixels("y");return null!=a&&(a.beginPath(),a.moveTo(e,g-d),a.bezierCurveTo(e+b*c,g-d,e+c,g-b*d,e+c,g),a.bezierCurveTo(e+c,g+b*d,e+b*c,g+d,e,g+d),a.bezierCurveTo(e-b*c,g+d,e-c,g+b*d,e-c,g),a.bezierCurveTo(e-c,g-b*d,e-b*c,g-d,e,g-d),a.closePath()),new f.BoundingBox(e-c,g-d,e+c,g+d)}},f.Element.ellipse.prototype=new f.Element.PathElementBase,f.Element.line=function(a){this.base=f.Element.PathElementBase,this.base(a),this.getPoints=function(){return[new f.Point(this.attribute("x1").toPixels("x"),this.attribute("y1").toPixels("y")),new f.Point(this.attribute("x2").toPixels("x"),this.attribute("y2").toPixels("y"))]},this.path=function(a){var b=this.getPoints();return null!=a&&(a.beginPath(),a.moveTo(b[0].x,b[0].y),a.lineTo(b[1].x,b[1].y)),new f.BoundingBox(b[0].x,b[0].y,b[1].x,b[1].y)},this.getMarkers=function(){var a=this.getPoints(),b=a[0].angleTo(a[1]);return[[a[0],b],[a[1],b]]}},f.Element.line.prototype=new f.Element.PathElementBase,f.Element.polyline=function(a){this.base=f.Element.PathElementBase,this.base(a),this.points=f.CreatePath(this.attribute("points").value),this.path=function(a){var b=new f.BoundingBox(this.points[0].x,this.points[0].y);null!=a&&(a.beginPath(),a.moveTo(this.points[0].x,this.points[0].y));for(var c=1;c<this.points.length;c++)b.addPoint(this.points[c].x,this.points[c].y),null!=a&&a.lineTo(this.points[c].x,this.points[c].y);return b},this.getMarkers=function(){for(var a=[],b=0;b<this.points.length-1;b++)a.push([this.points[b],this.points[b].angleTo(this.points[b+1])]);return a.length>0&&a.push([this.points[this.points.length-1],a[a.length-1][1]]),a}},f.Element.polyline.prototype=new f.Element.PathElementBase,f.Element.polygon=function(a){this.base=f.Element.polyline,this.base(a),this.basePath=this.path,this.path=function(a){var b=this.basePath(a);return null!=a&&(a.lineTo(this.points[0].x,this.points[0].y),a.closePath()),b}},f.Element.polygon.prototype=new f.Element.polyline,f.Element.path=function(a){this.base=f.Element.PathElementBase,this.base(a);var b=this.attribute("d").value;b=b.replace(/,/gm," ");for(var c=0;c<2;c++)b=b.replace(/([MmZzLlHhVvCcSsQqTtAa])([^\s])/gm,"$1 $2");b=b.replace(/([^\s])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2"),b=b.replace(/([0-9])([+\-])/gm,"$1 $2");for(var c=0;c<2;c++)b=b.replace(/(\.[0-9]*)(\.)/gm,"$1 $2");b=b.replace(/([Aa](\s+[0-9]+){3})\s+([01])\s*([01])/gm,"$1 $3 $4 "),b=f.compressSpaces(b),b=f.trim(b),this.PathParser=new function(a){this.tokens=a.split(" "),this.reset=function(){this.i=-1,this.command="",this.previousCommand="",this.start=new f.Point(0,0),this.control=new f.Point(0,0),this.current=new f.Point(0,0),this.points=[],this.angles=[]},this.isEnd=function(){return this.i>=this.tokens.length-1},this.isCommandOrEnd=function(){return!!this.isEnd()||null!=this.tokens[this.i+1].match(/^[A-Za-z]$/)},this.isRelativeCommand=function(){switch(this.command){case"m":case"l":case"h":case"v":case"c":case"s":case"q":case"t":case"a":case"z":return!0}return!1},this.getToken=function(){return this.i++,this.tokens[this.i]},this.getScalar=function(){return parseFloat(this.getToken())},this.nextCommand=function(){this.previousCommand=this.command,this.command=this.getToken()},this.getPoint=function(){var a=new f.Point(this.getScalar(),this.getScalar());return this.makeAbsolute(a)},this.getAsControlPoint=function(){var a=this.getPoint();return this.control=a,a},this.getAsCurrentPoint=function(){var a=this.getPoint();return this.current=a,a},this.getReflectedControlPoint=function(){return"c"!=this.previousCommand.toLowerCase()&&"s"!=this.previousCommand.toLowerCase()&&"q"!=this.previousCommand.toLowerCase()&&"t"!=this.previousCommand.toLowerCase()?this.current:new f.Point(2*this.current.x-this.control.x,2*this.current.y-this.control.y)},this.makeAbsolute=function(a){return this.isRelativeCommand()&&(a.x+=this.current.x,a.y+=this.current.y),a},this.addMarker=function(a,b,c){null!=c&&this.angles.length>0&&null==this.angles[this.angles.length-1]&&(this.angles[this.angles.length-1]=this.points[this.points.length-1].angleTo(c)),this.addMarkerAngle(a,null==b?null:b.angleTo(a))},this.addMarkerAngle=function(a,b){this.points.push(a),this.angles.push(b)},this.getMarkerPoints=function(){return this.points},this.getMarkerAngles=function(){for(var a=0;a<this.angles.length;a++)if(null==this.angles[a])for(var b=a+1;b<this.angles.length;b++)if(null!=this.angles[b]){this.angles[a]=this.angles[b];break}return this.angles}}(b),this.path=function(a){var b=this.PathParser;b.reset();var c=new f.BoundingBox;for(null!=a&&a.beginPath();!b.isEnd();)switch(b.nextCommand(),b.command){case"M":case"m":var d=b.getAsCurrentPoint();for(b.addMarker(d),c.addPoint(d.x,d.y),null!=a&&a.moveTo(d.x,d.y),b.start=b.current;!b.isCommandOrEnd();){var d=b.getAsCurrentPoint();b.addMarker(d,b.start),c.addPoint(d.x,d.y),null!=a&&a.lineTo(d.x,d.y)}break;case"L":case"l":for(;!b.isCommandOrEnd();){var e=b.current,d=b.getAsCurrentPoint();b.addMarker(d,e),c.addPoint(d.x,d.y),null!=a&&a.lineTo(d.x,d.y)}break;case"H":case"h":for(;!b.isCommandOrEnd();){var g=new f.Point((b.isRelativeCommand()?b.current.x:0)+b.getScalar(),b.current.y);b.addMarker(g,b.current),b.current=g,c.addPoint(b.current.x,b.current.y),null!=a&&a.lineTo(b.current.x,b.current.y)}break;case"V":case"v":for(;!b.isCommandOrEnd();){var g=new f.Point(b.current.x,(b.isRelativeCommand()?b.current.y:0)+b.getScalar());b.addMarker(g,b.current),b.current=g,c.addPoint(b.current.x,b.current.y),null!=a&&a.lineTo(b.current.x,b.current.y)}break;case"C":case"c":for(;!b.isCommandOrEnd();){var h=b.current,i=b.getPoint(),j=b.getAsControlPoint(),k=b.getAsCurrentPoint();b.addMarker(k,j,i),c.addBezierCurve(h.x,h.y,i.x,i.y,j.x,j.y,k.x,k.y),null!=a&&a.bezierCurveTo(i.x,i.y,j.x,j.y,k.x,k.y)}break;case"S":case"s":for(;!b.isCommandOrEnd();){var h=b.current,i=b.getReflectedControlPoint(),j=b.getAsControlPoint(),k=b.getAsCurrentPoint();
b.addMarker(k,j,i),c.addBezierCurve(h.x,h.y,i.x,i.y,j.x,j.y,k.x,k.y),null!=a&&a.bezierCurveTo(i.x,i.y,j.x,j.y,k.x,k.y)}break;case"Q":case"q":for(;!b.isCommandOrEnd();){var h=b.current,j=b.getAsControlPoint(),k=b.getAsCurrentPoint();b.addMarker(k,j,j),c.addQuadraticCurve(h.x,h.y,j.x,j.y,k.x,k.y),null!=a&&a.quadraticCurveTo(j.x,j.y,k.x,k.y)}break;case"T":case"t":for(;!b.isCommandOrEnd();){var h=b.current,j=b.getReflectedControlPoint();b.control=j;var k=b.getAsCurrentPoint();b.addMarker(k,j,j),c.addQuadraticCurve(h.x,h.y,j.x,j.y,k.x,k.y),null!=a&&a.quadraticCurveTo(j.x,j.y,k.x,k.y)}break;case"A":case"a":for(;!b.isCommandOrEnd();){var h=b.current,l=b.getScalar(),m=b.getScalar(),n=b.getScalar()*(Math.PI/180),o=b.getScalar(),p=b.getScalar(),k=b.getAsCurrentPoint(),q=new f.Point(Math.cos(n)*(h.x-k.x)/2+Math.sin(n)*(h.y-k.y)/2,-Math.sin(n)*(h.x-k.x)/2+Math.cos(n)*(h.y-k.y)/2),r=Math.pow(q.x,2)/Math.pow(l,2)+Math.pow(q.y,2)/Math.pow(m,2);r>1&&(l*=Math.sqrt(r),m*=Math.sqrt(r));var s=(o==p?-1:1)*Math.sqrt((Math.pow(l,2)*Math.pow(m,2)-Math.pow(l,2)*Math.pow(q.y,2)-Math.pow(m,2)*Math.pow(q.x,2))/(Math.pow(l,2)*Math.pow(q.y,2)+Math.pow(m,2)*Math.pow(q.x,2)));isNaN(s)&&(s=0);var t=new f.Point(s*l*q.y/m,s*-m*q.x/l),u=new f.Point((h.x+k.x)/2+Math.cos(n)*t.x-Math.sin(n)*t.y,(h.y+k.y)/2+Math.sin(n)*t.x+Math.cos(n)*t.y),v=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2))},w=function(a,b){return(a[0]*b[0]+a[1]*b[1])/(v(a)*v(b))},x=function(a,b){return(a[0]*b[1]<a[1]*b[0]?-1:1)*Math.acos(w(a,b))},y=x([1,0],[(q.x-t.x)/l,(q.y-t.y)/m]),z=[(q.x-t.x)/l,(q.y-t.y)/m],A=[(-q.x-t.x)/l,(-q.y-t.y)/m],B=x(z,A);w(z,A)<=-1&&(B=Math.PI),w(z,A)>=1&&(B=0);var C=1-p?1:-1,D=y+C*(B/2),E=new f.Point(u.x+l*Math.cos(D),u.y+m*Math.sin(D));if(b.addMarkerAngle(E,D-C*Math.PI/2),b.addMarkerAngle(k,D-C*Math.PI),c.addPoint(k.x,k.y),null!=a){var w=l>m?l:m,F=l>m?1:l/m,G=l>m?m/l:1;a.translate(u.x,u.y),a.rotate(n),a.scale(F,G),a.arc(0,0,w,y,y+B,1-p),a.scale(1/F,1/G),a.rotate(-n),a.translate(-u.x,-u.y)}}break;case"Z":case"z":null!=a&&a.closePath(),b.current=b.start}return c},this.getMarkers=function(){for(var a=this.PathParser.getMarkerPoints(),b=this.PathParser.getMarkerAngles(),c=[],d=0;d<a.length;d++)c.push([a[d],b[d]]);return c}},f.Element.path.prototype=new f.Element.PathElementBase,f.Element.pattern=function(a){this.base=f.Element.ElementBase,this.base(a),this.createPattern=function(a,b){var c=this.attribute("width").toPixels("x",!0),d=this.attribute("height").toPixels("y",!0),e=new f.Element.svg;e.attributes.viewBox=new f.Property("viewBox",this.attribute("viewBox").value),e.attributes.width=new f.Property("width",c+"px"),e.attributes.height=new f.Property("height",d+"px"),e.attributes.transform=new f.Property("transform",this.attribute("patternTransform").value),e.children=this.children;var g=document.createElement("canvas");g.width=c,g.height=d;var h=g.getContext("2d");this.attribute("x").hasValue()&&this.attribute("y").hasValue()&&h.translate(this.attribute("x").toPixels("x",!0),this.attribute("y").toPixels("y",!0));for(var i=-1;i<=1;i++)for(var j=-1;j<=1;j++)h.save(),e.attributes.x=new f.Property("x",i*g.width),e.attributes.y=new f.Property("y",j*g.height),e.render(h),h.restore();return a.createPattern(g,"repeat")}},f.Element.pattern.prototype=new f.Element.ElementBase,f.Element.marker=function(a){this.base=f.Element.ElementBase,this.base(a),this.baseRender=this.render,this.render=function(a,b,c){a.translate(b.x,b.y),"auto"==this.attribute("orient").valueOrDefault("auto")&&a.rotate(c),"strokeWidth"==this.attribute("markerUnits").valueOrDefault("strokeWidth")&&a.scale(a.lineWidth,a.lineWidth),a.save();var d=new f.Element.svg;d.attributes.viewBox=new f.Property("viewBox",this.attribute("viewBox").value),d.attributes.refX=new f.Property("refX",this.attribute("refX").value),d.attributes.refY=new f.Property("refY",this.attribute("refY").value),d.attributes.width=new f.Property("width",this.attribute("markerWidth").value),d.attributes.height=new f.Property("height",this.attribute("markerHeight").value),d.attributes.fill=new f.Property("fill",this.attribute("fill").valueOrDefault("black")),d.attributes.stroke=new f.Property("stroke",this.attribute("stroke").valueOrDefault("none")),d.children=this.children,d.render(a),a.restore(),"strokeWidth"==this.attribute("markerUnits").valueOrDefault("strokeWidth")&&a.scale(1/a.lineWidth,1/a.lineWidth),"auto"==this.attribute("orient").valueOrDefault("auto")&&a.rotate(-c),a.translate(-b.x,-b.y)}},f.Element.marker.prototype=new f.Element.ElementBase,f.Element.defs=function(a){this.base=f.Element.ElementBase,this.base(a),this.render=function(a){}},f.Element.defs.prototype=new f.Element.ElementBase,f.Element.GradientBase=function(a){this.base=f.Element.ElementBase,this.base(a),this.stops=[];for(var b=0;b<this.children.length;b++){var c=this.children[b];"stop"==c.type&&this.stops.push(c)}this.getGradient=function(){},this.gradientUnits=function(){return this.attribute("gradientUnits").valueOrDefault("objectBoundingBox")},this.attributesToInherit=["gradientUnits"],this.inheritStopContainer=function(a){for(var b=0;b<this.attributesToInherit.length;b++){var c=this.attributesToInherit[b];!this.attribute(c).hasValue()&&a.attribute(c).hasValue()&&(this.attribute(c,!0).value=a.attribute(c).value)}},this.createGradient=function(a,b,c){var d=this;this.getHrefAttribute().hasValue()&&(d=this.getHrefAttribute().getDefinition(),this.inheritStopContainer(d));var e=function(a){if(c.hasValue()){return new f.Property("color",a).addOpacity(c).value}return a},g=this.getGradient(a,b);if(null==g)return e(d.stops[d.stops.length-1].color);for(var h=0;h<d.stops.length;h++)g.addColorStop(d.stops[h].offset,e(d.stops[h].color));if(this.attribute("gradientTransform").hasValue()){var i=f.ViewPort.viewPorts[0],j=new f.Element.rect;j.attributes.x=new f.Property("x",-f.MAX_VIRTUAL_PIXELS/3),j.attributes.y=new f.Property("y",-f.MAX_VIRTUAL_PIXELS/3),j.attributes.width=new f.Property("width",f.MAX_VIRTUAL_PIXELS),j.attributes.height=new f.Property("height",f.MAX_VIRTUAL_PIXELS);var k=new f.Element.g;k.attributes.transform=new f.Property("transform",this.attribute("gradientTransform").value),k.children=[j];var l=new f.Element.svg;l.attributes.x=new f.Property("x",0),l.attributes.y=new f.Property("y",0),l.attributes.width=new f.Property("width",i.width),l.attributes.height=new f.Property("height",i.height),l.children=[k];var m=document.createElement("canvas");m.width=i.width,m.height=i.height;var n=m.getContext("2d");return n.fillStyle=g,l.render(n),n.createPattern(m,"no-repeat")}return g}},f.Element.GradientBase.prototype=new f.Element.ElementBase,f.Element.linearGradient=function(a){this.base=f.Element.GradientBase,this.base(a),this.attributesToInherit.push("x1"),this.attributesToInherit.push("y1"),this.attributesToInherit.push("x2"),this.attributesToInherit.push("y2"),this.getGradient=function(a,b){var c="objectBoundingBox"==this.gradientUnits()?b.getBoundingBox():null;this.attribute("x1").hasValue()||this.attribute("y1").hasValue()||this.attribute("x2").hasValue()||this.attribute("y2").hasValue()||(this.attribute("x1",!0).value=0,this.attribute("y1",!0).value=0,this.attribute("x2",!0).value=1,this.attribute("y2",!0).value=0);var d="objectBoundingBox"==this.gradientUnits()?c.x()+c.width()*this.attribute("x1").numValue():this.attribute("x1").toPixels("x"),e="objectBoundingBox"==this.gradientUnits()?c.y()+c.height()*this.attribute("y1").numValue():this.attribute("y1").toPixels("y"),f="objectBoundingBox"==this.gradientUnits()?c.x()+c.width()*this.attribute("x2").numValue():this.attribute("x2").toPixels("x"),g="objectBoundingBox"==this.gradientUnits()?c.y()+c.height()*this.attribute("y2").numValue():this.attribute("y2").toPixels("y");return d==f&&e==g?null:a.createLinearGradient(d,e,f,g)}},f.Element.linearGradient.prototype=new f.Element.GradientBase,f.Element.radialGradient=function(a){this.base=f.Element.GradientBase,this.base(a),this.attributesToInherit.push("cx"),this.attributesToInherit.push("cy"),this.attributesToInherit.push("r"),this.attributesToInherit.push("fx"),this.attributesToInherit.push("fy"),this.getGradient=function(a,b){var c=b.getBoundingBox();this.attribute("cx").hasValue()||(this.attribute("cx",!0).value="50%"),this.attribute("cy").hasValue()||(this.attribute("cy",!0).value="50%"),this.attribute("r").hasValue()||(this.attribute("r",!0).value="50%");var d="objectBoundingBox"==this.gradientUnits()?c.x()+c.width()*this.attribute("cx").numValue():this.attribute("cx").toPixels("x"),e="objectBoundingBox"==this.gradientUnits()?c.y()+c.height()*this.attribute("cy").numValue():this.attribute("cy").toPixels("y"),f=d,g=e;this.attribute("fx").hasValue()&&(f="objectBoundingBox"==this.gradientUnits()?c.x()+c.width()*this.attribute("fx").numValue():this.attribute("fx").toPixels("x")),this.attribute("fy").hasValue()&&(g="objectBoundingBox"==this.gradientUnits()?c.y()+c.height()*this.attribute("fy").numValue():this.attribute("fy").toPixels("y"));var h="objectBoundingBox"==this.gradientUnits()?(c.width()+c.height())/2*this.attribute("r").numValue():this.attribute("r").toPixels();return a.createRadialGradient(f,g,0,d,e,h)}},f.Element.radialGradient.prototype=new f.Element.GradientBase,f.Element.stop=function(a){this.base=f.Element.ElementBase,this.base(a),this.offset=this.attribute("offset").numValue(),this.offset<0&&(this.offset=0),this.offset>1&&(this.offset=1);var b=this.style("stop-color",!0);""===b.value&&(b.value="#000"),this.style("stop-opacity").hasValue()&&(b=b.addOpacity(this.style("stop-opacity"))),this.color=b.value},f.Element.stop.prototype=new f.Element.ElementBase,f.Element.AnimateBase=function(a){this.base=f.Element.ElementBase,this.base(a),f.Animations.push(this),this.duration=0,this.begin=this.attribute("begin").toMilliseconds(),this.maxDuration=this.begin+this.attribute("dur").toMilliseconds(),this.getProperty=function(){var a=this.attribute("attributeType").value,b=this.attribute("attributeName").value;return"CSS"==a?this.parent.style(b,!0):this.parent.attribute(b,!0)},this.initialValue=null,this.initialUnits="",this.removed=!1,this.calcValue=function(){return""},this.update=function(a){if(null==this.initialValue&&(this.initialValue=this.getProperty().value,this.initialUnits=this.getProperty().getUnits()),this.duration>this.maxDuration){if("indefinite"==this.attribute("repeatCount").value||"indefinite"==this.attribute("repeatDur").value)this.duration=0;else if("freeze"!=this.attribute("fill").valueOrDefault("remove")||this.frozen){if("remove"==this.attribute("fill").valueOrDefault("remove")&&!this.removed)return this.removed=!0,this.getProperty().value=this.parent.animationFrozen?this.parent.animationFrozenValue:this.initialValue,!0}else this.frozen=!0,this.parent.animationFrozen=!0,this.parent.animationFrozenValue=this.getProperty().value;return!1}this.duration=this.duration+a;var b=!1;if(this.begin<this.duration){var c=this.calcValue();if(this.attribute("type").hasValue()){c=this.attribute("type").value+"("+c+")"}this.getProperty().value=c,b=!0}return b},this.from=this.attribute("from"),this.to=this.attribute("to"),this.values=this.attribute("values"),this.values.hasValue()&&(this.values.value=this.values.value.split(";")),this.progress=function(){var a={progress:(this.duration-this.begin)/(this.maxDuration-this.begin)};if(this.values.hasValue()){var b=a.progress*(this.values.value.length-1),c=Math.floor(b),d=Math.ceil(b);a.from=new f.Property("from",parseFloat(this.values.value[c])),a.to=new f.Property("to",parseFloat(this.values.value[d])),a.progress=(b-c)/(d-c)}else a.from=this.from,a.to=this.to;return a}},f.Element.AnimateBase.prototype=new f.Element.ElementBase,f.Element.animate=function(a){this.base=f.Element.AnimateBase,this.base(a),this.calcValue=function(){var a=this.progress();return a.from.numValue()+(a.to.numValue()-a.from.numValue())*a.progress+this.initialUnits}},f.Element.animate.prototype=new f.Element.AnimateBase,f.Element.animateColor=function(b){this.base=f.Element.AnimateBase,this.base(b),this.calcValue=function(){var b=this.progress(),c=new a(b.from.value),d=new a(b.to.value);if(c.ok&&d.ok){var e=c.r+(d.r-c.r)*b.progress,f=c.g+(d.g-c.g)*b.progress,g=c.b+(d.b-c.b)*b.progress;return"rgb("+parseInt(e,10)+","+parseInt(f,10)+","+parseInt(g,10)+")"}return this.attribute("from").value}},f.Element.animateColor.prototype=new f.Element.AnimateBase,f.Element.animateTransform=function(a){this.base=f.Element.AnimateBase,this.base(a),this.calcValue=function(){for(var a=this.progress(),b=f.ToNumberArray(a.from.value),c=f.ToNumberArray(a.to.value),d="",e=0;e<b.length;e++)d+=b[e]+(c[e]-b[e])*a.progress+" ";return d}},f.Element.animateTransform.prototype=new f.Element.animate,f.Element.font=function(a){this.base=f.Element.ElementBase,this.base(a),this.horizAdvX=this.attribute("horiz-adv-x").numValue(),this.isRTL=!1,this.isArabic=!1,this.fontFace=null,this.missingGlyph=null,this.glyphs=[];for(var b=0;b<this.children.length;b++){var c=this.children[b];"font-face"==c.type?(this.fontFace=c,c.style("font-family").hasValue()&&(f.Definitions[c.style("font-family").value]=this)):"missing-glyph"==c.type?this.missingGlyph=c:"glyph"==c.type&&(""!=c.arabicForm?(this.isRTL=!0,this.isArabic=!0,void 0===this.glyphs[c.unicode]&&(this.glyphs[c.unicode]=[]),this.glyphs[c.unicode][c.arabicForm]=c):this.glyphs[c.unicode]=c)}},f.Element.font.prototype=new f.Element.ElementBase,f.Element.fontface=function(a){this.base=f.Element.ElementBase,this.base(a),this.ascent=this.attribute("ascent").value,this.descent=this.attribute("descent").value,this.unitsPerEm=this.attribute("units-per-em").numValue()},f.Element.fontface.prototype=new f.Element.ElementBase,f.Element.missingglyph=function(a){this.base=f.Element.path,this.base(a),this.horizAdvX=0},f.Element.missingglyph.prototype=new f.Element.path,f.Element.glyph=function(a){this.base=f.Element.path,this.base(a),this.horizAdvX=this.attribute("horiz-adv-x").numValue(),this.unicode=this.attribute("unicode").value,this.arabicForm=this.attribute("arabic-form").value},f.Element.glyph.prototype=new f.Element.path,f.Element.text=function(a){this.captureTextNodes=!0,this.base=f.Element.RenderedElementBase,this.base(a),this.baseSetContext=this.setContext,this.setContext=function(a){this.baseSetContext(a);var b=this.style("dominant-baseline").toTextBaseline();null==b&&(b=this.style("alignment-baseline").toTextBaseline()),null!=b&&(a.textBaseline=b)},this.getBoundingBox=function(){var a=this.attribute("x").toPixels("x"),b=this.attribute("y").toPixels("y"),c=this.parent.style("font-size").numValueOrDefault(f.Font.Parse(f.ctx.font).fontSize);return new f.BoundingBox(a,b-c,a+Math.floor(2*c/3)*this.children[0].getText().length,b)},this.renderChildren=function(a){this.x=this.attribute("x").toPixels("x"),this.y=this.attribute("y").toPixels("y"),this.attribute("dx").hasValue()&&(this.x+=this.attribute("dx").toPixels("x")),this.attribute("dy").hasValue()&&(this.y+=this.attribute("dy").toPixels("y")),this.x+=this.getAnchorDelta(a,this,0);for(var b=0;b<this.children.length;b++)this.renderChild(a,this,this,b)},this.getAnchorDelta=function(a,b,c){var d=this.style("text-anchor").valueOrDefault("start");if("start"!=d){for(var e=0,f=c;f<b.children.length;f++){var g=b.children[f];if(f>c&&g.attribute("x").hasValue())break;e+=g.measureTextRecursive(a)}return-1*("end"==d?e:e/2)}return 0},this.renderChild=function(a,b,c,d){var e=c.children[d];e.attribute("x").hasValue()?(e.x=e.attribute("x").toPixels("x")+b.getAnchorDelta(a,c,d),e.attribute("dx").hasValue()&&(e.x+=e.attribute("dx").toPixels("x"))):(e.attribute("dx").hasValue()&&(b.x+=e.attribute("dx").toPixels("x")),e.x=b.x),b.x=e.x+e.measureText(a),e.attribute("y").hasValue()?(e.y=e.attribute("y").toPixels("y"),e.attribute("dy").hasValue()&&(e.y+=e.attribute("dy").toPixels("y"))):(e.attribute("dy").hasValue()&&(b.y+=e.attribute("dy").toPixels("y")),e.y=b.y),b.y=e.y,e.render(a);for(var d=0;d<e.children.length;d++)b.renderChild(a,b,e,d)}},f.Element.text.prototype=new f.Element.RenderedElementBase,f.Element.TextElementBase=function(a){this.base=f.Element.RenderedElementBase,this.base(a),this.getGlyph=function(a,b,c){var d=b[c],e=null;if(a.isArabic){var f="isolated";(0==c||" "==b[c-1])&&c<b.length-2&&" "!=b[c+1]&&(f="terminal"),c>0&&" "!=b[c-1]&&c<b.length-2&&" "!=b[c+1]&&(f="medial"),c>0&&" "!=b[c-1]&&(c==b.length-1||" "==b[c+1])&&(f="initial"),void 0!==a.glyphs[d]&&null==(e=a.glyphs[d][f])&&"glyph"==a.glyphs[d].type&&(e=a.glyphs[d])}else e=a.glyphs[d];return null==e&&(e=a.missingGlyph),e},this.renderChildren=function(a){var b=this.parent.style("font-family").getDefinition();if(null==b)""!=a.fillStyle&&a.fillText(this.getText(),this.x,this.y),""!=a.strokeStyle&&a.strokeText(this.getText(),this.x,this.y);else{var c=this.parent.style("font-size").numValueOrDefault(f.Font.Parse(f.ctx.font).fontSize),d=this.parent.style("font-style").valueOrDefault(f.Font.Parse(f.ctx.font).fontStyle),e=this.getText();b.isRTL&&(e=e.split("").reverse().join(""));for(var g=f.ToNumberArray(this.parent.attribute("dx").value),h=0;h<e.length;h++){var i=this.getGlyph(b,e,h),j=c/b.fontFace.unitsPerEm;a.translate(this.x,this.y),a.scale(j,-j);var k=a.lineWidth;a.lineWidth=a.lineWidth*b.fontFace.unitsPerEm/c,"italic"==d&&a.transform(1,0,.4,1,0,0),i.render(a),"italic"==d&&a.transform(1,0,-.4,1,0,0),a.lineWidth=k,a.scale(1/j,-1/j),a.translate(-this.x,-this.y),this.x+=c*(i.horizAdvX||b.horizAdvX)/b.fontFace.unitsPerEm,void 0===g[h]||isNaN(g[h])||(this.x+=g[h])}}},this.getText=function(){},this.measureTextRecursive=function(a){for(var b=this.measureText(a),c=0;c<this.children.length;c++)b+=this.children[c].measureTextRecursive(a);return b},this.measureText=function(a){var b=this.parent.style("font-family").getDefinition();if(null!=b){var c=this.parent.style("font-size").numValueOrDefault(f.Font.Parse(f.ctx.font).fontSize),d=0,e=this.getText();b.isRTL&&(e=e.split("").reverse().join(""));for(var g=f.ToNumberArray(this.parent.attribute("dx").value),h=0;h<e.length;h++){d+=(this.getGlyph(b,e,h).horizAdvX||b.horizAdvX)*c/b.fontFace.unitsPerEm,void 0===g[h]||isNaN(g[h])||(d+=g[h])}return d}var i=this.getText();if(!a.measureText)return 10*i.length;a.save(),this.setContext(a);var j=a.measureText(i).width;return a.restore(),j}},f.Element.TextElementBase.prototype=new f.Element.RenderedElementBase,f.Element.tspan=function(a){this.captureTextNodes=!0,this.base=f.Element.TextElementBase,this.base(a),this.text=a.value||a.text||a.textContent||"",this.getText=function(){return this.children.length>0?"":this.text}},f.Element.tspan.prototype=new f.Element.TextElementBase,f.Element.tref=function(a){this.base=f.Element.TextElementBase,this.base(a),this.getText=function(){var a=this.getHrefAttribute().getDefinition();if(null!=a)return a.children[0].getText()}},f.Element.tref.prototype=new f.Element.TextElementBase,f.Element.a=function(a){this.base=f.Element.TextElementBase,this.base(a),this.hasText=a.childNodes.length>0;for(var b=0;b<a.childNodes.length;b++)3!=a.childNodes[b].nodeType&&(this.hasText=!1);this.text=this.hasText?a.childNodes[0].value:"",this.getText=function(){return this.text},this.baseRenderChildren=this.renderChildren,this.renderChildren=function(a){if(this.hasText){this.baseRenderChildren(a);var b=new f.Property("fontSize",f.Font.Parse(f.ctx.font).fontSize);f.Mouse.checkBoundingBox(this,new f.BoundingBox(this.x,this.y-b.toPixels("y"),this.x+this.measureText(a),this.y))}else if(this.children.length>0){var c=new f.Element.g;c.children=this.children,c.parent=this,c.render(a)}},this.onclick=function(){window.open(this.getHrefAttribute().value)},this.onmousemove=function(){f.ctx.canvas.style.cursor="pointer"}},f.Element.a.prototype=new f.Element.TextElementBase,f.Element.image=function(a){this.base=f.Element.RenderedElementBase,this.base(a);var b=this.getHrefAttribute().value;if(""!=b){var c=b.match(/\.svg$/);if(f.Images.push(this),this.loaded=!1,c)this.img=f.ajax(b),this.loaded=!0;else{this.img=document.createElement("img"),1==f.opts.useCORS&&(this.img.crossOrigin="Anonymous");var d=this;this.img.onload=function(){d.loaded=!0},this.img.onerror=function(){f.log('ERROR: image "'+b+'" not found'),d.loaded=!0},this.img.src=b}this.renderChildren=function(a){var b=this.attribute("x").toPixels("x"),d=this.attribute("y").toPixels("y"),e=this.attribute("width").toPixels("x"),g=this.attribute("height").toPixels("y");0!=e&&0!=g&&(a.save(),c?a.drawSvg(this.img,b,d,e,g):(a.translate(b,d),f.AspectRatio(a,this.attribute("preserveAspectRatio").value,e,this.img.width,g,this.img.height,0,0),a.drawImage(this.img,0,0)),a.restore())},this.getBoundingBox=function(){var a=this.attribute("x").toPixels("x"),b=this.attribute("y").toPixels("y"),c=this.attribute("width").toPixels("x"),d=this.attribute("height").toPixels("y");return new f.BoundingBox(a,b,a+c,b+d)}}},f.Element.image.prototype=new f.Element.RenderedElementBase,f.Element.g=function(a){this.base=f.Element.RenderedElementBase,this.base(a),this.getBoundingBox=function(){for(var a=new f.BoundingBox,b=0;b<this.children.length;b++)a.addBoundingBox(this.children[b].getBoundingBox());return a}},f.Element.g.prototype=new f.Element.RenderedElementBase,f.Element.symbol=function(a){this.base=f.Element.RenderedElementBase,this.base(a),this.render=function(a){}},f.Element.symbol.prototype=new f.Element.RenderedElementBase,f.Element.style=function(a){this.base=f.Element.ElementBase,this.base(a);for(var b="",d=0;d<a.childNodes.length;d++)b+=a.childNodes[d].data;b=b.replace(/(\/\*([^*]|[\r\n]|(\*+([^*\/]|[\r\n])))*\*+\/)|(^[\s]*\/\/.*)/gm,""),b=f.compressSpaces(b);for(var e=b.split("}"),d=0;d<e.length;d++)if(""!=f.trim(e[d]))for(var g=e[d].split("{"),h=g[0].split(","),i=g[1].split(";"),j=0;j<h.length;j++){var k=f.trim(h[j]);if(""!=k){for(var l=f.Styles[k]||{},m=0;m<i.length;m++){var n=i[m].indexOf(":"),o=i[m].substr(0,n),p=i[m].substr(n+1,i[m].length-n);null!=o&&null!=p&&(l[f.trim(o)]=new f.Property(f.trim(o),f.trim(p)))}if(f.Styles[k]=l,f.StylesSpecificity[k]=c(k),"@font-face"==k)for(var q=l["font-family"].value.replace(/"/g,""),r=l.src.value.split(","),s=0;s<r.length;s++)if(r[s].indexOf('format("svg")')>0)for(var t=r[s].indexOf("url"),u=r[s].indexOf(")",t),v=r[s].substr(t+5,u-t-6),w=f.parseXml(f.ajax(v)),x=w.getElementsByTagName("font"),y=0;y<x.length;y++){var z=f.CreateElement(x[y]);f.Definitions[q]=z}}}},f.Element.style.prototype=new f.Element.ElementBase,f.Element.use=function(a){this.base=f.Element.RenderedElementBase,this.base(a),this.baseSetContext=this.setContext,this.setContext=function(a){this.baseSetContext(a),this.attribute("x").hasValue()&&a.translate(this.attribute("x").toPixels("x"),0),this.attribute("y").hasValue()&&a.translate(0,this.attribute("y").toPixels("y"))};var b=this.getHrefAttribute().getDefinition();this.path=function(a){null!=b&&b.path(a)},this.getBoundingBox=function(){if(null!=b)return b.getBoundingBox()},this.renderChildren=function(a){if(null!=b){var c=b;"symbol"==b.type&&(c=new f.Element.svg,c.type="svg",c.attributes.viewBox=new f.Property("viewBox",b.attribute("viewBox").value),c.attributes.preserveAspectRatio=new f.Property("preserveAspectRatio",b.attribute("preserveAspectRatio").value),c.attributes.overflow=new f.Property("overflow",b.attribute("overflow").value),c.children=b.children),"svg"==c.type&&(this.attribute("width").hasValue()&&(c.attributes.width=new f.Property("width",this.attribute("width").value)),this.attribute("height").hasValue()&&(c.attributes.height=new f.Property("height",this.attribute("height").value)));var d=c.parent;c.parent=null,c.render(a),c.parent=d}}},f.Element.use.prototype=new f.Element.RenderedElementBase,f.Element.mask=function(a){this.base=f.Element.ElementBase,this.base(a),this.apply=function(a,b){var c=this.attribute("x").toPixels("x"),d=this.attribute("y").toPixels("y"),e=this.attribute("width").toPixels("x"),g=this.attribute("height").toPixels("y");if(0==e&&0==g){for(var h=new f.BoundingBox,i=0;i<this.children.length;i++)h.addBoundingBox(this.children[i].getBoundingBox());var c=Math.floor(h.x1),d=Math.floor(h.y1),e=Math.floor(h.width()),g=Math.floor(h.height())}var j=b.attribute("mask").value;b.attribute("mask").value="";var k=document.createElement("canvas");k.width=c+e,k.height=d+g;var l=k.getContext("2d");this.renderChildren(l);var m=document.createElement("canvas");m.width=c+e,m.height=d+g;var n=m.getContext("2d");b.render(n),n.globalCompositeOperation="destination-in",n.fillStyle=l.createPattern(k,"no-repeat"),n.fillRect(0,0,c+e,d+g),a.fillStyle=n.createPattern(m,"no-repeat"),a.fillRect(0,0,c+e,d+g),b.attribute("mask").value=j},this.render=function(a){}},f.Element.mask.prototype=new f.Element.ElementBase,f.Element.clipPath=function(a){this.base=f.Element.ElementBase,this.base(a),this.apply=function(a){var b=CanvasRenderingContext2D.prototype.beginPath;CanvasRenderingContext2D.prototype.beginPath=function(){};var c=CanvasRenderingContext2D.prototype.closePath;CanvasRenderingContext2D.prototype.closePath=function(){},b.call(a);for(var d=0;d<this.children.length;d++){var e=this.children[d];if(void 0!==e.path){var g=null;e.style("transform",!1,!0).hasValue()&&(g=new f.Transform(e.style("transform",!1,!0).value),g.apply(a)),e.path(a),CanvasRenderingContext2D.prototype.closePath=c,g&&g.unapply(a)}}c.call(a),a.clip(),CanvasRenderingContext2D.prototype.beginPath=b,CanvasRenderingContext2D.prototype.closePath=c},this.render=function(a){}},f.Element.clipPath.prototype=new f.Element.ElementBase,f.Element.filter=function(a){this.base=f.Element.ElementBase,this.base(a),this.apply=function(a,b){var c=b.getBoundingBox(),d=Math.floor(c.x1),e=Math.floor(c.y1),f=Math.floor(c.width()),g=Math.floor(c.height()),h=b.style("filter").value;b.style("filter").value="";for(var i=0,j=0,k=0;k<this.children.length;k++){var l=this.children[k].extraFilterDistance||0;i=Math.max(i,l),j=Math.max(j,l)}var m=document.createElement("canvas");m.width=f+2*i,m.height=g+2*j;var n=m.getContext("2d");n.translate(-d+i,-e+j),b.render(n);for(var k=0;k<this.children.length;k++)"function"==typeof this.children[k].apply&&this.children[k].apply(n,0,0,f+2*i,g+2*j);a.drawImage(m,0,0,f+2*i,g+2*j,d-i,e-j,f+2*i,g+2*j),b.style("filter",!0).value=h},this.render=function(a){}},f.Element.filter.prototype=new f.Element.ElementBase,f.Element.feMorphology=function(a){this.base=f.Element.ElementBase,this.base(a),this.apply=function(a,b,c,d,e){}},f.Element.feMorphology.prototype=new f.Element.ElementBase,f.Element.feComposite=function(a){this.base=f.Element.ElementBase,this.base(a),this.apply=function(a,b,c,d,e){}},f.Element.feComposite.prototype=new f.Element.ElementBase,f.Element.feColorMatrix=function(a){function b(a,b,c,d,e,f){return a[c*d*4+4*b+f]}function c(a,b,c,d,e,f,g){a[c*d*4+4*b+f]=g}function d(a,b){var c=e[a];return c*(c<0?b-255:b)}this.base=f.Element.ElementBase,this.base(a);var e=f.ToNumberArray(this.attribute("values").value);switch(this.attribute("type").valueOrDefault("matrix")){case"saturate":var g=e[0];e=[.213+.787*g,.715-.715*g,.072-.072*g,0,0,.213-.213*g,.715+.285*g,.072-.072*g,0,0,.213-.213*g,.715-.715*g,.072+.928*g,0,0,0,0,0,1,0,0,0,0,0,1];break;case"hueRotate":var h=e[0]*Math.PI/180,i=function(a,b,c){return a+Math.cos(h)*b+Math.sin(h)*c};e=[i(.213,.787,-.213),i(.715,-.715,-.715),i(.072,-.072,.928),0,0,i(.213,-.213,.143),i(.715,.285,.14),i(.072,-.072,-.283),0,0,i(.213,-.213,-.787),i(.715,-.715,.715),i(.072,.928,.072),0,0,0,0,0,1,0,0,0,0,0,1];break;case"luminanceToAlpha":e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.2125,.7154,.0721,0,0,0,0,0,0,1]}this.apply=function(a,e,f,g,h){for(var i=a.getImageData(0,0,g,h),f=0;f<h;f++)for(var e=0;e<g;e++){var j=b(i.data,e,f,g,h,0),k=b(i.data,e,f,g,h,1),l=b(i.data,e,f,g,h,2),m=b(i.data,e,f,g,h,3);c(i.data,e,f,g,h,0,d(0,j)+d(1,k)+d(2,l)+d(3,m)+d(4,1)),c(i.data,e,f,g,h,1,d(5,j)+d(6,k)+d(7,l)+d(8,m)+d(9,1)),c(i.data,e,f,g,h,2,d(10,j)+d(11,k)+d(12,l)+d(13,m)+d(14,1)),c(i.data,e,f,g,h,3,d(15,j)+d(16,k)+d(17,l)+d(18,m)+d(19,1))}a.clearRect(0,0,g,h),a.putImageData(i,0,0)}},f.Element.feColorMatrix.prototype=new f.Element.ElementBase,f.Element.feGaussianBlur=function(a){this.base=f.Element.ElementBase,this.base(a),this.blurRadius=Math.floor(this.attribute("stdDeviation").numValue()),this.extraFilterDistance=this.blurRadius,this.apply=function(a,c,d,e,g){if(void 0===b.canvasRGBA)return void f.log("ERROR: StackBlur.js must be included for blur to work");a.canvas.id=f.UniqueId(),a.canvas.style.display="none",document.body.appendChild(a.canvas),b.canvasRGBA(a.canvas.id,c,d,e,g,this.blurRadius),document.body.removeChild(a.canvas)}},f.Element.feGaussianBlur.prototype=new f.Element.ElementBase,f.Element.title=function(a){},f.Element.title.prototype=new f.Element.ElementBase,f.Element.desc=function(a){},f.Element.desc.prototype=new f.Element.ElementBase,f.Element.MISSING=function(a){f.log("ERROR: Element '"+a.nodeName+"' not yet implemented.")},f.Element.MISSING.prototype=new f.Element.ElementBase,f.CreateElement=function(a){var b=a.nodeName.replace(/^[^:]+:/,"");b=b.replace(/\-/g,"");var c=null;return c=void 0!==f.Element[b]?new f.Element[b](a):new f.Element.MISSING(a),c.type=a.nodeName,c},f.load=function(a,b){f.loadXml(a,f.ajax(b))},f.loadXml=function(a,b){f.loadXmlDoc(a,f.parseXml(b))},f.loadXmlDoc=function(a,b){f.init(a);var c=function(b){for(var c=a.canvas;c;)b.x-=c.offsetLeft,b.y-=c.offsetTop,c=c.offsetParent;return window.scrollX&&(b.x+=window.scrollX),window.scrollY&&(b.y+=window.scrollY),b};1!=f.opts.ignoreMouse&&(a.canvas.onclick=function(a){var b=c(new f.Point(null!=a?a.clientX:event.clientX,null!=a?a.clientY:event.clientY));f.Mouse.onclick(b.x,b.y)},a.canvas.onmousemove=function(a){var b=c(new f.Point(null!=a?a.clientX:event.clientX,null!=a?a.clientY:event.clientY));f.Mouse.onmousemove(b.x,b.y)});var d=f.CreateElement(b.documentElement);d.root=!0,d.addStylesFromStyleDefinition();var e=!0,g=function(){f.ViewPort.Clear(),a.canvas.parentNode&&f.ViewPort.SetCurrent(a.canvas.parentNode.clientWidth,a.canvas.parentNode.clientHeight),1!=f.opts.ignoreDimensions&&(d.style("width").hasValue()&&(a.canvas.width=d.style("width").toPixels("x"),a.canvas.style.width=a.canvas.width+"px"),d.style("height").hasValue()&&(a.canvas.height=d.style("height").toPixels("y"),a.canvas.style.height=a.canvas.height+"px"));var c=a.canvas.clientWidth||a.canvas.width,g=a.canvas.clientHeight||a.canvas.height;if(1==f.opts.ignoreDimensions&&d.style("width").hasValue()&&d.style("height").hasValue()&&(c=d.style("width").toPixels("x"),g=d.style("height").toPixels("y")),f.ViewPort.SetCurrent(c,g),null!=f.opts.offsetX&&(d.attribute("x",!0).value=f.opts.offsetX),null!=f.opts.offsetY&&(d.attribute("y",!0).value=f.opts.offsetY),null!=f.opts.scaleWidth||null!=f.opts.scaleHeight){var h=null,i=null,j=f.ToNumberArray(d.attribute("viewBox").value);null!=f.opts.scaleWidth&&(d.attribute("width").hasValue()?h=d.attribute("width").toPixels("x")/f.opts.scaleWidth:isNaN(j[2])||(h=j[2]/f.opts.scaleWidth)),null!=f.opts.scaleHeight&&(d.attribute("height").hasValue()?i=d.attribute("height").toPixels("y")/f.opts.scaleHeight:isNaN(j[3])||(i=j[3]/f.opts.scaleHeight)),null==h&&(h=i),null==i&&(i=h),d.attribute("width",!0).value=f.opts.scaleWidth,d.attribute("height",!0).value=f.opts.scaleHeight,d.style("transform",!0,!0).value+=" scale("+1/h+","+1/i+")"}1!=f.opts.ignoreClear&&a.clearRect(0,0,c,g),d.render(a),e&&(e=!1,"function"==typeof f.opts.renderCallback&&f.opts.renderCallback(b))},h=!0;f.ImagesLoaded()&&(h=!1,g()),f.intervalID=setInterval(function(){var a=!1;if(h&&f.ImagesLoaded()&&(h=!1,a=!0),1!=f.opts.ignoreMouse&&(a|=f.Mouse.hasEvents()),1!=f.opts.ignoreAnimation)for(var b=0;b<f.Animations.length;b++)a|=f.Animations[b].update(1e3/f.FRAMERATE);"function"==typeof f.opts.forceRedraw&&1==f.opts.forceRedraw()&&(a=!0),a&&(g(),f.Mouse.runEvents())},1e3/f.FRAMERATE)},f.stop=function(){f.intervalID&&clearInterval(f.intervalID)},f.Mouse=new function(){this.events=[],this.hasEvents=function(){return 0!=this.events.length},this.onclick=function(a,b){this.events.push({type:"onclick",x:a,y:b,run:function(a){
a.onclick&&a.onclick()}})},this.onmousemove=function(a,b){this.events.push({type:"onmousemove",x:a,y:b,run:function(a){a.onmousemove&&a.onmousemove()}})},this.eventElements=[],this.checkPath=function(a,b){for(var c=0;c<this.events.length;c++){var d=this.events[c];b.isPointInPath&&b.isPointInPath(d.x,d.y)&&(this.eventElements[c]=a)}},this.checkBoundingBox=function(a,b){for(var c=0;c<this.events.length;c++){var d=this.events[c];b.isPointInBox(d.x,d.y)&&(this.eventElements[c]=a)}},this.runEvents=function(){f.ctx.canvas.style.cursor="";for(var a=0;a<this.events.length;a++)for(var b=this.events[a],c=this.eventElements[a];c;)b.run(c),c=c.parent;this.events=[],this.eventElements=[]}},f}var e,f=function n(a,b,c){if(null!=a||null!=b||null!=c){"string"==typeof a&&(a=document.getElementById(a)),null!=a.svg&&a.svg.stop();var e=d(c||{});1==a.childNodes.length&&"OBJECT"==a.childNodes[0].nodeName||(a.svg=e);var f=a.getContext("2d");void 0!==b.documentElement?e.loadXmlDoc(f,b):"<"==b.substr(0,1)?e.loadXml(f,b):e.load(f,b)}else for(var g=document.querySelectorAll("svg"),h=0;h<g.length;h++){var i=g[h],j=document.createElement("canvas");j.width=i.clientWidth,j.height=i.clientHeight,i.parentNode.insertBefore(j,i),i.parentNode.removeChild(i);var k=document.createElement("div");k.appendChild(i),n(j,k.innerHTML)}};void 0!==Element.prototype.matches?e=function(a,b){return a.matches(b)}:void 0!==Element.prototype.webkitMatchesSelector?e=function(a,b){return a.webkitMatchesSelector(b)}:void 0!==Element.prototype.mozMatchesSelector?e=function(a,b){return a.mozMatchesSelector(b)}:void 0!==Element.prototype.msMatchesSelector?e=function(a,b){return a.msMatchesSelector(b)}:void 0!==Element.prototype.oMatchesSelector?e=function(a,b){return a.oMatchesSelector(b)}:("function"!=typeof jQuery&&"function"!=typeof Zepto||(e=function(a,b){return $(a).is(b)}),void 0===e&&(e=Sizzle.matchesSelector));var g=/(\[[^\]]+\])/g,h=/(#[^\s\+>~\.\[:]+)/g,i=/(\.[^\s\+>~\.\[:]+)/g,j=/(::[^\s\+>~\.\[:]+|:first-line|:first-letter|:before|:after)/gi,k=/(:[\w-]+\([^\)]*\))/gi,l=/(:[^\s\+>~\.\[:]+)/g,m=/([^\s\+>~\.\[:]+)/g;return"undefined"!=typeof CanvasRenderingContext2D&&(CanvasRenderingContext2D.prototype.drawSvg=function(a,b,c,d,e,g){var h={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,ignoreClear:!0,offsetX:b,offsetY:c,scaleWidth:d,scaleHeight:e};for(var i in g)g.hasOwnProperty(i)&&(h[i]=g[i]);f(this.canvas,a,h)}),f})},function(a,b,c){"use strict";var d;!function(e){function f(a){this.ok=!1,"#"==a.charAt(0)&&(a=a.substr(1,6)),a=a.replace(/ /g,""),a=a.toLowerCase();var b={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};for(var c in b)a==c&&(a=b[c]);for(var d=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(a){return[parseInt(a[1]),parseInt(a[2]),parseInt(a[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)]}}],e=0;e<d.length;e++){var g,h=d[e].re,i=d[e].process,j=h.exec(a);j&&(g=i(j),this.r=g[0],this.g=g[1],this.b=g[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var a=this.r.toString(16),b=this.g.toString(16),c=this.b.toString(16);return 1==a.length&&(a="0"+a),1==b.length&&(b="0"+b),1==c.length&&(c="0"+c),"#"+a+b+c},this.getHelpXML=function(){for(var a=new Array,c=0;c<d.length;c++)for(var e=d[c].example,g=0;g<e.length;g++)a[a.length]=e[g];for(var h in b)a[a.length]=h;var i=document.createElement("ul");i.setAttribute("id","rgbcolor-examples");for(var c=0;c<a.length;c++)try{var j=document.createElement("li"),k=new f(a[c]),l=document.createElement("div");l.style.cssText="margin: 3px; border: 1px solid black; background:"+k.toHex()+"; color:"+k.toHex(),l.appendChild(document.createTextNode("test"));var m=document.createTextNode(" "+a[c]+" -> "+k.toRGB()+" -> "+k.toHex());j.appendChild(l),j.appendChild(m),i.appendChild(j)}catch(n){}return i}}void 0!==(d=function(){return f}.call(b,c,b,a))&&(a.exports=d),e.RGBColor=f}("undefined"!=typeof window?window:void 0)},function(a,b,c){"use strict";var d;!function(e){function f(a){for(var b=a.data,c=a.width*a.height*4,d=0;d<c;d+=4){var e=b[d+3]/255;b[d]*=e,b[d+1]*=e,b[d+2]*=e}}function g(a){for(var b=a.data,c=a.width*a.height*4,d=0;d<c;d+=4){var e=b[d+3];0!=e&&(e=255/e,b[d]*=e,b[d+1]*=e,b[d+2]*=e)}}function h(a,b,c,d){var e=document.getElementById(a),f=e.naturalWidth,g=e.naturalHeight,h=document.getElementById(b);h.style.width=f+"px",h.style.height=g+"px",h.width=f,h.height=g;var k=h.getContext("2d");k.clearRect(0,0,f,g),k.drawImage(e,0,0),isNaN(c)||c<1||(d?i(b,0,0,f,g,c):j(b,0,0,f,g,c))}function i(a,b,c,d,e,h){if(!(isNaN(h)||h<1)){h|=0;var i,j=document.getElementById(a),n=j.getContext("2d");try{try{i=n.getImageData(b,c,d,e)}catch(o){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead"),i=n.getImageData(b,c,d,e)}catch(o){throw void 0,new Error("unable to access local image data: "+o)}}}catch(o){throw void 0,new Error("unable to access image data: "+o)}f(i);var p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N=i.data,O=h+h+1,P=d-1,Q=e-1,R=h+1,S=R*(R+1)/2,T=new k,U=T;for(r=1;r<O;r++)if(U=U.next=new k,r==R)var V=U;U.next=T;var W=null,X=null;v=u=0;var Y=l[h],Z=m[h];for(q=0;q<e;q++){for(E=F=G=H=w=x=y=z=0,A=R*(I=N[u]),B=R*(J=N[u+1]),C=R*(K=N[u+2]),D=R*(L=N[u+3]),w+=S*I,x+=S*J,y+=S*K,z+=S*L,U=T,r=0;r<R;r++)U.r=I,U.g=J,U.b=K,U.a=L,U=U.next;for(r=1;r<R;r++)s=u+((P<r?P:r)<<2),w+=(U.r=I=N[s])*(M=R-r),x+=(U.g=J=N[s+1])*M,y+=(U.b=K=N[s+2])*M,z+=(U.a=L=N[s+3])*M,E+=I,F+=J,G+=K,H+=L,U=U.next;for(W=T,X=V,p=0;p<d;p++)N[u]=w*Y>>Z,N[u+1]=x*Y>>Z,N[u+2]=y*Y>>Z,N[u+3]=z*Y>>Z,w-=A,x-=B,y-=C,z-=D,A-=W.r,B-=W.g,C-=W.b,D-=W.a,s=v+((s=p+h+1)<P?s:P)<<2,E+=W.r=N[s],F+=W.g=N[s+1],G+=W.b=N[s+2],H+=W.a=N[s+3],w+=E,x+=F,y+=G,z+=H,W=W.next,A+=I=X.r,B+=J=X.g,C+=K=X.b,D+=L=X.a,E-=I,F-=J,G-=K,H-=L,X=X.next,u+=4;v+=d}for(p=0;p<d;p++){for(F=G=H=E=x=y=z=w=0,u=p<<2,A=R*(I=N[u]),B=R*(J=N[u+1]),C=R*(K=N[u+2]),D=R*(L=N[u+3]),w+=S*I,x+=S*J,y+=S*K,z+=S*L,U=T,r=0;r<R;r++)U.r=I,U.g=J,U.b=K,U.a=L,U=U.next;for(t=d,r=1;r<=h;r++)u=t+p<<2,w+=(U.r=I=N[u])*(M=R-r),x+=(U.g=J=N[u+1])*M,y+=(U.b=K=N[u+2])*M,z+=(U.a=L=N[u+3])*M,E+=I,F+=J,G+=K,H+=L,U=U.next,r<Q&&(t+=d);for(u=p,W=T,X=V,q=0;q<e;q++)s=u<<2,N[s]=w*Y>>Z,N[s+1]=x*Y>>Z,N[s+2]=y*Y>>Z,N[s+3]=z*Y>>Z,w-=A,x-=B,y-=C,z-=D,A-=W.r,B-=W.g,C-=W.b,D-=W.a,s=p+((s=q+R)<Q?s:Q)*d<<2,w+=E+=W.r=N[s],x+=F+=W.g=N[s+1],y+=G+=W.b=N[s+2],z+=H+=W.a=N[s+3],W=W.next,A+=I=X.r,B+=J=X.g,C+=K=X.b,D+=L=X.a,E-=I,F-=J,G-=K,H-=L,X=X.next,u+=d}g(i),n.putImageData(i,b,c)}}function j(a,b,c,d,e,f){if(!(isNaN(f)||f<1)){f|=0;var g,h=document.getElementById(a),i=h.getContext("2d");try{try{g=i.getImageData(b,c,d,e)}catch(j){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead"),g=i.getImageData(b,c,d,e)}catch(j){throw void 0,new Error("unable to access local image data: "+j)}}}catch(j){throw void 0,new Error("unable to access image data: "+j)}var n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H=g.data,I=f+f+1,J=d-1,K=e-1,L=f+1,M=L*(L+1)/2,N=new k,O=N;for(p=1;p<I;p++)if(O=O.next=new k,p==L)var P=O;O.next=N;var Q=null,R=null;t=s=0;var S=l[f],T=m[f];for(o=0;o<e;o++){for(A=B=C=u=v=w=0,x=L*(D=H[s]),y=L*(E=H[s+1]),z=L*(F=H[s+2]),u+=M*D,v+=M*E,w+=M*F,O=N,p=0;p<L;p++)O.r=D,O.g=E,O.b=F,O=O.next;for(p=1;p<L;p++)q=s+((J<p?J:p)<<2),u+=(O.r=D=H[q])*(G=L-p),v+=(O.g=E=H[q+1])*G,w+=(O.b=F=H[q+2])*G,A+=D,B+=E,C+=F,O=O.next;for(Q=N,R=P,n=0;n<d;n++)H[s]=u*S>>T,H[s+1]=v*S>>T,H[s+2]=w*S>>T,u-=x,v-=y,w-=z,x-=Q.r,y-=Q.g,z-=Q.b,q=t+((q=n+f+1)<J?q:J)<<2,A+=Q.r=H[q],B+=Q.g=H[q+1],C+=Q.b=H[q+2],u+=A,v+=B,w+=C,Q=Q.next,x+=D=R.r,y+=E=R.g,z+=F=R.b,A-=D,B-=E,C-=F,R=R.next,s+=4;t+=d}for(n=0;n<d;n++){for(B=C=A=v=w=u=0,s=n<<2,x=L*(D=H[s]),y=L*(E=H[s+1]),z=L*(F=H[s+2]),u+=M*D,v+=M*E,w+=M*F,O=N,p=0;p<L;p++)O.r=D,O.g=E,O.b=F,O=O.next;for(r=d,p=1;p<=f;p++)s=r+n<<2,u+=(O.r=D=H[s])*(G=L-p),v+=(O.g=E=H[s+1])*G,w+=(O.b=F=H[s+2])*G,A+=D,B+=E,C+=F,O=O.next,p<K&&(r+=d);for(s=n,Q=N,R=P,o=0;o<e;o++)q=s<<2,H[q]=u*S>>T,H[q+1]=v*S>>T,H[q+2]=w*S>>T,u-=x,v-=y,w-=z,x-=Q.r,y-=Q.g,z-=Q.b,q=n+((q=o+L)<K?q:K)*d<<2,u+=A+=Q.r=H[q],v+=B+=Q.g=H[q+1],w+=C+=Q.b=H[q+2],Q=Q.next,x+=D=R.r,y+=E=R.g,z+=F=R.b,A-=D,B-=E,C-=F,R=R.next,s+=d}i.putImageData(g,b,c)}}function k(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}var l=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],m=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24],n={image:h,canvasRGBA:i,canvasRGB:j};void 0!==(d=function(){return n}.call(b,c,b,a))&&(a.exports=d),e.stackBlur=n}("undefined"!=typeof window?window:void 0)},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(2),h=d(g),i=c(1),j=d(i),k=c(3),l=d(k),m=c(23),n=d(m),o=c(74),p=d(o),q=c(52),r=d(q),s=c(73),t=d(s),u=c(31),v=d(u),w=c(56),x=d(w),y=c(32),z=c(17),A=c(10),B=c(177),C=c(136),D=d(C),E=c(137),F={x:0,y:0},G=function(a){function b(c,d,e){(0,f.default)(this,b);var g=(0,h.default)(this,a.call(this,c,d));return g._container=e,g._container.on(x.default.CHANGE_SIZE,g.onContainerChanged,g),g.stage.on(v.default.CLEAR_ALL,g.onClearAll,g),g.stage.on(v.default.BITMAPDATA_UPDATE,g.onUpdateBitmapData,g),g._init(),g}return(0,l.default)(b,a),(0,j.default)(b,null,[{key:"UPDATE_W_TOOLTIP",get:function(){return"update_w_tooltip"}},{key:"UPDATE_H_TOOLTIP",get:function(){return"update_h_tooltip"}},{key:"ADD_W_TOOLTIP",get:function(){return"add_w_tooltip"}},{key:"REMOVE_W_TOOLTIP",get:function(){return"remove_w_tooltip"}},{key:"ADD_H_TOOLTIP",get:function(){return"add_h_tooltip"}},{key:"REMOVE_H_TOOLTIP",get:function(){return"remove_h_tooltip"}},{key:"EXIT_BUTTON_CLICK",get:function(){return"exit_button_click"}},{key:"IMAGE_SIGN_READY",get:function(){return"imageSignReady"}}]),b.prototype.start=function(){a.prototype.start.call(this),this.stage.addChild(this._lineGraphics),this._addEvent(),this.displayObject&&this._addExitButton(),this.screenFit(this.screenFitEnable)},b.prototype.suspend=function(){return this._lineGraphics.parent&&this._lineGraphics.parent.removeChild(this._lineGraphics),this._removeEvent(),this.displayObject&&this._removeExitButton(),a.prototype.suspend.call(this)},b.prototype.dispose=function(){this.stage.off(p.default.BOUNDARY_CHANGE,this.onCropBoundaryChange,this),this.stage.off(v.default.MOUSE_CHILDREN_CHANGE,this.onMouseChildrenChange,this),this.stage.off(v.default.BITMAPDATA_UPDATE,this.onUpdateBitmapData,this),this.stage.off(v.default.CLEAR_ALL,this.onClearAll,this)},b.prototype.screenFit=function(a){if(a)return void this.stage.magnify.autoScale(!0);if(null==this.displayObject)return void this.stage.magnify.autoScale(a);var b=A.TEMP_POINT_A;b.x=this.sprite.x,b.y=this.sprite.y;var c=this._container.toGlobal(b);this.stage.magnify.autoScale(!1,c.x,c.y)},b.prototype.snapshot=function(){if(null==this.displayObject)return{};var a=this._positionType,b=this.sprite,c=this.stage.magnify.border;return{positionType:a,w:this._w,h:this._h,displayObject:this.displayObject,textInfo:this._textInfo,signature:this._getSignatureType(),horizontalAlign:"left",verticalAlign:"top",offsetX:b.x-b.pivot.x+c.left,offsetY:b.y-b.pivot.y+c.right}},b.prototype.getVAlign=function(a){return["top","middle","bottom"][["t","c","b"].indexOf(a)]},b.prototype.getHAlign=function(a){return["left","center","right"][["l","c","r"].indexOf(a)]},b.prototype.getVPosition=function(a,b,c){switch(a){case"t":return b+.5+c.top|0;case"c":return 0;case"b":return b+.5+c.bottom|0}},b.prototype.getHPosition=function(a,b,c){switch(a){case"l":return b+.5+c.left|0;case"c":return 0;case"r":return b+.5+c.right|0}},b.prototype.reset=function(b){var c=arguments.length>1&&void 0!==arguments[1]&&arguments[1];null!=b&&b.hasOwnProperty("displayObject")?(this._positionType=b.positionType,this._w=b.w,this._h=b.h,this.displayObject=b.displayObject,this._textInfo=b.textInfo):(1==this._isImageChanged&&this._initPosition(),this._initInfo()),this._isImageChanged=!1,a.prototype.reset.call(this,c)},b.prototype.identity=function(){this._isImageChanged=!0},b.prototype.clearDisplayObject=function(){this.displayObject&&(this.sprite.parent&&this.sprite.parent.removeChild(this.sprite),this.sprite.renderableObject=!1,this.sprite.texture=null)},b.prototype.setImageSignature=function(a){var c=this;if(this._textInfo=null,this.img.src=a,this.img.complete){if(this.invalidate(this.img))return void this.emitErrorEvent(this.img.src);this.displayObject=this.img,this.pushHistory()}else this.img.onload=function(){if(c.invalidate(c.img))return void c.emitErrorEvent(c.img.src);c.img.onload=null,c.displayObject=c.img,c.pushHistory(),c.emit(b.IMAGE_SIGN_READY)}},b.prototype.invalidate=function(a){return null==a||0==a.width||0==a.naturalWidth||0==a.height||0==a.naturalHeight},b.prototype.emitErrorEvent=function(a){this.stage.emit(v.default.INVALID_IMAGE_SRC,{target:this,dataURL:a})},b.prototype.setTextSignature=function(a){this._textInfo=a,this.displayObject=this._signText.drawSign(a),this._updatePosition(this.sprite.x,this.sprite.y),this.pushHistory()},b.prototype.alignSignature=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(this._width=this._container.actualWidth,this._height=this._container.actualHeight,null!=this.displayObject){var b=void 0,c=void 0,d=void 0,e=void 0;if(null==a)c={x:0,y:0},d={x:this._width,y:0},e={x:0,y:this._height},b=0,this.sprite.scale.x=this.sprite.scale.y=1;else{this.stage.updateTransform();var f=this._container.worldTransform,g=(0,z.map)(a,function(a){return f.applyInverse(a)}),h=this._container.parent.parent.scale;c=g.lt,d=g.rt,e=g.lb,b=(0,y.getRadian)(c.x,c.y,d.x,d.y),this.sprite.scale.y=h.x*h.y}this._top.setTo(d.x-c.x,d.y-c.y),this._left.setTo(e.x-c.x,e.y-c.y);var i=(this._top.length,this._left.length,this.alignSignatureBetween(c,this._top,this._left,this._positionType,{x:this._w,y:this._h},{x:this.sprite.width/2,y:this.sprite.height/2}));this.sprite.x=i[0],this.sprite.y=i[1],this.sprite.rotation=b}},b.prototype.alignSignatureBetween=function(a,b,c,d,e,f){var g=0,h=0,i=f.x,j=b.length-f.x,k=f.y,l=c.length-f.y;switch(d){case"lt":b.len(Math.min(j,Math.max(f.x,e.x+f.x))).add(c.len(Math.min(l,e.y+f.y)));break;case"lc":b.len(Math.min(j,Math.max(f.x,e.x+f.x))).add(c.scale(.5));break;case"lb":b.len(Math.min(j,Math.max(f.x,e.x+f.x))).add(c.len(Math.min(l,Math.max(k,c.length-e.y-f.y))));break;case"ct":b.scale(.5).add(c.len(Math.min(l,e.y+f.y)));break;case"cc":b.scale(.5).add(c.scale(.5));break;case"cb":b.scale(.5).add(c.len(Math.min(l,Math.max(k,c.length-e.y-f.y))));break;case"rt":b.len(Math.min(j,Math.max(i,b.length-e.x-f.x))).add(c.len(Math.min(l,e.y+f.y)));break;case"rc":b.len(Math.min(j,Math.max(i,b.length-e.x-f.x))).add(c.scale(.5));break;case"rb":b.len(Math.min(j,Math.max(i,b.length-e.x-f.x))).add(c.len(Math.min(l,Math.max(k,c.length-e.y-f.y))));break;default:void 0}return g=a.x+b.x,h=a.y+b.y,[g,h]},b.prototype.exit=function(){this._initInfo()},b.prototype._init=function(){this.sprite=new PIXI.Sprite,this.sprite.renderableObject=!1,this._isDown=!1,this._width=0,this._height=0,this._lineGraphics=new PIXI.Graphics,this._exitButton=new PIXI.Sprite,this._exitButton.interactive=!0,this._exitButton.buttonMode=!0,this._signText=new E(this.stage.options.canvasLimitSize),this._mouseDownHandler=this._onMouseDown.bind(this),this._mouseUpHandler=this._onMouseUp.bind(this),this._mouseMoveHandler=this._onMouseMove.bind(this),this._viewportChangeHandler=this._viewportChange.bind(this),this._exitButtonOverHandler=this._exitButtonOver.bind(this),this._exitButtonOutHandler=this._exitButtonOut.bind(this),this._exitButtonClickHandler=this._exitButtonClick.bind(this),this._exitPoint=new PIXI.Point(0,0),this._wPoint=new PIXI.Point(0,0),this._hPoint=new PIXI.Point(0,0),this._exitPoint.isExist=!1,this._wPoint.isExist=!1,this._hPoint.isExist=!1,this._isImageChanged=!1,this.img=document.createElement("img"),this._exitButtonTexture=null,this._exitButtonOverTexture=null,this._initEvents(),this._initPosition(),this._initInfo(),this._createExitButton(),this._top=new D.default,this._left=new D.default},b.prototype._initEvents=function(){this._wTooltipEvent={x:0,y:0,value:0},this._hTooltipEvent={x:0,y:0,value:0},this.stage.on(p.default.BOUNDARY_CHANGE,this.onCropBoundaryChange,this),this.stage.on(v.default.MOUSE_CHILDREN_CHANGE,this.onMouseChildrenChange,this)},b.prototype._initPosition=function(){this._positionType=this.options.positionType,this._w=this.options.w,this._h=this.options.h},b.prototype._initInfo=function(){this.displayObject=null,this._textInfo=null},b.prototype._setSnapArea=function(){var a=this._width/this.options.snapRangeRatio;return new PIXI.Rectangle(this._width/2-a/2,this._height/2-a/2,a,a)},b.prototype._createExitButton=function(){var a=document.createElement("img"),b=this;a.onload=function(){b._exitButtonTexture=new PIXI.Texture(new PIXI.BaseTexture(a)),b._exitButton.texture=b._exitButtonTexture,b.stage.addChild(b._exitButton),b._exitButton.visible=!1},a.src=this.options.exitBtnImageURL;var c=document.createElement("img");c.onload=function(){b._exitButtonOverTexture=new PIXI.Texture(new PIXI.BaseTexture(c))},c.src=this.options.exitBtnMouseoverImageURL},b.prototype._addEvent=function(){this.sprite.interactive=!0,this.sprite.on("mousedown",this._mouseDownHandler),this.sprite.on("mousemove",this._mouseMoveHandler),this.sprite.off("mousedown",this.onSpriteClick,this),document.addEventListener("mouseup",this._mouseUpHandler),this.stage.on(v.default.VIEWPORT_MOTION_UPDATE,this._viewportChangeHandler),this._exitButton.on("mouseover",this._exitButtonOverHandler),this._exitButton.on("mouseout",this._exitButtonOutHandler),this._exitButton.on("click",this._exitButtonClickHandler),this.stage.magnify.on(t.default.DRAG,this.onImageDrag,this),this.stage.motion.on(r.default.UPDATE,this.onMotionUpdate,this),this.stage.motion.on(r.default.COMPLETE,this.onMotionComplete,this)},b.prototype._removeEvent=function(){this.sprite.on("mousedown",this.onSpriteClick,this),document.removeEventListener("mouseup",this._mouseUpHandler),this.stage.off(v.default.VIEWPORT_MOTION_UPDATE,this._viewportChangeHandler),this._exitButton.off("mouseover",this._exitButtonOverHandler),this._exitButton.off("mouseout",this._exitButtonOutHandler),this._exitButton.off("click",this._exitButtonClickHandler),this.stage.magnify.off(t.default.DRAG,this.onImageDrag,this),this.stage.motion.off(r.default.UPDATE,this.onMotionUpdate,this),this.stage.motion.off(r.default.COMPLETE,this.onMotionComplete,this)},b.prototype._getSignatureType=function(){return this._textInfo&&this._displayObject?"text":this._displayObject?"image":null},b.prototype.onSpriteClick=function(){this._enterMenu=!0,this.stage.emit(v.default.PHASE_CHANGE,{type:v.default.PHASE_CHANGE,phase:"signature"})},b.prototype.onMouseChildrenChange=function(a){this._container&&(this._container.mouseChildren=a.interactive)},b.prototype.onCropBoundaryChange=function(a){this.alignSignature(a.points)},b.prototype._exitButtonClick=function(){this.emit(b.EXIT_BUTTON_CLICK),this.pushHistory()},b.prototype._exitButtonOut=function(){this._exitButton.texture=this._exitButtonTexture},b.prototype._exitButtonOver=function(){this._exitButton.texture=this._exitButtonOverTexture},b.prototype._onMouseDown=function(a){this._isDown=!0,this.sprite.data=a.data;var b=this.sprite.data.getLocalPosition(this._container);this.sprite.dx=b.x-this.sprite.position.x,this.sprite.dy=b.y-this.sprite.position.y,this.stage.magnify.enable=!1,this.stage.stickerContainer.mouseChildren=!1},b.prototype._onMouseUp=function(){0!=this._isDown&&(this._enterMenu=!1,this._isDown=!1,this.sprite.data=null,this._dropSprite(),this._removeWTooltip(),this._removeHTooltip(),this.stage.magnify.enable=!0,this.stage.stickerContainer.mouseChildren=!0,this.pushHistory())},b.prototype._onMouseMove=function(){if(0!=this._isDown){this._enterMenu=!1;var a=this.sprite.data.getLocalPosition(this._container),b=a.x-this.sprite.dx,c=a.y-this.sprite.dy;this._updatePosition(b,c),this._updateInfoByPosition();var d=this._updateLine();this._updateTooltipPosition(d)}},b.prototype.onImageDrag=function(){this._updateExitPosition()},b.prototype.onMotionUpdate=function(){this._isDown&&this._enterMenu,this._updateExitPosition()},b.prototype.onMotionComplete=function(a){this._enterMenu=!1},b.prototype.onClearAll=function(a){this.reset()},b.prototype.onContainerChanged=function(a){this.sprite.rotation=0,this.alignSignature()},b.prototype.onUpdateBitmapData=function(a){this._container&&this.alignSignature()},b.prototype._viewportChange=function(){this._updateExitPosition()},b.prototype._dropSprite=function(){var a=this.sprite.position.x,b=this.sprite.position.y;switch(this._positionType){case"lc":case"rc":b=this._height/2;break;case"ct":case"cb":a=this._width/2;break;case"cc":a=this._width/2,b=this._height/2}this._updatePosition(a,b),this._lineGraphics.clear()},b.prototype._updatePosition=function(a,b){var c=this.sprite.width/2,d=this.sprite.height/2;a<c&&(a=c),a>this._width-c&&(a=this._width-c),b<d&&(b=d),b>this._height-d&&(b=this._height-d),this.sprite.position.x=a,this.sprite.position.y=b,this._updateExitPosition()},b.prototype._checkBoundary=function(a,b,c){var d=this.sprite.width/2,e=this.sprite.height/2;c[0]<d&&(c[0]=d),c[0]>a-d&&(c[0]=a-d),c[1]<e&&(c[1]=e),c[1]>b-e&&(c[1]=b-e)},b.prototype._updateExitPosition=function(){if(null!=this.sprite.texture){this._exitPoint.x=this.sprite.position.x-this.sprite.width/2,this._exitPoint.y=this.sprite.position.y-this.sprite.height/2,this.stage.root.updateTransform();var a=this._container.toGlobal(this._exitPoint);this._exitButton.position.x=a.x,this._exitButton.position.y=a.y-this._exitButton.height}},b.prototype._updateTooltipPosition=function(a){var c=this,d=a.tooltip.map(function(a){return a?(0,B.iterateValues)(c._getGlobalPosition.apply(c,a),"x","y"):a}),e=this.stage.viewport;this._w<0?this._removeWTooltip():this._addWTooltip(),this._h<0?this._removeHTooltip():this._addHTooltip();var f=d[0],g=d[1];f&&(this._wTooltipEvent.x=Math.max(e.x,Math.min(e.x+e.width,f[0])),this._wTooltipEvent.y=Math.max(e.y,Math.min(e.y+e.height,f[1])),this._wTooltipEvent.value=this._w,this.emit(b.UPDATE_W_TOOLTIP,this._wTooltipEvent)),g&&(this._hTooltipEvent.x=Math.max(e.x,Math.min(e.x+e.width,g[0])),this._hTooltipEvent.y=Math.max(e.y,Math.min(e.y+e.height,g[1])),this._hTooltipEvent.value=this._h,this.emit(b.UPDATE_H_TOOLTIP,this._hTooltipEvent))},b.prototype._getPositionType=function(){var a=this._setSnapArea(),b="";b=this.sprite.position.x<a.x?"l":this.sprite.position.x>a.x+a.width?"r":"c";var c="";return c=this.sprite.position.y<a.y?"t":this.sprite.position.y>a.y+a.height?"b":"c",b+c},b.prototype._addExitButton=function(){1!=this._exitPoint.isExist&&(this._exitPoint.isExist=!0,this._exitButton.visible=!0)},b.prototype._removeExitButton=function(){0!=this._exitPoint.isExist&&(this._exitPoint.isExist=!1,this._exitButton.visible=!1)},b.prototype._addWTooltip=function(){1!=this._wPoint.isExist&&(this._wPoint.isExist=!0,this.emit(b.ADD_W_TOOLTIP))},b.prototype._removeWTooltip=function(){0!=this._wPoint.isExist&&(this._wPoint.isExist=!1,this.emit(b.REMOVE_W_TOOLTIP))},b.prototype._addHTooltip=function(){1!=this._hPoint.isExist&&(this._hPoint.isExist=!0,this.emit(b.ADD_H_TOOLTIP))},b.prototype._removeHTooltip=function(){0!=this._hPoint.isExist&&(this._hPoint.isExist=!1,this.emit(b.REMOVE_H_TOOLTIP))},b.prototype._updatePositionByInfo=function(a,b){var c,d,e=this.sprite.width/2,f=this.sprite.height/2;switch(this._positionType){case"lt":c=this._w+e,d=this._h+f;break;case"lc":c=this._w+e,d=b/2;break;case"lb":c=this._w+e,d=b-(this._h+f);break;case"ct":c=a/2,d=this._h+f;break;case"cc":c=a/2,d=b/2;break;case"cb":c=a/2,d=b-(this._h+f);break;case"rt":c=a-(this._w+e),d=this._h+f;break;case"rc":c=a-(this._w+e),d=b/2;break;case"rb":c=a-(this._w+e),d=b-(this._h+f)}return[c,d]},b.prototype._updateInfoByPosition=function(){var a={},b=this.sprite.position,c=this.sprite.width/2,d=this.sprite.height/2;switch(a.type=this._getPositionType(),a.type){case"lt":a.w=b.x-c,a.h=b.y-d;break;case"lc":a.w=b.x-c,a.h=-1;break;case"lb":a.w=b.x-c,a.h=this._height-(b.y+d);break;case"ct":a.w=-1,a.h=b.y-d;break;case"cc":a.w=-1,a.h=-1;break;case"cb":a.w=-1,a.h=this._height-(b.y+d);break;case"rt":a.w=this._width-(b.x+c),a.h=b.y-d;break;case"rc":a.w=this._width-(b.x+c),a.h=-1;break;case"rb":a.w=this._width-(b.x+c),a.h=this._height-(b.y+d)}this._positionType=a.type,this._w=a.w,this._h=a.h},b.prototype.getLocalPointsByType=function(a){var b=this.sprite.width/2,c=this.sprite.height/2,d=this.sprite.x,e=this.sprite.y,f=this._container.actualWidth,g=this._container.actualHeight,h=void 0,i=void 0,j=void 0;switch(a){case"lt":h=Math.max(0,d-b),i=Math.max(0,e-c),j=[[0,i],[h,i],[h,0],[h,i]],j.tooltip=[[h/2,i],[h,i/2]];break;case"lc":h=Math.max(0,d-b),j=[[0,e],[h,e],[d,0],[d,e-c],[d,e+c],[d,g]],j.tooltip=[[h/2,e]];break;case"lb":h=Math.max(0,d-b),i=Math.max(0,e+c),j=[[0,i],[h,i],[h,i],[h,g]],j.tooltip=[[h/2,i],[h,i+(g-i)/2]];break;case"rt":h=d+b,i=e-c,j=[[h,i],[f,i],[h,0],[h,i]],j.tooltip=[[h+(f-h)/2,i],[h,i/2]];break;case"rc":j=[[d,0],[d,e-c],[d+b,e],[f,e],[d,e+c],[d,g]],j.tooltip=[[d+b+(f-(d+b))/2,e]];break;case"rb":h=d+b,i=e+c,j=[[h,i],[f,i],[h,i],[h,g]],j.tooltip=[[h+(f-h)/2,i],[h,i+(g-i)/2]];break;case"ct":j=[[0,e],[d-b,e],[d,0],[d,e-c],[d+b,e],[f,e]],j.tooltip=[null,[d,(e-c)/2]];break;case"cc":j=[[0,e],[d-b,e],[d,0],[d,e-c],[d+b,e],[f,e],[d,e+c],[d,g]],j.tooltip=[];break;case"cb":j=[[0,e],[d-b,e],[d,e+c],[d,g],[d+b,e],[f,e]],j.tooltip=[null,[d,e+c+(g-e+c)/2]]}return j},b.prototype._updateLine=function(){var a=this,b=this._lineGraphics,c=this._options,d=this.getLocalPointsByType(this._positionType),e=d.map(function(b){return(0,B.iterateValues)(a._getGlobalPosition.apply(a,b),"x","y")});return b.clear(),b.lineStyle(c.lineWidth||1,c.lineColor,c.lineAlpha||1),e.forEach(function(c,d){d%2||a._drawLine.apply(a,[b].concat(c,e[d+1]))}),d},b.prototype._drawLine=function(a,b,c,d,e){a.moveTo(b,c),a.lineTo(d,e)},b.prototype._getGlobalPosition=function(a,b){return F.x=a,F.y=b,this._container.toGlobal(F)},(0,j.default)(b,[{key:"screenFitEnable",get:function(){return this.stage.screenFitEnable},set:function(a){this.screenFit(a)}},{key:"displayObject",get:function(){return this._displayObject},set:function(a){if(this.clearDisplayObject(),this._removeExitButton(),this._displayObject=a,this._displayObject&&(this.sprite.texture=new PIXI.Texture(new PIXI.BaseTexture(a)),this.sprite.renderableObject=!0,this._container.addChildAt(this.sprite,0),this.sprite.pivot.x=this.sprite.width/2,this.sprite.pivot.y=this.sprite.height/2,this.alignSignature(),this.running)){this._addExitButton();var b=A.TEMP_POINT_A;b.x=this.sprite.x,b.y=this.sprite.y;var c=this._container.toGlobal(b);this.stage.motion.running||this.stage.magnify.moveTo(c.x,c.y)}}},{key:"container",get:function(){return this._container}},{key:"modified",get:function(){return null!=this._displayObject}}]),b}(n.default);b.default=G,window.iterateValues=B.iterateValues},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(2),h=d(g),i=c(1),j=d(i),k=c(3),l=d(k),m=c(23),n=d(m),o=c(56),p=d(o),q=c(31),r=d(q),s=c(188),t=d(s),u=(c(10),c(32)),v=c(17),w=c(52),x=d(w),y=c(73),z=d(y),A=c(74),B=d(A),C=c(98),D=d(C),E=c(77),F=d(E),G=c(57),H=d(G),I=function(a){
function b(c,d,e){(0,f.default)(this,b);var g=(0,h.default)(this,a.call(this,c,d));return g._container=e,g._container.on(p.default.CHANGE_SIZE,g.onContainerChange,g),g.stage.on(r.default.MOUSE_CHILDREN_CHANGE,g.onMouseChildrenChange,g),H.default.renderer=d.renderer,g.textMain=new t.default(d,e,c),g.textMain.initialize(),g._textSelEvt=g.onTextSelect.bind(g),g._textDeselEvt=g.onTextDeSelect.bind(g),g._textDelEvt=g.onTextDeleted.bind(g),g._textReqInputEvt=g.onTextReqInput.bind(g),g.addEvents(),g.stage.on(r.default.VIEWPORT_MOTION_UPDATE,g.onViewportChange,g),g.stage.on(r.default.VIEWPORT_MOTION_COMPLETE,g.onViewportChange,g),g.stage.on(r.default.MOUSE_CHILDREN_CHANGE,g.onMouseChildrenChange,g),g.stage.on(r.default.CLEAR_ALL,g.onClearAll,g),g.stage.sticker?(0,h.default)(g):(g.stage.on(r.default.BITMAPDATA_UPDATE,g.onUpdateBitmapDataComplete,g),g.stage.on(B.default.CROP_COMPLETE,g.onCropComplete,g),g)}return(0,l.default)(b,a),(0,j.default)(b,null,[{key:"SELECT",get:function(){return"selText"}},{key:"DESELECT_TEXT",get:function(){return"deselText"}},{key:"DELETED",get:function(){return"deleted"}},{key:"ACTIVE_INPUT",get:function(){return"activeInput"}}]),b.prototype.start=function(){a.prototype.start.call(this),this.stage.magnify.on(z.default.DRAG,this.onImageDrag,this),this.stage.motion.on(x.default.UPDATE,this.onMotionUpdate,this)},b.prototype.suspend=function(){return this.stage.magnify.off(z.default.DRAG,this.onImageDrag,this),this.stage.motion.off(x.default.UPDATE,this.onMotionUpdate,this),this.textMain.releaseTarget(),a.prototype.suspend.call(this)},b.prototype.reset=function(b){var c=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.textMain.releaseTarget(),this.textMain.clear(),this.textMain.restore(b),a.prototype.reset.call(this,c)},b.prototype.snapshot=function(){return this.textMain.snapshot},b.prototype.dispose=function(){this.removeEvents(),this._container.off(p.default.CHANGE_SIZE,this.onContainerChange,this),this._container=null,this.stage.off(r.default.VIEWPORT_MOTION_UPDATE,this.onViewportChange,this),this.stage.off(r.default.VIEWPORT_MOTION_COMPLETE,this.onViewportChange,this),this.stage.off(r.default.MOUSE_CHILDREN_CHANGE,this.onMouseChildrenChange,this),this.stage.off(r.default.BITMAPDATA_UPDATE,this.onUpdateBitmapDataComplete,this),this.stage.off(B.default.CROP_COMPLETE,this.onCropComplete,this),this.stage.off(r.default.CLEAR_ALL,this.onClearAll,this)},b.prototype.delete=function(){this.textMain.textDelete()},b.prototype.setText=function(a){var b=this.stage.croppedWidth/this.stage.resizedWidth,c=this.textMain.createText(a,b),d=this.stage.viewportToLocal(this._container),e=(0,u.rotate)(d.width/2,d.height/2,d.radian),f=d.origin.x+e.x,g=d.origin.y+e.y,h=0!=d.radian?(0,u.rotate)(this.options.horizontalGap,this.options.verticalGap,d.radian):{x:this.options.horizontalGap,y:this.options.verticalGap},i=this.evalEmptyLocation(this.textMain.texts,f,g,f,g,D.default.imageRect,h),j=this._container.scale.x<0?-1:1,k=this._container.scale.y<0?-1:1;c.x=i.x,c.y=i.y,c.scale.x*=j,c.scale.y*=k,c.rotation=d.radian,this.textMain.setTarget(c),this.pushHistory()},b.prototype.evalEmptyLocation=function(a,b,c,d,e,f,g){var h=arguments.length>7&&void 0!==arguments[7]?arguments[7]:1;if(!(0,u.hitTestWithBoundary)(d,e,f))return{x:b,y:c};if((0,v.every)(a,function(a){return Math.abs(d-a.x)>1||Math.abs(e-a.y)>1}))return{x:d,y:e};if(d+=g.x,e+=g.y,!(0,u.hitTestWithBoundary)(d,e,f)){var i=(0,u.rotate)(g.x,g.y,Math.PI/2);d=b+i.x*h,e=c+i.y*h++}return this.evalEmptyLocation(a,b,c,d,e,f,g,h)},b.prototype.updateText=function(a,b){this.textMain.updateText(a,b),this.pushHistory()},b.prototype.addEvents=function(){this.textMain.on(t.default.SELECT,this._textSelEvt),this.textMain.on(t.default.DESELECT,this._textDeselEvt),this.textMain.on(t.default.DELETED,this._textDelEvt),this.textMain.on(t.default.REQ_INPUT,this._textReqInputEvt),this.textMain.on(F.default.CONTROL_UP,this.onControlUp,this)},b.prototype.removeEvents=function(){this.textMain.off(t.default.SELECT,this._textSelEvt),this.textMain.off(t.default.DESELECT,this._textDeselEvt),this.textMain.off(t.default.DELETED,this._textDelEvt),this.textMain.off(t.default.REQ_INPUT,this._textReqInputEvt),this.textMain.off(F.default.CONTROL_UP,this.onControlUp,this)},b.prototype.screenFit=function(a){if(a)return void this.stage.magnify.autoScale(a);return void(1!=this.stage.magnify.scale&&this.stage.magnify.autoScale(a))},b.prototype.update=function(){this.textMain.updateTransformTool(),this.textMain.transformTool.drawCenter(),this.textMain.transformTool.updatePrevTargetLt()},b.prototype.onContainerChange=function(a){},b.prototype.onControlUp=function(a){},b.prototype.onMouseChildrenChange=function(a){this._container.mouseChildren=a.interactive},b.prototype.onTextSelect=function(a){this.emit("selText",a),this.running||this.stage.emit(r.default.PHASE_CHANGE,{type:r.default.PHASE_CHANGE,phase:"text"})},b.prototype.onTextDeSelect=function(a){this.emit("deselText")},b.prototype.onTextDeleted=function(a){this.emit(b.DELETED)},b.prototype.onTextReqInput=function(a){this.emit("activeInput",a)},b.prototype.onControlUp=function(a){this.pushHistory()},b.prototype.onViewportChange=function(a){this.update()},b.prototype.onImageDrag=function(){this.update()},b.prototype.onMotionUpdate=function(){this.update()},b.prototype.onMouseChildrenChange=function(a){this._container&&(this._container.mouseChildren=a.interactive)},b.prototype.onUpdateBitmapDataComplete=function(a){if(this._container){var b=D.default.mouseBoundary=this.stage.imageToLocal(this._container),c=D.default.imageRect,d={origin:b.tl,width:(0,u.getDistance)(b.tl.x,b.tl.y,b.tr.x,b.tr.y),height:(0,u.getDistance)(b.tl.x,b.tl.y,b.bl.x,b.bl.y),radian:(0,u.getRadian)(b.tl.x,b.tl.y,b.tr.x,b.tr.y)};this._container.scale.x<0?d=this._container.scale.y<0?{origin:b.br,width:(0,u.getDistance)(b.br.x,b.br.y,b.bl.x,b.bl.y),height:(0,u.getDistance)(b.br.x,b.br.y,b.tr.x,b.tr.y),radian:(0,u.getRadian)(b.br.x,b.br.y,b.bl.x,b.bl.y)}:{origin:b.tr,width:(0,u.getDistance)(b.tr.x,b.tr.y,b.tl.x,b.tl.y),height:(0,u.getDistance)(b.tr.x,b.tr.y,b.br.x,b.br.y),radian:(0,u.getRadian)(b.tr.x,b.tr.y,b.tl.x,b.tl.y)}:this._container.scale.y<0&&(d={origin:b.bl,width:(0,u.getDistance)(b.bl.x,b.bl.y,b.br.x,b.br.y),height:(0,u.getDistance)(b.bl.x,b.bl.y,b.tl.x,b.tl.y),radian:(0,u.getRadian)(b.bl.x,b.bl.y,b.br.x,b.br.y)}),c.origin.x=d.origin.x,c.origin.y=d.origin.y,c.width=d.width,c.height=d.height,c.radian=d.radian,D.default.imageRect=D.default.imageRect}},b.prototype.onCropComplete=function(a){this.stage.updateTransform(),this.onUpdateBitmapDataComplete()},b.prototype.onClearAll=function(a){this.reset()},(0,j.default)(b,[{key:"modified",get:function(){return this.textMain.modified}},{key:"lastText",get:function(){return this.textMain.lastText}},{key:"screenFitEnable",get:function(){return this.stage.screenFitEnable},set:function(a){this.screenFit(a)}}]),b}(n.default);b.default=I},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(1),h=d(g),i=c(136),j=d(i),k=function(){function a(b,c,d,e,g){(0,f.default)(this,a),this.setPoints(b,c,d,e),g&&this.setTransform(g)}return a.prototype.setPoints=function(a,b,c,d){this._tl=a,this._tr=b,this._br=c,this._bl=d,this._minx=Math.min(this._tl.x,this._tr.x,this._br.x,this._bl.x),this._maxx=Math.max(this._tl.x,this._tr.x,this._br.x,this._bl.x),this._miny=Math.min(this._tl.y,this._tr.y,this._br.y,this._bl.y),this._maxy=Math.max(this._tl.y,this._tr.y,this._br.y,this._bl.y),this.setVec()},a.prototype.setVec=function(){this._tlv=new j.default(this._tl.x,this._tl.y),this._trv=new j.default(this._tr.x,this._tr.y),this._brv=new j.default(this._br.x,this._br.y),this._blv=new j.default(this._bl.x,this._bl.y),this._boundvs=[this._tlv,this._trv,this._brv,this._blv],this._a=this._trv.clone().sub(this._tlv),this._b=this._brv.clone().sub(this._trv),this._c=this._blv.clone().sub(this._brv),this._d=this._tlv.clone().sub(this._blv),this._basevs=[this._a,this._b,this._c,this._d],this._width=this._a.length,this._height=this._b.length},a.prototype.setTransform=function(a){this._transform=a},a.prototype.updateTransform=function(a){a?this._transform=a:this.calcTransform()},a.prototype.calcTransform=function(){var a=this._a.rad,b=Math.cos(a),c=Math.sin(a);this._transform||(this._transform=new PIXI.Matrix),this._transform.set(b,c,-c,b,this._tl.x,this._tl.y)},a.prototype.clone=function(){return new a(this._tl,this._tr,this._br,this._bl,this._transform)},a.prototype.AABB=function(a){return this._maxx>a._minx&&this._minx<a._maxx&&this._maxy>a._miny&&this._miny<a._maxy},a.prototype.OBB=function(a){},(0,h.default)(a,[{key:"transform",get:function(){return this._transform?this._transform:(this.calcTransform(),this._transform)}}]),a}();b.default=k},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(21),f=d(e),g=c(0),h=d(g),i=c(2),j=d(i),k=c(1),l=d(k),m=c(3),n=d(m),o=c(23),p=d(o),q=c(48),r=c(10),s=c(55),t=c(138),u=d(t),v=c(341),w=d(v),x=c(31),y=d(x),z=c(199),A=d(z),B=function(a){function b(c,d,e){(0,h.default)(this,b);var f=(0,j.default)(this,a.call(this,c,d));return f._init(e),f}return(0,n.default)(b,a),(0,l.default)(b,null,[{key:"CLIP_READY",get:function(){return"clipReady"}}]),b.prototype.start=function(){var b=this;a.prototype.start.call(this),this._isSuspend=!1,this.changeMouseChildrenStatus(!1),this.stage.emit(y.default.SAVE_RESIZE),this.stage.emit("photoFrameDisable",{type:"photoFrameDisable",visible:!1}),this.stage.emit("historyChanged",{type:"historyChanged",target:this,redoable:!1,undoable:!1}),(0,q.completeMotion)(this.stage.viewportMotion).then(function(a){return b.onMotionComplete(a)})},b.prototype.onMotionComplete=function(a){this._backup=this.snapshot(),this.stage.once(y.default.BITMAPDATA_UPDATE,this.onBitmapDataUpdate,this),this.reset(null,!0)},b.prototype.onBitmapDataUpdate=function(a){this.stage.root.visible=!1,this.stage.maskContainer.visible=!0,this.clipMain.sizeInitailize(this.bitmapdata,this.viewport),this.restoreByPrevHistory(this.stage.history.getPrevHistory().snapshot.clip),this.clipMain.isBitmapDataUpdate=!0,this.clipMain.addSignature(this.stage.signatureContainer),this.clipMain.addSticker(this.stage.stickerContainer),this.emit(b.CLIP_READY,{type:b.CLIP_READY})},b.prototype.restoreByPrevHistory=function(a){if(-1==a.index&&this.clipMain.start(this.bitmapdata,a.restoreVO),this.index=a.index,this.lineWidth=a.mask.thickness,this.color=a.mask.color,this.opacity=a.mask.opacity,a.mask.maskWidth>0){var b=this.imageTransform.stroke;b.maskWidth=a.mask.maskWidth,b.maskHeight=a.mask.maskHeight,b.update()}-1!=a.index&&this.clipMain.start(this.bitmapdata,a.restoreVO)},b.prototype.suspend=function(){this._isSuspend=!0,this._backup&&this.reset(this._backup),this.stage.root.visible=!0,this.stage.maskContainer.visible=!1,this.clipMain.suspend();var b=this.stage._objectContainer;return[this.clipMain.removeSticker(),this.clipMain.removeSignature()].forEach(function(a){return a?b.addChild(a):null}),this.stage.emit(y.default.RESTORE_RESIZE),this.isEditingImageChanged()?(this.stage.once("bitmapDataUpdate",this.onSuspendUpdateBitmapData,this),this.stage.updateBitmapData()):this.onSuspendUpdateBitmapData(),a.prototype.suspend.call(this)},b.prototype.onSuspendUpdateBitmapData=function(a){this.changeMouseChildrenStatus(!0),this.stage.emit("photoFrameDisable",{type:"photoFrameDisable",visible:!0}),this.stage._emitHistoryChange()},b.prototype.isEditingImageChanged=function(){return this.modified||this.stage.getModifiedStateAt("resize")||this.stage.entrySize>0},b.prototype.createMask=function(a){this.clipMain.maskVO=a},b.prototype.mask=function(){if(this._backup=null,this.restoreVO=this.clipMain.getRestoreVO(),!this.maskSource)return void this.pushHistory();var a=this.clipMain.imageTransform;this.color=this.clipMain.color,this.opacity=this.clipMain.opacity,this.lineWidth=this.clipMain.lineWidth,this.imageTransform.stroke.maskWidth=a.maskWidth,this.imageTransform.stroke.maskHeight=a.maskHeight;var b=this.imageTransform.transform;b.x=a.x,b.y=a.y,b.offsetX=a.offsetX,b.offsetY=a.offsetY,b.scaleX=a.scaleX,b.scaleY=a.scaleY,b.radian=a.radian,this.pushHistory()},b.prototype.pushHistory=function(){this.isChangeAfterStart&&a.prototype.pushHistory.call(this)},b.prototype.reset=function(b){var c=arguments.length>1&&void 0!==arguments[1]&&arguments[1];b?(this.index=b.index,this.color=b.mask.color,this.opacity=b.mask.opacity,this.lineWidth=b.mask.thickness,this.imageTransform.restore(b.mask),this.restoreVO=b.restoreVO||null):this.index=-1,a.prototype.reset.call(this,c)},b.prototype.dispose=function(){a.prototype.dispose.call(this)},b.prototype.identity=function(){this.restoreVO=null,this.clipMain.updateBitmapData(this.bitmapdata),this.clipMain.reset()},b.prototype.snapshot=function(){var a={};return a.index=this.index,a.mask=this.imageTransform.snapshot,a.maskScale=this.maskScale,-1!=this.index&&(a.restoreVO=this.restoreVO),a},b.prototype.loadAssets=function(a){var b=this;if(!a||!a.length)return f.default.reject("asset을 찾을 수 없습니다. "+a);this._pending=!0;var c=a.map(function(a){return(0,q.request)(a).then(function(a){return(0,s.parseXML)(a).documentElement})});return f.default.all(c).then(function(a){return b.onAssetComplete(a)}).catch(function(a){return void 0})},b.prototype.getCurrentMaskGraphics=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=b.lineWidth,d=void 0===c?1:c,e=b.color,f=void 0===e?16777215:e,g=b.alpha,h=void 0===g?1:g,i={lineWidth:d,color:f,alpha:h};return this.imageTransform.stroke.getCurrentMaskGraphics(a,i)},b.prototype.changeMouseChildrenStatus=function(a){this.stage.emit(y.default.MOUSE_CHILDREN_CHANGE,{type:y.default.MOUSE_CHILDREN_CHANGE,interactive:a})},b.prototype._init=function(a){this.maskContainer=a,this.restoreVO=null,this._pending=!1,this._isSuspend=!1,this._enlargable=!1,this._imageTransform=new u.default,this.clipMain=new w.default(this.stage.renderer,this.stage,this.maskContainer,this.options),this.stage.on(y.default.SAVE_MASK,this.onSaveMask,this),this.stage.on(y.default.RESTORE_MASK,this.onRestoreMask,this),this._initAssets(),this._index=-1,this.reset()},b.prototype._initAssets=function(){this.options.assets&&this.options.assets.length&&this.loadAssets(this.options.assets)},b.prototype.onSaveMask=function(a){this._savedBackup=null,this.modified&&(this._savedBackup=this.snapshot(),this.reset(null))},b.prototype.onRestoreMask=function(a){var b=this._savedBackup;this._savedBackup=null,b&&!a.flush&&this.reset(b)},b.prototype.onAssetComplete=function(a){this._assets=a,this._pending=!1,this.setSVGDomain(document.domain),this.emit("ready","ready")},b.prototype.setSVGDomain=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"naver.com";this.assets.forEach(function(b){b.parentNode&&b.parentNode.domain&&-1!=b.parentNode.domain.indexOf(a)&&b.parentNode.domain!=a&&(b.parentNode.domain=a)})},b.prototype._transformEqual=function(a,b){var c=a,d=b;return c.maskWidth==d.maskWidth&&c.maskHeight==d.maskHeight&&c.transform.offsetX==d.offsetX&&c.transform.offsetY==d.offsetY&&c.transform.radian==d.radian&&c.transform.scaleX==d.scaleX&&c.transform.scaleY==d.scaleY&&c.transform.x==d.x&&c.transform.y==d.y},(0,l.default)(b,[{key:"viewport",get:function(){return this.clipMain.viewport},set:function(a){this.clipMain.viewport=a}},{key:"modified",get:function(){return!!this.stage.ready&&this.imageTransform.modified}},{key:"complete",get:function(){return!!this.assets&&0!=this.assets.length}},{key:"assets",get:function(){return this._assets||[]}},{key:"pending",get:function(){return this._pending}},{key:"maskScale",get:function(){var a=this.imageTransform.stroke;return a.maskWidth/a.sourceWidth},set:function(a){var b=this.imageTransform.stroke;b.maskWidth=a*b.sourceWidth,b.maskHeight=a*b.sourceHeight}},{key:"isChange",get:function(){return this.clipMain.isChange}},{key:"isChangeAfterStart",get:function(){var a=this.snapshot(),b=this.stage.history.getPrevHistory().snapshot.clip;return a.index!=b.index||-1!=a.index&&(!(0,r.objectEqual)(a,b,"modified","restoreVO")||!this._transformEqual(b.mask,this.clipMain.imageTransform))}},{key:"lineWidth",get:function(){return this.clipMain.lineWidth},set:function(a){this.clipMain.lineWidth=a}},{key:"opacity",get:function(){return this.clipMain.opacity},set:function(a){this.clipMain.opacity=a}},{key:"color",get:function(){return this.clipMain.color},set:function(a){this.clipMain.color=a}},{key:"index",get:function(){return this._index},set:function(a){if(this._index=a,this.clipMain.index=a,this.maskSource=this.assets[a],-1===a)this.clipMain.removeMask();else{var b=new A.default;b.setDataByURL(this.options.assets[a]),this.maskVO=b}}},{key:"dimmedOpacity",get:function(){return this.clipMain.backgroundImage?this.clipMain.backgroundImage.bitmap.dimmedMaskAlpha:this.options.dimmedOpacity},set:function(a){this.clipMain.backgroundImage&&(this.clipMain.backgroundImage.bitmap.dimmedMaskAlpha=a)}},{key:"maskVO",get:function(){return this._maskVO},set:function(a){this._maskVO=a,this._isSuspend||this.clipMain.createMask(a)}},{key:"maskSource",get:function(){return this._maskSource},set:function(a){this.maskSource!=a&&(this._maskSource=a,this.imageTransform.stroke.initWithSVG(this._maskSource))}}]),b}(p.default);b.default=B},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(1),h=d(g),i=c(131),j=(c(10),c(48)),k=c(55),l=c(97),m=d(l),n=c(25),o=d(n),p=new o.default,q=[1,0,0,1,0,0],r=function(){function a(){(0,f.default)(this,a),this._source=null,this.sourceContainer=document.createElement("div"),this.sourceContainer.style.display="none",this.strokeContext=document.createElement("canvas").getContext("2d"),this.innerStrokeContext=document.createElement("canvas").getContext("2d"),this.maskContext=document.createElement("canvas").getContext("2d"),this.innerStrokeClippingContext=document.createElement("canvas").getContext("2d"),document.body.appendChild(this.sourceContainer),this._maskWidth=this._maskHeight=0,this._strokeGap=6,this._enableStrokeGap=!1,this._enableMaskCanvasOffset=!0,this._maskCanvasOffsetMax=2}return a.prototype.initWithURL=function(a){var b=this,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#npe-mask-core";return(0,j.request)(a).then(function(a){return b.initWithSVG((0,k.parseXML)(a).documentElement,c)}).catch(function(a){return void 0})},a.prototype.initWithSVG=function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#npe-mask-core",c=this.thickness,d=this.opacity,e=this.color;return this.clear(),this.source&&this.source.parentNode==this.sourceContainer&&this.sourceContainer.removeChild(this.source),this._source=a,this.source?(this.sourceContainer.appendChild(this.source),this.mainPath=a.querySelector(b),this.fillOpacity=0,this.maskWidth=this.sourceWidth+.5|0,this.maskHeight=this.sourceHeight+.5|0,this._sizeChanged=!0,this._strokeChanged=!0,this.thickness=c,this.opacity=d,this.color=e,this.update(),this):this},a.prototype.clear=function(){this.mainPath=null},a.prototype.update=function(){this.updateInnerStroke(),this.updateStroke(),this.updateMask()},a.prototype.updateStroke=function(){if(this._strokeChanged&&this.mainPath){var a=this.sourceContainer.innerHTML,b=this.strokeContext.canvas;b.width=this.maskWidth,b.height=this.maskHeight,this.strokeContext.drawSvg(a,0,0,this.maskWidth,this.maskHeight),this._strokeChanged=!1}},a.prototype.updateMask=function(){if(this.mainPath){var a=this.opacity;this.maskContext.canvas;this.mainPath.style["stroke-opacity"]=0,this.fillOpacity=1,this.fillColor=this.colorHex,this.drawInnerStrokeClipping(this.innerStrokeClippingContext,this.sourceContainer.innerHTML,this.maskWidth,this.maskHeight),this.drawMaskCanvas(this.maskContext,this.innerStrokeClippingCanvas,this.maskWidth,this.maskHeight),this.mainPath.style["stroke-opacity"]=a,this.fillOpacity=0,this._sizeChanged=!1}},a.prototype.drawInnerStrokeClipping=function(a,b,c,d){var e=a.canvas;e.width=c,e.height=d,a.drawSvg(b,0,0,c,d)},a.prototype.drawMaskCanvas=function(a,b,c,d){var e=a.canvas,f=Math.min(this._maskCanvasOffsetMax,this.thickness);e.width=c,e.height=d,a.drawImage(b,f,f,c-2*f,d-2*f)},a.prototype.updateInnerStroke=function(){if(this.mainPath){this.updateStroke(),this.updateMask();var a=this.innerStrokeContext.canvas,b=[this.maskWidth,this.maskHeight];a.width=b[0],a.height=b[1],this.innerStrokeContext.save(),this.innerStrokeContext.setTransform(1,0,0,1,0,0),this.innerStrokeContext.drawImage(this.strokeCanvas,0,0),this.innerStrokeContext.globalCompositeOperation="destination-in";var c=this.getTransformMatrix(this.maskCanvas.width,this.maskCanvas.height);this.innerStrokeContext.setTransform(c[0],c[1],c[2],c[3],c[4],c[5]),this.innerStrokeContext.drawImage(this.innerStrokeClippingCanvas,0,0),this.innerStrokeContext.restore()}},a.prototype.getTransformMatrix=function(a,b){if(!this._enableStrokeGap)return q;var c=(a+this._strokeGap)/a,d=a*c,e=b*c;return p.setTransform(d/2,e/2,c,c,d/2,e/2,0),p.matrix.raw},a.prototype.getCurrentMaskGraphics=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=b.lineWidth,d=void 0===c?1:c,e=b.color,f=void 0===e?16777215:e,g=b.alpha,h=void 0===g?1:g;return this.source?(a||(a=new PIXI.Graphics),a.clear(),a.lineStyle(d,f,h),m.default.drawSVG(a,this.source),a):null},(0,h.default)(a,[{key:"maskWidth",get:function(){return this._maskWidth},set:function(a){a!=this._maskWidth&&(this._maskWidth=a||this.sourceWidth,this._strokeChanged=!0,this._sizeChanged=!0)}},{key:"maskHeight",get:function(){return this._maskHeight},set:function(a){a!=this.height&&(this._maskHeight=a||this.sourceHeight,this._strokeChanged=!0,this._sizeChanged=!0)}},{key:"color",get:function(){if(!this.mainPath)return 16777215;var a=this.mainPath.style.stroke,b=void 0,c=void 0,d=void 0;if(/^rgb/g.test(a)){var e=a.match(/\d+/g).map(function(a){return Number(a)});b=e[0],c=e[1],d=e[2]}else if(/^#/.test(a)){var f=(0,i.toHex)(a);b=f[0],c=f[1],d=f[2]}else b=255,c=255,d=255;return b<<16|c<<8|d},set:function(a){a!=this.color&&(this.colorHex=(0,i.toHexString)(a))}},{key:"colorHex",get:function(){return this.mainPath?this.mainPath.style.stroke:"#fff"},set:function(a){this.mainPath&&a!=this.colorHex&&(this.mainPath.style.stroke=a,this._strokeChanged=!0,this._sizeChanged=!0)}},{key:"opacity",get:function(){return this.mainPath?Number(this.mainPath.style["stroke-opacity"]):1},set:function(a){this.mainPath&&a!=this.opacity&&(this.mainPath.style["stroke-opacity"]=a,this._strokeChanged=!0)}},{key:"fillOpacity",get:function(){return this.mainPath?Number(this.mainPath.style["fill-opacity"]):0},set:function(a){this.mainPath&&a!=this.fillOpacity&&(this.mainPath.style["fill-opacity"]=a)}},{key:"fillColor",get:function(){return this.mainPath?this.mainPath.style.fill:0},set:function(a){this.mainPath&&(this.mainPath.style.fill=a,this._sizeChanged=!0)}},{key:"thickness",get:function(){return this.mainPath?Number(this.mainPath.style["stroke-width"].replace(/[^\d]+/,"")):0},set:function(a){if(this.mainPath&&a!=this.thickness){var b=a+.5|0;this.mainPath.style["stroke-width"]=b+"px",this._strokeChanged=!0}}},{key:"source",get:function(){return this._source}},{key:"sourceWidth",get:function(){return this.source?(0,i.retrieveValueIn)(this.source,"width","baseVal","value")||0:1}},{key:"sourceHeight",get:function(){return this.source?(0,i.retrieveValueIn)(this.source,"height","baseVal","value")||0:1}},{key:"strokeCanvas",get:function(){return this.strokeContext.canvas}},{key:"maskCanvas",get:function(){return this.maskContext.canvas}},{key:"innerStrokeCanvas",get:function(){return this.innerStrokeContext.canvas}},{key:"innerStrokeClippingCanvas",get:function(){return this.innerStrokeClippingContext.canvas}}]),a}();b.default=r},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(1),h=d(g),i=c(2),j=d(i),k=c(3),l=d(k),m=c(79),n=d(m),o=c(15),p=(d(o),c(190)),q=(d(p),c(193)),r=(d(q),c(143)),s=d(r),t=c(57),u=d(t),v=c(192),w=(d(v),c(194)),x=(d(w),c(348)),y=d(x),z=c(142),A=d(z),B=c(140),C=d(B),D=c(196),E=d(D),F=c(141),G=d(F),H=c(199),I=(d(H),c(10)),J=c(349),K=(d(J),c(350)),L=d(K),M=c(52),N=d(M),O=c(351),P=d(O),Q=c(31),R=d(Q),S=c(200),T=d(S),U=c(355),V=d(U),W=c(357),X=d(W),Y=c(358),Z=d(Y),$=c(10),_=c(97),aa=(d(_),c(17)),ba=c(359),ca=(d(ba),c(63)),da=(d(ca),{type:"boundaryChange",points:null}),ea=function(a){function b(c,d,e){var g=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{useSnap:!0,snapAngle:5,useDelete:!1};(0,f.default)(this,b);var h=(0,j.default)(this,a.call(this));return u.default.renderer=c,h.renderer=c,h.stageLayer=d,h.maskLayer=e,h.options=g,h.initialize(),h.createListener(),h}return(0,l.default)(b,a),b.prototype.initialize=function(){this._maskVO=null,this.maskShape=null,this._opacity=0,this._lineWidth=0,this._color="#000000",this._isApplicationStart=!1,this._changeMaskCount=0,this.isBitmapDataUpdate=!1,this._isChange=!1,this._isChangeAfterStart=!1,this.restoreVO=null,this.isAddDimmedRenderTicker=!1,this.transformTool=new C.default(this.stageLayer,this.maskLayer,this.options),this._strokeRestoreVO=new P.default,this._renderer=(new X.default).initPolygonRenderer(this.renderer),this.transformTool.collision=this._renderer},b.prototype.createListener=function(){this._maskTransformCompleteListener=this.onTransformToolComplete.bind(this),this._transformToolChangeListener=this.onTransformToolChange.bind(this),this._backgroundImageTransformCompleteListener=this.onBackgroundImageTransformComplete.bind(this),this._stageDownListener=this.onStageDown.bind(this),this._dimmedRenderListener=this.onDimmedRender.bind(this)},b.prototype.start=function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.bitmapData=a,this.restoreVO=b,this.addEvent(),this.addDimmedRenderTicker(),b?this.restore(b):this.createBackgroundImage()},b.prototype.suspend=function(){this.stopTween(),this.removeEvent(),this.transformTool.releaseTarget(),this.maskShape&&(this.maskShape.visible=!1),this.backgroundImage&&(this.backgroundImage.visible=!1),this.outLine&&(this.outLine.visible=!1),this.guideOutLine&&(this.guideOutLine.visible=!1),this.removeDimmedRenderTicker(),this.maskLayer.visible=!1,this._changeMaskCount=0,this.isBitmapDataUpdate=!1,this._isChangeAfterStart=!1},b.prototype.restore=function(a){a&&(this.restoreVO=a,this.backgroundImage.alpha=0,this.backgroundImage.visible=!0,this.createBackgroundImage(a.backgroundImageRestoreVO),this.restoreMask(a.maskRestoreVO),this.backgroundImageSAT.updateFrame(this.backgroundImage.bitmapWidth,this.backgroundImage.bitmapHeight),this.updateBackgrounImageSAT(),this.updateMaskShapeSAT())},b.prototype.createBackgroundImage=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(this.backgroundImage?(this.backgroundImage.visible=!0,this.backgroundImage.bitmapData=this.bitmapData):(this.backgroundImageSAT=new V.default(100,100),this._renderer.add(this.backgroundImageSAT),this.backgroundImage=new A.default(this.bitmapData),this.backgroundImage.on(C.default.TRANSFORM_COMPLETE,this._backgroundImageTransformCompleteListener),this.maskLayer.addChild(this.backgroundImage)),a)this.backgroundImage.setPivot(a.pivot),this.backgroundImage.x=a.x,this.backgroundImage.y=a.y,this.backgroundImage.bitmapWidth=a.bitmapWidth,this.backgroundImage.bitmapHeight=a.bitmapHeight,this.backgroundImage.width=a.width,this.backgroundImage.height=a.height,this.backgroundImage.rotation=a.rotation,this.backgroundImage.scale.x=a.scaleX,this.backgroundImage.scale.y=a.scaleY;else{var b=n.default.initializedBackgroundImageSize;this.backgroundImage.bitmapWidth=Math.min(b.width,this.bitmapData.width),this.backgroundImage.bitmapHeight=Math.min(b.height,this.bitmapData.height),this.backgroundImage.x=n.default.viewportCenterX,this.backgroundImage.y=n.default.viewportCenterY}this.backgroundImageSAT.updateFrame(this.backgroundImage.bitmapWidth,this.backgroundImage.bitmapHeight),this.updateBackgrounImageSAT()},b.prototype.updateBitmapData=function(a){this.bitmapData=a,this.isApplicationStart&&(n.default.initialize(a,this.viewport),this.backgroundImage.bitmapData=a)},b.prototype.punch=function(){var a=this.backgroundImage.scale.x,b=this.backgroundImage.scale.y;this.backgroundImage.bitmap.punch(this.outLine.x,this.outLine.y,a,b,this.stroke.maskCanvas,-this.backgroundImage.rotation)},b.prototype.addSticker=function(a){this.backgroundImage&&this.backgroundImage.bitmap.addSticker(a)},b.prototype.removeSticker=function(){if(this.backgroundImage)return this.backgroundImage.bitmap.removeSticker()},b.prototype.addSignature=function(a){this._signatureContainer=a,this.updateSignature(),this.emitBoundaryChange()},b.prototype.removeSignature=function(){var a=this._signatureContainer;return this._signatureContainer=null,a&&a.parent?a.parent.removeChild(a):null},b.prototype.updateSignature=function(){if(this._signatureContainer){var a=this._signatureContainer,b=Math.max(a.actualWidth,a.actualHeight),c=Math.min(1,this.stageLayer.editingMaxSize/b),d=this.index<0?[this.backgroundImage.bitmap.image,c]:[this.maskLayer,1],e=d[0],f=d[1];a.scale.x=a.scale.y=f,e.addChildAt(this._signatureContainer,e.children.length)}},b.prototype.createMask=function(a){a&&(this.maskShape?this.changeMask(a):(this.addMask(a),this.startApplication()),this.backgroundImage.bitmap.dimmedMaskAlpha=this.options.dimmedOpacity,this.updateSignature(),this.emitBoundaryChange())},b.prototype.addMask=function(a){var b=this.maskShape;b||(this.maskShape=b=new s.default(this.stroke.maskCanvas),b.on(C.default.CHANGE,this._transformToolChangeListener),b.on(C.default.TRANSFORM_COMPLETE,this._maskTransformCompleteListener),b.x=n.default.viewportCenterX,b.y=n.default.viewportCenterY,this.maskLayer.addChild(b)),b.maskVO=a,b.visible=!0,b.alpha=.001,this.resizeMaskToImage(this.backgroundImage,b),this.outLine&&(this.stroke.update(),this.outLine.texture.update(),this.updateOutLine(),this.outLine.visible=!0),this.backgroundImage.bitmap.showDimmed(),this.maskShapeSAT&&this._renderer.remove(this.maskShapeSAT),this.maskShapeSAT=this.createMaskShapeSAT(R.default.defaultOptions.clip.polygons[this.index]),this._renderer.add(this.maskShapeSAT),this.updateMaskShapeSAT(),this.alignBackgroundImage()},b.prototype.resizeMaskToImage=function(a,b){var c=Math.min(a.width/b.width,a.height/b.height);if(!(c>=1)){var d=b.width*c|0,e=b.height*c|0;this.updateStroke(d,e),b.width=d,b.height=e,b.setImageSize(d,e),this.updateOutLine()}},b.prototype.createMaskShapeSAT=function(a){var b=void 0;return 1==a.length?b=new Z.default(a):(b=new T.default(a),b.anchorX=b.anchorY=.5),b},b.prototype.alignBackgroundImage=function(){if(this.transformTool.moveTest()){var a=this._renderer.boundary,b=this._renderer.target,c=this.backgroundImage;c.x=a.x,c.y=a.y;var d=c.toLocal({x:b.x,y:b.y});this.transformTool.setPivotByLocalPoint(d,c);var e=a.containTestPolygon(b);$.maxLength.apply(void 0,e)<=0||(b.radius?a.scaleToCircle(b.radius):this.scaleTestBoundaryWithPolygon(e),c.width=a.width,c.height=a.height)}},b.prototype.scaleTestBoundaryWithPolygon=function(a){var b=this._renderer.boundary,c=this._renderer.target,d=c.pivot,e=$.maxVertex.apply(void 0,a),f=e.map(function(a,b){return a-d[b]}),g=f[0],h=f[1];b.scaleToVector(g,h)},b.prototype.updateMaskShapeSAT=function(){this.maskShape&&(this.maskShape.updateTransform(),this.maskShapeSAT.width=this.maskShape.width,this.maskShapeSAT.height=this.maskShape.height,this.maskShapeSAT.x=this.maskShape.x,this.maskShapeSAT.y=this.maskShape.y)},b.prototype.updateBackgrounImageSAT=function(){this.backgroundImage&&(this.backgroundImage.updateTransform(),this.backgroundImageSAT.width=this.backgroundImage.width,this.backgroundImageSAT.height=this.backgroundImage.height,this.backgroundImageSAT.radian=this.backgroundImage.rotation,
this.backgroundImageSAT.x=this.backgroundImage.x,this.backgroundImageSAT.y=this.backgroundImage.y,this.backgroundImageSAT.pivotX=this.backgroundImage.pivot.x+Math.abs(this.backgroundImage.bitmap.x),this.backgroundImageSAT.pivotY=this.backgroundImage.pivot.y+Math.abs(this.backgroundImage.bitmap.y))},b.prototype.removeMask=function(){if(this.transformTool&&this.transformTool.releaseTarget(),this.maskShape&&(this.maskShape.visible=!1),this.isReady){var a=this.backgroundImage;a.bitmap.hideDimmed(),a.pivot.x=a.pivot.y=0,a.rotation=0,this.createBackgroundImage(null),this.outLine.visible=!1}this.hideGuideOutLine(),this.updateSignature(),this.emitBoundaryChange()},b.prototype.mask=function(){if(this.isReady){this.transformTool.releaseTarget();var a=this.renderManager.getVisibleMaskCanvas(),b=this.maskResult=new PIXI.Sprite(PIXI.Texture.fromCanvas(a));b.pivot={x:a.width/2,y:a.height/2},b.x=n.default.viewportCenterX,b.y=n.default.viewportCenterY,this.maskLayer.addChild(b),this.maskLayer.swapChildren(this.maskResult,this.outLine),this.backgroundImage.visible=!1}},b.prototype.changeMask=function(a){this.hideGuideOutLine(),this.transformTool&&this.transformTool.releaseTarget(),this.addMask(a),0!==this._changeMaskCount&&(this.isChangeAfterStart=!0),this._changeMaskCount++},b.prototype.restoreMask=function(a){this.maskShape.setImageSize(a.width,a.height),this.maskShape.x=a.x,this.maskShape.y=a.y,this.maskShape.visible=!0,this.maskShape.alpha=.001,this.restoreStrokeAndResetSetting(this.restoreVO.strokeRestoreVO)},b.prototype.restoreStrokeAndResetSetting=function(a){this.setStrokeByRestoreVO(a),this.stroke.maskWidth=this.maskShape.width,this.stroke.maskHeight=this.maskShape.height,this.stroke.update(),this.outLine.texture.update(),this.updateOutLine(),this.outLine.visible=!0,this.showBackgroundImageAndDimmedWithMotion(),this._changeMaskCount++,this._isChangeAfterStart=!1},b.prototype.showBackgroundImageAndDimmedWithMotion=function(){var a=this,b=this.backgroundImage.bitmap._dimmed;b.alpha=0,this.backgroundImage.bitmap.showDimmed(),this.showBackgroundImageTween||(this.showDimmedTween=new N.default,this.showBackgroundImageTween=new N.default,this.showDimmedTween.on("complete",function(){a.addDimmedRenderTicker()})),this.showBackgroundImageTween.play(this.backgroundImage,{alpha:1},300,N.default.easeOut),this.showDimmedTween.play(b,{alpha:1},300,N.default.easeOut)},b.prototype.setStrokeByRestoreVO=function(a){if(a){var b=a.color,c=a.color;c.indexOf("rgb")>-1&&(c=c.split("(")[1].split(")")[0],c=c.split(","),b=c.map(function(a){return a=parseInt(a).toString(16),1==a.length?"0"+a:a}),b="#"+b.join("")),this.color=b,this.lineWidth=a.thickness,this.opacity=a.opacity}},b.prototype.startApplication=function(){this._isApplicationStart=!0,this.createRenderManager(),this.createCollisionManager(),this.createOutLine()},b.prototype.addEvent=function(){this.stageLayer.renderer.view.addEventListener("mousedown",this._stageDownListener)},b.prototype.removeEvent=function(){this._stageDownListener&&this.stageLayer.renderer.view.removeEventListener("mousedown",this._stageDownListener)},b.prototype.createRenderManager=function(){this.isReady&&!this.renderManager&&(this.renderManager=new y.default(this.maskShape,this.backgroundImage))},b.prototype.addDimmedRenderTicker=function(){!1===this.isAddDimmedRenderTicker&&(this.isAddDimmedRenderTicker=!0,this.renderer.on("prerender",this._dimmedRenderListener,this))},b.prototype.removeDimmedRenderTicker=function(){this.isAddDimmedRenderTicker&&(this.isAddDimmedRenderTicker=!1,this.renderer.off("prerender",this._dimmedRenderListener,this))},b.prototype.onDimmedRender=function(a){!1!==this.isReady&&!1!==this.maskShape.visible&&(this.maskLayer.updateTransform(),this.punch())},b.prototype.createCollisionManager=function(){this.isReady&&E.default.initialize(this.maskShape,this.backgroundImage,this._renderer)},b.prototype.createOutLine=function(){this.outLine||(this.outLine=new PIXI.Sprite(PIXI.Texture.fromCanvas(this.stroke.innerStrokeCanvas)),this.outLine.x=this.maskShape.x-this.maskShape.width/2,this.outLine.y=this.maskShape.y-this.maskShape.height/2,this.maskLayer.addChild(this.outLine)),this.guideOutLine||(this.guideOutLine=new PIXI.Graphics,this.guideOutLine.visible=!1,this.maskLayer.addChild(this.guideOutLine))},b.prototype.updateOutLine=function(){this.maskShape&&this.outLine&&(this.outLine.x=this.maskShape.x-this.maskShape.width/2,this.outLine.y=this.maskShape.y-this.maskShape.height/2),this.guideOutLine&&(this.guideOutLine.x=this.outLine.x,this.guideOutLine.y=this.outLine.y)},b.prototype.onTransformToolChange=function(a){this.maskShape&&(this.transformTool.target===this.maskShape&&a.target.type!==G.default.MIDDLE_CENTER&&(this.updateStroke(this.maskShape.width,this.maskShape.height),this.outLine.texture.update(),this.showGuideOutLine()),this.updateOutLine(),this.emitBoundaryChange())},b.prototype.onTransformToolComplete=function(a){this.maskShape.updateTransform(),this.transformTool.update(),this.transformTool.drawCenter(),this.maskMoveToCenter(a)},b.prototype.updateStroke=function(a,b){this.stroke.maskWidth=a,this.stroke.maskHeight=b,this.stroke.update()},b.prototype.emitBoundaryChange=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getMaskRectGlobalPoints(),b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getMaskRectScale();da.points=a,da.scale=b,this.stage.emit("boundaryChange",da)},b.prototype.getMaskRectGlobalPoints=function(){var a=void 0,b=void 0,c=void 0;return this.maskShape&&this.maskShape.visible?(b=this.maskShape.canvas,a={lt:{x:b.lt.x,y:b.lt.y},rt:{x:b.rt.x,y:b.rt.y},lb:{x:b.lb.x,y:b.lb.y},rb:{x:b.rb.x,y:b.rb.y}}):this.backgroundImage&&(b=this.backgroundImage.bitmap,c=b.image,a={lt:{x:0,y:0},rt:{x:c.width,y:0},lb:{x:0,y:c.height},rb:{x:c.width,y:c.height}}),b?(0,aa.map)(a,function(a){return b.toGlobal(a)}):null},b.prototype.getMaskRectScale=function(){return 1},b.prototype.resize=function(){var a=0,b=0;if(this.viewport&&n.default.isAvailable){n.default.initialize(this.bitmapData,this.viewport);var c=this.viewport.x+.5*this.viewport.width|0,d=this.viewport.y+.5*this.viewport.height|0;this.maskShape?(a=c-this.maskShape.x,b=d-this.maskShape.y,this.backgroundImage&&(this.backgroundImage.x+=a,this.backgroundImage.y+=b),this.maskShape.x=c,this.maskShape.y=d):this.backgroundImage&&(this.backgroundImage.x=c,this.backgroundImage.y=d)}this.transformTool&&this.transformTool.releaseTarget(),this.updateOutLine(),this.updateMaskShapeSAT(),this.updateBackgrounImageSAT()},b.prototype.update=function(a){},b.prototype.maskMoveToCenter=function(a){var b=this,c=this.transformTool.target;if(E.default.isMask(c)&&a.type===G.default.MIDDLE_CENTER){this.stopTween();var d=n.default.viewportCenterX,e=n.default.viewportCenterY,f=d-this.maskShape.x,g=e-this.maskShape.y;this.maskTween||(this.maskTween=new N.default,this.maskTween.on("update",function(){b.transformTool.activeTarget(c),b.updateOutLine(),b.updateSATandBoundary()}),this.maskTween.on("complete",function(){b.transformTool.activeTarget(c),b.updateOutLine(),b.updateSATandBoundary()}),this.backTween=new N.default),this.maskTween.play(this.maskShape,{x:d,y:e},300,N.default.easeOut),this.backTween.play(this.backgroundImage,{x:this.backgroundImage.x+f,y:this.backgroundImage.y+g},300,N.default.easeOut)}},b.prototype.updateSATandBoundary=function(){this.updateMaskShapeSAT(),this.updateBackgrounImageSAT(),this.emitBoundaryChange()},b.prototype.stopTween=function(){this.maskTween&&this.maskTween.stop(),this.backTween&&this.backTween.stop(),this.resetMaskTween&&this.resetMaskTween.stop(),this.resetBackTween&&this.resetBackTween.stop(),this.showDimmedTween&&this.showDimmedTween.stop(!0),this.showBackgroundImageTween&&this.showBackgroundImageTween.stop(!0)},b.prototype.reset=function(){var a=this,b=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.stopTween(),this.transformTool&&this.transformTool.releaseTarget(),this.maskShape&&(this.maskShape.alpha=.001,b?(this.resetMaskTween||(this.resetMaskTween=new N.default,this.resetMaskTween.on("update",function(){a.stroke.maskWidth=a.maskShape.width,a.stroke.maskHeight=a.maskShape.height,a.stroke.update(),a.outLine.texture.update(),a.updateOutLine()})),this.resetMaskTween.play(this.maskShape,{x:n.default.viewportCenterX,y:n.default.viewportCenterY,width:Number(this.maskShape.defaultSizeX),height:Number(this.maskShape.defaultSizeY)},300,N.default.easeOut)):(this.maskShape.x=n.default.viewportCenterX,this.maskShape.y=n.default.viewportCenterY,this.maskShape.width=this.maskShape.defaultSizeX,this.maskShape.height=this.maskShape.defaultSizeY)),this.backgroundImage&&(this.backgroundImage.visible=!0,this.backgroundImage.setPivot(this.backgroundImage.registrationPoint),b?(this.resetBackTween||(this.resetBackTween=new N.default,this.resetBackTween.on("update",function(){a.backgroundImage.scale.x=a.backgroundImage.sx,a.backgroundImage.scale.y=a.backgroundImage.sy})),this.backgroundImage.sx=this.backgroundImage.scale.x,this.backgroundImage.sy=this.backgroundImage.scale.y,this.resetBackTween.play(this.backgroundImage,{sx:1,sy:1,rotation:0,x:n.default.viewportCenterX,y:n.default.viewportCenterY},300,N.default.easeOut)):(this.backgroundImage.scale.x=1,this.backgroundImage.scale.y=1,this.backgroundImage.rotation=0,this.backgroundImage.x=n.default.viewportCenterX,this.backgroundImage.y=n.default.viewportCenterY)),this.updateOutLine()},b.prototype.getRestoreVO=function(){return this.isReady?new L.default(this.strokeRestoreVO,this.maskShape.restoreVO,this.backgroundImage.restoreVO):null},b.prototype.sizeInitailize=function(a,b){window.Size=n.default,n.default.initialize(a,b)},b.prototype.showGuideOutLine=function(){0===this.lineWidth&&(this.stroke.getCurrentMaskGraphics(this.guideOutLine,{lineWidth:1,color:"0xDADADA",alpha:1}),this.guideOutLine.x=this.outLine.x,this.guideOutLine.y=this.outLine.y,this.guideOutLine.width=this.maskShape.width,this.guideOutLine.height=this.maskShape.height,this.guideOutLine.visible=!0)},b.prototype.hideGuideOutLine=function(){this.guideOutLine&&(this.guideOutLine.visible=!1)},b.prototype.onStageDown=function(a){if(this.isReady&&this.isSelectedMask){this.stopTween();if(!0!==this.transformTool.isOverControl){var b=u.default.global,c=this.maskShape.width*this.maskShape.height,d=this.backgroundImage.width*this.backgroundImage.height,e=c>d,f=this.maskShape.hitTestWithGlobalPoint(b),g=this.backgroundImage.hitTestWithGlobalPoint(b);e?g?this.onBackgroundImageMouseDown(this.createSetTargetEvent(a,this.backgroundImage)):this.maskShape.visible&&f?this.onMaskDown(this.createSetTargetEvent(a,this.maskShape)):(this.transformTool.releaseTarget(),this.hideGuideOutLine()):this.maskShape.visible&&f?this.onMaskDown(this.createSetTargetEvent(a,this.maskShape)):g?(this.onBackgroundImageMouseDown(this.createSetTargetEvent(a,this.backgroundImage)),this.hideGuideOutLine()):(this.transformTool.releaseTarget(),this.hideGuideOutLine())}}},b.prototype.createSetTargetEvent=function(a,b){a.stopPropagation();var c=(0,I.clone)(a);return c.target=b,c.stopPropagation=function(){},c},b.prototype.onMaskDown=function(a){this.isChangeAfterStart=!0,this.transformTool.setTargetByEvent(a),this.showGuideOutLine()},b.prototype.onBackgroundImageMouseDown=function(a){this.isChangeAfterStart=!0,this.transformTool.setTargetByEvent(a)},b.prototype.onBackgroundImageTransformComplete=function(a){this.transformTool.update(),this.transformTool.drawCenter()},(0,h.default)(b,[{key:"viewport",get:function(){return this._viewport},set:function(a){this._viewport=a,this.resize()}},{key:"maskVO",set:function(a){this._maskVO=a},get:function(){return this._maskVO}},{key:"lineWidth",get:function(){return this.stroke.thickness},set:function(a){this.stroke.thickness=a,this._strokeRestoreVO.thickness=a,this.stroke.update(),this.isBitmapDataUpdate&&(this.isChangeAfterStart=!0),this.hideGuideOutLine()}},{key:"opacity",get:function(){return this.stroke.opacity},set:function(a){this.stroke.opacity=a,this._strokeRestoreVO.opacity=a,this.stroke.update(),this.isBitmapDataUpdate&&(this.isChangeAfterStart=!0)}},{key:"color",get:function(){return this.stroke.colorHex},set:function(a){this.stroke.colorHex=a,this._strokeRestoreVO.color=a,this.stroke.update(),this.isBitmapDataUpdate&&(this.isChangeAfterStart=!0)}},{key:"imageTransform",get:function(){return this.renderManager?this.renderManager.getTransformVisibleSize(this.bitmapData):null}},{key:"stage",get:function(){return this.stageLayer}},{key:"stroke",get:function(){return this.stage.clip.imageTransform.stroke}},{key:"strokeRestoreVO",get:function(){return this._strokeRestoreVO.clone()}},{key:"isChange",get:function(){return this._isChange}},{key:"isChangeAfterStart",set:function(a){!0===a&&(this._isChange=!0),this._isChangeAfterStart=a},get:function(){return this._isChangeAfterStart}},{key:"isApplicationStart",get:function(){return this._isApplicationStart}},{key:"isReady",get:function(){return!(!this.maskShape||!this.backgroundImage)}},{key:"isSelectedMask",get:function(){return-1!=this.index}},{key:"index",set:function(a){this._index=a},get:function(){return this._index}}]),b}(PIXI.utils.EventEmitter);b.default=ea},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(1),h=d(g),i=c(2),j=d(i),k=c(3),l=d(k),m=c(194),n=d(m),o=c(15),p=(d(o),c(78)),q=(d(p),c(139)),r=d(q),s=c(63),t=d(s),u=c(140),v=d(u),w=c(80),x=(d(w),function(a){function b(){(0,f.default)(this,b);var c=(0,j.default)(this,a.call(this));return c._initialize(),c._addEvent(),c}return(0,l.default)(b,a),b.prototype._initialize=function(){this.vector=new n.default,this.addChild(this.vector),this._vectorHalfWidth=0,this._vectorHalfHeight=0,this.pivotOffset=new PIXI.Point},b.prototype._addEvent=function(){this._vectorLoadCompleteListener=this.onVectorLoadComplete.bind(this),this._vectorTextureUpdateListener=this.onVectorTextureUpdateComplete.bind(this),this._vectorTransfromCompleteListener=this.onVectorTransformComplete.bind(this),this.vector.on(n.default.LOAD_COMPLETE,this._vectorLoadCompleteListener),this.vector.on(n.default.TEXTURE_UPDATE,this._vectorTextureUpdateListener),this.on(v.default.TRANSFORM_COMPLETE,this._vectorTransfromCompleteListener)},b.prototype.load=function(a,b,c){this.vector.load(a,0,0,b,c)},b.prototype.loadDefaultSize=function(a){var b=this.parseSize(a.defaultSize);this.vector.load(a.url,0,0,b.width,b.height)},b.prototype.addRegistrationPoint=function(){this.registrationPoint||(this.registrationPoint=t.default.getCircle(0,0,0,5025616),this.addChild(this.registrationPoint))},b.prototype.hitTestWithGlobalPoint=function(a){var b=this.toLocal(a),c=this.getLocalBounds();return b.x>=c.x&&b.x<=c.x+c.width&&b.y>=c.y&&b.y<=c.y+c.height},b.prototype.setPivot=function(a){this.pivot=a},b.prototype.destroy=function(){this.vector&&(this.vector.off(n.default.LOAD_COMPLETE,this._vectorLoadCompleteListener),this.vector.off(n.default.TEXTURE_UPDATE,this._vectorTextureUpdateListener),this.off(v.default.TRANSFORM_COMPLETE,this._vectorTransfromCompleteListener),this.removeChild(this.vector),this.vector.destroy(),this.vector=null),this.registrationPoint&&(this.removeChild(this.registrationPoint),this.registrationPoint.destroy(),this.registrationPoint=null),this.graphics&&(this.removeChild(this.graphics),this.graphics.destroy(),this.graphics=null),a.prototype.destroy.call(this)},b.prototype.onVectorLoadComplete=function(){this._vectorHalfWidth=this.vector.width/2,this._vectorHalfHeight=this.vector.height/2,this.vector.x=-this.vectorHalfWidth,this.vector.y=-this.vectorHalfHeight,this.addRegistrationPoint(),this.onReady&&this.onReady()},b.prototype.onVectorTextureUpdateComplete=function(){this._vectorHalfWidth=this.vector.width/2,this._vectorHalfHeight=this.vector.height/2,this.vector.x=-this.vectorHalfWidth,this.vector.y=-this.vectorHalfHeight,this.scale=new PIXI.Point(1,1),this.emit(v.default.TEXTURE_UPDATE)},b.prototype.onVectorTransformComplete=function(a){"middleCenter"!==a.type&&this.redrawVector(this.width,this.height)},b.prototype.redrawVector=function(a,b){this.vector.drawSvg(0,0,a,b)},b.prototype.getMovedRect=function(a,b){var c=this.lt,d=this.rt,e=this.rb,f=this.lb;return c.x+=a,c.y+=b,d.x+=a,d.y+=b,e.x+=a,e.y+=b,f.x+=a,f.y+=b,new r.default(c,d,e,f)},b.prototype.getRotatedRect=function(a){var b=this.rotation;this.rotation=a,this.updateTransform();var c=this.lt.clone(),d=this.rt.clone(),e=this.rb.clone(),f=this.lb.clone();return this.rotation=b,new r.default(c,d,e,f)},b.prototype.getScaledRect=function(a){var b=this.scale.x;this.scale.x=a,this.scale.y=a,this.updateTransform();var c=this.lt.clone(),d=this.rt.clone(),e=this.rb.clone(),f=this.lb.clone();return this.scale.x=b,this.scale.y=b,new r.default(c,d,e,f)},b.prototype.getScale=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,c=this.width,d=this.height;this.width=a,this.height=b,this.updateTransform();var e=this.scale.x,f=this.scale.y;return this.width=c,this.height=d,{scaleX:e,scaleY:f}},b.prototype.parseSize=function(a){if(a&&""!==a){var b=a.split("x");return new PIXI.Rectangle(0,0,b[0],b[1])}},b.prototype.drawBounds=function(){this.graphics=new PIXI.Graphics,this.graphics.beginFill(16724736,0),this.graphics.lineStyle(1,16724736),this.graphics.drawRect(0,0,this.vector.width,this.vector.height),this.graphics.endFill(),this.graphics.x=-this.vectorHalfWidth,this.graphics.y=-this.vectorHalfHeight,this.addChild(this.graphics)},(0,h.default)(b,[{key:"vectorWidth",set:function(a){this.vector.width=a,this._vectorHalfWidth=this.vector.width/2,this.vector.x=-this.vectorHalfWidth,this.prevVectorRegistrationPoint=this.localLt},get:function(){return this.vector.width}},{key:"vectorHalfWidth",get:function(){return this._vectorHalfWidth}},{key:"vectorHeight",set:function(a){this.vector.height=a,this._vectorHalfHeight=this.vector.height/2,this.vector.y=-this.vectorHalfHeight,this.prevVectorRegistrationPoint=this.localLt},get:function(){return this.vector.height}},{key:"vectorHalfHeight",get:function(){return this._vectorHalfHeight}},{key:"vectorRotation",set:function(a){this.rotation=a;var b=this.localLt,c=this.prevVectorRegistrationPoint;this.pivotOffset=new PIXI.Point(b.x-c.x,b.y-c.y)},get:function(){return this.rotation}},{key:"vector",set:function(a){this._vector=a},get:function(){return this._vector}},{key:"lt",get:function(){return this.toGlobal(this.localLt)}},{key:"rt",get:function(){return this.toGlobal(this.localRt)}},{key:"rb",get:function(){return this.toGlobal(this.localRb)}},{key:"lb",get:function(){return this.toGlobal(this.localLb)}},{key:"center",get:function(){return this.toGlobal(new PIXI.Point)}},{key:"globalPivot",get:function(){return this.toGlobal(this.pivot)}},{key:"localLt",get:function(){return this.toLocal(this.vector.lt,this.vector)}},{key:"localRt",get:function(){return this.toLocal(this.vector.rt,this.vector)}},{key:"localRb",get:function(){return this.toLocal(this.vector.rb,this.vector)}},{key:"localLb",get:function(){return this.toLocal(this.vector.lb,this.vector)}},{key:"distanceBetweenLtAndCenter",get:function(){if(!this.registrationPoint)return new PIXI.Point(0,0);var a=this.localLt;return new PIXI.Point(this.registrationPoint.x-a.x,this.registrationPoint.y-a.y)}},{key:"left",get:function(){for(var a=this.vector.points,b=this.toGlobal(this.toLocal(a[0],this.vector)),c=1;c<a.length;c++){var d=this.toGlobal(this.toLocal(a[c],this.vector));d.x<b.x&&(b=d)}return b.x}},{key:"right",get:function(){for(var a=this.vector.points,b=this.toGlobal(this.toLocal(a[0],this.vector)),c=1;c<a.length;c++){var d=this.toGlobal(this.toLocal(a[c],this.vector));d.x>b.x&&(b=d)}return b.x}},{key:"top",get:function(){for(var a=this.vector.points,b=this.toGlobal(this.toLocal(a[0],this.vector)),c=1;c<a.length;c++){var d=this.toGlobal(this.toLocal(a[c],this.vector));d.y<b.y&&(b=d)}return b.y}},{key:"bottom",get:function(){for(var a=this.vector.points,b=this.toGlobal(this.toLocal(a[0],this.vector)),c=1;c<a.length;c++){var d=this.toGlobal(this.toLocal(a[c],this.vector));d.y>b.y&&(b=d)}return b.y}},{key:"points",get:function(){return{lt:this.lt.clone(),rt:this.rt.clone(),rb:this.rb.clone(),lb:this.lb.clone()}}},{key:"collisionRect",get:function(){return new r.default(this.lt,this.rt,this.rb,this.lb)}}]),b}(PIXI.Container));b.default=x},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(2),h=d(g),i=c(1),j=d(i),k=c(3),l=d(k),m=c(57),n=d(m),o=c(15),p=d(o),q=c(141),r=d(q),s=c(195),t=d(s),u=function(a){function b(c){var d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.default.NONE;(0,f.default)(this,b);var g=(0,h.default)(this,a.call(this));return g.type=c,g.options=d,g.photoEditor=d.photoEditor,g.rotationControlType=e,g.rotationCursorList=d.rotationCursorList,g.initialize(),g.render(),g.addCursorEvent(),g.addMouseDownEvent(),g}return(0,l.default)(b,a),(0,j.default)(b,null,[{key:"DELETE",get:function(){return"delete"}},{key:"MOVE_START",get:function(){return"moveStart"}},{key:"MOVE",get:function(){return"move"}},{key:"MOVE_END",get:function(){return"moveEnd"}},{key:"ROTATE_START",get:function(){return"rotateStart"}},{key:"ROTATE",get:function(){return"rotate"}},{key:"ROTATE_END",get:function(){return"rotateEnd"}},{key:"CHANGE_ROTATION_CURSOR",get:function(){return"changeRotationCursor"}},{key:"RECTANGLE_SIZE",get:function(){return 9}}]),b.prototype.initialize=function(){this._enable=!0,this.currentRadian=0,this.currentRotation=0,this.drawAlpha=0,this.buttonMode=!0,this.interactive=!0,this.defaultCursor="inherit",this._isMouseDown=!1,this.hasMouseMoveEvent=!1,this._localPoint=new PIXI.Point,this.g=this.graphics=new PIXI.Graphics,this.addChild(this.graphics),this.ticker=PIXI.ticker.shared},b.prototype.render=function(){switch(this.type){case r.default.TOP_LEFT:case r.default.TOP_CENTER:case r.default.TOP_RIGHT:case r.default.MIDDLE_LEFT:case r.default.MIDDLE_RIGHT:case r.default.BOTTOM_LEFT:case r.default.BOTTOM_CENTER:case r.default.BOTTOM_RIGHT:case r.default.MIDDLE_CENTER:this.drawControl();break;case r.default.ROTATION:this.drawRotation();break;case r.default.DELETE:this.drawDeleteButton()}},b.prototype.destroy=function(){this.removeCursorEvent(),this.removeMouseDownEvent(),this.removeMouseMoveEvent(),this.ticker=null,this.removeChild(this.g),this.g.destroy(),this.g=this.graphics=null,this.deleteTexture&&this.deleteTexture.destroy(),this.deleteOverTexture&&this.deleteOverTexture.destroy(),this.texture&&this.texture.destroy(),this.type=this.options=this.photoEditor=this.rotationControlType=this.rotationCursorList=null,a.prototype.destroy.call(this)},b.prototype.drawControl=function(){var a=b.RECTANGLE_SIZE,c=a/2;this.g.clear(),this.g.beginFill(16724991,this.drawAlpha),this.g.drawRect(-5,-5,10,10),this.g.beginFill(16777215,1),this.g.drawRect(-c,-c,a,a),this.g.beginFill(0,1),this.g.drawRect(-3.5,-3.5,7,7),this.g.endFill()},b.prototype.drawCenter=function(a,b,c){this.rotation=a,this.g.clear(),this.g.beginFill(16724991,this.drawAlpha),this.g.drawRect(-b/2,-c/2,b,c),this.g.endFill()},b.prototype.drawRotation=function(){this.g.clear(),this.g.beginFill(16724736,this.drawAlpha),this.g.drawRect(-11,-11,22,22),this.g.endFill()},b.prototype.drawDeleteButton=function(){this.deleteTexture=PIXI.Texture.fromImage("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABsAAAAbCAYAAACN1PRVAAAB2UlEQVRIie2VTUsqYRTHj2M4MhHUIKLDCC58QxHdulHEnWsXfYco0kUUVHKDXqgJLtw2fYC+haDixpUgA8KIgsj4Hm1qTCf03EW3W9xL40yCtPC/eRbnPOd3Dvyf8+gA4AYWpJU/5/0CWCZiAZC/WsKWsK/DotEoPZlMjg0Gg25WIURMzwXLZrMPLpfrajQaHVutVoMSiCTJk7lgAAD1ev05Fov9arVaB6FQaP1jLBKJ0IiYttlsF7Is49wwgNcJE4nEbaFQ2Ha73dQbKJfLbdM0fSqK4lhNHR287kZV64plWbLZbO47nc7LWq22ZzabzwaDwYuauwBgWpmd8y5RFMcEQfxAxHQymbzTAAIAjdYPh8MbiJj2+/3XHMdtqnGpZpjRaCTsdrsxn8/v+Hw+rlKpPAWDwZ/D4fDQ4/GsEoS6nvUAEAeAoVJSPB43F4vFXYvFct5oNEaICP1+X65Wq7VMJrPF83xVEIQnREVDUjMNQlEUIUnSEcMw551OR/43HggE1kqlUtLr9XKCICg1rfyfsSxLSpJ05HA4Lnu93n8gAIByufyo1+tPeJ7fTaVSTqV6mqyvJIZhyG63O55Op5+laLO+ktrt9syH/X22/hL2LWFvbjQtAvYb9NC0/9Sr3AYAAAAASUVORK5CYII="),this.deleteOverTexture=PIXI.Texture.fromImage("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABsAAAAbCAYAAACN1PRVAAABCElEQVRIie3UvWrDMBDA8VNtD8EfIojYwlPA0Rrw4HcIef9XyRAh9O/SlgaaWC4htGDBLcdJP4HupEQEedF6exW0Yiv2jzDnnIQQJMuy2YMgbVx5FMYYYozUdX23BiDLsofnfMRsAc45Yozs9/ub/OFwAEBrnQKlYSLCOI5479ntdjfQZrNJhdIxEUFrTYwRYwwAZVkugZZh39/odDot3rcIG4YBAGst1+s1tSmWYXmes91uAei6DqUU1lq897Rti1LqedjxeASgqqqb/DRNeO8ZxzEVfFxQFAXA3Tnr+54QwleX/hrTWgNgjJm9+eVy4Xw+P78bf4qmaWYvpD7FV6y/8+uv2Iq9A1yTczX16ka0AAAAAElFTkSuQmCC"),this.texture=this.deleteTexture},b.prototype.hideAllRotationCursor=function(){if(this.type===r.default.ROTATION)for(var a=this.rotationCursorList.length,b=0;b<a;b++)this.rotationCursorList[b].visible=!1},b.prototype.getFlipRotation=function(a){if(this.photoEditor){var b=this.photoEditor.croppedScaleX,c=this.photoEditor.croppedScaleY;-1==b&&1==c?a*=-1:1==b&&-1==c&&(a*=-1)}return a},b.prototype.addCursorEvent=function(){this.mouseover=this.onMouseOver.bind(this),this.mouseout=this.onMouseOut.bind(this),this.mousemove=this.onMouseOverMove.bind(this)},b.prototype.removeCursorEvent=function(){this.mouseover=this.mouseout=this.mousemove=null},b.prototype.addMouseDownEvent=function(){this._mouseDownListener=this.onMouseDown.bind(this),this.on("mousedown",this._mouseDownListener)},b.prototype.removeMouseDownEvent=function(){this.off("mousedown",this._mouseDownListener)},b.prototype.addMouseMoveEvent=function(){!0!==this.hasMouseMoveEvent&&(this.hasMouseMoveEvent=!0,this._mouseMoveListener=this.onMouseMove.bind(this),this._mouseUpListener=this.onMouseUp.bind(this),this.ticker.add(this._mouseMoveListener))},b.prototype.removeMouseMoveEvent=function(){this.hasMouseMoveEvent=!1,this.ticker.remove(this._mouseMoveListener),window.document.removeEventListener("mouseup",this._mouseUpListener)},b.prototype.onMouseDown=function(a){a.stopPropagation(),this._isMouseDown=!0;var c=n.default.global;this.mouseDownPoint=c.clone(),this.prevMousePoint=this.currentMousePoint=c,this.targetPrevMousePoint=this.targetCurrentMousePoint=this.targetLayer.toLocal(c),this.type===r.default.ROTATION?(this.prevRotation=this.currentRotation=p.default.getRotation(this.centerPoint.globalPoint,c),this.currentRadian=p.default.toRadians(this.currentRotation),this.emit(b.ROTATE_START,{target:this,type:this.type,currentRadian:this.currentRadian,currentRotation:this.currentRotation,currentMousePoint:this.currentMousePoint})):this.emit(b.MOVE_START,{target:this,type:this.type,currentMousePoint:this.currentMousePoint,targetCurrentMousePoint:this.targetCurrentMousePoint}),this.addMouseMoveEvent(),window.document.addEventListener("mouseup",this._mouseUpListener),this.prevMousePoint=this.targetPrevMousePoint=null},b.prototype.onMouseMove=function(a){var c=n.default.global;this.currentMousePoint=c,this.targetCurrentMousePoint=this.targetLayer.toLocal(c),this.prevMousePoint=this.prevMousePoint||this.currentMousePoint,this.targetPrevMousePoint=this.targetPrevMousePoint||this.targetCurrentMousePoint,this.changeMovement={x:this.currentMousePoint.x-this.prevMousePoint.x,y:this.currentMousePoint.y-this.prevMousePoint.y},this.targetChangeMovement={x:this.targetCurrentMousePoint.x-this.targetPrevMousePoint.x,y:this.targetCurrentMousePoint.y-this.targetPrevMousePoint.y},this.moveRotationCursor(),this.type===r.default.ROTATION?(this.currentRotation=p.default.getRotation(this.centerPoint.globalPoint,c),this.changeRotation=this.currentRotation-this.prevRotation,this.absChangeRotation=this.changeRotation<0?-1*this.changeRotation:this.changeRotation,this.absChangeRotation<100&&this.emit(b.ROTATE,{prevRotation:this.prevRotation,changeRotation:this.changeRotation,currentRotation:this.currentRotation,currentRadian:p.default.toRadians(this.currentRotation),changeRadian:p.default.toRadians(this.changeRotation)}),this.emit(b.CHANGE_ROTATION_CURSOR,this.getRotationCursor())):this.emit(b.MOVE,{target:this,type:this.type,prevMousePoint:this.prevMousePoint,changeMovement:this.changeMovement,currentMousePoint:this.currentMousePoint,targetPrevMousePoint:this.targetPrevMousePoint,targetChangeMovement:this.targetChangeMovement,targetCurrentMousePoint:this.targetCurrentMousePoint}),this.prevRotation=this.currentRotation,this.prevMousePoint=this.currentMousePoint,this.targetPrevMousePoint=this.targetCurrentMousePoint},b.prototype.onMouseUp=function(a){this._isMouseDown=!1;var c=n.default.global,d=this.currentMousePoint.x!=this.mouseDownPoint.x&&this.currentMousePoint.y!=this.mouseDownPoint.y;this.currentMousePoint=c,this.targetCurrentMousePoint=this.targetLayer.toLocal(c),this.prevMousePoint=this.prevMousePoint||this.currentMousePoint,this.targetPrevMousePoint=this.targetPrevMousePoint||this.targetCurrentMousePoint,this.changeMovement={x:this.currentMousePoint.x-this.prevMousePoint.x,y:this.currentMousePoint.y-this.prevMousePoint.y},this.targetChangeMovement={x:this.targetCurrentMousePoint.x-this.targetPrevMousePoint.x,y:this.targetCurrentMousePoint.y-this.targetPrevMousePoint.y},this.moveRotationCursor(),this.type===r.default.ROTATION?(this.currentRotation=p.default.getRotation(this.centerPoint.globalPoint,n.default.global),this.changeRotation=this.currentRotation-this.prevRotation,this.absChangeRotation=this.changeRotation<0?-1*this.changeRotation:this.changeRotation,this.absChangeRotation<100&&this.emit(b.ROTATE_END,{target:this,type:this.type,modified:d,prevRotation:this.prevRotation,changeRotation:this.changeRotation,currentRotation:this.currentRotation,currentRadian:p.default.toRadians(this.currentRotation),changeRadian:p.default.toRadians(this.changeRotation)})):this.emit(b.MOVE_END,{target:this,type:this.type,modified:d,prevMousePoint:this.prevMousePoint,changeMovement:this.changeMovement,currentMousePoint:this.currentMousePoint,targetPrevMousePoint:this.targetPrevMousePoint,targetChangeMovement:this.targetChangeMovement,targetCurrentMousePoint:this.targetCurrentMousePoint}),this.removeMouseMoveEvent()},b.prototype.onMouseOver=function(){this.defaultCursor=this.getCursor(),this.type===r.default.DELETE&&(this.texture=this.deleteOverTexture),this.type===r.default.ROTATION&&(this.rotationCursor=this.rotationCursorList[this.cursorIndex],this.moveRotationCursor(),this.rotationCursor.visible=!0)},b.prototype.onMouseOut=function(){this.type===r.default.DELETE&&(this.texture=this.deleteTexture),"none"!==n.default.defaultCursor&&(this.rotationCursor=null,this.hideAllRotationCursor())},b.prototype.onMouseOverMove=function(){this.type===r.default.ROTATION&&this.moveRotationCursor()},b.prototype.moveRotationCursor=function(){if(this.rotationCursor&&null!==this.rotationCursor){var a=this.rotationCursorList[this.cursorIndex];this.rotationCursor!==a&&(this.rotationCursor.visible=!1,this.rotationCursor=a,this.rotationCursor.visible=!0),this.rotationCursor.x=n.default.globalX,this.rotationCursor.y=n.default.globalY}},b.prototype.getAngleIndex=function(){var a=this.angle;return a>337.5&&a<=22.5?0:a>22.5&&a<=67.5?1:a>67.5&&a<=112.5?2:a>112.5&&a<=157.5?3:a>157.5&&a<=202.5?4:a>202.5&&a<=247.5?5:a>247.5&&a<=292.5?6:a>292.5&&a<=337.5?7:0},b.prototype.getCursor=function(){switch(this.type){case r.default.TOP_LEFT:case r.default.TOP_CENTER:case r.default.TOP_RIGHT:case r.default.MIDDLE_LEFT:case r.default.MIDDLE_RIGHT:case r.default.BOTTOM_LEFT:case r.default.BOTTOM_CENTER:case r.default.BOTTOM_RIGHT:return this.getScaleCursor();case r.default.ROTATION:return this.getRotationCursor();case r.default.DELETE:return"pointer";case r.default.MIDDLE_CENTER:return"move"}},b.prototype.getScaleCursor=function(){switch(this.cursorIndex){case 0:return"ns-resize";case 1:return"nesw-resize";case 2:return"ew-resize";case 3:return"nwse-resize";case 4:return"ns-resize";case 5:return"nesw-resize";case 6:return"ew-resize";case 7:return"nwse-resize"}},b.prototype.getRotationCursor=function(){
return"none"},b.prototype.getFlipCursor=function(a){if(!this.photoEditor)return a;if(this.target.scale.x*this.target.scale.y*this.photoEditor.croppedScaleX*this.photoEditor.croppedScaleY<1)switch(a){case 0:return 0;case 1:return 7;case 2:return 6;case 3:return 5;case 4:return 4;case 5:return 3;case 6:return 2;case 7:return 1}return a},b.prototype.getCursorIndex=function(){if(this.type===r.default.ROTATION)return this.getRotationCursorIndex();var a=this.target?this.target.scaleSignX:1,b=this.target?this.target.scaleSignY:1;if(1===a&&1===b)switch(this.type){case r.default.TOP_CENTER:return 0;case r.default.TOP_RIGHT:return 1;case r.default.MIDDLE_RIGHT:return 2;case r.default.BOTTOM_RIGHT:return 3;case r.default.BOTTOM_CENTER:return 4;case r.default.BOTTOM_LEFT:return 5;case r.default.MIDDLE_LEFT:return 6;case r.default.TOP_LEFT:return 7}else if(-1===a&&1===b)switch(this.type){case r.default.TOP_CENTER:return 0;case r.default.TOP_RIGHT:return 7;case r.default.MIDDLE_RIGHT:return 6;case r.default.BOTTOM_RIGHT:return 5;case r.default.BOTTOM_CENTER:return 4;case r.default.BOTTOM_LEFT:return 3;case r.default.MIDDLE_LEFT:return 2;case r.default.TOP_LEFT:return 1}else if(1===a&&-1===b)switch(this.type){case r.default.TOP_CENTER:return 4;case r.default.TOP_RIGHT:return 3;case r.default.MIDDLE_RIGHT:return 2;case r.default.BOTTOM_RIGHT:return 1;case r.default.BOTTOM_CENTER:return 0;case r.default.BOTTOM_LEFT:return 7;case r.default.MIDDLE_LEFT:return 6;case r.default.TOP_LEFT:return 5}else if(-1===a&&-1===b)switch(this.type){case r.default.TOP_CENTER:return 4;case r.default.TOP_RIGHT:return 5;case r.default.MIDDLE_RIGHT:return 6;case r.default.BOTTOM_RIGHT:return 7;case r.default.BOTTOM_CENTER:return 0;case r.default.BOTTOM_LEFT:return 1;case r.default.MIDDLE_LEFT:return 2;case r.default.TOP_LEFT:return 3}else switch(this.type){case r.default.TOP_CENTER:return 0;case r.default.TOP_RIGHT:return 1;case r.default.MIDDLE_RIGHT:return 2;case r.default.BOTTOM_RIGHT:return 3;case r.default.BOTTOM_CENTER:return 4;case r.default.BOTTOM_LEFT:return 5;case r.default.MIDDLE_LEFT:return 6;case r.default.TOP_LEFT:return 7}},b.prototype.getRotationCursorIndex=function(){var a=this.target?this.target.scaleSignX:1,b=this.target?this.target.scaleSignY:1;if(1===a&&1===b)switch(this.rotationControlType){case t.default.TOP_CENTER:return 0;case t.default.TOP_RIGHT:return 1;case t.default.MIDDLE_RIGHT:return 2;case t.default.BOTTOM_RIGHT:return 3;case t.default.BOTTOM_CENTER:return 4;case t.default.BOTTOM_LEFT:return 5;case t.default.MIDDLE_LEFT:return 6;case t.default.TOP_LEFT:case t.default.DELETE:return 7}else if(-1===a&&1===b)switch(this.rotationControlType){case t.default.TOP_CENTER:return 0;case t.default.TOP_RIGHT:return 7;case t.default.MIDDLE_RIGHT:return 6;case t.default.BOTTOM_RIGHT:return 5;case t.default.BOTTOM_CENTER:return 4;case t.default.BOTTOM_LEFT:return 3;case t.default.MIDDLE_LEFT:return 2;case t.default.TOP_LEFT:case t.default.DELETE:return 1}else if(1===a&&-1===b)switch(this.rotationControlType){case t.default.TOP_CENTER:return 4;case t.default.TOP_RIGHT:return 3;case t.default.MIDDLE_RIGHT:return 2;case t.default.BOTTOM_RIGHT:return 1;case t.default.BOTTOM_CENTER:return 0;case t.default.BOTTOM_LEFT:return 7;case t.default.MIDDLE_LEFT:return 6;case t.default.TOP_LEFT:case t.default.DELETE:return 5}else if(-1===a&&-1===b)switch(this.rotationControlType){case t.default.TOP_CENTER:return 4;case t.default.TOP_RIGHT:return 5;case t.default.MIDDLE_RIGHT:return 6;case t.default.BOTTOM_RIGHT:return 7;case t.default.BOTTOM_CENTER:return 0;case t.default.BOTTOM_LEFT:return 1;case t.default.MIDDLE_LEFT:return 2;case t.default.TOP_LEFT:case t.default.DELETE:return 3}else switch(this.rotationControlType){case t.default.TOP_CENTER:return 0;case t.default.TOP_RIGHT:return 1;case t.default.MIDDLE_RIGHT:return 2;case t.default.BOTTOM_RIGHT:return 3;case t.default.BOTTOM_CENTER:return 4;case t.default.BOTTOM_LEFT:return 5;case t.default.MIDDLE_LEFT:return 6;case t.default.TOP_LEFT:case t.default.DELETE:return 7}},b.prototype.hitTestWithGlobalPoint=function(a){var c=void 0,d=this.toLocal(a);return c=this.type!==b.DELETE?this.g.getLocalBounds():this.getLocalBounds(),d.x>=c.x&&d.x<=c.x+c.width&&d.y>=c.y&&d.y<=c.y+c.height},(0,j.default)(b,[{key:"target",set:function(a){this._target=a},get:function(){return this._target}},{key:"transform",set:function(a){this._transform=a},get:function(){return this._transform}},{key:"localPoint",set:function(a){this._localPoint=a},get:function(){return this._localPoint}},{key:"globalPoint",get:function(){return this.transform.apply(this._localPoint)}},{key:"centerPoint",set:function(a){this._centerPoint=a},get:function(){return this._centerPoint}},{key:"angle",get:function(){var a=this.target.worldTransform.clone(),b=p.default.getSkewX(a);return b=b<0?b+360:b}},{key:"cursorIndex",get:function(){return(this.getAngleIndex()+this.getCursorIndex())%8}},{key:"targetLayer",set:function(a){this._targetLayer=a},get:function(){return this._targetLayer}},{key:"isMouseDown",get:function(){return this._isMouseDown}},{key:"enable",set:function(a){this._enable=a,this.visible=a,this.buttonMode=a,this.interactive=a},get:function(){return this._enable}}]),b}(PIXI.Sprite);b.default=u},function(a,b,c){"use strict";b.__esModule=!0;var d=c(0),e=function(a){return a&&a.__esModule?a:{"default":a}}(d),f=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0},c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,f=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,g=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,h=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,j=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,k=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,l=arguments.length>9&&void 0!==arguments[9]?arguments[9]:1;(0,e.default)(this,a),this.pivot=b,this.x=c,this.y=d,this.bitmapWidth=f,this.bitmapHeight=g,this.width=h,this.height=i,this.rotation=j,this.scaleX=k,this.scaleY=l}return a.prototype.clone=function(){return new a({x:this.pivot.x,y:this.pivot.y},this.x,this.y,this.bitmapWidth,this.bitmapHeight,this.width,this.height,this.rotation,this.scaleX,this.scaleY)},a.prototype.toString=function(){var a="BackgroundImageRestoreVO[pivot["+this.pivot.x+", "+this.pivot.y+"], "+this.x+", "+this.y+", "+this.bitmapWidth+", "+this.bitmapHeight+", "+this.width+", "+this.height+", "+this.rotation+", "+this.scaleX+", "+this.scaleY+"]";return void 0,a},a}();b.default=f},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(1),h=d(g),i=c(197),j=d(i),k=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j.default.NONE,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;(0,f.default)(this,a),this._type=b,this.offsetX=c,this.offsetY=d}return a.prototype.reset=function(){this.offsetX=0,this.offsetY=0,this._type=j.default.NONE},a.prototype.clone=function(){return new a(this.type,this.offsetX,this.offsetY)},(0,h.default)(a,[{key:"type",set:function(a){this._type===j.default.NONE?this._type=a:this._type=this._type+(a.substr(0,1).toUpperCase()+a.substr(1))},get:function(){return this._type}}]),a}();b.default=k},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(1),h=d(g),i=c(2),j=d(i),k=c(3),l=d(k),m=c(347),n=d(m),o=c(15),p=(d(o),c(78)),q=(d(p),c(139)),r=d(q),s=c(63),t=d(s),u=c(140),v=d(u),w=c(80),x=(d(w),function(a){function b(c){(0,f.default)(this,b);var d=(0,j.default)(this,a.call(this));return d._initialize(c),d._addEvent(),d}return(0,l.default)(b,a),b.prototype._initialize=function(a){this.canvas=new n.default(a),this.addChild(this.canvas),this._canvasHalfWidth=0,this._canvasHalfHeight=0,this.pivotOffset=new PIXI.Point},b.prototype._addEvent=function(){this._canvasTextureUpdateListener=this.onCanvasTextureUpdateComplete.bind(this),this._canvasTransfromCompleteListener=this.onCanvasTransformComplete.bind(this),this.canvas.on(n.default.TEXTURE_UPDATE,this._canvasTextureUpdateListener),this.on(v.default.TRANSFORM_COMPLETE,this._canvasTransfromCompleteListener)},b.prototype.setDefaultMaskSize=function(a){var b=this.parseSize(a.defaultSize);this.setImageSize(b.width,b.height)},b.prototype.setImageSize=function(a,b){this.canvas.setImageSize(a,b),this.setContainer()},b.prototype.setContainer=function(){this.addRegistrationPoint(),this._canvasHalfWidth=this.canvas.width/2,this._canvasHalfHeight=this.canvas.height/2,this.canvas.x=-this.canvasHalfWidth,this.canvas.y=-this.canvasHalfHeight},b.prototype.addRegistrationPoint=function(){this.registrationPoint||(this.registrationPoint=t.default.getCircle(0,0,0,5025616),this.addChild(this.registrationPoint))},b.prototype.hitTestWithGlobalPoint=function(a){var b=this.toLocal(a),c=this.getLocalBounds();return b.x>=c.x&&b.x<=c.x+c.width&&b.y>=c.y&&b.y<=c.y+c.height},b.prototype.setPivot=function(a){this.pivot=a},b.prototype.onCanvasTextureUpdateComplete=function(){this._canvasHalfWidth=this.canvas.width/2,this._canvasHalfHeight=this.canvas.height/2,this.canvas.x=-this.canvasHalfWidth,this.canvas.y=-this.canvasHalfHeight,this.scale=new PIXI.Point(1,1),this.emit(v.default.TEXTURE_UPDATE)},b.prototype.onCanvasTransformComplete=function(a){"middleCenter"!==a.type&&this.canvas.setImageSize(this.width,this.height)},b.prototype.getMovedRect=function(a,b){var c=this.lt,d=this.rt,e=this.rb,f=this.lb;return c.x+=a,c.y+=b,d.x+=a,d.y+=b,e.x+=a,e.y+=b,f.x+=a,f.y+=b,new r.default(c,d,e,f)},b.prototype.getRotatedRect=function(a){var b=this.rotation;this.rotation=a,this.updateTransform();var c=this.lt.clone(),d=this.rt.clone(),e=this.rb.clone(),f=this.lb.clone();return this.rotation=b,new r.default(c,d,e,f)},b.prototype.getScaledRect=function(a){var b=this.scale.x;this.scale.x=a,this.scale.y=a,this.updateTransform();var c=this.lt.clone(),d=this.rt.clone(),e=this.rb.clone(),f=this.lb.clone();return this.scale.x=b,this.scale.y=b,new r.default(c,d,e,f)},b.prototype.getScale=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,c=this.width,d=this.height;this.width=a,this.height=b,this.updateTransform();var e=this.scale.x,f=this.scale.y;return this.width=c,this.height=d,{scaleX:e,scaleY:f}},b.prototype.parseSize=function(a){if(a&&""!==a){var b=a.split("x");return new PIXI.Rectangle(0,0,b[0],b[1])}},b.prototype.drawBounds=function(){this.graphics=new PIXI.Graphics,this.graphics.beginFill(16724736,0),this.graphics.lineStyle(1,16724736),this.graphics.drawRect(0,0,this.canvas.width,this.canvas.height),this.graphics.endFill(),this.graphics.x=-this.canvasHalfWidth,this.graphics.y=-this.canvasHalfHeight,this.addChild(this.graphics)},(0,h.default)(b,[{key:"lt",get:function(){return this.toGlobal(this.localLt)}},{key:"rt",get:function(){return this.toGlobal(this.localRt)}},{key:"rb",get:function(){return this.toGlobal(this.localRb)}},{key:"lb",get:function(){return this.toGlobal(this.localLb)}},{key:"center",get:function(){return this.toGlobal(new PIXI.Point)}},{key:"globalPivot",get:function(){return this.toGlobal(this.pivot)}},{key:"localLt",get:function(){return this.toLocal(this.canvas.lt,this.canvas)}},{key:"localRt",get:function(){return this.toLocal(this.canvas.rt,this.canvas)}},{key:"localRb",get:function(){return this.toLocal(this.canvas.rb,this.canvas)}},{key:"localLb",get:function(){return this.toLocal(this.canvas.lb,this.canvas)}},{key:"distanceBetweenLtAndCenter",get:function(){if(!this.registrationPoint)return new PIXI.Point(0,0);var a=this.localLt;return new PIXI.Point(this.registrationPoint.x-a.x,this.registrationPoint.y-a.y)}},{key:"left",get:function(){for(var a=this.canvas.points,b=this.toGlobal(this.toLocal(a[0],this.canvas)),c=1;c<a.length;c++){var d=this.toGlobal(this.toLocal(a[c],this.canvas));d.x<b.x&&(b=d)}return b.x}},{key:"right",get:function(){for(var a=this.canvas.points,b=this.toGlobal(this.toLocal(a[0],this.canvas)),c=1;c<a.length;c++){var d=this.toGlobal(this.toLocal(a[c],this.canvas));d.x>b.x&&(b=d)}return b.x}},{key:"top",get:function(){for(var a=this.canvas.points,b=this.toGlobal(this.toLocal(a[0],this.canvas)),c=1;c<a.length;c++){var d=this.toGlobal(this.toLocal(a[c],this.canvas));d.y<b.y&&(b=d)}return b.y}},{key:"bottom",get:function(){for(var a=this.canvas.points,b=this.toGlobal(this.toLocal(a[0],this.canvas)),c=1;c<a.length;c++){var d=this.toGlobal(this.toLocal(a[c],this.canvas));d.y>b.y&&(b=d)}return b.y}},{key:"canvasHalfWidth",get:function(){return this._canvasHalfWidth}},{key:"canvasHalfHeight",get:function(){return this._canvasHalfHeight}},{key:"points",get:function(){return{lt:this.lt.clone(),rt:this.rt.clone(),rb:this.rb.clone(),lb:this.lb.clone()}}},{key:"collisionRect",get:function(){return new r.default(this.lt,this.rt,this.rb,this.lb)}}]),b}(PIXI.Container));b.default=x},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(2),h=d(g),i=c(1),j=d(i),k=c(3),l=d(k),m=c(63),n=d(m),o=function(a){function b(c){(0,f.default)(this,b);var d=(0,h.default)(this,a.call(this));return d.textureCanvas=c,d.initialize(),d}return(0,l.default)(b,a),(0,j.default)(b,null,[{key:"TEXTURE_UPDATE",get:function(){return"textureUpdate"}}]),b.prototype.initialize=function(){this.createImage(),this.createPoints()},b.prototype.setImageSize=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;this.imageWidth=a,this.imageHeight=b,this.update(),this.notifyTextureUpdate()},b.prototype.createImage=function(){this.image=new PIXI.Sprite(new PIXI.Texture.fromCanvas(this.textureCanvas)),this.addChild(this.image)},b.prototype.createPoints=function(){this.lt=this.registrationPoint=n.default.getRectangle(0,0,0),this.rt=n.default.getRectangle(-0,0,0),this.rb=n.default.getRectangle(-0,-0,0),this.lb=n.default.getRectangle(0,-0,0),this.points=[this.lt,this.rt,this.rb,this.lb],this.addChild(this.lt),this.addChild(this.rt),this.addChild(this.rb),this.addChild(this.lb)},b.prototype.update=function(){this.image.texture.update(),this.image.updateTransform(),this.updatePoints()},b.prototype.updatePoints=function(){this.rt.x=this.rb.x=this.imageWidth,this.rb.y=this.lb.y=this.imageHeight},b.prototype.notifyTextureUpdate=function(){this.emit(b.TEXTURE_UPDATE,{target:this})},b}(PIXI.Container);b.default=o},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(1),h=d(g),i=c(2),j=d(i),k=c(3),l=d(k),m=c(79),n=d(m),o=c(15),p=d(o),q=function(a){function b(c,d){(0,f.default)(this,b);var e=(0,j.default)(this,a.call(this));return e.maskShape=c,e.backgroundImage=d,e.initialize(),e}return(0,l.default)(b,a),b.prototype.initialize=function(){this.isAddRender=!1,this.isRenderStart=!1,this.isDisplayPunchImage=!0,this.isDisplayDimmedImage=!1,this.createRenderedSprite(),this.rotationPivot=new PIXI.Point(0,0)},b.prototype.createPunchCanvas=function(){if(!this.backCanvas){var a=this.backCanvas=document.createElement("canvas");a.width=n.default.maskMaxWidth,a.height=n.default.maskMaxHeight,a.style.display="none",document.body.appendChild(a),this.backCtx=a.getContext("2d");var b=this.maskCanvas=document.createElement("canvas");b.width=n.default.maskMaxWidth,b.height=n.default.maskMaxHeight,b.style.display="none",document.body.appendChild(b),this.maskCtx=b.getContext("2d"),this.contextImageSmoothingEnabledSetting(this.backCtx,!0),this.contextImageSmoothingEnabledSetting(this.maskCtx,!0)}},b.prototype.removePunchCanvas=function(){this.backCanvas&&(document.body.removeChild(this.backCanvas),document.body.removeChild(this.maskCanvas)),this.backCanvas=this.maskCanvas=this.backCtx=this.maskCtx=null},b.prototype.createDimmedCanvas=function(){this.dimmedCanvas=document.createElement("canvas"),this.dimmedCanvas.width=n.default.canvasLimitWidth,this.dimmedCanvas.height=n.default.canvasLimitHeight,this.dimmedCtx=this.dimmedCanvas.getContext("2d"),this.dimmedCanvas.style.display="none",document.body.appendChild(this.dimmedCanvas),this.contextImageSmoothingEnabledSetting(this.dimmedCtx,!0)},b.prototype.removeDimmedCanvas=function(){this.dimmedCanvas&&document.body.appendChild(this.dimmedCanvas)},b.prototype.createRenderedSprite=function(){this.isDisplayPunchImage?this.renderedSprite=new PIXI.Sprite(PIXI.Texture.fromCanvas(this.maskCanvas)):this.renderedSprite=new PIXI.Sprite(PIXI.Texture.fromCanvas(this.dimmedCanvas)),this.addChild(this.renderedSprite)},b.prototype.removeRenderedSprite=function(){this.renderedSprite&&(this.removeChild(this.renderedSprite),this.renderedSprite.texture.destroy(),this.renderedSprite.texture=null,this.renderedSprite.destroy(),this.renderedSprite=null)},b.prototype.displayPunchImage=function(){this.isDisplayPunchImage=!0,this.isDisplayDimmedImage=!1},b.prototype.displayDimmedImage=function(){this.isDisplayPunchImage=!1,this.isDisplayDimmedImage=!0},b.prototype.destroy=function(){this.stopRender(),this.removeRenderedSprite(),this.removePunchCanvas(),this.removeDimmedCanvas(),this.maskShape=this.backgroundImage=null},b.prototype.render=function(){if(this.visible)if(this.clearCanvas(),this.isDisplayPunchImage){this.drawPunchImage();var a=this.maskShape.lt;this.renderedSprite.x=a.x,this.renderedSprite.y=a.y,this.renderedSprite.texture.update()}else this.isDisplayDimmedImage&&(this.drawDimmedBackground(),this.drawMask("destination-out"),this.renderedSprite.x=0,this.renderedSprite.y=0)},b.prototype.startRender=function(){this.addRender(),this.isRenderStart=!0},b.prototype.stopRender=function(){this.removeRender(),this.isRenderStart=!1},b.prototype.addRender=function(){this.removeRender(),this.isAddRender=!0,PIXI.ticker.shared.add(this.render,this)},b.prototype.removeRender=function(){this.isAddRender&&PIXI.ticker.shared.remove(this.render,this),this.isAddRender=!1},b.prototype.clearCanvas=function(){this.isDisplayPunchImage?this.backCtx.globalCompositeOperation=this.maskCtx.globalCompositeOperation="source-over":this.isDisplayDimmedImage&&(this.dimmedCanvas.width=this.dimmedCanvas.width,this.dimmedCanvas.height=this.dimmedCanvas.height,this.dimmedCtx.globalCompositeOperation="source-over")},b.prototype.drawBackground=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"source-over";this.dimmedCtx.save(),this.dimmedCtx.globalCompositeOperation=a,this.dimmedCtx.rotate(this.backgroundImage.rotation),this.dimmedCtx.translate(-this.backgroundImage.bitmapHalfWidth,-this.backgroundImage.bitmapHalfHeight);var b=this.backgroundImage.distanceBetweenLtAndCenter;this.dimmedCtx.translate(b.x,b.y);var c=this.backgroundImage.lt,d=p.default.getRotationPointWithPivot(this.rotationPivot,c,-p.default.toDegrees(this.backgroundImage.bitmapRotation));this.dimmedCtx.translate(d.x,d.y);var e=this.backgroundImage.scale.x,f=this.backgroundImage.scale.y,g=this.backgroundImage.bitmapWidth*e,h=this.backgroundImage.bitmapHeight*f;this.dimmedCtx.drawImage(this.backgroundImage.bitmap.textureCanvas,0,0,g,h),this.dimmedCtx.restore()},b.prototype.drawDimmedBackground=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"source-over";this.dimmedCtx.save(),this.dimmedCtx.globalCompositeOperation=a,this.dimmedCtx.rotate(this.backgroundImage.rotation);var b=this.backgroundImage.scale.x,c=this.backgroundImage.scale.y,d=this.backgroundImage.bitmapWidth*b,e=this.backgroundImage.bitmapHeight*c,f=this.backgroundImage.bitmapHalfWidth*b,g=this.backgroundImage.bitmapHalfHeight*c;this.dimmedCtx.translate(-f,-g);var h=this.backgroundImage.distanceBetweenLtAndCenter;h.x=h.x*b,h.y=h.y*c,this.dimmedCtx.translate(h.x,h.y);var i=this.backgroundImage.lt,j=p.default.getRotationPointWithPivot(this.rotationPivot,i,-p.default.toDegrees(this.backgroundImage.bitmapRotation));this.dimmedCtx.translate(j.x,j.y),this.dimmedCtx.globalAlpha=.83,this.dimmedCtx.fillStyle="#000000",this.dimmedCtx.fillRect(-1,-1,d+2,e+2),this.dimmedCtx.restore()},b.prototype.drawMask=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"source-over";this.dimmedCtx.save(),this.dimmedCtx.globalCompositeOperation=a;var b=this.maskShape.lt;this.dimmedCtx.translate(b.x,b.y),this.maskShape.bitmap?this.dimmedCtx.drawImage(this.maskShape.bitmap.textureCanvas,0,0,this.maskShape.scale.x*this.maskShape.bitmapWidth,this.maskShape.scale.y*this.maskShape.bitmapHeight):this.dimmedCtx.drawImage(this.maskShape.vector.canvgCanvas,0,0,this.maskShape.width,this.maskShape.height,0,0,this.maskShape.width,this.maskShape.height),this.dimmedCtx.restore(),this.renderedSprite.x=b.x,this.renderedSprite.y=b.y},b.prototype.drawPunchImage=function(){var a=this.maskShape,b=void 0,c=void 0,d=void 0,e=void 0,f=void 0;this.maskShape.bitmap?(b=a.originalImageSize,c=b.width/a.width,d=b.height/a.height,e=a.width*c,f=a.height*d):(e=a.width,f=a.height);var g=this.backgroundImage,h=g.originalImageSize,i=h.width/g.width,j=h.height/g.height,k=g.width*i,l=g.height*j,m=a.width,n=a.height;this.backCanvas.width=e,this.backCanvas.height=f,this.maskCanvas.width=e,this.maskCanvas.height=f,this.backCtx.save();var o=a.globalPivot.x-g.lt.x,q=a.globalPivot.y-g.lt.y;this.backCtx.translate(-o,-q),this.backCtx.rotate(g.rotation);var r=a.lt,s=a.globalPivot,t=s.x-r.x,u=s.y-r.y;this.backCtx.translate(t,u);var v=p.default.getRotationPointWithPivot(a.globalPivot,a.lt,-p.default.toDegrees(g.rotation)),w=a.lt.x-v.x,x=a.lt.y-v.y;this.backCtx.translate(w,x),this.backCtx.drawImage(g.bitmap.textureCanvas,0,0,k,l,0,0,g.width,g.height),this.backCtx.restore(),this.maskCtx.save(),this.maskCtx.drawImage(this.backCanvas,0,0),this.maskCtx.globalCompositeOperation="destination-in",this.maskShape.bitmap?this.maskCtx.drawImage(a.bitmap.textureCanvas,0,0,e,f,0,0,m,n):this.maskCtx.drawImage(a.canvas.textureCanvas,0,0,e,f),this.maskCtx.restore()},b.prototype.drawPunchImageSingle=function(){var a=this.maskShape,b=void 0,c=void 0,d=void 0,e=void 0,f=void 0;this.maskShape.bitmap?(b=a.originalImageSize,c=b.width/a.width,d=b.height/a.height,e=a.width*c,f=a.height*d):(e=a.width,f=a.height);var g=this.backgroundImage,h=g.originalImageSize,i=h.width/g.width,j=h.height/g.height,k=g.width*i,l=g.height*j;a.width,a.height;this.backCanvas.width=e,this.backCanvas.height=f,this.backCtx.save();var m=a.globalPivot.x-g.lt.x,n=a.globalPivot.y-g.lt.y;this.backCtx.translate(-m,-n),this.backCtx.rotate(g.rotation);var o=a.lt,q=a.globalPivot,r=q.x-o.x,s=q.y-o.y;this.backCtx.translate(r,s);var t=p.default.getRotationPointWithPivot(a.globalPivot,a.lt,-p.default.toDegrees(g.rotation)),u=a.lt.x-t.x,v=a.lt.y-t.y;this.backCtx.translate(u,v),this.backCtx.drawImage(g.bitmap.textureCanvas,0,0,k,l,0,0,g.width,g.height),this.backCtx.globalCompositeOperation="destination-in",this.backCtx.setTransform(1,0,0,1,0,0),this.backCtx.drawImage(a.vector.canvgCanvas,0,0,e,f),this.backCtx.restore()},b.prototype.changeMask=function(a){this.maskShape=a},b.prototype.getVisibleSizeMaskCanvas=function(){var a=this.maskShape,b=void 0,c=void 0,d=void 0,e=void 0,f=void 0;this.maskShape.bitmap?(b=a.originalImageSize,c=b.width/a.width,d=b.height/a.height,e=a.width*c,f=a.height*d):(e=a.width,f=a.height);var g=this.backgroundImage,h=g.originalImageSize,i=h.width/g.width,j=h.height/g.height,k=g.width*i,l=g.height*j,m=a.width,n=a.height;this.backCanvas.width=g.width,this.backCanvas.height=g.height,this.maskCanvas.width=m,this.maskCanvas.height=n,this.backCtx.save(),this.backCtx.clearRect(0,0,this.backCanvas.width,this.backCanvas.height);var o=a.globalPivot.x-g.lt.x,q=a.globalPivot.y-g.lt.y;this.backCtx.translate(-o,-q),this.backCtx.rotate(g.rotation);var r=a.lt,s=a.globalPivot,t=s.x-r.x,u=s.y-r.y;this.backCtx.translate(t,u);var v=p.default.getRotationPointWithPivot(a.globalPivot,a.lt,-p.default.toDegrees(g.rotation)),w=a.lt.x-v.x,x=a.lt.y-v.y;return this.backCtx.translate(w,x),this.backCtx.drawImage(g.bitmap.textureCanvas,0,0,k,l,0,0,g.width,g.height),this.backCtx.restore(),this.maskCtx.save(),this.maskCtx.clearRect(0,0,m,n),this.maskCtx.drawImage(this.backCanvas,0,0),this.maskCtx.globalCompositeOperation="destination-in",this.maskShape.bitmap?this.maskCtx.drawImage(a.bitmap.textureCanvas,0,0,e,f,0,0,m,n):this.maskCtx.drawImage(a.vector.canvgCanvas,0,0,e,f,0,0,m,n),this.maskCtx.restore(),this.maskCanvas},b.prototype.getRealSizeMaskCanvas=function(){var a=this.maskShape,b=void 0,c=void 0,d=void 0,e=void 0,f=void 0;this.maskShape.bitmap?(b=a.originalImageSize,c=b.width/a.width,d=b.height/a.height,e=a.width*c,f=a.height*d):(e=a.width,f=a.height);var g=this.backgroundImage,h=g.originalImageSize,i=h.width/g.width,j=h.height/g.height,k=g.width*i,l=g.height*j,m=a.width*i,n=a.height*j,o=m,q=n;this.backCanvas.width=k,this.backCanvas.height=l,this.maskCanvas.width=o,this.maskCanvas.height=q,this.backCtx.save(),this.backCtx.clearRect(0,0,k,l);var r=(a.globalPivot.x-g.lt.x)*i,s=(a.globalPivot.y-g.lt.y)*j;this.backCtx.translate(-r,-s),this.backCtx.rotate(g.rotation);var t=a.lt,u=a.globalPivot,v=(u.x-t.x)*i,w=(u.y-t.y)*j;this.backCtx.translate(v,w);var x=p.default.getRotationPointWithPivot(a.globalPivot,a.lt,-p.default.toDegrees(g.rotation)),y=(a.lt.x-x.x)*i,z=(a.lt.y-x.y)*j;return this.backCtx.translate(y,z),this.backCtx.drawImage(g.bitmap.textureCanvas,0,0),this.backCtx.restore(),this.maskCtx.save(),this.maskCtx.clearRect(0,0,o,q),this.maskCtx.drawImage(this.backCanvas,0,0),this.maskCtx.globalCompositeOperation="destination-in",this.maskShape.bitmap?this.maskCtx.drawImage(a.bitmap.textureCanvas,0,0,e,f,0,0,o,q):this.maskCtx.drawImage(a.vector.canvgCanvas,0,0,e,f,0,0,o,q),this.maskCtx.restore(),this.maskCanvas},b.prototype.getTransform=function(){var a=this.maskShape,b=this.backgroundImage,c=b.originalImageSize,d=c.width/b.width,e=c.height/b.height,f=a.width*d,g=a.height*e;b.bitmap.displayObjectUpdateTransform(),b.bitmap.image.displayObjectUpdateTransform();var h=b.bitmap.image.toLocal(a.lt);return{maskWidth:f,maskHeight:g,x:0,y:0,offsetX:h.x,offsetY:h.y,scaleX:1,scaleY:1,radian:b.rotation}},b.prototype.getTransformRealSize=function(a){var b=this.maskShape,c=this.backgroundImage,d=b.points,e=a.worldTransform.matrix,f=p.default.convertCanvasMatrixToPixiMatrix(e);c.bitmap.displayObjectUpdateTransform(),c.bitmap.image.displayObjectUpdateTransform();var g=c.bitmap.image.worldTransform.clone();g.append(f);var h=p.default.toLocalPoints(g,d),i=p.default.getSizeByPoints(h),j=i.width,k=i.height;return j=j+.5|0,k=k+.5|0,{maskWidth:j,maskHeight:k,x:0,y:0,offsetX:Math.round(h.lt.x),offsetY:Math.round(h.lt.y),scaleX:1,scaleY:1,radian:c.rotation}},b.prototype.getTransformVisibleSize=function(a){var b=this.maskShape,c=this.backgroundImage,d=b.points,e=a.worldTransform,f=Math.abs(e.scaleX),g=Math.abs(e.scaleY),h=(new PIXI.Matrix).set(f,0,0,g,0,0);c.bitmap.displayObjectUpdateTransform(),c.bitmap.image.displayObjectUpdateTransform();var i=c.bitmap.image.worldTransform.clone();i.append(h);var j=p.default.toLocalPoints(i,d),k=Math.round(j.lt.x),l=Math.round(j.lt.y),m=Math.sqrt(i.a*i.a+i.b*i.b),n=Math.sqrt(i.c*i.c+i.d*i.d);return{maskWidth:b.width,maskHeight:b.height,x:0,y:0,offsetX:k,offsetY:l,scaleX:m,scaleY:n,radian:c.rotation}},b.prototype.contextImageSmoothingEnabledSetting=function(a){var b=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];a.imageSmoothingEnabled?a.imageSmoothingEnabled=b:a.oImageSmoothingEnabled?a.oImageSmoothingEnabled=b:a.msImageSmoothingEnabled?a.msImageSmoothingEnabled=b:a.mozImageSmoothingEnabled?a.mozImageSmoothingEnabled=b:a.webkitImageSmoothingEnabled&&(a.webkitImageSmoothingEnabled=b)},(0,h.default)(b,[{key:"isAvailable",get:function(){return!(!this.maskShape||!this.backgroundImage)}},{key:"isDisplayPunchImage",set:function(a){!0===a&&this.createPunchCanvas(),this._isDisplayPunchImage=a},get:function(){return this._isDisplayPunchImage}},{key:"isDisplayDimmedImage",set:function(a){!0===a&&this.createDimmedCanvas(),this._isDisplayDimmedImage=a},get:function(){return this._isDisplayDimmedImage}}]),b}(PIXI.Container);b.default=q},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(1),h=d(g),i=c(2),j=d(i),k=c(3),l=d(k),m=c(48),n=c(55),o=function(a){function b(c){var d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"#EEEEEE",g=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,h=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1e3,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1e3;(0,f.default)(this,b);var k=(0,j.default)(this,a.call(this));return k.url=c,k._thickness=d,k._color=e,k._opacity=g,k._drawWidth=h,k._drawHeight=i,k.initialize(),k}return(0,l.default)(b,a),b.LOAD_COMPLETE=function(){return"loadComplete"},b.prototype.initialize=function(){var a=this.svgContainer=document.createElement("div");a.style.display="none",document.body.appendChild(a),this.maskContext=this.createCanvas("maskCanvas",this.drawWidth,this.drawHeight,!0,"0px","0px"),this.strokeContext=this.createCanvas("strokeCanvas",this.drawWidth,this.drawHeight,!0,"0px",this.drawHeight+"px"),this.resultContext=this.createCanvas("resultCanvas",this.drawWidth,this.drawHeight,!0,"0px",2*this.drawHeight+"px"),this.strokeSprite=new PIXI.Sprite(new PIXI.Texture.fromCanvas(this.resultContext.canvas)),this.url&&this.load(this.url,this.thickness,this.color,this.opacity,this.drawWidth,this.drawHeight)},b.prototype.load=function(a){var c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"#EEEEEE",e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,f=this,g=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1e3,h=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1e3;this.svgElement&&this.svgContainer.removeChild(this.svgElement),a&&(0,m.request)(a).then(function(a){f.svgElement=(0,n.parseXML)(a).documentElement,f.svgContainer.appendChild(f.svgElement),f.svg=f.svgElement.querySelector("#npe-mask-core"),f.update(c,d,e,g,h),f.addChild(f.strokeSprite),f.emit(b.LOAD_COMPLETE)}).catch(function(a){void 0})},b.prototype.clear=function(){this.maskContext.clearRect(0,0,this.maskContext.canvas.width,this.maskContext.canvas.height),this.strokeContext.clearRect(0,0,this.strokeContext.canvas.width,this.strokeContext.canvas.height),this.resultContext.clearRect(0,0,this.resultContext.canvas.width,this.resultContext.canvas.height)},b.prototype.resizeCanvas=function(a,b){this.maskContext.canvas.width=a,this.maskContext.canvas.height=b,this.strokeContext.canvas.width=a,this.strokeContext.canvas.height=b,this.resultContext.canvas.width=a,this.resultContext.canvas.height=b},b.prototype.textureUpdate=function(){this.resizeCanvas(this.drawWidth,this.drawHeight),this.strokeWidth=0,this.fillOpacity=1,this.maskContext.drawSvg(this.svgContainer.innerHTML,0,0,this.drawWidth,this.drawHeight),this.fillOpacity=0,0!==this.thickness&&(this.stroke=this.color,this.strokeWidth=this.thickness,this.strokeOpacity=this.opacity),this.strokeContext.drawSvg(this.svgContainer.innerHTML,0,0,this.drawWidth,this.drawHeight),this.resultContext.drawImage(this.strokeContext.canvas,0,0),this.resultContext.globalCompositeOperation="destination-in",this.resultContext.drawImage(this.maskContext.canvas,0,0),this.strokeSprite.texture.update()},b.prototype.createCanvas=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,d=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],e=(arguments.length>4&&void 0!==arguments[4]&&arguments[4],arguments.length>5&&void 0!==arguments[5]&&arguments[5],document.createElement("canvas"));
e.id=a,e.width=b,e.height=c;var f=e.getContext("2d");return f.imageSmoothingEnabled=d,f.oImageSmoothingEnabled=d,f.msImageSmoothingEnabled=d,f.mozImageSmoothingEnabled=d,f.webkitImageSmoothingEnabled=d,e.style.display="none",document.body.appendChild(e),f},b.prototype.update=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#EEEEEE",c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e3,e=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1e3;this._thickness=a,this._color=b,this._opacity=c,this._drawWidth=d,this._drawHeight=e,this.textureUpdate()},b.prototype.destroy=function(){this.strokeSprite&&(this.removeChild(this.strokeSprite),this.strokeSprite.texture.destroy(),this.strokeSprite.texture=null,this.strokeSprite.destroy(),this.strokeSprite=null),this.maskContext&&(document.body.removeChild(this.maskContext.canvas),document.body.removeChild(this.strokeContext.canvas),document.body.removeChild(this.resultContext.canvas),this.maskContext=null,this.strokeContext=null,this.resultContext=null),this.svgElement&&this.svgContainer.removeChild(this.svgElement),this.svgContainer&&document.body.removeChild(this.svgContainer),this.svgElement=this.svgContainer=null},(0,h.default)(b,[{key:"thickness",set:function(a){this._thickness=a,this.textureUpdate()},get:function(){return this._thickness}},{key:"color",set:function(a){this._color=a,this.textureUpdate()},get:function(){return this._color}},{key:"opacity",set:function(a){this._opacity=a,this.textureUpdate()},get:function(){return this._opacity}},{key:"drawWidth",set:function(a){this._drawWidth=a,this.textureUpdate()},get:function(){return this._drawWidth}},{key:"drawHeight",set:function(a){this._drawHeight=a,this.textureUpdate()},get:function(){return this._drawHeight}},{key:"fill",set:function(a){this.svg&&(this.svg.style.fill=a)},get:function(){return this.svg?this.svg.style.fill:null}},{key:"fillOpacity",set:function(a){return this.svg&&(this.svg.style["fill-opacity"]=a),null},get:function(){return this.svg?Number(this.svg.style["fill-opacity"]):null}},{key:"stroke",set:function(a){this.svg&&(this.svg.style.stroke=a)},get:function(){return this.svg?this.svg.style:null}},{key:"strokeOpacity",set:function(a){this.svg&&(this.svg.style["stroke-opacity"]=a)},get:function(){if(this.svg)return this.svg.style["stroke-opacity"]}},{key:"strokeWidth",set:function(a){this.svg&&(this.svg.style["stroke-width"]=a+"px")},get:function(){return this.svg?this.svg.style["stroke-width"]:null}}]),b}(PIXI.Container);b.default=o},function(a,b,c){"use strict";b.__esModule=!0;var d=c(0),e=function(a){return a&&a.__esModule?a:{"default":a}}(d),f=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;(0,e.default)(this,a),this.strokeRestoreVO=b,this.maskRestoreVO=c,this.backgroundImageRestoreVO=d}return a.prototype.clone=function(){return new a(this.strokeRestoreVO.clone(),this.maskRestoreVO.clone(),this.backgroundImageRestoreVO.clone())},a}();b.default=f},function(a,b,c){"use strict";b.__esModule=!0;var d=c(0),e=function(a){return a&&a.__esModule?a:{"default":a}}(d),f=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#FFFFFF",d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;(0,e.default)(this,a),this.thickness=b,this.color=c,this.opacity=d}return a.prototype.clone=function(){return new a(this.thickness,this.color,this.opacity)},a.prototype.toString=function(){var a="strokeRestoreVO("+this.thickness+", "+this.color+", "+this.opacity+")";return void 0,a},a}();b.default=f},function(a,b,c){a.exports={"default":c(353),__esModule:!0}},function(a,b,c){c(354),a.exports=-9007199254740991},function(a,b,c){var d=c(13);d(d.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(2),h=d(g),i=c(3),j=d(i),k=c(200),l=d(k),m=c(202),n=d(m),o=c(32),p=c(356),q=d(p),r=c(187),s=[0,0],t=[0,0],u=new n.default,v=new n.default,w={x:null,y:null,min:null,max:null},x={x:null,y:null,min:null,max:null},y=new q.default,z=new q.default,A=[s,null,null,w,y],B=[t,null,null,x,z],C=[A,B],D=function(a){function b(c,d){return(0,f.default)(this,b),(0,h.default)(this,a.call(this,[[0,0],[c,0],[c,d],[0,d]],c,d))}return(0,j.default)(b,a),b.prototype.updateFrame=function(b,c){this.initWithVertices(this.getVertices(b,c)),a.prototype.updateFrame.call(this,b,c)},b.prototype.hitTestEdge=function(a,b,c,d){for(var e=this.vertices,f=void 0,g=void 0,h=void 0,i=void 0,j={x:0,y:0},k=0,l=e.length;k<l;k++){var m=e[k];f=m[0],g=m[1];var n=e[k+1]||e[0];if(h=n[0],i=n[1],(0,r.getIntersection)(a,b,c,d,f,g,h,i,j))return[j.x,j.y]}return null},b.prototype.scaleToCircle=function(a){this.scale=a/this.getMinEdgeDivWithPivot()},b.prototype.projectToTop=function(a,b){return o.getAxis.apply(void 0,this.vertices[0].concat(this.vertices[1],[s])),a*s[0]+b*s[1]},b.prototype.projectToLeft=function(a,b){return o.getAxis.apply(void 0,this.vertices[0].concat(this.vertices[3],[t])),a*t[0]+b*t[1]},b.prototype.getVertices=function(a,b){return[[0,0],[a,0],[a,b],[0,b]]},b.prototype.getMinEdgeDivWithPivot=function(){return Math.min(this.getMinEdgeDivWithPivotX(),this.getMinEdgeDivWithPivotY())},b.prototype.getMinEdgeDivWithPivotX=function(){return this.getMinValue(this._width,this.anchorX)},b.prototype.getMinEdgeDivWithPivotY=function(){return this.getMinValue(this._height,this.anchorY)},b.prototype.getMinValue=function(a,b){return Math.min(a*b,a*(1-b))},b.prototype.getAxes=function(){var a=(arguments.length>0&&void 0!==arguments[0]&&arguments[0],this.vertices),b=a[0],c=a[1],d=a[3];return[o.getAxis.apply(void 0,b.concat(c)),o.getAxis.apply(void 0,b.concat(d))]},b.prototype.containTestPolygon=function(a){var b=this.vertices,c=b[0],d=b[1],e=b[3];return o.getAxis.apply(void 0,c.concat(d,[s])),o.getAxis.apply(void 0,c.concat(e,[t])),A[1]=c,A[2]=d,B[1]=c,B[2]=e,C.map(function(b){var c=b[0],d=c[0],e=c[1],f=b[1],g=b[2],h=b[3],i=b[4];return u.initWithAxis(d,e),u.project.apply(u,f),u.project.apply(u,g),v.initWithAxis(d,e),a.radius?v.projectCircle(a.vertex,a.radius):v.projectPolygon(a.vertices),i.initWithVO(u.getMTV(v,h))})},b}(l.default);b.default=D},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(1),h=d(g),i=c(53),j=function(){function a(b){(0,f.default)(this,a),b&&this.initWithVO(b)}return a.prototype.initWithVO=function(a){if(!a)throw new Error("MTV VO가 null 입니다.");return this._vo=a,this._largestLength=void 0,this},a.prototype.translate=function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,c=this.minimum,d=this.maximum;0!=c&&(a.x+=this.x*c*b,a.y+=this.y*c*b),0!=d&&(a.x+=this.x*d*b,a.y+=this.y*d*b)},a.prototype.scale=function(a,b,c,d,e){var f=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,g=(0,i.abs)(d-b),h=(0,i.abs)(e-c),j="width",k=g;h>g&&(j="height",k=h),a.scale*=(a[j]-2*k*f)/a[j]},(0,h.default)(a,[{key:"outofbounds",get:function(){return this.largestLength>0}},{key:"largestLength",get:function(){return void 0===this._largestLength&&(this._largestLength=Math.max(Math.abs(this.minimum),Math.abs(this.maximum))),this._largestLength}},{key:"largestVertex",get:function(){return Math.abs(this.minimum)>Math.abs(this.maximum)?this.minimumVertex:this.maximumVertex}},{key:"minimum",get:function(){return this.vo.min}},{key:"maximum",get:function(){return this.vo.max}},{key:"minimumVertex",get:function(){return this.vo.minVertex}},{key:"maximumVertex",get:function(){return this.vo.maxVertex}},{key:"x",get:function(){return this.vo.x}},{key:"y",get:function(){return this.vo.y}},{key:"vo",get:function(){return this._vo}}]),a}();b.default=j},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(1),h=d(g),i=function(){function a(){(0,f.default)(this,a)}return a.prototype.initPolygonRenderer=function(a){return this._renderer=a,this._container=[],this},a.prototype.startRender=function(){this._renderer.on("postrender",this.onPostRender,this)},a.prototype.stopRender=function(){this._renderer.off("postrender",this.onPostRender,this)},a.prototype.add=function(a){this.remove(a),this._container.push(a)},a.prototype.remove=function(a){var b=this._container.indexOf(a);return-1==b?null:this._container.splice(b,1)[0]},a.prototype.onPostRender=function(){var a=this;this._container.forEach(function(b){return b.render(a._renderer.context)})},(0,h.default)(a,[{key:"boundary",get:function(){return this._container[0]}},{key:"target",get:function(){return this._container[1]}}]),a}();b.default=i},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(1),h=d(g),i=c(2),j=d(i),k=c(3),l=d(k),m=c(201),n=d(m),o=c(32),p=function(a){function b(){var c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;(0,f.default)(this,b);var d=(0,j.default)(this,a.call(this,c,c));return d._vertex=[0,0],d._originalRadius=0,d.originalRadius=c,d.fillColor="#222",d.lineColor="#55f",d}return(0,l.default)(b,a),b.prototype.hitTestPoint=function(a,b){var c=this.radius*this.radius,d=this.vertex,e=a-d[0],f=b-d[1];return c>=e*e+f*f},b.prototype.render=function(a){var b=this.vertex;a.save(),a.setTransform(1,0,0,1,0,0),a.strokeStyle=this.lineColor,a.lineWidth=1,a.fillStyle=this.fillColor,a.beginPath(),a.arc.apply(a,b.concat([this.radius,0,2*Math.PI])),a.stroke(),a.restore(),this.__hit&&this.fill(a,this.fillColor)},b.prototype.fill=function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#fff",c=this.vertex;a.save(),a.fillStyle=b,a.beginPath(),a.arc.apply(a,c.concat([this.radius,0,2*Math.PI])),a.fill(),a.restore()},b.prototype.getHorizontalScale=function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this._width;return Math.abs(this.projectToTop(a,b))/(.5*c)},b.prototype.getVerticalScale=function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this._height;return Math.abs(this.projectToLeft(a,b))/(.5*c)},b.prototype.projectToTop=function(a,b){var c=this.matrix.apply(0,0),d=this.matrix.apply(this._width,0),e=o.getAxis.apply(void 0,c.concat(d));return a*e[0]+b*e[1]},b.prototype.projectToLeft=function(a,b){var c=this.matrix.apply(0,0),d=this.matrix.apply(0,this._height),e=o.getAxis.apply(void 0,c.concat(d));return a*e[0]+b*e[1]},b.prototype.len=function(a,b){return Math.sqrt(a*a+b*b)},(0,h.default)(b,[{key:"vertex",get:function(){return this._invalidateVertex&&(this.matrix.apply(0,0,this._vertex),this._invalidateVertex=!1),this._vertex}},{key:"pivot",get:function(){return this.matrix.apply(this.pivotX,this.pivotY)}},{key:"radius",get:function(){return this.originalRadius*this.scaleX},set:function(a){this.scaleX=a/this.originalRadius}},{key:"height",get:function(){return this.width},set:function(a){this.width=a}},{key:"originalRadius",get:function(){return this._originalRadius},set:function(a){this._originalRadius=a,this.updateFrame(2*a,2*a)}},{key:"invalidate",get:function(){return this._invalidate},set:function(a){this._invalidate=a,a&&(this._invalidateRadius=a,this._invalidateVertex=a)}}]),b}(n.default);b.default=p},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(1),h=d(g),i=function(){function a(){(0,f.default)(this,a)}return(0,h.default)(a,null,[{key:"BREAK",get:function(){return 3}},{key:"BACKSPACE",get:function(){return 8}},{key:"TAB",get:function(){return 9}},{key:"CLEAR",get:function(){return 12}},{key:"ENTER",get:function(){return 13}},{key:"COMMAND",get:function(){return 15}},{key:"SHIFT",get:function(){return 16}},{key:"CONTROL",get:function(){return 17}},{key:"ALTERNATE",get:function(){return 18}},{key:"PAUSE",get:function(){return 18}},{key:"CAPSLOCK",get:function(){return 18}},{key:"ESCAPE",get:function(){return 27}},{key:"SPACE",get:function(){return 32}},{key:"PAGE_UP",get:function(){return 33}},{key:"PAGE_DOWN",get:function(){return 34}},{key:"END",get:function(){return 35}},{key:"HOME",get:function(){return 36}},{key:"LEFT",get:function(){return 37}},{key:"UP",get:function(){return 38}},{key:"RIGHT",get:function(){return 39}},{key:"DOWN",get:function(){return 40}},{key:"INSERT",get:function(){return 45}},{key:"DELETE",get:function(){return 46}},{key:"NUMBER_0",get:function(){return 48}},{key:"NUMBER_1",get:function(){return 49}},{key:"NUMBER_2",get:function(){return 50}},{key:"NUMBER_3",get:function(){return 51}},{key:"NUMBER_4",get:function(){return 52}},{key:"NUMBER_5",get:function(){return 53}},{key:"NUMBER_6",get:function(){return 54}},{key:"NUMBER_7",get:function(){return 55}},{key:"NUMBER_8",get:function(){return 56}},{key:"NUMBER_9",get:function(){return 57}},{key:"A",get:function(){return 65}},{key:"B",get:function(){return 66}},{key:"C",get:function(){return 67}},{key:"D",get:function(){return 68}},{key:"E",get:function(){return 69}},{key:"F",get:function(){return 70}},{key:"G",get:function(){return 71}},{key:"H",get:function(){return 72}},{key:"I",get:function(){return 73}},{key:"J",get:function(){return 74}},{key:"K",get:function(){return 75}},{key:"L",get:function(){return 76}},{key:"M",get:function(){return 77}},{key:"N",get:function(){return 78}},{key:"O",get:function(){return 79}},{key:"P",get:function(){return 80}},{key:"Q",get:function(){return 81}},{key:"R",get:function(){return 82}},{key:"S",get:function(){return 83}},{key:"T",get:function(){return 84}},{key:"U",get:function(){return 85}},{key:"V",get:function(){return 86}},{key:"W",get:function(){return 87}},{key:"X",get:function(){return 88}},{key:"Y",get:function(){return 89}},{key:"Z",get:function(){return 90}},{key:"LEFT_WINDOW",get:function(){return 91}},{key:"RIGHT_WINDOW",get:function(){return 92}},{key:"RIGHT_MENU",get:function(){return 93}},{key:"NUMPAD_0",get:function(){return 96}},{key:"NUMPAD_1",get:function(){return 97}},{key:"NUMPAD_2",get:function(){return 98}},{key:"NUMPAD_3",get:function(){return 99}},{key:"NUMPAD_4",get:function(){return 100}},{key:"NUMPAD_5",get:function(){return 101}},{key:"NUMPAD_6",get:function(){return 102}},{key:"NUMPAD_7",get:function(){return 103}},{key:"NUMPAD_8",get:function(){return 104}},{key:"NUMPAD_9",get:function(){return 105}},{key:"NUMPAD_MULTIPLY",get:function(){return 106}},{key:"NUMPAD_ADD",get:function(){return 107}},{key:"NUMPAD_ENTER",get:function(){return 108}},{key:"NUMPAD_SUBTRACT",get:function(){return 109}},{key:"NUMPAD_DECIMAL",get:function(){return 110}},{key:"NUMPAD_DIVIDE",get:function(){return 111}},{key:"F1",get:function(){return 112}},{key:"F2",get:function(){return 113}},{key:"F3",get:function(){return 114}},{key:"F4",get:function(){return 115}},{key:"F5",get:function(){return 116}},{key:"F6",get:function(){return 117}},{key:"F7",get:function(){return 118}},{key:"F8",get:function(){return 119}},{key:"F9",get:function(){return 120}},{key:"F10",get:function(){return 121}},{key:"F11",get:function(){return 122}},{key:"F12",get:function(){return 123}},{key:"F13",get:function(){return 124}},{key:"F14",get:function(){return 125}},{key:"F15",get:function(){return 126}},{key:"SEMICOLON",get:function(){return 186}},{key:"EQUAL",get:function(){return 187}},{key:"COMMA",get:function(){return 188}},{key:"DASH",get:function(){return 189}},{key:"PERIOD",get:function(){return 190}},{key:"BACKQUOTE",get:function(){return 192}},{key:"BACKSLASH",get:function(){return 220}},{key:"QUOTE",get:function(){return 222}}]),a}();b.default=i},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(1),h=d(g),i=c(132),j=d(i),k=c(94),l=d(k),m=c(138),n=d(m),o=c(361),p=d(o),q=c(179),r=d(q),s=c(362),t=d(s),u=c(363),v=d(u),w=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new n.default,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new j.default,d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new l.default;(0,f.default)(this,a),this._toImageData=new r.default,this._maskImageCrop=new t.default(b),this._imageTransforms=[c,this.maskImageCrop,d,this.toImageData],this._cropAndResize=(new p.default).initWithTransforms(this.crop,this.resize),this._resizeDownScale=(new v.default).initWithTransforms(this.resize),this._simpleTransforms=[c,b,this._resizeDownScale,this.toImageData]}return(0,h.default)(a,[{key:"transforms",get:function(){return this.imageTransforms.map(function(a){return a.transform})}},{key:"imageTransforms",get:function(){return this._imageTransforms}},{key:"simpleTransforms",get:function(){return this._simpleTransforms}},{key:"toImageData",get:function(){return this._toImageData}},{key:"cropAndResize",get:function(){return this._cropAndResize}},{key:"mask",get:function(){return this._simpleTransforms[1]}},{key:"maskImageCrop",get:function(){return this._maskImageCrop}},{key:"crop",get:function(){return this._imageTransforms[0]}},{key:"resize",get:function(){return this._imageTransforms[2]}}]),a}();b.default=w},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(2),h=d(g),i=c(3),j=d(i),k=c(132),l=d(k),m=c(94),n=d(m),o=c(33),p=c(47),q=d(p),r=c(54),s=d(r),t=function(a){function b(){(0,f.default)(this,b);var c=(0,h.default)(this,a.call(this));return c.resizeRatio=.5,c}return(0,j.default)(b,a),b.prototype.initWithTransforms=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new l.default,b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new n.default;return this.crop=a,this.resize=b,this},b.prototype.applyTransform=function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,d=this.crop.getCanvasSize(a),e=d[0],f=d[1],g=new q.default,h=!this.crop._compare(a,e,f)||this.crop.transform.modified;h&&(g.setBy(this.crop.transform.matrix),c&&c.matrix.preppend(this.crop.transform.matrix));var i=this.resize.updateScale(e,f);return i>=1&&this.resize.resetResizedCache(),i>=1&&!h?null:(this.resize.updateCanvasSize(b,e*i|0,f*i|0),c&&c.matrix.preppend(this.resize.transform.matrix),(0,o.resizeImage)(a,b.getContext("2d"),e,f,this.resizeRatio,g.raw),b)},b}(s.default);b.default=t},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(1),h=d(g),i=c(2),j=d(i),k=c(3),l=d(k),m=c(54),n=d(m),o=c(25),p=d(o),q=c(33),r=c(95),s=d(r),t=c(10),u=function(a){function b(c){(0,f.default)(this,b);var d=(0,j.default)(this,a.call(this));return d._init(c),window.__context=t.__context,d}return(0,l.default)(b,a),b.prototype._init=function(a){this.mask=a,this._temp=new p.default},b.prototype.applyTransform=function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return this.modified?(this.stroke.update(),b.width=this.stroke.maskWidth,b.height=this.stroke.maskHeight,t.__context.canvas.width=this.stroke.maskWidth*(1/this.transform.scaleX),t.__context.canvas.height=this.stroke.maskHeight*(1/this.transform.scaleY),c&&c.matrix.preppend(this.transform.matrix),this.setTransformTo(this._temp,this.transform),(0,q.transformImage)(a,t.__context,this._temp.matrix.raw),s.default.resizeCanvas(t.__context.canvas,b,{alpha:!0},function(){}),b):null},b.prototype.setTransformTo=function(a,b){a.setTransform(b.x,b.y,1,1,b.offsetX,b.offsetY,b.radian)},(0,h.default)(b,[{key:"modified",get:function(){return this.mask.modified}},{key:"stroke",get:function(){return this.mask.stroke}},{key:"transform",get:function(){return this.mask.transform}}]),b}(n.default);b.default=u},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(1),h=d(g),i=c(2),j=d(i),k=c(3),l=d(k),m=c(54),n=d(m),o=c(94),p=d(o),q=c(33),r=function(a){function b(){return(0,f.default)(this,b),(0,j.default)(this,a.call(this))}return(0,l.default)(b,a),b.prototype.initWithTransforms=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new p.default;return this._original=a,this},b.prototype.applyTransform=function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,d=this.original.getSourceSize(a),e=d[0],f=d[1],g=this.original.updateScale(e,f);return!this.modified&&g>=1?this.original.resetResizedCache():(this.original.updateCanvasSize(b,e*g|0,f*g|0),c&&c.matrix.preppend(this.original.transform.matrix),(0,q.resizeImage)(a,b.getContext("2d"),e,f,.5),b)},(0,h.default)(b,[{key:"modified",get:function(){return this.original.modified}},{key:"original",get:function(){return this._original}},{key:"width",get:function(){return this.original.width}},{key:"maximum",get:function(){return this.original.maximum}}]),b}(n.default);b.default=r},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(21),f=d(e),g=c(0),h=d(g),i=c(1),j=d(i),k=c(2),l=d(k),m=c(3),n=d(m),o=c(144),p=d(o),q=c(46),r=d(q),s=c(24),t=c(55),u=c(48),v=c(60),w=d(v),x=c(40),y=(d(x),c(44)),z=d(y),A=function(){},B=!1,C=function(a){function b(c){return(0,h.default)(this,b),(0,l.default)(this,a.call(this,c))}return(0,n.default)(b,a),b.prototype._init=function(b){a.prototype._init.call(this,b),this._gl=(0,s.getWebGLContext)(),this._gl.__type__="bitmapdataContext",this._destTextures=[],this._drawGLImage=null,this._sourceTex2D=new r.default.createTextureForSingleImage(z.default.shared),this._sourceTex2D.texture.__filter__="original",this.applyImageFiltersAsync=this.applyImageFiltersAsync.bind(this)},b.prototype.initGLFiltersWithSize=function(a,b){this._updateSizeOfGLImage(this.drawGLImage,a,b),this._updateSizeOfFilters(a,b,this.filters)},b.prototype._updateSizeOfFilters=function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.filters;c&&c.length&&c.forEach(function(c){return c.initWithSize(a,b)})},b.prototype.dispose=function(){a.prototype.dispose.call(this),this.glImage.dispose(),this.sourceTexture2D.dispose()},b.prototype._clearCache=function(){a.prototype._clearCache.call(this);var b=Math.max(2,this.transformedWidth),c=Math.max(2,this.transformedHeight);this._destTextures.forEach(function(a){return a.initWithPixels(b,c)})},b.prototype._clearDestTextures=function(){var a=this.gl;a.bindTexture(a.TEXTURE_2D,null),this._destTextures.forEach(function(a){return a.dispose()}),this._destTextures.length=0},b.prototype.save=function(a,b){var c=this,d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.tempCanvases[0].getContext("2d"),e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.drawGLImage;this.worldTransform.identity();var f=b.some(function(a){return a.changed});return(0,u.re)(this.applyImageTransformsAsync,this.source,this.tempCanvases,a,this.worldTransform).then(function(a){var g=a[0];return f?c._updateImageFilters(g,b,d,e,g):c._drawImageDataToContext(g,d)})},b.prototype._updateImageFilters=function(a,b,c,d){var e=this,f=this._updateSizeAndSourceTexture(a,d,b),g=f[0],h=f[1];return(0,u.re)(this.applyImageFiltersAsync,g.texture,h.texture,d.gl,b,a).then(function(a){var b=a[0];return e._updateGLImageAndDrawToCanvas(b,d,c),e._disposeTex2Ds(g,h),c})},b.prototype._drawImageDataToContext=function(a,b){var c=b.canvas;return c.width=a.width,c.height=a.height,b.putImageData(a,0,0),b},b.prototype.applyImageFiltersAsync=function(a,b,c,d,e){var g=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,h=d.length,i=this;return new f.default(function(f){if(g>=h||!d[g])return f({done:!0,args:[a]});var j=d[g];j.changed?j.applyFilterAsync(a,b,i,e).then(function(h){return f({done:!1,args:[b,a,c,d,e,++g]})}):f({done:!1,args:[a,b,c,d,e,++g]})})},b.prototype._updateSizeAndSourceTexture=function(a,b,c){var d=b.gl,e=a.width,f=a.height,g=[r.default.createTextureForSingleImage(d).initWithPixels(e,f),r.default.createTextureForSingleImage(d).initWithPixels(e,f)];return this._updateSizeOfGLImage(b,e,f),this._updateSizeOfFilters(e,f,c),this._updateSourceTexture(a,g[0]),g},b.prototype._disposeTex2Ds=function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];b.forEach(function(a){return a.dispose()})},b.prototype._updateGLImageAndDrawToCanvas=function(a,b,c){var d=c.canvas;return d.width=b.width,d.height=b.height,b.draw(a),c.drawImage(b.gl.canvas,0,0),c},b.prototype.update=function(){this.updateImageTransforms(),this.updateFilters(null),this.updateCanvas()},b.prototype.updateImageTransforms=function(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.transforms;a.prototype.updateImageTransforms.call(this,b);var c=this.transformedWidth,d=this.transformedHeight;this._updateSourceTexture(this.transformedImageData),this.initGLFiltersWithSize(c,d)},b.prototype.updateFilters=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,b=z.default.shared;b.getParameter(b.FRAMEBUFFER_BINDING)&&b.bindFramebuffer(b.FRAMEBUFFER,null),this._updateSizeOfCanvas(b,this.transformedWidth,this.transformedHeight),this.applyGLFilters(this.filters,a)},b.prototype.updateCanvas=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getSourceTexture(this.numFilters).texture,b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._offContext,c=this.drawGLImage,d=c.gl.canvas,e=b.canvas;c.draw(a),this.setCanvasSize(d.width||d.naturalWidth,d.height||d.naturalHeight,e),b.drawImage(d,0,0)},b.prototype.applyGLFilters=function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(a&&0!=a.length)for(var c=a.length,d=a.indexOf(b),e=this.getSourceTexture(d),f=void 0,g=void 0,h=e.width,i=e.height,j=Math.max(d,0);j<c;j++)g=a[j],g.changed&&(f=this.getDestTexture(j,h,i),g.initWithSize(h,i),g.applyFilter(e.texture,f.texture,this),e=f)},b.prototype.getSourceTexture=function(a){return a<=0||0==this.numFilters?this.sourceTexture2D:this.filters[a-1].changed?this._destTextures[a-1]:this.getSourceTexture(a-1)},b.prototype.getDestTexture=function(a,b,c){var d=this._destTextures[a];return(0,w.default)(d,a+"에 해당하는 destTexture2D를 찾을 수 없습니다."),b==d.width&&c==d.height||d.initWithPixels(b,c),d},b.prototype._initDestTextures=function(a){this._clearDestTextures();for(var b=this._destTextures,c=z.default.shared,d=void 0,e=0;e<a;e++)d=r.default.createTextureForSingleImage(c),d.texture.__filter__=this.filters[e].name,this.filters[e].frameBuffer&&(this.filters[e].frameBuffer.frame.__name__=d.texture.__filter__),d.initWithPixels(2,2),b.push(d)},b.prototype._updateSizeOfGLImage=function(a,b,c){var d=a.gl;a&&!this._testSize(d.canvas,b,c)&&(this._updateSizeOfCanvas(d,b,c),a.initWithSize(b,c),a.updateWorldTransform(b,c))},b.prototype._updateSizeOfCanvas=function(a,b,c){a.canvas.width=b,a.canvas.height=c,a.viewport(0,0,b,c)},b.prototype._updateSourceTexture=function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.sourceTexture2D,c=new Uint8Array(a.data);return b.initWithPixels(a.width,a.height,c),b},b.prototype._testSize=function(a,b,c){return(a.width||a.naturalWidth)===b&&(a.height||a.naturalHeight)===c},(0,j.default)(b,[{key:"gl",get:function(){return this._gl}},{key:"canvas",get:function(){return this._offContext.canvas}},{key:"sourceTexture2D",get:function(){return this._sourceTex2D}},{key:"sourceTexture",get:function(){return this.sourceTexture2D.texture}},{key:"numFilters",get:function(){return this.filters?this.filters.length:0}},{key:"filters",get:function(){return this._filters},set:function(a){this._filters=a||[],this._clearCache(),this._initDestTextures(this.numFilters)}},{key:"drawGLImage",get:function(){return this._drawGLImage},set:function(a){this._drawGLImage=a}},{key:"showOriginal",get:function(){return this._showOriginal||!1},set:function(a){if(this._showOriginal!=a){this._showOriginal=a;var b=a?this.sourceTexture:void 0;this.updateCanvas(b)}}},{key:"debug",get:function(){return B},set:function(a){B=a,A=(0,t.makeDebugLog)(this.debug)}}]),b}(p.default);b.default=C},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(2),h=d(g),i=c(3),j=d(i),k=c(23),l=d(k),m=c(10),n=function(a){function b(c,d){return(0,f.default)(this,b),(0,h.default)(this,a.call(this,c,d))}return(0,j.default)(b,a),b.prototype.start=function(){this.stage.interactive=!0,(0,m.addEvents)(this.stage,["mousedown",this.onMouseDown,this]),this.stage.magnify.autoScale(!1)},b.prototype.fitToScreen=function(){},b.prototype.screenFitDisable=function(){this.stage.magnify.autoScale(!1)},b.prototype.suspend=function(){(0,m.removeEvents)(this.stage,["mousedown",this.onMouseDown,this]),document.body.removeEventListener("mouseup",this._onMouseUp)},b.prototype.onMouseDown=function(a){var b=a.data.global.x,c=a.data.global.y;this.stage.magnify.moveTo(b,c),this._onMouseUp=this._onMouseUp||this.onMouseUp.bind(this),document.body.addEventListener("mouseup",this._onMouseUp)},b.prototype.onMouseMove=function(a){},b.prototype.rotate=function(a){var b=this.stage.viewport,c=a.x-(b.x+b.width/2),d=a.y-(b.y+b.height/2),e=Math.atan2(d,c);this.stage.root.rotation=e,this.stage.root.updateTransform();var a={x:b.x+100,y:b.y+100},f=this.container.worldTransform.applyInverse(a);this.stage.signature.sprite.x=f.x,this.stage.signature.sprite.y=f.y,this.stage.signature.sprite.rotation=-e,void 0},b.prototype.onMouseUp=function(a){},b}(l.default);b.default=n},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(1),h=d(g),i=c(2),j=d(i),k=c(3),l=d(k),m=function(a){function b(c){var d=arguments.length>1&&void 0!==arguments[1]&&arguments[1],e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2631720;(0,f.default)(this,b);var g=(0,j.default)(this,a.call(this));return g._init(c,d,e),g.parent=new PIXI.Container,g.startRender(),g}return(0,l.default)(b,a),b.prototype.update=function(){this.ticker.update()},b.prototype.dispose=function(){this.ticker.remove(this._onRender,this),this.ticker.stop(),this.removeAllListeners()},b.prototype.changeStageSize=function(a,b){this.renderer.resize(a,b),this.onRender()},b.prototype.startRender=function(){this.ticker.add(this._onRender,this)},b.prototype.stopRender=function(){this.ticker.remove(this._onRender,this)},b.prototype._init=function(a,b,c){this._ticker=PIXI.ticker.shared,this._bindEventListeners(),this._initRenderer(a,b,c)},b.prototype._bindEventListeners=function(){this._onRequestRender=this.onRequestRender.bind(this),this._onRender=this.onRender.bind(this),this.on(b.REQ_RENDER,this._onRequestRender)},b.prototype._initRenderer=function(a,b,c){this._renderer=b?PIXI.autoDetectRenderer(a.width,a.height,{view:a,autoResize:!1,backgroundColor:c}):new PIXI.CanvasRenderer(a.width,a.height,{view:a,autoResize:!1,backgroundColor:c}),this._renderGL=this._renderer instanceof PIXI.WebGLRenderer},b.prototype.onRequestRender=function(a){this.update()},b.prototype.onRender=function(){this._renderer.render(this)},(0,h.default)(b,[{key:"renderer",get:function(){return this._renderer}},{key:"canvas",get:function(){return this._renderer.view}},{key:"renderGL",get:function(){return this._renderGL}},{key:"stageWidth",get:function(){return this.canvas.width}},{key:"stageHeight",get:function(){return this.canvas.height}},{key:"ticker",get:function(){return this._ticker}}]),b}(PIXI.Container);b.default=m},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(1),h=d(g),i=function(){function a(){(0,f.default)(this,a),this._list=[],this.clear()}return a.prototype.undo=function(){return this.undoable?this._list[--this.$p]:null},a.prototype.redo=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.redoable?this._list[++this.$p]:null},a.prototype.push=function(a){this._list.length=++this.$p,
this._list.push(a)},a.prototype.clear=function(){this._list.length=0,this.$p=-1},a.prototype.getPrevHistory=function(){return this._list[this.$p]},(0,h.default)(a,[{key:"numStack",get:function(){return this._list.length}},{key:"undoable",get:function(){return this.$p-1>=0}},{key:"redoable",get:function(){return this.$p+1<this.numStack}}]),a}();b.default=i},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(1),h=d(g),i=c(2),j=d(i),k=c(3),l=d(k),m=c(23),n=d(m),o=c(56),p=d(o),q=c(10),r=c(73),s=(d(r),c(203)),t=d(s),u=c(169),v=d(u),w=function(a){function b(c,d,e){(0,f.default)(this,b);var g=(0,j.default)(this,a.call(this,c,d));return g.frame=new t.default(e),g.frame.initialize(c.imgPath,c.crossOrigin),g._container=e,g._container.on(p.default.CHANGE_SIZE,g.onContainerChange,g),g.stage.on(v.default.PHOTOFRAME_DISABLE,g.onPhotoFrameDisable,g),g.stage.on("clearAll",g.onClearAll,g),g}return(0,l.default)(b,a),b.prototype.start=function(){a.prototype.start.call(this)},b.prototype.suspend=function(){return a.prototype.suspend.call(this)},b.prototype.reset=function(b){var c=arguments.length>1&&void 0!==arguments[1]&&arguments[1];b&&b.hasOwnProperty("index")?(this.currentFrameIndex=b.index||0,this._backupIndex=b.backup||0):(this.currentFrameIndex=0,this._backupIndex=0),a.prototype.reset.call(this,c)},b.prototype.snapshot=function(){return this.modified?{index:this.currentFrameIndex,backup:this._backupIndex}:{}},b.prototype.dispose=function(){this.stage.off(v.default.PHOTOFRAME_DISABLE,this.onPhotoFrameDisable,this),this.stage.off("clearAll",this.onClearAll,this),this._container&&this._container.off(p.default.CHANGE_SIZE,this.onContainerChange,this)},b.prototype.addFrame=function(a){a!=this.currentFrameIndex&&(this.currentFrameIndex=a,this.pushHistory())},b.prototype.onContainerChange=function(a){this.modified&&this.frame.applyFrame(this.frame.frameNum)},b.prototype.onClearAll=function(a){this.reset()},b.prototype.onPhotoFrameDisable=function(a){if(this.modified||this._backupIndex)if(a.visible)this.currentFrameIndex=this._backupIndex||0;else{var b=this.currentFrameIndex;this.currentFrameIndex=0,this._backupIndex=b}},(0,h.default)(b,[{key:"modified",get:function(){return this.frame.modified}},{key:"source",get:function(){return this.frame.source}},{key:"currentFrameIndex",get:function(){return this.frame.frameNum},set:function(a){this._backupIndex=a,this.frame.visible=!0,this.frame.applyFrame(a),this.stage.magnify.border=(0,q.clone)(this.frame.border),this.stage.emit(v.default.BORDER_CHANGED,{type:v.default.BORDER_CHANGED,target:this})}},{key:"border",get:function(){return this.frame.border}}]),b}(n.default);b.default=w},function(a,b,c){"use strict";b.__esModule=!0,b.default={frames:{"01_1_left_top.png":{frame:{x:241,y:127,w:11,h:11},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:11,h:11},sourceSize:{w:11,h:11}},"01_2_center_top.png":{frame:{x:251,y:108,w:1,h:11},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:1,h:11},sourceSize:{w:1,h:11}},"01_3_right_top.png":{frame:{x:239,y:91,w:11,h:11},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:11,h:11},sourceSize:{w:11,h:11}},"01_4_left_middle.png":{frame:{x:121,y:132,w:11,h:1},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:11,h:1},sourceSize:{w:11,h:1}},"01_5_right_middle.png":{frame:{x:121,y:134,w:11,h:1},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:11,h:1},sourceSize:{w:11,h:1}},"01_6_left_bottom.png":{frame:{x:239,y:103,w:11,h:11},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:11,h:11},sourceSize:{w:11,h:11}},"01_7_center_bottom.png":{frame:{x:249,y:77,w:1,h:11},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:1,h:11},sourceSize:{w:1,h:11}},"01_8_right_bottom.png":{frame:{x:239,y:115,w:11,h:11},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:11,h:11},sourceSize:{w:11,h:11}},"02_1_left_top.png":{frame:{x:33,y:82,w:8,h:8},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:8,h:8},sourceSize:{w:8,h:8}},"02_2_center_top.png":{frame:{x:33,y:109,w:1,h:8},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:1,h:8},sourceSize:{w:1,h:8}},"02_3_right_top.png":{frame:{x:33,y:100,w:8,h:8},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:8,h:8},sourceSize:{w:8,h:8}},"02_4_left_middle.png":{frame:{x:33,y:118,w:8,h:1},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:8,h:1},sourceSize:{w:8,h:1}},"02_5_right_middle.png":{frame:{x:33,y:120,w:8,h:1},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:8,h:1},sourceSize:{w:8,h:1}},"02_6_left_bottom.png":{frame:{x:33,y:91,w:8,h:8},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:8,h:8},sourceSize:{w:8,h:8}},"02_7_center_bottom.png":{frame:{x:35,y:109,w:1,h:8},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:1,h:8},sourceSize:{w:1,h:8}},"02_8_right_bottom.png":{frame:{x:33,y:73,w:8,h:8},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:8,h:8},sourceSize:{w:8,h:8}},"03_1_left_top.png":{frame:{x:77,y:126,w:21,h:21},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:21,h:21},sourceSize:{w:21,h:21}},"03_2_center_top.png":{frame:{x:249,y:55,w:1,h:21},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:1,h:21},sourceSize:{w:1,h:21}},"03_3_right_top.png":{frame:{x:33,y:126,w:21,h:21},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:21,h:21},sourceSize:{w:21,h:21}},"03_4_left_middle.png":{frame:{x:99,y:132,w:21,h:1},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:21,h:1},sourceSize:{w:21,h:1}},"03_5_right_middle.png":{frame:{x:99,y:134,w:21,h:1},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:21,h:1},sourceSize:{w:21,h:1}},"03_6_left_bottom.png":{frame:{x:198,y:127,w:21,h:21},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:21,h:21},sourceSize:{w:21,h:21}},"03_7_center_bottom.png":{frame:{x:253,y:108,w:1,h:21},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:1,h:21},sourceSize:{w:1,h:21}},"03_8_right_bottom.png":{frame:{x:55,y:126,w:21,h:21},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:21,h:21},sourceSize:{w:21,h:21}},"04_1_left_top.png":{frame:{x:149,y:2,w:52,h:52},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:52,h:52},sourceSize:{w:52,h:52}},"04_2_center_top.png":{frame:{x:251,y:55,w:1,h:52},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:1,h:52},sourceSize:{w:1,h:52}},"04_3_right_top.png":{frame:{x:43,y:2,w:52,h:52},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:52,h:52},sourceSize:{w:52,h:52}},"04_4_left_middle.png":{frame:{x:99,y:143,w:52,h:1},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:52,h:1},sourceSize:{w:52,h:1}},"04_5_right_middle.png":{frame:{x:99,y:145,w:52,h:1},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:52,h:1},sourceSize:{w:52,h:1}},"04_6_left_bottom.png":{frame:{x:96,y:2,w:52,h:52},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:52,h:52},sourceSize:{w:52,h:52}},"04_7_center_bottom.png":{frame:{x:253,y:55,w:1,h:52},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:1,h:52},sourceSize:{w:1,h:52}},"04_8_right_bottom.png":{frame:{x:202,y:2,w:52,h:52},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:52,h:52},sourceSize:{w:52,h:52}},"05_1_left_top.png":{frame:{x:213,y:55,w:35,h:35},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:35,h:35},sourceSize:{w:35,h:35}},"05_2_center_top.png":{frame:{x:2,y:114,w:30,h:35},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:30,h:35},sourceSize:{w:30,h:35}},"05_3_right_top.png":{frame:{x:141,y:55,w:35,h:35},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:35,h:35},sourceSize:{w:35,h:35}},"05_4_left_middle.png":{frame:{x:172,y:91,w:35,h:30},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:35,h:30},sourceSize:{w:35,h:30}},"05_5_right_middle.png":{frame:{x:136,y:91,w:35,h:30},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:35,h:30},sourceSize:{w:35,h:30}},"05_6_left_bottom.png":{frame:{x:105,y:55,w:35,h:35},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:35,h:35},sourceSize:{w:35,h:35}},"05_7_center_bottom.png":{frame:{x:208,y:91,w:30,h:35},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:30,h:35},sourceSize:{w:30,h:35}},"05_8_right_bottom.png":{frame:{x:177,y:55,w:35,h:35},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:35,h:35},sourceSize:{w:35,h:35}},"06_1_left_top.png":{frame:{x:167,y:122,w:30,h:20},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:30,h:20},sourceSize:{w:30,h:20}},"06_2_center_top.png":{frame:{x:220,y:127,w:20,h:20},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:20,h:20},sourceSize:{w:20,h:20}},"06_3_right_top.png":{frame:{x:136,y:122,w:30,h:20},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:30,h:20},sourceSize:{w:30,h:20}},"06_4_left_middle.png":{frame:{x:2,y:73,w:30,h:40},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:30,h:40},sourceSize:{w:30,h:40}},"06_5_right_middle.png":{frame:{x:105,y:91,w:30,h:40},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:30,h:40},sourceSize:{w:30,h:40}},"06_6_left_bottom.png":{frame:{x:43,y:55,w:30,h:70},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:30,h:70},sourceSize:{w:30,h:70}},"06_7_center_bottom.png":{frame:{x:2,y:2,w:40,h:70},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:40,h:70},sourceSize:{w:40,h:70}},"06_8_right_bottom.png":{frame:{x:74,y:55,w:30,h:70},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:30,h:70},sourceSize:{w:30,h:70}}},meta:{app:"Adobe Flash Professional",version:"15.0.1.179",image:"frame.png",format:"RGBA8888",size:{w:256,h:256},scale:"1"}}},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(21),f=d(e),g=c(37),h=d(g),i=c(0),j=d(i),k=c(1),l=d(k),m=c(144),n=d(m),o=c(17),p=c(56),q=d(p),r=c(92),s=(d(r),c(135)),t=d(s),u=c(76),v=d(u),w=c(47),x=d(w),y=c(137),z=d(y),A=c(188),B=d(A),C=c(203),D=d(C),E=c(189),F=c(10),G=c(33),H=c(25),I=d(H),J=c(48),K=(c(55),c(138)),L=d(K),M=c(134),N=c(124),O=c(180),P=c(130).AutoAdjustment,Q=c(184),R=void 0,S=function(){function a(b){(0,j.default)(this,a),this.options=b,R=(0,J.makeLoadImage)(this.options.crossOrigin),this._init(),this._initEvent()}return a.prototype._init=function(){this.bitmapdata=new n.default,this._colorTransform=new N,this._sharpen=new O,this._autolevel=new P,this._foodie=new M,this._mosaic=new Q(this.bitmapdata.worldTransform),this.bitmapdata.transforms=[],this.bitmapdata._resizeTransforms=[],this.bitmapdata.filters=[this._autolevel,this._foodie,this._sharpen,this._mosaic,this._colorTransform],this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.signatureContainer=new q.default,this.signatureContainer.interactive=!1,this.stickerContainer=new q.default,this.stickerContainer.interactive=!1,this.signature=new PIXI.Sprite,this.signature.renderableObject=!0,this.photoFrame=new D.default(this.signatureContainer),this.photoFrame.initialize(this.options.photoFrame.imgPath),this.restoreComplete=null},a.prototype._initEvent=function(){this.setImageByElement=this.setImageByElement.bind(this),this.renderCanvas=this.renderCanvas.bind(this)},a.prototype.initWithColorTable=function(a){this._colorTables=a},a.prototype.initMaskAssets=function(a){this._mask=new L.default,this._maskAsset=a},a.prototype.updateOriginalSize=function(a,b){this._originalWidth=a,this._originalHeight=b,this.signatureContainer.updateSize(a,b)},a.prototype.clear=function(){this._ready=!1,this.restoreComplete=null,this.bitmapdata.clear(),this.photoFrame.applyFrame(0),this.clearFilter(),this.clearContainer()},a.prototype.clearFilter=function(){var a=this._colorTransform;a.brightness=0,a.contrast=1,a.saturation=1,a.hue=0,a.kelvin=0,this._sharpen.sharpen=0,this._autolevel.enabled=!1,this._mosaic.areas=null,this._foodie.colorTable=null,this._foodie.value=0},a.prototype.clearContainer=function(){[this.signatureContainer,this.stickerContainer].forEach(function(a){for(var b=a.children.length;b--;)a.removeChildAt(b);a.scale.x=a.scale.y=1,a.x=a.y=0,a.pivot.x=a.pivot.y=0,a.rotation=0}),this.signature.parent&&this.signature.parent.removeChild(this.signature),this.photoFrame.applyFrame(0)},a.prototype.toDataURL=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"image/jpeg",b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.92;return this.bitmapdata.canvas.toDataURL(a,b)},a.prototype.setImageByDataURL=function(a){return this.clear(),this._ready=!1,R(a).then(this.setImageByElement)},a.prototype.setImageByElement=function(a){return this._ready=!0,this.bitmapdata.initWithSource(a),this},a.prototype.restore=function(a){var b=this;return this.snapshot=a,this.bitmapdata.updateTransform(),this.restoreMask(a.clip),this.restoreCrop(a),this.restoreResize(a),(0,o.each)(a,function(a,c){return b.applyFilter(c,a)}),(0,o.each)(a,function(a,c){return b.drawObject(c,a)}),this.getAllStickerLoaded().then(this.renderCanvas)},a.prototype.renderCanvas=function(){this.bitmapdata.updateFilters(),this.bitmapdata.updateCanvas(),this.stickerContainer.children.sort(function(a,b){return a.childIndex<b.childIndex?-1:Number(a.childIndex>b.childIndex)});var a=this.bitmapdata.canvas.getContext("2d");this.drawRenderableObjects(a),this.drawPhotoframe(a)},a.prototype.restoreMask=function(a){if(this._mask){var b=this._mask,c=b.stroke;b.identity(),a&&-1!=a.index&&(c.initWithSVG(this._maskAsset[a.index]),b.restore(a.mask),c.update())}},a.prototype.restoreCrop=function(a){a.crop=a.crop||{},a.crop.transform=a.crop.transform||new I.default;var b=(new I.default).setTo(a.crop.transform),c=!1;if(b.canvasWidth=-1==b.canvasWidth?this.originalWidth:b.canvasWidth,b.canvasHeight=-1==b.canvasHeight?this.originalHeight:b.canvasHeight,a.crop.transform.canvasWidth=b.canvasWidth,a.crop.transform.canvasHeight=b.canvasHeight,a.crop.hasOwnProperty("externalRotation")&&a.crop.externalRotation%360){var d=new I.default,e=(360+(a.crop.externalRotation||0)%360)%360;c=(e/90|0)%2,b.rotate(e*Math.PI/180,b.canvasWidth,b.canvasHeight,c),a.crop.transform.canvasWidth=b.canvasWidth,a.crop.transform.canvasHeight=b.canvasHeight,d.canvasWidth=this.sourceWidth,d.canvasHeight=this.sourceHeight,this.applyExternalRotation(a.crop.externalRotation,d),this.bitmapdata.transforms.push(d),this.bitmapdata.updateTransform(),this.bitmapdata.transforms.length=0,this.signatureContainer.updateSize(this.croppedWidth,this.croppedHeight)}this.restoreWorldTransform(b,c),this.restoreContainer(b)},a.prototype.restoreResize=function(a){if(a.resize&&a.resize.width){var b=Math.min(1,a.resize.width/this.croppedWidth);this.signatureContainer.updateSize(a.resize.width,this.croppedHeight*b|0)}},a.prototype.restoreWorldTransform=function(a){var b=arguments.length>1&&void 0!==arguments[1]&&arguments[1],c=this.bitmapdata.worldTransform,d=b?[this.sourceHeight,this.sourceWidth]:[this.sourceWidth,this.sourceHeight],e=d[0],f=d[1],g=Math.max(e/this.croppedWidth,f/this.croppedHeight),h=this.croppedWidth*g|0,i=this.croppedHeight*g|0,j=e-h>>1|0,k=f-i>>1|0,l=(new I.default).setTo(a);l.scaleX*=g,l.scaleY*=g,c.setTo(l),c.evaluateMatrix(),c.matrix.append(new x.default(1,0,0,1,j,k)),c.scaleX*=g,c.scaleY*=g,c._changed=!1},a.prototype.restoreContainer=function(a){var b=this.stickerContainer;b.updateSize(this.originalWidth,this.originalHeight),b.scale.x=a.scaleX||1,b.scale.y=a.scaleY||1,b.x=a.x||0,b.y=a.y||0,b.rotation=a.radian||0,b.pivot.x=a.offsetX||0,b.pivot.y=a.offsetY||0},a.prototype.applyExternalRotation=function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(0!=a){this._externalRotateAngle=a;var c=[0,0,0,1,1,1,1,0];a=(360+a%360)%360;var d=a/90%4|0;if(b.offsetX=b.canvasWidth*c[2*d],b.offsetY=b.canvasHeight*c[2*d+1],b.radian+=a*Math.PI/180,d%2){var e=b.canvasWidth;b.canvasWidth=b.canvasHeight,b.canvasHeight=e}}},a.prototype.drawRenderableObjects=function(a){var b=this;a.save(),a.setTransform(1,0,0,1,0,0);var c=[this.croppedWidth,this.croppedHeight,this.resizedWidth,this.resizedHeight];[this.stickerContainer,this.signatureContainer].forEach(function(d,e){if(0!=d.children.length){var f=b.canvas.width=c[2*e],g=b.canvas.height=c[2*e+1];b.context.setTransform(1,0,0,1,0,0),b.context.clearRect(0,0,f,g),(0,F.makeDrawCallbackInClosure)(b.context,null).call(b,d),b.resizeAndDrawImage(b.canvas,a,f,g)}}),a.restore()},a.prototype.drawPhotoframe=function(a){a.save(),a.setTransform(1,0,0,1,0,0);var b=this.photoFrame.source;this.resizeAndDrawImage(b,a,b.width,b.height),a.restore()},a.prototype.resizeAndDrawImage=function(a,b,c,d){var e=arguments.length>4&&void 0!==arguments[4]&&arguments[4],f=e?this.sourceWidth:this.bitmapdata.width,g=e?this.sourceHeight:this.bitmapdata.height,h=Math.min(c/f,d/g),i=f*h+.5|0,j=g*h+.5|0,k=[1,0,0,1,0,0];i==c?k[5]=j-d>>1|0:k[4]=i-c>>1|0,(0,G.resizeImage)(a,b,i,j,.5,k)},a.prototype.applyFilter=function(a,b){switch(a){case"filter":null==this._colorTables&&void 0,this._foodie.colorTable=this._colorTables[b.index],this._foodie.value=b.values[b.index];break;case"adjust":var c=this._colorTransform;c.brightness=b.brightness||0,c.contrast=b.contrast||1,c.saturation=void 0===b.saturation?1:b.saturation,c.hue=b.hue||0,c.kelvin=b.kelvin||0,this._sharpen.sharpen=b.sharpen||0,this._autolevel.enabled=b.autolevel||!1;break;case"mosaic":this._mosaic.areas=b.areas.map(function(a){return(0,h.default)({},a)})}},a.prototype.drawObject=function(a,b){if(null!=b&&b.modified)switch(a){case"photoFrame":this.photoFrame.applyFrame(b.index||0);break;case"signature":if(null==b.displayObject)return;this.restoreSignature(b);break;case"sticker":if(!b.length)return;this.restoreSticker(b);break;case"text":if(!b.length)return;this.restoreText(b)}},a.prototype.restoreSignature=function(a){this.signature.texture=new PIXI.Texture(new PIXI.BaseTexture(a.displayObject)),this.signature.pivot.x=this.signature.width/2,this.signature.pivot.y=this.signature.height/2,this.signature.rotation=0;var b=this._alignSignature({width:this.resizedWidth,height:this.resizedHeight},{width:this.signature.width>>1,height:this.signature.height>>1},a.positionType,a);this.signature.x=b.x,this.signature.y=b.y,this.signatureContainer.addChild(this.signature)},a.prototype.restoreSticker=function(a){var b=this;a.forEach(function(a){var c=a.transform,d=a.pngSource?new t.default:new v.default;d.on(v.default.LOAD_COMPLETE,b.onLoadComplete,b),d.childScaleX=c.childScaleX,d.childScaleY=c.childScaleY,d.childIndex=a.childIndex,d.load(a.url,c.x,c.y,a.width,a.height),d.x=c.x,d.y=c.y,d.scale.x=c.scaleX,d.scale.y=c.scaleY,d.rotation=c.rotation,d.pivot.x=c.pivotX,d.pivot.y=c.pivotY,d._restored=!0,d.renderableObject=!0,b.stickerContainer.addChild(d)})},a.prototype.restoreText=function(a){var b=this;a.forEach(function(a){var c=b.createText(a.option,a),d=a.transform;c.x=d.x,c.y=d.y,c.scale.x=d.scaleX,c.scale.y=d.scaleY,c.pivot.x=d.pivotX,c.pivot.y=d.pivotY,c.rotation=d.rotation,c.childIndex=a.childIndex,c.originW=d.originW,c.originH=d.originH,c.image.scale.x=d.childScaleX,c.image.scale.y=d.childScaleY,c.childIndex=a.childIndex,c.renderableObject=!0,b.stickerContainer.addChild(c)})},a.prototype.getAllStickerLoaded=function(){var a=this,b=this.stickerContainer.children.map(function(b){return a.getSingleStickerLoaded(b)});return f.default.all(b)},a.prototype.getSingleStickerLoaded=function(a){return new f.default(function(b,c){a instanceof t.default&&!a.complete||b(a),a.once(v.default.LOAD_COMPLETE,function(a){return b(a.target)})})},a.prototype.onLoadComplete=function(a){if(a){var b=a.target;b.image.scale.x=b.childScaleX,b.image.scale.y=b.childScaleY,b.off(v.default.LOAD_COMPLETE,this.onLoadComplete,this)}},a.prototype._alignSignature=function(a,b,c,d){var e=void 0,f=void 0,g=b.width,h=b.height;switch(c){case"lt":e=d.w+g,f=d.h+h;break;case"lc":e=d.w+g,f=a.height/2;break;case"lb":e=d.w+g,f=a.height-(d.h+h);break;case"ct":e=a.width/2,f=d.h+h;break;case"cc":e=a.width/2,f=a.height/2;break;case"cb":e=a.width/2,f=a.height-(d.h+h);break;case"rt":e=a.width-(d.w+g),f=d.h+h;break;case"rc":e=a.width-(d.w+g),f=a.height/2;break;case"rb":e=a.width-(d.w+g),f=a.height-(d.h+h)}return this._hitTest(e,f,a,b)},a.prototype._hitTest=function(a,b,c,d){var e=d.width,f=d.height;return a=Math.max(e,Math.min(c.width-e,a)),b=Math.max(f,Math.min(c.height-f,b)),{x:a,y:b}},a.prototype.createText=function(a,b,c){a.textPadding||(a.textPadding={left:0,top:0,right:0,bottom:0});var d=new z.default(this.options.canvasLimitSize),e=new v.default(this.options.canvasLimitSize);if(e.signText=d,b&&b.transform){var f=b.transform;e.x=f.x,e.y=f.y,e.scale.x=f.scaleX,e.scale.y=f.scaleY,e.rotation=f.rotation}return this.applyText(e,a,b,c?{x:c,y:c}:null),e},a.prototype.applyText=function(a,b,c,d){var e=(0,h.default)(b,{}),f=void 0,g=void 0,i=b.text.split("\n"),j=0,k=0,l=.4*b.fontSize,m=[],n=0,o="",p=void 0,q=void 0,r=void 0,s=void 0,t=void 0;e.scale=a.scaleForOrigin,e.text="말말",f=a.signText.drawSign(e),r={w:f.width,h:f.height};for(var u=0;u<i.length;u++){q=e.text=i[u],0;var v=/[^(가-힣ㄱ-ㅎㅏ-ㅣa-zA-Z0-9)]/gi;v.test(q)&&(o=q.match(v)),e.text.length>1?(s=e.text.charAt(0),t=e.text.charAt(e.text.length-1),e.text=(" "==s?"말"+s:s+"말")+e.text.substr(1,e.text.length-2)+(" "==t?t+"말":"말"+t),f=a.signText.drawSign(e),e.text=i[u],n=f.height,p=f.rect,f.rect=p,f.rect.h=n,f.rect.w=f.width-r.w):(o.length!=e.text.length&&""!=e.text||(e.text+="ㅣ",f=a.signText.drawSign(e),n=f.height,p=f.rect),e.text=i[u],f=a.signText.drawSign(e),n||(n=f.height,p=f.rect),f.rect=p,f.rect.h=n,f.rect.w=f.width),m.push((0,h.default)(f.rect,{})),k+=f.rect.h,f.rect.w>j&&(j=f.rect.w),p=null,n=0}k+=l*(i.length-1),g={mainRect:{x:B.default.TEXT_MARGIN.left,y:B.default.TEXT_MARGIN.top,w:j+B.default.TEXT_MARGIN.left+B.default.TEXT_MARGIN.right,h:k+B.default.TEXT_MARGIN.top+B.default.TEXT_MARGIN.bottom},rects:m,gap:l},b.text=i.join("\n");var w=E.SVGCreator.createText(b,g,0),x=void 0;x=c||{x:0,y:0,width:g.mainRect.w,height:g.mainRect.h},a.option=b,a.setSVG(w,x.x,x.y,x.width,x.height),d&&(x.width*=d.x,x.height*=d.y,a.drawSvg(0,0,x.width,x.height))},(0,l.default)(a,[{key:"source",get:function(){return this.bitmapdata.source}},{key:"originalWidth",get:function(){return this._originalWidth||this.signatureContainer.actualWidth}},{key:"originalHeight",get:function(){return this._originalHeight||this.signatureContainer.actualHeight}},{key:"sourceWidth",get:function(){return this._ready?this.bitmapdata.sourceWidth:0}},{key:"sourceHeight",get:function(){return this._ready?this.bitmapdata.sourceHeight:0}},{key:"croppedWidth",get:function(){return this.snapshot&&this.snapshot.crop?-1==this.snapshot.crop.transform.canvasWidth?this.maskedWidth:this.snapshot.crop.transform.canvasWidth:this.maskedWidth}},{key:"croppedHeight",get:function(){return this.snapshot&&this.snapshot.crop?-1==this.snapshot.crop.transform.canvasHeight?this.maskedHeight:this.snapshot.crop.transform.canvasHeight:this.maskedHeight}},{key:"maskedWidth",get:function(){return this.snapshot&&this.snapshot.clip?-1==this.snapshot.clip.mask.transform.canvasWidth?this.originalWidth:this.snapshot.clip.mask.transform.canvasWidth:this.originalWidth}},{key:"maskedHeight",get:function(){return this.snapshot&&this.snapshot.clip?-1==this.snapshot.clip.mask.transform.canvasHeight?this.originalHeight:this.snapshot.clip.mask.transform.canvasHeight:this.originalHeight}},{key:"resizedWidth",get:function(){return this.snapshot&&this.snapshot.resize?this.snapshot.resize.width<=0?this.croppedWidth:this.snapshot.resize.width:this.croppedWidth}},{key:"resizedHeight",get:function(){if(!this.snapshot||!this.snapshot.resize)return this.croppedHeight;if(this.snapshot.resize.width<=0)return this.croppedHeight;var a=this.snapshot.resize.width;return Math.min(1,a/this.croppedWidth)*this.croppedHeight|0}}]),a}();b.default=S},function(a,b,c){"use strict";var d,e=c(204),f=c(372),g=c(99),h=c(41),i=c(35),j=c(58),k=c(390),l=c(49),m=c(211),n=c(396),o=c(409),p=c(412),q=Function.prototype.call,r=Object.defineProperties,s=Object.getPrototypeOf;a.exports=d=function(){var a,b,c,e=arguments[0];if(!(this instanceof d))throw new TypeError("Constructor requires 'new'");return c=p&&g&&Map!==d?g(new Map,s(this)):this,null!=e&&m(e),r(c,{__mapKeysData__:j("c",a=[]),__mapValuesData__:j("c",b=[])}),e?(n(e,function(c){var d=i(c)[0];c=c[1],-1===f.call(a,d)&&(a.push(d),b.push(c))},c),c):c},p&&(g&&g(d,Map),d.prototype=Object.create(Map.prototype,{constructor:j(d)})),k(r(d.prototype,{clear:j(function(){this.__mapKeysData__.length&&(e.call(this.__mapKeysData__),e.call(this.__mapValuesData__),this.emit("_clear"))}),"delete":j(function(a){var b=f.call(this.__mapKeysData__,a);return-1!==b&&(this.__mapKeysData__.splice(b,1),this.__mapValuesData__.splice(b,1),this.emit("_delete",b,a),!0)}),entries:j(function(){return new o(this,"key+value")}),forEach:j(function(a){var b,c,d=arguments[1];for(h(a),b=this.entries(),c=b._next();void 0!==c;)q.call(a,d,this.__mapValuesData__[c],this.__mapKeysData__[c],this),c=b._next()}),get:j(function(a){var b=f.call(this.__mapKeysData__,a);if(-1!==b)return this.__mapValuesData__[b]}),has:j(function(a){return-1!==f.call(this.__mapKeysData__,a)}),keys:j(function(){return new o(this,"key")}),set:j(function(a,b){var c,d=f.call(this.__mapKeysData__,a);return-1===d&&(d=this.__mapKeysData__.push(a)-1,c=!0),this.__mapValuesData__[d]=b,c&&this.emit("_add",d,a),this}),size:j.gs(function(){return this.__mapKeysData__.length}),values:j(function(){return new o(this,"value")}),toString:j(function(){return"[object Map]"})})),Object.defineProperty(d.prototype,l.iterator,j(function(){return this.entries()})),Object.defineProperty(d.prototype,l.toStringTag,j("c","Map"))},function(a,b,c){"use strict";var d=c(373),e=c(206),f=c(35),g=Array.prototype.indexOf,h=Object.prototype.hasOwnProperty,i=Math.abs,j=Math.floor;a.exports=function(a){var b,c,k,l;if(!d(a))return g.apply(this,arguments);for(c=e(f(this).length),k=arguments[1],k=isNaN(k)?0:k>=0?j(k):e(this.length)-j(i(k)),b=k;b<c;++b)if(h.call(this,b)&&(l=this[b],d(l)))return b;return-1}},function(a,b,c){"use strict";a.exports=c(374)()?Number.isNaN:c(375)},function(a,b,c){"use strict";a.exports=function(){var a=Number.isNaN;return"function"==typeof a&&(!a({})&&a(NaN)&&!a(34))}},function(a,b,c){"use strict";a.exports=function(a){return a!==a}},function(a,b,c){"use strict";var d=c(377),e=Math.abs,f=Math.floor;a.exports=function(a){return isNaN(a)?0:(a=Number(a),0!==a&&isFinite(a)?d(a)*f(e(a)):a)}},function(a,b,c){"use strict";a.exports=c(378)()?Math.sign:c(379)},function(a,b,c){"use strict";a.exports=function(){var a=Math.sign;return"function"==typeof a&&(1===a(10)&&-1===a(-20))}},function(a,b,c){"use strict";a.exports=function(a){return a=Number(a),isNaN(a)||0===a?a:a>0?1:-1}},function(a,b,c){"use strict";var d=c(64),e={"function":!0,object:!0};a.exports=function(a){return d(a)&&e[typeof a]||!1}},function(a,b,c){"use strict";var d,e=Object.create;c(207)()||(d=c(208)),a.exports=function(){var a,b,c;return d?1!==d.level?e:(a={},b={},c={configurable:!1,enumerable:!1,writable:!0,value:void 0},Object.getOwnPropertyNames(Object.prototype).forEach(function(a){if("__proto__"===a)return void(b[a]={configurable:!0,enumerable:!1,writable:!0,value:void 0});b[a]=c}),Object.defineProperties(a,b),Object.defineProperty(d,"nullPolyfill",{configurable:!1,enumerable:!1,writable:!1,value:a}),function(b,c){return e(null===b?a:b,c)}):e}()},function(a,b,c){"use strict";a.exports=function(){var a,b=Object.assign;return"function"==typeof b&&(a={foo:"raz"},b(a,{bar:"dwa"},{trzy:"trzy"}),a.foo+a.bar+a.trzy==="razdwatrzy")}},function(a,b,c){"use strict";var d=c(384),e=c(35),f=Math.max;a.exports=function(a,b){var c,g,h,i=f(arguments.length,2);for(a=Object(e(a)),h=function(d){try{a[d]=b[d]}catch(e){c||(c=e)}},g=1;g<i;++g)b=arguments[g],d(b).forEach(h);if(void 0!==c)throw c;return a}},function(a,b,c){"use strict";a.exports=c(385)()?Object.keys:c(386)},function(a,b,c){"use strict";a.exports=function(){try{return Object.keys("primitive"),!0}catch(a){return!1}}},function(a,b,c){"use strict";var d=c(64),e=Object.keys;a.exports=function(a){return e(d(a)?Object(a):a)}},function(a,b,c){"use strict";a.exports=function(a){return"function"==typeof a}},function(a,b,c){"use strict";var d="razdwatrzy";a.exports=function(){return"function"==typeof d.contains&&(!0===d.contains("dwa")&&!1===d.contains("foo"))}},function(a,b,c){"use strict";var d=String.prototype.indexOf;a.exports=function(a){return d.call(this,a,arguments[1])>-1}},function(a,b,c){"use strict";var d,e,f,g,h,i,j,k=c(58),l=c(41),m=Function.prototype.apply,n=Function.prototype.call,o=Object.create,p=Object.defineProperty,q=Object.defineProperties,r=Object.prototype.hasOwnProperty,s={configurable:!0,enumerable:!1,writable:!0};d=function(a,b){var c;return l(b),r.call(this,"__ee__")?c=this.__ee__:(c=s.value=o(null),p(this,"__ee__",s),s.value=null),c[a]?"object"==typeof c[a]?c[a].push(b):c[a]=[c[a],b]:c[a]=b,this},e=function(a,b){var c,e;return l(b),e=this,d.call(this,a,c=function(){f.call(e,a,c),m.call(b,this,arguments)}),c.__eeOnceListener__=b,this},f=function(a,b){var c,d,e,f;if(l(b),!r.call(this,"__ee__"))return this;if(c=this.__ee__,!c[a])return this;if("object"==typeof(d=c[a]))for(f=0;e=d[f];++f)e!==b&&e.__eeOnceListener__!==b||(2===d.length?c[a]=d[f?0:1]:d.splice(f,1));else d!==b&&d.__eeOnceListener__!==b||delete c[a];return this},g=function(a){var b,c,d,e,f;if(r.call(this,"__ee__")&&(e=this.__ee__[a]))if("object"==typeof e){for(c=arguments.length,f=new Array(c-1),b=1;b<c;++b)f[b-1]=arguments[b];for(e=e.slice(),b=0;d=e[b];++b)m.call(d,this,f)}else switch(arguments.length){case 1:n.call(e,this);break;case 2:n.call(e,this,arguments[1]);break;case 3:n.call(e,this,arguments[1],arguments[2]);break;default:for(c=arguments.length,f=new Array(c-1),b=1;b<c;++b)f[b-1]=arguments[b];m.call(e,this,f)}},h={on:d,once:e,off:f,emit:g},i={on:k(d),once:k(e),off:k(f),emit:k(g)},j=q({},i),a.exports=b=function(a){return null==a?o(j):q(Object(a),i)},b.methods=h},function(a,b,c){"use strict";var d={object:!0,symbol:!0};a.exports=function(){var a;if("function"!=typeof Symbol)return!1;a=Symbol("test symbol");try{String(a)}catch(b){return!1}return!!d[typeof Symbol.iterator]&&(!!d[typeof Symbol.toPrimitive]&&!!d[typeof Symbol.toStringTag])}},function(a,b,c){"use strict";var d,e,f,g,h=c(58),i=c(393),j=Object.create,k=Object.defineProperties,l=Object.defineProperty,m=Object.prototype,n=j(null);if("function"==typeof Symbol){d=Symbol;try{String(d()),g=!0}catch(o){}}var p=function(){var a=j(null);return function(b){for(var c,d,e=0;a[b+(e||"")];)++e;return b+=e||"",a[b]=!0,c="@@"+b,l(m,c,h.gs(null,function(a){d||(d=!0,l(this,c,h(a)),d=!1)})),c}}();f=function(a){if(this instanceof f)throw new TypeError("Symbol is not a constructor");return e(a)},a.exports=e=function q(a){var b;if(this instanceof q)throw new TypeError("Symbol is not a constructor");return g?d(a):(b=j(f.prototype),a=void 0===a?"":String(a),k(b,{__description__:h("",a),__name__:h("",p(a))}))},k(e,{"for":h(function(a){return n[a]?n[a]:n[a]=e(String(a))}),keyFor:h(function(a){var b;i(a);for(b in n)if(n[b]===a)return b}),hasInstance:h("",d&&d.hasInstance||e("hasInstance")),isConcatSpreadable:h("",d&&d.isConcatSpreadable||e("isConcatSpreadable")),iterator:h("",d&&d.iterator||e("iterator")),match:h("",d&&d.match||e("match")),replace:h("",d&&d.replace||e("replace")),search:h("",d&&d.search||e("search")),species:h("",d&&d.species||e("species")),split:h("",d&&d.split||e("split")),toPrimitive:h("",d&&d.toPrimitive||e("toPrimitive")),toStringTag:h("",d&&d.toStringTag||e("toStringTag")),unscopables:h("",d&&d.unscopables||e("unscopables"))}),k(f.prototype,{constructor:h(e),toString:h("",function(){return this.__name__})}),k(e.prototype,{toString:h(function(){return"Symbol ("+i(this).__description__+")"}),valueOf:h(function(){return i(this)})}),l(e.prototype,e.toPrimitive,h("",function(){var a=i(this);return"symbol"==typeof a?a:a.toString()})),l(e.prototype,e.toStringTag,h("c","Symbol")),l(f.prototype,e.toStringTag,h("c",e.prototype[e.toStringTag])),l(f.prototype,e.toPrimitive,h("c",e.prototype[e.toPrimitive]))},function(a,b,c){"use strict";var d=c(394);a.exports=function(a){if(!d(a))throw new TypeError(a+" is not a symbol");return a}},function(a,b,c){"use strict";a.exports=function(a){return!!a&&("symbol"==typeof a||!!a.constructor&&("Symbol"===a.constructor.name&&"Symbol"===a[a.constructor.toStringTag]));
}},function(a,b,c){"use strict";var d=c(100),e=c(64),f=c(101),g=c(49).iterator,h=Array.isArray;a.exports=function(a){return!!e(a)&&(!!h(a)||(!!f(a)||(!!d(a)||"function"==typeof a[g])))}},function(a,b,c){"use strict";var d=c(100),e=c(41),f=c(101),g=c(397),h=Array.isArray,i=Function.prototype.call,j=Array.prototype.some;a.exports=function(a,b){var c,k,l,m,n,o,p,q,r=arguments[2];if(h(a)||d(a)?c="array":f(a)?c="string":a=g(a),e(b),l=function(){m=!0},"array"===c)return void j.call(a,function(a){return i.call(b,r,a,l),m});if("string"!==c)for(k=a.next();!k.done;){if(i.call(b,r,k.value,l),m)return;k=a.next()}else for(o=a.length,n=0;n<o&&(p=a[n],n+1<o&&(q=p.charCodeAt(0))>=55296&&q<=56319&&(p+=a[++n]),i.call(b,r,p,l),!m);++n);}},function(a,b,c){"use strict";var d=c(100),e=c(101),f=c(398),g=c(408),h=c(211),i=c(49).iterator;a.exports=function(a){return"function"==typeof h(a)[i]?a[i]():d(a)?new f(a):e(a)?new g(a):new f(a)}},function(a,b,c){"use strict";var d,e=c(99),f=c(210),g=c(58),h=c(49),i=c(146),j=Object.defineProperty;d=a.exports=function(a,b){if(!(this instanceof d))throw new TypeError("Constructor requires 'new'");i.call(this,a),b=b?f.call(b,"key+value")?"key+value":f.call(b,"key")?"key":"value":"value",j(this,"__kind__",g("",b))},e&&e(d,i),delete d.prototype.constructor,d.prototype=Object.create(i.prototype,{_resolve:g(function(a){return"value"===this.__kind__?this.__list__[a]:"key+value"===this.__kind__?[a,this.__list__[a]]:a})}),j(d.prototype,h.toStringTag,g("c","Array Iterator"))},function(a,b,c){"use strict";var d,e=c(400),f=c(209),g=c(41),h=c(405),i=c(41),j=c(35),k=Function.prototype.bind,l=Object.defineProperty,m=Object.prototype.hasOwnProperty;d=function(a,b,c){var d,f=j(b)&&i(b.value);return d=e(b),delete d.writable,delete d.value,d.get=function(){return!c.overwriteDefinition&&m.call(this,a)?f:(b.value=k.call(f,c.resolveContext?c.resolveContext(this):this),l(this,a,b),this[a])},d},a.exports=function(a){var b=f(arguments[1]);return null!=b.resolveContext&&g(b.resolveContext),h(a,function(a,c){return d(c,a,b)})}},function(a,b,c){"use strict";var d=c(401),e=c(145),f=c(35);a.exports=function(a){var b=Object(f(a)),c=arguments[1],g=Object(arguments[2]);if(b!==a&&!c)return b;var h={};return c?d(c,function(b){(g.ensure||b in a)&&(h[b]=a[b])}):e(h,a),h}},function(a,b,c){"use strict";a.exports=c(402)()?Array.from:c(403)},function(a,b,c){"use strict";a.exports=function(){var a,b,c=Array.from;return"function"==typeof c&&(a=["raz","dwa"],b=c(a),Boolean(b&&b!==a&&"dwa"===b[1]))}},function(a,b,c){"use strict";var d=c(49).iterator,e=c(100),f=c(404),g=c(206),h=c(41),i=c(35),j=c(64),k=c(101),l=Array.isArray,m=Function.prototype.call,n={configurable:!0,enumerable:!0,writable:!0,value:null},o=Object.defineProperty;a.exports=function(a){var b,c,p,q,r,s,t,u,v,w,x=arguments[1],y=arguments[2];if(a=Object(i(a)),j(x)&&h(x),this&&this!==Array&&f(this))b=this;else{if(!x){if(e(a))return 1!==(r=a.length)?Array.apply(null,a):(q=new Array(1),q[0]=a[0],q);if(l(a)){for(q=new Array(r=a.length),c=0;c<r;++c)q[c]=a[c];return q}}q=[]}if(!l(a))if(void 0!==(v=a[d])){for(t=h(v).call(a),b&&(q=new b),u=t.next(),c=0;!u.done;)w=x?m.call(x,y,u.value,c):u.value,b?(n.value=w,o(q,c,n)):q[c]=w,u=t.next(),++c;r=c}else if(k(a)){for(r=a.length,b&&(q=new b),c=0,p=0;c<r;++c)w=a[c],c+1<r&&(s=w.charCodeAt(0))>=55296&&s<=56319&&(w+=a[++c]),w=x?m.call(x,y,w,p):w,b?(n.value=w,o(q,p,n)):q[p]=w,++p;r=p}if(void 0===r)for(r=g(a.length),b&&(q=new b(r)),c=0;c<r;++c)w=x?m.call(x,y,a[c],c):a[c],b?(n.value=w,o(q,c,n)):q[c]=w;return b&&(n.value=null,q.length=r),q}},function(a,b,c){"use strict";var d=Object.prototype.toString,e=d.call(c(205));a.exports=function(a){return"function"==typeof a&&d.call(a)===e}},function(a,b,c){"use strict";var d=c(41),e=c(406),f=Function.prototype.call;a.exports=function(a,b){var c={},g=arguments[2];return d(b),e(a,function(a,d,e,h){c[d]=f.call(b,g,a,d,e,h)}),c}},function(a,b,c){"use strict";a.exports=c(407)("forEach")},function(a,b,c){"use strict";var d=c(41),e=c(35),f=Function.prototype.bind,g=Function.prototype.call,h=Object.keys,i=Object.prototype.propertyIsEnumerable;a.exports=function(a,b){return function(c,j){var k,l=arguments[2],m=arguments[3];return c=Object(e(c)),d(j),k=h(c),m&&k.sort("function"==typeof m?f.call(m,c):void 0),"function"!=typeof a&&(a=k[a]),g.call(a,k,function(a,d){return i.call(c,a)?g.call(j,l,c[a],a,c,d):b})}}},function(a,b,c){"use strict";var d,e=c(99),f=c(58),g=c(49),h=c(146),i=Object.defineProperty;d=a.exports=function(a){if(!(this instanceof d))throw new TypeError("Constructor requires 'new'");a=String(a),h.call(this,a),i(this,"__length__",f("",a.length))},e&&e(d,h),delete d.prototype.constructor,d.prototype=Object.create(h.prototype,{_next:f(function(){if(this.__list__)return this.__nextIndex__<this.__length__?this.__nextIndex__++:void this._unBind()}),_resolve:f(function(a){var b,c=this.__list__[a];return this.__nextIndex__===this.__length__?c:(b=c.charCodeAt(0),b>=55296&&b<=56319?c+this.__list__[this.__nextIndex__++]:c)})}),i(d.prototype,g.toStringTag,f("c","String Iterator"))},function(a,b,c){"use strict";var d,e=c(99),f=c(58),g=c(146),h=c(49).toStringTag,i=c(410),j=Object.defineProperties,k=g.prototype._unBind;d=a.exports=function(a,b){if(!(this instanceof d))return new d(a,b);g.call(this,a.__mapKeysData__,a),b&&i[b]||(b="key+value"),j(this,{__kind__:f("",b),__values__:f("w",a.__mapValuesData__)})},e&&e(d,g),d.prototype=Object.create(g.prototype,{constructor:f(d),_resolve:f(function(a){return"value"===this.__kind__?this.__values__[a]:"key"===this.__kind__?this.__list__[a]:[this.__list__[a],this.__values__[a]]}),_unBind:f(function(){this.__values__=null,k.call(this)}),toString:f(function(){return"[object Map Iterator]"})}),Object.defineProperty(d.prototype,h,f("c","Map Iterator"))},function(a,b,c){"use strict";a.exports=c(411)("key","value","key+value")},function(a,b,c){"use strict";var d=Array.prototype.forEach,e=Object.create;a.exports=function(a){var b=e(null);return d.call(arguments,function(a){b[a]=!0}),b}},function(a,b,c){"use strict";a.exports=function(){return"undefined"!=typeof Map&&"[object Map]"===Object.prototype.toString.call(new Map)}()},function(a,b,c){var d,e,f;!function(c,g){e=[],d=g,void 0!==(f="function"==typeof d?d.apply(b,e):d)&&(a.exports=f)}(0,function(){return function a(b,c,d){function e(a){var b=a.split(/[:;,]/),c=b[1],d="base64"==b[2]?atob:decodeURIComponent,e=d(b.pop()),f=e.length,g=0,h=new Uint8Array(f);for(g;g<f;++g)h[g]=e.charCodeAt(g);return new p([h],{type:c})}function f(a,b){if("download"in n)return n.href=a,n.setAttribute("download",q),n.className="download-js-link",n.innerHTML="downloading...",n.style.display="none",document.body.appendChild(n),setTimeout(function(){n.click(),document.body.removeChild(n),!0===b&&setTimeout(function(){i.URL.revokeObjectURL(n.href)},250)},66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(a)&&(a="data:"+a.replace(/^data:([\w\/\-\+]+)/,j)),window.open(a)||confirm("Displaying New Document\n\nUse Save As... to download, then click back to return to this page.")&&(location.href=a),!0;var c=document.createElement("iframe");document.body.appendChild(c),!b&&/^data:/.test(a)&&(a="data:"+a.replace(/^data:([\w\/\-\+]+)/,j)),c.src=a,setTimeout(function(){document.body.removeChild(c)},333)}var g,h,i=window,j="application/octet-stream",k=d||j,l=b,m=!c&&!d&&l,n=document.createElement("a"),o=function(a){return String(a)},p=i.Blob||i.MozBlob||i.WebKitBlob||o,q=c||"download";if(p=p.call?p.bind(i):Blob,"true"===String(this)&&(l=[l,k],k=l[0],l=l[1]),m&&m.length<2048&&(q=m.split("/").pop().split("?")[0],n.href=m,-1!==n.href.indexOf(m))){var r=new XMLHttpRequest;return r.open("GET",m,!0),r.responseType="blob",r.onload=function(b){a(b.target.response,q,j)},setTimeout(function(){r.send()},0),r}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(l)){if(!(l.length>2096103.424&&p!==o))return navigator.msSaveBlob?navigator.msSaveBlob(e(l),q):f(l);l=e(l),k=l.type||j}else if(/([\x80-\xff])/.test(l)){var s=0,t=new Uint8Array(l.length),u=t.length;for(s;s<u;++s)t[s]=l.charCodeAt(s);l=new p([t],{type:k})}if(g=l instanceof p?l:new p([l],{type:k}),navigator.msSaveBlob)return navigator.msSaveBlob(g,q);if(i.URL)f(i.URL.createObjectURL(g),!0);else{if("string"==typeof g||g.constructor===o)try{return f("data:"+k+";base64,"+i.btoa(g))}catch(v){return f("data:"+k+","+encodeURIComponent(g))}h=new FileReader,h.onload=function(a){f(this.result)},h.readAsDataURL(g)}return!0}})},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(30),f=d(e),g=c(71),h=d(g),i=c(0),j=d(i),k=c(7),l=d(k),m=c(12),n=d(m),o=c(20),p=d(o),q=c(8),r=d(q),s=c(11),t=d(s),u=c(16),v=d(u),w=c(168),x=d(w),y=c(5),z=d(y);r.default.EDITOR={UNDO_BTN:".npe_btn_undo",REDO_BTN:".npe_btn_redo",RESTORE_BTN:".npe_btn_original",SAVE_BTN:".npe_btn_download",PC_SAVE_BTN:".npe_btn_mycomputer",CLOUDE_SAVE_BTN:".npe_btn_cloud",CANCEL_BTN:".npe_header_submit_btn_area .npe_btn_cancel",SUBMIT_BTN:".npe_header_submit_btn_area .npe_btn_submit",FITTOSCREEN_TOGGLE_WRAP:".npe_view_set",FITTOSCREEN_TOGGLE_CHECKBOX:".npe_view_set_check",TOAST_WRAP:".npe_notice_toast",TOAST_MSG:".npe_notice_toast_text",TOOLTIP_WRAP:".npe_notice_tooltip",TOOLTIP_MSG:".npe_notice_tooltip_text"};var A=function(){function a(b){(0,j.default)(this,a),this._controller=b,this._options=b._options,this.init()}return a.prototype.init=function(){var a=this.$wrapper=(0,z.default)(r.default.PHOTOEDITOR_WRAP),b=this._getThemeClassName();this.$controlWrap=a.find(r.default.EDITOR.CONTROL_WRAP),this.$undoBtn=a.find(r.default.EDITOR.UNDO_BTN),this.$redoBtn=a.find(r.default.EDITOR.REDO_BTN),this.$restoreBtn=a.find(r.default.EDITOR.RESTORE_BTN),this.$cancelBtn=a.find(r.default.EDITOR.CANCEL_BTN),this.$submitBtn=a.find(r.default.EDITOR.SUBMIT_BTN),this.$canvasWrap=a.find(r.default.CANVAS_WRAP),this.$canvas=this.$canvasWrap.find(r.default.CANVAS),this.$canvasLoadingUI=a.find(r.default.CANVAS_LOADING),this.$toastWrap=a.find(r.default.EDITOR.TOAST_WRAP),this.$toastMsg=this.$toastWrap.find(r.default.EDITOR.TOAST_MSG),this.$compareTooltipWrap=a.find(r.default.EDITOR.TOOLTIP_WRAP),this.$compareTooltipMsg=this.$toastWrap.find(r.default.EDITOR.TOOLTIP_MSG),this.$saveBtn=a.find(r.default.EDITOR.SAVE_BTN),this.$pcImageSaveBtn=(0,z.default)(r.default.EDITOR.PC_SAVE_BTN),this.$cloudImageSaveBtn=(0,z.default)(r.default.EDITOR.CLOUDE_SAVE_BTN),this._modal=new x.default(this._controller._storage),b&&a.addClass(b)},a.prototype.activate=function(){this.$undoBtn.on("click",this._onClickUndoBtn.bind(this)),this.$redoBtn.on("click",this._onClickRedoBtn.bind(this)),this.$restoreBtn.on("click",this._onClickRestoreBtn.bind(this)),this.$cancelBtn.on("click",this._onClickCancelBtn.bind(this)),this.$submitBtn.on("click",this._onClickSubmitBtn.bind(this)),this.$canvas.on("mousedown",this._onMousedownOnCanvas.bind(this)),this.$saveBtn.on("click",this._onClickSaveBtn.bind(this)),this.$pcImageSaveBtn.on("click",this._onChangePcImageSaveBtn.bind(this)),this.$cloudImageSaveBtn.on("click",this._onChangeCloudImageSaveBtn.bind(this)),(0,z.default)(window).on("keydown.peUndoKey",this._onUndoKey.bind(this)),(0,z.default)(window).on("click.peClick",this._onClickWindow.bind(this)),this._controller.on("open",this._onOpen.bind(this)),this._controller.on("close",this._onClose.bind(this)),this._controller.on("changeLanguage",this._onChangeLanguage.bind(this)),this._controller.on("setHold",this._onHold.bind(this)),this._controller.on("unsetHold",this._onUnsetHold.bind(this)),this._controller.on("alert",this._onAlert.bind(this)),this._controller.on("confirm",this._onConfirm.bind(this)),this._controller.on("changeViewport",this._onChangeViewport.bind(this)),this._controller.on("showToastMessage",this._showToastMessage.bind(this)),this._controller.on("hideToastMessage",this._hideToastMessage.bind(this)),this._controller.on("showCompareTooltip",this._showCompareTooltip.bind(this)),this._controller.on("hideCompareTooltip",this._hideCompareTooltip.bind(this)),this._controller.on("checkModified",this._onCheckModified.bind(this)),this._controller.on("setDimmed",this._onSetDimmed.bind(this)),this._controller.on("unsetDimmed",this._onUnsetDimmed.bind(this)),this._controller.on("changeCurrentPhoto",this._onChangeCurrentPhoto.bind(this)),this._controller.on("changeHistory",this._onChangeHistory.bind(this)),this._controller.on("canvasReady",this._onCanvasReady.bind(this))},a.prototype.deactivate=function(){this.$undoBtn.off("click"),this.$redoBtn.off("click"),this.$restoreBtn.off("click"),this.$cancelBtn.off("click"),this.$submitBtn.off("click"),this.$canvas.off("mousedown"),this.$saveBtn.off("click"),this.$pcImageSaveBtn.off("click"),this.$cloudImageSaveBtn.off("click"),(0,z.default)(window).off("keydown.peUndoKey"),(0,z.default)(window).off("click.peClick")},a.prototype._render=function(a,b){n.default.render(a,b)},a.prototype._getThemeClassName=function(){var a=this._options.theme;return a?"npe_theme_"+a:null},a.prototype._onClickWindow=function(a){var b=(0,z.default)(a.target);this._controller._latelyMouseDownEvent=a,b.is("button, a")&&b.blur()},a.prototype._onOpen=function(){this.$wrapper.addClass(r.default.ACTIVE_TOGGLE_CLASS),this.$submitBtn.focus()},a.prototype._onClose=function(a){var b=this.$wrapper;return b.removeClass(r.default.ACTIVE_TOGGLE_CLASS).on("webkitAnimationEnd oanimationend msAnimationEnd animationend",function(c){c.target===b.get(0)&&(b.off(c),b.removeClass(r.default.OUT_ANIMATION_CLASS),a.resolve())}).addClass(r.default.OUT_ANIMATION_CLASS),a},a.prototype._onChangeLanguage=function(a){this.$wrapper.attr("lang",a),this._render(this.$wrapper,p.default.getMessages())},a.prototype._onHold=function(){this.$wrapper.addClass(r.default.LOADING_CLASS)},a.prototype._onUnsetHold=function(){this.$wrapper.removeClass(r.default.LOADING_CLASS)},a.prototype._onSetDimmed=function(){this.$wrapper.addClass(r.default.DIMMED_CLASS)},a.prototype._onUnsetDimmed=function(){this.$wrapper.removeClass(r.default.DIMMED_CLASS)},a.prototype._onChangeHistory=function(a){this._btnToggleDisable(this.$undoBtn,!a.undoable),this._btnToggleDisable(this.$redoBtn,!a.redoable)},a.prototype._onCanvasReady=function(){this._checkEditable()},a.prototype._checkEditable=function(){var a=this._controller.getCurrentPhoto(),b=void 0;a.animationGIF?b=p.default.getMessage("txt_notice_animation_gif"):a.vr360&&(b=p.default.getMessage("txt_notice_vr360")),b?this._controller.showToastMessage(b):this._controller.hideToastMessage()},a.prototype._btnToggleDisable=function(a,b){b=Boolean(b),a.toggleClass(r.default.DISABLE_TOGGLE_CLASS,b),a.prop("disabled",b)},a.prototype._onAlert=function(a,b,c){this._modal.alert({title:a,content:b,yesCallback:c})},a.prototype._onConfirm=function(a,b,c,d){this._modal.confirm({title:a,yesCallback:c,noCallback:d})},a.prototype._onCheckModified=function(a){var b=this._controller.getCurrentPhoto();this._btnToggleDisable(this.$restoreBtn,!a),this._btnToggleDisable(this.$saveBtn,!a&&b.width===this._controller._editor.resizedWidth)},a.prototype._onClickUndoBtn=function(a){this._controller.isHolded()||this.$undoBtn.hasClass(r.default.DISABLE_TOGGLE_CLASS)||(this._controller.undo(),v.default.log("PTE_UNDO",a.currentTarget,a))},a.prototype._onClickRedoBtn=function(a){this._controller.isHolded()||this.$redoBtn.hasClass(r.default.DISABLE_TOGGLE_CLASS)||(this._controller.redo(),v.default.log("PTE_REDO",a.currentTarget,a))},a.prototype._onClickRestoreBtn=function(a){var b=this.$restoreBtn;this._controller.isHolded()||b.hasClass(r.default.DISABLE_TOGGLE_CLASS)||(this._controller.restoreEditor(),v.default.log("PTE_ORIGINAL",a.currentTarget,a))},a.prototype._onClickCancelBtn=function(a){this.$cancelBtn.hasClass(r.default.DISABLE_TOGGLE_CLASS)||(this._controller.cancelEditing(),v.default.log("PTE_CANCEL",a.currentTarget,a),a.preventDefault())},a.prototype._onClickSubmitBtn=function(a){this.$submitBtn.hasClass(r.default.DISABLE_TOGGLE_CLASS)||(this._controller.finishEditing(),v.default.log("PTE_OK",a.currentTarget,a),a.preventDefault())},a.prototype._onUndoKey=function(a){var b=(a.target,this._controller.currentControl,a.keyCode),c=a.shiftKey,d=a.ctrlKey&&!a.metaKey||!a.ctrlKey&&a.metaKey,e=!a.shiftKey&&d;e&&b===t.default.KEYCODES.Z&&(this._controller.undo(),a.preventDefault()),(e&&b===t.default.KEYCODES.Y||c&&d&&b===t.default.KEYCODES.Z)&&(this._controller.redo(),a.preventDefault())},a.prototype._toggleMessage=function(a,b){b?a.html(b).show():a.hide()},a.prototype._onChangeViewport=function(a){this.$canvasLoadingUI.css("margin-bottom",a.bottom+"px")},a.prototype._onMousedownOnCanvas=function(){this._controller.hideToastMessage()},a.prototype._showTimerTooltip=function(a){var b=this,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;a.timer&&clearTimeout(a.timer),a.stop(!0,!0).addClass(r.default.ACTIVE_TOGGLE_CLASS).show(),a.timer=setTimeout(function(){b._hideTimerTooltip(a)},c)},a.prototype._hideTimerTooltip=function(a){a.timer&&clearTimeout(a.timer),a.stop(!0,!0).removeClass(r.default.ACTIVE_TOGGLE_CLASS).hide()},a.prototype._setCompareTooltipPosition=function(){var a=this.$compareTooltipWrap,b=(this.$controlWrap,this._controller._editor.getImageBounds()),c=this.$canvasWrap.width()-Math.max(b.x,0),d=this.$canvasWrap.offset().top+b.y+Math.min(125,b.height/4),e=this.$wrapper.outerWidth(),f=a.outerWidth()+17;c+f>e&&(c-=c+f-e),a.css({right:c+16,top:d})},a.prototype._showCompareTooltip=function(a){var b=this,c=this.$compareTooltipWrap;this.$compareTooltipMsg.html(a.message),this._setCompareTooltipPosition(),this._showTimerTooltip(c,5e3),(0,z.default)(window).on("resize.compareTooltip",function(){b._setCompareTooltipPosition()}).one("mousedown.compareTooltip",function(){b._hideCompareTooltip()})},a.prototype._hideCompareTooltip=function(){var a=this.$compareTooltipWrap;this._hideTimerTooltip(a),(0,z.default)(window).off(".compareTooltip")},a.prototype._showToastMessage=function(a){var b=this.$toastWrap,c=this.$toastMsg,d=this._controller._getViewportCalculcated();c.html(a.message),b.css({"margin-top":(d.top+d.bottom)/2*-1}),this._showTimerTooltip(b,a.delay)},a.prototype._hideToastMessage=function(a){var b=this.$toastWrap;this._hideTimerTooltip(b)},a.prototype._onChangeCurrentPhoto=function(){this._controller.checkFitToViewport()},a.prototype._onClickSaveBtn=function(a){this.$saveBtn.hasClass(r.default.DISABLE_TOGGLE_CLASS)||(this._controller.setEditorClipConfirm(),this._modal.saveImagePopup({title:p.default.getMessage("txt_notice_image_save_title")}),v.default.log("PTE_EXPORT",a.currentTarget,a))},a.prototype._onChangePcImageSaveBtn=function(a){v.default.log("PTE_EXPTPC",a.currentTarget,a),this._controller.downloadCurrentPhoto(),this._modal.close()},a.prototype._onChangeCloudImageSaveBtn=function(){function a(a){return b.apply(this,arguments)}var b=(0,h.default)(f.default.mark(function c(a){var b,d,e,g;return f.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this._controller._validationGrafolioStickers(!0);case 2:if(c.sent){c.next=4;break}return c.abrupt("return");case 4:return v.default.log("PTE_EXPTCLOUD",a.currentTarget,a),c.next=7,this._controller.asyncGetCurrentPhotoSnapshotData();case 7:b=c.sent,d=b.url,e=b.fileName,g=b.fileSize,l.default.openNdriveSavePopup(d,e,g),this._modal.close();case 13:case"end":return c.stop()}},c,this)}));return a}(),a}();b.default=A},function(a,b,c){"use strict";var d=c(4),e=function(a){return a&&a.__esModule?a:{"default":a}}(d);!function(){var b=void 0!==b?b:{};b.ready=function(a,b){var c,d;if("function"==typeof a){if(c="readystatechange","complete"===document.readyState)return void a(b);document.addEventListener?(d=function(){document.removeEventListener(c,d,!1),a(b)},document.addEventListener(c,d,!1)):document.attachEvent&&(c="on"+c,d=function(){document.detachEvent(c,d),a(b)},document.attachEvent(c,d))}},b.css=function(a){var b=document.head||document.getElementsByTagName("head")[0],c=document.createElement("style");c.setAttribute("type","text/css"),c.styleSheet?c.styleSheet.cssText=a:c.appendChild(document.createTextNode(a)),b.appendChild(c)},b.TagWire=function(){function a(a){a&&w(a,ga)}function c(a,b,c,d){var e=[];d.opt.evfns=[],d.ready&&d.ready({target:a,data:b,name:c,type:Y.ready}),f(a,b,c,e,d),w(e,function(a){try{a.f(a.t,a.v,a.c)}catch(b){D(b.message,a.s)}}),w(d.opt.evfns,function(a){n(a.t,a.v,a.c,d,Y.finish)}),d.finish&&d.finish({target:a,data:b,name:c,type:Y.finish}),d.asyncNum||setTimeout(function(){w(d.evcmp,function(a){n(a.t,a.v,a.c,d,Y.complete)}),d.complete&&d.complete(d.event)},1)}function d(a,b,d,e){e.asyncNum++,setTimeout(function(){e.opt={async:!0},e.asyncNum--,c(a,b,d,e)},1)}function f(a,b,c,f,h){var i,j,m,n;h.skipReg&&h.skipReg.test(c)||(b instanceof Array?(i=g,j=!0):null!==b&&"object"===(void 0===b?"undefined":(0,e.default)(b))?(i=k,j=!0):(i=l,j=!1),m=c+U+W.asc,n=h.opt.async,h.opt.async=null,w(a,function(a){L(a,V.blk)||(j&&!n&&L(a,m)?d(a,b,c,h):i(a,b,c,f,h))}))}function g(a,b,c,d,e){var g,j,k,m;if(!L(a,c))return void w(N(a,c),function(a){f(a,b,c,d,e)});g=c+U+W.list,j=b.length,k=function(a){!1!==n(a,b,c,e,Y.ready)&&(l(a,j,c,d,e),L(a,g)&&m(a),w(N(a,g),m),L(a,V.arr)&&h(a,b,c,d,e)),p(a,b,c,e)},m=function(a){i(a,b,c,d,e)},w(a,k)}function h(a,b,c,d,e){var f,g=b.length;for(f=0;f<g;f++)l(a,b[f],c+U+f,d,e)}function i(a,b,c,d,e){var f=O(a,X.sct);f.length&&j(a,f,b,c,d,e),l(a,b,V.lida,d,e,!0)}function j(a,b,c,d,e,g){var h,i,j,k,m,o=c.length-1,q=L(a,V.rev),r=L(a,V.td),s=L(a,V.bu),t=r?V.td:s?V.bu:null,v=s?b[b.length-1]:P(a,V.itm),x=function(b){var c,o,q,r=b._tw_varsName;void 0===j&&(j=b._tw_tlen),o=k?"boolean"==typeof b._tw_itemType?Boolean(k[r]):k[r]:null,!A(r)&&k.hasOwnProperty(r)&&b._tw_itemType!==o||(q=u(b._tw_template),c=i+m*h+1,l(q,m,V.idn,e,g),l(q,c,V.idx,e,g),l(q,j+c,V.tidx,e,g),!1!==n(q,k,d,g,Y.ready)&&(f(q,k,V.itm,e,g),l(q,k,V.itda,e,g,!0),q._remove||(a.insertBefore(q,v),b._tw_tlen++)),p(q,k,d,g))};for(d=d+U+W.itm,v||(v=b[b.length-1]),v=v.nextSibling,s?(h=-1,i=o):(h=1,i=0),w(O(a,V.nw),ca),m=0;m<=o;m++)k=c[q?o-m:m],w(b,x);t||w(N(a,V.od),function(b){a.removeChild(b)}),a.className.replace(Z.fix,function(b,c){var d=O(a,V.itm),e=d.length;return c=Number(c),c<e&&w(d,function(b,d){s?d>=c&&a.removeChild(b):d<e-c&&a.removeChild(b)}),b})}function k(a,b,c,d,e){var g,h,i,j=c===V.itm;if(j||!1!==n(a,b,c,e,Y.ready))for(i in b)b.hasOwnProperty(i)&&i!==S&&(g=b[i],"object"===y(g)?(h=a,(L(h,i)||(h=N(a,i)).length)&&f(h,g,i,d,e)):f(a,g,i,d,e));j||p(a,b,c,e),L(a,V.obda,!0)&&l(a,b,V.obda,d,e,!0),(g=b.global)&&(!1!==n(a,g,S,e,Y.ready)&&f(a,g,S,d,e),p(a,g,S,e))}function l(a,b,c,d,e,f){var g,h=a,i=function(a,f){return Z.hyp.test(f)||ja?q(h,b,c,f,d,e):(g=b,(U+f).replace(Z.tail,j)),a},j=function(a){var b=q(h,g,c,a.substr(1),null,e);return void 0!==b&&(g=b),""};L(a,c+U,!0)&&a.className.replace(m(c),i),f||w(N(a,c+U,!0),function(a){h=a,h.className.replace(m(c),i)})}function m(a){return aa[X.resf+a]||F(X.resf+a,new RegExp("(?:^|\\s)"+T+a+U+"(?!"+X.skip+"|"+Y.all+")(\\S+)","g"))}function n(a,b,c,d,e,f){var g=null,h=a,i=function(a,e){return!1!==g&&(Z.hyp.test(e)||ja?g=q(h,b,c,e,null,d):(U+e).replace(Z.tail,j)),a},j=function(a){return!1===q(h,b,c,a.substr(1),null,d)&&(g=!1),""};return c=c+U+e,L(a,c+U,!0)&&a.className.replace(o(c),i),f||w(N(a,c+U,!0),function(a){h=a,h.className.replace(o(c),i)}),g}function o(a){return aa[X.ree+a]||F(X.ree+a,new RegExp("(?:^|\\s)"+T+a+U+"(?!"+X.skip+")(\\S+)","g"))}function p(a,b,c,d){d.opt.evfns.push({t:a,v:b,c:c}),d.evcmp.push({t:a,v:b,c:c})}function q(a,b,c,d,e,f){var g=H[d],h=_[d];if(g)try{return h?h(a,b,c):g(a,b,c,f)}catch(i){D(i.message,d)}else if(h)if(e)e.push({t:a,v:b,c:c,s:d,f:h});else try{return h(a,b,c)}catch(i){D(i.message,d)}else v(a,b,d)}function r(a){a||(a=document.body),w(N(a,V.cpt),t),w(N(a,V.tmp),s)}function s(a){var b,c=document.createElement("script"),d=a.className;M(a,V.tmp,!1),M(a,V.od,!1),M(a,V.itm,!0),M(a,V.nw,!0),c.setAttribute("type",X.sct),d&&(b=Z.ityp.exec(d))&&(c._tw_itemType=a.getAttribute("data-"+W.ityp),"true"===c._tw_itemType?c._tw_itemType=!0:"false"===c._tw_itemType&&(c._tw_itemType=!1),c._tw_varsName=b[0].replace(U+W.ityp,"").substr(1)),c._tw_tlen=0,c._tw_template=a,a._tw_targetScr=c,a.parentNode.replaceChild(c,a)}function t(a){var b,c;M(a,V.cln,!0),M(a,V.cpt,!1),c=u(a),c.style.display="",b=a.previousSibling,b&&b.type===X.scc||(b=document.createElement("script"),b.setAttribute("type",X.scc),a.parentNode.insertBefore(b,a)),b._tw_template=c}function u(a){var b,c,d=a.cloneNode(!0),e=d.getElementsByTagName("script");return w(a.getElementsByTagName("script"),function(a,d){(b=a._tw_template)&&(c=e[d],c._tw_template=b,void 0!==a._tw_itemType&&(c._tw_itemType=a._tw_itemType),void 0!==a._tw_varsName&&(c._tw_varsName=a._tw_varsName),void 0!==a._tw_tlen&&(c._tw_tlen=0))}),d}function v(a,b,c){if(!A(b)){var d=c.replace(Z.rbl,""),e=c!==d;"boolean"==typeof a[d]?a[d]=e?!z(b):z(b):(void 0!==a[d]||null!==a.getAttribute(d)||Z.hyp.test(d))&&a.setAttribute(d,b)}}function w(a,b){var c,d;if(a&&b){if(void 0===a.length||a.getAttribute)return b(a);for(c=0,d=a.length;c<d;c++)if(!1===b(a[c],c))return!1}}function x(a,b){var c;if(a&&b)for(c in a)if(a.hasOwnProperty(c)&&!1===b(a[c],c))return!1}function y(a){return null===a?"null":a instanceof Array?"array":void 0===a?"undefined":(0,e.default)(a)}function z(a){switch(y(a)){case"array":return Boolean(a.length);case"object":return Boolean(a);default:return!Z.fls.test(a)}}function A(a){return null===a||void 0===a}function B(){var a=window.console;a&&a.log&&("function"==typeof a.log.apply?a.log.apply(a,arguments):void 0)}function C(){var a=window.console;a&&"function"==typeof a.error?a.error.apply(a,arguments):B(E(arguments))}function D(a,b){throw C("[TagWire.tail."+b+"]  "+a+"."),new Error("TagWire rendering was aborted because of [TagWire.tail."+b+"] error.")}function E(a,b){var c="";return b=b||" ",w(a,function(a){c+=(c?b:"")+a}),c}function F(a,b){return++ba&&(aa[a]=b)}var G,H,I,J,K,L,M,N,O,P,Q,R,S="global",T="_",U="-",V={tmp:"template",rev:"reverse",td:"topdown",bu:"bottomup",tidx:"tidx",idx:"idx",idn:"i",fix:"fix",arr:"array",itm:"item",nw:"new",od:"old",rndr:"render",blk:"block",cpt:"capture",cln:"clone",hidn:"hidden",obda:"objdata",itda:"itemdata",lida:"listdata"},W={list:"list",ityp:"itemtype",asc:"async",itm:"item"},X={sct:"text/tw-template",scc:"text/tw-capture",catp:"data|aria",skip:"\\d+(?="+U+")",cls:"c_",resf:"s_",rep:"r_",ree:"e_",hid:"_tw_"},Y={all:"",ready:"ready",finish:"finish",complete:"complete"},Z={fe:/^\s+/,ityp:new RegExp("\\S*"+U+W.ityp),hyp:new RegExp("^(?:"+X.catp+")-\\S+"),fls:/^\s*(?:false|0|null|undefined|)\s*$/,rbl:/^_/,tail:new RegExp(U+"+[^\\"+U+"]+","g"),fix:new RegExp(T+V.fix+"(\\d+)"),amp:/&amp;/g,lt:/&lt;/g,gt:/&gt;/g},$={},_={},aa={},ba=0,ca=function(a){M(a,V.nw,!1),M(a,V.od,!0)},da=function(a,b){return _[b]=a,a},ea=function(a,b){return delete _[b],a},fa=function(a){M(a,V.hidn,!1)},ga=function(a){L(a,V.hidn)&&fa(a),w(N(a,V.hidn),fa)},ha=document.createElement("span"),ia=""===ha.textContent,ja="-"!==U;return x(Y,function(a){Y.all+=(Y.all?"|":"")+a}),x(W,function(a){X.skip+=(X.skip?"|":"")+a}),Z.ev=new RegExp(T+"([^\\"+U+"]+)"+U+"(?:"+Y.all+")"),function(){var a;ha.classList?(J=function(a,b,c){return c?-1!==a.className.indexOf(b):a.classList&&a.classList.contains(b)},K=function(a,b,c){c?a.classList.add(b):a.classList.remove(b)}):(J=function(a,b,c){var d;return c?-1!==a.className.indexOf(b):(d=aa[b]||F(b,new RegExp("(?:^|\\s)"+b+"(?:\\s|$)")),d.test(a.className))},K=function(a,b,c){var d,e=a.className;c?L(a,b)||(a.className=e?e+" "+b:b):(d=aa[b]||F(b,new RegExp("(?:^|\\s+)"+b+"(?=\\s|$)")),a.className=e.replace(d,"").replace(Z.fe,""))}),L=function(a,b,c){return J(a,T+b,c)},M=function(a,b,c){K(a,T+b,c)},document.querySelectorAll?(I=function(a,b){return a.querySelectorAll("."+b)},N=function(a,b,c){var d;return d=b.indexOf("text/")?c?"[class*="+T+b+"]":"."+T+b:'script[type="'+b+'"]',a.querySelectorAll(d)},a=0,O=function(b,c,d){var e,f,g=!b.id;return g&&(a=a?++a:1,b.id=X.hid+a),e=c.indexOf("text/")?d?"#"+b.id+">[class*="+T+c+"]":"#"+b.id+">."+T+c:"#"+b.id+'>script[type="'+c+'"]',f=b.querySelectorAll(e),g&&(b.id="",a--),f},P=function(a,b,c){var d=O(a,b,c),e=d.length;return e?d[e-1]:null},Q=function(a){return a.attributes}):(I=function(a,b){var c=[];return w(a.getElementsByTagName("*"),function(a){J(a,b)&&c.push(a)}),c},N=function(a,b,c){var d,e=[],f=!b.indexOf("text/"),g=a.getElementsByTagName(f?"script":"*");return d=f?function(a){a.type===b&&e.push(a)}:function(a){L(a,b,c)&&e.push(a)},w(g,d),e},O=function(a,b,c){var d,e=[];return d=b.indexOf("text/")?function(a){L(a,b,c)&&e.push(a)}:function(a){a.type===b&&e.push(a)},w(a.children,d),e},P=function(a,b,c){var d=a.children,e=d.length;if(e){var f,g;for(f=e-1;f>=0;f--)if(g=d[f],L(g,b,c))return g}return null},Z.attl=/(?: )([^\s]+?)=(?:([\'\"]).*?\2|[^ ]+)/g,Q=function(a){var b=[];return a.cloneNode().outerHTML.replace(Z.attl,function(c,d){var f=a.getAttributeNode(d).nodeValue;return"object"!==(void 0===f?"undefined":(0,e.default)(f))&&b.push(d),c}),b}),R="object"===("undefined"==typeof HTMLElement?"undefined":(0,e.default)(HTMLElement))?function(a){return a instanceof HTMLElement}:function(a){return!!a.nodeName}}(),G={tail:_,render:function(b,e,f){var g,h,i,j,k,l;if(ba>500&&(ba=0,aa={}),g="object"===y(e),b&&0!==b.length&&(f||e&&g)){switch(w(b,r),i=!1,j={opt:{},evcmp:[]},y(f)){case"boolean":i=f,f=V.rndr;break;case"undefined":f=V.rndr;break;case"object":i=Boolean(f.async),g&&f.select&&(l=e,e={},w(f.select.split(" "),function(a){void 0!==(k=l[a])&&(e[a]=k)})),f.skip&&(j.skipReg=new RegExp(f.skip.replace(/ +/g,"|"))),j.complete=f.complete,j.ready=f.ready,j.finish=f.finish,f=f.varsName||V.rndr}return g&&f===V.rndr?h=e:(h={},h[f]=e),j.asyncNum=0,j.event={target:b,data:h,name:f,type:Y.complete},i?d(b,h,V.rndr,j):c(b,h,V.rndr,j),a(b),e}},callTail:function(a,b,c,d){w(b,function(b){q(b,c,d,a)})},innerTail:function(a,b,c){if(!c&&"function"==typeof H[a])throw new Error('[TagWire.innerTail] "'+a+'" is already in use.');H[a]=b},addTails:function(a){x(a,da)},removeTails:function(a){x(a,ea)},initTemplate:function(a){w(a,r)},cloneNode:function(a){var b=null;return w(a,function(a){return b=u(a),!1}),b},plugin:function(a,b){var c=void 0===b?"undefined":(0,e.default)(b);return!(!a&&"string"!==a)&&("boolean"===c&&b?($[a]=!0,!0):"function"===c?($[a]=b,!1):!0===(b=$[a])||"function"==typeof b&&b())},ready:function(a){b.ready(r,a)},checkBoolean:z,each:w,oeach:x,typeOf:y,isEmpty:A,log:B,error:C},H={attr:function(a,b,c){var d,e,f;"string"!=typeof c||A(b)||(d="#"+c+"#",e=aa[X.rep+c]||F(X.rep+c,new RegExp(d,"g")),w(Q(a),function(c){c=c.name||c,"string"==typeof(f=a.getAttribute(c))&&-1!==f.indexOf(d)&&a.setAttribute(c,f.replace(e,b))}))},insert:function(a,b,c){var d,e,f,g;"string"!=typeof c||A(b)||(d="#"+c+"#",e=aa[X.rep+c]||F(X.rep+c,new RegExp(d,"g")),ha.innerHTML=b,g=ha.innerHTML.replace(Z.amp,"&").replace(Z.lt,"<").replace(Z.gt,">"),ha.innerHTML="",w(a.childNodes,function(a){"#text"===a.nodeName&&(f=a.nodeValue,-1!==f.indexOf(d)&&(a.nodeValue=f.replace(e,g)))}))},replace:function(a,b,c){var d,e;"string"!=typeof c||A(b)||(d="#"+c+"#",e=aa[X.rep+c]||F(X.rep+c,new RegExp(d,"g")),a.innerHTML=a.innerHTML.replace(e,b))},text:ia?function(a,b){A(b)||(a.textContent=b)}:function(a,b){A(b)||(a.innerText=b)},html:function(a,b){A(b)||(a.innerHTML=b)},val:function(a,b){A(b)||(a.value=b)},data:function(a,b,c){"string"!=typeof c||A(b)||a.setAttribute("data-"+c,b)},dt:function(a,b,c){"string"!=typeof c||A(b)||(a.attrData||(a.attrData={}),a.attrData[c]=b)},show:function(a,b){a.style.display=z(b)?"":"none"},hide:function(a,b){H.show(a,!z(b))},keep:function(a,b){z(b)||(a.parentNode?a.parentNode.removeChild(a):(a.innerHTML="",a._remove=!0))},remove:function(a,b){H.keep(a,!z(b))},setClass:function(a,b,c){K(a,c,z(b))},_setClass:function(a,b,c){K(a,c,!z(b))},addClass:function(a,b){"string"==typeof b&&K(a,b,!0)},removeClass:function(a,b){"string"==typeof b&&K(a,b,!1)},restore:function(a,b){
var c=a.previousSibling;c&&c.type===X.scc&&z(b)&&a.parentNode.replaceChild(u(c._tw_template),a)},_restore:function(a,b){H.restore(a,!z(b))},restoreAttr:function(a,b){var c,d=a.previousSibling;d&&d.type===X.scc&&z(b)&&(c=d._tw_template,w(Q(c),function(b){b=b.name,a.setAttribute(b,c.getAttribute(b))}))},_restoreAttr:function(a,b){H.restoreAttr(a,!z(b))},restoreText:function(a,b){var c,d,e=a.previousSibling;e&&e.type===X.scc&&z(b)&&(c=[],d=0,w(a.childNodes,function(a){"#text"===a.nodeName&&c.push(a)}),w(e._tw_template.childNodes,function(a){"#text"===a.nodeName&&(c[d++].nodeValue=a.nodeValue)}))},_restoreText:function(a,b){H.restoreText(a,!z(b))},restoreHtml:function(a,b){var c=a.previousSibling;c&&c.type===X.scc&&z(b)&&(a.innerHTML=c._tw_template.innerHTML)},_restoreHtml:function(a,b){H.restoreHtml(a,!z(b))},restoreChild:function(a,b){var c,d,e=z(b);w(O(a,X.scc),function(a){c=a.nextSibling,(d=!c||!L(c,V.cln))&&e&&a.parentNode.insertBefore(u(a._tw_template),a.nextSibling)})},_restoreChild:function(a,b){H.restoreChild(a,!z(b))},render:function(a,b){return G.render(a,b),!1},log:function(a,b,c){B("[TagWire:"+T+c+U+"log]","\n - target :",a,"\n - value :",b)}},G}(),void 0!==a&&a.exports?a.exports=b.TagWire:window.TagWire=window.TagWire||b.TagWire,function c(){function a(a,b){var c=d.fn;void 0===c[a]&&(c[a]=b)}var b=window.TagWire,d=window.jQuery;if(b)return d?(b.plugin("jQuery",!0),b.innerTail("data",function(a,b,c){d(a).data(c,b)},!0),d.fn.tagwire=function(a,c){return b.render(this,a,c),this},a("render",d.fn.tagwire),a("callTail",function(a,c,d){return b.callTail(this,a,c,d),this}),a("initTemplate",function(){return b.initTemplate(this),this}),a("copyNode",function(){return d(b.cloneNode(this))}),a("loadAndRender",function(a,c){var e,f,g,h=this;return e={dataType:"json",success:function(a){"function"==typeof f&&f(a),b.render(h,a,c)},error:function(a){"function"==typeof g&&g(a),b.error('[TagWire:loadAndRender]  JSON Parse Error : "'+e.url+'"\n\n',a.responseText)}},"string"==typeof a?e.url=a:(f=a.success,g=a.error,e=d.extend({},a,e)),d.ajax(e),this}),!0):(b.plugin("jQuery",c),!1)}()}()},function(a,b,c){"use strict";a.exports='<!--[ Photoeditor Template : Start ]-->\n<div class="npe_wrap npe_se_wrap">\n<header class="npe_header">\n<div class="npe_header_logo_area npe_logo_area">\n<h1 class="npe_logo npe_se_logo"><em>SmartEditor 3.0</em></h1>\n</div>\n<div class="npe_header_func_btn_area npe_btn_area">\n<button type="button" class="npe_btn_icon npe_btn_undo">\n<span class="npe_btn_title _txt_undo-text">이전</span>\n</button>\n<button type="button" class="npe_btn_icon npe_btn_redo">\n<span class="npe_btn_title _txt_redo-text">다시</span>\n</button>\n<button type="button" class="npe_btn_icon npe_btn_original">\n<span class="npe_btn_title _txt_return_origin-text">초기화</span>\n</button>\n<button type="button" class="npe_btn_icon npe_btn_download">\n<span class="npe_btn_title _txt_image_save-text">사진저장</span>\n</button>\n</div>\n<div class="npe_header_submit_btn_area npe_btn_area">\n<button type="button" class="npe_btn_header npe_btn_cancel">\n<span class="npe_btn_title _txt_cancel-text">취소</span>\n</button>\n<button type="button" class="npe_btn_header npe_btn_submit">\n<span class="npe_btn_title _txt_done-text">완료</span>\n</button>\n</div>\n</header>\n<nav class="npe_control_wrap npe_control_left">\n<div class="npe_control_area">\n<button type="button" data-targetControl="resize" class="npe_btn_control npe_btn_resize _useResize-show _txt_resize-text">크기</button>\n<button type="button" data-targetControl="crop" class="npe_btn_control npe_btn_crop _useCrop-show _txt_crop-text">자르기, 회전</button>\n<button type="button" data-targetControl="filter" class="npe_btn_control npe_btn_filter _useFilter-show _txt_filter-text">필터</button>\n<button type="button" data-targetControl="adjust" class="npe_btn_control npe_btn_effect _useAdjust-show _txt_adjust-text">보정</button>\n<button type="button" data-targetControl="photoFrame" class="npe_btn_control npe_btn_frame _usePhotoFrame-show _txt_frame-text" >액자</button>\n<button type="button" data-targetControl="signature" class="npe_btn_control npe_btn_sign _useSignature-show _txt_signature-text">서명</button>\n<button type="button" data-targetControl="mosaic" class="npe_btn_control npe_btn_mosaic _useMosaic-show _txt_mosaic-text">모자이크</button>\n<button type="button" data-targetControl="text" class="npe_btn_control _useText-show npe_btn_text _txt_text-text">텍스트</button>\n<button type="button" data-targetControl="sticker" class="npe_btn_control _useSticker-show npe_btn_sticker _txt_sticker-text">스티커</button>\n<button type="button" data-targetControl="clip" class="npe_btn_control _useClip-show npe_btn_mask _txt_clip-text">마스크</button>\n</div>\n</nav>\n<section class="npe_edit_wrap">\n<div class="npe_canvas_wrap" id="npe_canvas_wrap">\n<canvas class="npe_canvas"></canvas>\n<div class="npe_deg_wrap">\n<div class="npe_deg">\n</div>\n<div class="npe_deg_option">\n<span class="npe_deg_cursor"></span>\n<button type="button" class="npe_btn_deg_auto"><span class="npe_auto_title _txt_auto-text">자동</span></button>\n</div>\n</div>\n<div class="npe_size_wrap">\n<div class="npe_size_width">\n<span class="npe_size_width_text">W <em class="npe_size_width_num">3000</em></span>\n</div>\n<div class="npe_size_height">\n<span class="npe_size_height_text">H <em class="npe_size_height_num">3000</em></span>\n</div>\n</div>\n<textarea class="npe_text_wrap" wrap="off" spellcheck="false"></textarea>\n<div class="npe_text_hidden"></div>\n</div>\n<div class="npe_sign_wrap">\n<div class="npe_sign_coord_w">\nW <span class="npe_sign_coord_num"></span>\n</div>\n<div class="npe_sign_coord_h">\nH <span class="npe_sign_coord_num"></span>\n</div>\n</div>\n<div class="npe_notice_toast">\n<span class="npe_notice_toast_text">토스트 메시지</span>\n</div>\n<div class="npe_control_detail_wrap">\n<div class="npe_control_detail npe_control_resize"  data-control="resize">\n<strong class="npe_blind">크기</strong>\n<div class="npe_resize_area npe_resize_function_area">\n<button type="button" class="npe_btn_detail_text npe_btn_detail_resize" data-resize="original"><span class="npe_detail_title"><span class="npe_original_text _txt_original_btn-text">원본</span> <span class="npe_original_size"><span class="_width-text"></span> x <span class="_height-text"></span></span></span></button>\n<span class="npe_btn_detail_text npe_btn_detail_resize npe_btn_direct_input _useResizeCustom-keep" data-resize="custom"><input type="text" class="npe_detail_title _txt_direct-attr _txt_direct-val" maxlength="5" data-placeholder="#txt_direct#" /><button type="button" class="npe_btn_direct_input_confirm"></button></span>\n</div>\n<div class="npe_resize_area npe_resize_preset_area _resizePreset _resizePreset-list">\n<button type="button" class="npe_btn_detail_text npe_btn_detail_resize _template _item-replace _item-attr" data-resize="#item#"><span class="npe_detail_title">#item#</span></button>\n</div>\n<span class="npe_detail_bar"></span>\n<div class="npe_resize_area npe_resize_apply_area">\n<button type="button" class="npe_btn_icon npe_btn_apply_all"><span class="npe_btn_title _txt_apply_all-text">모든 사진 적용</span></button>\n<button type="button" class="npe_btn_icon npe_btn_apply_select"><span class="npe_btn_title _txt_apply_select-text">일부 사진 적용</span></button>\n</div>\n</div>\n<div class="npe_control_detail npe_control_crop _cropPreset _cropPreset-list" data-control="crop">\n<strong class="npe_blind">자르기</strong>\n<button type="button" class="npe_btn_icon npe_btn_rotate">\n<span class="npe_btn_title _txt_rotate-text">회전</span>\n</button>\n<button type="button" class="npe_btn_icon npe_btn_horizon">\n<span class="npe_btn_title _txt_flip_horizon-text">좌우반전</span>\n</button>\n<button type="button" class="npe_btn_icon npe_btn_vertical">\n<span class="npe_btn_title _txt_flip_vertical-text">상하반전</span>\n</button>\n<button type="button" class="npe_btn_detail_thumb npe_btn_detail_crop _template _code-attr" data-crop="#code#">\n<div class="npe_detail_thumb_area">\n<span class="npe_detail_thumb">\n<span class="npe_detail_thumb_img"></span>\n</span>\n</div>\n<span class="npe_detail_title _i18n-addI18nTextClass"></span>\n</button>\n<span class="npe_detail_bar"></span>\n<button type="button" class="npe_btn_icon npe_btn_confirm">\n<span class="npe_btn_title _txt_confirm-text">확인</span>\n</button>\n</div>\n<div class="npe_control_detail npe_control_filter _filters" data-control="filter">\n<strong class="npe_blind">필터</strong>\n<button type="button" class="npe_filter_list_arrow npe_filter_list_prev disable"><span class="npe_blind">이전</span></button>\n<div class="npe_detail_filter_area _filters-list">\n<button type="button" class="npe_btn_detail_thumb npe_btn_detail_filter _template _code-attr" data-filter="#code#">\n<div class="npe_detail_thumb_area">\n<span class="npe_detail_thumb">\n<canvas class="npe_detail_thumb_img"></canvas>\n</span>\n</div>\n<span class="npe_detail_title _i18n-addI18nTextClass"></span>\n</button>\n</div>\n<button type="button" class="npe_filter_list_arrow npe_filter_list_next disable"><span class="npe_blind">다음</span></button>\n<span class="npe_detail_bar"></span>\n<button type="button" class="npe_btn_icon npe_btn_apply_all">\n<span class="npe_btn_title _txt_apply_all-text">모든 사진 적용</span>\n</button>\n<button type="button" class="npe_btn_icon npe_btn_apply_select">\n<span class="npe_btn_title _txt_apply_select-text">일부 사진 적용</span>\n</button>\n<div class="npe_control_detail_slide_area npe_slide_area">\n<input type="range" min="0" max="100" step="1" data-base="0" data-basedata="0" data-mindata="0" data-maxdata="1" class="npe_slide npe_slide_filter on">\n<div class="npe_slide_appear">\n<div class="npe_slide_background_track_back"></div>\n<div class="npe_slide_background_track"></div>\n<div class="npe_slide_background_thumb"></div>\n<span class="npe_control_detail_slide_number npe_slide_number">0</span>\n</div>\n</div>\n</div>\n<div class="npe_control_detail npe_control_effect" data-control="adjust">\n<strong class="npe_blind">보정</strong>\n<button type="button" class="npe_btn_icon npe_btn_detail_effect auto_effect" data-adjust="auto_adjust">\n<span class="npe_btn_title _txt_auto_adjustment-text">자동보정</span>\n</button>\n<button type="button" class="npe_btn_icon npe_btn_detail_effect brightness on" data-adjust="brightness">\n<span class="npe_btn_title _txt_brightness-text">밝기</span>\n</button>\n<button type="button" class="npe_btn_icon npe_btn_detail_effect chroma" data-adjust="saturation">\n<span class="npe_btn_title _txt_saturation-text">채도</span>\n</button>\n<button type="button" class="npe_btn_icon npe_btn_detail_effect resolution" data-adjust="sharpen">\n<span class="npe_btn_title _txt_sharpen-text">선명도</span>\n</button>\n<button type="button" class="npe_btn_icon npe_btn_detail_effect color" data-adjust="kelvin">\n<span class="npe_btn_title _txt_kelvin-text">색온도</span>\n</button>\n<button type="button" class="npe_btn_icon npe_btn_detail_effect constrast" data-adjust="contrast">\n<span class="npe_btn_title _txt_contrast-text">대비</span>\n</button>\n<div class="npe_control_detail_slide_area npe_slide_area">\n<input type="range" min="-100" max="100" step="1" data-base="0" data-basedata="0" data-mindata="-0.4" data-maxdata="0.4" class="npe_slide npe_slide_brightness on" data-adjust="brightness">\n<input type="range" min="-100" max="100" step="1" data-base="0" data-basedata="1" data-mindata="0" data-maxdata="4" class="npe_slide npe_slide_chroma" data-adjust="saturation">\n<input type="range" min="-100" max="100" step="1" data-base="0" data-basedata="0" data-mindata="-0.3" data-maxdata="0.3" class="npe_slide npe_slide_resolution" data-adjust="sharpen">\n<input type="range" min="-100" max="100" step="1" data-base="0" data-basedata="0" data-mindata="-0.3" data-maxdata="0.3" class="npe_slide npe_slide_color" data-adjust="kelvin">\n<input type="range" min="-100" max="100" step="1" data-base="0" data-basedata="1" data-mindata="0.5" data-maxdata="1.5" class="npe_slide npe_slide_constrast" data-adjust="contrast">\n<div class="npe_slide_appear">\n<div class="npe_slide_background_track_back"></div>\n<div class="npe_slide_background_track"></div>\n<div class="npe_slide_background_thumb"></div>\n<span class="npe_control_detail_slide_number npe_slide_number">0</span>\n</div>\n</div>\n</div>\n<div class="npe_control_detail npe_control_frame _frames _frames-list" data-control="photoFrame">\n<strong class="npe_blind">액자</strong>\n<button type="button" class="npe_btn_detail_thumb npe_btn_detail_frame _template _code-attr" data-frame="#code#">\n<div class="npe_detail_thumb_area">\n<span class="npe_detail_thumb">\n<img alt="" class="npe_img_frame _src-src _src-keep"/>\n</span>\n</div>\n<span class="npe_detail_title _i18n-addI18nTextClass"></span>\n</button>\n<span class="npe_detail_bar"></span>\n<button type="button" class="npe_btn_icon npe_btn_apply_all"><span class="npe_btn_title _txt_apply_all-text">모든 사진 적용</span></button>\n<button type="button" class="npe_btn_icon npe_btn_apply_select"><span class="npe_btn_title _txt_apply_select-text">일부 사진 적용</span></button>\n</div>\n<div class="npe_control_detail npe_control_sign" data-control="signature">\n<strong class="npe_blind">서명</strong>\n<button type="button" class="npe_btn_icon npe_btn_sign_none on" data-signature="none">\n<span class="npe_btn_title _txt_none_signature-text">서명 안함</span>\n</button>\n<button type="button" class="npe_btn_icon npe_btn_sign_image" data-signature="image">\n<span class="npe_btn_title _txt_image_signature-text">이미지 서명</span>\n</button>\n<button type="button" class="npe_btn_icon npe_btn_sign_text" data-signature="text">\n<span class="npe_btn_title _txt_text_signature-text">텍스트 서명</span>\n</button>\n<span class="npe_detail_bar"></span>\n<button type="button" class="npe_btn_icon npe_btn_apply_all">\n<span class="npe_btn_title _txt_apply_all-text">모든 사진 적용</span>\n</button>\n<button type="button" class="npe_btn_icon npe_btn_apply_select">\n<span class="npe_btn_title _txt_apply_select-text">일부 사진 적용</span>\n</button>\n<div class="npe_detail_option npe_detail_option_sign_image" data-signature="image">\n<span class="npe_sign_image_data _txt_signature_image_input-text">400x200px, 200kb 이하</span>\n<label class="npe_btn_detail npe_btn_detail_text">\n<input class="npe_sign_image_file npe_blind" type="file" accept="image/*">\n<span class="npe_detail_title _txt_signature_image_load-text">불러오기</span>\n</label>\n</div>\n<div class="npe_detail_option npe_detail_option_sign_text" data-signature="text">\n<span class="npe_sign_text_input_area">\n<input type="text" class="npe_sign_text_input _txt_signature_text_placeholder-placeholder" spellcheck="false" readonly />\n</span>\n<div class="npe_text_tool_area">\n<span class="npe_text_tool npe_text_font_family" data-clickcode="PTE_G_FONT">\n<span class="npe_tool_title" title="글꼴">나눔고딕</span>\n<ul class="npe_tool_list npe_text_font_family_list _fonts _fonts-list">\n<li class="npe_tool_item _template _type-data _fontFamily-fontFamily _title-text _title-title _title-data _default-data _i18nClass-addClass" data-title="">폰트명</li>\n</ul>\n</span>\n<span class="npe_text_tool npe_text_font_size" data-clickcode="PTE_G_FONTSIZE">\n<span class="npe_tool_title" title="글자 크기">크기 5</span>\n<ul class="npe_tool_list npe_text_font_size_list _sizes _sizes-list">\n<li class="npe_tool_item _template _item-attr" title="#item#px" data-type="#item#" data-title="#item#px"><span class="_item-text"></span>px</li>\n</ul>\n</span>\n<button type="button" class="npe_text_tool npe_text_font_bold" title="굵게" data-clickcode="PTE_G_BOLD">\n<span class="npe_tool_title"></span>\n</button>\n<button type="button" class="npe_text_tool npe_text_font_italic" title="기울임꼴" data-clickcode="PTE_G_ITALIC">\n<span class="npe_tool_title"></span>\n</button>\n<span class="npe_text_tool npe_text_font_color" title="글자색" data-clickcode="PTE_G_COLOR">\n<span class="npe_tool_title"></span>\n<span class="npe_text_color_preview" style="background-color: #f7f7f7;"></span>\n</span>\n<span class="npe_text_tool npe_text_back_color" title="배경색" data-clickcode="PTE_G_BGCOLOR">\n<span class="npe_tool_title"></span>\n<span class="npe_text_color_preview" style="background-color: #000;"></span>\n</span>\n<div class="npe_color_select_area">\n<div class="npe_color_select_recent">\n<div class="npe_color_select_list _recentColors _recentColors-list">\n<button type="button" title="#item#" class="npe_color_select_item _template _item-attr _item-data _item-backgroundColor"></button>\n</div>\n</div>\n<div class="npe_color_select_table">\n<div class="npe_color_select_list _colors _colors-list">\n<button type="button" title="#item#" class="npe_color_select_item _template _item-attr _item-data _item-backgroundColor"></button>\n</div>\n</div>\n<div class="npe_color_select_input">\n<span class="npe_color_select_preview" style="background-color:#f7f7f7"></span>\n<span class="npe_color_select_code">\n<span class="npe_color_select_code_prefix">#</span>\n<input type="text" class="npe_color_select_code_input" maxlength="6" style="text-transform: uppercase; ime-mode:disabled;">\n</span>\n<div class="npe_color_select_opacity_area">\n<span class="npe_color_select_opacity_title _txt_signature_opacity-text">투명도</span>\n<div class="npe_color_select_opacity_slide npe_slide_area">\n<input type="range" step="1" class="npe_slide on">\n<div class="npe_slide_appear">\n<div class="npe_slide_background_track_back"></div>\n<div class="npe_slide_background_track"></div>\n<div class="npe_slide_background_thumb"></div>\n</div>\n</div>\n<input type="text" class="npe_color_select_opacity_num" maxlength="3" size="3">\n<span class="npe_color_select_opacity_num_control">\n<button type="button" class="npe_num_up"></button>\n<button type="button" class="npe_num_down"></button>\n</span>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n<div class="npe_control_detail npe_control_mosaic" data-control="mosaic">\n<strong class="npe_blind">모자이크</strong>\n<button type="button" class="npe_btn_icon npe_btn_detail_mosaic rect1 on" data-mosaic="square1">\n<span class="npe_btn_title"><span class="_txt_square-text">사각</span>1</span>\n</button>\n<button type="button" class="npe_btn_icon npe_btn_detail_mosaic rect2" data-mosaic="square2">\n<span class="npe_btn_title"><span class="_txt_square-text">사각</span>2</span>\n</button>\n<button type="button" class="npe_btn_icon npe_btn_detail_mosaic rect3" data-mosaic="square3">\n<span class="npe_btn_title"><span class="_txt_square-text">사각</span>3</span>\n</button>\n<button type="button" class="npe_btn_icon npe_btn_detail_mosaic rect4" data-mosaic="square4">\n<span class="npe_btn_title"><span class="_txt_square-text">사각</span>4</span>\n</button>\n<button type="button" class="npe_btn_icon npe_btn_detail_mosaic rect5" data-mosaic="square5">\n<span class="npe_btn_title"><span class="_txt_square-text">사각</span>5</span>\n</button>\n<button type="button" class="npe_btn_icon npe_btn_detail_mosaic circle1" data-mosaic="circle1">\n<span class="npe_btn_title"><span class="_txt_circle-text">원</span>1</span>\n</button>\n<button type="button" class="npe_btn_icon npe_btn_detail_mosaic circle2" data-mosaic="circle2">\n<span class="npe_btn_title"><span class="_txt_circle-text">원</span>2</span>\n</button>\n<button type="button" class="npe_btn_icon npe_btn_detail_mosaic circle3" data-mosaic="circle3">\n<span class="npe_btn_title"><span class="_txt_circle-text">원</span>3</span>\n</button>\n<button type="button" class="npe_btn_icon npe_btn_detail_mosaic circle4" data-mosaic="circle4">\n<span class="npe_btn_title"><span class="_txt_circle-text">원</span>4</span>\n</button>\n<button type="button" class="npe_btn_icon npe_btn_detail_mosaic circle5" data-mosaic="circle5">\n<span class="npe_btn_title"><span class="_txt_circle-text">원</span>5</span>\n</button>\n</div>\n<div class="npe_control_detail npe_control_text" data-control="text">\n<strong class="npe_blind">텍스트</strong>\n<button type="button" class="npe_btn_icon npe_btn_text_add">\n<span class="npe_btn_title _txt_add_text-text">텍스트 추가</span>\n</button>\n<div class="npe_control_text_option_area">\n<div class="npe_text_tool_area">\n<span class="npe_text_tool npe_text_font_family" data-clickcode="PTE_T_FONT">\n<span class="npe_tool_title" title="글꼴">나눔고딕</span>\n<ul class="npe_tool_list npe_text_font_family_list _fonts _fonts-list">\n<li class="npe_tool_item _template _type-data _fontFamily-fontFamily _title-text _title-title _title-data _default-data _i18nClass-addClass" data-title="">폰트명</li>\n</ul>\n</span>\n<span class="npe_text_tool npe_text_font_size" data-clickcode="PTE_T_FONTSIZE">\n<span class="npe_tool_title" title="글자 크기">크기 5</span>\n<ul class="npe_tool_list npe_text_font_size_list _sizes _sizes-list">\n<li class="npe_tool_item _template _item-attr" title="#item#px" data-type="#item#" data-title="#item#px"><span class="_item-text"></span>px</li>\n</ul>\n</span>\n<button type="button" class="npe_text_tool npe_text_font_bold" title="굵게" data-clickcode="PTE_T_BOLD">\n<span class="npe_tool_title"></span>\n</button>\n<button type="button" class="npe_text_tool npe_text_font_italic" title="기울임꼴" data-clickcode="PTE_T_ITALIC">\n<span class="npe_tool_title"></span>\n</button>\n<span class="npe_text_tool npe_text_font_color" title="글자색" data-clickcode="PTE_T_COLOR">\n<span class="npe_tool_title"></span>\n<span class="npe_text_color_preview" style="background-color: #f7f7f7;"></span>\n</span>\n<span class="npe_text_tool npe_text_back_color" title="배경색" data-clickcode="PTE_T_BGCOLOR">\n<span class="npe_tool_title"></span>\n<span class="npe_text_color_preview" style="background-color: #000;"></span>\n</span>\n<div class="npe_color_select_area">\n<div class="npe_color_select_recent">\n<div class="npe_color_select_list _recentColors _recentColors-list">\n<button type="button" title="#item#" class="npe_color_select_item _template _item-attr _item-data _item-backgroundColor"></button>\n</div>\n</div>\n<div class="npe_color_select_table">\n<div class="npe_color_select_list _colors _colors-list">\n<button type="button" title="#item#" class="npe_color_select_item _template _item-attr _item-data _item-backgroundColor"></button>\n</div>\n</div>\n<div class="npe_color_select_input">\n<span class="npe_color_select_preview" style="background-color:#f7f7f7"></span>\n<span class="npe_color_select_code">\n<span class="npe_color_select_code_prefix">#</span>\n<input type="text" class="npe_color_select_code_input" maxlength="6" style="text-transform: uppercase; ime-mode:disabled;">\n</span>\n<div class="npe_color_select_opacity_area">\n<span class="npe_color_select_opacity_title _txt_signature_opacity-text">투명도</span>\n<div class="npe_color_select_opacity_slide npe_slide_area">\n<input type="range" step="1" class="npe_slide on">\n<div class="npe_slide_appear">\n<div class="npe_slide_background_track_back"></div>\n<div class="npe_slide_background_track"></div>\n<div class="npe_slide_background_thumb"></div>\n</div>\n</div>\n<input type="text" class="npe_color_select_opacity_num" maxlength="3" size="3">\n<span class="npe_color_select_opacity_num_control">\n<button type="button" class="npe_num_up"></button>\n<button type="button" class="npe_num_down"></button>\n</span>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n<div class="npe_control_detail npe_control_sticker" data-control="sticker">\n<strong class="npe_blind">스티커</strong>\n<div class="npe_sticker_area">\n<div class="npe_sticker_list _stickerPacks _stickerPacks-list">\n<div class="npe_sticker_item _template _type-data _packCode-data">\n<button type="button" class="npe_btn_detail_sticker">\n<img class="npe_sticker_img_off _tabOffImg-src" alt="">\n<img class="npe_sticker_img_on _tabOnImg-src" alt="">\n</button>\n<div class="npe_sticker_detail_wrap">\n<div class="npe_sticker_detail_area">\n<div class="npe_sticker_detail_list _packCode-data _stickers _stickers-list">\n<button type="button" class="npe_sticker_item_detail _template _original-data _code-data _itemdata-stickerSprite"></button>\n</div>\n</div>\n</div>\n</div>\n<div class="npe_sticker_item _grafolioMarketBtnWrap">\n<button type="button" class="npe_btn_detail_sticker _grafolioMarketBtn">\n<i class="npe_icon_plus"></i>\n</button>\n</div>\n</div>\n</div>\n</div>\n<div class="npe_control_detail npe_control_mask _masks _masks-list" data-control="clip">\n<strong class="npe_blind">마스크</strong>\n<button type="button" class="npe_btn_icon npe_btn_detail_mask no_apply _mask_btn" data-code="-1">\n<span class="npe_btn_title"><span class="_txt_none_apply-text">적용 안함</span></span>\n</button>\n<span class="npe_detail_bar"></span>\n<button type="button" class="npe_btn_icon npe_btn_detail_mask _mask_btn _template _code-data _className-addClass">\n<span class="npe_btn_title"><span class="_i18n-addI18nTextClass">원</span></span>\n</button>\n<span class="npe_detail_bar"></span>\n<span role="button" class="npe_btn_icon npe_btn_detail_mask _mask_outline_btn outline">\n<span class="npe_btn_title"><span class="_txt_outline-text">테두리</span></span>\n</span>\n<div class="npe_color_select_area">\n<div class="npe_color_select_border_area">\n<span class="npe_color_select_border_title">두께</span>\n<div class="npe_color_select_border_slide npe_slide_area">\n<input type="range" step="1" class="npe_slide on">\n<div class="npe_slide_appear">\n<div class="npe_slide_background_track_back"></div>\n<div class="npe_slide_background_track"></div>\n<div class="npe_slide_background_thumb"></div>\n</div>\n</div>\n<input type="text" class="npe_color_select_opacity_num" maxlength="3" size="3">\n<span class="npe_color_select_opacity_num_control">\n<button class="npe_num_up"></button>\n<button class="npe_num_down"></button>\n</span>\n</div>\n<div class="npe_color_select_recent">\n<div class="npe_color_select_list _recentColors _recentColors-list">\n<button type="button" title="#item#" class="npe_color_select_item _template _item-attr _item-data _item-backgroundColor"></button>\n</div>\n</div>\n<div class="npe_color_select_table">\n<div class="npe_color_select_list _colors _colors-list">\n<button type="button" title="#item#" class="npe_color_select_item _template _item-attr _item-data _item-backgroundColor"></button>\n</div>\n</div>\n<div class="npe_color_select_input">\n<span class="npe_color_select_preview" style="background-color:#f7f7f7"></span>\n<span class="npe_color_select_code">\n<span class="npe_color_select_code_prefix">#</span>\n<input type="text" class="npe_color_select_code_input" maxlength="6" style="text-transform: uppercase; ime-mode:disabled;">\n</span>\n<div class="npe_color_select_opacity_area">\n<span class="npe_color_select_opacity_title _txt_signature_opacity-text">투명도</span>\n<div class="npe_color_select_opacity_slide npe_slide_area">\n<input type="range" step="1" class="npe_slide on">\n<div class="npe_slide_appear">\n<div class="npe_slide_background_track_back"></div>\n<div class="npe_slide_background_track"></div>\n<div class="npe_slide_background_thumb"></div>\n</div>\n</div>\n<input type="text" class="npe_color_select_opacity_num" maxlength="3" size="3">\n<span class="npe_color_select_opacity_num_control">\n<button class="npe_num_up"></button>\n<button class="npe_num_down"></button>\n</span>\n</div>\n</div>\n</div>\n<span class="npe_detail_bar"></span>\n<button type="button" class="npe_btn_icon npe_btn_confirm">\n<span class="npe_btn_title _txt_confirm-text">확인</span>\n</button>\n</div>\n</div>\n</section>\n<footer class="npe_image_list_wrap">\n<label class="npe_view_set"><input type="checkbox" class="npe_view_set_check npe_blind"><i class="npe_icon_check"></i><span class="npe_view_set_title _txt_fill_the_screen-text">화면 맞춤</span></label>\n<div class="npe_image_list_area">\n<div class="npe_image_list_header">\n<div class="npe_image_list_header_title">\n<span class="list_title _txt_image_list-text">이미지 목록</span><span class="list_num _total-show" style="display:none"><em class="now_num _now-text">6</em><span class="total_num"> / <em class="_total-text">14</em></span></span>\n<div class="npe_image_list_header_btn_area">\n<button type="button" class="npe_btn_edit_order _txt_edit_order-text">순서 편집</button>\n<button type="button" class="npe_btn_sort_reverse _txt_reverse-text">역순으로</button>\n<span class="npe_image_list_header_bar"></span>\n<span class="list_open_close list_open on"><em class="list_open_close_title _txt_open-text">열기</em></span>\n<span class="list_open_close list_close"><em class="list_open_close_title _txt_close-text">닫기</em></span>\n</div>\n</div>\n</div>\n<div class="npe_image_list_header npe_select_header">\n<div class="npe_image_list_header_title">\n<button type="button" class="npe_btn_select_all" title="전체 선택"></button>\n<span class="list_title _txt_choice_photos_apply-text">적용할 사진을 선택하세요.</span> <span class="list_num _txt_selected_count-html"><em class="now_num">6</em>장 선택함</span>\n<div class="npe_image_list_header_btn_area">\n<button type="button" class="npe_btn_image_select npe_btn_cancel">\n<span class="npe_btn_title _txt_cancel-text">취소</span>\n</button>\n<button type="button" class="npe_btn_image_select npe_btn_submit">\n<span class="npe_btn_title _txt_apply-text">적용</span>\n</button>\n</div>\n</div>\n</div>\n<div class="npe_image_list_header npe_order_header">\n<div class="npe_image_list_header_title">\n<span class="list_title _txt_drag_photos-text">사진을 끌어서 순서를 바꿔 보세요. 문서에 첨부된 사진 순서도 함께 바뀝니다.</span> <span class="list_num _txt_selected_count-html"><em class="now_num">6</em>장 선택함</span>\n<div class="npe_image_list_header_btn_area">\n<button type="button" class="npe_btn_image_select npe_btn_cancel">\n<span class="npe_btn_title _txt_cancel-text">취소</span>\n</button>\n<button type="button" class="npe_btn_image_select npe_btn_submit">\n<span class="npe_btn_title _txt_apply_edit_order-text">순서 편집 완료</span>\n</button>\n</div>\n</div>\n</div>\n<div class="npe_image_list_content">\n<button type="button" class="npe_image_list_arrow npe_image_list_prev"><span class="npe_blind">이전</span></button>\n<ul class="npe_image_list _list _list-list">\n<li class="npe_image_list_item _template _key-attr _isReady-_setLoadingClass" data-key="#key#" draggable="true">\n<div class="npe_image_list_thumb_wrap">\n<span class="npe_image_list_thumb" href="#">\n<span class="npe_image_list_thumb_img _thumbnailSrc-background"></span>\n</span>\n</div>\n<i class="npe_image_item_checked"></i>\n</li>\n</ul>\n<button type="button" class="npe_image_list_arrow npe_image_list_next"><span class="npe_blind">다음</span></button>\n</div>\n<div class="npe_image_list_tooltip _txt_editor_sort_tooltip-html">\n끌어서 이미지 순서를 변경할 수 있어요. 변경시 에디터에 첨부된 이미지 순서도 함께 변경됩니다.\n</div>\n</div>\n</footer>\n<div class="npe_canvas_loading"></div>\n<div class="npe_notice_tooltip">\n<i class="npe_icon_tooltip_hand"></i>\n<span class="npe_notice_tooltip_text _txt_notice_compare-html">이미지를 누르면<br>원본과 비교할 수 있어요</span>\n</div>\n<div class="npe_alert_wrap">\n<div class="npe_alert">\n<strong class="npe_alert_title _txt_alert_error-text">\n앗, 에러가 발생했습니다!\n</strong>\n<strong class="npe_alert_title_small">\nJPG, GIF, PNG, BMP 이미지 파일을 올릴 수 있습니다.\n<br>한 장당 10MB, 1회 500MB까지 올리기 가능합니다.\n</strong>\n<p class="npe_alert_description">다시 한 번 시도해 주시겠어요?</p>\n<p class="npe_alert_description_long">\n저작권자의 원 권리자의 허락을 받지 않은 이미지의 수정 및 사용,<br>다른 사람의 권리 침해, 명예를 훼손하는 이미지는 <br><em class="highlight">이용약관 및 관련 법률에 의해 제재를 받으실 수 있습니다.</em>\n</p>\n<div class="npe_alert_uploading_area">\n<div class="npe_alert_uploading_total">\n<div class="npe_alert_progress_bar_wrap">\n<div class="npe_alert_progress_bar _totalPercent-widthPercent"></div>\n</div>\n<span class="npe_alert_text">전체</span>\n<span class="npe_alert_num_area">\n<em class="npe_alert_num _uploadCnt-text">0</em>/<em class="npe_alert_num_total _listCnt-text">0</em>장\n</span>\n</div>\n<div class="npe_alert_uploading_part">\n<div class="npe_alert_progress_bar_wrap">\n<div class="npe_alert_progress_bar"></div>\n</div>\n<span class="npe_alert_text _currentFileName-text">IMG_8333.JPG</span>\n<span class="npe_alert_num_perent"><span class="_percent-text"></span>%</span>\n</div>\n<div class="npe_alert_uploading_error _errorResultMessage-show">\n<i class="npe_icon_info"></i><span class="npe_alert_text _errorResultMessage-text">전체 50장 중 10장을 추가하지 못했습니다.</span>\n<button type="button" class="npe_btn_alert_toggle close _errorLogs-show">\n<span class="npe_btn_alert_title _btnTxt-text">닫기</span>\n</button>\n<div class="npe_alert_detail_area _errorLogs-show">\n<ul class="npe_alert_detail_list _errorLogs _errorLogs-list">\n<li class="npe_alert_detail_item _template">\n<span class="npe_alert_detail_filename _fileName-text">IMG_파일명글자수여기까지..</span>\n<span class="npe_alert_detail_fileext _fileExt-text">JPG</span>\n<span class="npe_alert_detail_text _message-text">최대 500MB까지 사진을 추가할 수 있습니다.</span>\n</li>\n</ul>\n</div>\n</div>\n</div>\n<div class="npe_alert_btn_area">\n<button type="button" class="npe_btn npe_alert_btn_cancel">\n<em class="npe_btn_title _txt_alert_cancel-text">취소</em>\n</button>\n<button type="button" class="npe_btn npe_alert_btn_ok">\n<em class="npe_btn_title _txt_alert_ok-text">확인</em>\n</button>\n</div>\n<div class="npe_alert_sns_area">\n<button type="button" class="npe_btn_sns npe_btn_facebook" data-sns="facebook">\n<div class="npe_btn_sns_img"></div>\n<span class="npe_btn_sns_title _txt_facebook-text">페이스북</span>\n</button>\n<button type="button" class="npe_btn_sns npe_btn_pholar" data-sns="pholar">\n<div class="npe_btn_sns_img"></div>\n<span class="npe_btn_sns_title _txt_pholar-text">폴라</span>\n</button>\n<button type="button" class="npe_btn_sns npe_btn_instagram" data-sns="instagram">\n<div class="npe_btn_sns_img"></div>\n<span class="npe_btn_sns_title _txt_instagram-text">인스타그램</span>\n</button>\n</div>\n<div class="npe_alert_save_area">\n<button type="button" class="npe_btn_save npe_btn_mycomputer">\n<div class="npe_btn_save_img"></div>\n<span class="npe_btn_save_title _txt_mypc-text">내 컴퓨터</span>\n</button>\n<button type="button" class="npe_btn_save npe_btn_cloud">\n<div class="npe_btn_save_img"></div>\n<span class="npe_btn_save_title _txt_navercloud-text">네이버 클라우드</span>\n</button>\n</div>\n<button type="button" class="npe_alert_btn_close"></button>\n<label class="npe_alert_btn_hide">\n<input type="checkbox" class="npe_alert_hide_check npe_blind">\n<i class="npe_check_icon"></i>\n<span class="npe_btn_title _txt_dont_see_again-text">다시 보지 않기</span>\n</label>\n</div>\n</div>\n</div>';
},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(90),f=d(e),g=c(0),h=d(g),i=c(7),j=d(i),k=c(12),l=d(k),m=c(8),n=d(m),o=c(11),p=d(o),q=c(16),r=d(q),s=c(5),t=d(s);c(418),n.default.LIST={LIST_WRAP:".npe_image_list_wrap",LIST_AREA:".npe_image_list_content",LIST:".npe_image_list",LIST_ITEM:".npe_image_list_item",LIST_ITEM_THUMB_WRAP:".npe_image_list_thumb_wrap",LIST_NUMS:".list_num",LIST_HEADER:".npe_image_list_header",LIST_OPEN_CLOSE_BTN:".list_open_close",LIST_OPEN_BTN:".list_open",LIST_CLOSE_BTN:".list_close",LIST_PREV_BTN:".npe_image_list_prev",LIST_NEXT_BTN:".npe_image_list_next",LIST_TOOLTIP:".npe_image_list_tooltip",LIST_HEADER_BAR:".npe_image_list_header_bar",LIST_SORT_MODE_BTN:".npe_btn_edit_order",LIST_SORT_REVERSE_BTN:".npe_btn_sort_reverse",LIST_SORT_CANCEL_BTN:".npe_order_header .npe_btn_cancel",LIST_SORT_SUBMIT_BTN:".npe_order_header .npe_btn_submit",LIST_SELECT_ALL_BTN:".npe_select_header .npe_btn_select_all",LIST_SELECT_CANCEL_BTN:".npe_select_header .npe_btn_cancel",LIST_SELECT_SUBMIT_BTN:".npe_select_header .npe_btn_submit",LIST_SELECT_NUM_WRAP:".npe_select_header .list_num, .npe_order_header .list_num",LIST_SELECT_NUM:".npe_select_header .now_num, .npe_order_header .now_num",SELECT_MODE_WRAP_TOGGLE_CLASS:"on_image_select"};var u=function(){function a(b){(0,h.default)(this,a),this._controller=b,this.init()}return a.prototype.init=function(){var a=this;this._source=null,this._showTooltip=!0,this._mode=p.default.LIST_MODE.LIST;var b=this.$wrapper=(0,t.default)(n.default.PHOTOEDITOR_WRAP);this.$canvas=b.find(n.default.CANVAS_WRAP).find(n.default.CANVAS),this.$listHeader=b.find(n.default.LIST.LIST_HEADER),this.$listWrap=b.find(n.default.LIST.LIST_WRAP),this.$listArea=this.$listWrap.find(n.default.LIST.LIST_AREA),this.$list=this.$listWrap.find(n.default.LIST.LIST),this.$listPrevBtn=this.$listWrap.find(n.default.LIST.LIST_PREV_BTN),this.$listNextBtn=this.$listWrap.find(n.default.LIST.LIST_NEXT_BTN),this.$listTooltip=this.$listWrap.find(n.default.LIST.LIST_TOOLTIP),this.$listHeaderBar=this.$listWrap.find(n.default.LIST.LIST_HEADER_BAR),this.$controlDetailWrap=b.find(n.default.CONTROL_DETAIL_WRAP),this.$controlWrap=b.find(n.default.CONTROL_WRAP),this.$listSortModeBtn=this.$listWrap.find(n.default.LIST.LIST_SORT_MODE_BTN),this.$listSortReverseBtn=this.$listWrap.find(n.default.LIST.LIST_SORT_REVERSE_BTN),this.$listSortCancelBtn=this.$listWrap.find(n.default.LIST.LIST_SORT_CANCEL_BTN),this.$listSortSubmitBtn=this.$listWrap.find(n.default.LIST.LIST_SORT_SUBMIT_BTN),this.$listSelectAllBtn=this.$listWrap.find(n.default.LIST.LIST_SELECT_ALL_BTN),this.$listSelectCancelBtn=this.$listWrap.find(n.default.LIST.LIST_SELECT_CANCEL_BTN),this.$listSelectSubmitBtn=this.$listWrap.find(n.default.LIST.LIST_SELECT_SUBMIT_BTN),this.$listSelectNumWrap=this.$listWrap.find(n.default.LIST.LIST_SELECT_NUM_WRAP),this.$list.selectonic({multi:!0,keyboard:!1,focusBlur:!0,selectionBlur:!1,selectedClass:n.default.ACTIVE_TOGGLE_CLASS,mouseMode:"toggle",before:function(a){return function(b){var c=b&&(0,t.default)(b.target).closest(n.default.LIST.LIST_ITEM)||null;if(c&&c.hasClass(n.default.DISABLE_TOGGLE_CLASS)||!1||a._isListMode())return this.selectonic("cancel"),!1}}(this),select:function(){a._renderMultiSelectImageNum(),a._renderBtnDisable()},unselect:function(){a._renderMultiSelectImageNum(),a._renderBtnDisable()}})},a.prototype.activate=function(){this.$listArea.on("click",this._onClickImageListArea.bind(this)),this.$list.on("click",n.default.LIST.LIST_ITEM,this._onClickImageListItem.bind(this)),this.$list.on("mouseenter",n.default.LIST.LIST_ITEM,this._onMouseenterImageListItem.bind(this)),this.$list.on("mouseleave",n.default.LIST.LIST_ITEM,this._onMouseleaveImageListItem.bind(this)),this.$list.on("scroll",this._checkEnableListScrollBtn.bind(this)),this.$listHeader.on("click",this._onClickListHeader.bind(this)),this.$listPrevBtn.on("click",this._onClickListPrevBtn.bind(this)),this.$listNextBtn.on("click",this._onClickListNextBtn.bind(this)),this.$listSortModeBtn.on("click",this._onClickSortModeBtn.bind(this)),this.$listSortReverseBtn.on("click",this._onClickSortReverseBtn.bind(this)),this.$listSortCancelBtn.on("click",this._onClickSortCancelBtn.bind(this)),this.$listSortSubmitBtn.on("click",this._onClickSortSubmitBtn.bind(this)),this.$listSelectAllBtn.on("click",this._onClickSelectAllBtn.bind(this)),this.$listSelectCancelBtn.on("click",this._onClickSelectCancelBtn.bind(this)),this.$listSelectSubmitBtn.on("click",this._onClickSelectSubmitBtn.bind(this)),this.$wrapper.on("click.dimmed",this._onClickDimmedArea.bind(this)),this.$list.on("dragstart","li",this._onListDragStart.bind(this)),this.$list.on("dragenter","li",this._onListDragEnter.bind(this)),this.$list.on("dragend","li",this._onListDragEnd.bind(this)),this.$listWrap.on("dragover",this._onListDragOver.bind(this)),this.$list.on("drop",this._onListDrop.bind(this)),(0,t.default)(window).on("resize.peList",this._onResizeWindow.bind(this)),(0,t.default)(window).on("keydown.peList",this._onKeydown.bind(this)),this._controller.once("open",this._onOpen.bind(this)),this._controller.on("canvasReady",this._onCanvasReady.bind(this)),this._controller.on("setPhotos",this._onSetPhotos.bind(this)),this._controller.on("updatePhotos",this._onUpdatePhotos.bind(this)),this._controller.on("beforeChangeCurrentPhoto",this._beforeChangeCurrentPhoto.bind(this)),this._controller.on("changeCurrentPhoto",this._onChangeCurrentPhoto.bind(this)),this._controller.on("changeListMode",this._onChangeListMode.bind(this)),this._controller.on("setBatchApplyToThumbnail",this._onSetBatchApplyToThumbnail.bind(this))},a.prototype.deactivate=function(){this.$listArea.off("click"),this.$list.off(),this.$listHeader.off("click"),this.$listPrevBtn.off("click"),this.$listNextBtn.off("click"),this.$listSortModeBtn.off("click"),this.$listSortReverseBtn.off("click"),this.$listSortCancelBtn.off("click"),this.$listSortSubmitBtn.off("click"),this.$listSelectAllBtn.off("click"),this.$listSelectCancelBtn.off("click"),this.$listSelectSubmitBtn.off("click"),this.$wrapper.off("click.dimmed"),this.$list.off("dragstart"),this.$list.off("dragenter"),this.$list.off("dragend"),this.$listWrap.off("dragover"),this.$list.off("drop"),(0,t.default)(window).off("resize.peList"),(0,t.default)(window).off("keydown.peList")},a.prototype._render=function(a,b){l.default.render(a,b)},a.prototype._renderBtnDisable=function(){var a=(this.$listSelectAllBtn,this.$list.find(n.default.LIST.LIST_ITEM).filter(":not(."+n.default.DISABLE_TOGGLE_CLASS+")")),b=a.filter("."+n.default.ACTIVE_TOGGLE_CLASS);this.$listSelectAllBtn.toggleClass(n.default.DISABLE_TOGGLE_CLASS,!a.length.length),this.$listSelectAllBtn.toggleClass(n.default.ACTIVE_TOGGLE_CLASS,!(!a.length||a.length!==b.length))},a.prototype._onResizeWindow=function(){this._checkEnableListScrollBtn(),this._resizeListHeight()},a.prototype._onOpen=function(){this._openList(),this._prevControl=null},a.prototype._onCanvasReady=function(){this._controller.getCurrentPhoto().isEditable?this._prevControl&&this._controller.changeControl(this._prevControl):this._controller.changeControl(),this._setListMode(),this._resizeControlDetailWrap(),this._renderCurrentImageThumbnail(),this._onCanvasReadyForAnimationEnd()},a.prototype._openList=function(){this.$listWrap.addClass("open"),this._isSelectMode()||this._resizeControlDetailWrap(),this._showListTooltip()},a.prototype._closeList=function(){this.$listWrap.removeClass("open"),this._resizeControlDetailWrap()},a.prototype._toggleList=function(a){a?this._openList():this._closeList(),this._controller.resizeViewport(!0)},a.prototype._onListDragStart=function(a){if(!this._isSelectMode()){if(this._isSortMode()){var b=a&&a.currentTarget,c=(0,t.default)(b)||null;!c||c.hasClass(n.default.ACTIVE_TOGGLE_CLASS)||c.hasClass(n.default.DISABLE_TOGGLE_CLASS)||this._multiSelectPhoto(a)}window.getSelection().removeAllRanges();var d=j.default.getIEVersion(),e=a.originalEvent.dataTransfer;this._source=a.currentTarget,e.effectAllowed="move",d||e.setData("text/plain",null)}},a.prototype._resizeControlDetailWrap=function(){this.$controlDetailWrap.css({"padding-bottom":this.$listWrap.outerHeight()}),this.$controlWrap.css({"margin-bottom":this.$listWrap.outerHeight()})},a.prototype._onListDragEnter=function(a){this._source&&(a.preventDefault(),(0,t.default)(this._source).addClass(n.default.LIST.LIST_DRAG_ITEM_CLASS))},a.prototype._onListDragEnd=function(a){this._source&&((0,t.default)(this._source).removeClass(n.default.LIST.LIST_DRAG_ITEM_CLASS),this._source=null),this._hideListDragBar()},a.prototype._onListDragOver=function(a){if(this._source){a.preventDefault();var b=this._source,c=(0,t.default)(a.target).closest("li[draggable]").get(0);if(a.originalEvent.dataTransfer.dropEffect="move",c){var d=(0,t.default)(c),e=this._isBefore(a,c)?"left_bar":"right_bar";d.hasClass(e)||this._hideListDragBar(),d.addClass(e)}else this._hideListDragBar();if(this._isSortMode()&&!this.$listArea.is(":animated")){var f=a.clientY-this.$listArea.offset().top,g=this.$listArea.outerHeight(),h=(0,t.default)(b).outerHeight(!0);f<h/2&&this.$listArea.stop().animate({scrollTop:"-="+h+"px"}),f>g-h/2&&this.$listArea.stop().animate({scrollTop:"+="+h+"px"})}if(this._isListMode()&&!this.$list.is(":animated")){var i=a.clientX-this.$list.offset().left,j=this.$list.outerWidth(),k=(0,t.default)(b).outerWidth(!0);i<k/2&&this.$list.stop().animate({scrollLeft:"-="+k+"px"}),i>j-k/2&&this.$list.stop().animate({scrollLeft:"+="+k+"px"})}}},a.prototype._hideListDragBar=function(){this.$list.find(n.default.LIST.LIST_ITEM).removeClass("left_bar").removeClass("right_bar")},a.prototype._onListDrop=function(a){this._source&&(a.preventDefault&&a.preventDefault(),a.stopPropagation&&a.stopPropagation(),this._multiModeDrop(a),this._source=null)},a.prototype._multiModeDrop=function(a){var b=this._source,c=a.target,d=(0,t.default)(c).closest("li[draggable]").get(0),e=this._isListMode()?(0,t.default)(b):this.$list.find(n.default.LIST.LIST_ITEM).filter("."+n.default.ACTIVE_TOGGLE_CLASS);if(e.length&&d){if(this._startSortAnimation(),this._isBefore(a,d)||(d=d.nextSibling),!this._isListMode()&&(0,t.default)(d).hasClass(n.default.ACTIVE_TOGGLE_CLASS)){var f=(0,t.default)(d).nextAll(":not(."+n.default.ACTIVE_TOGGLE_CLASS+")").get(0);f||(f=(0,t.default)(d).nextAll().last().get(0),f=f?f.nextSibling:null),d=f}d?(0,t.default)(d).before(e):this.$list.append(e),(0,t.default)(this._source).removeClass(n.default.LIST.LIST_DRAG_ITEM_CLASS),this._resetPhotosIndex(),this._renderImageNum(this._controller.getCurrentPhoto()),this._updateSortAnimation(),r.default.log("PTE_L_DROP",c,a)}this._multiSelectBasePhotoKey=this.$list.find(n.default.LIST.LIST_ITEM+":first").data("key")},a.prototype._startSortAnimation=function(){var a=(this.$list,this.$list.find(n.default.LIST.LIST_ITEM)),b=(0,t.default)(a.get().reverse());b.each(function(a,b){(0,t.default)(b).data("position",(0,t.default)(b).position())})},a.prototype._updateSortAnimation=function(){var a=this,b=this.$list.find(n.default.LIST.LIST_ITEM);b.each(function(c,d){var e=(0,t.default)(d),f=e.data("position"),g=e.position();f.left===g.left&&f.top===g.top||(e.css({"-webkit-transform":"translate("+(f.left-g.left)+"px,"+(f.top-g.top)+"px)","-moz-transform":"translate("+(f.left-g.left)+"px,"+(f.top-g.top)+"px)","-ms-transform":"translate("+(f.left-g.left)+"px,"+(f.top-g.top)+"px)","-o-transform":"translate("+(f.left-g.left)+"px,"+(f.top-g.top)+"px)",transform:"translate("+(f.left-g.left)+"px,"+(f.top-g.top)+"px)"}),e.addClass("moving"),e.one("webkitAnimationEnd oanimationend msAnimationEnd animationend",function(c){(0,t.default)(c.target).css({"-webkit-transform":"translate(0,0)","-moz-transform":"translate(0,0)","-ms-transform":"translate(0,0)","-o-transform":"translate(0,0)",transform:"translate(0,0)"}),(0,t.default)(c.target).removeClass("moving"),b.filter(":animated").length||a._endSortAnimation()}))})},a.prototype._endSortAnimation=function(){this._isSortMode()&&this._deselectAllPhotos()},a.prototype._resetPhotosIndex=function(){var a=this;this.$list.find(n.default.LIST.LIST_ITEM).each(function(b,c){var d=(0,t.default)(c).data("key");a._controller.getPhotoByKey(d).index=b})},a.prototype._isBefore=function(a,b){var c=(0,t.default)(b),d=c.offset().left,e=c.outerWidth();return a.clientX<d+e/2},a.prototype._renderImageList=function(){var a=this._controller.getPhotosArray(),b=this.$list;this._render(b,{list:a})},a.prototype._renderImageListAdded=function(a){var b=this.$list;b.addClass("_topdown"),this._render(b,{list:a}),b.removeClass("_topdown")},a.prototype._renderImageListUpdated=function(a){var b=this;a.forEach(function(a,c){b._renderImage(a)})},a.prototype._renderImage=function(a){var b=this.$list.find(n.default.LIST.LIST_ITEM),c=b.filter("*[data-key='"+a.key+"']");b.removeClass(n.default.ACTIVE_TOGGLE_CLASS),c.addClass(n.default.ACTIVE_TOGGLE_CLASS),this._render(c,a)},a.prototype._renderImageNum=function(a){a=a||this._controller.getCurrentPhoto();var b=this.$listWrap.find(n.default.LIST.LIST_NUMS),c=this.$list.find(n.default.LIST.LIST_ITEM),d=a?c.filter("*[data-key='"+a.key+"']"):null,e=c.index(d)+1,f=this._controller.photos.length;f>1?(this.$listSortReverseBtn.show(),this.$listHeaderBar.show()):(this.$listSortReverseBtn.hide(),this.$listHeaderBar.hide()),this._render(b,{now:e,total:f})},a.prototype._onSetPhotos=function(){this._renderImageList(),this._checkEnableListScrollBtn(),this._showListTooltip()},a.prototype._onUpdatePhotos=function(a){this._renderImageListAdded(a.photosAdded),this._renderImageListUpdated(a.photosUpdated),this._renderImageNum(this._controller.getCurrentPhoto()),this._checkEnableListScrollBtn()},a.prototype._beforeChangeCurrentPhoto=function(a){var b=a.prevPhoto;this._renderImageThumbnail(b)},a.prototype._renderCurrentImageThumbnail=function(){var a=this._controller.getCurrentPhoto();if(a){var b=this.$list.find(n.default.LIST.LIST_ITEM),c=b.filter("*[data-key='"+a.key+"']"),d=a.cropWidth||a.width,e=a.cropHeight||a.height,f=j.default.getThumbnailImageSizeForCover(d,e,400,400),g=f[0],h=f[1];this._render(c,{thumbnailSrc:this._controller.getThumbnailDataURL(g,h)})}},a.prototype._renderImageThumbnail=function(a){if(a){var b=this.$list.find(n.default.LIST.LIST_ITEM),c=b.filter("*[data-key='"+a.key+"']");this._render(c,{thumbnailSrc:a.thumbnailSrc})}},a.prototype._onChangeCurrentPhoto=function(){var a=this._controller.getCurrentPhoto();this._renderImageNum(a),this._renderImage(a),this._adjustListScroll(a)},a.prototype._onClickListHeader=function(a){a.preventDefault();var b=(0,t.default)(a.target),c=this.$listWrap.hasClass("open");!b.closest("button").length&&this._isListMode()&&(c?r.default.log("PTE_L_CLOSE",a.currentTarget,a):r.default.log("PTE_L_OPEN",a.currentTarget,a),this._toggleList(!c))},a.prototype._showListTooltip=function(){var a=this;this._showTooltip&&(this._controller.photos.length<2||(this._showTooltip=!1,this.$listTooltip.addClass(n.default.ACTIVE_TOGGLE_CLASS),this.$wrapper.one("mousedown",function(){a.$listTooltip.removeClass(n.default.ACTIVE_TOGGLE_CLASS)})))},a.prototype._onClickListPrevBtn=function(a){a.preventDefault();var b=a.currentTarget;(0,t.default)(b).hasClass(n.default.DISABLE_TOGGLE_CLASS)||(this._moveListScroll(-1),r.default.log("PTE_L_PREV",b,a))},a.prototype._onClickListNextBtn=function(a){a.preventDefault();var b=a.currentTarget;(0,t.default)(b).hasClass(n.default.DISABLE_TOGGLE_CLASS)||(this._moveListScroll(1),r.default.log("PTE_L_NEXT",b,a))},a.prototype._moveListScroll=function(a){var b=this.$list,c=a>0?"+=":"-=",d=b.innerWidth(),e=b.scrollLeft(),f=b.children(n.default.LIST.LIST_ITEM).first().outerWidth(),g=void 0;a>0&&(g=Math.floor((e+d)/f)*f-e),a<0&&(g=d-(Math.ceil(e/f)*f-e)),g&&this.$list.stop(!0,!0).animate({scrollLeft:c+g},{duration:150,specialEasing:{width:"linear",height:"easeOut"}})},a.prototype._onClickSortModeBtn=function(a){a.preventDefault(),this._openList(),this._saveSortState(),this._setSortMode(),this._controller.resizeViewport(!0),r.default.log("PTE_L_EDIT",a.currentTarget,a)},a.prototype._onClickSortReverseBtn=function(a){a.preventDefault(),this._openList(),this._reverseImageListItem(),this._controller.resizeViewport(!0),r.default.log("PTE_L_REVERSE",a.currentTarget,a)},a.prototype._onClickSortCancelBtn=function(a){this._restoreSortState(),this._setListMode(),this._resizeControlDetailWrap(),this._controller.resizeViewport(!0)},a.prototype._onClickSortSubmitBtn=function(a){var b=this._controller.getCurrentPhoto();this._setListMode(),this._selectPhoto(b.key),this._controller.resizeViewport(!0),r.default.log("PTE_L_SAVE",a.currentTarget,a)},a.prototype._onClickSelectAllBtn=function(a){var b=this.$list.find(n.default.LIST.LIST_ITEM).filter(":not(."+n.default.DISABLE_TOGGLE_CLASS+")"),c=b.filter("."+n.default.ACTIVE_TOGGLE_CLASS);b.length===c.length?this.$list.selectonic("unselect",b):this.$list.selectonic("select",b),this._renderMultiSelectImageNum()},a.prototype._onClickSelectCancelBtn=function(a){this._restoreSortState(),this._setListMode(),this._resizeControlDetailWrap(),this._controller.resizeViewport(!0),this._controller.callbackMultiSelectPhotos()},a.prototype._onClickSelectSubmitBtn=function(a){var b=this,c=this.$list.find(n.default.LIST.LIST_ITEM).filter("."+n.default.ACTIVE_TOGGLE_CLASS),d=[];c.length&&(c.each(function(){var a=(0,t.default)(this),c=a.data("key"),e=b._controller.getPhotoByKey(c);d.push(e)}),this._setListMode(),this._resizeControlDetailWrap(),this._controller.resizeViewport(!0),this._controller.callbackMultiSelectPhotos(d),this._restoreSortState())},a.prototype._onClickImageListArea=function(a){a.preventDefault();(0,t.default)(a.target).closest(n.default.LIST.LIST_ITEM).length||this._isSortMode()&&this._deselectAllPhotos()},a.prototype._onClickImageListItem=function(a){var b=this;a.preventDefault();var c=a.currentTarget,d=(0,t.default)(c),e=d.data("key");this._isListMode()&&(d.hasClass(n.default.ACTIVE_TOGGLE_CLASS)||d.hasClass(n.default.DISABLE_TOGGLE_CLASS)||this._controller.isWaitingAsyncResponseEvent()||this._controller._asyncConfirmCropSave("txt_confirm_crop_tit").then(function(){return b._controller._asyncConfirmClipSave("txt_confirm_clip_tit",!0)}).then(function(){return b._exitCropControlMode()}).then(function(){return b._selectPhoto(e)}))},a.prototype._exitCropControlMode=function(){if(-1!==[p.default.CONTROLS.CROP,p.default.CONTROLS.CLIP].indexOf(this._controller.currentControl))return this._controller.changeControl()},a.prototype._selectPhoto=function(a){var b=this.$canvas,c=this._controller.getCurrentPhoto();if(c.key===a)return this._renderImage(c),void this._adjustListScroll(c);this._renderImageThumbnail(c),b.removeClass(n.default.ACTIVE_TOGGLE_CLASS),b.hide(),this._controller.once("canvasReady",function(){b.one("webkitAnimationEnd oanimationend msAnimationEnd animationend",function(a){(0,t.default)(a.target).removeClass(n.default.ACTIVE_TOGGLE_CLASS)}),setTimeout(function(){b.show(),b.addClass(n.default.ACTIVE_TOGGLE_CLASS)},100)}),this._prevControl=this._controller.currentControl,this._controller.selectPhoto(a)},a.prototype._onCanvasReadyForAnimationEnd=function(a){var b=this;this.$canvas.is(":visible")||(this.$canvas.one("webkitAnimationEnd oanimationend msAnimationEnd animationend",function(a){(0,t.default)(a.target).removeClass(n.default.ACTIVE_TOGGLE_CLASS)}),setTimeout(function(){b.$canvas.show(),b.$canvas.addClass(n.default.ACTIVE_TOGGLE_CLASS)},100))},a.prototype._onMouseenterImageListItem=function(a){var b=(0,t.default)(a.currentTarget);this._isListMode()&&b.addClass(n.default.HOVER_TOGGLE_CLASS)},a.prototype._onMouseleaveImageListItem=function(a){(0,t.default)(a.currentTarget).removeClass(n.default.HOVER_TOGGLE_CLASS)},a.prototype._reverseImageListItem=function(){var a=this,b=this._controller.getCurrentPhoto(),c=this.$list,d=this.$list.find(n.default.LIST.LIST_ITEM),e=d.length;d.each(function(){var b=(0,t.default)(this),d=b.data("key"),f=a._controller.getPhotoByKey(d);e-=1,f.index=e,b.prependTo(c)}),this._adjustListScroll(),this._renderImageNum(b)},a.prototype._checkEnableListScrollBtn=function(){var a=this.$list,b=this.$listPrevBtn,c=this.$listNextBtn;a.scrollLeft()?b.removeClass(n.default.DISABLE_TOGGLE_CLASS):b.addClass(n.default.DISABLE_TOGGLE_CLASS),a.scrollLeft()+a.innerWidth()<a.get(0).scrollWidth?c.removeClass(n.default.DISABLE_TOGGLE_CLASS):c.addClass(n.default.DISABLE_TOGGLE_CLASS)},a.prototype._adjustListScroll=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;a=a||this._controller.getCurrentPhoto();var b=this.$list,c=b.find(n.default.LIST.LIST_ITEM),d=c.filter("*[data-key='"+a.key+"']"),e=d.outerWidth(),f=d.offset().left,g=b.innerWidth(),h=parseInt(b.css("padding-left"),10),i=parseInt(b.css("padding-right"),10),j=b.offset().left+h,k={duration:0};f<j&&b.stop(!0,!0).animate({scrollLeft:"-="+(j-f)},k),j+g<f+e-i&&b.stop(!0,!0).animate({scrollLeft:"+="+(f+e-(j+g-i))},k)},a.prototype._onKeydown=function(a){var b=a.keyCode;this.$listWrap.hasClass("open")&&this._hasLeftRightKeyCode(b)&&this._selectPhotoByKeyboard(a,b)},a.prototype._hasLeftRightKeyCode=function(a){return-1!==[p.default.KEYCODES.LEFT,p.default.KEYCODES.RIGHT].indexOf(a)},a.prototype._selectPhotoByKeyboard=function(a,b){var c=a.target,d=this._controller.getCurrentPhoto();if(!(0,t.default)(c).is("input")&&!(0,t.default)(c).is("textarea")&&"true"!==(0,t.default)(c).attr("contenteditable")&&d){var e=this._controller.getPhotosArray(),f=e.length,g=d.index,h=this.$list,i=void 0;b===p.default.KEYCODES.LEFT&&g--,b===p.default.KEYCODES.RIGHT&&g++,0<=g&&g<f&&(a.preventDefault(),i=h.find(n.default.LIST.LIST_ITEM),i.eq(g).trigger("click"))}},a.prototype._onChangeListMode=function(a){a===p.default.LIST_MODE.LIST&&(this._restoreSortState(),this._setListMode(),this._openList()),a===p.default.LIST_MODE.SELECT&&(this._saveSortState(),this._setSelectMode(),this._openList()),a===p.default.LIST_MODE.SORT&&(this._saveSortState(),this._setSortMode(),this._openList()),this._controller.resizeViewport(!0)},a.prototype._setListMode=function(){this._mode=p.default.LIST_MODE.LIST,this._controller._listMode=this._mode,this.$listWrap.removeClass("multi").removeClass("select").removeClass("edit_order"),this.$wrapper.removeClass(n.default.LIST.SELECT_MODE_WRAP_TOGGLE_CLASS),this.$list.find(n.default.LIST.LIST_ITEM).prop("draggable",!0),this._activateAllItems(),this._controller.unsetDimmed(),this._checkEnableListScrollBtn()},a.prototype._isListMode=function(){return this._mode===p.default.LIST_MODE.LIST},a.prototype._setSelectMode=function(){this._mode=p.default.LIST_MODE.SELECT,this._multiSelectBasePhotoKey=this.$list.find(n.default.LIST.LIST_ITEM+":first").data("key"),this._controller._listMode=this._mode,this.$listWrap.addClass("multi").addClass("select").removeClass("edit_order"),this.$wrapper.addClass(n.default.LIST.SELECT_MODE_WRAP_TOGGLE_CLASS),this.$list.find(n.default.LIST.LIST_ITEM).prop("draggable",!1),this._deactivateNotEditableItems(),this._resizeListHeight(),this._renderMultiSelectImageNum(),this._controller.setDimmed()},a.prototype._isSelectMode=function(){return this._mode===p.default.LIST_MODE.SELECT},a.prototype._activateAllItems=function(){this.$list.find(n.default.LIST.LIST_ITEM).removeClass(n.default.DISABLE_TOGGLE_CLASS)},a.prototype._deactivateNotEditableItems=function(){var a=this;this.$list.find(n.default.LIST.LIST_ITEM).each(function(b,c){var d=(0,t.default)(c).data("key"),e=a._controller.getPhotoByKey(d);(0,t.default)(c).toggleClass(n.default.DISABLE_TOGGLE_CLASS,!e.isEditable)})},a.prototype._setSortMode=function(){this._mode=p.default.LIST_MODE.SORT,this._multiSelectBasePhotoKey=this.$list.find(n.default.LIST.LIST_ITEM+":first").data("key"),this._controller._listMode=this._mode,this.$listWrap.addClass("multi").removeClass("select").addClass("edit_order"),this.$wrapper.addClass(n.default.LIST.SELECT_MODE_WRAP_TOGGLE_CLASS),this.$list.find(n.default.LIST.LIST_ITEM).removeClass(n.default.ACTIVE_TOGGLE_CLASS).prop("draggable",!0),this._resizeListHeight(),this._renderMultiSelectImageNum(),this._controller.setDimmed()},a.prototype._isSortMode=function(){return this._mode===p.default.LIST_MODE.SORT},a.prototype._resizeListHeight=function(){this.$listArea.css("max-height",this.$wrapper.height()-this.$listHeader.height())},a.prototype._getSortState=function(){var a=this.$list.find(n.default.LIST.LIST_ITEM),b={keys:[]};return a.each(function(){b.keys.push((0,t.default)(this).data("key"))}),b},a.prototype._saveSortState=function(){this._sortState=this._getSortState()},a.prototype._restoreSortState=function(){var a=this;if(this._sortState){var b=this._controller.getCurrentPhoto(),c=this._sortState,d=this.$list,e=this.$list.find(n.default.LIST.LIST_ITEM);c.keys.forEach(function(b,c){var f=e.filter("[data-key='"+b+"']");a._controller.getPhotoByKey(b).index=c,f.appendTo(d)}),this._selectPhoto(b.key),this._adjustListScroll(),this._renderImageNum(b),this._sortState=null}},a.prototype._isSortStateChanged=function(){var a=this._sortState&&(0,f.default)(this._getSortState())!==(0,f.default)(this._sortState),b=!!this.$list.find(n.default.LIST.LIST_ITEM).filter("."+n.default.ACTIVE_TOGGLE_CLASS).length;return a||b},a.prototype._multiSelectPhoto=function(a){var b=(0,t.default)(a.currentTarget),c=this.$list.find(n.default.LIST.LIST_ITEM),d=a.shiftKey,e=b.data("key"),f=this._multiSelectBasePhotoKey?c.filter("[data-key='"+this._multiSelectBasePhotoKey+"']"):null;if(this._multiSelectBasePhotoKey=e,d&&f){for(var g=c.index(f),h=c.index(b),i=(0,t.default)([]),j=Math.min(g,h);j<=Math.max(g,h);j++)c.eq(j).hasClass(n.default.DISABLE_TOGGLE_CLASS)||(i=i.add(c.eq(j)));i.addClass(n.default.ACTIVE_TOGGLE_CLASS)}else b.hasClass(n.default.ACTIVE_TOGGLE_CLASS)&&(this._multiSelectBasePhotoKey=null),b.toggleClass(n.default.ACTIVE_TOGGLE_CLASS);"mousedown"===a.type&&(this._passMultiSelectPhotoByClick=!0),this._renderMultiSelectImageNum()},a.prototype._deselectAllPhotos=function(){var a=this.$list.find(n.default.LIST.LIST_ITEM),b=a.filter("."+n.default.ACTIVE_TOGGLE_CLASS);b.length&&b.removeClass(n.default.ACTIVE_TOGGLE_CLASS),this._multiSelectBasePhotoKey=null,this._renderMultiSelectImageNum()},a.prototype._renderMultiSelectImageNum=function(){var a=this.$list.find(n.default.LIST.LIST_ITEM),b=a.filter("."+n.default.ACTIVE_TOGGLE_CLASS).length;this.$listWrap.find(n.default.LIST.LIST_SELECT_NUM).text(b),b?this.$listSelectNumWrap.show():this.$listSelectNumWrap.hide()},a.prototype._onClickDimmedArea=function(a){(0,t.default)(a.target).closest(this.$listWrap).length||this._isListMode()||this._isSortStateChanged()||(this._isSelectMode()?this.$listSelectCancelBtn.trigger("click"):this._isSortMode()&&this.$listSortCancelBtn.trigger("click"))},a.prototype._onSetBatchApplyToThumbnail=function(){var a=this;this.$list.find(n.default.LIST.LIST_ITEM).each(function(b,c){var d=(0,t.default)(c).data("key"),e=a._controller.getPhotoByKey(d);a._renderImageThumbnail(e)})},a}();b.default=u},function(a,b,c){"use strict";var d,e,f,g=c(4),h=function(a){return a&&a.__esModule?a:{"default":a}}(g);!function(g){e=[c(5)],d=g,void 0!==(f="function"==typeof d?d.apply(b,e):d)&&(a.exports=f)}(function(a){function b(b,c,d){return this._schema=b,this._options={},this._callbacks={},this.set(a.extend({},c,d||{}),!0),this}function c(d,e){this._name=c.pluginName,this.el=d,this.$el=a(d),this.ui={},this._selected=0,this._isEnable=!0,this._keyModes={},this.options=new b(k,j,e);var f=this;this.options.on("filter",function(a){return f._itemsSelector="."+f.options.get("listClass")+" "+a,a}),this.options.on("autoScroll",function(a){return f._setScrolledElem(a),a}),this._itemsSelector="."+this.options.get("listClass")+" "+this.options.get("filter"),this._setScrolledElem(this.options.get("autoScroll")),this._init()}var d=a.fn.outerHeight?"outerHeight":"height";a.fn.jquery||a.fn.zepto||(a.fn.zepto=!0);var e=function(a,b,c){var d,e,f,g=null,h=0;c=c||{};var i=function(){h=!1===c.leading?0:new Date,g=null,f=a.apply(d,e)};return function(){var j=new Date;h||!1!==c.leading||(h=j);var k=b-(j-h);return d=this,e=arguments,k<=0?(clearTimeout(g),g=null,h=j,f=a.apply(d,e)):g||!1===c.trailing||(g=setTimeout(i,k)),f}},f=Array.prototype.indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(this[b]===a)return b;return-1},g=function(a,b){return a instanceof Array&&f.call(a,b)>=0},i=a(window.document);b.isCorrectType=function(a,b){var c=void 0===a?"undefined":(0,h.default)(a),d=null===a&&b.nullable;return b.type instanceof Array?g(b.type,c)||d:c===b.type||d},b.prototype.set=function(c,d){var e,f;for(e in c){var h=c[e],i=this._schema[e];if(void 0!==i){if(i.unchangeable&&!d)throw new Error('Option "'+e+'" could be setted once at the begining.');if(!b.isCorrectType(h,i)){var j='Option "'+e+'" must be '+(i.type instanceof Array?i.type.join(", "):i.type)+(i.nullable?" or null.":".");throw new TypeError(j)}if(i.values&&!g(i.values,h))throw new RangeError('Option "'+e+'" only could be in these values: "'+i.values.join('", "')+'".')}}for(e in c)(f=this._callbacks[e])&&(c[e]=f.call(this,c[e]));this._options=a.extend(this._options,c)},b.prototype.get=function(b){return b?this._options[b]:a.extend({},this._options)},b.prototype.on=function(a,b){this._callbacks[a]=b},b.prototype.off=function(a){this._callbacks[a]&&delete this._callbacks[a]};var j={filter:"> *",multi:!0,mouseMode:"standard",focusBlur:!1,selectionBlur:!1,handle:null,textSelection:!1,focusOnHover:!1,keyboard:!1,keyboardMode:"select",autoScroll:!0,loop:!1,preventInputs:!0,listClass:"j-selectable",focusClass:"j-focused",selectedClass:"j-selected",disabledClass:"j-disabled",create:null,before:null,focusLost:null,select:null,unselect:null,unselectAll:null,stop:null,destroy:null},k={filter:{type:"string"},multi:{type:"boolean"},mouseMode:{type:"string",values:["standard","mouseup","toggle"]},focusBlur:{type:"boolean"},selectionBlur:{type:"boolean"},handle:{type:"string",nullable:!0},textSelection:{type:"boolean"},focusOnHover:{type:"boolean"},keyboard:{type:"boolean"},keyboardMode:{type:"string",values:["select","toggle"]},autoScroll:{type:["boolean","string"]},loop:{type:"boolean"},preventInputs:{type:"boolean"},listClass:{type:"string",unchangeable:!0},focusClass:{type:"string",unchangeable:!0},selectedClass:{type:"string",unchangeable:!0},disabledClass:{type:"string",unchangeable:!0},create:{type:"function",nullable:!0},before:{type:"function",nullable:!0},focusLost:{type:"function",nullable:!0},select:{type:"function",nullable:!0},unselect:{type:"function",nullable:!0},unselectAll:{type:"function",nullable:!0},stop:{type:"function",nullable:!0},destroy:{type:"function",nullable:!0}};c.pluginName="selectonic",c.keyCode={DOWN:40,UP:38,SHIFT:16,END:35,HOME:36,PAGE_DOWN:34,PAGE_UP:33,A:65,SPACE:32,ENTER:13},c.getDataObject=function(b){return a(b).data("plugin_"+c.pluginName)},c.prototype._init=function(){this.$el.addClass(this.options.get("listClass")),this._bindEvents(),this.$el.data("plugin_"+c.pluginName,this),this._trigger("create")},c.prototype._setScrolledElem=function(b){var c;if(null===b||!1===b)return void delete this._scrolledElem;if("string"==typeof b){if(c=a(b),!(c.length>0))throw new Error('There are no elements that matches to selector - "'+b+'"');return void(this._scrolledElem=c[0])}this._scrolledElem=this.el},c.prototype._cancel=function(b,c){if(!c.wasCancelled){c.isCancellation=this._isPrevented=!0;var d=this;a.each(a(c.changedItems),function(e,f){c.prevItemsStates[e]?d._select(b,c,a(f),!0):d._unselect(b,c,a(f),!0)}),c.prevFocus&&this._setFocus(c.prevFocus),delete c.isCancellation,c.wasCancelled=!0}},c.prototype._bindEvents=function(){var a=this,b=this._name;this._mouseEvent=function(b){a._isEnable&&1===b.which&&a._mouseHandler.call(a,b)},this._keyboardEvent=function(b){a.options.get("keyboard")&&a._isEnable&&a._keyHandler.call(a,b)},this._selectstartEvent=function(){if(!a.options.get("textSelection"))return!1},this._mousemoveEvent=e(function(b){a._isEnable&&a.options&&a.options.get("focusOnHover")&&a._mousemoveHandler.call(a,b);
},20),i.on("keydown."+b,this._keyboardEvent),i.on("keyup."+b,this._keyboardEvent),i.on("mousemove."+b,this._mousemoveEvent),i.on("click."+b,this._mouseEvent),i.on("mousedown."+b,this._mouseEvent),i.on("mouseup."+b,this._mouseEvent),this.$el.on("selectstart."+b,this._selectstartEvent)},c.prototype._unbindEvents=function(){var a=this._name;i.off("keydown."+a,this._keyboardEvent),i.off("keyup."+a,this._keyboardEvent),i.off("mousemove."+a,this._mousemoveEvent),i.off("click."+a,this._mouseEvent),i.off("mousedown."+a,this._mouseEvent),i.off("mouseup."+a,this._mouseEvent),this.$el.off("selectstart."+a,this._selectstartEvent)},c.prototype._getTarget=function(b){for(var c,d,e,f=b.target,g=this.options.get("handle");null!==f&&f!==this.el;)c=a(f),c.context=window.document,c.is(this._itemsSelector)&&(d=f),g&&c.is(g)&&(e=f),f=f.parentNode;return g&&f&&e?d:!g&&f?d:null},c.prototype._getItems=function(b,c,d){var e;switch(c){case"next":case"prev":for(var f=d.jquery?d:a(d),g=a.fn[c];;){if(f=g.call(f),0===f.length)break;if(f.context=window.document,f.is(this._itemsSelector))return f}return null;case"pageup":case"pagedown":return this._getNextPageElem(b,c,d);case"first":return e=b.allItems?b.allItems:this.$el.find(this.options.get("filter")),b.allItems=e,e.first();case"last":return e=b.allItems?b.allItems:this.$el.find(this.options.get("filter")),b.allItems=e,e.last();default:return e=b.allItems?b.allItems:this.$el.find(this.options.get("filter")),b.allItems=e,void 0!==c&&a.isNumeric(c)?e.eq(c):e}},c.prototype._getNextPageElem=function(b,c,e){var f,g,h,i,j,k=b.isShiftPageRange,l=this._scrolledElem||this.el,m=l.clientHeight,n=a(window)[d](),o=a(e),p=m>n,q=p?n:m,r=o[d](),s=r,t=r,u="pageup"===c?"prev":"next";for(k&&(u="pageup"===c?-1:1,i=this._getItems(b),b.rangeStart=h=i.index(e));;){if(k?(h+=u,j=h>=0?i.eq(h):null,f=j&&j.length>0?j:null):f=this._getItems(b,u,o),!f&&o[0]===e)break;if(!f)return k&&(b.rangeEnd=h-u),o;if(g=f[d](),(t+=g)>q)return s+g>q?(k&&(b.rangeEnd=h),f):(k&&(b.rangeEnd=h-u),o);s=g,o=f}return null},c.prototype._trigger=function(a,b,c){var d,e=this.options.get(a);if(e){if("create"===a||"destroy"===a)return e.call(this.$el);switch(d={},c.target&&(d.target=c.target),this.ui.focus&&(d.focus=this.ui.focus),a){case"select":d.items=c.selected;break;case"unselectAll":case"unselect":d.items=c.unselected;break;case"stop":c.wasCancelled||(d.items=c.changedItems)}e.call(this.$el,b||null,d)}},c.prototype._controller=function(a,b){var c;if(b.changedItems=[],b.prevItemsStates=[],delete this._isPrevented,this._trigger("before",a,b),this._isPrevented)return this._cancel(a,b),void this._stop(a,b);b.wasSelected=this._selected>0,b.target&&void 0===b.isTargetWasSelected&&(b.isTargetWasSelected=this._getIsSelected(b.target)),b.isRangeSelect&&b.isTargetWasSelected&&b.target===this.ui.focus||(b.isRangeSelect?this._perfomRangeSelect(a,b):b.isMultiSelect?(c=b.isTargetWasSelected?this._unselect:this._select,c.call(this,a,b,b.items)):b.target&&!b.items&&"mouseover"===a.type||(b.target&&b.items?(this._selected&&1===this._selected&&this._getIsSelected(this.ui.focus)?this._unselect(a,b,this.ui.focus,b.isTargetWasSelected):this._selected&&this._unselectAll(a,b),this._select(a,b,b.items,b.isTargetWasSelected)):!b.target&&this._selected>0&&this.options.get("selectionBlur")&&this._unselectAll(a,b))),!this._selected&&b.wasSelected&&this._trigger("unselectAll",a,b),b.prevFocus=this.ui.focus?this.ui.focus:null,!b.target&&this.options.get("focusBlur")?this._blur(a,b):b.target&&!b.wasCancelled&&this._setFocus(b.target),this._stop(a,b)},c.prototype._perfomRangeSelect=function(a,b){var c,d,e,f,g,h,i,j=b.rangeStart<b.rangeEnd,k=this._getItems(b),l=j?b.rangeStart:b.rangeEnd,m=j?b.rangeEnd:b.rangeStart;b.isNewSolidSelection?(d=k.slice(0,l),d=d.add(k.slice(m+1)),this._unselect(a,b,d),this._select(a,b,b.items)):this.ui.solidInitialElem&&!b.isTargetWasSelected&&(e=b.items.index(this.ui.solidInitialElem))>=0?(e=j?b.rangeStart+e:b.rangeEnd+e,f=e<b.rangeStart,g=b.rangeStart<e,h=e<b.rangeEnd,i=b.rangeEnd<e,(!h&&f||!i&&g)&&(d=g?k.slice(l,e):k.slice(e+1,m+1),d.length>0&&this._unselect(a,b,d)),(i&&!g||h&&!f)&&(d=i?k.slice(l,e):k.slice(e+1,m+1),d.length>0&&this._select(a,b,d))):(c=b.isTargetWasSelected?this._unselect:this._select,c.call(this,a,b,b.items))},c.prototype._changeItemsStates=function(b,c,d){var e=c>0,f=[],g=this;a(b).each(function(b,h){var i=g._getIsSelected(h),j=e?!i:i;(!(h===d.target&&d.isTargetWasSelected)||e||d.isMultiSelect||d.isRangeSelect)&&(j&&(d.isCancellation||(f.push(h),d.prevItemsStates.push(i)),g._selected+=c),a(h).toggleClass(g.options.get("selectedClass"),e))}),d.isCancellation||(d[e?"selected":"unselected"]=a(f),d.changedItems=d.changedItems.concat(f))},c.prototype._select=function(a,b,c,d){this._changeItemsStates(c,1,b),d||this._trigger("select",a,b),this._isPrevented&&!b.isCancellation&&this._cancel(a,b)},c.prototype._unselect=function(a,b,c,d){this._changeItemsStates(c,-1,b),d||this._trigger("unselect",a,b),this._isPrevented&&!b.isCancellation&&this._cancel(a,b)},c.prototype._unselectAll=function(a,b){var c,d;this._selected&&0!==this._selected&&(d=this._getItems(b),c=b.target&&b.isTargetWasSelected&&1===this._selected,this._unselect(a,b,d,c))},c.prototype._multiSelect=function(b){return b.isMultiSelect=!0,a(b.target)},c.prototype._rangeSelect=function(b){if(b.isRangeSelect=!0,b.target===this.ui.focus)return a(b.target);var c=b.allItems?b.allItems:this._getItems(b),d=c.index(b.target),e=c.index(this.ui.focus),f=d<e?c.slice(d,e):c.slice(e,d);return f.push(d<e?c[e]:c[d]),b.allItems=c,b.rangeStart=e,b.rangeEnd=d,f},c.prototype._getIsSelected=function(b){var c=this.options.get();return a(b).length<=1?a(b).hasClass(c.selectedClass):a.map(a(b),function(b){return a(b).hasClass(c.selectedClass)})},c.prototype._blur=function(b,c,d){!d&&this.ui.focus&&this._trigger("focusLost",b,c),this.ui.focus&&(a(this.ui.focus).removeClass(this.options.get("focusClass")),delete this.ui.focus)},c.prototype._setFocus=function(b){if(b)return this.ui.focus&&a(this.ui.focus).removeClass(this.options.get("focusClass")),this.ui.focus=b,a(this.ui.focus).addClass(this.options.get("focusClass")),this.ui.focus},c.prototype._stop=function(a,b){this._trigger("stop",a,b),this._isPrevented&&this._cancel(a,b)},c.prototype._checkIfElem=function(b){var c;return!(!b||!(b.jquery||b.zepto||b.nodeType))&&(b=b.jquery||b.zepto?b:a(b),c=b.filter(this._itemsSelector),c.length>0?c:null)},c.prototype._checkIfSelector=function(a){var b;return!(!a||"string"!=typeof a)&&(b=this.$el.find(a).filter(this._itemsSelector),b.jquery&&b.length>0?b:null)},c.prototype._keyHandler=function(b){if(this.options.get("keyboard")&&!(this.options.get("preventInputs")&&"INPUT"===b.target.tagName||"TEXTAREA"===b.target.tagName)){var d,e,f,g,h=b.which,i={};if("keyup"===b.type)return void(h===c.keyCode.SHIFT&&(delete this._shiftModeAction,delete this._keyModes.shift));if(h===c.keyCode.A&&this._isMulti(b)&&this.options.get("multi"))d=this._getItems(i),e=!0;else switch(h){case c.keyCode.DOWN:f="next",d=this._findNextTarget("next",i);break;case c.keyCode.UP:f="prev",d=this._findNextTarget("prev",i);break;case c.keyCode.HOME:f="prev",d=this._getItems(i,"first");break;case c.keyCode.END:f="next",d=this._getItems(i,"last");break;case c.keyCode.PAGE_DOWN:case c.keyCode.PAGE_UP:var j=h===c.keyCode.PAGE_DOWN;f=j?"next":"prev",g=j?"pagedown":"pageup",i.isShiftPageRange=this.options.get("multi")&&b.shiftKey&&!e,d=this._findNextTarget(g,i);break;case c.keyCode.SPACE:d=a(this.ui.focus);break;case c.keyCode.ENTER:this.options.get("multi")||(d=a(this.ui.focus))}f&&b.preventDefault(),d&&d.length>0?(i.target=d[0],i.items=d,"toggle"===this.options.get("keyboardMode")?(h===c.keyCode.SPACE||h===c.keyCode.ENTER&&!this.options.get("multi")||delete i.items,this.options.get("multi")&&(i.isMultiSelect=!0),delete this.ui.solidInitialElem):this.ui.focus&&this.options.get("multi")&&b.shiftKey&&!e?(h===c.keyCode.END||h===c.keyCode.HOME||h===c.keyCode.PAGE_UP||h===c.keyCode.PAGE_DOWN?this._rangeVariator(i):this._multiVariator(i,h,f,d),this.ui.solidInitialElem||i.target===this.ui.focus||(this.ui.solidInitialElem=this.ui.focus,i.isNewSolidSelection=!0),this._shiftModeAction||(this._shiftModeAction="select"),this._keyModes.shift||(this._keyModes.shift=h)):delete this.ui.solidInitialElem,this._controller(b,i),this.scroll()):(i.prevItemsStates=[],this._trigger("before",b,i),this._trigger("stop",b,i))}},c.prototype._rangeVariator=function(a){var b=void 0===a.isFocusSelected?this._getIsSelected(this.ui.focus):a.isFocusSelected,c=a.isTargetWasSelected=this._getIsSelected(a.target);b||c?(a.items=this._rangeSelect(a),c&&(a.items=a.rangeStart<a.rangeEnd?a.items.slice(0,a.items.length-1):a.items.slice(1))):(a.target=a.items=this.ui.focus,a.isMultiSelect=!0)},c.prototype._multiVariator=function(a,b,c,d){var e,f=void 0===a.isFocusSelected?this._getIsSelected(this.ui.focus):a.isFocusSelected,g=this._getIsSelected(a.target),h=this._getItems(a,c,d),i=this._getIsSelected(h);if(this._keyModes.shift&&this._keyModes.shift!==b&&(this._keyModes.shift=this._shiftModeAction=null),this._keyModes.shift&&"select"===this._shiftModeAction&&g){for(;this._getIsSelected(a.items)&&a.items.length>0;)e=a.items,a.items=this._getItems(a,c,a.items);a.target=a.items?a.items:e}else g&&f&&!i?(this._keyModes.shift=this._shiftModeAction=null,a.items=this.ui.focus):f&&g?(a.items=this.ui.focus,this._shiftModeAction||(this._shiftModeAction="unselect")):f||(a.target=a.items=this.ui.focus);a.isMultiSelect=!0},c.prototype._findNextTarget=function(a,b){var c="next"===a||"pagedown"===a?"first":"last",d=this.ui.focus?this._getItems(b,a,this.ui.focus):this._getItems(b,c);return null!==d&&0!==d.length||!this.options.get("loop")||(d=this._getItems(b,c)),d},c.prototype._refreshBoxScroll=function(b){var c=a(b),e=b===window,f=e?c[d]():b.clientHeight,g=c.scrollTop(),h=e?0:c.offset().top,i=a(this.ui.focus),j=i[d](),k=e?i.offset().top:i.offset().top-h+g;k<g?c.scrollTop(k):k+j>g+f&&c.scrollTop(k+j-f)},c.prototype._isRange=function(a){return a.shiftKey||a.shiftKey&&a.ctrlKey||a.shiftKey&&a.metaKey},c.prototype._isMulti=function(a){return a.ctrlKey||a.metaKey},c.prototype._mouseHandler=function(b){var c=this.options.get(),d=b.type,e=this._isMulti(b),f=this._isRange(b),g={};if("mouseup"===c.mouseMode){if(g.target=this._getTarget(b),"click"===d||g.target&&"mousedown"===d)return}else{if("click"===d&&!this._mousedownOnItem)return;if("mousedown"!==d&&"click"!==d)return;if(g.target=this._getTarget(b),"mousedown"===d&&g.target&&(!c.multi||!e&&!f||"standard"!==c.mouseMode))return void(this._mousedownOnItem=g.target);if(delete this._mousedownOnItem,!g.target&&"click"===d)return}c.multi&&g.target&&(f&&this.ui.focus?g.items=this._rangeSelect(g):(e||"toggle"===c.mouseMode)&&(g.items=this._multiSelect(g))),g.target&&!g.items&&(g.items=a(g.target)),delete this.ui.solidInitialElem,this._controller(b,g)},c.prototype._mousemoveHandler=function(a){if(!this._isFocusOnHoverPrevented){var b={},c=this._getTarget(a);c?(delete this.ui.solidInitialElem,this._isHovered=!0,c!==this.ui.focus&&(b.target=c,this._controller(a,b))):this._isHovered&&(this._isHovered=!1,this._controller(a,b))}},c.prototype._preventMouseMove=function(){var a=this;this._isFocusOnHoverPrevented=!0,this._focusHoverTimeout&&(clearTimeout(this._focusHoverTimeout),delete this._focusHoverTimeout),this._focusHoverTimeout=setTimeout(function(){delete a._isFocusOnHoverPrevented,delete a._focusHoverTimeout},250)},c._callPublicMethod=function(b){var d,e,f=c.getDataObject(this);if(null===f||void 0===f)throw new Error("Element "+this[0]+" has no plugin "+c.pluginName);if(f[b]&&a.isFunction(f[b])&&(d=f[b]),d&&a.isFunction(d)&&"_"!==b.charAt(0))return e=Array.prototype.slice.call(arguments),e.shift(),d.apply(f,e);throw new Error('Plugin "'+c.pluginName+'" has no method "'+b+'"')},c.prototype.isEnabled=function(){return this._isEnable},c.prototype.option=function(b,c){var d=arguments.length;if(d>0&&"string"==typeof b){if(d>1){var e={};return e[b]=c,this.options.set(e),this.$el}return this.options.get(b)}if(d>0&&a.isPlainObject(b))return this.options.set(b),this.$el;if(0===d)return this.options.get();throw new Error('Format of "option" could be: "option" or "option","name" or "option","name",val or "option",{}')},c.prototype.destroy=function(){this._trigger("destroy"),this._unbindEvents(),this._focusHoverTimeout&&clearTimeout(this._focusHoverTimeout),this.ui.focus&&(a(this.ui.focus).removeClass(this.options.get("focusClass")),delete this.ui.focus),this._selected>0&&this.getSelected().removeClass(this.options.get("selectedClass")),this.$el.removeClass(this.options.get("disabledClass")),this.$el.removeClass(this.options.get("listClass")),this.options.off(),delete this.options,delete this._scrolledElem,delete this.ui.solidInitialElem,this.$el.removeData("plugin_"+c.pluginName),this.$el=null},c.prototype.unselect=function(a){return this.select(a,!0)},c.prototype.select=function(b,c){var d,e;if(!0===c&&void 0===b)e={isTargetWasSelected:!0,isMultiSelect:!0},e.items=this._getItems(e);else if(e={isTargetWasSelected:!!c,isMultiSelect:!0},void 0!==b&&a.isNumeric(b))e.items=this._getItems(e,b);else{if(d=this._checkIfElem(b),!1===d&&(d=this._checkIfSelector(b)),!1===d)throw new Error('You shold pass DOM element or selector to "select" method.');e.items=null===d?null:d.addClass?d:a(d)}return delete this.ui.solidInitialElem,this._controller(null,e),this.$el},c.prototype.blur=function(){return this._controller(null,{target:null}),this.$el},c.prototype.getSelected=function(a){var b,c=this._getItems({}).filter("."+this.options.get("selectedClass"));if(a){b=[];for(var d=0;d<c.length;d++)b.push(c[d].id||null);return b&&b.length>0?b:null}return c},c.prototype.getSelectedId=function(){return this.getSelected(!0)},c.prototype.focus=function(b){var c;if(arguments.length>0){if((c=a.isNumeric(b)?this._getItems({},b):!1===(c=this._checkIfElem(b))?this._checkIfSelector(b):c)&&(c.jquery||c.zepto))this._setFocus(c[0]);else if(!1===c)throw new Error("You shold pass DOM element or CSS selector to set focus or nothing to get it.");return this.$el}return this.ui.focus?this.ui.focus:null},c.prototype.scroll=function(){this._preventMouseMove(),this.ui.focus&&(this._scrolledElem&&this._refreshBoxScroll(this._scrolledElem),this._refreshBoxScroll(window))},c.prototype.enable=function(){return this._isEnable=!0,this.$el.removeClass(this.options.get("disabledClass")),this.$el},c.prototype.disable=function(){return this._isEnable=!1,this._isHovered=!1,this.$el.addClass(this.options.get("disabledClass")),this.$el},c.prototype.cancel=function(){return this._isPrevented=!0,this.$el},c.prototype.refresh=function(){var b=this.ui.focus;return b&&!a(b).is(":visible")&&delete this.ui.focus,this._selected=this.getSelected().length,this.$el},a.fn[c.pluginName]=function(a){return a&&a.charAt?c._callPublicMethod.apply(this,arguments):this.each(function(b,d){c.getDataObject(d)||new c(d,a)})},a.fn[c.pluginName].defaults=j})},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(14),h=(d(g),c(7)),i=d(h),j=c(12),k=d(j),l=c(20),m=d(l),n=c(8),o=d(n),p=c(11),q=(d(p),c(16)),r=d(q),s=c(5),t=d(s),u=function(){function a(b){(0,f.default)(this,a),this._controller=b,this._state={control:null,fitToScreenAvailable:!1,screenFitEnable:!1},this.init()}return a.prototype.init=function(){var a=this.$wrapper=(0,t.default)(o.default.PHOTOEDITOR_WRAP);this.$controlWrap=a.find(o.default.CONTROL_WRAP),this.$controlBtns=a.find(o.default.CONTROL_BTN),this.$controlDetails=a.find(o.default.CONTROL_DETAIL),this.$controlDetailWrap=a.find(o.default.CONTROL_DETAIL_WRAP),this.$fitToScreenToggleWrap=a.find(o.default.EDITOR.FITTOSCREEN_TOGGLE_WRAP),this.$fitToScreenToggleCheckbox=a.find(o.default.EDITOR.FITTOSCREEN_TOGGLE_CHECKBOX)},a.prototype._ready=function(){this.$wrapper;this._render(this.$controlWrap,this._controller.options.functions)},a.prototype.activate=function(){this._ready(),this.$controlBtns.on("click",this._onClickControlBtn.bind(this)),this.$fitToScreenToggleCheckbox.on("click",this._onClickFitToScreenToggleCheckbox.bind(this)),i.default.isNeedPolyfill()&&this.$controlDetails.on("click mousemove mousedown mouseup","*",this._onPointerEvents),this._controller.on("close",this._onClose.bind(this)),this._controller.on("canvasReady",this._onCanvasReady.bind(this)),this._controller.on("changeControl",this._onChangeControl.bind(this)),this._controller.on("checkFitToViewport",this._onCheckFitToViewport.bind(this))},a.prototype.deactivate=function(){this.$controlBtns.off("click"),this.$fitToScreenToggleCheckbox.off("click"),i.default.isNeedPolyfill()&&this.$controlDetails.off("click mousemove mousedown mouseup")},a.prototype._render=function(a,b){k.default.render(a,b)},a.prototype._onCanvasReady=function(a){this._checkEditable()},a.prototype._onPointerEvents=function(a){if("none"===(0,t.default)(this).css("pointer-events")){var b=(0,t.default)(this).css("display");(0,t.default)(this).css("display","none");var c=document.elementFromPoint(a.clientX,a.clientY);return(0,t.default)(this).css("display",b||""),a.target=c,(0,t.default)(c).trigger(a),!1}return!0},a.prototype._onClickControlBtn=function(a){a.preventDefault();var b=a.currentTarget,c=(0,t.default)(b),d=c.data("targetcontrol");i.default.isHold(b)||c.hasClass(o.default.DISABLE_TOGGLE_CLASS)||(c.hasClass(o.default.ACTIVE_TOGGLE_CLASS)&&(d=null),this._controller.selectControl(d),d&&r.default.log("PTE_S_"+d.toUpperCase(),b,a))},a.prototype._onChangeControl=function(a){var b=this.$controlBtns,c=b.filter(function(){return(0,t.default)(this).data("targetcontrol")===a}),d=this.$controlDetails,e=(0,t.default)(o.default.CONTROL_DETAIL+'[data-control="'+a+'"]'),f=(0,t.default)(o.default.CONTROL_DETAIL+"."+o.default.ACTIVE_TOGGLE_CLASS),g=this.$controlDetailWrap;a&&c.hasClass(o.default.ACTIVE_TOGGLE_CLASS)||(b.removeClass(o.default.ACTIVE_TOGGLE_CLASS),d.removeClass(o.default.ACTIVE_TOGGLE_CLASS).removeClass(o.default.OUT_ANIMATION_CLASS),a?(c.addClass(o.default.ACTIVE_TOGGLE_CLASS),e.addClass(o.default.ACTIVE_TOGGLE_CLASS),g.addClass(o.default.ACTIVE_TOGGLE_CLASS)):(f.one("webkitAnimationEnd oanimationend msAnimationEnd animationend",function(a){(0,t.default)(a.target).removeClass(o.default.OUT_ANIMATION_CLASS)}),f.addClass(o.default.OUT_ANIMATION_CLASS),g.removeClass(o.default.ACTIVE_TOGGLE_CLASS)),this._state.control=a,this._checkControlDetailWrapVisible())},a.prototype._onClose=function(){this.$fitToScreenToggleCheckbox.removeAttr("checked")},a.prototype._onClickFitToScreenToggleCheckbox=function(a){var b=a.currentTarget,c=(0,t.default)(b),d=c.is(":checked");if(i.default.isHold(b)||c.hasClass(o.default.DISABLE_TOGGLE_CLASS))return void this._controller.checkFitToViewport();this._controller.setEditorFitToViewport(d),r.default.log("PTE_S_FITSCREEN",b,a)},a.prototype._onCheckFitToViewport=function(a){var b=this.$fitToScreenToggleWrap,c=this.$fitToScreenToggleCheckbox,d=!a.fitToScreenAvailable,e=!(d||!a.screenFitEnable);b.toggleClass(o.default.DISABLE_TOGGLE_CLASS,d),c.prop("disabled",d).prop("checked",e).trigger("change"),this._state.fitToScreenAvailable=a.fitToScreenAvailable,this._state.screenFitEnable=a.screenFitEnable,this._checkControlDetailWrapVisible()},a.prototype._checkEditable=function(){var a=this._controller.getCurrentPhoto(),b=this.$controlBtns,c=void 0;a.animationGIF?c=m.default.getMessage("txt_notice_animation_gif"):a.vr360?c=m.default.getMessage("txt_notice_vr360"):a.panorama&&(c=m.default.getMessage("txt_notice_panorama")),a.isEditable?b.removeClass(o.default.DISABLE_TOGGLE_CLASS).prop("disabled",!1):b.addClass(o.default.DISABLE_TOGGLE_CLASS).prop("disabled",!0),c?this._controller.showToastMessage(c):this._controller.hideToastMessage()},a.prototype._checkControlDetailWrapVisible=function(){var a=this._state.fitToScreenAvailable&&!this._state.screenFitEnable,b=!this._state.control||"main"==this._state.control;this.$controlDetailWrap.toggleClass(o.default.CONTROL_DETAIL_WRAP_OFF_CLASS,a&&b)},a}();b.default=u},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(14),h=d(g),i=c(7),j=d(i),k=c(12),l=d(k),m=c(20),n=(d(m),c(8)),o=d(n),p=c(11),q=d(p),r=c(16),s=d(r),t=c(102),u=d(t),v=c(5),w=d(v);o.default.FILTER={DETAIL_FILTER_BTN:".npe_btn_detail_filter",DETAIL_FILTER_THUMB:".npe_control_filter .npe_detail_thumb",DETAIL_FILTER_THUMB_CANVAS:".npe_control_filter .npe_detail_thumb_img",DETAIL_FILTER_APPLY_ALL_BTN:".npe_control_filter .npe_btn_apply_all",DETAIL_FILTER_APPLY_SELECT_BTN:".npe_control_filter .npe_btn_apply_select",FILTER_SLIDE:".npe_slide_filter",FILTER_SLIDE_AREA:".npe_control_filter .npe_slide_area",LIST_AREA:".npe_control_filter .npe_detail_filter_area",LIST_PREV_BTN:".npe_control_filter .npe_filter_list_prev",LIST_NEXT_BTN:".npe_control_filter .npe_filter_list_next"};var x=function(){function a(b){(0,f.default)(this,a),this._controller=b,this._currentFilterIndex=-1,this.init()}return a.prototype.init=function(){var a=this.$wrapper=(0,w.default)(o.default.PHOTOEDITOR_WRAP);this.$controlWrap=a.find(o.default.CONTROL_WRAP),this.$controlDetails=a.find(o.default.CONTROL_DETAIL),this.$filterSlide=a.find(o.default.FILTER.FILTER_SLIDE),this.$filterSlideArea=a.find(o.default.FILTER.FILTER_SLIDE_AREA),this.$detailFilterApplyAllBtn=a.find(o.default.FILTER.DETAIL_FILTER_APPLY_ALL_BTN),this.$detailFilterApplySelectBtn=a.find(o.default.FILTER.DETAIL_FILTER_APPLY_SELECT_BTN),this.$filterListArea=a.find(o.default.FILTER.LIST_AREA),this.$filterListPrevBtn=a.find(o.default.FILTER.LIST_PREV_BTN),this.$filterListNextBtn=a.find(o.default.FILTER.LIST_NEXT_BTN),this._filterSlider=new u.default,this._filterSlider.setTarget(this.$filterSlide,{base:Number(this.$filterSlide.data("base")),min:Number(this.$filterSlide.attr("min")),max:Number(this.$filterSlide.attr("max")),baseData:Number(this.$filterSlide.data("basedata")),minData:Number(this.$filterSlide.data("mindata")),maxData:Number(this.$filterSlide.data("maxdata")),center:0})},a.prototype._ready=function(){var a=this.$wrapper;this._render(this.$controlDetails,{filters:h.default.filters}),this.$detailFilterThumb=a.find(o.default.FILTER.DETAIL_FILTER_THUMB),this.$detailFilterThumbCanvas=a.find(o.default.FILTER.DETAIL_FILTER_THUMB_CANVAS),this.$detailFilterBtns=a.find(o.default.FILTER.DETAIL_FILTER_BTN)},a.prototype.activate=function(){this._ready(),this.$controlDetails.on("click",o.default.FILTER.DETAIL_FILTER_BTN,this._onClickFilterBtn.bind(this)),this.$filterSlide.on("mousedown",this._onMousedownFilterSlide.bind(this)),this.$detailFilterApplyAllBtn.on("click",this._onClickFilterApplyAllBtn.bind(this)),this.$detailFilterApplySelectBtn.on("click",this._onClickFilterApplySelectBtn.bind(this)),this.$filterListArea.on("scroll",this._checkEnableListScrollBtn.bind(this)),this.$filterListPrevBtn.on("click",this._onClickFilterListArrowBtn.bind(this,-1)),this.$filterListNextBtn.on("click",this._onClickFilterListArrowBtn.bind(this,1)),this._filterSlider.activate(),this._filterSlider.on("slideStart",this._onFilterSlideStart.bind(this)),this._filterSlider.on("slide",this._onFilterSlide.bind(this)),this._filterSlider.on("slideEnd",this._onFilterSlideEnd.bind(this)),this._controller.on("canvasReady",this._onCanvasReady.bind(this)),this._controller.on("changeFilter",this._onChangeFilter.bind(this)),this._controller.on("updatePhotos",this._onUpdatePhotos.bind(this)),this._controller.on("initControlValues",this._onInitControlValues.bind(this)),this._controller.on("changeControl",this._onChangeControl.bind(this))},a.prototype.deactivate=function(){this.$controlDetails.off("click",o.default.FILTER.DETAIL_FILTER_BTN),this.$filterSlide.off("mousedown"),this.$detailFilterApplyAllBtn.off("click"),this.$detailFilterApplySelectBtn.off("click"),this.$filterListPrevBtn.off("click"),this.$filterListNextBtn.off("click"),this._filterSlider.deactivate()},a.prototype._render=function(a,b){l.default.render(a,b)},a.prototype._onCanvasReady=function(a){this._renderFilterThumbnails(),this._renderFilterSlider()},a.prototype._onChangeControl=function(a){a===q.default.CONTROLS.FILTER&&this._adjustListScroll(this._currentFilterIndex)},a.prototype._onInitControlValues=function(){this._checkApplyAllBtnState()},a.prototype._onClickFilterBtn=function(a){a.preventDefault();var b=a.currentTarget,c=(0,w.default)(b).data("filter"),d=(0,w.default)(b);d.hasClass(o.default.ACTIVE_TOGGLE_CLASS)||d.hasClass(o.default.DISABLE_TOGGLE_CLASS)||(this._controller.setEditorFilter(c),this._controller.pushHistory(),-1===c?s.default.log("PTE_F_ORIGINAL",b,a):s.default.log("PTE_F_FIL"+c,b,a))},a.prototype._onChangeFilter=function(a){var b=this.$detailFilterBtns.filter("[data-filter='"+a.index+"']");this._currentFilterIndex=a.index,b.hasClass(o.default.ACTIVE_TOGGLE_CLASS)||b.addClass(o.default.ACTIVE_TOGGLE_CLASS).siblings().removeClass(o.default.ACTIVE_TOGGLE_CLASS),this._checkApplyAllBtnState(),this._renderFilterSlider(),this._adjustListScroll(this._currentFilterIndex)},a.prototype._onUpdatePhotos=function(){this._checkApplyAllBtnState()},a.prototype._checkApplyAllBtnState=function(){var a=this,b=this.$detailFilterApplyAllBtn,c=this.$detailFilterApplySelectBtn,d=this._controller.photos,e=!1;return d.length<=1?(b.addClass(o.default.DISABLE_TOGGLE_CLASS).attr("disabled",!0),void c.addClass(o.default.DISABLE_TOGGLE_CLASS).attr("disabled",!0)):-1!==this._currentFilterIndex||(d.forEach(function(b){a._isPhotoAppliedFilter(b)&&(e=!0)}),e)?(b.removeClass(o.default.DISABLE_TOGGLE_CLASS).removeAttr("disabled"),void c.removeClass(o.default.DISABLE_TOGGLE_CLASS).removeAttr("disabled")):(b.addClass(o.default.DISABLE_TOGGLE_CLASS).attr("disabled",!0),void c.addClass(o.default.DISABLE_TOGGLE_CLASS).attr("disabled",!0))},a.prototype._isPhotoAppliedFilter=function(a){var b=a.snapshot,c=a.batchOptions,d=!1;return c.filter&&-1===c.filter.index||(b&&b.filter&&"number"==typeof b.filter.index||c.filter&&"number"==typeof c.filter.index)&&(d=!0),d},a.prototype._renderFilterThumbnails=function(){var a=this,b=this.$detailFilterThumbCanvas,c=this.$detailFilterThumb,d=this._controller.getCurrentPhoto(),e=parseInt(c.css("width")),f=parseInt(c.css("height")),g=void 0,h=void 0,i=j.default.getThumbnailImageSizeForCover(d.width,d.height,e,f);g=i[0],h=i[1],b.attr({width:g,height:h}),g<h?b.css({"margin-top":-1*Math.round((h-f)/2),"margin-left":0}):b.css({"margin-top":0,"margin-left":-1*Math.round((g-e)/2)}),this._render(b.eq(0),{originalSrc:d.domain+d.path}),setTimeout(function(){a._controller.drawFilterThumbnails(b.filter("canvas"))},10)},a.prototype._renderFilterSlider=function(){var a=this._controller.getEditorFilterIndex(),b=this._controller.getEditorFilterValue();-1===a?(this._filterSlider.disabled=!0,this._filterSlider.setValue(this.$filterSlide.data("base"))):(this._filterSlider.disabled=!1,this._filterSlider.setValueByData(b))},a.prototype._onFilterSlide=function(a){var b=a.currentTarget;(0,w.default)(b).data("adjust");this._controller.setEditorFilterValue(a.dataValue),this._controller.checkAdjustModified()},a.prototype._onFilterSlideStart=function(a){this._controller.setEditorPreview(!0),this._rangeStartPoint=a.currentTarget.value},a.prototype._onFilterSlideEnd=function(a){var b=a.currentTarget;this._controller.setEditorPreview(!1),this._controller.pushHistory(),this._rangeMoved=b.value-this._rangeStartPoint,0!==this._rangeMoved&&(0,w.default)(b).trigger("input")},a.prototype._onMousedownFilterSlide=function(a){s.default.log("PTE_F_BAR",a.currentTarget,a)},a.prototype._onClickFilterApplyAllBtn=function(a){a.preventDefault();var b=a.currentTarget;(0,w.default)(b).hasClass(o.default.DISABLE_TOGGLE_CLASS)||(this._controller.setBatchFilterApply(),this._checkApplyAllBtnState(),s.default.log("PTE_F_APPLYALL",b,a))},a.prototype._onClickFilterApplySelectBtn=function(a){var b=this;a.preventDefault();var c=a.currentTarget;(0,w.default)(c).hasClass(o.default.DISABLE_TOGGLE_CLASS)||(this._controller.asyncMultiSelectPhotos().then(function(a){a&&a.length&&b._controller.setBatchFilterApply(a)}),this._checkApplyAllBtnState(),s.default.log("PTE_F_PORTION",c,a))},a.prototype._moveListScroll=function(a){var b=this.$filterListArea,c=a>0?"+=":"-=",d=b.innerWidth(),e=b.scrollLeft(),f=b.children(o.default.FILTER.DETAIL_FILTER_BTN).first().outerWidth(),g=void 0;a>0&&(g=Math.floor((e+d)/f)*f-e),a<0&&(g=d-(Math.ceil(e/f)*f-e)),g&&b.stop(!0,!0).animate({scrollLeft:c+g},{duration:150,specialEasing:{width:"linear",height:"easeOut"}})},a.prototype._checkEnableListScrollBtn=function(){var a=this.$filterListArea,b=this.$filterListPrevBtn,c=this.$filterListNextBtn;a.scrollLeft()?b.removeClass(o.default.DISABLE_TOGGLE_CLASS):b.addClass(o.default.DISABLE_TOGGLE_CLASS),a.scrollLeft()+a.innerWidth()<a.get(0).scrollWidth?c.removeClass(o.default.DISABLE_TOGGLE_CLASS):c.addClass(o.default.DISABLE_TOGGLE_CLASS)},a.prototype._adjustListScroll=function(a){var b=this.$filterListArea,c=b.find(o.default.FILTER.DETAIL_FILTER_BTN),d=c.filter("*[data-filter='"+a+"']"),e=d.outerWidth()+2,f=d.offset().left-1,g=b.innerWidth(),h=b.offset().left,i={duration:0};f<h&&b.stop(!0,!0).animate({scrollLeft:"-="+(h-f)},i),h+g<f+e&&b.stop(!0,!0).animate({scrollLeft:"+="+(f+e-(h+g)+1)},i),this._checkEnableListScrollBtn()},a.prototype._onClickFilterListArrowBtn=function(a,b){this._moveListScroll(a)},a}();b.default=x},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(14),h=d(g),i=c(7),j=d(i),k=c(12),l=d(k),m=c(20),n=d(m),o=c(8),p=d(o),q=c(11),r=d(q),s=c(16),t=d(s),u=c(5),v=d(u);p.default.RESIZE={DETAIL_RESIZE_BTN:".npe_btn_detail_resize[data-resize]",DETAIL_RESIZE_CUSTOM_BTN:".npe_btn_direct_input",DETAIL_RESIZE_CUSTOM_INPUT:"input[type=text]",DETAIL_RESIZE_CUSTOM_CONFIRM_BTN:".npe_btn_direct_input_confirm",DETAIL_RESIZE_APPLY_ALL_BTN:".npe_control_resize .npe_btn_apply_all",DETAIL_RESIZE_ORIGINAL_TEXT:".npe_original_text",DETAIL_RESIZE_ORIGINAL_SIZE:".npe_original_size",DETAIL_RESIZE_APPLY_SELECT_BTN:".npe_control_resize .npe_btn_apply_select"};var w=function(){function a(b){(0,f.default)(this,a),this._controller=b,this.init()}return a.prototype.init=function(){var a=this.$wrapper=(0,v.default)(p.default.PHOTOEDITOR_WRAP);this.$controlWrap=a.find(p.default.CONTROL_WRAP),this.$controlDetails=a.find(p.default.CONTROL_DETAIL),this.$detailResizeApplyAllBtn=a.find(p.default.RESIZE.DETAIL_RESIZE_APPLY_ALL_BTN),this.$detailResizeApplySelectBtn=a.find(p.default.RESIZE.DETAIL_RESIZE_APPLY_SELECT_BTN),this.$detailResizeOriginalText=a.find(p.default.RESIZE.DETAIL_RESIZE_ORIGINAL_TEXT),this.$detailResizeOriginalSize=a.find(p.default.RESIZE.DETAIL_RESIZE_ORIGINAL_SIZE),this._originalWidth=null,this._originalHeight=null},a.prototype._ready=function(){var a=this.$wrapper;this._render(this.$controlDetails,{resizePreset:this._controller.options.resizePreset,useResizeCustom:this._controller.options.resizeCustom}),this.$detailResizeBtns=a.find(p.default.RESIZE.DETAIL_RESIZE_BTN),this.$detailResizeCustomBtn=a.find(p.default.RESIZE.DETAIL_RESIZE_CUSTOM_BTN),this.$detailResizeCustomInput=this.$detailResizeCustomBtn.children(p.default.RESIZE.DETAIL_RESIZE_CUSTOM_INPUT),this.$detailResizeCustomConfirmBtn=this.$detailResizeCustomBtn.children(p.default.RESIZE.DETAIL_RESIZE_CUSTOM_CONFIRM_BTN)},a.prototype.activate=function(){this._ready(),this.$detailResizeBtns.on("mousedown",this._onClickResizeBtn.bind(this)),this.$detailResizeCustomInput.on("focusin",this._onFocusinResizeCustomInput.bind(this)),this.$detailResizeCustomInput.on("focusout",this._onFocusoutResizeCustomInput.bind(this)),this.$detailResizeCustomInput.on("keydown",this._onKeydownResizeCustomInput.bind(this)),this.$detailResizeCustomInput.on("input keyup change",this._onChangeResizeCustom.bind(this)),this.$detailResizeCustomConfirmBtn.on("click",this._onClickResizeCustomConfirmBtn.bind(this)),this.$detailResizeApplyAllBtn.on("click",this._onClickResizeApplyAllBtn.bind(this)),
this.$detailResizeApplySelectBtn.on("click",this._onClickResizeApplySelectBtn.bind(this)),(0,v.default)(document.body).on("click.pe",this._onClickBody.bind(this)),this._controller.on("changeResize",this._onChangeResize.bind(this)),this._controller.on("changeBitmapdata",this._onChangeBitmapdata.bind(this))},a.prototype.deactivate=function(){this.$detailResizeBtns.off("mousedown"),this.$detailResizeCustomInput.off("focusin"),this.$detailResizeCustomInput.off("focusout"),this.$detailResizeCustomInput.off("keydown"),this.$detailResizeCustomInput.off("input keyup change"),this.$detailResizeCustomConfirmBtn.off("click"),this.$detailResizeApplyAllBtn.off("click"),this.$detailResizeApplySelectBtn.off("click"),(0,v.default)(document.body).off("click.pe")},a.prototype._render=function(a,b){l.default.render(a,b)},a.prototype._onClickResizeBtn=function(a){a.preventDefault();var b=a.currentTarget,c=(0,v.default)(b),d=c.data("resize");if(d===r.default.CONTROL.RESIZE.CUSTOM)return this._controller.isWaitingAsyncResponseEvent()||this.$detailResizeCustomInput.trigger("focus"),!1;c.hasClass(p.default.ACTIVE_TOGGLE_CLASS)||c.hasClass(p.default.DISABLE_TOGGLE_CLASS)||(this._controller.setEditorResize(d),t.default.log("PTE_W_"+d.toString().toUpperCase(),b,a))},a.prototype._onChangeResize=function(a){var b=this.$detailResizeBtns,c=this.$detailResizeBtns.filter("[data-resize='"+a+"']"),d=this.$detailResizeCustomBtn,e=this.$detailResizeBtns.filter("[data-resize='"+r.default.CONTROL.RESIZE.ORIGINAL+"']"),f=this.$detailResizeApplyAllBtn,g=this.$detailResizeApplySelectBtn,h=a===r.default.CONTROL.RESIZE.ORIGINAL||a===this._originalWidth,i=this._controller.photos.length;h||i<=1?(f.addClass(p.default.DISABLE_TOGGLE_CLASS).attr("disabled",!0),g.addClass(p.default.DISABLE_TOGGLE_CLASS).attr("disabled",!0)):(f.removeClass(p.default.DISABLE_TOGGLE_CLASS).removeAttr("disabled"),g.removeClass(p.default.DISABLE_TOGGLE_CLASS).removeAttr("disabled")),b.removeClass(p.default.ACTIVE_TOGGLE_CLASS),h?(e.addClass(p.default.ACTIVE_TOGGLE_CLASS),this._setResizeCustomInputValue("")):c.length?(c.addClass(p.default.ACTIVE_TOGGLE_CLASS),this._setResizeCustomInputValue("")):(d.addClass(p.default.ACTIVE_TOGGLE_CLASS),this._setResizeCustomInputValue(a))},a.prototype._setResizeCustomInputValue=function(a){var b=arguments.length>1&&void 0!==arguments[1]&&arguments[1],c=this.$detailResizeCustomInput,d=c.data("placeholder");b||a||(a=d),c.val(a)},a.prototype._onFocusinResizeCustomInput=function(a){var b=this.$detailResizeBtns,c=a.currentTarget,d=this.$detailResizeCustomBtn,e=this.$detailResizeCustomInput,f=Number(e.val())||"";b.addClass(p.default.DISABLE_TOGGLE_CLASS),d.addClass(p.default.FOCUS_TOGGLE_CLASS),this._setResizeCustomInputValue(f,!0),t.default.log("PTE_W_INPUT",c,a)},a.prototype._setResizeCustomInputMaxAttr=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,c=this.$detailResizeCustomInput,d=this._controller.getCurrentPhoto();a=a||d.getMaximumWidth(),b=b||d.getMinimumWidth(),c.attr({max:a,min:b})},a.prototype._onFocusoutResizeCustomInput=function(a){a.preventDefault();var b=this.$detailResizeBtns,c=this.$detailResizeCustomBtn,d=this.$detailResizeCustomInput,e=parseInt(d.val(),10),f=Number(d.attr("min"));e<f&&(e=f,this._setResizeCustomInputValue(f)),b.removeClass(p.default.ACTIVE_TOGGLE_CLASS),c.removeClass(p.default.FOCUS_TOGGLE_CLASS).addClass(p.default.ACTIVE_TOGGLE_CLASS),this._controller.setEditorResize(e),this._disableResizePresetLargerThanPhoto()},a.prototype._onKeydownResizeCustomInput=function(a){var b=a.keyCode,c=a.shiftKey,d=a.ctrlKey,e=r.default.KEYCODES;if(b===e.ENTER||b===e.ESC)return a.preventDefault(),this.$detailResizeCustomInput.trigger("blur"),!1;-1!==v.default.inArray(b,[46,8,9,116])||65===b&&!0===d||67===b&&!0===d||88===b&&!0===d||b>=35&&b<=39||(c||b<48||b>57)&&(b<96||b>105)&&a.preventDefault()},a.prototype._onChangeResizeCustom=function(a){var b=this._controller.getCurrentPhoto(),c=this.$detailResizeCustomInput,d=c.val(),e=Number(d),f=Number(c.attr("max"));if(e>f){var g=void 0;g=b.width>h.default.maxImageSize?n.default.getMessage("txt_max"):n.default.getMessage("txt_original");var i=n.default.getMessage("txt_notice_resize",g,f);this._controller.showToastMessage(i),this._setResizeCustomInputValue(f)}/^0[0-9]+/.test(d)&&this._setResizeCustomInputValue(d.replace(/^0/,""))},a.prototype._onClickResizeCustomConfirmBtn=function(a){a.preventDefault(),this.$detailResizeCustomInput.trigger("blur")},a.prototype._onClickResizeApplyAllBtn=function(a){a.preventDefault();var b=a.currentTarget,c=(0,v.default)(b),d=this.$detailResizeBtns.filter("."+p.default.ACTIVE_TOGGLE_CLASS+"[data-resize]").data("resize");c.hasClass(p.default.DISABLE_TOGGLE_CLASS)||(d===r.default.CONTROL.RESIZE.CUSTOM&&(d=Number(this.$detailResizeCustomInput.val())),this._controller.setBatchResizeApply(d),t.default.log("PTE_W_BATCH",b,a))},a.prototype._onClickResizeApplySelectBtn=function(a){var b=this;a.preventDefault();var c=a.currentTarget,d=(0,v.default)(c),e=this.$detailResizeBtns.filter("."+p.default.ACTIVE_TOGGLE_CLASS+"[data-resize]").data("resize");d.hasClass(p.default.DISABLE_TOGGLE_CLASS)||(e===r.default.CONTROL.RESIZE.CUSTOM&&(e=Number(this.$detailResizeCustomInput.val())),this._controller.asyncMultiSelectPhotos().then(function(a){a&&a.length&&b._controller.setBatchResizeApply(e,a)}),t.default.log("PTE_W_PORTION",c,a))},a.prototype._renderResizeOriginalBtn=function(a){var b=this._controller.getCurrentPhoto(),c=b.width,d=b.height,e=void 0;a&&(c=a.cropWidth||c,d=a.cropHeight||d),this._originalWidth=c,this._originalHeight=d,e=b.width>h.default.maxImageSize?n.default.getMessage("txt_max"):n.default.getMessage("txt_original"),this._render(this.$detailResizeOriginalText,{txt_original_btn:e}),this._render(this.$detailResizeOriginalSize,{width:c,height:d})},a.prototype._onChangeCurrentPhoto=function(){this._setResizeCustomInputMaxAttr()},a.prototype._onChangeBitmapdata=function(a){var b=this._controller.getCurrentPhoto();b&&(b.cropWidth=a.cropWidth,b.cropHeight=a.cropHeight,this._disableResizePresetLargerThanPhoto(a),this._renderResizeOriginalBtn(a))},a.prototype._disableResizePresetLargerThanPhoto=function(a){var b=this.$detailResizeCustomBtn,c=this.$detailResizeBtns,d=(this._controller.getCurrentPhoto(),a&&a.cropWidth?a.cropWidth:this._originalWidth),e=a&&a.cropHeight?a.cropHeight:this._originalHeight,f=j.default.getMaximumWidth(d,e);this._getCurrentResizeValue()>f&&this._onChangeResize(r.default.CONTROL.RESIZE.ORIGINAL),b.hasClass(p.default.FOCUS_TOGGLE_CLASS)?c.addClass(p.default.DISABLE_TOGGLE_CLASS):c.each(function(){Number((0,v.default)(this).data("resize"))>Number(f)?(0,v.default)(this).addClass(p.default.DISABLE_TOGGLE_CLASS):(0,v.default)(this).removeClass(p.default.DISABLE_TOGGLE_CLASS)}),this._setResizeCustomInputMaxAttr(f),this._controller.checkModified()},a.prototype._getCurrentResizeValue=function(){var a=this.$detailResizeCustomInput,b=this.$detailResizeBtns.filter("."+p.default.ACTIVE_TOGGLE_CLASS),c=b.data("resize");return c===r.default.CONTROL.RESIZE.CUSTOM?Number(a.val()):c===r.default.CONTROL.RESIZE.ORIGINAL?0:Number(c)},a.prototype._onClickBody=function(a){var b=this.$detailResizeCustomInput;b.is(":focus")&&!(0,v.default)(a.target).closest(p.default.RESIZE.DETAIL_RESIZE_CUSTOM_BTN).length&&b.trigger("blur")},a}();b.default=w},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(14),h=d(g),i=c(7),j=d(i),k=c(12),l=d(k),m=c(20),n=(d(m),c(8)),o=d(n),p=c(11),q=d(p),r=c(16),s=d(r),t=c(5),u=d(t);o.default.CROP={CROP_CONFIRM_BTN:".npe_control_crop .npe_btn_confirm",DETAIL_CROP:".npe_control_crop",DETAIL_CROP_RESET_BTN:".npe_control_crop .npe_btn_reset",DETAIL_CROP_BTN:".npe_btn_detail_crop",DETAIL_CROP_ANGLE_WRAP:".npe_deg_wrap",DETAIL_CROP_ANGLE:".npe_deg",DETAIL_CROP_ANGLE_CIRCLE_CLASS:"npe_deg_circle",DETAIL_CROP_ANGLE_CIRCLE_BIG_CLASS:"npe_deg_circle_big",DETAIL_CROP_ANGLE_CIRCLE_SMALL_CLASS:"npe_deg_circle_small",DETAIL_CROP_ANGLE_CIRCLE_NUM_CLASS:"npe_deg_circle_num",DETAIL_CROP_ANGLE_AUTO_BTN:".npe_btn_deg_auto",DETAIL_CROP_ANGLE_90_BTN:".npe_btn_rotate",DETAIL_CROP_FLIP_X_BTN:".npe_btn_horizon",DETAIL_CROP_FLIP_Y_BTN:".npe_btn_vertical",CROP_SIZE_WRAP:".npe_size_wrap",CROP_SIZE_WIDTH:".npe_size_width_num",CROP_SIZE_HEIGHT:".npe_size_height_num",CROP_RESIZE_MODE_CLASS:"resize_mode"};var v=function(){function a(b){(0,f.default)(this,a),this._controller=b,this.init()}return a.prototype.init=function(){var a=this.$wrapper=(0,u.default)(o.default.PHOTOEDITOR_WRAP);this.$canvasWrap=a.find(o.default.CANVAS_WRAP),this.$canvas=this.$canvasWrap.find(o.default.CANVAS),this.$controlWrap=a.find(o.default.CROP.CONTROL_WRAP),this.$controlDetails=a.find(o.default.CROP.DETAIL_CROP),this.$detailCropResetBtn=a.find(o.default.CROP.DETAIL_CROP_RESET_BTN),this.$cropAngle90Btn=a.find(o.default.CROP.DETAIL_CROP_ANGLE_90_BTN),this.$cropConfirmBtn=a.find(o.default.CROP.CROP_CONFIRM_BTN),this.$cropAngleWrap=a.find(o.default.CROP.DETAIL_CROP_ANGLE_WRAP),this.$cropAngle=this.$cropAngleWrap.find(o.default.CROP.DETAIL_CROP_ANGLE),this.$cropAngleAutoBtn=this.$cropAngleWrap.find(o.default.CROP.DETAIL_CROP_ANGLE_AUTO_BTN),this.$cropSizeWrap=a.find(o.default.CROP.CROP_SIZE_WRAP),this.$cropSizeWidth=a.find(o.default.CROP.CROP_SIZE_WIDTH),this.$cropSizeHeight=a.find(o.default.CROP.CROP_SIZE_HEIGHT),this.$flipXBtn=a.find(o.default.CROP.DETAIL_CROP_FLIP_X_BTN),this.$flipYBtn=a.find(o.default.CROP.DETAIL_CROP_FLIP_Y_BTN)},a.prototype._ready=function(){this._renderCropPreset(),this._renderCropAngleGrid(),this.$detailCropBtns=this.$wrapper.find(o.default.CROP.DETAIL_CROP_BTN)},a.prototype.activate=function(){this._ready(),this.$controlDetails.on("click",o.default.CROP.DETAIL_CROP_BTN,this._onClickCropBtn.bind(this)),this.$detailCropResetBtn.on("click",this._onClickCropResetBtn.bind(this)),this.$cropConfirmBtn.on("click",this._onClickCropConfirmBtn.bind(this)),this.$cropAngle90Btn.on("click",this._onClickAngle90Btn.bind(this)),this.$cropAngleAutoBtn.on("click",this._onClickAngleAutoBtn.bind(this)),this.$cropAngleWrap.on("mousedown",this._onMousedownOnAngleUI.bind(this)),this.$flipXBtn.on("click",this._onClickFlipXBtn.bind(this)),this.$flipYBtn.on("click",this._onClickFlipYBtn.bind(this)),this._controller.on("canvasReady",this._onCanvasReady.bind(this)),this._controller.on("checkCropModified",this._onCheckCropModified.bind(this)),this._controller.on("checkCropEditable",this._onCheckCropEditable.bind(this)),this._controller.on("changeCrop",this._onChangeCrop.bind(this)),this._controller.on("changeAspectRatio",this._onChangeAspectRatio.bind(this)),this._controller.on("changeCropAngleStart",this._onChangeCropAngleStart.bind(this)),this._controller.on("changeCropAngle",this._onChangeCropAngle.bind(this)),this._controller.on("changeCropArea",this._onChangeCropArea.bind(this)),this._controller.on("changeCropAreaStart",this._onChangeCropAreaStart.bind(this)),this._controller.on("changeCropAreaEnd",this._onChangeCropAreaEnd.bind(this)),this._controller.on("checkCropRotation",this._onCheckCropRotaion.bind(this)),this._controller.on("checkCropMinimum",this._onCheckCropMinimum.bind(this)),this._controller.on("aspectRatioMotionStart",this._aspectRatioMotionStart.bind(this)),this._controller.on("changeControl",this._onChangeControl.bind(this))},a.prototype.deactivate=function(){this.$detailCropBtns.off("click"),this.$detailCropResetBtn.off("click"),this.$cropConfirmBtn.off("click"),this.$cropAngle90Btn.off("click"),this.$cropAngleAutoBtn.off("click"),this.$cropAngleWrap.off("mousedown"),this.$flipXBtn.off("click"),this.$flipYBtn.off("click")},a.prototype._render=function(a,b){l.default.render(a,b)},a.prototype._onCanvasReady=function(a){this._renderCropThumbnails()},a.prototype._onCheckCropEditable=function(a){var b=this.$detailCropBtns;a?b.removeClass(o.default.DISABLE_TOGGLE_CLASS):b.removeClass(o.default.ACTIVE_TOGGLE_CLASS).addClass(o.default.DISABLE_TOGGLE_CLASS)},a.prototype._onClickCropBtn=function(a){a.preventDefault();var b=a.currentTarget,c=(0,u.default)(b).data("crop"),d=(0,u.default)(b);d.hasClass(o.default.ACTIVE_TOGGLE_CLASS)||d.hasClass(o.default.DISABLE_TOGGLE_CLASS)||(this._controller.setEditorCrop(c),s.default.log("PTE_C_"+c.toUpperCase().replace(":",""),b,a))},a.prototype._onChangeCrop=function(a){var b=this.$detailCropBtns,c=b.filter("[data-crop='"+a+"']");c.length&&(b.removeClass(o.default.ACTIVE_TOGGLE_CLASS),c.hasClass(o.default.DISABLE_TOGGLE_CLASS)||c.addClass(o.default.ACTIVE_TOGGLE_CLASS))},a.prototype._onClickCropResetBtn=function(a){a.preventDefault(),this.$detailCropResetBtn.hasClass(o.default.DISABLE_TOGGLE_CLASS)||(this._controller.setEditorCropReset(),s.default.log("PTE_C_RE",a.currentTarget,a))},a.prototype._onClickCropConfirmBtn=function(a){a.preventDefault();var b=this.$detailCropBtns.filter("."+o.default.ACTIVE_TOGGLE_CLASS).data("crop");this._controller.setEditorCropConfirm(b),s.default.log("PTE_C_OK",a.currentTarget,a)},a.prototype._onClickAngle90Btn=function(a){a.preventDefault(),this._controller.setEditorRotate(),s.default.log("PTE_C_ROTATE",a.currentTarget,a)},a.prototype._onCheckCropModified=function(a){var b=this.$detailCropResetBtn;a?b.removeClass(o.default.DISABLE_TOGGLE_CLASS):b.addClass(o.default.DISABLE_TOGGLE_CLASS)},a.prototype._renderCropThumbnails=function(){var a=this._controller.getCurrentPhoto(),b=this.$detailCropBtns,c=h.default.cropThumbnailWidth,d=h.default.cropThumbnailHeight;b.each(function(){var b=(0,u.default)(this).find(o.default.DETAIL_THUMBNAIL_IMG),e=(0,u.default)(this).data("crop"),f=void 0,g=void 0,h=0,i=0;if(e===q.default.CONTROL.CROP.ORIGINAL||e===q.default.CONTROL.CROP.FREE){var k=j.default.getThumbnailSize(a.width,a.height,c,d);h=k[0],i=k[1]}else{var l=e.split(":");f=l[0],g=l[1];var m=j.default.getCroppedThumbnailSize(a.width,a.height,c,d,f,g);h=m[0],i=m[1]}b.css({width:h+"px",height:i+"px",background:'url("'+a.originalThumbnail+'") center center',"background-size":"cover"})})},a.prototype._onChangeAspectRatio=function(a){var b=a.width+":"+a.height;this._onChangeCrop(b)},a.prototype._onClickAngleAutoBtn=function(a){a.preventDefault();var b=this.$cropAngleAutoBtn;if(!b.hasClass(o.default.DISABLE_TOGGLE_CLASS)){this._controller.setEditorAutoRotate()||b.addClass(o.default.DISABLE_TOGGLE_CLASS),s.default.log("PTE_C_AUTO",a.currentTarget,a)}},a.prototype._onMousedownOnAngleUI=function(a){if(!(0,u.default)(a.target).hasClass(o.default.CROP.DETAIL_CROP_ANGLE_AUTO_BTN)){var b=this.$canvas[0],c=document.createEvent("MouseEvents");return c.initMouseEvent(a.type,!0,!0,a.view,1,a.screenX,a.screenY,a.clientX,a.clientY,!1,!1,!1,!1,0,null),b.dispatchEvent(c),!1}},a.prototype._renderCropPreset=function(){var a=this,b=h.default.crops.filter(function(b){return-1!==a._controller.options.cropPreset.indexOf(b.code)});this._render(this.$controlDetails,{cropPreset:b})},a.prototype._renderCropAngleGrid=function(){for(var a=this.$cropAngle,b=this.$cropAngleWrap,c=-45;c<46;c++){var d=(0,u.default)('<span class="'+o.default.CROP.DETAIL_CROP_ANGLE_CIRCLE_CLASS+'"></span>'),e=Math.PI*(2*c)/180,f=a.width()/2,g=Math.round(-f*Math.cos(e)+f),h=Math.round(-f*Math.sin(e)+f);c%5==0?(d.addClass(o.default.CROP.DETAIL_CROP_ANGLE_CIRCLE_BIG_CLASS),d.append('<em class="'+o.default.CROP.DETAIL_CROP_ANGLE_CIRCLE_NUM_CLASS+'">'+c+"</em>"),d.css("transform","rotate("+2*-c+"deg)")):d.addClass(o.default.CROP.DETAIL_CROP_ANGLE_CIRCLE_SMALL_CLASS),d.css("top",h),d.css("right",g),d.attr("data-deg",c),this.$cropAngle.append(d)}b.find("."+o.default.CROP.DETAIL_CROP_ANGLE_CIRCLE_CLASS+"[data-deg=0]").addClass(o.default.ACTIVE_TOGGLE_CLASS)},a.prototype._onChangeControl=function(a){"crop"===a?this.$canvasWrap.addClass(o.default.CROP.CROP_RESIZE_MODE_CLASS):(this.$canvasWrap.removeClass(o.default.CROP.CROP_RESIZE_MODE_CLASS),this._hideCropAngle(),this._hideCropSize())},a.prototype._showCropAngle=function(){"crop"!==this._controller.currentControl||this._isChangingCropArea||!this._controller.isCropEditable()||this._controller.isCropMinimum()?this._hideCropAngle():this.$cropAngleWrap.addClass(o.default.ACTIVE_TOGGLE_CLASS)},a.prototype._hideCropAngle=function(){this.$cropAngleWrap.removeClass(o.default.ACTIVE_TOGGLE_CLASS)},a.prototype._showCropSize=function(){this.$cropSizeWrap.addClass(o.default.ACTIVE_TOGGLE_CLASS)},a.prototype._hideCropSize=function(){this.$cropSizeWrap.removeClass(o.default.ACTIVE_TOGGLE_CLASS)},a.prototype._onCheckCropRotaion=function(a){var b=this.$cropAngleAutoBtn,c=j.default.getIEVersion();a||c&&c<=10?b.addClass(o.default.DISABLE_TOGGLE_CLASS):b.removeClass(o.default.DISABLE_TOGGLE_CLASS)},a.prototype._onCheckCropMinimum=function(){this._showCropAngle()},a.prototype._onChangeCropAngleStart=function(a){s.default.log("PTE_C_ANGLE",this._controller._canvas,this._controller._latelyMouseDownEvent)},a.prototype._onChangeCropAngle=function(a){var b=this.$cropAngle,c=this.$cropAngleWrap,d=a.rotation;d<-45&&(d=-45),45<d&&(d=45),b.css("transform","rotate("+2*d+"deg)"),c.find("."+o.default.CROP.DETAIL_CROP_ANGLE_CIRCLE_CLASS+'[data-deg="'+Math.round(d)+'"]').addClass(o.default.ACTIVE_TOGGLE_CLASS).siblings().removeClass(o.default.ACTIVE_TOGGLE_CLASS),this._controller.checkCropRotation(),this._controller.checkCropModified()},a.prototype._onChangeCropAreaStart=function(a){this._isChangingCropArea=!0,this._onChangeCropArea(a),this._showCropSize(),this._hideCropAngle()},a.prototype._aspectRatioMotionStart=function(a){this._hideCropAngle()},a.prototype._onChangeCropArea=function(a){var b=a.bounds,c=a.dimension;b&&this.$cropAngleWrap.css({left:b.x+b.width+3,top:b.y+b.height/2}),b&&c&&(this.$cropSizeWrap.css({left:b.x+b.width,top:b.y}),this.$cropSizeWidth.text(Math.ceil(c.width)),this.$cropSizeHeight.text(Math.ceil(c.height))),this._controller.checkCropModified()},a.prototype._onChangeCropAreaEnd=function(a){this._isChangingCropArea&&s.default.log("PTE_C_DROP",this._controller._canvas,this._controller._latelyMouseDownEvent),this._isChangingCropArea=!1,this._hideCropSize(),this._onChangeCropArea(a),this._showCropAngle()},a.prototype._onClickFlipXBtn=function(a){this._controller.setEditorFlipX(),s.default.log("PTE_C_HORIZON",a.currentTarget,a)},a.prototype._onClickFlipYBtn=function(a){this._controller.setEditorFlipY(),s.default.log("PTE_C_VERTICAL",a.currentTarget,a)},a}();b.default=v},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(14),h=(d(g),c(7)),i=(d(h),c(12)),j=d(i),k=c(20),l=(d(k),c(8)),m=d(l),n=c(11),o=d(n),p=c(16),q=d(p),r=c(102),s=d(r),t=c(5),u=d(t);m.default.ADJUST={DETAIL_ADJUST_BTN:".npe_btn_detail_effect[data-adjust]",DETAIL_ADJUST_RESET_BTN:".npe_control_effect .npe_btn_reset",ADJUST_SLIDE:".npe_control_detail_slide_area .npe_slide"};var v=function(){function a(b){(0,f.default)(this,a),this._controller=b,this.init()}return a.prototype.init=function(){var a=this.$wrapper=(0,u.default)(m.default.PHOTOEDITOR_WRAP);this.$controlWrap=a.find(m.default.CONTROL_WRAP),this.$controlDetails=a.find(m.default.CONTROL_DETAIL),this.$adjustSlides=a.find(m.default.ADJUST.ADJUST_SLIDE),this.$detailAdjustBtns=a.find(m.default.ADJUST.DETAIL_ADJUST_BTN),this.$detailAdjustResetBtn=a.find(m.default.ADJUST.DETAIL_ADJUST_RESET_BTN),this._adjustSlider=new s.default},a.prototype.activate=function(){this.$detailAdjustBtns.on("click",this._onClickAdjustBtn.bind(this)),this.$detailAdjustResetBtn.on("click",this._onClickAdjustResetBtn.bind(this)),this._adjustSlider.activate(),this._adjustSlider.on("slideStart",this._onAdjustSlideStart.bind(this)),this._adjustSlider.on("slide",this._onAdjustSlide.bind(this)),this._adjustSlider.on("slideEnd",this._onAdjustSlideEnd.bind(this)),this._controller.on("checkAdjustModified",this._onCheckAdjustModified.bind(this)),this._controller.on("changeAdjust",this._onChangeAdjust.bind(this)),this._controller.on("changeAutoAdjust",this._onChangeAutoAdjust.bind(this)),this._controller.on("initControlValues",this._onInitControlValues.bind(this))},a.prototype.deactivate=function(){this.$detailAdjustBtns.off("click"),this.$detailAdjustResetBtn.off("click"),this._adjustSlider.deactivate()},a.prototype._render=function(a,b){j.default.render(a,b)},a.prototype._onInitControlValues=function(a){this._onChangeAutoAdjust(a.adjust.autolevel),this._setAdjustControlValue(o.default.CONTROL.ADJUST.BRIGHTNESS,a.adjust[o.default.CONTROL.ADJUST.BRIGHTNESS]),this._setAdjustControlValue(o.default.CONTROL.ADJUST.SATURATION,a.adjust[o.default.CONTROL.ADJUST.SATURATION]),this._setAdjustControlValue(o.default.CONTROL.ADJUST.SHARPEN,a.adjust[o.default.CONTROL.ADJUST.SHARPEN]),this._setAdjustControlValue(o.default.CONTROL.ADJUST.KELVIN,a.adjust[o.default.CONTROL.ADJUST.KELVIN]),this._setAdjustControlValue(o.default.CONTROL.ADJUST.CONTRAST,a.adjust[o.default.CONTROL.ADJUST.CONTRAST])},a.prototype._startRangeMoving=function(a){this._controller.setEditorPreview(!0),this._rangeStartPoint=a.value},a.prototype._endRangeMoving=function(a){this._controller.setEditorPreview(!1),this._controller.pushHistory(),this._rangeMoved=a.value-this._rangeStartPoint,0!==this._rangeMoved&&(0,u.default)(a).trigger("input")},a.prototype._showAdjustSlides=function(a){var b=this.$adjustSlides,c=b.filter(function(){return(0,u.default)(this).data("adjust")===a});b.removeClass(m.default.ACTIVE_TOGGLE_CLASS),c.addClass(m.default.ACTIVE_TOGGLE_CLASS),this._adjustSlider.setTarget(c[0],{base:Number(c.data("base")),min:Number(c.attr("min")),max:Number(c.attr("max")),baseData:Number(c.data("basedata")),minData:Number(c.data("mindata")),maxData:Number(c.data("maxdata"))})},a.prototype._onClickAdjustBtn=function(a){a.preventDefault();var b=a.currentTarget,c=(0,u.default)(b),d=c.data("adjust");if(d===o.default.CONTROL.ADJUST.AUTO)return void this._onClickAutoAdjustBtn(a);this._controller.changeAdjust(d),q.default.log("PTE_R_"+d.toUpperCase(),b,a)},a.prototype._onClickAutoAdjustBtn=function(a){a.preventDefault();var b=a.currentTarget,c=(0,u.default)(b),d=c.hasClass(m.default.ACTIVE_TOGGLE_CLASS);this._controller.setEditorAutoAdjust(!d),q.default.log("PTE_R_AUTO",b,a)},a.prototype._onChangeAutoAdjust=function(a){var b=this.$detailAdjustBtns.filter("[data-adjust='"+o.default.CONTROL.ADJUST.AUTO+"']");a?b.addClass(m.default.ACTIVE_TOGGLE_CLASS):b.removeClass(m.default.ACTIVE_TOGGLE_CLASS)},a.prototype._onChangeAdjust=function(a){this.$detailAdjustBtns.filter("[data-adjust='"+a+"']").addClass(m.default.ACTIVE_TOGGLE_CLASS).siblings("[data-adjust!='"+o.default.CONTROL.ADJUST.AUTO+"']").removeClass(m.default.ACTIVE_TOGGLE_CLASS),this._showAdjustSlides(a)},a.prototype._onClickAdjustResetBtn=function(a){a.preventDefault();var b=a.currentTarget;(0,u.default)(b).hasClass(m.default.DISABLE_TOGGLE_CLASS)||(this._controller.setEditorAdjustReset(),this._controller.pushHistory(),this._onChangeAutoAdjust(!1),this._resetAdjustControlAndValues(),q.default.log("PTE_R_RESET",b,a))},a.prototype._resetAdjustControlAndValues=function(){var a=this;this._onChangeAdjust(o.default.CONTROL.ADJUST.BRIGHTNESS),this.$adjustSlides.each(function(){var b=(0,u.default)(this).data("adjust"),c=(0,u.default)(this).data("init");a._setAdjustControlValue(b,c)})},a.prototype._onAdjustSlide=function(a){var b=a.currentTarget,c=(0,u.default)(b).data("adjust");this._controller.setEditorAdjust(c,a.dataValue),this._controller.checkAdjustModified()},a.prototype._onAdjustSlideStart=function(a){var b=a.currentTarget;this._startRangeMoving(b)},a.prototype._onAdjustSlideEnd=function(a){var b=a.currentTarget;this._endRangeMoving(b)},a.prototype._setAdjustControlValue=function(a,b){this.$adjustSlides.filter("[data-adjust='"+a+"']").get(0);this._showAdjustSlides(a),this._adjustSlider.setValueByData(b)},a.prototype._onCheckAdjustModified=function(a){var b=this.$detailAdjustResetBtn;a?b.removeClass(m.default.DISABLE_TOGGLE_CLASS):b.addClass(m.default.DISABLE_TOGGLE_CLASS)},a}();b.default=v},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(14),h=(d(g),c(7)),i=(d(h),c(12)),j=d(i),k=c(20),l=(d(k),c(8)),m=d(l),n=c(11),o=d(n),p=c(16),q=d(p),r=c(5),s=d(r);m.default.MOSAIC={DETAIL_MOSAIC_RESET_BTN:".npe_control_mosaic .npe_btn_reset",DETAIL_MOSAIC_BTN:".npe_btn_detail_mosaic"};var t=function(){function a(b){(0,f.default)(this,a),this._controller=b,this.init()}return a.prototype.init=function(){var a=this.$wrapper=(0,s.default)(m.default.PHOTOEDITOR_WRAP);this.$controlWrap=a.find(m.default.CONTROL_WRAP),this.$controlDetails=a.find(m.default.CONTROL_DETAIL),this.$detailMosaicResetBtn=a.find(m.default.MOSAIC.DETAIL_MOSAIC_RESET_BTN),this.$detailMosaicBtns=a.find(m.default.MOSAIC.DETAIL_MOSAIC_BTN)},a.prototype.activate=function(){this.$detailMosaicBtns.on("click",this._onClickMosaicBtn.bind(this)),this.$detailMosaicResetBtn.on("click",this._onClickMosaicResetBtn.bind(this)),(0,s.default)(window).on("mouseup.pe",this._onMouseUpWindow.bind(this)),this._controller.on("changeMosaic",this._onChangeMosaic.bind(this))},a.prototype.deactivate=function(){this.$detailMosaicBtns.off("click"),this.$detailMosaicResetBtn.off("click"),(0,s.default)(window).off("mouseup.pe")},a.prototype._render=function(a,b){j.default.render(a,b)},a.prototype._onClickMosaicBtn=function(a){a.preventDefault();var b=a.currentTarget,c=(0,s.default)(b).data("mosaic"),d=(0,s.default)(b);d.hasClass(m.default.ACTIVE_TOGGLE_CLASS)||d.hasClass(m.default.DISABLE_TOGGLE_CLASS)||(this._controller.setEditorMosaic(c),q.default.log("PTE_M_"+c.toUpperCase(),b,a))},a.prototype._onChangeMosaic=function(a){var b=this.$detailMosaicBtns.filter("[data-mosaic='"+a+"']");b.hasClass(m.default.ACTIVE_TOGGLE_CLASS)||b.addClass(m.default.ACTIVE_TOGGLE_CLASS).siblings().removeClass(m.default.ACTIVE_TOGGLE_CLASS)},a.prototype._onClickMosaicResetBtn=function(a){a.preventDefault();var b=a.currentTarget;this.$detailMosaicResetBtn.hasClass(m.default.DISABLE_TOGGLE_CLASS)||(this._controller.setEditorMosaicReset(),q.default.log("PTE_M_RESET",b,a))},a.prototype._onMouseUpWindow=function(a){this._controller.currentControl===o.default.CONTROLS.MOSAIC&&this._controller.checkModified()},a}();b.default=t},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(14),h=d(g),i=c(7),j=d(i),k=c(12),l=d(k),m=c(20),n=d(m),o=c(8),p=d(o),q=c(11),r=d(q),s=c(16),t=d(s),u=c(212),v=d(u),w=c(5),x=d(w);p.default.SIGNATURE={DETAIL_SIGNATURE_BTN:".npe_control_sign .npe_btn_icon[data-signature]",DETAIL_SIGNATURE_APPLY_ALL_BTN:".npe_control_sign .npe_btn_apply_all",DETAIL_SIGNATURE_APPLY_SELECT_BTN:".npe_control_sign .npe_btn_apply_select",DETAIL_SIGNATURE_WRAP:".npe_detail_option[data-signature]",IMAGE_UPLOAD_INPUT:".npe_sign_image_file",IMAGE_UPLOAD_FILENAME:".npe_sign_image_data",TEXT_INPUT:".npe_sign_text_input",TEXT_TOOL:".npe_control_sign .npe_text_tool_area",SIGNATURE_COORD_W:".npe_sign_coord_w",SIGNATURE_COORD_H:".npe_sign_coord_h",SIGNATURE_COORD_NUM:".npe_sign_coord_num",SLIDE_THUMB:".npe_slide_background_thumb"};var y=function(){function a(b){(0,f.default)(this,a),this._controller=b,this._photoinfraRequest=b._photoinfraRequest,this._storage=b._storage,this.init()}return a.prototype.init=function(){this._defaultTextInfo={bgColor:"#000000",textColor:"#ffffff",text:void 0,bold:void 0,italic:void 0,fontSize:void 0,font:void 0,bgAlpha:.5,textAlpha:1,containerPosition:{x:10,y:10},align:"BR",textPadding:{left:10,top:5,right:10,bottom:5}},this._textInfo=x.default.extend(!0,{},this._defaultTextInfo),this._currentSignatureType=r.default.CONTROL.SIGNATURE.NONE;var a=this.$wrapper=(0,x.default)(p.default.PHOTOEDITOR_WRAP);this.$canvas=this.$wrapper.find(p.default.CANVAS),this.$detailSignatureBtns=a.find(p.default.SIGNATURE.DETAIL_SIGNATURE_BTN),this.$detailSignatureApplyAllBtn=a.find(p.default.SIGNATURE.DETAIL_SIGNATURE_APPLY_ALL_BTN),this.$detailSignatureApplySelectBtn=a.find(p.default.SIGNATURE.DETAIL_SIGNATURE_APPLY_SELECT_BTN),this.$detailSignatureWraps=a.find(p.default.SIGNATURE.DETAIL_SIGNATURE_WRAP),this.$imageUploadInput=a.find(p.default.SIGNATURE.IMAGE_UPLOAD_INPUT),this.$imageUploadFilename=a.find(p.default.SIGNATURE.IMAGE_UPLOAD_FILENAME),this.$textInput=a.find(p.default.SIGNATURE.TEXT_INPUT),this.$signatureCoordWidth=a.find(p.default.SIGNATURE.SIGNATURE_COORD_W),this.$signatureCoordHeight=a.find(p.default.SIGNATURE.SIGNATURE_COORD_H),this.$fitToScreenToggleCheckbox=a.find(p.default.FITTOSCREEN_TOGGLE_CHECKBOX),this._textToolbar=new v.default(a.find(p.default.SIGNATURE.TEXT_TOOL),this._storage,{defaultTextColor:this._defaultTextInfo.textColor,defaultBgColor:this._defaultTextInfo.bgColor,defaultTextAlpha:this._defaultTextInfo.textAlpha,defaultBgAlpha:this._defaultTextInfo.bgAlpha})},a.prototype.activate=function(){this.$detailSignatureBtns.on("click",this._onClickSignatureBtn.bind(this)),this.$imageUploadInput.on("change",this._onChangeSignatureUploadInput.bind(this)),this.$textInput.on("mousedown",this._onMousedownTextInput.bind(this)),this.$textInput.on("blur",this._onBlurTextInput.bind(this)),this.$textInput.on("input change",this._onChangeTextInput.bind(this)),this.$detailSignatureApplyAllBtn.on("click",this._onClickSignatureApplyAllBtn.bind(this)),this.$detailSignatureApplySelectBtn.on("click",this._onClickSignatureApplySelectBtn.bind(this)),this._textToolbar.on("update",this._onUpdateTextToolbar.bind(this)),this._textToolbar.activate(),this._controller.on("open",this._onOpen.bind(this)),this._controller.on("close",this._onClose.bind(this)),this._controller.on("setPhotos",this._onSetPhotos.bind(this)),this._controller.on("updatePhotos",this._onSetPhotos.bind(this)),this._controller.on("changeCurrentPhoto",this._onChangeCurrentPhoto.bind(this)),this._controller.on("changeControl",this._onChangeControl.bind(this)),this._controller.on("changeSignature",this._onChangeSignature.bind(this)),this._controller.on("initControlValues",this._onInitControlValues.bind(this)),this._controller.on("updateSignatureWidthTooltip",this._onUpdateSignatureWidthTooltip.bind(this)),this._controller.on("addSignatureWidthTooltip",this._onAddSignatureWidthTooltip.bind(this)),this._controller.on("removeSignatureWidthTooltip",this._onRemoveSignatureWidthTooltip.bind(this)),this._controller.on("updateSignatureHeightTooltip",this._onUpdateSignatureHeightTooltip.bind(this)),this._controller.on("addSignatureHeightTooltip",this._onAddSignatureHeightTooltip.bind(this)),this._controller.on("removeSignatureHeightTooltip",this._onRemoveSignatureHeightTooltip.bind(this)),this._controller.on("exitSignature",this._onExitSignature.bind(this)),this._controller.on("imageSignReady",this._onImageSignReady.bind(this))},a.prototype.deactivate=function(){this.$detailSignatureBtns.off("click"),this.$imageUploadInput.off("change"),this.$textInput.off("mousedown"),this.$textInput.off("blur"),this.$textInput.off("input change"),this.$detailSignatureApplyAllBtn.off("click"),this.$detailSignatureApplySelectBtn.off("click"),this._textToolbar.deactivate()},a.prototype._render=function(a,b){l.default.render(a,b)},a.prototype._onOpen=function(){this._loadTextInfoFromLocalStorage(),this._updateUIFromTextinfo(),this._textToolbar.loadGoogleWebfonts()},a.prototype._loadTextInfoFromLocalStorage=function(){var a=this._controller.options.signature;this._textInfo.text=this._storage.getItem(r.default.COOKIES.SIGNATURE_TEXT)||j.default.byteCut(a.defaultText,a.byteLimit),this._textInfo.font=this._storage.getItem(r.default.COOKIES.SIGNATURE_TEXT_FONT_FAMILY),this._textInfo.fontSize=this._storage.getItem(r.default.COOKIES.SIGNATURE_TEXT_FONT_SIZE),this._textInfo.bold=this._storage.getItem(r.default.COOKIES.SIGNATURE_TEXT_FONT_BOLD)||this._defaultTextInfo.bold,this._textInfo.italic=this._storage.getItem(r.default.COOKIES.SIGNATURE_TEXT_FONT_ITALIC)||this._defaultTextInfo.italic,this._textInfo.textColor=this._storage.getItem(r.default.COOKIES.SIGNATURE_TEXT_FONT_COLOR)||this._defaultTextInfo.textColor,
this._textInfo.textAlpha=this._storage.getItem(r.default.COOKIES.SIGNATURE_TEXT_FONT_ALPHA),this._textInfo.bgColor=this._storage.getItem(r.default.COOKIES.SIGNATURE_TEXT_FONT_BG_COLOR)||this._defaultTextInfo.bgColor,this._textInfo.bgAlpha=this._storage.getItem(r.default.COOKIES.SIGNATURE_TEXT_FONT_BG_ALPHA),"string"==typeof this._textInfo.bold&&(this._textInfo.bold="true"===this._textInfo.bold),"string"==typeof this._textInfo.italic&&(this._textInfo.italic="true"===this._textInfo.italic),void 0!==this._textInfo.textAlpha&&null!==this._textInfo.textAlpha||(this._textInfo.textAlpha=this._defaultTextInfo.textAlpha),void 0!==this._textInfo.bgAlpha&&null!==this._textInfo.bgAlpha||(this._textInfo.bgAlpha=this._defaultTextInfo.bgAlpha)},a.prototype._updateUIFromTextinfo=function(){this._textToolbar.setFont(this._textInfo.font),this._textToolbar.setFontSize(this._textInfo.fontSize),this._textToolbar.setBold(this._textInfo.bold),this._textToolbar.setItalic(this._textInfo.italic),this._textToolbar.setFontColor(this._textInfo.textColor,this._textInfo.textAlpha),this._textToolbar.setBackColor(this._textInfo.bgColor,this._textInfo.bgAlpha),this.$textInput.val(this._textInfo.text),this.$textInput.attr("maxlength",this._controller.options.signature.byteLimit)},a.prototype._setDefaultFontSize=function(){var a=this._controller.getCurrentPhoto(),b=a.width>1e3?34:16;this._textToolbar.setDefaultFontSize(b)},a.prototype._onClose=function(){this._controller.setEditorSignatureReset(),this.$fitToScreenToggleCheckbox.removeAttr("checked")},a.prototype._onSetPhotos=function(){this._checkApplyAllBtnState()},a.prototype._checkApplyAllBtnState=function(){var a=this,b=this.$detailSignatureApplyAllBtn,c=this.$detailSignatureApplySelectBtn,d=this._controller.photos,e=!1;return d.length<=1?(b.addClass(p.default.DISABLE_TOGGLE_CLASS).attr("disabled",!0),void c.addClass(p.default.DISABLE_TOGGLE_CLASS).attr("disabled",!0)):this._currentSignatureType!==r.default.CONTROL.SIGNATURE.NONE||(d.forEach(function(b){a._isPhotoAppliedSignature(b)&&(e=!0)}),e)?(b.removeClass(p.default.DISABLE_TOGGLE_CLASS).removeAttr("disabled"),void c.removeClass(p.default.DISABLE_TOGGLE_CLASS).removeAttr("disabled")):(b.addClass(p.default.DISABLE_TOGGLE_CLASS).attr("disabled",!0),void c.addClass(p.default.DISABLE_TOGGLE_CLASS).attr("disabled",!0))},a.prototype._isPhotoAppliedSignature=function(a){var b=a.snapshot,c=a.batchOptions,d=!1;return c.signature&&c.signature.type===r.default.CONTROL.SIGNATURE.NONE||(b&&b.signature&&b.signature.signature||c.signature&&c.signature.type!==r.default.CONTROL.SIGNATURE.NONE)&&(d=!0),d},a.prototype._onChangeCurrentPhoto=function(){this._setDefaultFontSize(),this._onRemoveSignatureWidthTooltip(),this._onRemoveSignatureHeightTooltip()},a.prototype._onChangeControl=function(a){var b=this._controller.getCurrentPhoto(),c=void 0;if(b){if(c=b.getSnapshotFromBatchOption()||{},a===r.default.CONTROLS.SIGNATURE||this._currentSignatureType!==r.default.CONTROL.SIGNATURE.TEXT||this._textInfo.text.length||this._controller.setEditorSignatureReset(),a!==r.default.CONTROLS.SIGNATURE||this._currentSignatureType!==r.default.CONTROL.SIGNATURE.TEXT||this._textInfo.text.length||(this._updateTextinfoFromUI(),this._controller.setEditorSignatureText(this._textInfo)),a===r.default.CONTROLS.SIGNATURE&&this._currentSignatureType===r.default.CONTROL.SIGNATURE.NONE&&!b.signatureTypeChanged&&!c.signature){var d=this._storage.getItem(r.default.COOKIES.SIGNATURE_TYPE_LASTEST)||r.default.CONTROL.SIGNATURE.IMAGE;this._controller.changeSignature(d)}this._controller.checkModified()}},a.prototype._onInitControlValues=function(a){this._renderSignatureBtnUI(a.signature)},a.prototype._onClickSignatureBtn=function(a){a.preventDefault();var b=a.currentTarget,c=(0,x.default)(b),d=c.data("signature");c.hasClass(p.default.ACTIVE_TOGGLE_CLASS)||c.hasClass(p.default.DISABLE_TOGGLE_CLASS)||this._controller.isWaitingAsyncResponseEvent()||(this._controller.changeSignature(d),d===r.default.CONTROL.SIGNATURE.NONE&&this._controller.pushHistory(),t.default.log("PTE_G_"+d.toUpperCase(),b,a))},a.prototype._onChangeSignatureUploadInput=function(a){var b=this,c=a.currentTarget,d=c.files,e=d[0];if(d&&e){var f=e.name,g=f.toLowerCase().match(".("+h.default.signatureImageTypes.join("|")+")$");if(!(g?g[1]:null))return void this._controller.alert(n.default.getMessage("txt_notice_file_type_error"),n.default.getMessage("txt_notice_signature_image_type_error"));if(e.size>h.default.signatureImageSize)return void this._controller.alert(n.default.getMessage("txt_notice_signature_image_size"));this._asyncCheckSignatureImageValid(e).done(function(a){b.$imageUploadFilename.text(e.name),b._photoinfraRequest.uploadSignatureImage(a,e.type,"image"),b._controller.setEditorSignatureImage(a),b._controller.checkModified()}).fail(function(a){b._controller.alert(a)}).always(function(){(0,x.default)(c).val("").blur()}),t.default.log("PTE_G_ATTACH",c,a)}},a.prototype._onImageSignReady=function(){this._controller.checkModified()},a.prototype._asyncCheckSignatureImageValid=function(a){var b=x.default.Deferred(),c=new FileReader;return c.onload=function(a){var c=a.target.result,d=new Image;d.onload=function(){if(this.width>h.default.signatureImageWidth||this.height>h.default.signatureImageHeight)return void b.reject(n.default.getMessage("txt_notice_signature_image_size"));b.resolve(c)},d.onerror=function(){b.reject(n.default.getMessage("txt_alert_error"))},d.src=c},c.onerror=function(){b.reject(n.default.getMessage("txt_alert_error"))},c.readAsDataURL(a),b},a.prototype._onChangeSignature=function(a){var b=this;this._renderSignatureBtnUI(a),a===r.default.CONTROL.SIGNATURE.IMAGE&&(this._controller.waitAsyncResponseEvent("signatureImageUpload"),this._photoinfraRequest.asyncGetSignatureImageURL().done(function(a){b._controller.setEditorSignatureImage(a)}).fail(function(){b._controller.setEditorSignatureReset()}).always(function(){b._controller.removeAsyncReponseEvent("signatureImageUpload")})),a===r.default.CONTROL.SIGNATURE.TEXT&&(this._updateTextinfoFromUI(),this._controller.setEditorSignatureText(this._textInfo),this._controller._asyncUploadCurrentSignatureText("text2")),this._controller.checkModified()},a.prototype._renderSignatureBtnUI=function(a){var b=this.$detailSignatureBtns.filter("[data-signature='"+a+"']"),c=this.$detailSignatureWraps;this._currentSignatureType=a,b.addClass(p.default.ACTIVE_TOGGLE_CLASS).siblings().removeClass(p.default.ACTIVE_TOGGLE_CLASS),c.removeClass(p.default.ACTIVE_TOGGLE_CLASS).filter("[data-signature='"+a+"']").addClass(p.default.ACTIVE_TOGGLE_CLASS),this._checkApplyAllBtnState(),this._controller.resizeViewport()},a.prototype._onClickSignatureApplyAllBtn=function(a){a.preventDefault();var b=a.currentTarget,c=(0,x.default)(b),d=this.$detailSignatureBtns.filter("."+p.default.ACTIVE_TOGGLE_CLASS+"[data-signature]").data("signature");c.hasClass(p.default.DISABLE_TOGGLE_CLASS)||(this._controller.setBatchSignatureApply(d),this._checkApplyAllBtnState(),t.default.log("PTE_G_APPLYALL",b,a))},a.prototype._onClickSignatureApplySelectBtn=function(a){var b=this;a.preventDefault();var c=a.currentTarget,d=(0,x.default)(c),e=this.$detailSignatureBtns.filter("."+p.default.ACTIVE_TOGGLE_CLASS+"[data-signature]").data("signature");d.hasClass(p.default.DISABLE_TOGGLE_CLASS)||(this._controller.asyncMultiSelectPhotos().then(function(a){a&&a.length&&(b._controller.setBatchSignatureApply(e,a),b._checkApplyAllBtnState())}),t.default.log("PTE_G_PORTION",c,a))},a.prototype._onUpdateTextToolbar=function(){this._controller.currentControl===r.default.CONTROLS.SIGNATURE&&(this._updateTextinfoFromUI(),this._controller.setEditorSignatureText(this._textInfo))},a.prototype._updateTextinfoFromUI=function(){var a=this._textToolbar.getData();this._textInfo.font=a.font,this._textInfo.fontSize=a.fontSize,this._textInfo.bold=a.bold,this._textInfo.italic=a.italic,this._textInfo.textColor=a.textColor,this._textInfo.textAlpha=a.textAlpha,this._textInfo.bgColor=a.bgColor,this._textInfo.bgAlpha=a.bgAlpha,this._saveTextInfoToLocalStorage()},a.prototype._saveTextInfoToLocalStorage=function(){this._storage.setItem(r.default.COOKIES.SIGNATURE_TEXT,this._textInfo.text),this._storage.setItem(r.default.COOKIES.SIGNATURE_TEXT_FONT_FAMILY,this._textInfo.font),this._storage.setItem(r.default.COOKIES.SIGNATURE_TEXT_FONT_SIZE,this._textInfo.fontSize),this._storage.setItem(r.default.COOKIES.SIGNATURE_TEXT_FONT_BOLD,this._textInfo.bold),this._storage.setItem(r.default.COOKIES.SIGNATURE_TEXT_FONT_ITALIC,this._textInfo.italic),this._storage.setItem(r.default.COOKIES.SIGNATURE_TEXT_FONT_COLOR,this._textInfo.textColor),this._storage.setItem(r.default.COOKIES.SIGNATURE_TEXT_FONT_ALPHA,this._textInfo.textAlpha),this._storage.setItem(r.default.COOKIES.SIGNATURE_TEXT_FONT_BG_COLOR,this._textInfo.bgColor),this._storage.setItem(r.default.COOKIES.SIGNATURE_TEXT_FONT_BG_ALPHA,this._textInfo.bgAlpha)},a.prototype._onMousedownTextInput=function(a){this.$textInput.prop("readonly",!1).focus()},a.prototype._onBlurTextInput=function(a){this.$textInput.prop("readonly","readonly")},a.prototype._onChangeTextInput=function(a){var b=this;if(this._controller.currentControl===r.default.CONTROLS.SIGNATURE){var c=a.type,d=this.$textInput.val().trim(),e=this._controller.options.signature.byteLimit;10===j.default.getIEVersion()?j.default.getBytes(d)>=e?(d=j.default.byteCut(d,e),this.$textInput.prop("maxlength",d.length)):this.$textInput.prop("maxlength",e):j.default.getBytes(d)>=e&&(d=j.default.byteCut(d,e),this.$textInput.val(d)),this._textInfo.text=d,"change"===c?(this._applySignatureText(),this._controller._asyncUploadCurrentSignatureText("text2")):"input"===c&&(this._timer&&clearTimeout(this._timer),this._timer=setTimeout(function(){b._applySignatureText()},250))}},a.prototype._applySignatureText=function(){this._timer&&clearTimeout(this._timer),this._updateTextinfoFromUI(),this._controller.currentControl===r.default.CONTROLS.SIGNATURE&&this._currentSignatureType===r.default.CONTROL.SIGNATURE.TEXT&&this._controller.setEditorSignatureText(this._textInfo)},a.prototype._onExitSignature=function(a){this.$detailSignatureBtns.filter("[data-signature='"+r.default.CONTROL.SIGNATURE.NONE+"']").focus(),this._controller.changeSignature(r.default.CONTROL.SIGNATURE.NONE),this._controller.resizeViewport(!0)},a.prototype._onUpdateSignatureWidthTooltip=function(a){this.$signatureCoordWidth.find(p.default.SIGNATURE.SIGNATURE_COORD_NUM).text(Math.floor(a.value));var b=this.$signatureCoordWidth.outerWidth(),c=this.$signatureCoordWidth.outerHeight(),d=Math.max(0,a.x-b/2),e=Math.max(0,a.y-c-5);d=Math.min(d,this.$canvas.width()-b),e=Math.min(e,this.$canvas.height()-c),this.$signatureCoordWidth.css({left:d,top:e})},a.prototype._onAddSignatureWidthTooltip=function(a){this.$signatureCoordWidth.addClass(p.default.ACTIVE_TOGGLE_CLASS)},a.prototype._onRemoveSignatureWidthTooltip=function(a){this.$signatureCoordWidth.removeClass(p.default.ACTIVE_TOGGLE_CLASS)},a.prototype._onUpdateSignatureHeightTooltip=function(a){this.$signatureCoordHeight.find(p.default.SIGNATURE.SIGNATURE_COORD_NUM).text(Math.floor(a.value));var b=this.$signatureCoordHeight.outerWidth(),c=this.$signatureCoordHeight.outerHeight(),d=Math.max(0,a.x-b-4),e=Math.max(0,a.y-c/2);this.$signatureCoordHeight.css({left:d,top:e})},a.prototype._onAddSignatureHeightTooltip=function(a){this.$signatureCoordHeight.addClass(p.default.ACTIVE_TOGGLE_CLASS)},a.prototype._onRemoveSignatureHeightTooltip=function(a){this.$signatureCoordHeight.removeClass(p.default.ACTIVE_TOGGLE_CLASS)},a}();b.default=y},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(1),h=d(g),i=c(2),j=d(i),k=c(3),l=d(k),m=c(36),n=d(m),o=c(14),p=d(o),q=c(12),r=(d(q),c(8)),s=d(r),t=c(11),u=d(t),v=c(5),w=d(v),x=c(427),y=d(x),z=c(428),A=d(z),B=c(429),C=d(B),D=c(430),E=d(D);s.default.COLORPICKER=y.default;var F=function(a){function b(c){(0,f.default)(this,b);var d=(0,j.default)(this,a.call(this));return d._defaultOptions={selector:"",use:{colorTable:!0,opacitySlider:!0,outlineSlider:!1}},d.setOptions(c),d.initialize(),d}return(0,l.default)(b,a),b.prototype.initialize=function(){this._cacheElements(),this._createSubViews()},b.prototype._cacheElements=function(){this._$colorpickerWrapper=(0,w.default)(this._options.selector),this._$colorpickerLayer=this._$colorpickerWrapper.find(s.default.COLORPICKER.COLORPICKER_LAYER)},b.prototype.activate=function(){this._$colorpickerLayer.on("mousedown",this._onMousedown.bind(this)),this._colorTableView&&(this._colorTableView.on("changeColor",this._onChangeColor.bind(this)),this._colorTableView.activate(),this._colorTableView.setPresetColors(p.default.colors)),this._opacitySliderView&&(this._opacitySliderView.on("changeOpacity",this._onChangeOpacity.bind(this)),this._opacitySliderView.activate()),this._outlineSliderView&&(this._outlineSliderView.on("changeOutline",this._onChangeOutline.bind(this)),this._outlineSliderView.activate())},b.prototype.deactivate=function(){this._$colorpickerLayer.off(),this._colorTableView&&this._colorTableView.deactivate(),this._opacitySliderView&&this._opacitySliderView.deactivate(),this._outlineSliderView&&this._outlineSliderView.deactivate(),this.removeAllListeners()},b.prototype._createSubViews=function(){this._options.use.colorTable&&(this._colorTableView=this._colorTableView||new A.default(this._$colorpickerWrapper)),this._options.use.opacitySlider&&(this._opacitySliderView=this._opacitySliderView||new C.default(this._$colorpickerWrapper)),this._options.use.outlineSlider&&(this._outlineSliderView=this._outlineSliderView||new E.default(this._$colorpickerWrapper))},b.prototype.isChildOf=function(a){return 0!==(0,w.default)(a).find(this._$colorpickerLayer).length},b.prototype.appendTo=function(a){this._$colorpickerLayer.appendTo(a)},b.prototype.setOptions=function(a){this._options=w.default.extend(this._options||this._defaultOptions,a)},b.prototype.isVisible=function(){return this._$colorpickerLayer.hasClass(s.default.ACTIVE_TOGGLE_CLASS)},b.prototype.show=function(a){var b=this,c=this._$colorpickerLayer;a===u.default.COOKIES.SIGNATURE_TEXT_BACK||this._options.use.outlineSlider?this._opacitySliderView.setSliderTarget({baseData:0,minData:0}):this._opacitySliderView.setSliderTarget({baseData:.1,minData:.1}),(0,w.default)(document).off("click.colorPicker"),c.addClass(s.default.ACTIVE_TOGGLE_CLASS),c.find("input").removeAttr("disabled"),setTimeout(function(){(0,w.default)(document).off("click.colorPicker").on("click.colorPicker",function(a){var c=document.elementFromPoint(a.clientX,a.clientY);0===(0,w.default)(c).closest(s.default.COLORPICKER.COLORPICKER_LAYER).length&&b.hide()})},10),this.emit("show")},b.prototype.hide=function(){(0,w.default)(document).off("click.colorPicker"),this._$colorpickerLayer.removeClass(s.default.ACTIVE_TOGGLE_CLASS).find("input").attr("disabled",!0),this.emit("hide")},b.prototype.setRecentColors=function(a){this._options.use.colorTable&&this._colorTableView.setRecentColors(a)},b.prototype.setColor=function(a){this._options.use.colorTable&&this._colorTableView.setColor(a)},b.prototype.setOpacity=function(a){this._options.use.opacitySlider&&this._opacitySliderView.setOpacity(a)},b.prototype.setOutline=function(a){this._options.use.outlineSlider&&this._outlineSliderView.setOutline(a)},b.prototype._onMousedown=function(a){a.stopPropagation()},b.prototype._onChangeColor=function(a){this.emit("changeColor",a)},b.prototype._onChangeOpacity=function(a){this.emit("changeOpacity",a)},b.prototype._onChangeOutline=function(a){this.emit("changeOutline",a)},(0,h.default)(b,[{key:"container",get:function(){return this._$colorpickerLayer}}]),b}(n.default);b.default=F},function(a,b,c){"use strict";b.__esModule=!0,b.default={COLORPICKER_LAYER:".npe_color_select_area",COLORPICKER_TABLE:".npe_color_select_table",COLORPICKER_RECENT:".npe_color_select_recent",COLORPICKER_ITEM:".npe_color_select_item",COLORPICKER_CODE_PREVIEW:".npe_color_select_preview",COLORPICKER_CODE_INPUT:".npe_color_select_code_input",COLORPICKER_ALPHA_INPUT:".npe_color_select_opacity_area .npe_color_select_opacity_num",COLORPICKER_ALPHA_UP_BTN:".npe_color_select_opacity_area .npe_num_up",COLORPICKER_ALPHA_DOWN_BTN:".npe_color_select_opacity_area .npe_num_down",COLORPICKER_SLIDE_INPUT:".npe_color_select_opacity_area .npe_slide",COLORPICKER_OUTLINE_INPUT:".npe_color_select_border_area .npe_color_select_opacity_num",COLORPICKER_OUTLINE_UP_BTN:".npe_color_select_border_area .npe_num_up",COLORPICKER_OUTLINE_DOWN_BTN:".npe_color_select_border_area .npe_num_down",COLORPICKER_OUTLINE_SLIDE_INPUT:".npe_color_select_border_area .npe_slide"}},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(2),h=d(g),i=c(3),j=d(i),k=c(36),l=d(k),m=c(12),n=d(m),o=c(8),p=d(o),q=c(5),r=d(q),s=function(a){function b(c){(0,f.default)(this,b);var d=(0,h.default)(this,a.call(this));return d._$container=(0,r.default)(c),d.initialize(),d}return(0,j.default)(b,a),b.prototype.initialize=function(){this._cacheElements()},b.prototype._cacheElements=function(){this._$colorpickerTable=this._$container.find(p.default.COLORPICKER.COLORPICKER_TABLE),this._$colorpickerRecent=this._$container.find(p.default.COLORPICKER.COLORPICKER_RECENT),this._$colorpickerCodePreview=this._$container.find(p.default.COLORPICKER.COLORPICKER_CODE_PREVIEW),this._$colorpickerCodeInput=this._$container.find(p.default.COLORPICKER.COLORPICKER_CODE_INPUT)},b.prototype._render=function(a,b){n.default.render(a,b)},b.prototype.activate=function(){this._$colorpickerRecent.on("click.colorPicker",p.default.COLORPICKER.COLORPICKER_ITEM,this._onClickColor.bind(this)),this._$colorpickerTable.on("click.colorPicker",p.default.COLORPICKER.COLORPICKER_ITEM,this._onClickColor.bind(this)),this._$colorpickerCodeInput.on("keydown.colorPicker",this._onKeydownColorCodeInput.bind(this)),this._$colorpickerCodeInput.on("input.colorPicker change.colorPicker",this._onChangeColorCodeInput.bind(this))},b.prototype.deactivate=function(){this._$colorpickerRecent.off(),this._$colorpickerTable.off(),this._$colorpickerCodeInput.off(),this._$colorpickerCodeInput.off(),this.removeAllListeners()},b.prototype.setColor=function(a){this._$colorpickerTable.find(p.default.COLORPICKER.COLORPICKER_ITEM).removeClass(p.default.ACTIVE_TOGGLE_CLASS).filter("[data-item='"+a+"']").addClass(p.default.ACTIVE_TOGGLE_CLASS),this._$colorpickerCodePreview.css({"background-color":a}),this._$colorpickerCodeInput.val(a.replace("#",""))},b.prototype.setRecentColors=function(a){var b=this;setTimeout(function(){b._render(b._$colorpickerRecent,{recentColors:a})},20)},b.prototype.setPresetColors=function(a){this._render(this._$colorpickerTable,{colors:a})},b.prototype._onClickColor=function(a){var b=(0,r.default)(a.currentTarget),c=b.data("item");this.emit("changeColor",c)},b.prototype._onKeydownColorCodeInput=function(a){var b=a.keyCode,c=a.shiftKey,d=a.ctrlKey;-1!==r.default.inArray(b,[46,8,9,116])||65===b&&!0===d||67===b&&!0===d||88===b&&!0===d||b>=35&&b<=39||(c||b<48||b>57)&&(b<96||b>105)&&(b<65||b>90)&&a.preventDefault()},b.prototype._onChangeColorCodeInput=function(a){var b=(0,r.default)(a.currentTarget),c=b.val().toLowerCase(),d=/[^0-9a-z]/gi;d.test(c)&&(c=c.replace(d,""),b.val(c.toUpperCase())),6===c.length&&this.emit("changeColor","#"+c)},b}(l.default);b.default=s},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(2),h=d(g),i=c(3),j=d(i),k=c(36),l=d(k),m=c(12),n=d(m),o=c(8),p=d(o),q=c(102),r=d(q),s=c(5),t=d(s),u=function(a){function b(c){(0,f.default)(this,b);var d=(0,h.default)(this,a.call(this));return d._$container=(0,t.default)(c),d._opacitySlider=new r.default,d.initialize(),d}return(0,j.default)(b,a),b.prototype.initialize=function(){this._cacheElements()},b.prototype._cacheElements=function(){this._$colorpickerAlphaInput=this._$container.find(p.default.COLORPICKER.COLORPICKER_ALPHA_INPUT),this._$colorpickerAlphaUpBtn=this._$container.find(p.default.COLORPICKER.COLORPICKER_ALPHA_UP_BTN),this._$colorpickerAlphaDownBtn=this._$container.find(p.default.COLORPICKER.COLORPICKER_ALPHA_DOWN_BTN),this._$colorpickerAlphaSlide=this._$container.find(p.default.COLORPICKER.COLORPICKER_SLIDE_INPUT)},b.prototype._render=function(a,b){n.default.render(a,b)},b.prototype.activate=function(){this._$colorpickerAlphaInput.on("input.colorPicker",this._onInputOpacity.bind(this)),this._$colorpickerAlphaUpBtn.on("click.colorPicker",this._onClickUpBtn.bind(this)),this._$colorpickerAlphaDownBtn.on("click.colorPicker",this.onClickDownBtn.bind(this)),this._opacitySlider.activate(),this._opacitySlider.on("slide",this._onOpacitySlide.bind(this))},b.prototype.deactivate=function(){this._$colorpickerAlphaInput.off(),this._$colorpickerAlphaUpBtn.on(),this._$colorpickerAlphaDownBtn.on(),this._opacitySlider.deactivate(),this.removeAllListeners()},b.prototype.setSliderTarget=function(a){a=t.default.extend({base:0,min:0,max:100,baseData:.1,minData:.1,maxData:1},a),this._opacitySlider.setTarget(this._$colorpickerAlphaSlide,a)},b.prototype.setOpacity=function(a){this._opacitySlider.setValueByData(a),this._$colorpickerAlphaInput.val(this._opacitySlider.getValue())},b.prototype._onInputOpacity=function(a){var b=(0,t.default)(a.currentTarget),c=parseInt(b.val(),10)||0;c>100&&(c=100),this._opacitySlider.setValue(c),this.emit("changeOpacity",this._opacitySlider.getDataValue())},b.prototype._onClickUpBtn=function(a){var b=parseInt(this._$colorpickerAlphaInput.val(),10)||0;b=b<100?b+1:b,this._$colorpickerAlphaInput.val(b).trigger("input")},b.prototype.onClickDownBtn=function(a){var b=parseInt(this._$colorpickerAlphaInput.val(),10)||0;b=b>0?b-1:b,this._$colorpickerAlphaInput.val(b).trigger("input")},b.prototype._onOpacitySlide=function(a){this._$colorpickerAlphaInput.val(a.value).trigger("input")},b}(l.default);b.default=u},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(2),h=d(g),i=c(3),j=d(i),k=c(36),l=d(k),m=c(12),n=d(m),o=c(8),p=d(o),q=c(102),r=d(q),s=c(5),t=d(s),u=function(a){function b(c){(0,f.default)(this,b);var d=(0,h.default)(this,a.call(this));return d._$container=(0,t.default)(c),d.initialize(),d}return(0,j.default)(b,a),b.prototype.initialize=function(){this._cacheElements(),this._outlineSlider=new r.default(this._$colorpickerOutlineSlide,{base:0,min:0,max:30,baseData:0,minData:0,maxData:30})},b.prototype._cacheElements=function(){this._$colorpickerOutlineInput=this._$container.find(p.default.COLORPICKER.COLORPICKER_OUTLINE_INPUT),this._$colorpickerOutlineUpBtn=this._$container.find(p.default.COLORPICKER.COLORPICKER_OUTLINE_UP_BTN),this._$colorpickerOutlineDownBtn=this._$container.find(p.default.COLORPICKER.COLORPICKER_OUTLINE_DOWN_BTN),this._$colorpickerOutlineSlide=this._$container.find(p.default.COLORPICKER.COLORPICKER_OUTLINE_SLIDE_INPUT)},b.prototype._render=function(a,b){n.default.render(a,b)},b.prototype.activate=function(){this._$colorpickerOutlineInput.on("input.colorPicker",this._onInput.bind(this)),this._$colorpickerOutlineUpBtn.on("click.colorPicker",this._onClickUpBtn.bind(this)),this._$colorpickerOutlineDownBtn.on("click.colorPicker",this.onClickDownBtn.bind(this)),this._outlineSlider.activate(),this._outlineSlider.on("slide",this._onOpacitySlide.bind(this))},b.prototype.deactivate=function(){this._$colorpickerOutlineInput.off(),this._$colorpickerOutlineUpBtn.on(),this._$colorpickerOutlineDownBtn.on(),this._outlineSlider.deactivate(),this.removeAllListeners()},b.prototype.setOutline=function(a){this._outlineSlider.setValueByData(a),this._$colorpickerOutlineInput.val(this._outlineSlider.getValue())},b.prototype._onInput=function(a){var b=(0,t.default)(a.currentTarget),c=parseInt(b.val(),10)||0;c>30&&(c=30),this._outlineSlider.setValue(c),this.emit("changeOutline",this._outlineSlider.getDataValue())},b.prototype._onClickUpBtn=function(a){var b=parseInt(this._$colorpickerOutlineInput.val(),10)||0;b=b<30?b+1:b,this._$colorpickerOutlineInput.val(b).trigger("input")},b.prototype.onClickDownBtn=function(a){var b=parseInt(this._$colorpickerOutlineInput.val(),10)||0;b=b>0?b-1:b,this._$colorpickerOutlineInput.val(b).trigger("input")},b.prototype._onOpacitySlide=function(a){this._$colorpickerOutlineInput.val(a.value).trigger("input")},b}(l.default);b.default=u},function(a,b,c){var d;!function(){function e(a,b,c){return a.call.apply(a.bind,arguments)}function f(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(c,d),a.apply(b,c)}}return function(){return a.apply(b,arguments)}}function g(a,b,c){return g=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?e:f,g.apply(null,arguments)}function h(a,b){this.a=a,this.o=b||a,this.c=this.o.document}function i(a,b,c,d){if(b=a.c.createElement(b),c)for(var e in c)c.hasOwnProperty(e)&&("style"==e?b.style.cssText=c[e]:b.setAttribute(e,c[e]));return d&&b.appendChild(a.c.createTextNode(d)),b}function j(a,b,c){a=a.c.getElementsByTagName(b)[0],a||(a=document.documentElement),a.insertBefore(c,a.lastChild)}function k(a){a.parentNode&&a.parentNode.removeChild(a)}function l(a,b,c){b=b||[],c=c||[];for(var d=a.className.split(/\s+/),e=0;e<b.length;e+=1){for(var f=!1,g=0;g<d.length;g+=1)if(b[e]===d[g]){f=!0;break}f||d.push(b[e])}for(b=[],e=0;e<d.length;e+=1){for(f=!1,g=0;g<c.length;g+=1)if(d[e]===c[g]){f=!0;break}f||b.push(d[e])}a.className=b.join(" ").replace(/\s+/g," ").replace(/^\s+|\s+$/,"")}function m(a,b){for(var c=a.className.split(/\s+/),d=0,e=c.length;d<e;d++)if(c[d]==b)return!0;return!1}function n(a){return a.o.location.hostname||a.a.location.hostname}function o(a,b,c){function d(){h&&e&&f&&(h(g),h=null)}b=i(a,"link",{rel:"stylesheet",href:b,media:"all"});var e=!1,f=!0,g=null,h=c||null;fa?(b.onload=function(){e=!0,d()},b.onerror=function(){e=!0,g=Error("Stylesheet failed to load"),d()}):setTimeout(function(){e=!0,d()},0),j(a,"head",b)}function p(a,b,c,d){var e=a.c.getElementsByTagName("head")[0];if(e){var f=i(a,"script",{src:b}),g=!1;return f.onload=f.onreadystatechange=function(){g||this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||(g=!0,c&&c(null),f.onload=f.onreadystatechange=null,"HEAD"==f.parentNode.tagName&&e.removeChild(f))},e.appendChild(f),setTimeout(function(){g||(g=!0,c&&c(Error("Script load timeout")))},d||5e3),f}return null}function q(){this.a=0,this.c=null}function r(a){return a.a++,function(){a.a--,t(a)}}function s(a,b){a.c=b,t(a)}function t(a){0==a.a&&a.c&&(a.c(),a.c=null)}function u(a){this.a=a||"-"}function v(a,b){this.c=a,this.f=4,this.a="n";var c=(b||"n4").match(/^([nio])([1-9])$/i);c&&(this.a=c[1],this.f=parseInt(c[2],10))}function w(a){return z(a)+" "+a.f+"00 300px "+x(a.c)}function x(a){var b=[];a=a.split(/,\s*/);for(var c=0;c<a.length;c++){var d=a[c].replace(/['"]/g,"");-1!=d.indexOf(" ")||/^\d/.test(d)?b.push("'"+d+"'"):b.push(d)}return b.join(",")}function y(a){return a.a+a.f}function z(a){var b="normal";return"o"===a.a?b="oblique":"i"===a.a&&(b="italic"),b}function A(a){var b=4,c="n",d=null;return a&&((d=a.match(/(normal|oblique|italic)/i))&&d[1]&&(c=d[1].substr(0,1).toLowerCase()),(d=a.match(/([1-9]00|normal|bold)/i))&&d[1]&&(/bold/i.test(d[1])?b=7:/[1-9]00/.test(d[1])&&(b=parseInt(d[1].substr(0,1),10)))),c+b}function B(a,b){this.c=a,this.f=a.o.document.documentElement,this.h=b,this.a=new u("-"),this.j=!1!==b.events,this.g=!1!==b.classes}function C(a){a.g&&l(a.f,[a.a.c("wf","loading")]),E(a,"loading")}function D(a){if(a.g){var b=m(a.f,a.a.c("wf","active")),c=[],d=[a.a.c("wf","loading")];b||c.push(a.a.c("wf","inactive")),l(a.f,c,d)}E(a,"inactive")}function E(a,b,c){a.j&&a.h[b]&&(c?a.h[b](c.c,y(c)):a.h[b]())}function F(){this.c={}}function G(a,b,c){var d,e=[];for(d in b)if(b.hasOwnProperty(d)){var f=a.c[d];f&&e.push(f(b[d],c))}return e}function H(a,b){this.c=a,this.f=b,this.a=i(this.c,"span",{"aria-hidden":"true"},this.f)}function I(a){j(a.c,"body",a.a)}function J(a){return"display:block;position:absolute;top:-9999px;left:-9999px;font-size:300px;width:auto;height:auto;line-height:normal;margin:0;padding:0;font-variant:normal;white-space:nowrap;font-family:"+x(a.c)+";font-style:"+z(a)+";font-weight:"+a.f+"00;"}function K(a,b,c,d,e,f){this.g=a,this.j=b,this.a=d,this.c=c,this.f=e||3e3,this.h=f||void 0}function L(a,b,c,d,e,f,g){this.v=a,this.B=b,this.c=c,this.a=d,this.s=g||"BESbswy",this.f={},this.w=e||3e3,this.u=f||null,this.m=this.j=this.h=this.g=null,this.g=new H(this.c,this.s),this.h=new H(this.c,this.s),this.j=new H(this.c,this.s),this.m=new H(this.c,this.s),a=new v(this.a.c+",serif",y(this.a)),a=J(a),this.g.a.style.cssText=a,a=new v(this.a.c+",sans-serif",y(this.a)),a=J(a),this.h.a.style.cssText=a,a=new v("serif",y(this.a)),a=J(a),this.j.a.style.cssText=a,a=new v("sans-serif",y(this.a)),a=J(a),this.m.a.style.cssText=a,I(this.g),I(this.h),I(this.j),I(this.m)}function M(){if(null===ha){var a=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent);ha=!!a&&(536>parseInt(a[1],10)||536===parseInt(a[1],10)&&11>=parseInt(a[2],10))}return ha}function N(a,b,c){for(var d in ga)if(ga.hasOwnProperty(d)&&b===a.f[ga[d]]&&c===a.f[ga[d]])return!0;return!1}function O(a){var b,c=a.g.a.offsetWidth,d=a.h.a.offsetWidth;(b=c===a.f.serif&&d===a.f["sans-serif"])||(b=M()&&N(a,c,d)),b?ea()-a.A>=a.w?M()&&N(a,c,d)&&(null===a.u||a.u.hasOwnProperty(a.a.c))?Q(a,a.v):Q(a,a.B):P(a):Q(a,a.v)}function P(a){setTimeout(g(function(){O(this)},a),50)}function Q(a,b){setTimeout(g(function(){k(this.g.a),k(this.h.a),k(this.j.a),k(this.m.a),b(this.a)},a),0)}function R(a,b,c){this.c=a,this.a=b,this.f=0,this.m=this.j=!1,this.s=c}function S(a){0==--a.f&&a.j&&(a.m?(a=a.a,a.g&&l(a.f,[a.a.c("wf","active")],[a.a.c("wf","loading"),a.a.c("wf","inactive")]),E(a,"active")):D(a.a))}function T(a){this.j=a,this.a=new F,this.h=0,this.f=this.g=!0}function U(a,b,c,d,e){var f=0==--a.h;(a.f||a.g)&&setTimeout(function(){var a=e||null,h=d||null||{};if(0===c.length&&f)D(b.a);else{b.f+=c.length,f&&(b.j=f);var i,j=[];for(i=0;i<c.length;i++){var k=c[i],m=h[k.c],n=b.a,o=k;if(n.g&&l(n.f,[n.a.c("wf",o.c,y(o).toString(),"loading")]),E(n,"fontloading",o),n=null,null===ia)if(window.FontFace){var o=/Gecko.*Firefox\/(\d+)/.exec(window.navigator.userAgent),p=/OS X.*Version\/10\..*Safari/.exec(window.navigator.userAgent)&&/Apple/.exec(window.navigator.vendor);ia=o?42<parseInt(o[1],10):!p}else ia=!1;n=ia?new K(g(b.g,b),g(b.h,b),b.c,k,b.s,m):new L(g(b.g,b),g(b.h,b),b.c,k,b.s,a,m),j.push(n)}for(i=0;i<j.length;i++)j[i].start()}},0)}function V(a,b,c){var d=[],e=c.timeout;C(b);var d=G(a.a,c,a.c),f=new R(a.c,b,e);for(a.h=d.length,b=0,c=d.length;b<c;b++)d[b].load(function(b,c,d){U(a,f,b,c,d)})}function W(a,b){this.c=a,this.a=b}function X(a,b){this.c=a,this.a=b}function Y(a,b){this.c=a||ja,this.a=[],this.f=[],this.g=b||""}function Z(a,b){for(var c=b.length,d=0;d<c;d++){var e=b[d].split(":");3==e.length&&a.f.push(e.pop());var f="";2==e.length&&""!=e[1]&&(f=":"),a.a.push(e.join(f))}}function $(a){if(0==a.a.length)throw Error("No fonts to load!");if(-1!=a.c.indexOf("kit="))return a.c;for(var b=a.a.length,c=[],d=0;d<b;d++)c.push(a.a[d].replace(/ /g,"+"));return b=a.c+"?family="+c.join("%7C"),0<a.f.length&&(b+="&subset="+a.f.join(",")),0<a.g.length&&(b+="&text="+encodeURIComponent(a.g)),b}function _(a){this.f=a,this.a=[],this.c={}}function aa(a){for(var b=a.f.length,c=0;c<b;c++){var d=a.f[c].split(":"),e=d[0].replace(/\+/g," "),f=["n4"];if(2<=d.length){var g,h=d[1];if(g=[],h)for(var h=h.split(","),i=h.length,j=0;j<i;j++){var k;if(k=h[j],k.match(/^[\w-]+$/)){var l=na.exec(k.toLowerCase());if(null==l)k="";else{if(k=l[2],k=null==k||""==k?"n":ma[k],null==(l=l[1])||""==l)l="4";else var m=la[l],l=m||(isNaN(l)?"4":l.substr(0,1));k=[k,l].join("")}}else k="";k&&g.push(k)}0<g.length&&(f=g),3==d.length&&(d=d[2],g=[],d=d?d.split(","):g,
0<d.length&&(d=ka[d[0]])&&(a.c[e]=d))}for(a.c[e]||(d=ka[e])&&(a.c[e]=d),d=0;d<f.length;d+=1)a.a.push(new v(e,f[d]))}}function ba(a,b){this.c=a,this.a=b}function ca(a,b){this.c=a,this.a=b}function da(a,b){this.c=a,this.f=b,this.a=[]}var ea=Date.now||function(){return+new Date},fa=!!window.FontFace;u.prototype.c=function(a){for(var b=[],c=0;c<arguments.length;c++)b.push(arguments[c].replace(/[\W_]+/g,"").toLowerCase());return b.join(this.a)},K.prototype.start=function(){var a=this.c.o.document,b=this,c=ea(),d=new Promise(function(d,e){function f(){ea()-c>=b.f?e():a.fonts.load(w(b.a),b.h).then(function(a){1<=a.length?d():setTimeout(f,25)},function(){e()})}f()}),e=null,f=new Promise(function(a,c){e=setTimeout(c,b.f)});Promise.race([f,d]).then(function(){e&&(clearTimeout(e),e=null),b.g(b.a)},function(){b.j(b.a)})};var ga={D:"serif",C:"sans-serif"},ha=null;L.prototype.start=function(){this.f.serif=this.j.a.offsetWidth,this.f["sans-serif"]=this.m.a.offsetWidth,this.A=ea(),O(this)};var ia=null;R.prototype.g=function(a){var b=this.a;b.g&&l(b.f,[b.a.c("wf",a.c,y(a).toString(),"active")],[b.a.c("wf",a.c,y(a).toString(),"loading"),b.a.c("wf",a.c,y(a).toString(),"inactive")]),E(b,"fontactive",a),this.m=!0,S(this)},R.prototype.h=function(a){var b=this.a;if(b.g){var c=m(b.f,b.a.c("wf",a.c,y(a).toString(),"active")),d=[],e=[b.a.c("wf",a.c,y(a).toString(),"loading")];c||d.push(b.a.c("wf",a.c,y(a).toString(),"inactive")),l(b.f,d,e)}E(b,"fontinactive",a),S(this)},T.prototype.load=function(a){this.c=new h(this.j,a.context||this.j),this.g=!1!==a.events,this.f=!1!==a.classes,V(this,new B(this.c,a),a)},W.prototype.load=function(a){function b(){if(f["__mti_fntLst"+d]){var c,e=f["__mti_fntLst"+d](),g=[];if(e)for(var h=0;h<e.length;h++){var i=e[h].fontfamily;void 0!=e[h].fontStyle&&void 0!=e[h].fontWeight?(c=e[h].fontStyle+e[h].fontWeight,g.push(new v(i,c))):g.push(new v(i))}a(g)}else setTimeout(function(){b()},50)}var c=this,d=c.a.projectId,e=c.a.version;if(d){var f=c.c.o;p(this.c,(c.a.api||"https://fast.fonts.net/jsapi")+"/"+d+".js"+(e?"?v="+e:""),function(e){e?a([]):(f["__MonotypeConfiguration__"+d]=function(){return c.a},b())}).id="__MonotypeAPIScript__"+d}else a([])},X.prototype.load=function(a){var b,c,d=this.a.urls||[],e=this.a.families||[],f=this.a.testStrings||{},g=new q;for(b=0,c=d.length;b<c;b++)o(this.c,d[b],r(g));var h=[];for(b=0,c=e.length;b<c;b++)if(d=e[b].split(":"),d[1])for(var i=d[1].split(","),j=0;j<i.length;j+=1)h.push(new v(d[0],i[j]));else h.push(new v(d[0]));s(g,function(){a(h,f)})};var ja="https://fonts.googleapis.com/css",ka={latin:"BESbswy","latin-ext":"çöüğş",cyrillic:"йяЖ",greek:"αβΣ",khmer:"កខគ",Hanuman:"កខគ"},la={thin:"1",extralight:"2","extra-light":"2",ultralight:"2","ultra-light":"2",light:"3",regular:"4",book:"4",medium:"5","semi-bold":"6",semibold:"6","demi-bold":"6",demibold:"6",bold:"7","extra-bold":"8",extrabold:"8","ultra-bold":"8",ultrabold:"8",black:"9",heavy:"9",l:"3",r:"4",b:"7"},ma={i:"i",italic:"i",n:"n",normal:"n"},na=/^(thin|(?:(?:extra|ultra)-?)?light|regular|book|medium|(?:(?:semi|demi|extra|ultra)-?)?bold|black|heavy|l|r|b|[1-9]00)?(n|i|normal|italic)?$/,oa={Arimo:!0,Cousine:!0,Tinos:!0};ba.prototype.load=function(a){var b=new q,c=this.c,d=new Y(this.a.api,this.a.text),e=this.a.families;Z(d,e);var f=new _(e);aa(f),o(c,$(d),r(b)),s(b,function(){a(f.a,f.c,oa)})},ca.prototype.load=function(a){var b=this.a.id,c=this.c.o;b?p(this.c,(this.a.api||"https://use.typekit.net")+"/"+b+".js",function(b){if(b)a([]);else if(c.Typekit&&c.Typekit.config&&c.Typekit.config.fn){b=c.Typekit.config.fn;for(var d=[],e=0;e<b.length;e+=2)for(var f=b[e],g=b[e+1],h=0;h<g.length;h++)d.push(new v(f,g[h]));try{c.Typekit.load({events:!1,classes:!1,async:!0})}catch(i){}a(d)}},2e3):a([])},da.prototype.load=function(a){var b=this.f.id,c=this.c.o,d=this;b?(c.__webfontfontdeckmodule__||(c.__webfontfontdeckmodule__={}),c.__webfontfontdeckmodule__[b]=function(b,c){for(var e=0,f=c.fonts.length;e<f;++e){var g=c.fonts[e];d.a.push(new v(g.name,A("font-weight:"+g.weight+";font-style:"+g.style)))}a(d.a)},p(this.c,(this.f.api||"https://f.fontdeck.com/s/css/js/")+n(this.c)+"/"+b+".js",function(b){b&&a([])})):a([])};var pa=new T(window);pa.a.c.custom=function(a,b){return new X(b,a)},pa.a.c.fontdeck=function(a,b){return new da(b,a)},pa.a.c.monotype=function(a,b){return new W(b,a)},pa.a.c.typekit=function(a,b){return new ca(b,a)},pa.a.c.google=function(a,b){return new ba(b,a)};var qa={load:g(pa.load,pa)};void 0!==(d=function(){return qa}.call(b,c,b,a))&&(a.exports=d)}()},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(30),f=d(e),g=c(71),h=d(g),i=c(0),j=d(i),k=c(14),l=d(k),m=c(7),n=(d(m),c(12)),o=d(n),p=c(20),q=(d(p),c(8)),r=d(q),s=c(11),t=d(s),u=c(16),v=d(u),w=c(5),x=d(w);r.default.STICKER={AREA:".npe_sticker_area",PACK_LIST:".npe_sticker_list",PACK_LIST_ITEM:".npe_sticker_item[data-packcode]",PACK_LIST_ITEM_BTN:".npe_btn_detail_sticker",PACK_LIST_ITEM_IMG:".npe_sticker_img",STICKER_MARKET_BTN_WRAP:".npe_sticker_area ._grafolioMarketBtnWrap",STICKER_MARKET_BTN:".npe_sticker_area ._grafolioMarketBtn",STICKER_LIST:".npe_sticker_detail_list",STICKER_LIST_ITEM:".npe_sticker_item_detail",ACTIVED_STICKER_DETAIL_WRAP:".npe_sticker_item.on .npe_sticker_detail_wrap"};var y=function(){function a(b){(0,j.default)(this,a),this._controller=b,this._grafolio=b._grafolio,this.init()}return a.prototype.init=function(){var a=this.$editorWrapper=(0,x.default)(r.default.PHOTOEDITOR_WRAP);this._selected=!1,this._packs=[],this._stickers={},this.$stickerArea=a.find(r.default.STICKER.AREA),this.$stickerPackList=a.find(r.default.STICKER.PACK_LIST),this.$stickerMarketBtn=a.find(r.default.STICKER.STICKER_MARKET_BTN),this.$stickerMarketBtnWrap=a.find(r.default.STICKER.STICKER_MARKET_BTN_WRAP),this._renderUIByOptions()},a.prototype._renderUIByOptions=function(){var a=this._controller.options;this.$stickerMarketBtnWrap.toggle(Boolean(a.useGrafolioMarketBtn))},a.prototype.activate=function(){this.$stickerArea.on("click.sticker",r.default.STICKER.PACK_LIST_ITEM_BTN,this._onClickStickerPackItemBtn.bind(this)),this.$stickerArea.on("click.sticker",r.default.STICKER.STICKER_LIST_ITEM,this._onClickStickerItem.bind(this)),this.$stickerArea.on("click.sticker",r.default.STICKER.STICKER_MARKET_BTN,this._onClickMarketBtn.bind(this)),this.$editorWrapper.on("click.sticker",this._onClickWrapper.bind(this)),(0,x.default)(window).on("keydown.peSticker",this._onKeydown.bind(this)),this._controller.on("open",this._onOpen.bind(this)),this._controller.on("deleteSticker",this._onDeleteSticker.bind(this)),this._controller.on("selectSticker",this._onSelectSticker.bind(this)),this._controller.on("deselectSticker",this._onDeselectSticker.bind(this))},a.prototype.deactivate=function(){this.$stickerArea.off("click.sticker"),this.$editorWrapper.off("click.sticker"),(0,x.default)(window).off("keydown.peSticker")},a.prototype._render=function(a,b){o.default.render(a,b)},a.prototype._onOpen=function(){this._renderStickerPacks()},a.prototype._renderStickerPacks=function(){function a(){return b.apply(this,arguments)}var b=(0,h.default)(f.default.mark(function c(){return f.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!this._renderStickerPacksDone){a.next=2;break}return a.abrupt("return");case 2:return this._renderStickerPacksDone=!0,this._packs=this._getDefaultStickerPacks(),a.t0=this._packs,a.next=7,this._getGrafolioStickerPacks();case 7:a.t1=a.sent,this._packs=a.t0.concat.call(a.t0,a.t1),this._render(this.$stickerArea,{stickerPacks:this._packs});case 10:case"end":return a.stop()}},c,this)}));return a}(),a.prototype._renderStickers=function(){function a(a,c){return b.apply(this,arguments)}var b=(0,h.default)(f.default.mark(function c(a,b){var d,e;return f.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(d=this.$stickerArea.find(r.default.STICKER.STICKER_LIST).filter("[data-packCode='"+b+"']"),e={"default":"npe_sticker_default",grafolio:"npe_sticker_grafolio"},this._stickers[b]){c.next=13;break}if("default"===a&&(this._stickers[b]=this._getDefaultStickers(b)),"grafolio"!==a){c.next=13;break}return c.prev=5,c.next=8,this._getGrafolioStickers(b);case 8:this._stickers[b]=c.sent,c.next=13;break;case 11:c.prev=11,c.t0=c.catch(5);case 13:d.removeClass("npe_sticker_default").removeClass("npe_sticker_grafolio").addClass(e[a]),this._render(d,{stickers:this._stickers[b]});case 15:case"end":return c.stop()}},c,this,[[5,11]])}));return a}(),a.prototype._getDefaultStickers=function(a){var b=[],c=l.default.stickerPreview.default,d=this._controller.options.filterPath,e=void 0,f=void 0;return l.default.stickers[a].list.forEach(function(g,h){l.default.stickers[a].previewImg?(e=d+l.default.stickers[a].previewImg,f=[h%c.cols*c.width*-1,Math.floor(h/c.cols)*c.height*-1]):(e=d+g.thumbnail,f=[0,0]),b.push({type:"default",original:d+g.original,thumbnail:e,backgroundPosition:f.map(function(a){return a+"px"}).join(" ")})}),b},a.prototype._getDefaultStickerPacks=function(){var a=[],b=this._controller.options.filterPath;for(var c in l.default.stickers)a.push({type:"default",packCode:c,tabOnImg:b+l.default.stickers[c].tabOnImg,tabOffImg:b+l.default.stickers[c].tabOffImg});return a},a.prototype._getGrafolioStickers=function(){function a(a){return b.apply(this,arguments)}var b=(0,h.default)(f.default.mark(function c(a){return f.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,this._grafolio.getStickers(a);case 2:return b.abrupt("return",b.sent);case 3:case"end":return b.stop()}},c,this)}));return a}(),a.prototype._getGrafolioStickerPacks=function(){function a(){return b.apply(this,arguments)}var b=(0,h.default)(f.default.mark(function c(){return f.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this._grafolio.getStickerPacks();case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}},c,this)}));return a}(),a.prototype._onClickWrapper=function(a){(0,x.default)(a.target).closest(r.default.STICKER.PACK_LIST_ITEM).length||this._deactivateStickerPackBtns()},a.prototype._onClickMarketBtn=function(a){this._controller.alert("마켓 버튼 클릭"),v.default.log("PTE_H_MARKET",a.currentTarget,a)},a.prototype._onClickStickerPackItemBtn=function(a){var b=a.currentTarget,c=(0,x.default)(b),d=c.closest(r.default.STICKER.PACK_LIST_ITEM);d.data("type");this._toggleStickerPackBtn(b)},a.prototype._onClickStickerItem=function(a){v.default.log("PTE_H_NEWADD",a.currentTarget,a);var b=(0,x.default)(a.currentTarget),c=b.data("original"),d=b.data("code");this._controller.setEditorSticker(c,d),this._deactivateStickerPackBtns()},a.prototype._toggleStickerPackBtn=function(a){var b=(0,x.default)(a),c=b.closest(r.default.STICKER.PACK_LIST_ITEM),d=c.data("type"),e=c.data("packcode");c.hasClass(r.default.ACTIVE_TOGGLE_CLASS)||this._renderStickers(d,e),c.siblings().removeClass(r.default.ACTIVE_TOGGLE_CLASS),c.toggleClass(r.default.ACTIVE_TOGGLE_CLASS),this.$stickerArea.find(r.default.STICKER.ACTIVED_STICKER_DETAIL_WRAP).css("margin-top",-1*this.$stickerArea.scrollTop())},a.prototype._deactivateStickerPackBtns=function(){this.$stickerPackList.find(r.default.STICKER.PACK_LIST_ITEM).filter("."+r.default.ACTIVE_TOGGLE_CLASS).removeClass(r.default.ACTIVE_TOGGLE_CLASS)},a.prototype._onDeleteSticker=function(){this._controller.checkModified()},a.prototype._onSelectSticker=function(a){this._selected=!0},a.prototype._onDeselectSticker=function(a){this._selected=!1},a.prototype._onKeydown=function(a){if(this._controller.currentControl===t.default.CONTROLS.STICKER){var b=a.keyCode;this._selected&&b===t.default.KEYCODES.DEL&&this._controller.setEditorDeleteSticker()}},a}();b.default=y},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(90),f=d(e),g=c(37),h=d(g),i=c(0),j=d(i),k=c(14),l=(d(k),c(7)),m=d(l),n=c(12),o=d(n),p=c(20),q=d(p),r=c(8),s=d(r),t=c(11),u=d(t),v=c(16),w=d(v),x=c(212),y=d(x),z=c(5),A=d(z);s.default.TEXT={ADD_BTN:".npe_btn_text_add",TEXT_TOOL:".npe_control_text  .npe_text_tool_area",TEXT_INPUT_WRAP:".npe_text_wrap",TEXT_HIDDEN_VIEW:".npe_text_hidden"};var B=function(){function a(b){(0,j.default)(this,a),this._controller=b,this._storage=b._storage,this._selectedTextId=null,this._actived=!1,this._activedTextScale=null,this._activedTextPosition=null,this.init()}return a.prototype.init=function(){this._selected=!1,this._defaultTextInfo={bgColor:"#000000",textColor:"#ffffff",bold:void 0,italic:void 0,fontSize:void 0,font:void 0,bgAlpha:.5,textAlpha:1},this._textInfo=A.default.extend(!0,{},this._defaultTextInfo);var a=this.$wrapper=(0,A.default)(s.default.PHOTOEDITOR_WRAP);this.$addTextBtn=a.find(s.default.TEXT.ADD_BTN),this.$textInputWrap=a.find(s.default.TEXT.TEXT_INPUT_WRAP),this.$textHiddenView=a.find(s.default.TEXT.TEXT_HIDDEN_VIEW),this._textToolbar=new y.default(a.find(s.default.TEXT.TEXT_TOOL),this._storage,{defaultTextColor:this._defaultTextInfo.textColor,defaultBgColor:this._defaultTextInfo.bgColor,defaultTextAlpha:this._defaultTextInfo.textAlpha,defaultBgAlpha:this._defaultTextInfo.bgAlpha})},a.prototype.activate=function(){this.$addTextBtn.on("click",this._onClickAddTextBtn.bind(this)),this.$textInputWrap.on("keydown keyup change input",this._onChangeTextInput.bind(this)),this.$textInputWrap.on("focusout",this._onFocusoutInput.bind(this)),(0,A.default)(window).on("keydown.peText",this._onKeydown.bind(this)),this._textToolbar.on("update",this._onUpdateTextToolData.bind(this)),this._textToolbar.activate(),this._controller.on("open",this._onOpen.bind(this)),this._controller.on("changeCurrentPhoto",this._onChangeCurrentPhoto.bind(this)),this._controller.on("selectText",this._onSelectText.bind(this)),this._controller.on("deselectText",this._onDeselectText.bind(this)),this._controller.on("activeInput",this._onActiveInput.bind(this)),this._controller.on("deleteText",this._onDeleteText.bind(this))},a.prototype.deactivate=function(){this.$addTextBtn.off("click"),this.$textInputWrap.off("keydown keyup change input"),this.$textInputWrap.off("focusout"),(0,A.default)(window).off("keydown.peText"),this._textToolbar.deactivate()},a.prototype._render=function(a,b){o.default.render(a,b)},a.prototype._onOpen=function(){this._loadTextInfoFromLocalStorage(),this._updateTextToolbar(),this._textToolbar.loadGoogleWebfonts()},a.prototype._loadTextInfoFromLocalStorage=function(){this._textInfo.font=this._storage.getItem(u.default.COOKIES.TEXT_FONT_FAMILY),this._textInfo.fontSize=this._storage.getItem(u.default.COOKIES.TEXT_FONT_SIZE),this._textInfo.bold=this._storage.getItem(u.default.COOKIES.TEXT_FONT_BOLD)||this._defaultTextInfo.bold,this._textInfo.italic=this._storage.getItem(u.default.COOKIES.TEXT_FONT_ITALIC)||this._defaultTextInfo.italic,this._textInfo.textColor=this._storage.getItem(u.default.COOKIES.TEXT_FONT_COLOR)||this._defaultTextInfo.textColor,this._textInfo.textAlpha=this._storage.getItem(u.default.COOKIES.TEXT_FONT_ALPHA),this._textInfo.bgColor=this._storage.getItem(u.default.COOKIES.TEXT_FONT_BG_COLOR)||this._defaultTextInfo.bgColor,this._textInfo.bgAlpha=this._storage.getItem(u.default.COOKIES.TEXT_FONT_BG_ALPHA),"string"==typeof this._textInfo.bold&&(this._textInfo.bold="true"===this._textInfo.bold),"string"==typeof this._textInfo.italic&&(this._textInfo.italic="true"===this._textInfo.italic),void 0!==this._textInfo.textAlpha&&null!==this._textInfo.textAlpha||(this._textInfo.textAlpha=this._defaultTextInfo.textAlpha),void 0!==this._textInfo.bgAlpha&&null!==this._textInfo.bgAlpha||(this._textInfo.bgAlpha=this._defaultTextInfo.bgAlpha)},a.prototype._onChangeCurrentPhoto=function(){this._setDefaultFontSize()},a.prototype._setDefaultFontSize=function(){var a=this._controller.getCurrentPhoto(),b=a.width>1e3?34:16;this._textToolbar.setDefaultFontSize(b)},a.prototype._updateTextToolbar=function(){var a=(0,h.default)({},this._textInfo);this._textToolbar.disableEmit(),this._textToolbar.setFont(a.font),this._textToolbar.setFontSize(a.fontSize),this._textToolbar.setBold(a.bold),this._textToolbar.setItalic(a.italic),this._textToolbar.setFontColor(a.textColor,a.textAlpha),this._textToolbar.setBackColor(a.bgColor,a.bgAlpha),this._textToolbar.enableEmit()},a.prototype._onUpdateTextToolData=function(){var a=this._textToolbar.getData();this._textInfo.font=a.font,this._textInfo.fontSize=a.fontSize,this._textInfo.bold=a.bold,this._textInfo.italic=a.italic,this._textInfo.textColor=a.textColor,this._textInfo.textAlpha=a.textAlpha,this._textInfo.bgColor=a.bgColor,this._textInfo.bgAlpha=a.bgAlpha,this._saveTextInfoToLocalStorage(),null!==this._selectedTextId&&this._controller.setEditorUpdateText(this._selectedTextId,(0,h.default)({},this._textInfo))},a.prototype._saveTextInfoToLocalStorage=function(){this._storage.setItem(u.default.COOKIES.TEXT_FONT_FAMILY,this._textInfo.font),this._storage.setItem(u.default.COOKIES.TEXT_FONT_SIZE,this._textInfo.fontSize),this._storage.setItem(u.default.COOKIES.TEXT_FONT_BOLD,this._textInfo.bold),this._storage.setItem(u.default.COOKIES.TEXT_FONT_ITALIC,this._textInfo.italic),this._storage.setItem(u.default.COOKIES.TEXT_FONT_COLOR,this._textInfo.textColor),this._storage.setItem(u.default.COOKIES.TEXT_FONT_ALPHA,this._textInfo.textAlpha),this._storage.setItem(u.default.COOKIES.TEXT_FONT_BG_COLOR,this._textInfo.bgColor),this._storage.setItem(u.default.COOKIES.TEXT_FONT_BG_ALPHA,this._textInfo.bgAlpha)},a.prototype._onClickAddTextBtn=function(a){a.preventDefault();var b=(0,h.default)({},this._textInfo);b.text=q.default.getMessage("txt_input_text"),this._controller.setEditorAddText(b),w.default.log("PTE_T_NEWADD",a.currentTarget,a)},a.prototype._onChangeTextInput=function(){this.resizeTextInputWrap()},a.prototype._onSelectText=function(a){this._selected=!0,this._selectedTextId=a.id,(0,f.default)(this._textInfo)!==(0,f.default)(a.option)&&(this._textInfo=(0,h.default)({},a.option),this._updateTextToolbar())},a.prototype._onDeselectText=function(a){this._selected=!1,this._selectedTextId=null,this._actived=!1},a.prototype._onActiveInput=function(a){var b=this,c=this.$textInputWrap,d=a.option.italic?Math.ceil(.2*a.option.fontSize):0;this._actived=!0,this._activedTextScale=a.scale,this._activedTextPosition=a.position,c.css({left:a.position.x,top:a.position.y,"font-weight":a.option.bold?"bold":"normal","font-style":a.option.italic?"italic":"normal","font-size":a.option.fontSize+"px","font-family":a.option.font,color:m.default.convertHexToRGBA(a.option.textColor,a.option.textAlpha),"background-color":m.default.convertHexToRGBA(a.option.bgColor,a.option.bgAlpha),"transform-origin":"left top",transform:"scale("+a.scale.x+", "+a.scale.y+") matrix("+a.transform.a+", "+a.transform.b+", "+a.transform.c+", "+a.transform.d+", 0, 0)","padding-right":d+"px"}).val(a.option.text),this.resizeTextInputWrap(),c.show(),c.focus().scrollLeft(0).select(),this.resizeTextInputWrap(),setTimeout(function(){b.$wrapper.on("mousedown.activeTextInput",function(a){(0,A.default)(a.target).is(b.$textInputWrap)||(b._onFocusoutInput(a),b.$wrapper.off("mousedown.activeTextInput"))})},10)},a.prototype._onDeleteText=function(){this._controller.checkModified()},a.prototype.resizeTextInputWrap=function(){var a=this._controller._state.viewport,b=this.$textInputWrap,c=this.$textHiddenView,d=b.val(),e=this._activedTextScale,f=this._activedTextPosition,g=parseInt(b.css("padding-right"),10)||0,h=m.default.getIEVersion(),i=b.css("font-size"),j=void 0;d=d.replace(/</g,"&lt;"),d=d.replace(/>/g,"&gt;"),d=d.replace(/\n/g,"<br>"),d=d.replace(/\s/g,"&nbsp;"),d+="<br>",c.html(d).css({"font-weight":b.css("font-weight"),"font-style":b.css("font-style"),"font-size":i,"font-family":b.css("font-family"),"line-height":b.css("line-height"),padding:b.css("padding"),"letter-spacing":b.css("letter-spacing")}),j=c.width(),h&&(j+=1.1*parseInt(i,10)),b.css({"max-height":(a.height-f.y)/e.y+a.top,"max-width":(a.width-f.x)/e.x+a.left-g,width:j,height:c.height()}),10===h&&b.scrollLeft()&&b.width()===j&&b.scrollLeft(0)},a.prototype._onFocusoutInput=function(a){if(this._actived){var b=(0,h.default)({},this._textInfo);b.text=this.$textInputWrap.val(),this.$textInputWrap.hide(),this._controller.setEditorUpdateText(this._selectedTextId,b),this._onDeselectText()}},a.prototype._onKeydown=function(a){if(this._controller.currentControl===u.default.CONTROLS.TEXT){var b=a.keyCode;this._selected&&b===u.default.KEYCODES.DEL&&this._controller.setEditorDeleteText()}},a}();b.default=B},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(14),h=d(g),i=c(7),j=(d(i),c(12)),k=d(j),l=c(20),m=(d(l),c(8)),n=d(m),o=c(11),p=(d(o),c(16)),q=d(p),r=c(5),s=d(r);n.default.FRAME={DETAIL_FRAME_BTN:".npe_btn_detail_frame",DETAIL_FRAME_APPLY_ALL_BTN:".npe_control_frame .npe_btn_apply_all",DETAIL_FRAME_APPLY_SELECT_BTN:".npe_control_frame .npe_btn_apply_select"};var t=["NONE","WHITE","BLACK","ROUND","TRANSPARENT","OLD","PAPER"],u=function(){function a(b){(0,f.default)(this,a),this._controller=b,this._currentFrameIndex=0,this.init()}return a.prototype.init=function(){var a=this.$editorWrapper=(0,s.default)(n.default.PHOTOEDITOR_WRAP);this.$controlDetails=a.find(n.default.CONTROL_DETAIL),this.$detailFrameApplyAllBtn=a.find(n.default.FRAME.DETAIL_FRAME_APPLY_ALL_BTN),this.$detailFrameApplySelectBtn=a.find(n.default.FRAME.DETAIL_FRAME_APPLY_SELECT_BTN),this._renderFrameBtns()},a.prototype._renderFrameBtns=function(){var a=this;this._render(this.$controlDetails,{frames:h.default.frames.map(function(b){return b.src=b.path?a._controller._options.filterPath+b.path:null,b})}),this.$detailFrameBtns=this.$editorWrapper.find(n.default.FRAME.DETAIL_FRAME_BTN)},a.prototype.activate=function(){this.$controlDetails.on("click",n.default.FRAME.DETAIL_FRAME_BTN,this._onClickFrameBtn.bind(this)),this.$detailFrameApplyAllBtn.on("click",this._onClickFrameApplyAllBtn.bind(this)),this.$detailFrameApplySelectBtn.on("click",this._onClickFrameApplySelectBtn.bind(this)),this._controller.on("changeFrame",this._onChangeFrame.bind(this)),this._controller.on("updatePhotos",this._onUpdatePhotos.bind(this)),this._controller.on("initControlValues",this._onInitControlValues.bind(this))},a.prototype.deactivate=function(){this.$controlDetails.off("click"),this.$detailFrameApplyAllBtn.off("click"),this.$detailFrameApplySelectBtn.off("click")},a.prototype._render=function(a,b){k.default.render(a,b)},a.prototype._onClickFrameBtn=function(a){var b=a.currentTarget,c=(0,s.default)(b),d=parseInt(c.data("frame"),10);q.default.log("PTE_A_"+t[d],b,a),this._controller.setEditorFrame(d)},a.prototype._onClickFrameApplyAllBtn=function(a){a.preventDefault();var b=a.currentTarget;(0,s.default)(b).hasClass(n.default.DISABLE_TOGGLE_CLASS)||(this._controller.setBatchFrameApply(),this._checkApplyAllBtnState(),q.default.log("PTE_A_APPLYALL",b,a))},a.prototype._onClickFrameApplySelectBtn=function(a){var b=this;a.preventDefault();var c=a.currentTarget;(0,s.default)(c).hasClass(n.default.DISABLE_TOGGLE_CLASS)||(this._controller.asyncMultiSelectPhotos().then(function(a){a&&a.length&&b._controller.setBatchFrameApply(a)}),this._checkApplyAllBtnState(),q.default.log("PTE_A_PORTION",c,a))},a.prototype._onChangeFrame=function(a){var b=this.$detailFrameBtns.filter("[data-frame='"+a+"']");this._currentFrameIndex=a,b.hasClass(n.default.ACTIVE_TOGGLE_CLASS)||b.addClass(n.default.ACTIVE_TOGGLE_CLASS).siblings().removeClass(n.default.ACTIVE_TOGGLE_CLASS),this._checkApplyAllBtnState()},a.prototype._onInitControlValues=function(){this._checkApplyAllBtnState()},a.prototype._onUpdatePhotos=function(){this._checkApplyAllBtnState()},a.prototype._checkApplyAllBtnState=function(){var a=this,b=this.$detailFrameApplyAllBtn,c=this.$detailFrameApplySelectBtn,d=this._controller.photos,e=!1;return d.length<=1?(b.addClass(n.default.DISABLE_TOGGLE_CLASS).attr("disabled",!0),void c.addClass(n.default.DISABLE_TOGGLE_CLASS).attr("disabled",!0)):0!==this._currentFrameIndex||(d.forEach(function(b){a._isPhotoAppliedFrame(b)&&(e=!0)}),e)?(b.removeClass(n.default.DISABLE_TOGGLE_CLASS).removeAttr("disabled"),void c.removeClass(n.default.DISABLE_TOGGLE_CLASS).removeAttr("disabled")):(b.addClass(n.default.DISABLE_TOGGLE_CLASS).attr("disabled",!0),void c.addClass(n.default.DISABLE_TOGGLE_CLASS).attr("disabled",!0))},a.prototype._isPhotoAppliedFrame=function(a){var b=a.snapshot,c=a.batchOptions,d=!1;return c.frame&&0===c.frame||(b&&b.photoFrame&&"number"==typeof b.photoFrame.index||c.frame&&"number"==typeof c.frame)&&(d=!0),d},a}();b.default=u},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var e=c(0),f=d(e),g=c(14),h=d(g),i=c(7),j=(d(i),c(12)),k=d(j),l=c(20),m=(d(l),c(8)),n=d(m),o=c(11),p=d(o),q=c(16),r=d(q),s=c(5),t=d(s),u=c(213),v=d(u);n.default.MASK={DETAIL_MASK:".npe_control_mask",NO_APPLY_BTN:"._mask_no_btn",MASK_BTN:"._mask_btn",OUTLINE_BTN:"._mask_outline_btn",CONFIRM_BTN:".npe_control_mask .npe_btn_confirm"};var w=function(){function a(b){(0,f.default)(this,a),this._controller=b,this._storage=b._storage,this._options=b._options,this._currentClipIndex=-1,this.init()}return a.prototype.init=function(){var a=this.$wrapper=(0,t.default)(n.default.PHOTOEDITOR_WRAP);this.$canvasWrap=a.find(n.default.CANVAS_WRAP),this.$canvas=this.$canvasWrap.find(n.default.CANVAS),this.$maskToolbar=a.find(n.default.MASK.DETAIL_MASK),this.$outlineBtn=a.find(n.default.MASK.OUTLINE_BTN),this.$confirmBtn=a.find(n.default.MASK.CONFIRM_BTN),this._renderMaskBtns(),this.$maskBtns=a.find(n.default.MASK.MASK_BTN),this._setColorPicker()},a.prototype.activate=function(){this.$maskToolbar.on("click",n.default.MASK.MASK_BTN,this._onClickMaskBtn.bind(this)),this.$outlineBtn.on("click",this._onClickOutlineBtn.bind(this)),this.$confirmBtn.on("click",this._onClickConfirmBtn.bind(this)),this._colorPicker.on("changeColor",this._onChangeColorByColorPicker.bind(this)),this._colorPicker.on("changeOpacity",this._onChangeOpacityByColorPicker.bind(this)),this._colorPicker.on("update",this._onUpdateColorPicker.bind(this)),this._colorPicker.on("show",this._onShowColorPicker.bind(this)),this._colorPicker.on("hide",this._onHideColorPicker.bind(this)),this._colorPicker.activate(),this._controller.on("changeClip",this._onChangeClip.bind(this)),this._controller.on("changeCurrentPhoto",this._onChangeCurrentPhoto.bind(this)),this._controller.on("changeControl",this._onChangeControl.bind(this))},a.prototype.deactivate=function(){this.$maskToolbar.off(),this.$outlineBtn.off(),this.$confirmBtn.off(),this._colorPicker.deactivate()},a.prototype._render=function(a,b){k.default.render(a,b)},a.prototype._renderMaskBtns=function(){this._render(this.$maskToolbar,{masks:h.default.masks})},a.prototype._setColorPicker=function(){this._colorPicker=new v.default(this.$maskToolbar,this._controller._storage,{typePrefix:p.default.COOKIES.MASK_BORDER,defaultColor:this._storage.getItem(p.default.COOKIES.MASK_BORDER_COLOR)||this._options.clip.color,defaultAlpha:Number(this._storage.getItem(p.default.COOKIES.MASK_BORDER_ALPHA))||this._options.clip.opacity,defaultOutline:this._options.clip.lineWidth,use:{colorTable:!0,opacitySlider:!0,outlineSlider:!0}}),this._colorPicker.appendTo(this.$outlineBtn)},a.prototype._onChangeColorByColorPicker=function(a){this._storage.setItem(p.default.COOKIES.MASK_BORDER_COLOR,a)},a.prototype._onChangeOpacityByColorPicker=function(a){this._storage.setItem(p.default.COOKIES.MASK_BORDER_ALPHA,a)},a.prototype._onUpdateColorPicker=function(){this._setClip()},a.prototype._onShowColorPicker=function(){this._controller.setEditorClipDimmed(!0)},a.prototype._onHideColorPicker=function(){this._controller.setEditorClipDimmed(!1)},a.prototype._onClickMaskBtn=function(a){var b=a.currentTarget,c=(0,t.default)(b),d=c.data("code");this._setClip(d),-1==d?r.default.log("PTE_K_NONE",b,a):r.default.log("PTE_K_CLIP"+d,b,a)},a.prototype._onClickOutlineBtn=function(a){var b=a.currentTarget;this.$outlineBtn.hasClass(n.default.DISABLE_TOGGLE_CLASS)||(this._colorPicker.isVisible()||this._colorPicker.show(),r.default.log("PTE_K_OUTLINE",b,a))},a.prototype._setClip=function(a){var b=this._colorPicker.color,c=this._colorPicker.alpha,d=this._colorPicker.outline;void 0===a&&(a=this._currentClipIndex),this._controller.setEditorClip(a,d,c,b)},a.prototype._onClickConfirmBtn=function(a){var b=a.currentTarget;this._controller.setEditorClipConfirm(),r.default.log("PTE_K_OK",b,a)},a.prototype._onChangeClip=function(a){var b=this.$maskBtns.filter("[data-code='"+a.index+"']");this._currentClipIndex=a.index,b.hasClass(n.default.ACTIVE_TOGGLE_CLASS)||b.addClass(n.default.ACTIVE_TOGGLE_CLASS).siblings().removeClass(n.default.ACTIVE_TOGGLE_CLASS),this._colorPicker.setColor(a.color),this._colorPicker.setAlpha(a.opacity),this._colorPicker.setOutline(a.lineWidth),this.$outlineBtn.toggleClass(n.default.DISABLE_TOGGLE_CLASS,-1==a.index)},a.prototype._onChangeCurrentPhoto=function(){},a.prototype._onChangeControl=function(a){p.default.CONTROLS.CLIP},a}();b.default=w}])});
//# sourceMappingURL=se_lib_ext_plugin_3.min.js.map